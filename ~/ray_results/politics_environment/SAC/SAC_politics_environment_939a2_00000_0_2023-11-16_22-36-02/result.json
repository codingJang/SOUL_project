{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 291.5582991089546, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 3073.097, "sample_time_ms": 1589.858}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-22", "timestamp": 1700202982, "time_this_iter_s": 3.0772600173950195, "time_total_s": 3.0772600173950195, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510b06280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.0772600173950195, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 53.0, "ram_util_percent": 92.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109464645385742, "actor_loss": -4.110601425170898, "critic_loss": 4.08748722076416, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.017045674845576286, "mean_q": 0.004658130928874016, "max_q": 0.007658281363546848, "min_q": 0.002615072298794985}, "td_error": [3.9830899238586426, 2.9442152976989746, 5.212706565856934, 4.690618991851807, 6.145318984985352, 3.2942185401916504, 3.370915412902832, 3.9143059253692627, 7.049956321716309, 5.710608959197998, 3.565446376800537, 4.412576675415039, 6.618990898132324, 5.444930076599121, 4.722888946533203, 4.072770118713379, 6.547143936157227, 5.590230464935303, 4.756978988647461, 4.33621883392334, 5.55817985534668, 3.343715190887451, 3.7027525901794434, 5.53834342956543, 4.418130874633789, 5.715932369232178, 4.924895286560059, 5.432326316833496, 2.6973845958709717, 3.7538504600524902, 3.346787452697754, 4.033501625061035, 5.6939496994018555, 5.154167175292969, 3.4023075103759766, 6.3740081787109375, 5.902212142944336, 7.437067031860352, 3.5935583114624023, 4.119071960449219, 3.931375741958618, 3.9868547916412354, 6.020794868469238, 4.984515190124512, 3.9279286861419678, 4.409623622894287, 5.308550834655762, 5.399051189422607, 4.806870460510254, 7.268972873687744, 6.285042762756348, 5.314840316772461, 4.500817775726318, 6.636378765106201, 3.000330924987793, 4.217217445373535, 5.228362083435059, 3.4455533027648926, 5.0404462814331055, 5.337245464324951, 3.7626230716705322, 4.73807430267334, 4.092016220092773, 3.309577465057373, 3.2548110485076904, 0.8368711471557617, 3.5533626079559326, 4.327958583831787, 5.8728485107421875, 4.65084171295166, 2.5957717895507812, 5.41005277633667, 2.9828429222106934, 4.453843593597412, 4.126194000244141, 5.294196605682373, 5.02559757232666, 3.4631259441375732, 3.505087375640869, 4.291987895965576, 3.7453432083129883, 5.387388706207275, 4.862730979919434, 3.7000129222869873, 4.012481689453125, 3.677919387817383], "mean_td_error": 4.587332248687744, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.978135108947754, "actor_loss": -3.978799819946289, "critic_loss": 2.019559860229492, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": -0.0015101871686056256, "mean_q": 0.0022513670846819878, "max_q": 0.0055752890184521675, "min_q": -0.0005167952040210366}, "td_error": [0.5359009504318237, 3.4061732292175293, 3.212181568145752, 3.1665797233581543, 2.844461441040039, 1.2539281845092773, 2.0369606018066406, 3.1821773052215576, 2.996089220046997, 2.7681734561920166, 2.0860393047332764, 2.7693490982055664, 1.6198303699493408, 4.422473907470703, 0.9903354048728943, 1.4237112998962402, 4.9193644523620605, 1.2456841468811035, 4.4659881591796875, 0.8624098300933838, 0.8848412036895752, 4.290850639343262, 1.7998082637786865, 1.5732791423797607, 2.5430448055267334, 4.616991996765137, 2.47733736038208, 2.2567782402038574, 3.5456576347351074, 1.7529703378677368, 3.7576823234558105, 3.3775901794433594, 3.515014886856079, 2.8453590869903564, 3.562643527984619, 2.554421901702881, 0.05871409922838211, 2.130825996398926, 3.1890289783477783, 2.3897831439971924, 0.7092153429985046, 2.932237386703491, 2.2620139122009277, 3.0618085861206055, 1.4548721313476562, 3.4586033821105957, 2.5047218799591064, 3.7960305213928223, 2.6042919158935547, 2.459275722503662, 3.032381057739258, 1.3725581169128418, 1.830413818359375, 2.6916422843933105, 0.5863334536552429, 3.339895248413086, 3.4210031032562256, 2.8869080543518066, 1.675025224685669, 3.148348331451416, 1.3413069248199463, 0.9868115186691284, 4.019610404968262, 2.210507392883301, 3.024629592895508, 2.2484030723571777, 3.2976229190826416, 1.512722134590149, 3.5825469493865967, 3.0065622329711914, 5.479563236236572, 3.324021816253662, 2.945305347442627, 0.9249132871627808, 4.229323863983154, 0.579775869846344, 1.8027575016021729, 2.100170135498047, 3.079956293106079, 0.5671643614768982, 2.74143648147583, 2.122798442840576, 1.5872493982315063, 0.3784080743789673, 3.1440460681915283, 2.81377911567688], "mean_td_error": 2.5070860385894775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048402786254883, "actor_loss": -4.049422740936279, "critic_loss": 2.278827428817749, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -6.0, "policy_t": 0.03499237820506096, "mean_q": 0.0029658807907253504, "max_q": 0.006564413197338581, "min_q": -0.0023632331285625696}, "td_error": [4.246834754943848, 1.2186484336853027, 3.690488815307617, 2.882101058959961, 2.478100538253784, 3.7668185234069824, 2.762722969055176, 1.2757165431976318, 3.6525485515594482, 2.612884998321533, 3.3235702514648438, 0.21667009592056274, 1.942049503326416, 1.8847286701202393, 1.9123539924621582, 1.0715221166610718, 1.2041960954666138, 2.526435375213623, 4.991694450378418, 2.928969621658325, 4.436348915100098, 3.076293468475342, 2.01969051361084, 3.4976463317871094, 3.088829517364502, 3.7418041229248047, 5.260270118713379, 3.734114646911621, 4.240067005157471, 0.4498634338378906, 3.101938247680664, 2.7506461143493652, 2.5963451862335205, 3.5875749588012695, 3.773787260055542, 0.7517083883285522, 4.036738395690918, 1.4668595790863037, 0.8885451555252075, 0.568251371383667, 1.3319926261901855, 3.251810073852539, 2.9918651580810547, 3.2711215019226074, 4.144811153411865, 3.763183355331421, 4.289742946624756, 1.1811039447784424, 3.350656509399414, 3.4312899112701416, 2.146975040435791, 2.861694812774658, 3.3332626819610596, 1.200236201286316, 2.947580099105835, 3.2162275314331055, 0.8447715640068054, 2.48795485496521, 2.26855731010437, 1.1732141971588135, 4.784186363220215, 4.173124313354492, 2.1779799461364746, 2.750316619873047, 3.2306952476501465, 2.9652860164642334, 3.3504462242126465, 0.8197888135910034, 2.2100510597229004, 4.100015163421631, 3.6105239391326904, 1.7966012954711914, 1.5562102794647217, 4.554714202880859, 4.4465155601501465, 4.582009315490723, 2.122349739074707, 2.879478693008423, 2.7959799766540527, 0.6933387517929077, 2.5328454971313477, 0.7056753635406494, 5.778924465179443, 2.701199531555176, 2.2473535537719727, 3.562119960784912], "mean_td_error": 2.770606756210327, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 349.28136913298096, "num_env_steps_trained_throughput_per_sec": 100.57432280838069, "timesteps_total": 1792, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 2819.124, "sample_time_ms": 1682.808, "load_time_ms": 0.542, "load_throughput": 476080.26, "learn_time_ms": 92.186, "learn_throughput": 2798.69, "synch_weights_time_ms": 17.889}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 258, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 258, "last_target_update_ts": 1792, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-24", "timestamp": 1700202984, "time_this_iter_s": 2.5787901878356934, "time_total_s": 5.656050205230713, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.656050205230713, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 62.3, "ram_util_percent": 92.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06067180633545, "actor_loss": -4.0726823806762695, "critic_loss": 3.6531825065612793, "alpha_loss": -0.0030182013288140297, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.021777760237455368, "mean_q": 0.01924489066004753, "max_q": 0.024218285456299782, "min_q": 0.015873581171035767}, "td_error": [3.447669744491577, 5.684425354003906, 7.019902229309082, 4.274782180786133, 2.9003024101257324, 3.9778213500976562, 4.100719928741455, 5.432859420776367, 2.725829601287842, 2.9247286319732666, 4.193607330322266, 4.146318435668945, 2.2655029296875, 6.225119590759277, 3.5596232414245605, 5.016107559204102, 5.63673210144043, 4.248302459716797, 5.315468788146973, 5.6328535079956055, 3.724034309387207, 4.375438690185547, 3.1752967834472656, 5.339313507080078, 2.952773332595825, 4.748014450073242, 4.820415496826172, 3.343235969543457, 4.869268417358398, 4.7318925857543945, 4.870141983032227, 4.3497209548950195, 3.0534534454345703, 2.690059185028076, 6.613130569458008, 4.4138264656066895, 5.1645355224609375, 3.490408420562744, 4.516973972320557, 3.757352828979492, 5.656879425048828, 4.910928726196289, 4.807757377624512, 2.8691625595092773, 5.775211334228516, 5.5941972732543945, 5.70562744140625, 4.573566913604736, 5.7645416259765625, 4.660694122314453, 4.805885314941406, 4.754401206970215, 3.2646946907043457, 3.196096897125244, 4.028445720672607, 5.97401237487793, 3.388390064239502, 3.275313377380371, 5.854286193847656, 2.796947717666626, 3.7426180839538574, 4.729540824890137, 5.805950164794922, 5.713224411010742, 3.280177116394043, 5.1017279624938965, 5.160477638244629, 3.123961925506592, 3.221925735473633, 3.9158987998962402, 4.039768218994141, 4.631039619445801, 6.338306427001953, 2.8467037677764893, 6.615815162658691, 1.933623194694519, 5.7339582443237305, 3.5611119270324707, 3.3966639041900635, 4.811005592346191, 4.20467472076416, 4.693714618682861, 5.729742050170898, 4.373527526855469, 4.095049858093262, 4.860805511474609], "mean_td_error": 4.43076753616333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.915166854858398, "actor_loss": -3.931243896484375, "critic_loss": 0.985121488571167, "alpha_loss": -0.002974549774080515, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0002999999560415745, "target_entropy": -6.0, "policy_t": -0.015770040452480316, "mean_q": 0.018866879865527153, "max_q": 0.02348479814827442, "min_q": 0.014711182564496994}, "td_error": [3.647587537765503, 1.5071680545806885, 3.056028127670288, 2.885627031326294, 1.7059946060180664, 3.035045862197876, 1.948747158050537, 0.6330753564834595, 0.24618789553642273, 2.7982959747314453, 1.3611241579055786, 1.4115562438964844, 3.221841812133789, 2.301973581314087, 2.2599239349365234, 3.3325517177581787, 0.4868214428424835, 0.5567628145217896, 1.2324588298797607, 4.703082084655762, 1.7448091506958008, 1.613028883934021, 3.0208382606506348, 4.332435607910156, 2.724946975708008, 1.8178410530090332, 2.867976188659668, 3.943528175354004, 1.6943066120147705, 4.167907238006592, 3.6153876781463623, 0.5417155027389526, 3.2182137966156006, 2.3898978233337402, 2.9808902740478516, 3.5176572799682617, 3.925985336303711, 4.048109531402588, 3.8312301635742188, 2.8139243125915527, 0.996934711933136, 3.452683687210083, 5.606022357940674, 0.37844282388687134, 0.8406398296356201, 3.336775064468384, 2.5730514526367188, 2.374318838119507, 2.443263530731201, 3.813605308532715, 3.806926727294922, 2.4578075408935547, 3.345231533050537, 3.6676270961761475, 0.5725443959236145, 3.3892529010772705, 2.1102771759033203, 2.0497989654541016, 2.4127869606018066, 3.0245418548583984, 0.30620163679122925, 0.7642419338226318, 0.8486863970756531, 3.1571578979492188, 2.1244211196899414, 1.3975075483322144, 2.307701349258423, 1.73809814453125, 0.7593175172805786, 3.860929489135742, 2.6257853507995605, 3.2561659812927246, 1.8110613822937012, 2.7171573638916016, 2.0845916271209717, 2.363494396209717, 2.171290874481201, 0.6129549741744995, 3.2121286392211914, 2.7337896823883057, 3.39045786857605, 1.8344147205352783, 0.7656545042991638, 2.75057315826416, 2.8195509910583496, 3.5162720680236816], "mean_td_error": 2.4386587142944336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114253997802734, "actor_loss": -4.129581928253174, "critic_loss": 1.617875099182129, "alpha_loss": -0.003034275723621249, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0002999999560415745, "target_entropy": -6.0, "policy_t": 0.031410399824380875, "mean_q": 0.017666619271039963, "max_q": 0.02301967144012451, "min_q": 0.012946287170052528}, "td_error": [2.5452170372009277, 2.5297048091888428, 2.8802061080932617, 3.170987844467163, 2.8146443367004395, 2.2916722297668457, 3.5287904739379883, 3.654064655303955, 1.7884032726287842, 0.9488760232925415, 4.314449310302734, 2.8191943168640137, 2.6293435096740723, 2.6520211696624756, 1.7054970264434814, 1.6945250034332275, 3.3496577739715576, 2.3838727474212646, 2.8272476196289062, 1.8583486080169678, 4.477898597717285, 3.6992175579071045, 2.237001895904541, 3.2528903484344482, 2.7081098556518555, 2.5109615325927734, 0.1864071786403656, 3.6276135444641113, 1.356579303741455, 0.07186029851436615, 3.8899331092834473, 2.0584654808044434, 1.323089361190796, 1.650805115699768, 2.451793670654297, 3.1079201698303223, 3.3566198348999023, 2.3414039611816406, 2.2515833377838135, 1.7371364831924438, 3.6898651123046875, 4.401479721069336, 2.1522090435028076, 3.322561502456665, 3.7144598960876465, 0.720359206199646, 3.7886345386505127, 4.53105354309082, 3.9073805809020996, 3.252511501312256, 2.0134315490722656, 4.4512434005737305, 3.267742156982422, 0.9764056205749512, 2.9390716552734375, 4.728253364562988, 3.480889320373535, 5.14455509185791, 5.0176496505737305, 4.861772537231445, 2.6070687770843506, 3.0030972957611084, 3.242110252380371, 3.2831063270568848, 4.062147617340088, 2.564713954925537, 2.5275325775146484, 3.907723903656006, 3.1591997146606445, 1.5773714780807495, 2.482821464538574, 1.1613478660583496, 3.508373260498047, 4.154796123504639, 3.054459571838379, 3.9296860694885254, 3.8224782943725586, 2.9056384563446045, 2.5254712104797363, 1.7582051753997803, 2.5402512550354004, 2.1005327701568604, 4.264507293701172, 3.2876973152160645, 3.969179630279541, 2.8234314918518066], "mean_td_error": 2.898470878601074, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 488.51688284305897, "num_env_steps_trained_throughput_per_sec": 140.66669171150582, "timesteps_total": 2688, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 2490.777, "sample_time_ms": 1540.848, "load_time_ms": 0.526, "load_throughput": 490873.41, "learn_time_ms": 79.792, "learn_throughput": 3233.411, "synch_weights_time_ms": 16.695}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-26", "timestamp": 1700202986, "time_this_iter_s": 1.850438117980957, "time_total_s": 7.50648832321167, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.50648832321167, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 86.9, "ram_util_percent": 92.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047770500183105, "actor_loss": -4.070931911468506, "critic_loss": 3.841684341430664, "alpha_loss": -0.006028273608535528, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999612621963024, "target_entropy": -6.0, "policy_t": 0.013583093881607056, "mean_q": 0.035188939422369, "max_q": 0.041772276163101196, "min_q": 0.028772015124559402}, "td_error": [6.799598693847656, 6.613920211791992, 2.817841053009033, 4.525241374969482, 3.1329457759857178, 5.067580223083496, 4.609548091888428, 5.595771312713623, 4.332432746887207, 4.356443405151367, 6.3658342361450195, 4.667203426361084, 4.636533737182617, 6.224970817565918, 3.620185375213623, 4.592004299163818, 5.259206771850586, 4.164702415466309, 7.00642204284668, 6.034734725952148, 4.012990951538086, 1.815636157989502, 6.191956996917725, 4.072373390197754, 3.3281354904174805, 5.673893928527832, 3.426208972930908, 3.9435081481933594, 5.818689346313477, 4.825395584106445, 6.259914875030518, 4.612374782562256, 3.979217052459717, 3.399723529815674, 6.257925033569336, 4.30874490737915, 5.310587406158447, 6.0920209884643555, 5.0996623039245605, 3.238527774810791, 4.030552864074707, 5.432977199554443, 3.5514235496520996, 3.0948946475982666, 3.3324522972106934, 5.064273834228516, 2.7277843952178955, 5.040645599365234, 5.564221382141113, 5.1965203285217285, 4.4244537353515625, 6.147715091705322, 4.799469947814941, 3.0956919193267822, 4.612739086151123, 3.576408624649048, 2.572500228881836, 3.7404122352600098, 3.6657960414886475, 3.4904775619506836, 4.414093971252441, 2.7084975242614746, 5.049211502075195, 5.7045135498046875, 4.048067092895508, 5.047689437866211, 3.910996913909912, 4.599766731262207, 4.368959426879883, 4.8866376876831055, 5.866366386413574, 2.6207313537597656, 3.623281955718994, 3.610901355743408, 5.504104137420654, 4.969911575317383, 3.913848638534546, 6.103198528289795, 6.464381217956543, 4.294825553894043, 4.760031223297119, 6.130742073059082, 4.347052574157715, 3.6575875282287598, 4.934778213500977, 4.113285064697266], "mean_td_error": 4.591923713684082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090435028076172, "actor_loss": -4.119801044464111, "critic_loss": 1.061517357826233, "alpha_loss": -0.006053745746612549, "alpha_value": 0.99940025806427, "log_alpha_value": -0.0005999489221721888, "target_entropy": -6.0, "policy_t": 0.024401042610406876, "mean_q": 0.03476671129465103, "max_q": 0.04355520382523537, "min_q": 0.0280877947807312}, "td_error": [2.742556095123291, 2.743082284927368, 2.7486844062805176, 0.7688028216362, 1.9814159870147705, 4.92530632019043, 4.53722620010376, 0.9140625, 3.847367286682129, 2.214554786682129, 1.6222610473632812, 3.802868604660034, 0.5638920664787292, 1.6701242923736572, 3.193796396255493, 2.4958221912384033, 0.5483629703521729, 2.8220741748809814, 3.101410150527954, 3.015402317047119, 1.4321093559265137, 2.8906874656677246, 3.4658961296081543, 2.0660464763641357, 2.2759363651275635, 2.834822177886963, 1.792973279953003, 3.965318202972412, 2.4505553245544434, 1.8801500797271729, 5.166800498962402, 2.485922336578369, 2.798243522644043, 2.9917426109313965, 2.1970744132995605, 1.570488691329956, 2.621461868286133, 3.0624427795410156, 4.534542083740234, 4.51490592956543, 3.2817466259002686, 2.378343105316162, 3.0649638175964355, 1.6341354846954346, 2.929202079772949, 1.6145596504211426, 1.117737889289856, 2.144327402114868, 3.8028953075408936, 2.3517215251922607, 3.45530366897583, 2.9180233478546143, 1.8926489353179932, 4.014748573303223, 0.6319955587387085, 2.3406176567077637, 2.6157946586608887, 4.443793296813965, 0.9112740159034729, 2.7684895992279053, 1.2881313562393188, 2.0228960514068604, 3.1322574615478516, 1.871424913406372, 2.4498648643493652, 3.0984573364257812, 4.778922080993652, 2.9964327812194824, 0.325288325548172, 2.62790846824646, 2.935058116912842, 2.888303518295288, 2.125710964202881, 2.2880334854125977, 3.0010621547698975, 0.8276740908622742, 3.798492908477783, 2.8007888793945312, 3.9110302925109863, 2.1810476779937744, 2.873116970062256, 2.2045657634735107, 4.029790878295898, 2.422121286392212, 3.091897964477539, 2.5076870918273926], "mean_td_error": 2.6284592151641846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13264274597168, "actor_loss": -4.161250114440918, "critic_loss": 1.151467204093933, "alpha_loss": -0.006080086342990398, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000493885949254, "target_entropy": -6.0, "policy_t": 0.006241598632186651, "mean_q": 0.032029200345277786, "max_q": 0.03758906573057175, "min_q": 0.024152474477887154}, "td_error": [2.1507492065429688, 2.710822820663452, 4.52940559387207, 2.3491616249084473, 2.4547319412231445, 2.827126979827881, 0.32314878702163696, 3.1649255752563477, 1.2860345840454102, 1.8754653930664062, 4.586302757263184, 3.360593795776367, 0.6780319213867188, 0.6906964778900146, 4.767148971557617, 3.1251134872436523, 1.732895851135254, 3.1799168586730957, 2.8293328285217285, 3.559164047241211, 3.5693745613098145, 3.1219840049743652, 3.572554588317871, 1.2104907035827637, 2.764277458190918, 2.549816846847534, 1.227520227432251, 2.3542158603668213, 4.352004051208496, 2.8619089126586914, 2.5639617443084717, 3.3878860473632812, 2.225587844848633, 3.0454282760620117, 1.7200183868408203, 2.183427333831787, 3.9382402896881104, 3.312875747680664, 2.009230375289917, 2.7998580932617188, 2.3155083656311035, 4.830033302307129, 3.20650577545166, 5.210638046264648, 3.4171032905578613, 2.1354339122772217, 1.957780361175537, 2.982344150543213, 3.354154586791992, 4.406582832336426, 0.9052536487579346, 4.7350053787231445, 3.015475034713745, 1.8944330215454102, 2.3402976989746094, 2.1254591941833496, 3.472740650177002, 2.4198484420776367, 2.3414578437805176, 3.737743377685547, 1.297102689743042, 0.8551074266433716, 4.29768180847168, 4.020960807800293, 2.0051894187927246, 3.491286277770996, 4.418633460998535, 2.77760910987854, 2.4825785160064697, 2.6600513458251953, 3.6607885360717773, 0.6948172450065613, 2.6316652297973633, 1.084740161895752, 1.8289508819580078, 3.049027681350708, 4.12179708480835, 0.32468998432159424, 2.10219144821167, 2.5023937225341797, 2.288456439971924, 2.5338544845581055, 3.150761604309082, 3.1681361198425293, 0.8109815120697021, 3.8030855655670166], "mean_td_error": 2.718811273574829, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 483.55901423914815, "num_env_steps_trained_throughput_per_sec": 139.2390911536833, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 2331.304, "sample_time_ms": 1477.314, "load_time_ms": 0.528, "load_throughput": 488326.007, "learn_time_ms": 74.77, "learn_throughput": 3450.587, "synch_weights_time_ms": 15.943}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-28", "timestamp": 1700202988, "time_this_iter_s": 1.871556043624878, "time_total_s": 9.378044366836548, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510b06280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 9.378044366836548, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 63.96666666666667, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109678268432617, "actor_loss": -4.144061088562012, "critic_loss": 3.889294147491455, "alpha_loss": -0.009097669273614883, "alpha_value": 0.9991005063056946, "log_alpha_value": -0.0008998970733955503, "target_entropy": -6.0, "policy_t": 0.02178386226296425, "mean_q": 0.050523675978183746, "max_q": 0.06011967733502388, "min_q": 0.04288168624043465}, "td_error": [4.402129650115967, 5.782134056091309, 4.94276237487793, 3.903306245803833, 5.788784027099609, 5.896368503570557, 4.988673686981201, 4.386355400085449, 4.014850616455078, 4.919959545135498, 3.2324252128601074, 4.192229270935059, 5.097526550292969, 3.1258113384246826, 4.047494411468506, 5.902425765991211, 4.381373405456543, 6.693465232849121, 4.0164713859558105, 5.8566131591796875, 4.885989189147949, 5.561548233032227, 4.282159805297852, 1.9955344200134277, 4.904074192047119, 4.419456481933594, 4.7044830322265625, 3.9120395183563232, 2.814927577972412, 6.383187294006348, 4.803155422210693, 6.36086368560791, 3.110304117202759, 2.6163363456726074, 4.472334861755371, 3.5198585987091064, 4.889514923095703, 3.3291306495666504, 3.570584774017334, 5.379378795623779, 5.452662944793701, 4.769291877746582, 5.015267372131348, 4.7156476974487305, 5.727476596832275, 6.835394859313965, 7.172569274902344, 5.389223098754883, 3.5729427337646484, 5.632142543792725, 4.759809494018555, 2.7098209857940674, 5.686501502990723, 5.066074848175049, 6.497594833374023, 5.168107986450195, 4.749341011047363, 5.624460220336914, 6.520674705505371, 4.656952381134033, 5.414916038513184, 2.752175807952881, 5.914443492889404, 5.736330509185791, 4.96864128112793, 4.486354827880859, 3.831460475921631, 3.0009002685546875, 4.896809101104736, 5.67804479598999, 4.877097129821777, 5.519927501678467, 5.425156593322754, 4.859470367431641, 4.776638031005859, 5.652378082275391, 6.201674938201904, 2.5874974727630615, 4.0884552001953125, 5.589428901672363, 4.4710845947265625, 3.376807689666748, 4.880312919616699, 5.6524763107299805, 3.461507797241211, 5.274430274963379], "mean_td_error": 4.774213790893555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03614616394043, "actor_loss": -4.080733299255371, "critic_loss": 1.0632953643798828, "alpha_loss": -0.009033158421516418, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009000624413602054, "target_entropy": -6.0, "policy_t": -0.01332614105194807, "mean_q": 0.05284798890352249, "max_q": 0.06750569492578506, "min_q": 0.0391390360891819}, "td_error": [2.009364604949951, 3.7777154445648193, 1.021012783050537, 3.4860363006591797, 4.231539249420166, 5.434027194976807, 3.222792625427246, 2.7619142532348633, 1.1412076950073242, 2.668999195098877, 2.658039093017578, 2.714360237121582, 1.4115314483642578, 3.975864887237549, 2.2285377979278564, 2.0466809272766113, 4.889111518859863, 1.001103162765503, 4.020470142364502, 3.6520886421203613, 4.196200370788574, 3.348360538482666, 0.5490480661392212, 0.42455941438674927, 2.8546247482299805, 3.6468005180358887, 1.854964017868042, 2.5195460319519043, 2.372647762298584, 2.9248995780944824, 0.8620918989181519, 2.5515475273132324, 3.4888267517089844, 3.254324197769165, 3.785853385925293, 1.6464793682098389, 0.08127059787511826, 3.528261184692383, 1.0745314359664917, 2.929483413696289, 3.2964890003204346, 1.8572442531585693, 1.1918318271636963, 2.2770705223083496, 2.6742730140686035, 2.1880478858947754, 3.5919504165649414, 2.684875011444092, 1.9837837219238281, 3.562370777130127, 2.24715518951416, 2.2018234729766846, 0.16963037848472595, 1.5837883949279785, 2.689664363861084, 3.661609649658203, 2.843048095703125, 3.2538890838623047, 3.5076217651367188, 4.167991638183594, 1.8095415830612183, 4.03005313873291, 3.1193389892578125, 3.236060619354248, 4.744524955749512, 3.6201539039611816, 3.2016663551330566, 3.374983310699463, 2.6164209842681885, 2.239562511444092, 1.0541002750396729, 1.2936674356460571, 1.6385165452957153, 1.590814471244812, 1.024464726448059, 1.6500314474105835, 3.7692694664001465, 1.1335177421569824, 2.1215133666992188, 1.5518275499343872, 3.1427478790283203, 1.2805876731872559, 3.3240833282470703, 1.94601309299469, 3.343069076538086, 4.298642158508301], "mean_td_error": 2.6050703525543213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.951028823852539, "actor_loss": -3.994312286376953, "critic_loss": 1.062472939491272, "alpha_loss": -0.008957255631685257, "alpha_value": 0.9991002678871155, "log_alpha_value": -0.0009001335129141808, "target_entropy": -6.0, "policy_t": 0.004205592907965183, "mean_q": 0.04710802808403969, "max_q": 0.05833736062049866, "min_q": 0.03717094659805298}, "td_error": [0.9271079301834106, 4.710875034332275, 3.061154842376709, 2.465362071990967, 2.546114921569824, 3.6400017738342285, 1.9477968215942383, 3.2337703704833984, 1.2675504684448242, 2.0228023529052734, 3.6218161582946777, 1.4285714626312256, 0.27622485160827637, 2.185482978820801, 2.4084746837615967, 3.2328145503997803, 3.6265053749084473, 4.773146629333496, 0.05432271957397461, 3.0011003017425537, 2.2797718048095703, 1.0101397037506104, 3.3317129611968994, 2.8944458961486816, 4.294427871704102, 1.239835262298584, 0.048492059111595154, 1.9957081079483032, 1.6823241710662842, 3.162937879562378, 2.008958339691162, 3.1468374729156494, 3.3356752395629883, 4.076255798339844, 4.052134037017822, 2.4304919242858887, 2.254624128341675, 3.6440505981445312, 3.2721500396728516, 1.639933705329895, 2.39864444732666, 1.0820688009262085, 4.39671516418457, 3.4325947761535645, 3.300191640853882, 0.5302110910415649, 1.761603832244873, 4.653304100036621, 2.4268436431884766, 3.3603463172912598, 1.7162970304489136, 3.5836002826690674, 1.734595537185669, 2.330376148223877, 2.117567539215088, 2.127999782562256, 2.954425811767578, 2.1562323570251465, 3.053133010864258, 1.777065634727478, 2.444486141204834, 3.0586628913879395, 4.372425079345703, 1.5763462781906128, 3.490783214569092, 1.2639446258544922, 3.0144059658050537, 2.1657166481018066, 2.7353529930114746, 3.155210018157959, 2.527749538421631, 1.984860897064209, 2.4193460941314697, 1.6261911392211914, 1.7198739051818848, 0.8789370059967041, 2.183450698852539, 3.445180892944336, 2.5981898307800293, 3.8373618125915527, 1.0995192527770996, 1.6423754692077637, 0.07022853195667267, 1.3925974369049072, 2.681267023086548, 4.5130205154418945], "mean_td_error": 2.500270128250122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 476.60991975073864, "num_env_steps_trained_throughput_per_sec": 137.23812421394038, "timesteps_total": 4480, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 2241.023, "sample_time_ms": 1441.622, "load_time_ms": 0.528, "load_throughput": 489098.5, "learn_time_ms": 72.172, "learn_throughput": 3574.782, "synch_weights_time_ms": 15.944}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 1032, "last_target_update_ts": 4480, "num_target_updates": 4}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-30", "timestamp": 1700202990, "time_this_iter_s": 1.894547939300537, "time_total_s": 11.272592306137085, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.272592306137085, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 65.63333333333333, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10122013092041, "actor_loss": -4.148139953613281, "critic_loss": 3.735485553741455, "alpha_loss": -0.012120410799980164, "alpha_value": 0.9988008141517639, "log_alpha_value": -0.0011998957488685846, "target_entropy": -6.0, "policy_t": -0.04003291204571724, "mean_q": 0.06767876446247101, "max_q": 0.08261443674564362, "min_q": 0.05672897398471832}, "td_error": [4.288315773010254, 5.121222496032715, 3.055081844329834, 3.5322694778442383, 6.226513862609863, 5.086538314819336, 2.861830234527588, 5.288494110107422, 3.685852527618408, 3.8764894008636475, 2.2054615020751953, 5.735583782196045, 3.7155673503875732, 4.700753211975098, 3.407411575317383, 3.6191654205322266, 5.769147872924805, 4.510587692260742, 5.5996809005737305, 3.081017017364502, 3.36706280708313, 5.673469066619873, 4.369794845581055, 5.106070041656494, 4.588486194610596, 4.4279398918151855, 4.837337493896484, 6.492581844329834, 4.459700107574463, 4.490081310272217, 6.526417255401611, 4.76826810836792, 4.646143913269043, 3.554710865020752, 4.292464256286621, 5.734575271606445, 5.845183849334717, 4.174481391906738, 4.819269180297852, 4.101849555969238, 6.290513038635254, 4.194526672363281, 5.462669849395752, 4.040526390075684, 4.267825603485107, 4.374510765075684, 5.595292568206787, 5.349679946899414, 3.7938148975372314, 5.33793830871582, 3.216343879699707, 4.604299545288086, 4.134138107299805, 3.174398422241211, 5.390440464019775, 2.6040964126586914, 5.399234294891357, 4.033725738525391, 4.5560503005981445, 5.207842826843262, 3.7214670181274414, 5.240320682525635, 4.418717861175537, 4.382270812988281, 4.071038246154785, 2.638805389404297, 4.295088768005371, 3.69205904006958, 4.785545349121094, 4.97212028503418, 4.144142150878906, 2.9771957397460938, 5.772012710571289, 5.4915008544921875, 5.63639497756958, 3.9340453147888184, 4.579350471496582, 4.114003658294678, 6.830682277679443, 6.050332546234131, 5.099921226501465, 4.5388641357421875, 5.079192161560059, 4.900382041931152, 4.036287784576416, 3.4010634422302246], "mean_td_error": 4.552018165588379, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139623641967773, "actor_loss": -4.199043273925781, "critic_loss": 1.0430855751037598, "alpha_loss": -0.01216949988156557, "alpha_value": 0.99880051612854, "log_alpha_value": -0.0012001923751085997, "target_entropy": -6.0, "policy_t": 0.01103584561496973, "mean_q": 0.06925991177558899, "max_q": 0.08732852339744568, "min_q": 0.055370062589645386}, "td_error": [3.6332640647888184, 2.1416730880737305, 3.312831163406372, 3.4750466346740723, 3.4618301391601562, 3.713655471801758, 1.1451940536499023, 3.6290111541748047, 3.937166452407837, 3.0438733100891113, 1.7100621461868286, 3.8618314266204834, 2.6709213256835938, 0.5136795043945312, 2.469137191772461, 3.7264513969421387, 1.6753194332122803, 4.570569038391113, 2.992438316345215, 1.2684547901153564, 3.928802013397217, 1.5331695079803467, 1.7315874099731445, 1.690124750137329, 2.397160768508911, 3.961928367614746, 2.3343777656555176, 1.2985610961914062, 4.51751184463501, 2.452777862548828, 1.7486838102340698, 0.968949556350708, 2.2065327167510986, 1.5083889961242676, 2.6612229347229004, 2.7776527404785156, 0.5771925449371338, 0.4099828600883484, 2.918867349624634, 2.371084690093994, 2.677135705947876, 0.07046093046665192, 2.7573423385620117, 2.6910386085510254, 1.0025538206100464, 3.0851316452026367, 0.9048123359680176, 2.498969078063965, 2.59934139251709, 2.4979214668273926, 1.3488943576812744, 3.7901628017425537, 2.187490940093994, 2.45596981048584, 3.2005014419555664, 4.187539100646973, 2.0955862998962402, 2.3537960052490234, 1.304145097732544, 2.4591903686523438, 2.1161999702453613, 1.8421108722686768, 1.4354054927825928, 4.267167091369629, 2.2108094692230225, 4.619298934936523, 4.851324081420898, 2.658000946044922, 3.5978188514709473, 1.2740240097045898, 4.78763484954834, 3.4629039764404297, 4.223180770874023, 2.153856039047241, 3.1246113777160645, 3.3366122245788574, 2.1307625770568848, 2.5661439895629883, 3.082432746887207, 3.8318734169006348, 0.20262381434440613, 1.3080062866210938, 3.069788932800293, 3.9813899993896484, 3.982506275177002, 2.1518564224243164], "mean_td_error": 2.597480297088623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0960054397583, "actor_loss": -4.152090072631836, "critic_loss": 1.0213918685913086, "alpha_loss": -0.012115303426980972, "alpha_value": 0.9988006949424744, "log_alpha_value": -0.0012000096030533314, "target_entropy": -6.0, "policy_t": -0.026651054620742798, "mean_q": 0.06136041879653931, "max_q": 0.07389175891876221, "min_q": 0.049562182277441025}, "td_error": [3.1131088733673096, 4.277822494506836, 2.5279970169067383, 1.7100775241851807, 1.8220500946044922, 1.9386342763900757, 3.1439437866210938, 3.726776123046875, 1.2104206085205078, 4.756678581237793, 2.6476571559906006, 2.770689010620117, 1.8127540349960327, 4.283843040466309, 3.0866856575012207, 0.9083958864212036, 1.3529956340789795, 3.6019797325134277, 1.5401499271392822, 3.8017921447753906, 2.7133119106292725, 2.3079380989074707, 2.3491716384887695, 2.499687671661377, 3.191688060760498, 3.64406681060791, 3.575049877166748, 4.965940952301025, 3.992828369140625, 3.1298670768737793, 2.8288726806640625, 2.8371739387512207, 3.899698257446289, 1.8487544059753418, 3.2753567695617676, 0.5098329782485962, 2.241011381149292, 1.2546720504760742, 3.46938419342041, 2.000356674194336, 1.4370834827423096, 4.0217461585998535, 2.1985549926757812, 2.5928173065185547, 3.357785224914551, 1.3192750215530396, 3.5485076904296875, 2.734520196914673, 3.1337575912475586, 4.242928504943848, 1.7608981132507324, 2.0684456825256348, 4.164475917816162, 1.7893903255462646, 5.442928314208984, 2.20098876953125, 0.5502315759658813, 2.7678332328796387, 3.167870044708252, 2.698399782180786, 0.14907638728618622, 2.7780961990356445, 2.993929862976074, 3.976125478744507, 2.0690267086029053, 1.8218965530395508, 2.3201310634613037, 4.5488996505737305, 2.978618621826172, 1.3431763648986816, 4.185759544372559, 1.3264672756195068, 1.336214303970337, 2.7898449897766113, 2.822824239730835, 2.028017520904541, 2.710402250289917, 1.579657793045044, 0.5345194935798645, 0.7501993179321289, 2.0022406578063965, 3.4254891872406006, 3.1338272094726562, 4.11650276184082, 2.9752132892608643, 3.2453370094299316], "mean_td_error": 2.6710355281829834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 398.4242802307536, "num_env_steps_trained_throughput_per_sec": 114.72484854858754, "timesteps_total": 5376, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 2242.325, "sample_time_ms": 1445.737, "load_time_ms": 0.524, "load_throughput": 492369.839, "learn_time_ms": 70.311, "learn_throughput": 3669.423, "synch_weights_time_ms": 17.149}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-32", "timestamp": 1700202992, "time_this_iter_s": 2.2619922161102295, "time_total_s": 13.534584522247314, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.534584522247314, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 70.36666666666666, "ram_util_percent": 92.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118070602416992, "actor_loss": -4.179091930389404, "critic_loss": 3.659512519836426, "alpha_loss": -0.015176295302808285, "alpha_value": 0.998501181602478, "log_alpha_value": -0.0014999198028817773, "target_entropy": -6.0, "policy_t": -0.013253270648419857, "mean_q": 0.08555622398853302, "max_q": 0.10648392140865326, "min_q": 0.07397512346506119}, "td_error": [3.6997220516204834, 4.459343910217285, 2.554093837738037, 4.871616840362549, 5.1019086837768555, 5.024716854095459, 6.404203414916992, 5.388607025146484, 4.534832000732422, 5.056081295013428, 4.0017571449279785, 2.8977701663970947, 4.1046953201293945, 2.776540756225586, 3.1392428874969482, 5.3198041915893555, 3.9285755157470703, 5.550852298736572, 2.7792482376098633, 6.84712028503418, 3.6096394062042236, 4.0704450607299805, 4.942321300506592, 3.111283302307129, 3.9390223026275635, 4.665569305419922, 3.2286195755004883, 4.029917240142822, 5.650017738342285, 4.98967170715332, 3.9227514266967773, 3.753328323364258, 3.60530424118042, 5.149460792541504, 5.679257392883301, 4.121980667114258, 6.470615386962891, 3.2766523361206055, 6.260689735412598, 5.5580339431762695, 2.9519221782684326, 3.2480435371398926, 4.801527976989746, 5.6435089111328125, 5.152604103088379, 4.114681243896484, 3.897426128387451, 3.1356334686279297, 5.853248596191406, 4.703154563903809, 3.085775375366211, 5.456536293029785, 4.7207441329956055, 5.150165557861328, 4.912854194641113, 5.480024337768555, 6.108743190765381, 6.310703277587891, 5.022603988647461, 3.399932861328125, 3.9123024940490723, 4.177618026733398, 5.162265777587891, 6.750241279602051, 2.4500973224639893, 5.068482398986816, 5.231451988220215, 5.507045745849609, 7.294708251953125, 4.062222480773926, 6.9365410804748535, 5.148658752441406, 2.3937883377075195, 3.948436975479126, 4.891864776611328, 5.4274115562438965, 3.2977070808410645, 4.686578750610352, 3.5579957962036133, 4.527719020843506, 5.9298882484436035, 3.485377788543701, 4.900679588317871, 3.7266013622283936, 5.747321128845215, 2.3138985633850098], "mean_td_error": 4.560023784637451, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0691556930542, "actor_loss": -4.146480083465576, "critic_loss": 0.9767872095108032, "alpha_loss": -0.015108386054635048, "alpha_value": 0.998500645160675, "log_alpha_value": -0.0015004619490355253, "target_entropy": -6.0, "policy_t": 0.013495665974915028, "mean_q": 0.09022761881351471, "max_q": 0.11110362410545349, "min_q": 0.07088886201381683}, "td_error": [1.8030047416687012, 3.393159866333008, 2.5733065605163574, 1.4572821855545044, 2.258882522583008, 1.0797133445739746, 3.421271324157715, 2.037792682647705, 3.9739370346069336, 0.13243389129638672, 3.615175724029541, 1.7526189088821411, 1.8259129524230957, 1.878324031829834, 4.41090202331543, 3.4191389083862305, 3.404390811920166, 3.9408175945281982, 4.551241874694824, 2.2070462703704834, 2.721586227416992, 2.0235214233398438, 1.9839011430740356, 2.7790236473083496, 0.22939418256282806, 0.45796242356300354, 2.223879337310791, 3.358018398284912, 2.465562343597412, 3.1737890243530273, 2.964329719543457, 1.0934898853302002, 0.6374101638793945, 2.280367374420166, 2.5044822692871094, 3.444981575012207, 3.4654393196105957, 1.6707379817962646, 2.0011558532714844, 3.318844795227051, 3.7257137298583984, 3.698730945587158, 3.8644676208496094, 1.5337755680084229, 3.3577213287353516, 1.9217643737792969, 0.8353628516197205, 2.388392448425293, 1.7258458137512207, 2.381190538406372, 0.8374857902526855, 2.356752872467041, 2.446784019470215, 3.8997325897216797, 3.2995033264160156, 1.7410565614700317, 2.727980852127075, 2.875062942504883, 0.5520195960998535, 1.1086246967315674, 2.0367069244384766, 3.9406111240386963, 2.104079008102417, 2.1145877838134766, 2.2683238983154297, 2.7296032905578613, 1.2935572862625122, 3.0512070655822754, 4.065181255340576, 3.3421998023986816, 1.4762189388275146, 2.7219462394714355, 4.416791915893555, 2.8783369064331055, 1.5911474227905273, 2.1358351707458496, 3.6294493675231934, 3.628520965576172, 2.0355477333068848, 1.895392656326294, 2.2335355281829834, 2.487161636352539, 3.167543411254883, 1.8583344221115112, 3.4745936393737793, 1.8097832202911377], "mean_td_error": 2.4837021827697754, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087895393371582, "actor_loss": -4.160948276519775, "critic_loss": 0.9789444208145142, "alpha_loss": -0.015131442807614803, "alpha_value": 0.998501181602478, "log_alpha_value": -0.0014999604318290949, "target_entropy": -6.0, "policy_t": -0.024977201595902443, "mean_q": 0.08009367436170578, "max_q": 0.09764035046100616, "min_q": 0.06673943996429443}, "td_error": [3.0959036350250244, 2.932445764541626, 2.4143781661987305, 2.939990282058716, 2.888171911239624, 3.621206760406494, 3.3685386180877686, 4.958242893218994, 2.1865687370300293, 2.6099085807800293, 2.0664944648742676, 2.6169843673706055, 4.076283931732178, 2.8424901962280273, 2.03170108795166, 2.0386786460876465, 4.269745826721191, 3.8830151557922363, 2.6745738983154297, 2.011129856109619, 3.9786252975463867, 2.711949110031128, 3.810750961303711, 3.356701374053955, 2.09686279296875, 1.8083431720733643, 3.6375489234924316, 2.496877670288086, 4.283993721008301, 2.453747510910034, 1.4194674491882324, 2.428410053253174, 2.4546432495117188, 4.2463226318359375, 1.688340663909912, 4.1936140060424805, 1.439530849456787, 3.306840658187866, 2.9477381706237793, 1.9955692291259766, 3.343475341796875, 1.27655029296875, 2.120929479598999, 1.1879342794418335, 1.4509354829788208, 1.724369764328003, 1.5582051277160645, 3.0560922622680664, 2.044052839279175, 3.6327037811279297, 1.7948622703552246, 3.0889856815338135, 0.07155653834342957, 4.409076690673828, 0.20124706625938416, 2.6726980209350586, 3.1392335891723633, 2.4246883392333984, 3.1001768112182617, 1.1701781749725342, 2.022611379623413, 2.717095375061035, 2.373049736022949, 1.5966432094573975, 1.0536870956420898, 2.1522269248962402, 1.207057237625122, 3.073728322982788, 4.396461009979248, 2.249903678894043, 1.0015473365783691, 2.8471970558166504, 2.339935779571533, 3.705747127532959, 3.1185317039489746, 2.404749870300293, 3.083012580871582, 4.589068412780762, 0.2455318421125412, 1.856184959411621, 2.5487427711486816, 3.1486897468566895, 1.494255781173706, 1.5574593544006348, 2.840062141418457, 1.340465784072876], "mean_td_error": 2.5664408206939697, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 491.756149116844, "num_env_steps_trained_throughput_per_sec": 141.59942686623413, "timesteps_total": 6272, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 2182.278, "sample_time_ms": 1417.992, "load_time_ms": 0.522, "load_throughput": 494424.504, "learn_time_ms": 69.482, "learn_throughput": 3713.166, "synch_weights_time_ms": 16.756}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 1548, "last_target_update_ts": 6272, "num_target_updates": 6}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-34", "timestamp": 1700202994, "time_this_iter_s": 1.8398587703704834, "time_total_s": 15.374443292617798, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.374443292617798, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.23333333333333, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111268043518066, "actor_loss": -4.1874566078186035, "critic_loss": 3.4432532787323, "alpha_loss": -0.018200110644102097, "alpha_value": 0.9982016086578369, "log_alpha_value": -0.001799982856027782, "target_entropy": -6.0, "policy_t": -0.050175443291664124, "mean_q": 0.1062426045536995, "max_q": 0.14054830372333527, "min_q": 0.08654333651065826}, "td_error": [3.9201555252075195, 4.203972816467285, 5.66436767578125, 4.627012252807617, 4.394159317016602, 4.471933841705322, 3.7868576049804688, 4.302854537963867, 5.902072906494141, 4.859684944152832, 4.473162651062012, 3.204864501953125, 4.319377422332764, 5.248619079589844, 4.62470006942749, 4.1329240798950195, 3.95418643951416, 4.276883602142334, 4.080170631408691, 5.684896469116211, 5.0817718505859375, 5.394596576690674, 3.1572494506835938, 3.1008148193359375, 5.70723819732666, 3.7794241905212402, 2.9314050674438477, 3.071850538253784, 5.436476707458496, 3.6803641319274902, 5.037487983703613, 4.051874160766602, 3.7600302696228027, 4.970092296600342, 4.8046956062316895, 4.492420673370361, 2.379216194152832, 2.1965861320495605, 4.702798843383789, 4.719727039337158, 3.7308754920959473, 1.9707454442977905, 4.707494735717773, 4.093311786651611, 5.023693084716797, 5.458044052124023, 3.6442065238952637, 3.1355602741241455, 3.681889057159424, 3.256138324737549, 4.695713043212891, 4.574772834777832, 3.780210018157959, 4.664244651794434, 4.596050262451172, 3.166205883026123, 4.406630516052246, 5.451321601867676, 3.1795969009399414, 5.463448524475098, 3.211493492126465, 4.958340644836426, 5.890780448913574, 4.413046836853027, 5.358756065368652, 4.604009628295898, 3.904170513153076, 3.3925845623016357, 5.200750827789307, 4.887904167175293, 3.1190075874328613, 5.390915870666504, 4.289848804473877, 5.034763336181641, 5.191277503967285, 5.312434196472168, 3.8631772994995117, 4.5044097900390625, 3.919422149658203, 3.1436691284179688, 4.042912483215332, 5.804867744445801, 4.346378326416016, 3.8009684085845947, 3.06137752532959, 5.292107105255127], "mean_td_error": 4.316378116607666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.009374618530273, "actor_loss": -4.104835510253906, "critic_loss": 0.9737987518310547, "alpha_loss": -0.018024126067757607, "alpha_value": 0.9982008934020996, "log_alpha_value": -0.0018007246544584632, "target_entropy": -6.0, "policy_t": 0.012351702898740768, "mean_q": 0.11250890791416168, "max_q": 0.14257210493087769, "min_q": 0.08402443677186966}, "td_error": [1.540664792060852, 3.1108646392822266, 2.9659485816955566, 3.0838775634765625, 3.140496253967285, 2.7030222415924072, 3.181328296661377, 3.5045762062072754, 1.0134704113006592, 1.8834439516067505, 2.122992992401123, 1.8980680704116821, 2.482077121734619, 2.121232032775879, 2.5903801918029785, 2.0104899406433105, 0.06317389011383057, 2.0130438804626465, 2.9997220039367676, 2.7892942428588867, 3.65919828414917, 0.7059661149978638, 1.7886607646942139, 1.9600586891174316, 2.488070011138916, 4.603137969970703, 2.165130853652954, 1.619321584701538, 1.4847023487091064, 2.400270938873291, 3.623228073120117, 3.6724448204040527, 2.3082103729248047, 3.702849864959717, 0.09747424721717834, 3.5674784183502197, 2.591796398162842, 1.3481358289718628, 3.97343111038208, 2.129044532775879, 1.0484569072723389, 1.8956520557403564, 3.8764567375183105, 3.0425186157226562, 3.255321979522705, 2.484009265899658, 1.9502537250518799, 1.172614336013794, 4.110895156860352, 3.203589916229248, 1.8202406167984009, 1.3174114227294922, 1.817866325378418, 1.4008467197418213, 2.381418228149414, 2.3317208290100098, 2.447685718536377, 2.6665515899658203, 1.3798468112945557, 2.6947736740112305, 3.152886390686035, 2.5699315071105957, 3.4414634704589844, 2.032376766204834, 2.4284281730651855, 2.2969107627868652, 2.0644009113311768, 2.9808502197265625, 2.6501986980438232, 3.265044927597046, 4.061761856079102, 3.5215678215026855, 1.0759131908416748, 1.0364035367965698, 3.2117559909820557, 2.6274447441101074, 2.008410692214966, 3.344601631164551, 2.8883705139160156, 2.0253210067749023, 2.5160701274871826, 1.6218717098236084, 0.881732702255249, 1.9059995412826538, 2.6593518257141113, 5.335850715637207], "mean_td_error": 2.4536025524139404, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132810592651367, "actor_loss": -4.222071170806885, "critic_loss": 0.9557977914810181, "alpha_loss": -0.018238535150885582, "alpha_value": 0.9982016682624817, "log_alpha_value": -0.0017999481642618775, "target_entropy": -6.0, "policy_t": -0.012847973965108395, "mean_q": 0.09656181186437607, "max_q": 0.11731300503015518, "min_q": 0.08015301823616028}, "td_error": [3.913315773010254, 2.2817835807800293, 4.252228736877441, 0.6973322629928589, 2.711817502975464, 2.5563840866088867, 3.2102890014648438, 3.6009464263916016, 3.364197254180908, 3.334407329559326, 0.6729530096054077, 1.833376407623291, 2.239105224609375, 4.601919174194336, 2.105518341064453, 2.582350254058838, 2.877389907836914, 3.2340011596679688, 0.9849308729171753, 0.5171958804130554, 2.0004355907440186, 3.5445096492767334, 1.715298056602478, 2.2762508392333984, 4.202848434448242, 2.849041223526001, 2.754244327545166, 3.290408134460449, 3.3504161834716797, 2.822768211364746, 2.656787157058716, 1.262967586517334, 1.4658927917480469, 4.0305047035217285, 0.9423435926437378, 0.554651141166687, 2.4267735481262207, 2.8012032508850098, 2.0010533332824707, 3.2054431438446045, 1.6136713027954102, 4.515911102294922, 3.875661849975586, 2.0139646530151367, 2.4073634147644043, 3.25008487701416, 4.888811111450195, 1.7576984167099, 2.9398579597473145, 0.8607698678970337, 0.8410067558288574, 1.7489054203033447, 3.6159911155700684, 1.7801501750946045, 3.615044593811035, 3.8914167881011963, 0.8998546600341797, 1.6219596862792969, 3.2436094284057617, 0.10609056800603867, 1.3168706893920898, 3.272106647491455, 3.058945655822754, 1.6905019283294678, 1.9571635723114014, 2.467923641204834, 1.7597581148147583, 2.4539222717285156, 2.8283557891845703, 1.7127190828323364, 0.8672099113464355, 9.172582626342773, 2.9392147064208984, 2.5846261978149414, 3.5085535049438477, 1.0245723724365234, 3.426365852355957, 2.6012749671936035, 3.5587635040283203, 1.1590769290924072, 2.0771045684814453, 3.5420382022857666, 2.6782045364379883, 3.090179920196533, 1.0758354663848877, 1.7539637088775635], "mean_td_error": 2.5440807342529297, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 461.27572779783924, "num_env_steps_trained_throughput_per_sec": 132.82269840607424, "timesteps_total": 7168, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2152.293, "sample_time_ms": 1413.903, "load_time_ms": 0.525, "load_throughput": 491430.714, "learn_time_ms": 68.77, "learn_throughput": 3751.651, "synch_weights_time_ms": 16.37}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-36", "timestamp": 1700202996, "time_this_iter_s": 1.9593188762664795, "time_total_s": 17.333762168884277, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510b06280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.333762168884277, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 92.6, "ram_util_percent": 92.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066584587097168, "actor_loss": -4.159904479980469, "critic_loss": 3.5127077102661133, "alpha_loss": -0.021140456199645996, "alpha_value": 0.9979021549224854, "log_alpha_value": -0.002100062556564808, "target_entropy": -6.0, "policy_t": 0.01585293933749199, "mean_q": 0.12701423466205597, "max_q": 0.15810784697532654, "min_q": 0.10399697721004486}, "td_error": [2.581523895263672, 4.073728084564209, 4.010026931762695, 4.9665069580078125, 6.666311740875244, 4.443196773529053, 5.094432830810547, 4.189388751983643, 4.947439193725586, 4.845130920410156, 4.137343406677246, 5.098346710205078, 3.5078325271606445, 3.925969123840332, 6.073758125305176, 4.03697395324707, 4.277252674102783, 2.322103977203369, 5.653972148895264, 3.1802785396575928, 3.8998236656188965, 4.212019920349121, 2.1292691230773926, 4.8371076583862305, 4.929808616638184, 3.882901191711426, 3.699248790740967, 4.282256603240967, 4.025823593139648, 4.9454450607299805, 4.421849250793457, 4.641073703765869, 4.276933670043945, 3.8356127738952637, 5.141331672668457, 1.949021816253662, 1.9840776920318604, 4.936068534851074, 4.05497932434082, 5.915136337280273, 3.760190963745117, 4.568717002868652, 3.8663711547851562, 3.8550825119018555, 3.6876139640808105, 4.482429504394531, 5.6504411697387695, 6.0105791091918945, 3.769443988800049, 3.4132745265960693, 4.086660861968994, 4.231341361999512, 6.135297775268555, 5.657594680786133, 3.2874794006347656, 5.015573024749756, 1.7721717357635498, 5.598440170288086, 3.515050172805786, 3.8830690383911133, 3.729153633117676, 7.341910362243652, 2.846384048461914, 4.424399375915527, 4.864654064178467, 4.483283996582031, 4.163363456726074, 5.024504661560059, 3.0592751502990723, 4.674107551574707, 4.1190996170043945, 4.762658596038818, 2.8136940002441406, 3.7453625202178955, 6.166691780090332, 3.2387802600860596, 4.742006301879883, 4.380491733551025, 3.9403951168060303, 2.7941832542419434, 4.3525590896606445, 4.33003044128418, 3.106741428375244, 3.9870519638061523, 5.281028747558594, 4.807849884033203], "mean_td_error": 4.272764682769775, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057019233703613, "actor_loss": -4.172059535980225, "critic_loss": 0.9603481888771057, "alpha_loss": -0.021128738299012184, "alpha_value": 0.9979013204574585, "log_alpha_value": -0.002100894693285227, "target_entropy": -6.0, "policy_t": 0.01879490166902542, "mean_q": 0.13283367455005646, "max_q": 0.16952024400234222, "min_q": 0.10855244845151901}, "td_error": [2.5830070972442627, 3.3983821868896484, 3.1558384895324707, 2.5593032836914062, 0.9947580099105835, 1.9999641180038452, 1.936628818511963, 3.054168224334717, 2.014242649078369, 2.8547191619873047, 0.6253200769424438, 4.575087547302246, 4.565673351287842, 0.4362342357635498, 1.8728243112564087, 2.883544445037842, 4.304003715515137, 3.5363941192626953, 1.7914729118347168, 0.005619831383228302, 2.3828818798065186, 2.084486484527588, 1.1492459774017334, 3.158193588256836, 2.7832648754119873, 3.7961645126342773, 2.1934163570404053, 1.418381690979004, 2.7319209575653076, 5.370761871337891, 3.8985862731933594, 3.8814005851745605, 2.9410691261291504, 4.147350311279297, 2.4917478561401367, 1.8699326515197754, 1.912614107131958, 1.315441370010376, 1.7488055229187012, 2.472160816192627, 3.030399799346924, 4.093975067138672, 3.190145254135132, 3.234231948852539, 1.7156044244766235, 0.7781044244766235, 1.5919060707092285, 1.680478811264038, 2.229642868041992, 1.9950625896453857, 3.3400368690490723, 3.2917909622192383, 0.21056115627288818, 1.8929023742675781, 2.1619508266448975, 2.665963888168335, 2.430229663848877, 1.6061155796051025, 2.7316203117370605, 3.143045663833618, 1.712740182876587, 1.629567265510559, 0.870891809463501, 4.0391106605529785, 2.9647018909454346, 4.430867671966553, 3.166433572769165, 3.889655590057373, 3.197702407836914, 2.3444643020629883, 2.734344005584717, 2.5778636932373047, 0.7479784488677979, 3.567574977874756, 1.8330121040344238, 1.8908188343048096, 3.0798768997192383, 0.2560085654258728, 0.6976298689842224, 4.563113212585449, 2.8620433807373047, 2.2910258769989014, 2.1502017974853516, 1.7043559551239014, 4.740644454956055, 1.2073917388916016], "mean_td_error": 2.500683546066284, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097772598266602, "actor_loss": -4.204131126403809, "critic_loss": 0.9682837724685669, "alpha_loss": -0.02120557613670826, "alpha_value": 0.9979021549224854, "log_alpha_value": -0.0021000253036618233, "target_entropy": -6.0, "policy_t": 0.008469224907457829, "mean_q": 0.11774244159460068, "max_q": 0.1359020173549652, "min_q": 0.09381784498691559}, "td_error": [3.45501708984375, 0.8196592330932617, 2.254885196685791, 4.3957014083862305, 2.815277099609375, 3.027400493621826, 4.651745796203613, 1.65226411819458, 1.3839356899261475, 2.488440990447998, 1.3324661254882812, 0.9495142102241516, 2.3465256690979004, 2.5615484714508057, 1.9058632850646973, 4.407276153564453, 2.1005115509033203, 4.1300153732299805, 2.156813144683838, 0.8569197654724121, 2.4384477138519287, 3.208298683166504, 4.473151206970215, 2.815371513366699, 2.8866474628448486, 3.1812596321105957, 5.553313255310059, 4.893762588500977, 2.3550162315368652, 3.4075112342834473, 1.9403983354568481, 2.171405792236328, 0.5800191164016724, 0.753592848777771, 3.118814468383789, 0.04565184935927391, 2.0849087238311768, 2.230996608734131, 3.8781166076660156, 2.4423489570617676, 3.0012781620025635, 3.880406379699707, 2.745680809020996, 2.27838134765625, 2.4050183296203613, 2.265467405319214, 2.9263410568237305, 2.6001412868499756, 4.152500152587891, 1.572535514831543, 1.1138525009155273, 3.5608553886413574, 2.681576728820801, 3.425795078277588, 1.8178952932357788, 2.36037015914917, 3.6869730949401855, 1.516859531402588, 3.096764087677002, 3.406458854675293, 3.1221189498901367, 1.6932809352874756, 2.13571834564209, 3.066999912261963, 2.3588900566101074, 1.6451218128204346, 3.5039703845977783, 2.085106134414673, 2.35176944732666, 2.630075454711914, 2.2911458015441895, 1.8578097820281982, 1.516343593597412, 2.577069044113159, 2.6647255420684814, 3.8354299068450928, 1.5229308605194092, 2.0411477088928223, 2.6396944522857666, 1.1191750764846802, 1.9597328901290894, 3.3878254890441895, 3.525123119354248, 3.7656917572021484, 1.0659704208374023, 2.823812961578369], "mean_td_error": 2.579449415206909, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 485.36721052747134, "num_env_steps_trained_throughput_per_sec": 139.75975481706206, "timesteps_total": 8064, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 2118.259, "sample_time_ms": 1399.025, "load_time_ms": 0.524, "load_throughput": 492353.037, "learn_time_ms": 68.146, "learn_throughput": 3785.983, "synch_weights_time_ms": 16.051}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 2064, "last_target_update_ts": 8064, "num_target_updates": 8}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-38", "timestamp": 1700202998, "time_this_iter_s": 1.8629670143127441, "time_total_s": 19.19672918319702, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e070a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.19672918319702, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 62.29999999999999, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063454627990723, "actor_loss": -4.174406051635742, "critic_loss": 3.3218283653259277, "alpha_loss": -0.024153169244527817, "alpha_value": 0.9976028203964233, "log_alpha_value": -0.0024000871926546097, "target_entropy": -6.0, "policy_t": -0.06107482686638832, "mean_q": 0.15003569424152374, "max_q": 0.17023788392543793, "min_q": 0.12874722480773926}, "td_error": [4.5415449142456055, 4.419417381286621, 5.100547790527344, 2.6722030639648438, 5.247374534606934, 5.2453813552856445, 4.9284210205078125, 4.924352645874023, 2.1005642414093018, 6.476290225982666, 3.1932854652404785, 5.257869720458984, 4.724981307983398, 7.112598896026611, 4.293797492980957, 3.5912249088287354, 3.283895492553711, 1.7555524110794067, 4.403785705566406, 3.8574676513671875, 4.439245223999023, 4.156312465667725, 3.598860263824463, 4.4570231437683105, 7.225611209869385, 3.3972620964050293, 3.816434621810913, 4.611311912536621, 4.805849075317383, 3.8237080574035645, 3.4178550243377686, 4.402726173400879, 5.382776737213135, 5.6067609786987305, 3.9518775939941406, 4.838675498962402, 6.146064281463623, 3.6207334995269775, 3.987818717956543, 4.382163047790527, 5.785826683044434, 4.88951301574707, 6.313396453857422, 2.6852450370788574, 4.33322811126709, 3.1633501052856445, 3.4020893573760986, 5.274275779724121, 6.481773376464844, 1.9557297229766846, 2.381265163421631, 3.507371425628662, 5.840803623199463, 3.287632942199707, 3.8279953002929688, 4.402497291564941, 4.55571985244751, 3.681917905807495, 2.9773755073547363, 4.191157817840576, 2.929028034210205, 3.50246524810791, 4.766336917877197, 4.676425933837891, 3.7906246185302734, 5.209782600402832, 4.2817182540893555, 3.01411771774292, 4.595617294311523, 4.823098659515381, 4.860204696655273, 2.484679698944092, 2.7652039527893066, 2.6048214435577393, 3.2385284900665283, 3.0510969161987305, 3.476991653442383, 5.637285232543945, 4.113071441650391, 4.917903900146484, 4.649139881134033, 3.972576141357422, 4.515275001525879, 4.733220100402832, 4.770179748535156, 2.987978219985962], "mean_td_error": 4.238431930541992, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07835865020752, "actor_loss": -4.214112281799316, "critic_loss": 0.6164276599884033, "alpha_loss": -0.024198833853006363, "alpha_value": 0.9976018071174622, "log_alpha_value": -0.0024010688066482544, "target_entropy": -6.0, "policy_t": -0.007032403722405434, "mean_q": 0.15766344964504242, "max_q": 0.19152086973190308, "min_q": 0.13136278092861176}, "td_error": [2.435253143310547, 2.9048871994018555, 3.36786150932312, 2.5910210609436035, 2.25815486907959, 1.932131290435791, 3.835493564605713, 4.248477458953857, 3.569035291671753, 2.513701915740967, 2.738524913787842, 1.9094411134719849, 2.4368298053741455, 2.809023380279541, 2.877067804336548, 3.3574769496917725, 3.282632827758789, 5.844489574432373, 1.686689019203186, 3.3369064331054688, 0.9944648742675781, 2.4659266471862793, 3.380213737487793, 4.518637180328369, 2.7442078590393066, 0.5384530425071716, 5.4074249267578125, 2.874849796295166, 3.3809127807617188, 2.1814355850219727, 3.315275192260742, 1.8137657642364502, 2.776052951812744, 2.902470111846924, 2.8668413162231445, 2.942227840423584, 3.468996524810791, 3.634519100189209, 2.8514890670776367, 4.122573375701904, 2.574388027191162, 1.7206101417541504, 1.3001213073730469, 4.953619003295898, 2.4655251502990723, 2.4682424068450928, 2.0127248764038086, 3.709841728210449, 1.9572162628173828, 2.9134507179260254, 2.2971489429473877, 2.3255724906921387, 4.675539970397949, 1.7567501068115234, 3.93566632270813, 3.151322364807129, 1.7387299537658691, 0.5895183682441711, 2.578873634338379, 0.13211479783058167, 3.7318406105041504, 1.0612711906433105, 2.0586729049682617, 2.6669421195983887, 1.6807894706726074, 2.742215156555176, 2.108809471130371, 3.0303101539611816, 4.388946533203125, 3.010128974914551, 2.0353877544403076, 2.351346969604492, 0.4506669044494629, 2.48068904876709, 3.5425949096679688, 0.5455158948898315, 1.5195198059082031, 3.7667455673217773, 2.296922445297241, 2.3929266929626465, 1.6192042827606201, 3.416266441345215, 3.0979647636413574, 2.648007392883301, 3.2803802490234375, 3.5812015533447266], "mean_td_error": 2.719512701034546, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081790924072266, "actor_loss": -4.209005832672119, "critic_loss": 0.9509904980659485, "alpha_loss": -0.024197451770305634, "alpha_value": 0.9976027607917786, "log_alpha_value": -0.002400114433839917, "target_entropy": -6.0, "policy_t": -0.00671372888609767, "mean_q": 0.13838544487953186, "max_q": 0.16638879477977753, "min_q": 0.11353784054517746}, "td_error": [4.164915084838867, 0.42969760298728943, 2.3605237007141113, 2.2257485389709473, 1.3447269201278687, 3.4317007064819336, 3.216984748840332, 1.7403719425201416, 3.0996737480163574, 3.2476797103881836, 3.415584087371826, 4.958401679992676, 2.345932960510254, 3.2221248149871826, 2.923491954803467, 4.59964656829834, 3.1278440952301025, 3.8159537315368652, 2.8431427478790283, 3.6482601165771484, 3.203176498413086, 1.592026710510254, 2.456256866455078, 1.2858508825302124, 3.230623722076416, 0.9425201416015625, 2.709653615951538, 1.2979278564453125, 2.6261141300201416, 3.9731318950653076, 2.6840567588806152, 1.8946772813796997, 2.8214521408081055, 1.6920629739761353, 2.9633431434631348, 1.5115582942962646, 1.4360426664352417, 2.5822033882141113, 3.2522854804992676, 2.821789264678955, 1.0794658660888672, 2.9661355018615723, 1.2332432270050049, 1.7812070846557617, 3.033895969390869, 1.6806731224060059, 3.453887462615967, 2.2696385383605957, 1.4809622764587402, 4.250716209411621, 3.420102834701538, 2.1540780067443848, 3.5017917156219482, 2.2012367248535156, 3.193675994873047, 3.967297077178955, 2.518063545227051, 3.974942445755005, 3.6071009635925293, 3.0493078231811523, 2.924437999725342, 0.6812543869018555, 2.048654079437256, 1.091747760772705, 2.5664796829223633, 2.446150779724121, 2.521906614303589, 1.040169596672058, 1.5623571872711182, 3.080249786376953, 2.552656888961792, 2.466315269470215, 2.568189859390259, 3.4926130771636963, 2.0505380630493164, 3.1328535079956055, 2.4278953075408936, 2.3553273677825928, 2.693819761276245, 2.65238356590271, 1.6869046688079834, 3.3307676315307617, 1.975151777267456, 2.8164174556732178, 2.264800548553467, 1.8965973854064941], "mean_td_error": 2.584688663482666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 487.31596079631976, "num_env_steps_trained_throughput_per_sec": 140.32089049715458, "timesteps_total": 8960, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 2090.295, "sample_time_ms": 1385.22, "load_time_ms": 0.523, "load_throughput": 493072.797, "learn_time_ms": 67.699, "learn_throughput": 3810.968, "synch_weights_time_ms": 15.922}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-40", "timestamp": 1700203000, "time_this_iter_s": 1.8541769981384277, "time_total_s": 21.05090618133545, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e070a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.05090618133545, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 92.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118463516235352, "actor_loss": -4.250891208648682, "critic_loss": 3.3216986656188965, "alpha_loss": -0.02732052281498909, "alpha_value": 0.9973036050796509, "log_alpha_value": -0.0027000659611076117, "target_entropy": -6.0, "policy_t": 0.00046411596122197807, "mean_q": 0.17642733454704285, "max_q": 0.21053184568881989, "min_q": 0.1449851244688034}, "td_error": [3.219374656677246, 4.372618675231934, 2.7238199710845947, 3.517976999282837, 5.77342414855957, 3.0724267959594727, 3.899691581726074, 5.884039878845215, 3.0528316497802734, 3.6235978603363037, 3.7550723552703857, 5.209413528442383, 6.263664245605469, 3.70719051361084, 3.6984410285949707, 4.546983242034912, 3.4630866050720215, 3.8697903156280518, 4.6310014724731445, 3.652827024459839, 2.478867530822754, 4.1046247482299805, 3.949159622192383, 3.8655381202697754, 4.096203804016113, 3.301816940307617, 4.501781940460205, 5.308479309082031, 2.5793070793151855, 5.271275520324707, 4.017053604125977, 5.0424299240112305, 4.497206211090088, 4.929847717285156, 4.84591007232666, 3.7244760990142822, 3.513016700744629, 2.2442445755004883, 4.4857177734375, 5.056493759155273, 2.5802903175354004, 3.8361635208129883, 4.493304252624512, 4.518891334533691, 4.945202827453613, 4.5239386558532715, 2.0450830459594727, 1.2747492790222168, 4.052206993103027, 2.4925918579101562, 4.847163200378418, 4.741767883300781, 5.4697957038879395, 3.0257740020751953, 4.080080509185791, 4.315924644470215, 4.337957382202148, 4.646685600280762, 4.36527156829834, 4.909146785736084, 5.3553056716918945, 2.919443130493164, 4.890054225921631, 5.542121887207031, 4.545788764953613, 3.1735424995422363, 3.6200828552246094, 6.919929504394531, 5.195842742919922, 3.2018449306488037, 2.380946636199951, 4.839560031890869, 3.4191040992736816, 5.494709014892578, 4.353901386260986, 3.3366057872772217, 4.358531951904297, 4.951120853424072, 4.335975170135498, 4.675639629364014, 4.174716949462891, 3.4966483116149902, 4.61849308013916, 5.186737060546875, 3.938197612762451, 3.9262638092041016], "mean_td_error": 4.140742301940918, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088173866271973, "actor_loss": -4.246585369110107, "critic_loss": 0.596226155757904, "alpha_loss": -0.02725095860660076, "alpha_value": 0.9973023533821106, "log_alpha_value": -0.00270127784460783, "target_entropy": -6.0, "policy_t": 0.009875436313450336, "mean_q": 0.1880243718624115, "max_q": 0.23440337181091309, "min_q": 0.14995351433753967}, "td_error": [3.0317118167877197, 0.7679747343063354, 2.2870569229125977, 1.804598093032837, 2.8589019775390625, 1.4017975330352783, 2.607232093811035, 3.7447781562805176, 2.9955577850341797, 1.5135326385498047, 2.8619577884674072, 1.9730168581008911, 1.2305424213409424, 1.7126619815826416, 2.3847241401672363, 2.8122053146362305, 2.436027765274048, 1.9478039741516113, 2.887664318084717, 4.024384498596191, 3.9399421215057373, 3.1813368797302246, 3.8112285137176514, 4.373341083526611, 1.90750253200531, 2.140472888946533, 3.9863781929016113, 2.9904556274414062, 4.082367420196533, 1.9268381595611572, 3.7057077884674072, 2.7957377433776855, 1.8204057216644287, 2.6604883670806885, 0.48999345302581787, 1.3270329236984253, 1.6750617027282715, 3.1974172592163086, 1.0911105871200562, 3.3198931217193604, 1.5941250324249268, 2.675920009613037, 3.806708335876465, 2.0754261016845703, 3.855529308319092, 3.007751941680908, 1.7892522811889648, 3.286525249481201, 4.324066162109375, 1.7132000923156738, 2.279996871948242, 2.579308032989502, 1.4259164333343506, 1.1409966945648193, 3.1645774841308594, 1.4557700157165527, 0.7709664106369019, 2.415438652038574, 3.227372407913208, 3.573883533477783, 4.5269083976745605, 2.2578916549682617, 4.09975528717041, 3.298002243041992, 2.830179452896118, 1.0190523862838745, 4.59402322769165, 1.9212747812271118, 1.7908644676208496, 1.8833131790161133, 2.6054835319519043, 5.369116306304932, 3.187593698501587, 2.822230339050293, 1.5640769004821777, 3.3938183784484863, 2.76617431640625, 4.91309928894043, 2.4456334114074707, 3.479602098464966, 3.1810507774353027, 3.49491024017334, 3.230072259902954, 0.14713680744171143, 1.9696483612060547, 2.8893160820007324], "mean_td_error": 2.645927906036377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030611038208008, "actor_loss": -4.179711818695068, "critic_loss": 1.0197067260742188, "alpha_loss": -0.027084531262516975, "alpha_value": 0.9973034262657166, "log_alpha_value": -0.002700187498703599, "target_entropy": -6.0, "policy_t": 0.006930025760084391, "mean_q": 0.1645870953798294, "max_q": 0.20022031664848328, "min_q": 0.13332444429397583}, "td_error": [4.655590057373047, 3.784085512161255, 3.095040798187256, 3.473794460296631, 3.691105365753174, 1.9206074476242065, 3.1388440132141113, 1.3486440181732178, 4.136636257171631, 4.30657958984375, 3.2394957542419434, 3.108841896057129, 3.6733057498931885, 3.865783929824829, 1.571352481842041, 1.6763863563537598, 0.3935987949371338, 3.0367679595947266, 3.7164230346679688, 0.5740309953689575, 2.9480814933776855, 3.019979953765869, 3.693965435028076, 0.5551021099090576, 3.612724781036377, 1.7479588985443115, 2.3745646476745605, 2.7823686599731445, 3.20993709564209, 3.3778533935546875, 2.874508857727051, 2.514115810394287, 0.8575706481933594, 1.824119210243225, 4.080940246582031, 0.895694375038147, 2.4185667037963867, 5.300956726074219, 3.440976142883301, 1.0903730392456055, 2.285461902618408, 2.2768192291259766, 2.648392677307129, 2.937201976776123, 3.286012649536133, 3.3586177825927734, 3.3640284538269043, 2.0937182903289795, 2.9983582496643066, 2.0917789936065674, 2.3059298992156982, 2.548295497894287, 2.0199079513549805, 3.1573646068573, 2.9336583614349365, 5.352710247039795, 1.400291919708252, 2.102264881134033, 2.206017255783081, 1.8784704208374023, 0.456424355506897, 1.5319339036941528, 3.6671416759490967, 2.2227299213409424, 3.66554594039917, 2.665958881378174, 3.52009916305542, 2.701004981994629, 1.6446824073791504, 5.150517463684082, 3.181243419647217, 4.226469039916992, 2.3577239513397217, 1.722625970840454, 2.5886263847351074, 0.5531014204025269, 4.7483811378479, 3.3167290687561035, 2.9671969413757324, 1.9594392776489258, 2.633485794067383, 3.290222644805908, 2.349057197570801, 2.5307180881500244, 1.093297004699707, 0.8652180433273315], "mean_td_error": 2.6963040828704834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 400.36357620120106, "num_env_steps_trained_throughput_per_sec": 115.28326189722085, "timesteps_total": 9856, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 2006.777, "sample_time_ms": 1392.409, "load_time_ms": 0.528, "load_throughput": 489054.292, "learn_time_ms": 67.629, "learn_throughput": 3814.914, "synch_weights_time_ms": 15.869}, "counters": {"num_env_steps_sampled": 9856, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 2580, "last_target_update_ts": 9856, "num_target_updates": 10}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-42", "timestamp": 1700203002, "time_this_iter_s": 2.2569048404693604, "time_total_s": 23.30781102180481, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0772820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 23.30781102180481, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 77.96666666666665, "ram_util_percent": 92.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059013366699219, "actor_loss": -4.210859298706055, "critic_loss": 3.495776653289795, "alpha_loss": -0.03017801232635975, "alpha_value": 0.9970043897628784, "log_alpha_value": -0.003000096417963505, "target_entropy": -6.0, "policy_t": -0.015381216071546078, "mean_q": 0.20502609014511108, "max_q": 0.23785504698753357, "min_q": 0.16902700066566467}, "td_error": [4.982948303222656, 5.206403732299805, 3.494842052459717, 4.719302654266357, 5.041808128356934, 3.876513957977295, 5.239382743835449, 3.913999080657959, 5.443695068359375, 4.216178894042969, 6.204960346221924, 4.297423362731934, 5.42447566986084, 6.16674280166626, 5.156459808349609, 4.411165237426758, 4.208873748779297, 7.060229778289795, 5.5872602462768555, 5.938444137573242, 4.64860200881958, 4.210086345672607, 2.373615264892578, 5.142946243286133, 3.5404293537139893, 4.355522632598877, 4.209088325500488, 1.5692338943481445, 4.932171821594238, 5.907204627990723, 4.004144191741943, 1.7295994758605957, 3.419973850250244, 2.9654767513275146, 3.7745704650878906, 5.484432220458984, 5.429495811462402, 5.439807891845703, 5.3062238693237305, 5.55555534362793, 2.6795718669891357, 3.9485023021698, 3.005143642425537, 3.5731568336486816, 4.244961261749268, 4.870687484741211, 2.3951854705810547, 4.78196382522583, 4.944193363189697, 5.833898544311523, 5.159816741943359, 3.447575092315674, 1.337606430053711, 3.968536853790283, 4.1695780754089355, 2.8297297954559326, 4.343487739562988, 5.2121124267578125, 5.323103904724121, 5.904535293579102, 3.8070764541625977, 2.9320924282073975, 5.176774978637695, 4.986406326293945, 4.034491539001465, 4.2846598625183105, 5.038613796234131, 3.471357822418213, 3.4655661582946777, 3.404448986053467, 4.57415771484375, 4.525975227355957, 3.6661691665649414, 4.9085893630981445, 3.533114194869995, 4.088289260864258, 4.977920055389404, 3.337066650390625, 4.457379341125488, 3.527144432067871, 4.401611804962158, 6.255699634552002, 4.522505760192871, 3.831772804260254, 3.621492385864258, 2.530665874481201], "mean_td_error": 4.347949504852295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057275772094727, "actor_loss": -4.240021228790283, "critic_loss": 0.5587857961654663, "alpha_loss": -0.03018719144165516, "alpha_value": 0.9970029592514038, "log_alpha_value": -0.0030015278607606888, "target_entropy": -6.0, "policy_t": 0.042965374886989594, "mean_q": 0.2149237096309662, "max_q": 0.2711663544178009, "min_q": 0.17950724065303802}, "td_error": [2.9064602851867676, 1.2321327924728394, 1.5440986156463623, 1.9866869449615479, 2.932285785675049, 2.4364070892333984, 3.2358856201171875, 0.4363599419593811, 1.1473110914230347, 2.491415500640869, 0.23527351021766663, 2.239015579223633, 1.8621747493743896, 0.7831199765205383, 1.7528718709945679, 2.760958194732666, 0.83051598072052, 2.715567111968994, 3.7050323486328125, 2.242859363555908, 2.5112950801849365, 3.7856526374816895, 0.10271341353654861, 2.4740428924560547, 3.034231185913086, 2.5110130310058594, 2.208738327026367, 2.5456626415252686, 2.5811610221862793, 0.9695934057235718, 3.0279555320739746, 1.836639642715454, 4.097823143005371, 2.498777389526367, 2.3750576972961426, 2.398679733276367, 1.7091495990753174, 3.9768564701080322, 1.1977736949920654, 3.6395084857940674, 0.8900040984153748, 4.679292678833008, 3.864203453063965, 1.998399257659912, 1.6119520664215088, 3.3514976501464844, 1.160048007965088, 3.4505820274353027, 2.953517436981201, 3.730299949645996, 3.3569183349609375, 4.289485931396484, 3.0294947624206543, 2.1114697456359863, 2.756075382232666, 4.087541103363037, 2.122683048248291, 3.1676149368286133, 2.5417022705078125, 2.718473434448242, 2.0425302982330322, 3.7254533767700195, 3.0778896808624268, 4.839565277099609, 1.0385991334915161, 2.3497629165649414, 2.9720230102539062, 2.355044364929199, 1.756831169128418, 1.1701021194458008, 2.4534711837768555, 3.5652897357940674, 1.4488797187805176, 2.624049663543701, 1.8837006092071533, 2.566493034362793, 2.1088485717773438, 2.903902053833008, 1.8695647716522217, 3.045529842376709, 2.6574363708496094, 3.4519753456115723, 0.527532696723938, 1.2137410640716553, 3.7346906661987305, 2.486489772796631], "mean_td_error": 2.449993133544922, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056013107299805, "actor_loss": -4.230328559875488, "critic_loss": 0.9484896659851074, "alpha_loss": -0.030169712379574776, "alpha_value": 0.9970043301582336, "log_alpha_value": -0.0030001667328178883, "target_entropy": -6.0, "policy_t": -0.05119909346103668, "mean_q": 0.1883414089679718, "max_q": 0.2368103414773941, "min_q": 0.15876011550426483}, "td_error": [2.1798689365386963, 5.1834564208984375, 2.447786331176758, 0.9180528521537781, 2.079559087753296, 2.1269686222076416, 1.5807433128356934, 3.264551877975464, 2.6650352478027344, 2.496616840362549, 2.1599621772766113, 2.1047773361206055, 2.0169973373413086, 2.9057679176330566, 2.807234525680542, 3.781019687652588, 2.4264636039733887, 1.2312736511230469, 1.805372953414917, 2.385432243347168, 2.6923880577087402, 1.678849458694458, 2.2976012229919434, 1.7710022926330566, 3.132086753845215, 3.0466527938842773, 0.7717432975769043, 4.828985691070557, 0.694828987121582, 0.6751982569694519, 1.0431272983551025, 2.503772020339966, 3.055177688598633, 2.8574934005737305, 1.9403479099273682, 0.6944476366043091, 3.3049464225769043, 2.8460001945495605, 2.4189014434814453, 2.2670178413391113, 3.3390579223632812, 3.204606771469116, 3.8498148918151855, 0.16347017884254456, 2.525111675262451, 2.777513027191162, 2.5140161514282227, 0.3444918394088745, 2.9272918701171875, 2.7512707710266113, 3.7752628326416016, 3.6015706062316895, 1.8891189098358154, 2.5617737770080566, 2.6708984375, 1.2487854957580566, 3.1452794075012207, 1.9089598655700684, 2.438856601715088, 1.3263702392578125, 4.6130290031433105, 2.2254765033721924, 2.1137094497680664, 2.6822433471679688, 1.6453168392181396, 2.303783893585205, 3.5601911544799805, 2.560512065887451, 4.954673767089844, 2.0723769664764404, 2.9715371131896973, 2.8760247230529785, 2.409555196762085, 2.5365943908691406, 3.738193988800049, 0.33102548122406006, 4.755863189697266, 4.698245525360107, 3.9781408309936523, 4.033064842224121, 3.158616304397583, 3.596440315246582, 2.2818031311035156, 2.0174388885498047, 3.6099658012390137, 1.7199654579162598], "mean_td_error": 2.552265167236328, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 367.9564181585262, "num_env_steps_trained_throughput_per_sec": 105.95173647868278, "timesteps_total": 10752, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1993.764, "sample_time_ms": 1379.453, "load_time_ms": 0.525, "load_throughput": 491185.344, "learn_time_ms": 64.784, "learn_throughput": 3982.453, "synch_weights_time_ms": 15.559}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-45", "timestamp": 1700203005, "time_this_iter_s": 2.4497480392456055, "time_total_s": 25.757559061050415, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.757559061050415, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 64.9, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060279846191406, "actor_loss": -4.237935543060303, "critic_loss": 3.1512279510498047, "alpha_loss": -0.03319964185357094, "alpha_value": 0.9967053532600403, "log_alpha_value": -0.0033000712282955647, "target_entropy": -6.0, "policy_t": 0.015957145020365715, "mean_q": 0.2369714379310608, "max_q": 0.2756245732307434, "min_q": 0.19650337100028992}, "td_error": [3.244263172149658, 5.481636047363281, 4.303745746612549, 4.349207878112793, 4.572834491729736, 3.089172840118408, 3.782723903656006, 3.1547255516052246, 3.5154929161071777, 5.366457462310791, 3.6260368824005127, 4.056268692016602, 4.282814025878906, 4.4725494384765625, 2.4585649967193604, 3.638451337814331, 6.682032108306885, 5.598644256591797, 4.127408504486084, 4.574561595916748, 4.133088111877441, 4.076791763305664, 3.698894500732422, 3.461381435394287, 4.105403900146484, 2.438694477081299, 3.140259265899658, 3.864800214767456, 2.4603042602539062, 2.241495132446289, 1.9826393127441406, 4.166956424713135, 3.886569023132324, 3.9312949180603027, 4.392297744750977, 4.1890177726745605, 2.772491455078125, 3.029710292816162, 4.85380744934082, 3.0655646324157715, 3.443291664123535, 6.0781636238098145, 5.775313854217529, 3.985522747039795, 6.456689834594727, 3.900860071182251, 2.37685227394104, 5.232528209686279, 5.666789531707764, 3.0936200618743896, 3.356900453567505, 6.198747634887695, 3.892608642578125, 3.160255193710327, 5.677435398101807, 5.612241744995117, 3.273820161819458, 4.563789367675781, 5.508824348449707, 2.364949941635132, 2.7809853553771973, 4.660332679748535, 5.4687700271606445, 3.0723209381103516, 3.503505229949951, 2.229942560195923, 4.6284966468811035, 4.614035606384277, 3.5372471809387207, 4.453176498413086, 2.8572473526000977, 3.4891762733459473, 3.29628324508667, 3.8024535179138184, 2.9700675010681152, 1.5340876579284668, 3.4063024520874023, 5.64105224609375, 5.93988037109375, 4.866795063018799, 4.1108503341674805, 3.530810832977295, 3.434452772140503, 2.49135684967041, 5.583539962768555, 3.546384334564209], "mean_td_error": 3.992300033569336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063883781433105, "actor_loss": -4.274163246154785, "critic_loss": 0.5227720737457275, "alpha_loss": -0.033228520303964615, "alpha_value": 0.9967036843299866, "log_alpha_value": -0.0033017590176314116, "target_entropy": -6.0, "policy_t": -0.012802623212337494, "mean_q": 0.24811230599880219, "max_q": 0.2986081540584564, "min_q": 0.19271504878997803}, "td_error": [4.2841901779174805, 1.5028231143951416, 1.482428789138794, 3.8271727561950684, 0.9274342656135559, 3.0637590885162354, 1.6379759311676025, 1.0222182273864746, 2.033214569091797, 2.8532614707946777, 2.23586368560791, 1.5656647682189941, 0.48228639364242554, 2.046308755874634, 2.4827659130096436, 0.29961198568344116, 1.8866312503814697, 2.9343838691711426, 1.536118745803833, 1.8975887298583984, 3.3900465965270996, 1.9322477579116821, 1.5768914222717285, 3.466599464416504, 2.0718488693237305, 1.1725059747695923, 4.55513858795166, 3.462533950805664, 3.123292922973633, 1.5408298969268799, 1.6221237182617188, 3.931244373321533, 4.048648834228516, 2.6371889114379883, 0.9817484021186829, 2.0848937034606934, 3.357888698577881, 1.6913731098175049, 2.9568276405334473, 3.106398582458496, 2.1126599311828613, 3.2385363578796387, 1.9490759372711182, 4.10458517074585, 3.326059579849243, 1.1211838722229004, 1.3960025310516357, 1.987632393836975, 4.33225154876709, 2.1467983722686768, 2.2606561183929443, 2.8146214485168457, 2.8952741622924805, 2.138866901397705, 4.550844669342041, 2.5242035388946533, 1.9919824600219727, 0.8739855289459229, 1.7217190265655518, 3.076338052749634, 2.2334532737731934, 1.44195556640625, 2.141589641571045, 3.531853199005127, 0.6757791042327881, 2.3843886852264404, 2.754671096801758, 2.525496482849121, 1.3698301315307617, 3.4945366382598877, 3.5959765911102295, 2.2687368392944336, 2.481645107269287, 1.547959804534912, 3.8114237785339355, 1.1188080310821533, 1.079237461090088, 4.8748273849487305, 4.605528831481934, 0.9889464378356934, 1.69660484790802, 1.0767675638198853, 2.0365724563598633, 1.2651456594467163, 3.430295944213867, 1.5267255306243896], "mean_td_error": 2.3631858825683594, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075271606445312, "actor_loss": -4.275470733642578, "critic_loss": 0.9591007232666016, "alpha_loss": -0.033249545842409134, "alpha_value": 0.9967053532600403, "log_alpha_value": -0.003300114069133997, "target_entropy": -6.0, "policy_t": -0.019375478848814964, "mean_q": 0.22128544747829437, "max_q": 0.2682643532752991, "min_q": 0.189670130610466}, "td_error": [3.280189275741577, 3.3463754653930664, 2.0563621520996094, 1.882070779800415, 1.322130799293518, 3.0023984909057617, 2.984119415283203, 4.366951942443848, 0.3325180411338806, 2.289322853088379, 1.7444093227386475, 2.577096939086914, 1.7430856227874756, 4.131034851074219, 0.47758179903030396, 1.53706955909729, 2.23887300491333, 1.8866121768951416, 2.212496280670166, 3.171360969543457, 4.194255828857422, 1.6567330360412598, 5.240658283233643, 3.0842227935791016, 3.2106947898864746, 1.6169302463531494, 2.463200092315674, 3.7443838119506836, 1.8936796188354492, 1.7187635898590088, 3.480252981185913, 2.428544282913208, 3.69638729095459, 0.9743821620941162, 1.611527681350708, 1.655807614326477, 2.0050454139709473, 2.5269856452941895, 0.832332968711853, 2.4965386390686035, 2.122511148452759, 3.5761640071868896, 4.385497093200684, 2.204521656036377, 2.799837112426758, 2.4660606384277344, 2.4083404541015625, 2.0343379974365234, 3.7483396530151367, 4.138184547424316, 2.776085376739502, 2.839775562286377, 1.351962924003601, 2.690920829772949, 4.142343044281006, 1.7497276067733765, 2.8666069507598877, 2.0870752334594727, 2.59820294380188, 1.995761752128601, 2.945842742919922, 2.040264844894409, 2.559993267059326, 4.790468215942383, 2.2233071327209473, 3.7078070640563965, 2.404923439025879, 2.8306710720062256, 1.7692465782165527, 4.061398506164551, 2.6123952865600586, 2.607271671295166, 1.8315908908843994, 0.23284652829170227, 2.957753896713257, 0.882267951965332, 4.598480224609375, 3.025078296661377, 4.328391075134277, 2.8881871700286865, 0.31054964661598206, 2.485380172729492, 0.3264954090118408, 2.7881174087524414, 2.904625177383423, 3.4945335388183594], "mean_td_error": 2.554692268371582, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 466.9736317017012, "num_env_steps_trained_throughput_per_sec": 134.4633894855345, "timesteps_total": 11648, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 2002.225, "sample_time_ms": 1388.606, "load_time_ms": 0.528, "load_throughput": 488789.21, "learn_time_ms": 64.458, "learn_throughput": 4002.6, "synch_weights_time_ms": 15.443}, "counters": {"num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-47", "timestamp": 1700203007, "time_this_iter_s": 1.9345626831054688, "time_total_s": 27.692121744155884, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052643a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.692121744155884, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 89.30000000000001, "ram_util_percent": 92.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.002829551696777, "actor_loss": -4.213100910186768, "critic_loss": 3.516941785812378, "alpha_loss": -0.03601022809743881, "alpha_value": 0.9964064955711365, "log_alpha_value": -0.003600003896281123, "target_entropy": -6.0, "policy_t": 0.026056621223688126, "mean_q": 0.26561054587364197, "max_q": 0.3095405101776123, "min_q": 0.22691883146762848}, "td_error": [3.7499260902404785, 5.950456619262695, 2.635207176208496, 4.447274208068848, 5.1948442459106445, 4.911542892456055, 3.5734848976135254, 4.908988952636719, 4.552224159240723, 4.100973606109619, 2.6959147453308105, 4.103006839752197, 5.369586944580078, 3.6805977821350098, 4.126529693603516, 5.33590841293335, 4.271677017211914, 3.847630262374878, 5.548434257507324, 4.262274265289307, 4.006470203399658, 5.154579162597656, 4.503140449523926, 4.42419958114624, 3.9382853507995605, 3.3029842376708984, 3.748971462249756, 6.12502384185791, 4.411170959472656, 3.9437637329101562, 5.32297420501709, 5.83969783782959, 5.478334426879883, 3.15990948677063, 3.619953155517578, 5.852414131164551, 2.688803195953369, 4.393466949462891, 4.723662853240967, 3.4460341930389404, 2.2953524589538574, 4.848448753356934, 3.036574125289917, 2.2928028106689453, 4.006176948547363, 4.980948448181152, 3.4792943000793457, 3.0164365768432617, 5.8356757164001465, 3.4581284523010254, 3.532337188720703, 5.796580791473389, 4.536383152008057, 2.237701892852783, 4.439138412475586, 3.7369768619537354, 2.1068105697631836, 4.1582417488098145, 5.870306968688965, 5.998974800109863, 5.451925277709961, 5.424747943878174, 3.1356780529022217, 4.611996173858643, 6.084258556365967, 4.029697418212891, 5.6025004386901855, 5.075372695922852, 3.346236228942871, 4.760869026184082, 5.496976852416992, 4.1507134437561035, 6.261731147766113, 4.136638164520264, 4.773019790649414, 5.62160587310791, 3.7560925483703613, 3.0860719680786133, 4.028139114379883, 3.723480463027954, 4.428758144378662, 4.003404140472412, 2.7343130111694336, 4.618375778198242, 6.56997013092041, 3.0654940605163574], "mean_td_error": 4.3371124267578125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079235076904297, "actor_loss": -4.314258575439453, "critic_loss": 0.5760499238967896, "alpha_loss": -0.0363052599132061, "alpha_value": 0.9964044690132141, "log_alpha_value": -0.0036019852850586176, "target_entropy": -6.0, "policy_t": -0.01674444042146206, "mean_q": 0.2780285179615021, "max_q": 0.3352639079093933, "min_q": 0.2332964688539505}, "td_error": [2.8966917991638184, 1.0553951263427734, 1.2986035346984863, 1.846875786781311, 2.3118743896484375, 0.5519295334815979, 2.859619140625, 2.1029610633850098, 2.051051139831543, 3.481604814529419, 2.2031407356262207, 2.859196662902832, 2.982602119445801, 3.6499667167663574, 2.4088425636291504, 3.7602643966674805, 1.8487839698791504, 2.8537955284118652, 2.3420119285583496, 5.750088691711426, 3.5642595291137695, 2.217029094696045, 3.291187286376953, 2.9842934608459473, 1.9816107749938965, 3.0320372581481934, 3.1701111793518066, 3.260742425918579, 1.9856797456741333, 2.1791186332702637, 4.301421165466309, 3.073342800140381, 0.8836279511451721, 0.3966407775878906, 6.171815872192383, 1.850358009338379, 4.661437034606934, 1.74458646774292, 3.9691271781921387, 1.4892995357513428, 2.496497631072998, 3.0860257148742676, 2.9629769325256348, 2.5433034896850586, 1.4239366054534912, 2.307766914367676, 4.655051231384277, 2.3485381603240967, 3.9209585189819336, 2.843639612197876, 4.1998701095581055, 1.7215285301208496, 1.6160309314727783, 1.9796888828277588, 3.1534032821655273, 3.014324426651001, 0.2651923894882202, 3.409029006958008, 2.5829145908355713, 4.887679100036621, 1.335047721862793, 3.6366071701049805, 2.903357982635498, 3.089928150177002, 2.164473056793213, 3.481149673461914, 0.44213324785232544, 3.242058753967285, 2.937893867492676, 1.657334327697754, 1.862175703048706, 2.3489513397216797, 2.543915033340454, 3.3694908618927, 2.2652838230133057, 2.396214485168457, 3.044551372528076, 1.5951671600341797, 1.0965033769607544, 1.3829715251922607, 3.558180332183838, 1.9221889972686768, 1.416083574295044, 1.821075677871704, 1.3435064554214478, 0.7803614139556885], "mean_td_error": 2.562534809112549, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080662727355957, "actor_loss": -4.309929370880127, "critic_loss": 0.9328055381774902, "alpha_loss": -0.03629107400774956, "alpha_value": 0.9964063763618469, "log_alpha_value": -0.0036000683903694153, "target_entropy": -6.0, "policy_t": -0.04035314545035362, "mean_q": 0.24865177273750305, "max_q": 0.2976795732975006, "min_q": 0.20543639361858368}, "td_error": [2.475424289703369, 2.8601245880126953, 3.90545654296875, 1.1648921966552734, 0.5661627650260925, 3.531766891479492, 2.663116931915283, 2.195021629333496, 2.9431097507476807, 2.4973902702331543, 4.305211067199707, 2.567868232727051, 2.034367799758911, 2.2717790603637695, 2.1813769340515137, 1.302443027496338, 2.18009877204895, 2.341641426086426, 3.9011590480804443, 3.1397552490234375, 1.3297576904296875, 4.504283905029297, 1.7568284273147583, 3.386475086212158, 2.019596576690674, 1.1727514266967773, 1.2804538011550903, 2.611787796020508, 2.5099358558654785, 3.3214409351348877, 2.8547375202178955, 2.666905403137207, 3.9864306449890137, 3.691032648086548, 1.656395673751831, 3.0022168159484863, 1.0144855976104736, 1.9425688982009888, 2.5240283012390137, 2.4889049530029297, 0.5158783197402954, 4.044486045837402, 1.6545606851577759, 3.2729685306549072, 1.602771520614624, 2.091590642929077, 2.8425776958465576, 1.102069616317749, 2.151660919189453, 0.6686645746231079, 2.555274486541748, 2.2485997676849365, 3.9913880825042725, 4.1797194480896, 3.4281399250030518, 2.606956720352173, 1.4459819793701172, 2.878657341003418, 2.1505274772644043, 1.7997558116912842, 1.7912023067474365, 1.7264068126678467, 1.7532613277435303, 3.54724383354187, 2.6671366691589355, 2.4017531871795654, 3.655332326889038, 2.6391375064849854, 3.035144329071045, 2.5340380668640137, 2.4515650272369385, 5.412330627441406, 2.899019241333008, 3.297844648361206, 2.2836008071899414, 3.5487418174743652, 1.4449598789215088, 3.954374313354492, 2.3776278495788574, 0.623231053352356, 1.6315498352050781, 2.95776629447937, 1.9601256847381592, 3.0976595878601074, 4.174173355102539, 2.399306297302246], "mean_td_error": 2.53774356842041, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 463.6510689547922, "num_env_steps_trained_throughput_per_sec": 133.5066694088576, "timesteps_total": 12544, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 2010.181, "sample_time_ms": 1396.267, "load_time_ms": 0.526, "load_throughput": 490917.948, "learn_time_ms": 64.288, "learn_throughput": 4013.177, "synch_weights_time_ms": 15.404}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-49", "timestamp": 1700203009, "time_this_iter_s": 1.9488189220428467, "time_total_s": 29.64094066619873, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.64094066619873, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 63.79999999999999, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03303050994873, "actor_loss": -4.2663893699646, "critic_loss": 3.2260031700134277, "alpha_loss": -0.03912686929106712, "alpha_value": 0.996107816696167, "log_alpha_value": -0.003899805247783661, "target_entropy": -6.0, "policy_t": 0.054059434682130814, "mean_q": 0.30083322525024414, "max_q": 0.3457561433315277, "min_q": 0.24158154428005219}, "td_error": [2.419206142425537, 4.362239837646484, 1.9238908290863037, 4.467391014099121, 1.572232723236084, 3.6861233711242676, 5.1064348220825195, 3.842283010482788, 3.840898036956787, 3.9792914390563965, 4.4987945556640625, 4.612664222717285, 5.588895797729492, 3.7261862754821777, 4.585024833679199, 1.1867810487747192, 3.0245895385742188, 5.1232781410217285, 4.753792762756348, 4.271106243133545, 3.4269766807556152, 4.479129791259766, 5.088995456695557, 5.722124099731445, 4.457395553588867, 4.922294616699219, 3.885756015777588, 2.943222761154175, 3.6566267013549805, 4.182521343231201, 5.511370658874512, 4.724634170532227, 5.722984313964844, 5.201440811157227, 1.7941871881484985, 2.249480962753296, 3.4937262535095215, 5.360291481018066, 5.012738227844238, 4.618470668792725, 3.1249871253967285, 2.8197054862976074, 3.3309555053710938, 3.8875503540039062, 5.759589195251465, 2.2507307529449463, 3.521184206008911, 2.284001350402832, 4.175339221954346, 3.725832462310791, 4.983058929443359, 4.306188583374023, 4.809884071350098, 3.616424083709717, 3.7426486015319824, 5.581140041351318, 3.7642762660980225, 2.445018768310547, 4.409550189971924, 4.893347263336182, 2.7437596321105957, 7.170306205749512, 3.2106833457946777, 2.9440536499023438, 3.2431812286376953, 3.4430553913116455, 3.5739879608154297, 3.614473819732666, 5.264662742614746, 5.347406387329102, 4.9122748374938965, 4.400582313537598, 5.932496070861816, 5.339703559875488, 4.419589996337891, 4.638707637786865, 4.003618240356445, 5.063407897949219, 5.447486877441406, 3.53196382522583, 3.392197370529175, 3.864556074142456, 2.143338680267334, 3.507352113723755, 4.627795219421387, 4.169770240783691], "mean_td_error": 4.0745038986206055, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069293022155762, "actor_loss": -4.33294153213501, "critic_loss": 0.550801157951355, "alpha_loss": -0.03929271548986435, "alpha_value": 0.9961053729057312, "log_alpha_value": -0.0039022325072437525, "target_entropy": -6.0, "policy_t": -0.004996573086827993, "mean_q": 0.31832021474838257, "max_q": 0.3927922546863556, "min_q": 0.2595812976360321}, "td_error": [2.968994140625, 3.731226682662964, 3.3984367847442627, 3.4482808113098145, 1.608009934425354, 2.705519199371338, 2.080552101135254, 1.730393886566162, 2.898435354232788, 3.1902451515197754, 2.087360382080078, 1.9341095685958862, 2.284392833709717, 2.7924158573150635, 2.9098942279815674, 4.267821311950684, 2.5833747386932373, 2.288764476776123, 0.7101619243621826, 3.2290029525756836, 2.6250863075256348, 2.9866390228271484, 2.4882631301879883, 1.6874476671218872, 1.4198098182678223, 1.4389934539794922, 3.560831069946289, 5.5634565353393555, 0.7802612781524658, 3.5095748901367188, 3.4082789421081543, 3.0684309005737305, 3.0975241661071777, 1.4026216268539429, 0.6819567084312439, 2.9760303497314453, 2.2929604053497314, 1.238736629486084, 1.5000909566879272, 4.300850868225098, 2.986307144165039, 3.685502052307129, 2.549323081970215, 2.829845428466797, 2.2008705139160156, 1.718651294708252, 1.126000165939331, 2.5918776988983154, 1.7688302993774414, 3.136536121368408, 3.076141119003296, 2.9058144092559814, 0.7889903783798218, 2.275324821472168, 2.9774813652038574, 2.788163423538208, 1.0303764343261719, 2.246321201324463, 0.7900174260139465, 1.3798162937164307, 0.08384792506694794, 0.9919398427009583, 3.8082633018493652, 2.773200273513794, 3.2762808799743652, 2.287132501602173, 4.9378156661987305, 2.127892017364502, 2.465919017791748, 3.006833791732788, 3.4068868160247803, 2.744126319885254, 2.112244129180908, 3.1686923503875732, 1.571028232574463, 2.6241698265075684, 2.607706069946289, 1.935215950012207, 3.5025038719177246, 2.401689052581787, 4.299538612365723, 0.21220077574253082, 1.8972194194793701, 1.1893303394317627, 3.8191518783569336, 0.9062536954879761], "mean_td_error": 2.463773488998413, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058150291442871, "actor_loss": -4.32304573059082, "critic_loss": 0.8593400716781616, "alpha_loss": -0.039227165281772614, "alpha_value": 0.9961075782775879, "log_alpha_value": -0.0039000376127660275, "target_entropy": -6.0, "policy_t": 0.008235422894358635, "mean_q": 0.28130295872688293, "max_q": 0.33583298325538635, "min_q": 0.23389840126037598}, "td_error": [4.451221466064453, 1.831908106803894, 0.18132838606834412, 2.246196746826172, 2.473830223083496, 0.5132584571838379, 2.0645689964294434, 1.9802299737930298, 3.6026809215545654, 0.03042842447757721, 2.4925756454467773, 2.476580858230591, 2.761598825454712, 3.203944206237793, 3.645761013031006, 3.1844468116760254, 4.902185916900635, 1.7805854082107544, 1.045527458190918, 3.440988779067993, 1.2343626022338867, 3.4386682510375977, 4.030053615570068, 0.024042382836341858, 3.1373112201690674, 2.1469953060150146, 1.0877400636672974, 1.2112915515899658, 4.231492042541504, 1.2593650817871094, 1.2887187004089355, 1.2294037342071533, 1.0953221321105957, 1.3562042713165283, 2.5807881355285645, 3.159255027770996, 3.30203914642334, 1.4870150089263916, 2.4493236541748047, 3.8557825088500977, 2.460165023803711, 0.7253050804138184, 4.761191368103027, 4.131636619567871, 3.7446980476379395, 0.8936595916748047, 2.3311314582824707, 2.2838735580444336, 1.2340221405029297, 2.523313522338867, 3.5895256996154785, 0.7627687454223633, 1.6564853191375732, 4.4882893562316895, 2.916193962097168, 2.108036994934082, 0.6394320726394653, 2.0679938793182373, 2.2850682735443115, 2.3285951614379883, 2.382158041000366, 4.6085028648376465, 1.5732195377349854, 3.648237466812134, 4.021866321563721, 2.0985283851623535, 2.138822555541992, 1.048469066619873, 1.9840171337127686, 2.9242844581604004, 1.6165252923965454, 1.8711483478546143, 1.2633092403411865, 3.0179734230041504, 1.2565295696258545, 1.166349172592163, 1.0083036422729492, 4.717381954193115, 2.7855000495910645, 1.6355133056640625, 2.2653236389160156, 2.253058910369873, 0.10928584635257721, 2.4086365699768066, 3.3423166275024414, 3.3330135345458984], "mean_td_error": 2.3293566703796387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 487.98499361272854, "num_env_steps_trained_throughput_per_sec": 140.51353610723658, "timesteps_total": 13440, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 2005.799, "sample_time_ms": 1392.558, "load_time_ms": 0.525, "load_throughput": 491855.112, "learn_time_ms": 64.196, "learn_throughput": 4018.935, "synch_weights_time_ms": 15.285}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 3612, "last_target_update_ts": 13440, "num_target_updates": 14}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-51", "timestamp": 1700203011, "time_this_iter_s": 1.8514227867126465, "time_total_s": 31.492363452911377, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0772f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.492363452911377, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 61.96666666666666, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050411224365234, "actor_loss": -4.313852787017822, "critic_loss": 3.4205751419067383, "alpha_loss": -0.042207226157188416, "alpha_value": 0.9958092570304871, "log_alpha_value": -0.004199552815407515, "target_entropy": -6.0, "policy_t": 0.036188721656799316, "mean_q": 0.3405623733997345, "max_q": 0.41465818881988525, "min_q": 0.2887905538082123}, "td_error": [5.396522521972656, 1.3583014011383057, 2.283930540084839, 2.0724973678588867, 3.5380375385284424, 5.640247821807861, 3.2057135105133057, 3.3946847915649414, 4.984194278717041, 3.766691207885742, 3.5789575576782227, 5.724384307861328, 4.29622745513916, 4.98693323135376, 4.998222351074219, 2.9384546279907227, 5.195448875427246, 3.2430386543273926, 5.607962608337402, 3.663644790649414, 4.268632888793945, 4.37300443649292, 3.259884834289551, 4.306521415710449, 5.235764503479004, 5.119622230529785, 4.89926815032959, 3.6414711475372314, 3.2252111434936523, 5.084909439086914, 5.942365646362305, 3.979159355163574, 3.0759854316711426, 3.945781707763672, 3.1166868209838867, 4.898759841918945, 4.5755438804626465, 4.934374809265137, 3.108229637145996, 4.94537353515625, 3.472972869873047, 4.515121936798096, 4.507892608642578, 1.2394968271255493, 4.705344200134277, 5.309391498565674, 4.365453720092773, 3.0969347953796387, 5.484582901000977, 3.6429014205932617, 5.308036804199219, 2.8931357860565186, 6.121909141540527, 4.449947357177734, 4.571952819824219, 4.658499717712402, 6.411769866943359, 3.714203357696533, 3.8423032760620117, 5.2204766273498535, 2.607607364654541, 2.720442056655884, 5.834639549255371, 2.79327130317688, 3.6124565601348877, 7.157466888427734, 2.769294023513794, 4.000706195831299, 5.792145729064941, 4.614571571350098, 4.713320732116699, 4.308499336242676, 1.7258234024047852, 2.988259792327881, 5.035433292388916, 2.969322681427002, 6.399107933044434, 4.064362525939941, 3.2050986289978027, 4.803657531738281, 4.069611072540283, 4.79888391494751, 2.082573413848877, 4.421350479125977, 2.0658211708068848, 4.32731294631958], "mean_td_error": 4.1537675857543945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096405982971191, "actor_loss": -4.396982192993164, "critic_loss": 0.5205416679382324, "alpha_loss": -0.04242993891239166, "alpha_value": 0.9958063364028931, "log_alpha_value": -0.004202479030936956, "target_entropy": -6.0, "policy_t": 0.01020357757806778, "mean_q": 0.361126571893692, "max_q": 0.4462139308452606, "min_q": 0.29496246576309204}, "td_error": [2.6846909523010254, 5.8698015213012695, 3.4720544815063477, 1.2487378120422363, 1.5548834800720215, 2.304034948348999, 3.7416367530822754, 1.9068670272827148, 2.2219486236572266, 1.3025020360946655, 1.1602208614349365, 0.29998695850372314, 3.3005259037017822, 3.325939655303955, 2.539811134338379, 4.443850517272949, 3.143012046813965, 3.4599742889404297, 3.108067035675049, 2.0153398513793945, 2.192999839782715, 2.43473482131958, 2.2324986457824707, 1.9059219360351562, 2.6878647804260254, 5.2341437339782715, 1.706296443939209, 0.6945455074310303, 1.32334303855896, 2.2393887042999268, 2.7727880477905273, 1.047168254852295, 2.04502010345459, 3.3930883407592773, 1.7749481201171875, 3.957411766052246, 1.9906678199768066, 1.645876169204712, 1.8955011367797852, 2.100080728530884, 2.289243698120117, 3.028620719909668, 0.6991631984710693, 3.2904295921325684, 1.6445026397705078, 3.269700765609741, 2.9468212127685547, 1.1619067192077637, 2.0662126541137695, 1.7093790769577026, 1.4722797870635986, 0.8089695572853088, 1.7307978868484497, 3.6668128967285156, 3.638575553894043, 4.520994186401367, 0.8787363171577454, 3.235222816467285, 2.157857894897461, 3.2936899662017822, 2.7853426933288574, 1.3225905895233154, 0.3697071373462677, 1.8386998176574707, 2.234078884124756, 2.337070941925049, 2.133419990539551, 2.6758947372436523, 1.6306856870651245, 0.9100219011306763, 1.854180932044983, 3.523829460144043, 2.100579261779785, 1.5123157501220703, 2.0652856826782227, 2.6364541053771973, 3.303393602371216, 2.2853541374206543, 1.9227215051651, 3.0044329166412354, 2.586592435836792, 3.153918743133545, 0.8116605281829834, 2.7940025329589844, 3.4816184043884277, 1.0207419395446777], "mean_td_error": 2.350961446762085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078268051147461, "actor_loss": -4.374021053314209, "critic_loss": 0.7107686996459961, "alpha_loss": -0.042328525334596634, "alpha_value": 0.9958088397979736, "log_alpha_value": -0.004199980292469263, "target_entropy": -6.0, "policy_t": 0.03254600614309311, "mean_q": 0.3205007314682007, "max_q": 0.3940742313861847, "min_q": 0.2590499520301819}, "td_error": [1.3189343214035034, 0.9876055717468262, 3.0872607231140137, 3.009479522705078, 2.481398820877075, 1.5264787673950195, 0.8853996396064758, 2.70552396774292, 3.005007266998291, 1.0501682758331299, 5.139824867248535, 3.366011619567871, 2.6146655082702637, 2.3880105018615723, 3.500800609588623, 1.9573384523391724, 1.509406566619873, 0.8564275503158569, 2.3146705627441406, 1.1023379564285278, 1.8296167850494385, 0.4394606947898865, 3.564237117767334, 2.8661839962005615, 1.669278860092163, 0.8148491382598877, 1.9853935241699219, 2.9810760021209717, 3.6929380893707275, 4.361019611358643, 1.175105094909668, 1.101980447769165, 1.1929306983947754, 3.063927173614502, 2.172614574432373, 1.9776995182037354, 2.5586066246032715, 2.806155204772949, 1.8707448244094849, 2.576573371887207, 2.2641959190368652, 1.0982818603515625, 4.0395708084106445, 1.8603607416152954, 2.274195432662964, 1.7260072231292725, 1.3410279750823975, 1.3386116027832031, 2.241421699523926, 2.4252967834472656, 3.2265853881835938, 3.116591691970825, 0.0273086279630661, 0.8339247703552246, 2.7720141410827637, 2.27205228805542, 3.7513303756713867, 3.8090524673461914, 1.5044023990631104, 3.033524751663208, 3.1356492042541504, 1.742512583732605, 3.428905963897705, 3.3704910278320312, 3.4678397178649902, 1.0152256488800049, 2.8451290130615234, 4.286468505859375, 1.4244216680526733, 1.462416410446167, 3.134913444519043, 3.392751693725586, 2.594923496246338, 1.9075227975845337, 1.826735496520996, 1.329080581665039, 2.7641196250915527, 2.2474365234375, 2.1603546142578125, 3.785788059234619, 2.943840503692627, 1.6155498027801514, 1.4870295524597168, 1.9327986240386963, 2.9143662452697754, 2.7477283477783203], "mean_td_error": 2.3189172744750977, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.32855573329897, "num_env_steps_trained_throughput_per_sec": 138.30889216427582, "timesteps_total": 14336, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1967.451, "sample_time_ms": 1374.289, "load_time_ms": 0.53, "load_throughput": 486919.741, "learn_time_ms": 64.181, "learn_throughput": 4019.906, "synch_weights_time_ms": 14.708}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-53", "timestamp": 1700203013, "time_this_iter_s": 1.8793232440948486, "time_total_s": 33.371686697006226, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07430d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.371686697006226, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 85.05, "ram_util_percent": 92.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090426445007324, "actor_loss": -4.393265247344971, "critic_loss": 3.329400062561035, "alpha_loss": -0.045399732887744904, "alpha_value": 0.9955108165740967, "log_alpha_value": -0.004499287344515324, "target_entropy": -6.0, "policy_t": 0.05151354521512985, "mean_q": 0.38351279497146606, "max_q": 0.4620417654514313, "min_q": 0.3187536597251892}, "td_error": [3.984365224838257, 3.8032989501953125, 5.791022300720215, 3.9774632453918457, 4.772113800048828, 5.775731563568115, 5.032074928283691, 4.4121294021606445, 4.188148498535156, 4.5427446365356445, 4.829931259155273, 2.169318675994873, 5.3425517082214355, 3.461550235748291, 3.2553012371063232, 5.001705169677734, 3.1615371704101562, 5.075852394104004, 4.670287132263184, 4.029983997344971, 5.693251132965088, 3.606489658355713, 4.587466239929199, 2.861605644226074, 4.932075500488281, 4.355128288269043, 2.4899420738220215, 2.975121021270752, 4.743148326873779, 4.045654296875, 3.782952308654785, 2.9606590270996094, 4.552762508392334, 4.7612810134887695, 5.25216007232666, 3.2829694747924805, 3.722036600112915, 4.498215675354004, 5.40315580368042, 5.486483097076416, 4.2414045333862305, 4.566070556640625, 4.242084503173828, 5.310303688049316, 2.7790322303771973, 2.9806158542633057, 3.8818061351776123, 4.002139568328857, 2.910855293273926, 4.764711380004883, 2.5215635299682617, 5.150090217590332, 4.290726661682129, 4.2206621170043945, 4.415088653564453, 4.950745582580566, 4.616466999053955, 4.652218818664551, 2.6577343940734863, 4.831997871398926, 2.39988374710083, 5.388238906860352, 6.795839309692383, 3.9045605659484863, 5.160541534423828, 2.9166531562805176, 3.876173496246338, 3.942495584487915, 3.341193199157715, 4.47572660446167, 5.401721954345703, 5.360611915588379, 3.733527183532715, 3.6276204586029053, 3.035799026489258, 5.6300835609436035, 4.071316719055176, 4.579899311065674, 2.702169179916382, 4.10792350769043, 5.480385780334473, 6.558506965637207, 5.350276947021484, 2.835747003555298, 3.2316231727600098, 3.8533453941345215], "mean_td_error": 4.244393348693848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061843872070312, "actor_loss": -4.400909423828125, "critic_loss": 0.5247209072113037, "alpha_loss": -0.04530618339776993, "alpha_value": 0.9955073595046997, "log_alpha_value": -0.004502770956605673, "target_entropy": -6.0, "policy_t": -0.008697845041751862, "mean_q": 0.4077688753604889, "max_q": 0.4941462278366089, "min_q": 0.32344305515289307}, "td_error": [2.4923839569091797, 1.5334057807922363, 3.878261089324951, 1.216007947921753, 3.9689676761627197, 3.3623046875, 1.7828829288482666, 1.852123498916626, 2.7022171020507812, 3.8006985187530518, 1.2631652355194092, 1.3967746496200562, 3.2138710021972656, 1.2411353588104248, 1.9251590967178345, 0.6715781092643738, 1.604798674583435, 2.179543972015381, 2.7229723930358887, 3.9288690090179443, 2.8999292850494385, 5.275805473327637, 0.3944022059440613, 1.6088677644729614, 2.74678373336792, 1.241711139678955, 1.3328471183776855, 1.1245498657226562, 1.7498623132705688, 1.609572172164917, 2.9160823822021484, 4.1937971115112305, 2.993756055831909, 3.4996328353881836, 2.4281985759735107, 2.99523663520813, 3.1464622020721436, 2.3697397708892822, 2.4917309284210205, 2.2663841247558594, 1.6927183866500854, 2.635557174682617, 4.673321723937988, 1.8009040355682373, 2.111902952194214, 1.4063260555267334, 0.6702564358711243, 0.3418869078159332, 4.158464431762695, 2.7506794929504395, 3.571475028991699, 3.8109045028686523, 3.496786117553711, 2.8525357246398926, 1.9155218601226807, 3.6625771522521973, 2.3634438514709473, 2.035747528076172, 2.8603477478027344, 2.223517894744873, 0.6792314052581787, 1.9592732191085815, 2.9079346656799316, 2.9655513763427734, 0.8824731707572937, 2.2980079650878906, 1.0113447904586792, 3.0393004417419434, 1.4575450420379639, 2.778217315673828, 2.827761650085449, 2.177957057952881, 0.9150278568267822, 2.290865182876587, 3.4925050735473633, 1.320302128791809, 1.930625319480896, 2.4597015380859375, 3.5440468788146973, 0.38005316257476807, 2.651557445526123, 3.7630972862243652, 1.8420593738555908, 1.8690881729125977, 2.2269082069396973, 3.570897102355957], "mean_td_error": 2.375566005706787, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09440803527832, "actor_loss": -4.432900905609131, "critic_loss": 0.686416745185852, "alpha_loss": -0.045424193143844604, "alpha_value": 0.9955101609230042, "log_alpha_value": -0.004499936476349831, "target_entropy": -6.0, "policy_t": 0.019664505496621132, "mean_q": 0.3609340488910675, "max_q": 0.41818442940711975, "min_q": 0.31879445910453796}, "td_error": [0.8332509994506836, 4.157918930053711, 2.9854700565338135, 0.25983959436416626, 2.2121005058288574, 1.1984188556671143, 2.693434238433838, 2.4823520183563232, 1.9364269971847534, 2.4108285903930664, 3.2803306579589844, 3.60524320602417, 1.9668821096420288, 1.0052496194839478, 1.6823103427886963, 1.6116793155670166, 2.52439022064209, 0.11513940989971161, 2.602968215942383, 0.6637728214263916, 2.903596878051758, 2.474152088165283, 1.0561968088150024, 2.9875712394714355, 2.264066696166992, 2.813638687133789, 0.31967273354530334, 0.29044991731643677, 3.7953944206237793, 1.5198168754577637, 2.249551296234131, 2.9253296852111816, 0.07697588205337524, 1.4189932346343994, 3.1945061683654785, 3.2768936157226562, 2.0045595169067383, 1.5169601440429688, 3.9014902114868164, 1.4945433139801025, 0.5922660827636719, 1.9178433418273926, 4.441586017608643, 1.4993221759796143, 3.9934768676757812, 5.004212379455566, 1.9581232070922852, 1.6872104406356812, 3.9746527671813965, 2.7033958435058594, 0.13656938076019287, 1.8190903663635254, 0.5578199625015259, 2.5932483673095703, 2.6572248935699463, 1.9060962200164795, 2.3720059394836426, 1.3510801792144775, 2.048826217651367, 2.423022985458374, 0.9029629230499268, 2.760681629180908, 3.755467653274536, 2.4389829635620117, 1.7151029109954834, 0.6130295991897583, 2.12532377243042, 2.090442180633545, 2.4573607444763184, 1.8883671760559082, 2.1793079376220703, 2.1795082092285156, 2.284313917160034, 2.4878439903259277, 2.5000133514404297, 2.155302047729492, 4.341481685638428, 1.5791518688201904, 2.862990140914917, 2.03482723236084, 3.6620254516601562, 3.382187604904175, 3.6483421325683594, 2.3577704429626465, 1.0782867670059204, 4.771454811096191], "mean_td_error": 2.2395577430725098, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 452.40779797175304, "num_env_steps_trained_throughput_per_sec": 130.26920968383067, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1983.298, "sample_time_ms": 1388.757, "load_time_ms": 0.536, "load_throughput": 481653.283, "learn_time_ms": 64.185, "learn_throughput": 4019.637, "synch_weights_time_ms": 15.019}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-55", "timestamp": 1700203015, "time_this_iter_s": 1.9979209899902344, "time_total_s": 35.36960768699646, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.36960768699646, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 72.73333333333333, "ram_util_percent": 92.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088865280151367, "actor_loss": -4.430572509765625, "critic_loss": 3.322695255279541, "alpha_loss": -0.048417314887046814, "alpha_value": 0.9952124357223511, "log_alpha_value": -0.004799083806574345, "target_entropy": -6.0, "policy_t": -0.0043875230476260185, "mean_q": 0.42502376437187195, "max_q": 0.5001658797264099, "min_q": 0.37217116355895996}, "td_error": [4.747919082641602, 5.0045366287231445, 5.3244476318359375, 2.5376968383789062, 5.742940902709961, 2.8772759437561035, 5.288838863372803, 4.656851768493652, 6.228938579559326, 6.219337463378906, 4.027263641357422, 2.708489179611206, 1.0167465209960938, 3.6468734741210938, 2.463212490081787, 2.7773101329803467, 3.3348753452301025, 4.1448822021484375, 4.510298252105713, 4.391439437866211, 5.767636299133301, 3.4855294227600098, 5.496434688568115, 4.657121658325195, 5.248852729797363, 4.219911098480225, 4.203179359436035, 4.344669818878174, 4.883213043212891, 4.056467533111572, 2.1992063522338867, 2.754700183868408, 5.814640998840332, 4.06838846206665, 2.9093210697174072, 3.8110620975494385, 4.1002302169799805, 4.980872631072998, 3.1870923042297363, 4.838196754455566, 4.442873001098633, 6.1578826904296875, 3.786015033721924, 5.150262355804443, 2.7032346725463867, 4.075037002563477, 5.339003562927246, 4.0479278564453125, 3.4131648540496826, 4.366375923156738, 2.936389923095703, 4.195893287658691, 4.130179405212402, 3.935237407684326, 3.6436564922332764, 5.390909194946289, 4.844526290893555, 3.0685670375823975, 3.2225165367126465, 2.961854934692383, 4.817165374755859, 5.405539512634277, 2.973214626312256, 2.633467197418213, 4.789278507232666, 4.553781509399414, 6.581050872802734, 4.073219299316406, 3.425720691680908, 5.3366827964782715, 4.044845104217529, 3.074310779571533, 3.974559783935547, 4.893343925476074, 4.463566780090332, 3.3162598609924316, 3.5929198265075684, 3.5236830711364746, 2.0162353515625, 3.5198264122009277, 4.448818683624268, 4.539139747619629, 4.022047996520996, 4.4730939865112305, 4.588832855224609, 4.214781761169434], "mean_td_error": 4.137020587921143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119051933288574, "actor_loss": -4.501043796539307, "critic_loss": 0.5044561624526978, "alpha_loss": -0.04860219731926918, "alpha_value": 0.9952085018157959, "log_alpha_value": -0.004803038667887449, "target_entropy": -6.0, "policy_t": -0.04537517577409744, "mean_q": 0.4436853229999542, "max_q": 0.5418126583099365, "min_q": 0.3656041920185089}, "td_error": [2.3583645820617676, 3.2782042026519775, 2.5000295639038086, 1.011878252029419, 0.22221601009368896, 1.6049754619598389, 1.1386497020721436, 1.4229968786239624, 1.2145637273788452, 1.5857887268066406, 3.1617865562438965, 2.447300910949707, 0.5402960181236267, 3.3255860805511475, 4.035980224609375, 2.888223648071289, 0.911167323589325, 3.157557964324951, 0.2775508761405945, 0.9203789830207825, 1.8101481199264526, 0.5420246124267578, 1.5334458351135254, 1.2369569540023804, 3.472871780395508, 2.284315586090088, 2.3815135955810547, 2.1625494956970215, 1.642195224761963, 3.4155757427215576, 2.2752771377563477, 2.537114381790161, 4.489001274108887, 3.1063480377197266, 3.0064215660095215, 2.293468713760376, 2.022848129272461, 3.478367805480957, 1.071006417274475, 0.886752188205719, 0.7083353400230408, 1.3038535118103027, 2.9293904304504395, 4.369675636291504, 2.763190984725952, 2.550802707672119, 0.5380814075469971, 1.7822017669677734, 3.032472848892212, 1.8373968601226807, 1.8406469821929932, 2.8078420162200928, 1.6860690116882324, 2.441784143447876, 2.952322483062744, 1.6220667362213135, 2.6019809246063232, 4.433198928833008, 2.148716926574707, 2.256528854370117, 2.0976338386535645, 3.5619125366210938, 2.33151912689209, 2.202319622039795, 4.426051139831543, 2.8302769660949707, 1.9729084968566895, 1.2410778999328613, 2.8103058338165283, 4.089971542358398, 0.21145503222942352, 1.9394837617874146, 2.678709030151367, 2.0638067722320557, 4.4253644943237305, 3.5561647415161133, 2.340698003768921, 1.9686362743377686, 2.3793582916259766, 2.579235076904297, 3.405933380126953, 1.9934678077697754, 2.02239990234375, 3.0097336769104004, 2.201211452484131, 2.115149974822998], "mean_td_error": 2.287360906600952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121589660644531, "actor_loss": -4.5042314529418945, "critic_loss": 0.8650767803192139, "alpha_loss": -0.048582952469587326, "alpha_value": 0.9952115416526794, "log_alpha_value": -0.004799933172762394, "target_entropy": -6.0, "policy_t": 0.0070779952220618725, "mean_q": 0.40299877524375916, "max_q": 0.5041616559028625, "min_q": 0.3348400294780731}, "td_error": [3.020012855529785, 4.487427711486816, 2.7009377479553223, 2.328094244003296, 5.010687828063965, 2.131302833557129, 2.7530105113983154, 2.962627410888672, 3.086475372314453, 2.791260242462158, 3.8599162101745605, 2.283015012741089, 1.5530526638031006, 1.2920458316802979, 3.6325981616973877, 2.4614946842193604, 3.321028709411621, 2.2710046768188477, 3.0909485816955566, 2.1589040756225586, 1.453636884689331, 3.6739861965179443, 2.300344944000244, 2.5837483406066895, 3.4407196044921875, 2.4312806129455566, 2.5836663246154785, 2.8405137062072754, 1.0470283031463623, 3.142988681793213, 1.7898321151733398, 1.8403124809265137, 3.933638572692871, 2.180718421936035, 2.2058587074279785, 5.247488021850586, 2.8534035682678223, 1.078108549118042, 2.781634569168091, 2.5369925498962402, 1.7261250019073486, 0.8827672004699707, 1.9302117824554443, 2.6496260166168213, 3.6495556831359863, 3.7843174934387207, 0.9296875, 3.1781280040740967, 2.6991560459136963, 0.05700799822807312, 2.0371224880218506, 3.2772343158721924, 2.7072768211364746, 2.674675941467285, 2.5696215629577637, 2.3939881324768066, 2.1586642265319824, 2.147258758544922, 3.2226858139038086, 3.828604221343994, 1.9792298078536987, 1.939915418624878, 2.9679927825927734, 2.8817882537841797, 2.5758004188537598, 2.5232129096984863, 1.6464287042617798, 4.263467788696289, 3.6704254150390625, 3.6270394325256348, 4.413848400115967, 2.1195178031921387, 3.753948211669922, 3.761620044708252, 3.1711597442626953, 1.9470558166503906, 2.8800764083862305, 3.3268613815307617, 3.483839988708496, 3.2806029319763184, 0.33535516262054443, 1.71732497215271, 2.0816237926483154, 1.6318764686584473, 2.353097915649414, 3.136471748352051], "mean_td_error": 2.664128065109253, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 436.1677027608429, "num_env_steps_trained_throughput_per_sec": 125.59293226818913, "timesteps_total": 16128, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1994.481, "sample_time_ms": 1397.535, "load_time_ms": 0.535, "load_throughput": 482490.829, "learn_time_ms": 64.158, "learn_throughput": 4021.353, "synch_weights_time_ms": 15.155}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 4386, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 4386, "last_target_update_ts": 16128, "num_target_updates": 17}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-57", "timestamp": 1700203017, "time_this_iter_s": 2.072723865509033, "time_total_s": 37.44233155250549, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.44233155250549, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.76666666666667, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125349998474121, "actor_loss": -4.505683422088623, "critic_loss": 3.141416311264038, "alpha_loss": -0.051628440618515015, "alpha_value": 0.9949140548706055, "log_alpha_value": -0.005098929163068533, "target_entropy": -6.0, "policy_t": 0.011482791043817997, "mean_q": 0.4738352596759796, "max_q": 0.5702240467071533, "min_q": 0.39556753635406494}, "td_error": [5.02805233001709, 2.932858467102051, 3.641329526901245, 4.028497695922852, 5.4636006355285645, 4.164776802062988, 4.094301700592041, 3.881722927093506, 2.5277750492095947, 5.379578113555908, 3.7748990058898926, 5.419594764709473, 2.1943161487579346, 4.279322624206543, 6.342001914978027, 2.5068278312683105, 4.611321449279785, 4.674384117126465, 2.228276491165161, 2.4158082008361816, 1.9497690200805664, 3.8790454864501953, 4.865699768066406, 4.66033935546875, 4.821530818939209, 4.850133419036865, 4.528293609619141, 2.6256251335144043, 5.089177131652832, 1.4065215587615967, 4.083683013916016, 5.888749122619629, 4.454734802246094, 3.6280465126037598, 2.8421201705932617, 1.7281286716461182, 4.713576316833496, 4.239721298217773, 5.276636123657227, 5.574127197265625, 4.197598457336426, 4.118447780609131, 5.444291114807129, 3.185590982437134, 2.2286648750305176, 3.3506078720092773, 2.6423115730285645, 3.8856000900268555, 3.5195536613464355, 3.3024654388427734, 3.6588661670684814, 4.903141975402832, 4.234609603881836, 3.897768974304199, 3.271663188934326, 4.9222564697265625, 3.8485138416290283, 2.0635390281677246, 4.296249866485596, 3.2344207763671875, 3.6637043952941895, 5.068201065063477, 3.7154381275177, 4.82310676574707, 3.450056552886963, 3.052987813949585, 3.1234281063079834, 4.337437629699707, 4.147622585296631, 3.41995906829834, 2.1106691360473633, 3.2474255561828613, 4.492011070251465, 4.700552940368652, 4.8951897621154785, 2.721090316772461, 2.978883981704712, 5.642049789428711, 4.6016998291015625, 3.663572072982788, 3.682680606842041, 2.7706308364868164, 2.043534278869629, 2.772408962249756, 3.895378351211548, 4.277091026306152], "mean_td_error": 3.8627662658691406, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096677780151367, "actor_loss": -4.5128607749938965, "critic_loss": 0.4570401906967163, "alpha_loss": -0.05152726545929909, "alpha_value": 0.9949095845222473, "log_alpha_value": -0.005103388335555792, "target_entropy": -6.0, "policy_t": -0.015182754024863243, "mean_q": 0.49589839577674866, "max_q": 0.616542637348175, "min_q": 0.41018548607826233}, "td_error": [2.1578986644744873, 2.914902687072754, 2.1489813327789307, 2.795201301574707, 1.0273478031158447, 2.649566173553467, 2.1038784980773926, 3.213139533996582, 2.631612777709961, 1.3446671962738037, 3.4175989627838135, 0.7927053570747375, 1.0153636932373047, 1.5471339225769043, 1.2594373226165771, 0.9550725221633911, 3.6362175941467285, 0.8976419568061829, 3.3842763900756836, 2.461524486541748, 1.6634671688079834, 0.48983442783355713, 2.107268810272217, 3.47086501121521, 3.033679246902466, 0.8631086349487305, 3.186671733856201, 0.45744776725769043, 3.1294939517974854, 1.9542040824890137, 2.584826946258545, 3.776567220687866, 3.305621385574341, 2.448925733566284, 2.464754819869995, 3.9538817405700684, 3.8331661224365234, 2.570096731185913, 1.8148109912872314, 4.066460609436035, 1.8147101402282715, 1.4527671337127686, 2.337001085281372, 1.9276474714279175, 1.345576524734497, 3.2812862396240234, 3.1628870964050293, 2.0767054557800293, 1.5483965873718262, 1.3074262142181396, 1.544693112373352, 1.22395920753479, 0.5210593342781067, 1.9213643074035645, 2.565755844116211, 2.734649658203125, 2.7898755073547363, 0.36137282848358154, 2.0396018028259277, 1.7854490280151367, 2.96445369720459, 1.3006680011749268, 2.581742763519287, 2.5283737182617188, 1.805504560470581, 2.68302583694458, 0.4425541162490845, 2.4493818283081055, 1.662952184677124, 4.639404296875, 1.0520374774932861, 1.3236664533615112, 0.3440858721733093, 2.9554989337921143, 3.2725443840026855, 0.935890793800354, 3.4392871856689453, 2.2332940101623535, 1.6516971588134766, 3.364743709564209, 1.9257135391235352, 0.5450313091278076, 1.6780173778533936, 1.5473406314849854, 0.07172881066799164, 3.0101561546325684], "mean_td_error": 2.135817289352417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08581829071045, "actor_loss": -4.509428024291992, "critic_loss": 0.6902949213981628, "alpha_loss": -0.051437798887491226, "alpha_value": 0.9949129819869995, "log_alpha_value": -0.005100012291222811, "target_entropy": -6.0, "policy_t": -0.024179648607969284, "mean_q": 0.44947704672813416, "max_q": 0.5565265417098999, "min_q": 0.38880735635757446}, "td_error": [1.6122955083847046, 3.3051259517669678, 2.8386597633361816, 2.413738965988159, 1.9637959003448486, 1.3095338344573975, 2.0983664989471436, 2.085958957672119, 0.03746727108955383, 3.404315948486328, 2.2685298919677734, 2.7722599506378174, 4.402177810668945, 2.5747222900390625, 0.5608319044113159, 2.722907543182373, 1.2805849313735962, 1.9590864181518555, 2.3555474281311035, 2.2120609283447266, 3.167778730392456, 1.6065560579299927, 2.383159875869751, 1.6165173053741455, 2.220078229904175, 0.677220344543457, 2.1238009929656982, 3.525815486907959, 2.900078058242798, 1.4417973756790161, 1.3132758140563965, 3.309501886367798, 2.7250704765319824, 3.596283435821533, 2.7708334922790527, 3.5072765350341797, 1.7562772035598755, 0.8849607706069946, 2.064518928527832, 5.061030387878418, 1.1211261749267578, 4.036182403564453, 2.0513229370117188, 3.2391183376312256, 2.8646717071533203, 2.3626363277435303, 0.6984314918518066, 2.162914276123047, 2.529489755630493, 2.5506107807159424, 3.139404296875, 3.8128232955932617, 0.6051083207130432, 0.0682191252708435, 1.6500681638717651, 3.8732705116271973, 0.5981538891792297, 0.8857928514480591, 2.3651061058044434, 1.4625229835510254, 3.7070488929748535, 1.8577944040298462, 4.042909622192383, 2.9564740657806396, 2.0522818565368652, 1.8057854175567627, 2.424085855484009, 2.7925033569335938, 3.9002633094787598, 1.2281970977783203, 0.7234847545623779, 1.5987385511398315, 2.899991512298584, 2.1457858085632324, 3.2328684329986572, 2.968479633331299, 3.50960111618042, 2.4832959175109863, 1.5178170204162598, 0.9120705127716064, 2.339782953262329, 1.2687230110168457, 1.86077880859375, 3.064241409301758, 1.118319034576416, 1.3057856559753418], "mean_td_error": 2.263068199157715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 367.5967908977622, "num_env_steps_trained_throughput_per_sec": 105.84818309332884, "timesteps_total": 17024, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 2053.623, "sample_time_ms": 1432.173, "load_time_ms": 0.537, "load_throughput": 480327.77, "learn_time_ms": 64.148, "learn_throughput": 4021.923, "synch_weights_time_ms": 15.207}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "939a2_00000", "date": "2023-11-16_22-36-59", "timestamp": 1700203019, "time_this_iter_s": 2.453740119934082, "time_total_s": 39.896071672439575, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07725e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.896071672439575, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 63.25000000000001, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.172986030578613, "actor_loss": -4.602542400360107, "critic_loss": 2.972992420196533, "alpha_loss": -0.054922763258218765, "alpha_value": 0.9946156740188599, "log_alpha_value": -0.005398883484303951, "target_entropy": -6.0, "policy_t": -0.020325802266597748, "mean_q": 0.5250754356384277, "max_q": 0.6184929013252258, "min_q": 0.45624083280563354}, "td_error": [5.233102798461914, 3.755671501159668, 2.4894309043884277, 2.8015565872192383, 3.7528274059295654, 4.301688194274902, 2.1592917442321777, 3.087949275970459, 3.843874216079712, 2.2028119564056396, 4.782967567443848, 4.274439811706543, 4.086455345153809, 5.306022644042969, 6.199642181396484, 3.28947114944458, 5.543277263641357, 3.758969783782959, 5.38553524017334, 4.141820430755615, 2.8781774044036865, 2.2098984718322754, 4.341257572174072, 3.974801540374756, 3.54630446434021, 2.387204647064209, 3.343295097351074, 5.440908908843994, 3.3017454147338867, 2.631633758544922, 3.102919578552246, 4.600771427154541, 4.975142955780029, 1.4226264953613281, 4.829885482788086, 2.355408191680908, 2.0760016441345215, 4.49079704284668, 3.065272092819214, 2.273825168609619, 3.0639729499816895, 4.695784568786621, 3.13887357711792, 2.7545523643493652, 2.8262462615966797, 3.4446005821228027, 3.3986926078796387, 5.045891761779785, 4.521439075469971, 5.348441123962402, 4.848482131958008, 4.3723955154418945, 5.83261775970459, 3.9953317642211914, 3.1007962226867676, 1.0142616033554077, 3.339850902557373, 4.063932418823242, 3.9196701049804688, 4.289028167724609, 4.606491565704346, 3.877584934234619, 2.9310624599456787, 5.232430458068848, 3.119072914123535, 4.261669158935547, 3.8741047382354736, 3.2313759326934814, 4.321804046630859, 3.627319574356079, 6.288550853729248, 2.6426925659179688, 2.7296793460845947, 3.6428017616271973, 2.7920703887939453, 2.8111205101013184, 6.598197937011719, 2.9507250785827637, 5.166216850280762, 2.873117446899414, 2.9828100204467773, 2.7504539489746094, 2.5304088592529297, 4.805936813354492, 3.08170747756958, 2.3798041343688965], "mean_td_error": 3.7298693656921387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.167521476745605, "actor_loss": -4.622629165649414, "critic_loss": 0.4465556740760803, "alpha_loss": -0.05494290217757225, "alpha_value": 0.9946107864379883, "log_alpha_value": -0.005403765011578798, "target_entropy": -6.0, "policy_t": 0.001868310384452343, "mean_q": 0.5520603060722351, "max_q": 0.6921854019165039, "min_q": 0.4445418119430542}, "td_error": [2.344970941543579, 1.1835732460021973, 3.3730783462524414, 2.260849714279175, 1.0477699041366577, 2.2019968032836914, 1.3302063941955566, 4.324796676635742, 2.4869813919067383, 3.7011356353759766, 3.900477170944214, 1.0323188304901123, 2.3744349479675293, 2.6939444541931152, 2.46651554107666, 0.8624545931816101, 2.0303397178649902, 1.9690570831298828, 1.2333364486694336, 2.388704538345337, 1.2769986391067505, 2.650639772415161, 3.1951260566711426, 3.3995680809020996, 1.9431047439575195, 0.5773279666900635, 3.7234020233154297, 0.8677101731300354, 3.143796920776367, 0.7812647819519043, 1.6230849027633667, 1.2448210716247559, 3.686583995819092, 0.06864222884178162, 1.8791086673736572, 2.0391767024993896, 0.08863028883934021, 1.6343406438827515, 1.6863934993743896, 0.6513147354125977, 2.0424675941467285, 3.957993507385254, 3.2837142944335938, 0.40219011902809143, 1.3276426792144775, 3.0009708404541016, 1.4759572744369507, 2.1941723823547363, 1.709446907043457, 4.725711345672607, 2.310854911804199, 1.8951292037963867, 1.3408548831939697, 1.9050103425979614, 2.3007166385650635, 1.8545610904693604, 0.9547196626663208, 1.8011332750320435, 1.9415068626403809, 2.8550052642822266, 2.7167863845825195, 1.5014171600341797, 3.4627490043640137, 1.0044504404067993, 0.472971111536026, 1.8929448127746582, 2.780937671661377, 1.9067959785461426, 0.6821205615997314, 1.280336618423462, 3.9437997341156006, 4.389883995056152, 3.3279318809509277, 1.5733147859573364, 1.6798151731491089, 1.4863228797912598, 3.350430965423584, 1.346618413925171, 2.8539891242980957, 2.780550479888916, 1.5608055591583252, 4.399764060974121, 0.27843618392944336, 2.301067352294922, 1.6026219129562378, 1.5290400981903076], "mean_td_error": 2.1017863750457764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165874481201172, "actor_loss": -4.638862609863281, "critic_loss": 0.7322503328323364, "alpha_loss": -0.05489668622612953, "alpha_value": 0.9946144819259644, "log_alpha_value": -0.005400094669312239, "target_entropy": -6.0, "policy_t": -0.028766876086592674, "mean_q": 0.507117509841919, "max_q": 0.6322429180145264, "min_q": 0.4125610291957855}, "td_error": [4.792209625244141, 0.9065638184547424, 3.3981404304504395, 2.387078046798706, 3.6398284435272217, 2.3481311798095703, 2.3523316383361816, 1.648094892501831, 2.143515110015869, 2.2415847778320312, 2.4541327953338623, 1.7262991666793823, 2.5763015747070312, 2.6444449424743652, 0.2782178819179535, 2.975522756576538, 1.7158044576644897, 2.2162656784057617, 1.2053422927856445, 1.9136497974395752, 2.96077561378479, 3.204590320587158, 1.9689085483551025, 2.974775791168213, 0.691321074962616, 2.244227409362793, 1.4368289709091187, 0.626057505607605, 3.327240467071533, 0.6717435121536255, 3.5849435329437256, 3.899829864501953, 1.9258781671524048, 0.906219482421875, 0.855996310710907, 2.8752241134643555, 2.5786056518554688, 2.567290782928467, 5.018590927124023, 1.9419028759002686, 2.633321762084961, 3.8294103145599365, 3.1594676971435547, 4.451063632965088, 3.034905195236206, 2.5709762573242188, 2.1717305183410645, 2.799835205078125, 1.844802975654602, 3.1742613315582275, 3.0867958068847656, 1.4289363622665405, 4.163866996765137, 2.181014060974121, 1.6554045677185059, 1.1821033954620361, 1.7274689674377441, 0.21518303453922272, 1.7281897068023682, 1.0603106021881104, 1.0353004932403564, 4.003179550170898, 3.01621150970459, 3.352712631225586, 2.5322766304016113, 2.9454638957977295, 2.9606332778930664, 2.770801067352295, 1.9633378982543945, 0.5398561954498291, 2.6293845176696777, 0.8983289003372192, 0.44802889227867126, 4.062543869018555, 3.104617118835449, 4.373102188110352, 3.289402484893799, 2.0970726013183594, 2.3506994247436523, 1.1545658111572266, 1.956406831741333, 2.06061053276062, 1.9148744344711304, 3.8364968299865723, 1.6269885301589966, 0.630805253982544], "mean_td_error": 2.3427579402923584, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 492.27553099684417, "num_env_steps_trained_throughput_per_sec": 141.74898102364486, "timesteps_total": 17920, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 2051.771, "sample_time_ms": 1431.563, "load_time_ms": 0.539, "load_throughput": 478226.282, "learn_time_ms": 63.998, "learn_throughput": 4031.381, "synch_weights_time_ms": 15.617}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 4902, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 4902, "last_target_update_ts": 17920, "num_target_updates": 19}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-01", "timestamp": 1700203021, "time_this_iter_s": 1.833235263824463, "time_total_s": 41.72930693626404, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.72930693626404, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 64.39999999999999, "ram_util_percent": 92.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06981086730957, "actor_loss": -4.5427937507629395, "critic_loss": 2.9068756103515625, "alpha_loss": -0.05738802254199982, "alpha_value": 0.9943171739578247, "log_alpha_value": -0.00569901755079627, "target_entropy": -6.0, "policy_t": 0.036315418779850006, "mean_q": 0.5857624411582947, "max_q": 0.7106900215148926, "min_q": 0.477067232131958}, "td_error": [2.5233981609344482, 4.76910400390625, 3.7556498050689697, 3.617091417312622, 3.1528987884521484, 4.492954730987549, 3.415696859359741, 3.5840673446655273, 3.7455151081085205, 3.475325107574463, 3.449573040008545, 4.350732803344727, 3.647037982940674, 3.915722370147705, 2.0646824836730957, 1.032448410987854, 2.7914977073669434, 1.3116486072540283, 3.6243677139282227, 3.8863472938537598, 5.972929954528809, 4.930812835693359, 4.606342315673828, 5.5154829025268555, 3.154782295227051, 3.759519100189209, 3.696899890899658, 3.5148391723632812, 3.92573881149292, 4.069494724273682, 4.529523849487305, 3.1836678981781006, 3.3577795028686523, 2.5676214694976807, 3.6990203857421875, 1.4297490119934082, 6.12258243560791, 2.5240318775177, 0.9068886041641235, 3.0884411334991455, 5.877866268157959, 4.352518081665039, 3.2103466987609863, 3.788236618041992, 5.3290252685546875, 5.37935733795166, 1.9661524295806885, 4.559789657592773, 4.910227298736572, 3.9828133583068848, 5.8489508628845215, 3.520988941192627, 5.192145347595215, 2.1628458499908447, 4.646777153015137, 3.3920981884002686, 3.717667579650879, 3.512338876724243, 2.810755968093872, 2.6687207221984863, 4.6439971923828125, 4.832930088043213, 3.1280899047851562, 5.219465255737305, 2.4173126220703125, 4.2742509841918945, 4.719407081604004, 5.147801399230957, 2.7550368309020996, 4.471283912658691, 2.9121975898742676, 2.5962443351745605, 2.9297361373901367, 3.5552473068237305, 4.846301555633545, 4.52711296081543, 3.059248924255371, 3.425510883331299, 3.2597413063049316, 4.534069061279297, 3.4595999717712402, 4.818094253540039, 1.5487964153289795, 2.8933420181274414, 4.311032295227051, 4.127986907958984], "mean_td_error": 3.7256438732147217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12244987487793, "actor_loss": -4.62837028503418, "critic_loss": 0.4536135494709015, "alpha_loss": -0.057741429656744, "alpha_value": 0.9943119287490845, "log_alpha_value": -0.005704293958842754, "target_entropy": -6.0, "policy_t": -0.01868303492665291, "mean_q": 0.6039037704467773, "max_q": 0.7566984295845032, "min_q": 0.47629889845848083}, "td_error": [2.740649461746216, 3.0942201614379883, 3.1137614250183105, 1.9501817226409912, 2.6454548835754395, 1.8770304918289185, 1.142137885093689, 1.4343607425689697, 1.8112534284591675, 1.3075647354125977, 2.9350123405456543, 2.551689624786377, 3.071702480316162, 0.841335654258728, 1.370938777923584, 2.335946798324585, 0.8113300800323486, 2.5654120445251465, 0.17044806480407715, 1.9153417348861694, 1.3154144287109375, 3.1498637199401855, 1.1994659900665283, 2.567171096801758, 3.108734130859375, 0.5121015310287476, 1.1333911418914795, 1.4407708644866943, 2.877772569656372, 1.5581644773483276, 2.9359183311462402, 0.12438327074050903, 2.862034797668457, 2.9830751419067383, 1.4576903581619263, 0.9321946501731873, 1.830167293548584, 2.6038455963134766, 2.950211524963379, 4.296041488647461, 3.2997395992279053, 3.344224452972412, 1.8381625413894653, 1.4959211349487305, 2.9850900173187256, 1.781593918800354, 2.27634859085083, 1.3864741325378418, 1.6462329626083374, 2.690548896789551, 1.2500983476638794, 2.522538661956787, 2.5767011642456055, 0.50581955909729, 0.2208990603685379, 1.3008079528808594, 2.5467281341552734, 2.2882556915283203, 3.303384780883789, 0.6097510457038879, 3.082184076309204, 3.432288646697998, 2.9716877937316895, 1.9065626859664917, 4.662249565124512, 2.7493467330932617, 0.4250713288784027, 1.0283148288726807, 1.4773284196853638, 3.991154909133911, 2.006897211074829, 2.1235742568969727, 1.664547085762024, 2.45701265335083, 1.8113324642181396, 2.075481414794922, 2.055126905441284, 1.4778451919555664, 1.7680732011795044, 2.4481101036071777, 3.228101968765259, 2.2995903491973877, 1.664905309677124, 3.178677558898926, 3.386272430419922, 2.563891887664795], "mean_td_error": 2.1317341327667236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089707374572754, "actor_loss": -4.621331691741943, "critic_loss": 0.6501615643501282, "alpha_loss": -0.05751464515924454, "alpha_value": 0.9943158626556396, "log_alpha_value": -0.005700328387320042, "target_entropy": -6.0, "policy_t": -0.015654807910323143, "mean_q": 0.554628312587738, "max_q": 0.6501357555389404, "min_q": 0.45728495717048645}, "td_error": [1.48903226852417, 1.430673360824585, 0.9978745579719543, 1.1109635829925537, 3.072798728942871, 1.714097261428833, 1.8791217803955078, 4.440071105957031, 0.43867307901382446, 0.2121051847934723, 2.2268524169921875, 3.2065277099609375, 0.9744960069656372, 4.0273308753967285, 2.020481586456299, 3.716581344604492, 3.564098834991455, 0.43751955032348633, 2.022421360015869, 1.6254456043243408, 2.718669891357422, 1.7754769325256348, 2.1500396728515625, 1.54329514503479, 0.834563136100769, 0.8250365853309631, 1.5586707592010498, 0.798563539981842, 3.802507162094116, 2.4275946617126465, 3.265218734741211, 3.1828932762145996, 1.1218435764312744, 1.60155189037323, 1.451167106628418, 3.044931411743164, 1.3035197257995605, 2.579226016998291, 2.4864132404327393, 1.8204317092895508, 1.0864155292510986, 1.1102386713027954, 2.5294718742370605, 3.392681121826172, 2.468902111053467, 0.856221616268158, 2.47349214553833, 0.740955114364624, 4.244792938232422, 1.893488883972168, 2.6222591400146484, 3.5173938274383545, 0.6312487125396729, 1.0444992780685425, 2.1530134677886963, 1.3943569660186768, 3.421058416366577, 2.486003875732422, 2.3381142616271973, 1.4172773361206055, 1.8283817768096924, 1.7557129859924316, 3.202993392944336, 3.1051321029663086, 2.6754324436187744, 2.480898857116699, 2.430037498474121, 2.6673526763916016, 2.6753289699554443, 2.8582630157470703, 0.9047412872314453, 0.8568510413169861, 2.5928611755371094, 0.4430781900882721, 2.183980941772461, 1.8964252471923828, 2.6138248443603516, 2.018773078918457, 3.8258492946624756, 1.5604809522628784, 1.9946435689926147, 3.237612724304199, 5.365510940551758, 3.5127172470092773, 1.6583528518676758, 2.491623878479004], "mean_td_error": 2.1576454639434814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.0433770274862, "num_env_steps_trained_throughput_per_sec": 138.2267759744324, "timesteps_total": 18816, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 2014.622, "sample_time_ms": 1393.368, "load_time_ms": 0.539, "load_throughput": 478691.689, "learn_time_ms": 63.692, "learn_throughput": 4050.738, "synch_weights_time_ms": 15.528}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-03", "timestamp": 1700203023, "time_this_iter_s": 1.882256269454956, "time_total_s": 43.611563205718994, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.611563205718994, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 88.75, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102400779724121, "actor_loss": -4.635574817657471, "critic_loss": 2.672023296356201, "alpha_loss": -0.060605403035879135, "alpha_value": 0.9940188527107239, "log_alpha_value": -0.005999109707772732, "target_entropy": -6.0, "policy_t": -0.011415800079703331, "mean_q": 0.6536740064620972, "max_q": 0.7402895092964172, "min_q": 0.5637592077255249}, "td_error": [3.56379771232605, 3.8070666790008545, 4.57211971282959, 3.016735792160034, 4.315725326538086, 3.738257884979248, 4.036774635314941, 4.833898544311523, 4.428574562072754, 1.688413143157959, 3.262014389038086, 4.393987655639648, 5.192716598510742, 4.57560396194458, 1.3679919242858887, 3.9621267318725586, 5.083864212036133, 2.6407320499420166, 3.8506500720977783, 2.313035249710083, 4.3228559494018555, 2.944427967071533, 3.178147315979004, 2.3654844760894775, 1.8143272399902344, 2.54472017288208, 5.261252403259277, 4.334221839904785, 4.444028854370117, 2.6456191539764404, 3.6778011322021484, 2.3247838020324707, 4.742611885070801, 3.1580395698547363, 3.433901071548462, 4.130159378051758, 3.0078039169311523, 3.7838335037231445, 3.145951747894287, 3.9705471992492676, 4.633604049682617, 2.845540761947632, 3.462921142578125, 4.141172885894775, 4.472681045532227, 2.2839770317077637, 3.3007242679595947, 3.9292311668395996, 5.630209445953369, 2.7109131813049316, 1.9209893941879272, 3.204404830932617, 3.4969539642333984, 3.7885663509368896, 3.4122414588928223, 3.1981427669525146, 3.0071372985839844, 3.5574920177459717, 3.099959373474121, 1.4262874126434326, 2.337960720062256, 2.407567024230957, 4.919806957244873, 3.316786527633667, 1.9990010261535645, 4.634896278381348, 4.015298843383789, 3.4306082725524902, 2.921584129333496, 4.12180233001709, 2.973790168762207, 3.6799755096435547, 3.351783275604248, 3.959723711013794, 2.6517577171325684, 4.117412090301514, 3.1803297996520996, 3.031951904296875, 2.408496379852295, 4.016680717468262, 3.7049500942230225, 3.073937177658081, 4.189693450927734, 2.3360962867736816, 6.228586196899414, 1.8942155838012695], "mean_td_error": 3.4918887615203857, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093087196350098, "actor_loss": -4.648961544036865, "critic_loss": 0.46722590923309326, "alpha_loss": -0.06060764566063881, "alpha_value": 0.9940131306648254, "log_alpha_value": -0.006004866678267717, "target_entropy": -6.0, "policy_t": -0.02204497903585434, "mean_q": 0.6860059499740601, "max_q": 0.8316687941551208, "min_q": 0.5391416549682617}, "td_error": [3.0569095611572266, 1.0940163135528564, 0.6273635029792786, 1.0081251859664917, 2.5752310752868652, 2.4603800773620605, 0.7746564149856567, 3.0160045623779297, 1.8099042177200317, 1.9611035585403442, 2.594299077987671, 0.2673981785774231, 2.5456480979919434, 0.34226372838020325, 3.758126735687256, 2.0573558807373047, 0.346363365650177, 3.4882235527038574, 0.08548882603645325, 2.224574089050293, 2.5305700302124023, 1.1575055122375488, 1.9600352048873901, 1.7730343341827393, 2.9310808181762695, 2.9876437187194824, 2.919175624847412, 2.987487316131592, 2.0746960639953613, 2.8611037731170654, 1.3895232677459717, 1.4920353889465332, 0.2390199899673462, 0.34100109338760376, 1.2674140930175781, 2.531215190887451, 4.182173728942871, 1.5622830390930176, 1.5666468143463135, 2.955657958984375, 0.7220953702926636, 2.8809874057769775, 1.773339033126831, 3.4451966285705566, 4.043151378631592, 1.3027734756469727, 1.9215874671936035, 2.8140721321105957, 2.7273459434509277, 3.480282783508301, 1.0436930656433105, 2.9607043266296387, 3.949069023132324, 2.848731279373169, 2.7679619789123535, 1.7722558975219727, 1.3863967657089233, 2.2327089309692383, 3.9090535640716553, 4.181248188018799, 1.9728472232818604, 2.0355379581451416, 2.3053712844848633, 1.4115289449691772, 1.4410728216171265, 0.14567479491233826, 2.4171833992004395, 3.649465322494507, 4.041802406311035, 3.462191104888916, 2.8877573013305664, 1.8376598358154297, 1.3384284973144531, 0.9247829914093018, 3.246857166290283, 3.197481155395508, 1.5493897199630737, 2.3965044021606445, 0.4937058091163635, 2.385464668273926, 1.9641021490097046, 1.1359710693359375, 1.1287682056427002, 2.8332602977752686, 2.8408656120300293, 1.4652615785598755], "mean_td_error": 2.145050525665283, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093646049499512, "actor_loss": -4.681708812713623, "critic_loss": 0.6329410076141357, "alpha_loss": -0.06056739389896393, "alpha_value": 0.9940174221992493, "log_alpha_value": -0.0060005467385053635, "target_entropy": -6.0, "policy_t": -0.0019284287700429559, "mean_q": 0.6232407093048096, "max_q": 0.7480821013450623, "min_q": 0.5288619995117188}, "td_error": [1.3967833518981934, 0.21081584692001343, 1.6669656038284302, 2.3245792388916016, 1.5435941219329834, 2.0556492805480957, 2.0699832439422607, 1.606614351272583, 0.7711625099182129, 1.7025721073150635, 0.0940590500831604, 2.9958555698394775, 2.0849709510803223, 1.4515047073364258, 0.7835109829902649, 1.4819015264511108, 2.635195255279541, 1.6293251514434814, 1.9369537830352783, 0.9022612571716309, 3.33113694190979, 3.002808094024658, 2.838007688522339, 0.39012548327445984, 2.645184278488159, 1.8210556507110596, 2.123422622680664, 2.012690544128418, 2.232999801635742, 3.2878150939941406, 4.925307273864746, 4.945433616638184, 2.998490810394287, 1.5227149724960327, 2.872323751449585, 2.7482247352600098, 0.043140918016433716, 1.1665772199630737, 1.7957125902175903, 2.0064873695373535, 0.14508751034736633, 1.9889286756515503, 2.389281988143921, 2.752887487411499, 4.068480014801025, 0.8477095365524292, 0.40517449378967285, 2.376037120819092, 3.8778433799743652, 1.8954694271087646, 0.30160680413246155, 1.582321047782898, 2.404827117919922, 1.2424508333206177, 3.8552818298339844, 3.272322654724121, 3.151869773864746, 3.0071966648101807, 2.066347360610962, 2.9870786666870117, 2.7461905479431152, 1.9487018585205078, 0.8658387660980225, 2.282172679901123, 2.5828042030334473, 3.626277446746826, 2.460045337677002, 0.08094888925552368, 2.303102731704712, 0.7497209310531616, 0.8255681991577148, 0.8044024705886841, 1.7430824041366577, 1.8719274997711182, 2.7877492904663086, 1.2605984210968018, 3.0651726722717285, 4.214908599853516, 2.4652132987976074, 3.390632152557373, 1.9300503730773926, 2.6039884090423584, 2.177128791809082, 0.04288884997367859, 3.0360586643218994, 2.1345040798187256], "mean_td_error": 2.0775792598724365, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.69746030609724, "num_env_steps_trained_throughput_per_sec": 134.9597597756396, "timesteps_total": 19712, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1962.283, "sample_time_ms": 1361.58, "load_time_ms": 0.539, "load_throughput": 478776.406, "learn_time_ms": 63.525, "learn_throughput": 4061.379, "synch_weights_time_ms": 15.748}, "counters": {"num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-05", "timestamp": 1700203025, "time_this_iter_s": 1.9262340068817139, "time_total_s": 45.53779721260071, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052649d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.53779721260071, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 66.5, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074801445007324, "actor_loss": -4.667682647705078, "critic_loss": 2.717960834503174, "alpha_loss": -0.0634634792804718, "alpha_value": 0.9937205910682678, "log_alpha_value": -0.00629922840744257, "target_entropy": -6.0, "policy_t": 0.024472787976264954, "mean_q": 0.71330726146698, "max_q": 0.8470979332923889, "min_q": 0.5957768559455872}, "td_error": [2.656214714050293, 2.131505250930786, 5.242968559265137, 4.478626251220703, 3.1928510665893555, 4.9923295974731445, 3.124852180480957, 4.166661262512207, 3.302919387817383, 3.3052115440368652, 3.2781152725219727, 5.239521026611328, 2.4438412189483643, 4.868968963623047, 2.7819175720214844, 4.347873687744141, 5.121801376342773, 5.153530120849609, 3.454744338989258, 3.760059118270874, 3.403482437133789, 2.0995569229125977, 3.9240317344665527, 4.138622283935547, 3.1081831455230713, 3.7103540897369385, 3.7093634605407715, 0.9136744737625122, 1.131765604019165, 4.521804332733154, 5.439756393432617, 2.9757890701293945, 3.6406102180480957, 4.02778434753418, 3.2184410095214844, 4.336885452270508, 3.1677680015563965, 4.7458319664001465, 2.6525516510009766, 3.996906280517578, 3.868077278137207, 4.251811981201172, 3.635049343109131, 4.674341201782227, 2.087756633758545, 2.722790002822876, 1.85508131980896, 1.8208767175674438, 2.228415012359619, 4.656766891479492, 3.495321035385132, 4.799746513366699, 2.706998348236084, 4.352166175842285, 3.975790023803711, 2.675198793411255, 2.614083766937256, 1.6723287105560303, 3.8176188468933105, 4.09970235824585, 3.4322123527526855, 2.0710628032684326, 3.2762579917907715, 3.934267997741699, 2.0704188346862793, 3.3672547340393066, 2.9046454429626465, 4.919678688049316, 3.151495933532715, 4.568093299865723, 3.218459129333496, 4.887439727783203, 3.5434980392456055, 3.9431357383728027, 4.833803653717041, 2.707822322845459, 3.8309826850891113, 2.1617255210876465, 2.3026130199432373, 1.8330057859420776, 3.8349878787994385, 3.560637950897217, 4.174363136291504, 3.584388256072998, 3.20300555229187, 3.6157116889953613], "mean_td_error": 3.4982388019561768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13170337677002, "actor_loss": -4.7471232414245605, "critic_loss": 0.49691617488861084, "alpha_loss": -0.06388463824987411, "alpha_value": 0.9937143921852112, "log_alpha_value": -0.006305418908596039, "target_entropy": -6.0, "policy_t": -0.01206285785883665, "mean_q": 0.7403167486190796, "max_q": 0.9409177899360657, "min_q": 0.582716703414917}, "td_error": [0.8412572145462036, 1.2587532997131348, 2.964460849761963, 1.7772459983825684, 3.613668203353882, 3.6360626220703125, 1.0009196996688843, 1.3391553163528442, 1.7046678066253662, 2.7335100173950195, 2.4455442428588867, 3.6262245178222656, 4.17893123626709, 3.9229342937469482, 2.1793200969696045, 2.911128520965576, 2.505214214324951, 3.671619415283203, 1.1187857389450073, 1.9918110370635986, 2.8835015296936035, 2.149153709411621, 1.5909092426300049, 4.572844982147217, 1.9126825332641602, 3.643970012664795, 2.2962088584899902, 2.504762649536133, 3.1172399520874023, 0.38785460591316223, 2.321770191192627, 2.2897396087646484, 2.0541958808898926, 2.7186641693115234, 2.5721583366394043, 2.619823694229126, 1.725594401359558, 0.13851267099380493, 2.1976709365844727, 3.6093101501464844, 2.6987733840942383, 2.2147226333618164, 1.35647451877594, 1.7486437559127808, 3.587090015411377, 3.0338597297668457, 1.9412707090377808, 2.289318561553955, 3.6389667987823486, 2.2719504833221436, 0.7416715025901794, 1.8942265510559082, 3.12424898147583, 1.7634013891220093, 2.101738929748535, 0.7903156280517578, 1.5962729454040527, 1.3590507507324219, 2.8506569862365723, 1.5733299255371094, 3.422001838684082, 3.4755663871765137, 2.0326123237609863, 2.2079918384552, 1.3082484006881714, 2.3434572219848633, 1.6675001382827759, 1.0712096691131592, 3.7474780082702637, 1.7736083269119263, 2.8967385292053223, 1.8398841619491577, 1.4852879047393799, 1.1412819623947144, 1.2788385152816772, 1.7771937847137451, 2.2239112854003906, 2.459569215774536, 2.3256852626800537, 1.7477822303771973, 1.5361186265945435, 3.306213855743408, 0.15282994508743286, 1.1360069513320923, 3.7134952545166016, 1.825097680091858], "mean_td_error": 2.246504306793213, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.167046546936035, "actor_loss": -4.815234184265137, "critic_loss": 0.6528462171554565, "alpha_loss": -0.06406010687351227, "alpha_value": 0.9937190413475037, "log_alpha_value": -0.006300758570432663, "target_entropy": -6.0, "policy_t": -0.049927424639463425, "mean_q": 0.6793134808540344, "max_q": 0.8011146187782288, "min_q": 0.5805044770240784}, "td_error": [2.787470579147339, 3.005859613418579, 1.0189722776412964, 3.614863157272339, 2.900887966156006, 2.3155462741851807, 2.5873892307281494, 1.6913468837738037, 2.1144018173217773, 2.9027671813964844, 2.2305445671081543, 3.3021183013916016, 2.098036289215088, 2.4070887565612793, 1.2517818212509155, 1.4338860511779785, 2.099846601486206, 2.27681827545166, 2.7931137084960938, 1.510872483253479, 3.119912624359131, 1.1848357915878296, 0.5740811824798584, 1.270198106765747, 2.201292037963867, 0.7029155492782593, 3.2839150428771973, 1.9849836826324463, 2.1615169048309326, 2.4155073165893555, 2.8884854316711426, 0.05796360969543457, 0.0811244547367096, 4.432568550109863, 3.7999958992004395, 1.2063064575195312, 1.7708065509796143, 2.4706735610961914, 0.5968396663665771, 1.5399610996246338, 2.417515993118286, 1.8881253004074097, 1.6963359117507935, 2.2131197452545166, 2.456791400909424, 0.7088623046875, 2.018805503845215, 2.683469533920288, 2.719496488571167, 2.413381576538086, 1.9825012683868408, 5.708512306213379, 2.24940824508667, 2.9082436561584473, 1.3892546892166138, 1.1912788152694702, 2.3122527599334717, 3.733736276626587, 2.8102898597717285, 0.7778909206390381, 0.6817728281021118, 0.43191757798194885, 3.4084689617156982, 1.2355036735534668, 1.4502832889556885, 1.9504138231277466, 0.18839162588119507, 2.4726128578186035, 1.3821196556091309, 2.5610873699188232, 1.9826607704162598, 2.5219078063964844, 2.3068137168884277, 3.6670169830322266, 0.928949773311615, 3.216336727142334, 1.434718132019043, 0.1852431297302246, 2.3219923973083496, 1.9411232471466064, 5.1079325675964355, 2.018061399459839, 2.39595365524292, 0.7936995625495911, 0.330425888299942, 2.6020164489746094], "mean_td_error": 2.0916764736175537, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 476.0845098007172, "num_env_steps_trained_throughput_per_sec": 137.0868342952958, "timesteps_total": 20608, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1958.611, "sample_time_ms": 1357.909, "load_time_ms": 0.538, "load_throughput": 479837.9, "learn_time_ms": 63.435, "learn_throughput": 4067.129, "synch_weights_time_ms": 15.789}, "counters": {"num_env_steps_sampled": 20608, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 5676, "last_target_update_ts": 20608, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-07", "timestamp": 1700203027, "time_this_iter_s": 1.8973388671875, "time_total_s": 47.43513607978821, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.43513607978821, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 64.16666666666667, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072007179260254, "actor_loss": -4.741637706756592, "critic_loss": 2.7346246242523193, "alpha_loss": -0.06646835803985596, "alpha_value": 0.9934223890304565, "log_alpha_value": -0.006599316373467445, "target_entropy": -6.0, "policy_t": 0.0004654522053897381, "mean_q": 0.7779237627983093, "max_q": 0.876114547252655, "min_q": 0.6514366269111633}, "td_error": [3.2444863319396973, 2.7413105964660645, 5.469369888305664, 1.7054235935211182, 6.139522552490234, 2.119739055633545, 1.5301542282104492, 4.601037979125977, 4.098199844360352, 4.377658367156982, 4.854692459106445, 3.169783115386963, 3.184321641921997, 2.1721534729003906, 2.6474761962890625, 5.590201377868652, 3.9257876873016357, 2.9629998207092285, 3.256584644317627, 2.587127447128296, 4.484768867492676, 3.236708164215088, 3.4345526695251465, 4.928560256958008, 4.080000400543213, 4.958840370178223, 2.9860644340515137, 1.5984808206558228, 3.8671302795410156, 2.055626392364502, 2.076240062713623, 5.23431921005249, 5.14019775390625, 3.4464049339294434, 2.9168009757995605, 4.3202972412109375, 2.264482021331787, 2.7727932929992676, 4.037553310394287, 0.8374166488647461, 3.3932509422302246, 2.294980764389038, 4.019774913787842, 2.759498119354248, 2.684515953063965, 3.3750534057617188, 2.953465461730957, 4.1475934982299805, 3.859895706176758, 2.4631896018981934, 4.207232475280762, 5.479452133178711, 3.6306276321411133, 1.4897093772888184, 4.659475326538086, 3.205317497253418, 4.956358909606934, 2.118637800216675, 1.0018278360366821, 4.583133697509766, 3.484280586242676, 4.478602886199951, 3.805037021636963, 4.769312858581543, 5.451812267303467, 3.3296146392822266, 2.471088409423828, 3.242264747619629, 1.1289737224578857, 6.198469161987305, 4.618063926696777, 4.152385234832764, 3.02067232131958, 3.754718542098999, 3.7422397136688232, 4.494241714477539, 3.336411476135254, 3.545783042907715, 3.290067195892334, 4.000110149383545, 4.8799285888671875, 1.66990327835083, 3.4023990631103516, 1.6212704181671143, 4.147525787353516, 3.2719016075134277], "mean_td_error": 3.5075037479400635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079370498657227, "actor_loss": -4.755173206329346, "critic_loss": 0.3957417905330658, "alpha_loss": -0.06658458709716797, "alpha_value": 0.9934157729148865, "log_alpha_value": -0.00660602655261755, "target_entropy": -6.0, "policy_t": -0.008058279752731323, "mean_q": 0.8056119680404663, "max_q": 1.0248546600341797, "min_q": 0.6172851324081421}, "td_error": [1.5690943002700806, 3.166783094406128, 2.4158082008361816, 1.4800812005996704, 4.751237392425537, 0.7313402891159058, 2.517333984375, 3.3363986015319824, 1.6988227367401123, 2.2601985931396484, 0.9120286703109741, 2.119256019592285, 3.176863670349121, 1.5251015424728394, 0.04843154549598694, 1.2218074798583984, 2.1561436653137207, 0.8362310528755188, 2.298665761947632, 3.354015827178955, 3.019273042678833, 2.8665659427642822, 0.6347662806510925, 1.1592447757720947, 3.2400145530700684, 0.2513216733932495, 1.1556700468063354, 3.2250583171844482, 1.280133843421936, 0.5052645802497864, 4.488824844360352, 3.1071877479553223, 0.35512277483940125, 1.9681708812713623, 1.6366705894470215, 0.21323469281196594, 0.22082656621932983, 3.9164681434631348, 2.316556692123413, 1.3415319919586182, 1.8999173641204834, 1.5487840175628662, 1.4529904127120972, 1.3692517280578613, 1.7231396436691284, 2.7452616691589355, 2.4263899326324463, 0.15675556659698486, 2.4015021324157715, 0.32269471883773804, 4.096073150634766, 2.731522560119629, 0.7153008580207825, 0.5905481576919556, 1.8675658702850342, 0.9145516753196716, 1.0249249935150146, 2.0746140480041504, 1.4329229593276978, 1.8989815711975098, 0.4057230055332184, 1.181739091873169, 2.8648855686187744, 2.8913235664367676, 2.250523567199707, 1.9812171459197998, 2.4878578186035156, 1.249815583229065, 2.3388924598693848, 3.6264805793762207, 1.3546738624572754, 4.758892059326172, 2.093852996826172, 3.020461082458496, 0.07485190033912659, 1.2148652076721191, 0.5343894958496094, 1.1343375444412231, 1.61237370967865, 1.2739205360412598, 3.0482516288757324, 3.967954158782959, 2.2798268795013428, 2.194711208343506, 0.3627775013446808, 1.1581029891967773], "mean_td_error": 1.898069143295288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11558723449707, "actor_loss": -4.83020544052124, "critic_loss": 0.6115936636924744, "alpha_loss": -0.06677404791116714, "alpha_value": 0.9934206604957581, "log_alpha_value": -0.006601105909794569, "target_entropy": -6.0, "policy_t": 0.013574509881436825, "mean_q": 0.7471195459365845, "max_q": 0.8770356774330139, "min_q": 0.5973510146141052}, "td_error": [2.148345708847046, 2.0777511596679688, 1.3181419372558594, 1.6090914011001587, 2.13674259185791, 0.8065205216407776, 3.591782569885254, 2.0049400329589844, 3.3762760162353516, 3.264538288116455, 2.311739921569824, 0.06027546525001526, 1.5480256080627441, 2.414834499359131, 2.284945011138916, 0.7010423541069031, 1.4224061965942383, 1.537172794342041, 2.615476131439209, 3.5712456703186035, 1.563179612159729, 2.7554798126220703, 2.262307643890381, 0.9570304751396179, 1.6849169731140137, 2.913753032684326, 2.661681890487671, 2.334263801574707, 1.2781890630722046, 1.1423087120056152, 0.665073812007904, 2.952975273132324, 2.1842117309570312, 2.610661268234253, 0.47766169905662537, 2.2417964935302734, 2.5337905883789062, 1.5603740215301514, 2.3642022609710693, 0.5660514831542969, 0.16979044675827026, 2.464210271835327, 1.7018119096755981, 1.488957166671753, 0.3562987148761749, 2.1007275581359863, 2.6046347618103027, 2.2252745628356934, 1.6092838048934937, 2.5857315063476562, 3.7360782623291016, 1.8359791040420532, 2.772691011428833, 1.3676669597625732, 3.5267109870910645, 3.2180166244506836, 3.1105287075042725, 2.287215232849121, 0.8967896103858948, 1.735450029373169, 1.7716783285140991, 0.7911314964294434, 2.087259531021118, 1.6922948360443115, 2.123645782470703, 0.7087259888648987, 1.7072707414627075, 3.525904655456543, 2.2760071754455566, 0.5248221158981323, 2.721935272216797, 2.4476356506347656, 0.051354408264160156, 1.8433454036712646, 4.306004524230957, 0.6996220350265503, 3.981196880340576, 5.027182579040527, 2.54984712600708, 1.1906310319900513, 0.9855979084968567, 0.8958760499954224, 3.4401519298553467, 2.8331809043884277, 0.5815736055374146, 0.6833304166793823], "mean_td_error": 1.9971190690994263, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 452.5830150601024, "num_env_steps_trained_throughput_per_sec": 130.31966281864555, "timesteps_total": 21504, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1963.337, "sample_time_ms": 1360.902, "load_time_ms": 0.539, "load_throughput": 478310.835, "learn_time_ms": 63.412, "learn_throughput": 4068.609, "synch_weights_time_ms": 16.033}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-09", "timestamp": 1700203029, "time_this_iter_s": 1.9953558444976807, "time_total_s": 49.43049192428589, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.43049192428589, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 69.39999999999999, "ram_util_percent": 92.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09875774383545, "actor_loss": -4.826711654663086, "critic_loss": 2.5929293632507324, "alpha_loss": -0.06967508792877197, "alpha_value": 0.9931243658065796, "log_alpha_value": -0.006899372208863497, "target_entropy": -6.0, "policy_t": -0.037951309233903885, "mean_q": 0.8578899502754211, "max_q": 0.9905350208282471, "min_q": 0.7330227494239807}, "td_error": [2.676694393157959, 2.7201216220855713, 5.475896835327148, 3.414431571960449, 2.4779281616210938, 1.6136765480041504, 4.483425140380859, 3.9466209411621094, 2.8432321548461914, 4.368500709533691, 2.840674877166748, 2.003319025039673, 2.873659133911133, 2.520535945892334, 2.3268260955810547, 3.0717148780822754, 2.6027579307556152, 2.780550479888916, 4.168866157531738, 1.6083838939666748, 2.0563125610351562, 4.2553606033325195, 3.4849555492401123, 2.0218698978424072, 4.26970100402832, 1.1720876693725586, 3.1003520488739014, 2.9046666622161865, 2.7270960807800293, 1.584765076637268, 4.4477033615112305, 4.3899030685424805, 5.523520469665527, 5.240597724914551, 3.9963417053222656, 1.3901758193969727, 3.165050983428955, 4.301958084106445, 4.7955522537231445, 3.991443157196045, 2.8998653888702393, 5.103479385375977, 3.0745434761047363, 4.238722801208496, 3.08272385597229, 1.312111496925354, 5.234132289886475, 3.00126314163208, 3.2267086505889893, 2.675896644592285, 5.034045696258545, 2.9937429428100586, 2.622065544128418, 2.6152424812316895, 2.4999375343322754, 4.152218818664551, 3.234621047973633, 3.5821123123168945, 2.422003746032715, 1.3251011371612549, 3.9074106216430664, 4.14144229888916, 2.4219491481781006, 3.2987356185913086, 4.356842994689941, 4.110099792480469, 2.6515278816223145, 3.3801658153533936, 2.8984861373901367, 4.89971923828125, 4.6527419090271, 3.9766712188720703, 4.902882099151611, 2.228754997253418, 3.5236287117004395, 4.039655685424805, 2.6487884521484375, 2.732720375061035, 1.6789491176605225, 2.8920822143554688, 3.7807719707489014, 3.431889057159424, 5.204585075378418, 3.532419204711914, 2.7783823013305664, 3.3630566596984863], "mean_td_error": 3.318629503250122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069221496582031, "actor_loss": -4.808383464813232, "critic_loss": 0.4120083451271057, "alpha_loss": -0.06954385340213776, "alpha_value": 0.9931172132492065, "log_alpha_value": -0.006906577851623297, "target_entropy": -6.0, "policy_t": 0.02224324457347393, "mean_q": 0.8863673806190491, "max_q": 1.0674388408660889, "min_q": 0.6561404466629028}, "td_error": [0.4706552028656006, 3.6082639694213867, 1.5488076210021973, 1.7004494667053223, 0.07376399636268616, 1.1808809041976929, 1.636206030845642, 1.914912223815918, 2.5375914573669434, 1.8320266008377075, 0.5654891729354858, 2.315009117126465, 1.6556315422058105, 4.37376594543457, 3.091599941253662, 3.1209630966186523, 4.22450065612793, 1.7609570026397705, 2.075256824493408, 1.548105001449585, 0.07786956429481506, 2.2903127670288086, 0.726617157459259, 1.7518390417099, 1.2622452974319458, 2.2012224197387695, 0.20349785685539246, 1.8585374355316162, 2.22109317779541, 1.672186017036438, 0.8937199711799622, 2.1580538749694824, 1.2550407648086548, 2.118215560913086, 1.0847983360290527, 3.4168620109558105, 2.0790648460388184, 2.110957145690918, 0.9636911153793335, 2.4429845809936523, 2.065485715866089, 1.4531352519989014, 2.980581283569336, 1.507222056388855, 2.648698329925537, 4.141787528991699, 2.4022555351257324, 1.303281307220459, 2.7637951374053955, 0.15890711545944214, 0.14838415384292603, 2.8648695945739746, 1.9150924682617188, 2.256242036819458, 2.622422695159912, 3.758362293243408, 1.0923218727111816, 2.667935371398926, 1.4697964191436768, 1.5370603799819946, 5.249899864196777, 0.7356248497962952, 1.5408694744110107, 2.7870254516601562, 2.0621707439422607, 2.29286527633667, 0.5023460388183594, 5.156180381774902, 0.8738784193992615, 3.027003288269043, 0.691096842288971, 2.154224395751953, 1.983618140220642, 0.3206162452697754, 0.6186742186546326, 2.849219560623169, 2.2559540271759033, 3.200378894805908, 1.7654922008514404, 1.4561703205108643, 0.7800701856613159, 1.3470731973648071, 1.7828893661499023, 3.2158989906311035, 3.0980868339538574, 0.6629828214645386], "mean_td_error": 1.9557161331176758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079488754272461, "actor_loss": -4.874392509460449, "critic_loss": 0.583426833152771, "alpha_loss": -0.06956327706575394, "alpha_value": 0.9931222796440125, "log_alpha_value": -0.006901468150317669, "target_entropy": -6.0, "policy_t": -0.0062887901440262794, "mean_q": 0.8313080668449402, "max_q": 0.9867487549781799, "min_q": 0.6632709503173828}, "td_error": [2.167008876800537, 0.672661542892456, 3.998400926589966, 0.4934232532978058, 0.662447452545166, 0.13773933053016663, 1.53702974319458, 2.5736145973205566, 1.6400387287139893, 1.559313178062439, 2.609999895095825, 3.083115577697754, 1.4603793621063232, 2.9537417888641357, 3.2469820976257324, 1.347224473953247, 3.5209274291992188, 3.374894857406616, 3.49912691116333, 2.383791446685791, 2.277599334716797, 1.1403818130493164, 2.6100306510925293, 3.8686366081237793, 1.5493426322937012, 2.301340103149414, 1.8745477199554443, 1.555722951889038, 2.0433053970336914, 1.8624587059020996, 2.4466142654418945, 2.4813079833984375, 1.2733715772628784, 1.109323501586914, 1.3067197799682617, 1.0774554014205933, 0.5713698863983154, 2.496009349822998, 0.5143857002258301, 0.1470620334148407, 0.7973414063453674, 1.7580641508102417, 1.0992686748504639, 1.1048604249954224, 1.8936816453933716, 1.5523929595947266, 1.0625741481781006, 2.3083133697509766, 0.5139321088790894, 3.440471887588501, 3.148813486099243, 1.2002333402633667, 3.1789913177490234, 1.0477708578109741, 1.7074224948883057, 1.3612253665924072, 1.7820541858673096, 1.84691321849823, 0.8960354328155518, 1.358321189880371, 2.0395002365112305, 1.1108249425888062, 2.4046952724456787, 2.9026854038238525, 1.2906570434570312, 0.19716626405715942, 2.7890710830688477, 2.0273327827453613, 3.0670316219329834, 1.2012135982513428, 3.159379720687866, 1.4250630140304565, 1.6749225854873657, 3.143871307373047, 3.102125644683838, 0.9129363894462585, 2.4591925144195557, 3.571892738342285, 3.6763827800750732, 0.994182288646698, 1.8182474374771118, 4.19989013671875, 1.465285301208496, 2.9956021308898926, 3.043210983276367, 1.3626114130020142], "mean_td_error": 1.9595640897750854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 432.56562202100804, "num_env_steps_trained_throughput_per_sec": 124.55572598372775, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1986.86, "sample_time_ms": 1384.707, "load_time_ms": 0.542, "load_throughput": 476101.206, "learn_time_ms": 63.297, "learn_throughput": 4076.034, "synch_weights_time_ms": 15.988}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-11", "timestamp": 1700203031, "time_this_iter_s": 2.087520122528076, "time_total_s": 51.518012046813965, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052649d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.518012046813965, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 76.23333333333333, "ram_util_percent": 92.23333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070086479187012, "actor_loss": -4.870858192443848, "critic_loss": 2.512359619140625, "alpha_loss": -0.0724991112947464, "alpha_value": 0.9928264021873474, "log_alpha_value": -0.0071994527243077755, "target_entropy": -6.0, "policy_t": 0.06704503297805786, "mean_q": 0.9376266598701477, "max_q": 1.098932147026062, "min_q": 0.7789183855056763}, "td_error": [4.170830726623535, 3.0686697959899902, 3.8112127780914307, 4.320524215698242, 5.567149639129639, 2.3039116859436035, 1.1118117570877075, 4.806100368499756, 3.0906453132629395, 2.4196414947509766, 2.159489154815674, 4.08869743347168, 3.361107349395752, 0.4346977472305298, 4.91131591796875, 4.173209190368652, 2.443277359008789, 3.0619077682495117, 1.9973196983337402, 3.204355001449585, 3.64009952545166, 2.6088695526123047, 3.2442915439605713, 3.9212899208068848, 3.4415862560272217, 4.132129192352295, 3.7650718688964844, 4.169816017150879, 3.5064687728881836, 2.6917123794555664, 1.7125450372695923, 3.743436098098755, 2.392465829849243, 2.8350400924682617, 2.827681064605713, 3.8028383255004883, 2.842383861541748, 4.4934401512146, 2.8252291679382324, 5.168365478515625, 3.0551388263702393, 4.114129543304443, 2.7341957092285156, 2.8699212074279785, 6.588552474975586, 2.7832326889038086, 4.088350296020508, 2.9843835830688477, 4.0204010009765625, 3.119950294494629, 1.4387969970703125, 5.501620292663574, 1.925405740737915, 3.108323574066162, 2.2990429401397705, 2.892271041870117, 2.3753256797790527, 3.183225154876709, 1.9021985530853271, 3.6978683471679688, 1.4109156131744385, 3.1182119846343994, 4.745425701141357, 4.550088882446289, 4.5045037269592285, 4.699641704559326, 4.403652191162109, 3.1595654487609863, 2.138953447341919, 4.363489151000977, 2.7025270462036133, 3.612825870513916, 1.2874966859817505, 2.8404579162597656, 4.703587532043457, 2.1493136882781982, 5.160793304443359, 1.0285370349884033, 3.6535229682922363, 3.239008903503418, 3.6157331466674805, 4.396225929260254, 2.022165298461914, 4.64458703994751, 3.603175401687622, 0.09104055166244507], "mean_td_error": 3.28835391998291, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10624885559082, "actor_loss": -4.918618679046631, "critic_loss": 0.35848623514175415, "alpha_loss": -0.07283633202314377, "alpha_value": 0.9928188323974609, "log_alpha_value": -0.007207059301435947, "target_entropy": -6.0, "policy_t": 0.011357233859598637, "mean_q": 0.9732053875923157, "max_q": 1.256769061088562, "min_q": 0.7532135248184204}, "td_error": [3.090428352355957, 2.3470544815063477, 1.0132375955581665, 2.896461009979248, 3.58772873878479, 1.3600984811782837, 1.6797221899032593, 2.5271267890930176, 2.0645065307617188, 1.6626129150390625, 0.987659752368927, 1.937643051147461, 1.1982979774475098, 0.9926237463951111, 1.23233962059021, 3.4210753440856934, 0.5130120515823364, 2.7919068336486816, 0.8127413392066956, 2.106600761413574, 0.646626353263855, 2.1879405975341797, 2.951951742172241, 0.7575745582580566, 1.9818280935287476, 0.9110708236694336, 2.171900987625122, 2.208292245864868, 0.9444296360015869, 0.8405088186264038, 1.4663243293762207, 1.5002336502075195, 1.0266087055206299, 0.974579930305481, 2.4221677780151367, 0.23555049300193787, 1.5877923965454102, 3.614802360534668, 0.3193054795265198, 1.519577980041504, 2.3819844722747803, 2.330826997756958, 1.5833137035369873, 1.492445468902588, 3.2356293201446533, 0.7921624183654785, 1.7591325044631958, 1.8789857625961304, 2.0112040042877197, 0.931288480758667, 2.2027840614318848, 0.8187031149864197, 0.25620436668395996, 2.3702096939086914, 1.804825782775879, 0.8045527338981628, 3.005796432495117, 2.6709342002868652, 2.0243449211120605, 3.1752772331237793, 3.7008860111236572, 2.2367422580718994, 0.8090170621871948, 1.6870191097259521, 0.8978806734085083, 3.7453622817993164, 1.2043005228042603, 0.3412787914276123, 2.0501515865325928, 2.064265727996826, 1.0853252410888672, 2.5344080924987793, 0.8357090353965759, 1.4097859859466553, 1.4421899318695068, 1.1590354442596436, 2.195326089859009, 0.07615384459495544, 2.358168840408325, 3.008117198944092, 2.578794002532959, 1.5859971046447754, 0.14466595649719238, 3.9337313175201416, 1.8593990802764893, 1.186050534248352], "mean_td_error": 1.7692129611968994, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118393898010254, "actor_loss": -4.983918190002441, "critic_loss": 0.5205913782119751, "alpha_loss": -0.07287035882472992, "alpha_value": 0.9928240776062012, "log_alpha_value": -0.007201771251857281, "target_entropy": -6.0, "policy_t": -0.020027436316013336, "mean_q": 0.9018997550010681, "max_q": 1.060886025428772, "min_q": 0.7750993967056274}, "td_error": [2.079659938812256, 2.2375974655151367, 2.8104453086853027, 0.627712607383728, 0.2689968943595886, 0.5581595301628113, 0.8424587249755859, 3.411440849304199, 1.195598840713501, 1.5278457403182983, 4.1803789138793945, 2.1918411254882812, 0.4341225326061249, 1.7839184999465942, 2.6902174949645996, 0.599376380443573, 1.711944818496704, 0.940721869468689, 0.6410098075866699, 1.849858045578003, 2.663954496383667, 1.7897906303405762, 0.22284457087516785, 1.1701030731201172, 2.292772054672241, 2.856661319732666, 0.8639895915985107, 3.1803088188171387, 3.1936628818511963, 2.239016532897949, 2.930825710296631, 2.131588935852051, 0.9257238507270813, 2.7493062019348145, 3.410550117492676, 0.15336832404136658, 2.5007846355438232, 1.7538378238677979, 3.309019088745117, 2.537458896636963, 2.2685160636901855, 1.4389851093292236, 2.8072195053100586, 2.618640899658203, 1.1349618434906006, 1.1409649848937988, 0.11930873990058899, 2.2444965839385986, 2.614917278289795, 4.567598342895508, 0.07362481951713562, 3.672377347946167, 2.233348846435547, 0.7702897191047668, 0.23637056350708008, 1.2718799114227295, 0.30768778920173645, 0.11759746074676514, 3.2309012413024902, 2.240128517150879, 2.2741198539733887, 0.8853884935379028, 2.19504714012146, 2.0110549926757812, 2.474478244781494, 0.9583990573883057, 0.09829580783843994, 1.7530397176742554, 2.828946590423584, 1.262345314025879, 1.855126976966858, 1.3253726959228516, 1.0683914422988892, 3.3024258613586426, 1.52512788772583, 2.7844786643981934, 0.9091102480888367, 0.34113720059394836, 2.5587031841278076, 0.10503372550010681, 1.7674036026000977, 1.3092296123504639, 2.02251935005188, 2.5897750854492188, 1.5978114604949951, 1.4303866624832153], "mean_td_error": 1.7883933782577515, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 444.0145332461238, "num_env_steps_trained_throughput_per_sec": 127.85239908203117, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 2002.117, "sample_time_ms": 1401.419, "load_time_ms": 0.537, "load_throughput": 480093.359, "learn_time_ms": 63.354, "learn_throughput": 4072.342, "synch_weights_time_ms": 16.468}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-13", "timestamp": 1700203033, "time_this_iter_s": 2.0469391345977783, "time_total_s": 53.56495118141174, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0772790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.56495118141174, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 71.06666666666666, "ram_util_percent": 92.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097175598144531, "actor_loss": -4.982955455780029, "critic_loss": 1.4979578256607056, "alpha_loss": -0.07572374492883682, "alpha_value": 0.9925285577774048, "log_alpha_value": -0.0074994973838329315, "target_entropy": -6.0, "policy_t": 0.012837336398661137, "mean_q": 1.0143667459487915, "max_q": 1.1749345064163208, "min_q": 0.8735847473144531}, "td_error": [4.648379325866699, 2.195180892944336, 1.8755940198898315, 4.2906999588012695, 2.232684850692749, 1.7371982336044312, 4.207942485809326, 0.557456374168396, 3.193835496902466, 5.865467548370361, 0.4820466935634613, 2.502608299255371, 3.4686341285705566, 4.892886161804199, 4.041586875915527, 4.8288774490356445, 5.739321231842041, 2.874795913696289, 4.301667213439941, 2.7168612480163574, 2.4524476528167725, 5.6861467361450195, 2.9309840202331543, 3.907388925552368, 2.0514652729034424, 4.026202201843262, 2.0999643802642822, 2.217935562133789, 2.887497663497925, 3.1130881309509277, 4.343591213226318, 3.5673484802246094, 3.5459747314453125, 2.3117101192474365, 3.017721176147461, 2.9239606857299805, 3.566164255142212, 5.101797103881836, 3.18939471244812, 4.029294967651367, 4.178619384765625, 2.1467294692993164, 2.8451528549194336, 1.0655765533447266, 3.150195837020874, 1.0144922733306885, 4.0049896240234375, 3.606962203979492, 3.336866855621338, 2.92659854888916, 4.179749488830566, 2.7227349281311035, 1.6894900798797607, 3.213200330734253, 3.209071159362793, 2.235741138458252, 3.27181339263916, 3.975198745727539, 2.6457223892211914, 3.7251029014587402, 5.018965721130371, 2.654325008392334, 3.5754783153533936, 4.971705436706543, 3.372431755065918, 2.1962199211120605, 2.797900676727295, 1.4461593627929688, 3.578310012817383, 3.9307949542999268, 4.684393405914307, 1.9440762996673584, 2.580258846282959, 2.751204490661621, 4.292712211608887, 4.2661638259887695, 4.623096466064453, 2.079813003540039, 3.018693447113037, 3.2195470333099365, 1.3116992712020874, 3.687842845916748, 3.119936466217041, 1.51205313205719, 3.065882682800293, 4.47606897354126], "mean_td_error": 3.220273733139038, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088791847229004, "actor_loss": -4.992823600769043, "critic_loss": 0.3598693013191223, "alpha_loss": -0.07574214786291122, "alpha_value": 0.9925205707550049, "log_alpha_value": -0.007507553324103355, "target_entropy": -6.0, "policy_t": 0.021378500387072563, "mean_q": 1.085202932357788, "max_q": 1.4258694648742676, "min_q": 0.7868767976760864}, "td_error": [0.7896764278411865, 4.4406280517578125, 3.172020435333252, 1.546636939048767, 0.2750915288925171, 0.6185092329978943, 1.3471410274505615, 2.04335355758667, 1.7079700231552124, 4.450466632843018, 1.4949193000793457, 0.8109390139579773, 3.4375903606414795, 2.18281626701355, 3.2223143577575684, 0.3027247488498688, 2.274278402328491, 1.4483518600463867, 2.3637280464172363, 2.769202709197998, 1.2446203231811523, 2.5099806785583496, 1.7983589172363281, 0.23405200242996216, 0.4773940443992615, 2.2229881286621094, 1.7998316287994385, 2.061124324798584, 2.4256882667541504, 1.382554292678833, 2.666743755340576, 0.3501870632171631, 3.242077350616455, 1.757726788520813, 0.8941939473152161, 2.0728490352630615, 1.8222272396087646, 0.4031534492969513, 2.282536506652832, 2.1807379722595215, 1.8696246147155762, 1.3696365356445312, 1.2422142028808594, 1.6942918300628662, 4.290369987487793, 0.6168765425682068, 3.7033705711364746, 2.281775951385498, 3.4272494316101074, 3.7114622592926025, 4.763484001159668, 2.137721538543701, 2.1730337142944336, 3.4525303840637207, 1.1106466054916382, 0.2426876723766327, 1.1322896480560303, 0.4385235011577606, 1.360684871673584, 0.4892157018184662, 2.985292911529541, 0.2026538848876953, 0.27382078766822815, 0.6808204054832458, 1.1254379749298096, 0.9267524480819702, 1.511329174041748, 0.09796392917633057, 2.3794939517974854, 0.9870098829269409, 1.5667433738708496, 2.1317055225372314, 1.4643350839614868, 0.10758459568023682, 2.8234312534332275, 0.7657340168952942, 2.5282444953918457, 1.7107436656951904, 1.296417236328125, 2.2150959968566895, 2.061835765838623, 0.6420006155967712, 0.8965855240821838, 0.5096186399459839, 3.6393399238586426, 2.133596897125244], "mean_td_error": 1.787193775177002, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.013833045959473, "actor_loss": -4.993823528289795, "critic_loss": 0.4512750506401062, "alpha_loss": -0.07512477040290833, "alpha_value": 0.9925259947776794, "log_alpha_value": -0.0075020999647676945, "target_entropy": -6.0, "policy_t": -0.004883359652012587, "mean_q": 0.9961459040641785, "max_q": 1.191145420074463, "min_q": 0.8262365460395813}, "td_error": [0.9285616278648376, 2.7737278938293457, 1.6579753160476685, 2.106429100036621, 2.5779144763946533, 2.024953842163086, 1.6506118774414062, 1.104121208190918, 0.6184231638908386, 0.9628221988677979, 1.7389898300170898, 1.40104341506958, 0.6825351715087891, 2.399412155151367, 1.4592127799987793, 0.6528018712997437, 2.418083667755127, 1.7411425113677979, 0.07268011569976807, 2.6145553588867188, 1.5850820541381836, 1.5037927627563477, 1.3837811946868896, 0.5795176029205322, 4.197003364562988, 2.010829448699951, 2.5759754180908203, 0.3800089359283447, 0.5036964416503906, 2.3529725074768066, 1.0086033344268799, 0.41196876764297485, 2.0870463848114014, 0.9947831630706787, 2.2229628562927246, 1.1057002544403076, 2.108626365661621, 0.7504525184631348, 1.8450969457626343, 1.8758316040039062, 2.960754871368408, 2.073582649230957, 2.1386258602142334, 1.5207544565200806, 0.17934560775756836, 0.3542524576187134, 1.139012336730957, 1.4685561656951904, 3.1650567054748535, 2.831993579864502, 0.9946619272232056, 1.2433788776397705, 0.23152926564216614, 0.8172998428344727, 1.4734445810317993, 0.15107709169387817, 1.0016107559204102, 0.4820054769515991, 2.240431785583496, 0.883461594581604, 4.827824592590332, 2.2203378677368164, 5.339414596557617, 2.194479465484619, 2.68255615234375, 1.5088813304901123, 0.5789105892181396, 1.7915219068527222, 0.4975317418575287, 2.9153385162353516, 1.714353084564209, 2.211073637008667, 1.5388542413711548, 1.2753283977508545, 0.7051494717597961, 2.5840280055999756, 0.17134153842926025, 0.8055651187896729, 1.8922123908996582, 1.6920047998428345, 0.1760845184326172, 1.6220202445983887, 0.3621653914451599, 1.969623327255249, 1.7258331775665283, 0.5574301481246948], "mean_td_error": 1.5811676979064941, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 414.2027087809714, "num_env_steps_trained_throughput_per_sec": 119.26819069809221, "timesteps_total": 24192, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 72576, "timers": {"training_iteration_time_ms": 2020.379, "sample_time_ms": 1420.88, "load_time_ms": 0.535, "load_throughput": 482598.418, "learn_time_ms": 63.166, "learn_throughput": 4084.494, "synch_weights_time_ms": 16.18}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 72576, "num_agent_steps_trained": 6708, "last_target_update_ts": 24192, "num_target_updates": 26}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-15", "timestamp": 1700203035, "time_this_iter_s": 2.1780598163604736, "time_total_s": 55.74301099777222, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.74301099777222, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 77.66666666666667, "ram_util_percent": 92.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107536315917969, "actor_loss": -5.089360237121582, "critic_loss": 1.4059553146362305, "alpha_loss": -0.07883439213037491, "alpha_value": 0.9922307729721069, "log_alpha_value": -0.00779956579208374, "target_entropy": -6.0, "policy_t": -0.007123863790184259, "mean_q": 1.1259490251541138, "max_q": 1.2724800109863281, "min_q": 0.937161386013031}, "td_error": [4.427647590637207, 1.5370821952819824, 3.250697135925293, 3.7933781147003174, 4.0767998695373535, 3.8021416664123535, 2.8363049030303955, 1.4673190116882324, 2.382251024246216, 1.757936716079712, 4.0512590408325195, 2.5416669845581055, 5.132214546203613, 2.3755264282226562, 6.179056167602539, 2.3087821006774902, 3.7606217861175537, 3.2551162242889404, 5.097418785095215, 2.429245710372925, 1.791778564453125, 2.224445104598999, 3.0960898399353027, 4.565999984741211, 2.885672092437744, 2.5415940284729004, 1.9711909294128418, 3.777545928955078, 1.9693987369537354, 1.9931938648223877, 1.787841558456421, 4.9963059425354, 3.08027720451355, 3.3797850608825684, 1.7418785095214844, 1.8533298969268799, 1.9086027145385742, 3.0731027126312256, 2.5588693618774414, 3.0934619903564453, 3.88800048828125, 2.8145370483398438, 4.015222072601318, 4.590305805206299, 3.669851541519165, 2.6142585277557373, 4.571145057678223, 3.250866413116455, 1.7490311861038208, 4.466928482055664, 0.5693040490150452, 2.478550672531128, 2.8182172775268555, 4.976468563079834, 1.6472477912902832, 4.3105645179748535, 3.1753008365631104, 3.2510523796081543, 3.9968905448913574, 4.9874372482299805, 3.8306617736816406, 2.1370201110839844, 3.3881006240844727, 5.118209362030029, 2.4317383766174316, 4.219287872314453, 3.5381622314453125, 3.332036256790161, 4.836786270141602, 2.210202217102051, 2.2024004459381104, 1.7010618448257446, 1.9656484127044678, 3.863152503967285, 3.5905580520629883, 2.9160690307617188, 5.376021862030029, 3.3791444301605225, 2.241112232208252, 2.426553249359131, 1.7603967189788818, 1.7464388608932495, 3.040508508682251, 3.2262086868286133, 3.2811267375946045, 4.607501029968262], "mean_td_error": 3.1506993770599365, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073312759399414, "actor_loss": -5.045016288757324, "critic_loss": 0.388059139251709, "alpha_loss": -0.07865264266729355, "alpha_value": 0.9922223687171936, "log_alpha_value": -0.0078080217353999615, "target_entropy": -6.0, "policy_t": 0.012322545051574707, "mean_q": 1.1941784620285034, "max_q": 1.5474809408187866, "min_q": 0.9577174186706543}, "td_error": [1.1998114585876465, 1.63796067237854, 1.494206428527832, 3.1917099952697754, 3.2594966888427734, 2.1221723556518555, 1.7080559730529785, 1.2200753688812256, 2.133687973022461, 3.3356733322143555, 2.675732135772705, 3.342039108276367, 2.723496437072754, 1.4622650146484375, 1.708967685699463, 0.13677167892456055, 2.586913824081421, 3.67313814163208, 2.781348705291748, 1.206580638885498, 1.2132177352905273, 0.8649597764015198, 1.8556890487670898, 3.10050106048584, 0.19778138399124146, 2.3155388832092285, 1.621671438217163, 1.4763541221618652, 0.0732119083404541, 2.193203926086426, 5.005312919616699, 2.2882494926452637, 0.4857451915740967, 1.5479846000671387, 3.6830551624298096, 2.5790252685546875, 0.816180944442749, 1.581343412399292, 2.303755283355713, 1.3491233587265015, 0.6870814561843872, 1.2257046699523926, 0.27018988132476807, 1.3992657661437988, 1.3709197044372559, 2.9194374084472656, 1.2418973445892334, 2.803844928741455, 1.6363779306411743, 1.3432576656341553, 1.8157460689544678, 1.7563526630401611, 1.073240876197815, 0.253781259059906, 1.4358057975769043, 0.946212112903595, 2.202822685241699, 2.963313579559326, 3.0921432971954346, 2.1242246627807617, 0.09059500694274902, 0.41432252526283264, 0.3616396188735962, 1.234331488609314, 0.23348289728164673, 3.1184937953948975, 3.274317741394043, 1.4322357177734375, 0.6680235266685486, 0.170260488986969, 1.1086938381195068, 4.572277545928955, 3.1773085594177246, 2.1393938064575195, 1.4560534954071045, 2.447503089904785, 0.07209369540214539, 2.235802412033081, 1.7215707302093506, 1.9562127590179443, 3.051440477371216, 2.2127342224121094, 5.928898334503174, 0.8735071420669556, 1.834332823753357, 2.681591033935547], "mean_td_error": 1.874194860458374, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133158683776855, "actor_loss": -5.17915678024292, "critic_loss": 0.5298177599906921, "alpha_loss": -0.07906132191419601, "alpha_value": 0.992228090763092, "log_alpha_value": -0.007802238687872887, "target_entropy": -6.0, "policy_t": 0.001338219502940774, "mean_q": 1.0914409160614014, "max_q": 1.3781321048736572, "min_q": 0.8926926255226135}, "td_error": [2.236069679260254, 2.881110906600952, 2.6277613639831543, 0.85947585105896, 1.2537312507629395, 4.668546676635742, 2.294372081756592, 2.6098198890686035, 0.14636653661727905, 2.0461244583129883, 2.6913442611694336, 3.086266040802002, 2.126626491546631, 1.7141778469085693, 1.5121583938598633, 1.5311951637268066, 1.92111337184906, 1.8323593139648438, 0.8936246633529663, 1.5354042053222656, 1.6002388000488281, 1.050587773323059, 2.184030055999756, 1.4886906147003174, 3.301726818084717, 2.499410629272461, 0.2476549744606018, 2.205667734146118, 0.3450322151184082, 2.6130924224853516, 1.8178448677062988, 0.13502556085586548, 1.2519233226776123, 3.6841225624084473, 1.6254713535308838, 0.47919362783432007, 1.062949776649475, 1.2139116525650024, 1.1097157001495361, 2.6911873817443848, 0.07421571016311646, 2.714014768600464, 1.5786280632019043, 0.2726436257362366, 3.1924610137939453, 1.937610387802124, 2.796356678009033, 1.2624597549438477, 3.2864296436309814, 0.3029659390449524, 3.0940957069396973, 1.1376597881317139, 2.128666400909424, 2.745795249938965, 0.6246746778488159, 1.3323832750320435, 1.3060474395751953, 1.5007432699203491, 1.3064106702804565, 0.4835793972015381, 0.33761507272720337, 2.025571823120117, 2.3923726081848145, 1.8512623310089111, 2.6446404457092285, 1.5529781579971313, 1.7139384746551514, 3.461944580078125, 4.236215591430664, 0.967035174369812, 3.259094715118408, 1.6683282852172852, 2.7636380195617676, 1.669262409210205, 0.8517677783966064, 1.4931144714355469, 3.1988749504089355, 1.0095676183700562, 0.1953793168067932, 2.1641454696655273, 0.6458312273025513, 3.764556884765625, 3.0178914070129395, 1.1788288354873657, 1.302369236946106, 0.82778400182724], "mean_td_error": 1.8179881572723389, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 430.7999116412838, "num_env_steps_trained_throughput_per_sec": 124.04729598599467, "timesteps_total": 25088, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 2022.937, "sample_time_ms": 1425.42, "load_time_ms": 0.532, "load_throughput": 484760.306, "learn_time_ms": 62.959, "learn_throughput": 4097.913, "synch_weights_time_ms": 16.313}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-17", "timestamp": 1700203037, "time_this_iter_s": 2.093065023422241, "time_total_s": 57.83607602119446, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.83607602119446, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103079795837402, "actor_loss": -5.15180778503418, "critic_loss": 1.3674662113189697, "alpha_loss": -0.0818316638469696, "alpha_value": 0.9919330477714539, "log_alpha_value": -0.008099675178527832, "target_entropy": -6.0, "policy_t": -0.009243576787412167, "mean_q": 1.207567572593689, "max_q": 1.401370644569397, "min_q": 1.0331600904464722}, "td_error": [2.11079478263855, 4.03851842880249, 2.52992582321167, 3.3146791458129883, 3.9100399017333984, 1.2032586336135864, 2.3306467533111572, 3.970278024673462, 4.54033088684082, 2.223525285720825, 1.5769679546356201, 3.487931251525879, 5.557221412658691, 4.5047454833984375, 1.0905662775039673, 2.764267921447754, 3.3556010723114014, 3.395345687866211, 4.0366010665893555, 1.8925755023956299, 1.4970197677612305, 3.3684167861938477, 4.71273136138916, 1.603572964668274, 2.1077818870544434, 1.9743218421936035, 2.449486255645752, 5.396644592285156, 2.507209300994873, 3.450380802154541, 3.4754505157470703, 2.353416919708252, 3.060760259628296, 1.0064542293548584, 2.731259346008301, 2.664026975631714, 2.412818431854248, 1.8803095817565918, 2.872504234313965, 5.222546577453613, 2.063983201980591, 3.1060197353363037, 2.4305012226104736, 2.228804588317871, 1.1270976066589355, 3.9695773124694824, 2.1494383811950684, 1.3634681701660156, 3.6801960468292236, 4.035140037536621, 4.240435600280762, 3.282665729522705, 3.2113759517669678, 2.4312400817871094, 1.0237574577331543, 2.679699182510376, 4.078813552856445, 3.0679097175598145, 2.935214042663574, 3.861992359161377, 4.346808910369873, 2.136733055114746, 3.64786958694458, 4.644472122192383, 2.2945003509521484, 1.2073386907577515, 3.465210199356079, 3.554189443588257, 4.192480087280273, 4.021594524383545, 1.2106082439422607, 2.0601344108581543, 3.9141643047332764, 2.5778660774230957, 4.615321636199951, 4.2142181396484375, 5.081004619598389, 2.5679569244384766, 4.9891157150268555, 4.008554458618164, 3.000478744506836, 3.9928979873657227, 1.9595685005187988, 3.7529518604278564, 4.6469268798828125, 4.518466949462891], "mean_td_error": 3.094996213912964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100601196289062, "actor_loss": -5.164490699768066, "critic_loss": 0.34265536069869995, "alpha_loss": -0.08190006762742996, "alpha_value": 0.9919243454933167, "log_alpha_value": -0.008108435198664665, "target_entropy": -6.0, "policy_t": 0.02576727792620659, "mean_q": 1.2906931638717651, "max_q": 1.6157822608947754, "min_q": 0.9874125719070435}, "td_error": [0.3643852472305298, 1.255729079246521, 1.1879290342330933, 2.3959097862243652, 1.7889832258224487, 1.29827880859375, 0.17732232809066772, 4.147995948791504, 2.6871886253356934, 3.721846342086792, 1.4739899635314941, 1.6976709365844727, 0.10826081037521362, 1.2160779237747192, 1.4821808338165283, 1.4407776594161987, 1.4253922700881958, 0.3056255578994751, 0.8157335519790649, 1.068207025527954, 1.782308578491211, 1.554178237915039, 2.5598902702331543, 1.8809690475463867, 2.7255420684814453, 1.0626802444458008, 1.2472199201583862, 0.9925322532653809, 0.30859559774398804, 2.0449576377868652, 2.351154088973999, 1.3867851495742798, 0.8598076701164246, 3.8058528900146484, 3.8532936573028564, 2.731877326965332, 0.2393152117729187, 3.7070353031158447, 1.4594449996948242, 0.83113032579422, 0.802640438079834, 0.6520687937736511, 3.369992733001709, 2.1481921672821045, 0.4451138973236084, 2.532564401626587, 0.44329607486724854, 0.41918623447418213, 0.10156798362731934, 1.8612076044082642, 3.069620132446289, 2.17470383644104, 1.526376485824585, 3.143745183944702, 2.9249913692474365, 2.8199970722198486, 2.573512315750122, 2.3459322452545166, 1.386902928352356, 0.34380900859832764, 2.439765453338623, 3.8879942893981934, 0.21129930019378662, 0.31578606367111206, 3.1512975692749023, 0.1669325828552246, 0.32239264249801636, 2.362771987915039, 0.2512989044189453, 1.9807617664337158, 2.83742618560791, 0.09716212749481201, 0.7548359632492065, 3.5908520221710205, 2.013624906539917, 0.9728919863700867, 2.4337880611419678, 2.0182085037231445, 0.33241379261016846, 0.7950061559677124, 0.7812213897705078, 0.9382275342941284, 0.10569751262664795, 2.241147041320801, 2.674386501312256, 1.5241652727127075], "mean_td_error": 1.6480330228805542, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.021503448486328, "actor_loss": -5.181189060211182, "critic_loss": 0.38860005140304565, "alpha_loss": -0.0811987891793251, "alpha_value": 0.9919303059577942, "log_alpha_value": -0.008102456107735634, "target_entropy": -6.0, "policy_t": -0.004058006219565868, "mean_q": 1.1920361518859863, "max_q": 1.4470431804656982, "min_q": 0.9346377849578857}, "td_error": [0.3970910310745239, 1.1007447242736816, 1.863844394683838, 1.7613359689712524, 1.0995335578918457, 0.3480771780014038, 0.1008458137512207, 2.6587469577789307, 0.5397636890411377, 0.3527947664260864, 2.2062277793884277, 1.1463696956634521, 1.8472564220428467, 1.3729355335235596, 0.5013301968574524, 1.983502984046936, 1.268266201019287, 1.7017955780029297, 2.4267313480377197, 0.853974461555481, 3.500168561935425, 0.04179257154464722, 1.8192789554595947, 1.684977650642395, 0.8217231035232544, 2.6066677570343018, 1.2092413902282715, 2.0379045009613037, 2.248964786529541, 0.9600993990898132, 0.18551111221313477, 2.1561741828918457, 1.6880013942718506, 0.20531606674194336, 1.8287684917449951, 1.4599061012268066, 0.4879035949707031, 2.453315496444702, 2.060641288757324, 0.1760801076889038, 0.19882464408874512, 0.4479794502258301, 0.3456612825393677, 0.35715651512145996, 0.7636890411376953, 3.108684539794922, 1.3984973430633545, 1.9307475090026855, 0.7335914373397827, 0.827058732509613, 1.3133482933044434, 1.0630943775177002, 1.6668429374694824, 1.747968316078186, 2.289987087249756, 1.9812431335449219, 1.582430124282837, 0.056339383125305176, 2.0743603706359863, 0.4838228225708008, 0.477581262588501, 1.8565173149108887, 1.8053332567214966, 0.10406476259231567, 0.73740553855896, 0.454245924949646, 0.19834893941879272, 3.3268723487854004, 0.2962355613708496, 3.035649538040161, 2.499992847442627, 0.05952572822570801, 2.2565994262695312, 2.566645622253418, 3.6301894187927246, 1.7261275053024292, 2.6461641788482666, 2.7449445724487305, 1.5376577377319336, 1.8255419731140137, 2.0171241760253906, 0.7239372730255127, 3.1799674034118652, 0.16849327087402344, 2.7467381954193115, 0.5121919512748718], "mean_td_error": 1.4263839721679688, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.0923719436016, "num_env_steps_trained_throughput_per_sec": 137.95293745697458, "timesteps_total": 25984, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 77952, "timers": {"training_iteration_time_ms": 1966.215, "sample_time_ms": 1391.912, "load_time_ms": 0.533, "load_throughput": 483785.064, "learn_time_ms": 62.923, "learn_throughput": 4100.256, "synch_weights_time_ms": 16.704}, "counters": {"num_env_steps_sampled": 25984, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 77952, "num_agent_steps_trained": 7224, "last_target_update_ts": 25984, "num_target_updates": 28}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-19", "timestamp": 1700203039, "time_this_iter_s": 1.8879318237304688, "time_total_s": 59.72400784492493, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.72400784492493, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 86.55, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.166789054870605, "actor_loss": -5.326323986053467, "critic_loss": 1.1409432888031006, "alpha_loss": -0.08539911359548569, "alpha_value": 0.9916353821754456, "log_alpha_value": -0.008399811573326588, "target_entropy": -6.0, "policy_t": -0.023070726543664932, "mean_q": 1.3178201913833618, "max_q": 1.5032836198806763, "min_q": 1.1249711513519287}, "td_error": [2.3169028759002686, 1.6269810199737549, 2.4821553230285645, 4.448007106781006, 1.4657704830169678, 1.706390142440796, 1.599492073059082, 1.4532616138458252, 3.1781539916992188, 0.8623455166816711, 2.9051053524017334, 3.9970693588256836, 3.0607187747955322, 1.5036274194717407, 1.0629868507385254, 3.103127956390381, 3.6797308921813965, 4.037694931030273, 2.1609179973602295, 4.028837203979492, 2.477501392364502, 1.2128181457519531, 2.082048177719116, 3.9144046306610107, 3.79463791847229, 3.741629123687744, 3.3497517108917236, 4.327949523925781, 1.2975800037384033, 2.4646286964416504, 2.920576572418213, 4.684472560882568, 2.0585923194885254, 3.4023351669311523, 4.610444068908691, 3.4924893379211426, 3.356602191925049, 3.9797232151031494, 4.25837516784668, 4.133245944976807, 2.3988349437713623, 1.679956316947937, 4.962804317474365, 2.9139022827148438, 2.4781298637390137, 1.9888967275619507, 0.4610792398452759, 1.659615397453308, 1.8563144207000732, 0.3255925178527832, 2.073526620864868, 2.4641194343566895, 2.5211753845214844, 1.3567845821380615, 3.335770606994629, 1.923592209815979, 2.5691428184509277, 3.2101006507873535, 2.243262767791748, 4.561206817626953, 2.342817783355713, 2.224078416824341, 1.7080817222595215, 3.7974491119384766, 0.5414015054702759, 2.054828643798828, 3.1506948471069336, 2.096125602722168, 2.619236469268799, 3.322783946990967, 1.551703929901123, 1.7180171012878418, 4.286224365234375, 3.4736552238464355, 3.2925703525543213, 3.805959701538086, 3.3795695304870605, 3.9122931957244873, 2.5801682472229004, 1.3377635478973389, 0.9429863095283508, 5.230183124542236, 2.021437168121338, 1.2924748659133911, 1.3950488567352295, 2.5390920639038086], "mean_td_error": 2.6725528240203857, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049413681030273, "actor_loss": -5.220280170440674, "critic_loss": 0.3843344449996948, "alpha_loss": -0.08450407534837723, "alpha_value": 0.9916263818740845, "log_alpha_value": -0.008408856578171253, "target_entropy": -6.0, "policy_t": -0.03646994009613991, "mean_q": 1.3957765102386475, "max_q": 1.8108322620391846, "min_q": 0.9719623327255249}, "td_error": [0.18818652629852295, 0.8711528182029724, 2.393070697784424, 0.5917615294456482, 2.4369211196899414, 0.6096081733703613, 3.297377586364746, 1.3398449420928955, 2.0289347171783447, 1.231799602508545, 0.8845084309577942, 2.934649705886841, 2.5911827087402344, 1.8929589986801147, 0.026501059532165527, 2.401216506958008, 2.9127118587493896, 0.8584444522857666, 3.086329460144043, 1.08115816116333, 2.285961627960205, 2.770841121673584, 1.725170612335205, 1.937744140625, 0.13908034563064575, 1.0666377544403076, 1.2094602584838867, 1.3378407955169678, 2.018380641937256, 0.7715678215026855, 4.313057899475098, 1.2391270399093628, 0.9863444566726685, 1.0940996408462524, 0.891412079334259, 3.9318532943725586, 1.777294397354126, 2.9148645401000977, 1.463943362236023, 1.4351816177368164, 3.499889850616455, 3.3884854316711426, 2.8726937770843506, 3.8642077445983887, 2.861530303955078, 3.771819829940796, 1.2482194900512695, 2.4229066371917725, 3.199474334716797, 3.298717498779297, 3.923304319381714, 1.4668447971343994, 1.9707003831863403, 2.5273284912109375, 0.9503504037857056, 0.3393218517303467, 3.0540456771850586, 2.2034878730773926, 0.25853991508483887, 0.9704535603523254, 1.591990351676941, 0.4348679184913635, 0.20680022239685059, 1.4798423051834106, 3.003446578979492, 1.4812886714935303, 0.4067951440811157, 0.23432469367980957, 3.358069896697998, 1.512071967124939, 0.7279698848724365, 1.046850562095642, 2.5175018310546875, 1.1742022037506104, 2.847468376159668, 1.9083976745605469, 2.9965314865112305, 0.6252894401550293, 2.563844919204712, 0.4404906630516052, 0.20622152090072632, 1.606353521347046, 2.0265469551086426, 1.4928579330444336, 2.331843852996826, 1.690227746963501], "mean_td_error": 1.8252629041671753, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09880542755127, "actor_loss": -5.374793529510498, "critic_loss": 0.3676820397377014, "alpha_loss": -0.0848553255200386, "alpha_value": 0.9916326999664307, "log_alpha_value": -0.008402511477470398, "target_entropy": -6.0, "policy_t": -0.019095495343208313, "mean_q": 1.3025351762771606, "max_q": 1.522016167640686, "min_q": 1.0535962581634521}, "td_error": [1.8887460231781006, 0.6541301608085632, 0.07469338178634644, 0.5288547873497009, 0.4900813698768616, 2.1123976707458496, 0.08806794881820679, 0.12248331308364868, 2.9560258388519287, 1.9697990417480469, 0.19245141744613647, 1.1608281135559082, 3.163330554962158, 1.6027206182479858, 1.073554277420044, 1.261833667755127, 2.073063611984253, 1.6443195343017578, 1.0961658954620361, 1.4606376886367798, 0.38960719108581543, 1.6100373268127441, 0.8463632464408875, 0.0888332724571228, 0.19846266508102417, 0.8059803247451782, 1.0470092296600342, 0.11654841899871826, 0.07545673847198486, 0.8554076552391052, 0.26657313108444214, 0.3174315094947815, 2.000977039337158, 0.6721017360687256, 2.696012020111084, 2.1103034019470215, 3.392256736755371, 1.695642352104187, 0.7543492913246155, 0.6609451174736023, 0.9638296961784363, 1.3885881900787354, 0.8028618693351746, 1.1813888549804688, 0.2559751272201538, 2.1641392707824707, 1.3676013946533203, 1.275800347328186, 2.831345796585083, 1.5713002681732178, 0.5593478679656982, 0.11142909526824951, 1.5359938144683838, 0.7968692183494568, 0.7491146922111511, 2.830223560333252, 1.858117699623108, 1.3449256420135498, 2.7927844524383545, 3.005577564239502, 0.5032694339752197, 2.907106876373291, 1.1609830856323242, 0.44292151927948, 2.283094882965088, 2.305778980255127, 0.8757545948028564, 1.096146583557129, 0.636207103729248, 0.17322367429733276, 0.8191887736320496, 2.1342966556549072, 2.635911464691162, 2.44235897064209, 1.342194676399231, 1.4301458597183228, 2.126335620880127, 0.1813424825668335, 2.2099575996398926, 1.3042800426483154, 2.5216550827026367, 0.7853620052337646, 1.063214659690857, 1.514418125152588, 2.3919951915740967, 2.020087480545044], "mean_td_error": 1.3361502885818481, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 426.0071709745792, "num_env_steps_trained_throughput_per_sec": 122.66724342794802, "timesteps_total": 26880, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 1994.527, "sample_time_ms": 1419.037, "load_time_ms": 0.533, "load_throughput": 483958.154, "learn_time_ms": 62.884, "learn_throughput": 4102.76, "synch_weights_time_ms": 16.464}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-21", "timestamp": 1700203041, "time_this_iter_s": 2.121356964111328, "time_total_s": 61.845364809036255, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.845364809036255, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 65.35, "ram_util_percent": 92.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037955284118652, "actor_loss": -5.311919689178467, "critic_loss": 1.2777667045593262, "alpha_loss": -0.08733123540878296, "alpha_value": 0.9913376569747925, "log_alpha_value": -0.00870010256767273, "target_entropy": -6.0, "policy_t": -0.04062346741557121, "mean_q": 1.412496566772461, "max_q": 1.715855598449707, "min_q": 1.1609687805175781}, "td_error": [1.9967031478881836, 0.4710214138031006, 1.8336358070373535, 4.050924301147461, 4.322809219360352, 3.4272260665893555, 3.872675895690918, 4.23301887512207, 2.563170909881592, 4.001863479614258, 2.6189486980438232, 2.2445459365844727, 0.8443401455879211, 1.3978685140609741, 4.223211765289307, 5.229123115539551, 0.6712320446968079, 2.402164936065674, 1.124311923980713, 3.6248068809509277, 2.4792838096618652, 2.585956573486328, 2.156970500946045, 2.4001359939575195, 2.241285800933838, 3.885047435760498, 3.2201709747314453, 1.541973352432251, 3.9771273136138916, 2.298825263977051, 2.7691712379455566, 3.9024510383605957, 2.89034366607666, 3.475745677947998, 1.5371692180633545, 2.7253870964050293, 2.4944405555725098, 2.3952829837799072, 4.455530166625977, 2.6772685050964355, 4.082206726074219, 3.107891082763672, 5.312943458557129, 4.181089401245117, 1.749537706375122, 1.7071619033813477, 3.176713705062866, 1.802051305770874, 3.648404121398926, 4.50642204284668, 3.8184707164764404, 3.714534282684326, 2.828598976135254, 3.7796924114227295, 3.039869785308838, 1.3465389013290405, 3.037649154663086, 3.152580499649048, 1.8265208005905151, 3.7678160667419434, 3.000493288040161, 0.7275292277336121, 1.8463585376739502, 2.2425894737243652, 3.1299915313720703, 3.7098498344421387, 2.4063727855682373, 4.10215950012207, 1.0786569118499756, 1.094558835029602, 2.802995204925537, 2.2498583793640137, 3.9069724082946777, 2.2305593490600586, 3.410057306289673, 2.90830659866333, 2.8550877571105957, 4.598202705383301, 4.911745071411133, 3.896366596221924, 1.3017449378967285, 3.159935474395752, 3.5384695529937744, 2.4828691482543945, 1.1417324542999268, 3.4805850982666016], "mean_td_error": 2.872836112976074, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079360008239746, "actor_loss": -5.329110145568848, "critic_loss": 0.24508467316627502, "alpha_loss": -0.08778294175863266, "alpha_value": 0.9913286566734314, "log_alpha_value": -0.008709176443517208, "target_entropy": -6.0, "policy_t": -0.001072307932190597, "mean_q": 1.5178415775299072, "max_q": 1.980756402015686, "min_q": 1.1247512102127075}, "td_error": [3.635435104370117, 2.9106359481811523, 0.25262200832366943, 0.17858189344406128, 0.2952284812927246, 1.1778333187103271, 2.150803565979004, 1.5620059967041016, 3.5068440437316895, 3.6286935806274414, 1.409015417098999, 1.6330443620681763, 1.4256134033203125, 0.2823166251182556, 1.5136940479278564, 0.23560857772827148, 3.1753945350646973, 1.571195125579834, 1.657550573348999, 0.9462505578994751, 1.458676815032959, 2.1071252822875977, 0.5460872054100037, 1.0588839054107666, 0.5488085746765137, 1.1586108207702637, 0.29223769903182983, 1.5808820724487305, 0.2148175835609436, 2.1222965717315674, 0.7133208513259888, 1.125572681427002, 0.7722545266151428, 0.8590070009231567, 0.6993456482887268, 1.8937116861343384, 2.148627281188965, 0.9512143731117249, 0.13137179613113403, 0.11310988664627075, 0.7046929001808167, 0.8449140191078186, 1.4776172637939453, 0.11212486028671265, 1.0427472591400146, 1.7582412958145142, 3.2989110946655273, 1.3313452005386353, 0.6681570410728455, 1.3612298965454102, 1.311369776725769, 0.9279863834381104, 1.0693013668060303, 2.9817047119140625, 0.36492985486984253, 0.9177419543266296, 0.19247394800186157, 1.5442862510681152, 2.1169495582580566, 0.889614999294281, 0.9280687570571899, 0.7632170915603638, 1.4322147369384766, 1.2911274433135986, 0.1650092601776123, 1.8323094844818115, 1.5967522859573364, 1.9787662029266357, 1.5399153232574463, 2.5321197509765625, 1.6501699686050415, 1.7187583446502686, 1.4645421504974365, 1.243998408317566, 3.2376673221588135, 2.099255084991455, 1.7813518047332764, 0.031713008880615234, 0.8270229697227478, 0.5794486403465271, 1.7172291278839111, 0.13117218017578125, 0.887305498123169, 0.9153560996055603, 0.18919336795806885, 0.35082709789276123], "mean_td_error": 1.2958741188049316, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.141277313232422, "actor_loss": -5.509742736816406, "critic_loss": 0.3323778510093689, "alpha_loss": -0.08825533837080002, "alpha_value": 0.9913351535797119, "log_alpha_value": -0.008702585473656654, "target_entropy": -6.0, "policy_t": 0.057264503091573715, "mean_q": 1.4064912796020508, "max_q": 1.744527816772461, "min_q": 1.094475269317627}, "td_error": [0.09268033504486084, 1.071526288986206, 2.3848352432250977, 2.075201988220215, 2.585604190826416, 1.8741388320922852, 0.1492505669593811, 0.7985886335372925, 0.037184834480285645, 0.8324103355407715, 1.7051963806152344, 0.7413715720176697, 2.9359960556030273, 0.8197175860404968, 1.4951488971710205, 1.033170223236084, 2.682462692260742, 2.440498113632202, 0.5086169242858887, 0.04624301195144653, 1.0660874843597412, 0.48810136318206787, 1.7876510620117188, 2.7732720375061035, 1.4912488460540771, 1.6439080238342285, 1.3718605041503906, 1.050211787223816, 2.5875492095947266, 0.4525108337402344, 0.08293616771697998, 2.4253902435302734, 1.5357091426849365, 0.20341676473617554, 0.3788689970970154, 1.8379855155944824, 0.10108262300491333, 1.3575488328933716, 0.750361979007721, 0.2927679419517517, 2.215244770050049, 1.2448346614837646, 2.8231313228607178, 0.7977622151374817, 2.675816059112549, 2.898683786392212, 0.7748124599456787, 0.0245935320854187, 0.14815443754196167, 1.1653207540512085, 1.8716237545013428, 1.551246166229248, 1.29252028465271, 0.4087334871292114, 0.2382332682609558, 2.1112301349639893, 0.334617555141449, 1.0582985877990723, 0.42487633228302, 0.30994105339050293, 1.66237473487854, 0.3037751317024231, 1.8886069059371948, 0.306932270526886, 1.0085835456848145, 1.2176425457000732, 2.7692267894744873, 1.4310909509658813, 2.1690256595611572, 0.18405115604400635, 0.9239016175270081, 1.4596643447875977, 1.6826852560043335, 2.1748604774475098, 1.9571906328201294, 2.497831344604492, 0.2039482593536377, 1.3525936603546143, 1.5807632207870483, 2.3624322414398193, 0.3361552953720093, 1.5134501457214355, 1.4473313093185425, 0.7148408889770508, 0.13796252012252808, 1.1719319820404053], "mean_td_error": 1.2653120756149292, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 434.60037843262467, "num_env_steps_trained_throughput_per_sec": 125.1416268254656, "timesteps_total": 27776, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 83328, "timers": {"training_iteration_time_ms": 2014.047, "sample_time_ms": 1440.073, "load_time_ms": 0.537, "load_throughput": 480519.73, "learn_time_ms": 62.839, "learn_throughput": 4105.757, "synch_weights_time_ms": 16.593}, "counters": {"num_env_steps_sampled": 27776, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 83328, "num_agent_steps_trained": 7740, "last_target_update_ts": 27776, "num_target_updates": 30}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-24", "timestamp": 1700203044, "time_this_iter_s": 2.0770139694213867, "time_total_s": 63.92237877845764, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e074c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 63.92237877845764, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 75.10000000000001, "ram_util_percent": 92.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078920364379883, "actor_loss": -5.434728622436523, "critic_loss": 1.0597985982894897, "alpha_loss": -0.09071289002895355, "alpha_value": 0.9910401105880737, "log_alpha_value": -0.009000257588922977, "target_entropy": -6.0, "policy_t": -0.013964504934847355, "mean_q": 1.5511136054992676, "max_q": 1.865360975265503, "min_q": 1.2456586360931396}, "td_error": [4.901235103607178, 1.7485547065734863, 2.264998197555542, 3.165020704269409, 2.7121853828430176, 1.2378675937652588, 4.491630554199219, 2.1097261905670166, 3.5360422134399414, 1.4758602380752563, 3.319882392883301, 4.109801769256592, 3.429987907409668, 3.948272705078125, 2.7014737129211426, 1.5853123664855957, 1.9664239883422852, 4.011203765869141, 2.3517863750457764, 2.280014991760254, 2.3353991508483887, 0.5589049458503723, 3.54815673828125, 1.7326393127441406, 2.013871669769287, 4.31843376159668, 4.031667709350586, 1.246532678604126, 1.0985970497131348, 3.4222676753997803, 2.2350592613220215, 1.8611140251159668, 1.2342524528503418, 1.2924518585205078, 1.4145255088806152, 2.832023859024048, 3.556478977203369, 4.074767589569092, 1.6290632486343384, 3.4453463554382324, 2.7673864364624023, 0.5491224527359009, 2.799497604370117, 2.989753246307373, 1.841212511062622, 2.7154881954193115, 1.8776257038116455, 2.57346510887146, 2.7178375720977783, 3.7164182662963867, 2.384836435317993, 5.607153415679932, 2.6511263847351074, 2.1305129528045654, 2.5298585891723633, 1.8685369491577148, 2.9684534072875977, 1.9701461791992188, 2.1308252811431885, 1.3993819952011108, 3.7178845405578613, 3.782388687133789, 3.204063892364502, 0.4884396195411682, 2.0348961353302, 1.3064186573028564, 1.3322985172271729, 2.5084452629089355, 0.5359569191932678, 1.228513479232788, 0.3914262652397156, 3.343820571899414, 4.024370193481445, 2.7657394409179688, 1.6619048118591309, 2.3434698581695557, 3.6588125228881836, 1.6635730266571045, 0.9934550523757935, 0.308652400970459, 0.15639334917068481, 2.489419460296631, 2.5746607780456543, 2.079404830932617, 4.487911701202393, 3.0498435497283936], "mean_td_error": 2.4598793983459473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126911163330078, "actor_loss": -5.476487159729004, "critic_loss": 0.23673424124717712, "alpha_loss": -0.0912381038069725, "alpha_value": 0.9910309910774231, "log_alpha_value": -0.009009471163153648, "target_entropy": -6.0, "policy_t": 0.01966623216867447, "mean_q": 1.7080038785934448, "max_q": 2.2940282821655273, "min_q": 1.2263076305389404}, "td_error": [0.7740073204040527, 0.7738870978355408, 1.5476875305175781, 0.5185790061950684, 2.5646228790283203, 0.5372431874275208, 1.0411608219146729, 0.6117112636566162, 1.657325029373169, 1.1309549808502197, 0.5622336268424988, 1.7594112157821655, 0.8196429014205933, 0.40767258405685425, 1.3223176002502441, 0.2622879147529602, 0.09416526556015015, 0.8105310201644897, 2.508183479309082, 1.3237943649291992, 0.31757330894470215, 1.0887123346328735, 3.096897602081299, 0.8178200721740723, 0.647583544254303, 1.1713159084320068, 1.1084372997283936, 3.3108739852905273, 1.6303317546844482, 0.12639009952545166, 0.05905556678771973, 2.3151233196258545, 0.3550931215286255, 3.19952392578125, 1.6818392276763916, 3.085784912109375, 1.0222134590148926, 0.07078331708908081, 0.8193883895874023, 0.7907288670539856, 1.734060525894165, 0.5285153388977051, 0.08299440145492554, 0.24688249826431274, 1.822444200515747, 3.120756149291992, 0.2642209529876709, 2.520723819732666, 1.7746405601501465, 0.9786786437034607, 0.8792293667793274, 1.383026361465454, 0.48664402961730957, 0.4280017018318176, 1.8863229751586914, 0.24077558517456055, 1.1787989139556885, 0.18754398822784424, 1.1769390106201172, 0.19904184341430664, 3.850825309753418, 0.30115753412246704, 0.3958713412284851, 0.881649911403656, 3.1523118019104004, 1.258760929107666, 1.391164779663086, 1.2315562963485718, 0.5090208649635315, 1.6588099002838135, 0.9062698483467102, 2.4343178272247314, 0.7382288575172424, 1.817004919052124, 3.708804130554199, 2.5352230072021484, 1.1112337112426758, 1.6901252269744873, 0.16959846019744873, 2.6540517807006836, 1.115100622177124, 0.0839126706123352, 0.35561472177505493, 1.9077328443527222, 2.5298471450805664, 0.08941686153411865], "mean_td_error": 1.2481480836868286, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102995872497559, "actor_loss": -5.608691692352295, "critic_loss": 0.2991572618484497, "alpha_loss": -0.09095489978790283, "alpha_value": 0.9910376667976379, "log_alpha_value": -0.009002765640616417, "target_entropy": -6.0, "policy_t": 0.0042998273856937885, "mean_q": 1.5457879304885864, "max_q": 1.8400206565856934, "min_q": 1.2632440328598022}, "td_error": [0.39986729621887207, 0.3972932696342468, 1.1674277782440186, 0.37639808654785156, 1.5791934728622437, 1.1499707698822021, 0.5198193192481995, 0.8524322509765625, 0.777236819267273, 1.0210233926773071, 0.36612486839294434, 0.3637573719024658, 0.7493910193443298, 0.11042845249176025, 0.20865881443023682, 1.4161897897720337, 0.11750835180282593, 2.1671156883239746, 2.0856893062591553, 0.677146315574646, 2.079298496246338, 0.30019938945770264, 2.372863531112671, 0.33711719512939453, 0.06657570600509644, 1.726476788520813, 3.96553897857666, 0.7222594022750854, 1.297199010848999, 0.06716048717498779, 1.6386685371398926, 0.7502715587615967, 0.9712417125701904, 0.4896116852760315, 1.7035787105560303, 2.024479866027832, 0.28672200441360474, 2.373137950897217, 1.2146412134170532, 1.729658603668213, 0.24585109949111938, 0.9137764573097229, 2.1285629272460938, 0.7012382745742798, 2.216944694519043, 0.8247244954109192, 1.3510397672653198, 0.6265789866447449, 1.6756764650344849, 1.4011805057525635, 1.9636352062225342, 1.5225911140441895, 1.3288259506225586, 0.392764687538147, 1.696218729019165, 1.9070639610290527, 1.827006220817566, 1.065600872039795, 2.0242347717285156, 0.10854965448379517, 0.5666906833648682, 0.8951492309570312, 0.31679534912109375, 0.4674938917160034, 1.218592643737793, 0.09196043014526367, 0.19635224342346191, 0.8794835805892944, 0.5734277367591858, 1.040928602218628, 0.09224367141723633, 2.2071871757507324, 2.505509853363037, 0.936364471912384, 2.0586514472961426, 0.37596815824508667, 2.461029291152954, 2.016998052597046, 1.3081573247909546, 0.9077399969100952, 0.5412865877151489, 3.0779876708984375, 2.76362943649292, 4.033415794372559, 0.2958213686943054, 0.225894033908844], "mean_td_error": 1.169723391532898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 455.2841265953011, "num_env_steps_trained_throughput_per_sec": 131.0974382383791, "timesteps_total": 28672, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 2019.682, "sample_time_ms": 1446.53, "load_time_ms": 0.537, "load_throughput": 480711.844, "learn_time_ms": 62.844, "learn_throughput": 4105.429, "synch_weights_time_ms": 16.585}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-26", "timestamp": 1700203046, "time_this_iter_s": 1.9848487377166748, "time_total_s": 65.90722751617432, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 65.90722751617432, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 94.19999999999999, "ram_util_percent": 92.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098843574523926, "actor_loss": -5.54918098449707, "critic_loss": 1.0644583702087402, "alpha_loss": -0.09392309188842773, "alpha_value": 0.9907427430152893, "log_alpha_value": -0.009300380945205688, "target_entropy": -6.0, "policy_t": -0.016201281920075417, "mean_q": 1.6511129140853882, "max_q": 1.96220064163208, "min_q": 1.3528289794921875}, "td_error": [0.20722508430480957, 2.0800466537475586, 2.820361852645874, 3.579240322113037, 2.289320468902588, 1.837578296661377, 1.6886589527130127, 3.1116137504577637, 2.40352201461792, 0.5779415965080261, 0.7016429305076599, 1.6523878574371338, 2.6825008392333984, 1.88084077835083, 0.47331172227859497, 4.312651634216309, 1.7580115795135498, 4.0270819664001465, 2.5401954650878906, 2.92488956451416, 4.252490997314453, 3.7446963787078857, 2.5189757347106934, 1.2641156911849976, 0.3980158567428589, 2.154463291168213, 2.4950170516967773, 4.404169082641602, 0.40084409713745117, 4.237288475036621, 3.484273910522461, 4.230470180511475, 1.9704869985580444, 0.10967451333999634, 1.8941476345062256, 2.084655284881592, 1.6848547458648682, 1.976157546043396, 3.837200403213501, 3.461914300918579, 2.2841482162475586, 2.922501564025879, 1.9722576141357422, 2.142787456512451, 2.9896721839904785, 1.7273138761520386, 1.5645285844802856, 2.9076528549194336, 2.246464252471924, 5.860683441162109, 1.8787651062011719, 1.3288556337356567, 2.1628012657165527, 1.7370305061340332, 4.37830924987793, 3.417013645172119, 1.5206589698791504, 4.097369194030762, 0.9877808094024658, 4.95121955871582, 1.6542590856552124, 2.5338077545166016, 2.3833353519439697, 1.3631043434143066, 5.387994766235352, 0.49250876903533936, 4.225922107696533, 3.1388230323791504, 2.116426944732666, 2.8995189666748047, 2.6271581649780273, 2.4628257751464844, 3.507373094558716, 3.3950657844543457, 2.8365464210510254, 2.619424343109131, 3.661700963973999, 4.478056907653809, 2.9848265647888184, 2.1478185653686523, 3.558157444000244, 1.1397522687911987, 1.7202526330947876, 2.514293670654297, 1.6682169437408447, 1.7171461582183838], "mean_td_error": 2.517035722732544, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087366104125977, "actor_loss": -5.584033489227295, "critic_loss": 0.24423357844352722, "alpha_loss": -0.0939117893576622, "alpha_value": 0.9907333850860596, "log_alpha_value": -0.009309843182563782, "target_entropy": -6.0, "policy_t": -0.03458274528384209, "mean_q": 1.8075687885284424, "max_q": 2.293626546859741, "min_q": 1.3354016542434692}, "td_error": [1.977738857269287, 1.1467559337615967, 0.8114995956420898, 0.3032982349395752, 0.9363894462585449, 0.5701187252998352, 0.66860431432724, 2.1708984375, 0.41006988286972046, 2.6711487770080566, 1.820073127746582, 0.3040698170661926, 0.9073987603187561, 1.5364210605621338, 0.6798139810562134, 2.3365273475646973, 1.1848409175872803, 0.3752990961074829, 2.3688082695007324, 0.18334245681762695, 0.2677861452102661, 1.0699949264526367, 0.38695305585861206, 0.5477075576782227, 1.2121264934539795, 1.246720314025879, 1.3327916860580444, 0.7945324778556824, 1.4812283515930176, 2.7729883193969727, 1.5583839416503906, 1.7785202264785767, 1.5751980543136597, 2.8922481536865234, 1.373192310333252, 0.26575934886932373, 1.169724702835083, 1.2653412818908691, 2.247753620147705, 0.539205014705658, 0.47368288040161133, 2.215620994567871, 0.1682497262954712, 3.3635268211364746, 1.989627718925476, 2.534195899963379, 1.4452528953552246, 0.9376887083053589, 1.029167890548706, 0.34349000453948975, 2.254774570465088, 0.2316117286682129, 0.5333224534988403, 1.4188852310180664, 1.3667185306549072, 0.9546352624893188, 1.8814712762832642, 0.31956803798675537, 3.1257176399230957, 0.16999930143356323, 0.9859756231307983, 2.7950003147125244, 0.6644541025161743, 1.9783847332000732, 1.408475637435913, 1.397732138633728, 1.298339605331421, 0.7138208746910095, 0.09735715389251709, 1.4056636095046997, 1.1409342288970947, 0.6313524842262268, 1.455113172531128, 1.7753419876098633, 1.581900715827942, 0.6669164299964905, 2.139984607696533, 1.4186431169509888, 1.717799186706543, 1.4335750341415405, 1.342963457107544, 0.7874257564544678, 2.9593253135681152, 0.11505478620529175, 1.2383378744125366, 1.948852300643921], "mean_td_error": 1.2906651496887207, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14351749420166, "actor_loss": -5.7532429695129395, "critic_loss": 0.34471505880355835, "alpha_loss": -0.0943647101521492, "alpha_value": 0.990740180015564, "log_alpha_value": -0.009302956983447075, "target_entropy": -6.0, "policy_t": 0.028442982584238052, "mean_q": 1.6668083667755127, "max_q": 2.0341594219207764, "min_q": 1.358872413635254}, "td_error": [2.7361629009246826, 1.5193891525268555, 1.2603952884674072, 1.4552158117294312, 1.6706913709640503, 2.904792308807373, 1.265135645866394, 3.3406641483306885, 1.5202276706695557, 1.0383946895599365, 2.2535414695739746, 2.0685620307922363, 1.6746816635131836, 1.7319189310073853, 2.9480302333831787, 1.010793924331665, 1.6541281938552856, 0.3046789765357971, 2.985788106918335, 1.805112361907959, 1.7569715976715088, 0.510256826877594, 1.0948371887207031, 0.9485504031181335, 0.517384946346283, 0.5372695326805115, 3.4223368167877197, 0.6292423009872437, 0.4994227886199951, 0.26002752780914307, 1.558314561843872, 0.664273738861084, 0.07699209451675415, 0.28349369764328003, 3.05433988571167, 0.8042765259742737, 1.0714151859283447, 0.8684627413749695, 0.8203511834144592, 1.669610619544983, 0.3212277889251709, 0.7218334674835205, 0.28052663803100586, 0.5829173922538757, 0.9751712679862976, 0.6539838314056396, 0.25093215703964233, 0.7995414733886719, 1.9548733234405518, 0.2174556851387024, 0.1124383807182312, 2.0063679218292236, 0.26878148317337036, 0.2262895107269287, 2.0159389972686768, 1.7959606647491455, 0.9446771740913391, 0.1250184178352356, 1.1169030666351318, 2.099532127380371, 1.5378117561340332, 1.570776104927063, 0.18083089590072632, 0.15353882312774658, 1.5009616613388062, 3.364622116088867, 0.3742045760154724, 1.887393593788147, 0.1667075753211975, 1.1951403617858887, 1.2282633781433105, 1.6274237632751465, 1.7715516090393066, 2.107057809829712, 1.1824824810028076, 1.2267943620681763, 2.4746899604797363, 2.5453248023986816, 1.0289921760559082, 1.0641411542892456, 0.37505626678466797, 0.22381561994552612, 1.628218173980713, 1.1702897548675537, 2.589841365814209, 0.2648552656173706], "mean_td_error": 1.2803173065185547, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 469.85925013237113, "num_env_steps_trained_throughput_per_sec": 135.2942930068658, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 2022.176, "sample_time_ms": 1447.563, "load_time_ms": 0.541, "load_throughput": 477003.629, "learn_time_ms": 62.98, "learn_throughput": 4096.543, "synch_weights_time_ms": 16.742}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-28", "timestamp": 1700203048, "time_this_iter_s": 1.924856185913086, "time_total_s": 67.8320837020874, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07503a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.8320837020874, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 67.0, "ram_util_percent": 92.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089632987976074, "actor_loss": -5.649319171905518, "critic_loss": 1.1211013793945312, "alpha_loss": -0.09686572104692459, "alpha_value": 0.9904454350471497, "log_alpha_value": -0.009600518271327019, "target_entropy": -6.0, "policy_t": 0.014829807914793491, "mean_q": 1.7690281867980957, "max_q": 2.108875274658203, "min_q": 1.4505400657653809}, "td_error": [0.5856415033340454, 3.746091604232788, 4.310951232910156, 2.5812721252441406, 1.8184537887573242, 2.8999836444854736, 3.63424015045166, 3.842430830001831, 3.0068979263305664, 1.1199501752853394, 5.540438175201416, 1.7728362083435059, 4.016438007354736, 1.214449167251587, 3.1540069580078125, 1.0452189445495605, 3.454167366027832, 3.5648608207702637, 3.7412490844726562, 2.271934986114502, 1.954229712486267, 2.371769428253174, 2.7291996479034424, 2.3221123218536377, 0.8071590662002563, 2.5617523193359375, 1.4626264572143555, 5.520045280456543, 3.711545944213867, 3.2264046669006348, 1.3311774730682373, 1.7391120195388794, 2.1953954696655273, 3.034529209136963, 5.094508647918701, 3.4102485179901123, 2.6287055015563965, 0.12601172924041748, 2.2968523502349854, 1.9002060890197754, 2.925579309463501, 0.7766604423522949, 1.4137496948242188, 1.6236400604248047, 3.5206141471862793, 1.333380103111267, 3.1059322357177734, 3.2280311584472656, 5.327997207641602, 2.103113889694214, 3.6298584938049316, 3.3608765602111816, 2.2119040489196777, 1.6423134803771973, 4.1001667976379395, 2.357408046722412, 3.3039324283599854, 2.9636802673339844, 2.6567416191101074, 0.6401313543319702, 2.9408483505249023, 3.2482662200927734, 2.5891661643981934, 2.2704660892486572, 4.377092361450195, 3.6546363830566406, 3.2229859828948975, 2.7537879943847656, 2.573294162750244, 1.9109735488891602, 4.087823390960693, 3.095987319946289, 2.7934730052948, 0.4290943145751953, 3.6014275550842285, 2.2824857234954834, 3.046137809753418, 0.3960775136947632, 4.330828666687012, 1.5262606143951416, 3.1760101318359375, 3.352374315261841, 1.8416705131530762, 0.11663562059402466, 2.6683874130249023, 0.6276456713676453], "mean_td_error": 2.6381936073303223, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082362174987793, "actor_loss": -5.686214923858643, "critic_loss": 0.212423637509346, "alpha_loss": -0.09689351171255112, "alpha_value": 0.9904358386993408, "log_alpha_value": -0.009610197506844997, "target_entropy": -6.0, "policy_t": -0.003953107632696629, "mean_q": 1.9609599113464355, "max_q": 2.581871271133423, "min_q": 1.317092776298523}, "td_error": [1.0082817077636719, 1.428450107574463, 1.1986327171325684, 1.0819368362426758, 0.31296873092651367, 1.7272539138793945, 1.2247648239135742, 0.22725611925125122, 0.8204389810562134, 1.6622158288955688, 0.30220794677734375, 1.6308484077453613, 2.1835124492645264, 0.9541574716567993, 2.323235034942627, 0.18924039602279663, 1.7208417654037476, 0.5781049728393555, 1.162559986114502, 1.1670523881912231, 0.2625574469566345, 3.7653017044067383, 3.3288092613220215, 0.35151052474975586, 0.1499505639076233, 1.1683967113494873, 1.0584335327148438, 1.4819501638412476, 1.7531046867370605, 2.198906421661377, 1.270261287689209, 1.3897874355316162, 1.1811141967773438, 0.06288373470306396, 1.4511065483093262, 0.604328989982605, 0.7881197929382324, 0.22325539588928223, 0.5571986436843872, 0.663388729095459, 0.28739815950393677, 1.1120026111602783, 2.8031909465789795, 0.8603206872940063, 0.19054961204528809, 0.21439862251281738, 2.1889045238494873, 1.1155318021774292, 0.17457866668701172, 1.246328592300415, 0.6014255285263062, 0.47376763820648193, 1.414388656616211, 3.688236713409424, 0.37242209911346436, 0.9166260957717896, 1.3183507919311523, 0.19036269187927246, 0.27524399757385254, 1.389259934425354, 0.4232565760612488, 2.8828513622283936, 2.0399539470672607, 1.3670072555541992, 3.190972328186035, 0.6826021075248718, 0.3468549847602844, 2.161825180053711, 1.311319351196289, 0.9899854063987732, 0.6610309481620789, 0.06972187757492065, 2.168760061264038, 0.6904560327529907, 1.3508753776550293, 0.23959410190582275, 0.4594232439994812, 1.8011448383331299, 0.6395065188407898, 0.18366152048110962, 1.1931945085525513, 1.3514404296875, 0.3019574284553528, 2.8429195880889893, 2.377258777618408, 0.8131052255630493], "mean_td_error": 1.1626546382904053, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.011920928955078, "actor_loss": -5.778770446777344, "critic_loss": 0.30967581272125244, "alpha_loss": -0.09614692628383636, "alpha_value": 0.99044269323349, "log_alpha_value": -0.009603244252502918, "target_entropy": -6.0, "policy_t": 0.003009198699146509, "mean_q": 1.7798817157745361, "max_q": 2.2351346015930176, "min_q": 1.4117469787597656}, "td_error": [0.5982637405395508, 0.6437833309173584, 0.52726811170578, 0.1921321153640747, 0.5056852102279663, 1.4888547658920288, 0.6025184988975525, 1.802370548248291, 1.532412052154541, 0.49190211296081543, 0.08692514896392822, 1.501376748085022, 1.3804426193237305, 1.4334436655044556, 2.0245137214660645, 0.6916866898536682, 1.296320915222168, 1.6903704404830933, 1.4910814762115479, 1.9946954250335693, 0.07775270938873291, 2.5221991539001465, 1.2474111318588257, 1.0717161893844604, 1.633387565612793, 0.5672365427017212, 0.4560821056365967, 1.9468045234680176, 1.1216914653778076, 1.3457105159759521, 1.4128265380859375, 0.812340497970581, 0.6059880256652832, 0.2428799867630005, 0.8734036684036255, 0.49500322341918945, 0.5731175541877747, 1.0420397520065308, 0.2028711438179016, 0.5161846280097961, 0.1829962134361267, 1.8030093908309937, 2.5932154655456543, 3.4563498497009277, 0.9090755581855774, 0.1385265588760376, 0.5224065780639648, 1.4682841300964355, 1.4336373805999756, 0.4662432074546814, 0.550046443939209, 2.9563894271850586, 4.433204650878906, 0.5825924277305603, 1.3852598667144775, 0.6236543655395508, 1.1366736888885498, 1.716194987297058, 0.19506198167800903, 1.4912633895874023, 1.1200015544891357, 1.2788028717041016, 0.37690597772598267, 0.8420950770378113, 0.03320401906967163, 0.8962433934211731, 0.9629489183425903, 3.749218463897705, 2.269076347351074, 1.452012062072754, 0.13244867324829102, 0.2416541576385498, 1.3699758052825928, 0.27292561531066895, 2.6971335411071777, 1.644966959953308, 0.7838850021362305, 0.13672363758087158, 1.2727200984954834, 2.3884968757629395, 1.84110689163208, 3.3373708724975586, 2.181434154510498, 2.464088201522827, 1.533512830734253, 0.3159024715423584], "mean_td_error": 1.2137399911880493, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 313.81045249254555, "num_env_steps_trained_throughput_per_sec": 90.36059904361244, "timesteps_total": 30464, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 2109.725, "sample_time_ms": 1525.801, "load_time_ms": 0.551, "load_throughput": 468596.731, "learn_time_ms": 63.899, "learn_throughput": 4037.631, "synch_weights_time_ms": 16.916}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-30", "timestamp": 1700203050, "time_this_iter_s": 2.883293867111206, "time_total_s": 70.71537756919861, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.71537756919861, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 82.72500000000001, "ram_util_percent": 92.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10460376739502, "actor_loss": -5.833725452423096, "critic_loss": 0.9299346208572388, "alpha_loss": -0.10004211962223053, "alpha_value": 0.9901481866836548, "log_alpha_value": -0.009900648146867752, "target_entropy": -6.0, "policy_t": 0.021672852337360382, "mean_q": 1.9162448644638062, "max_q": 2.303277015686035, "min_q": 1.6404963731765747}, "td_error": [1.5745391845703125, 1.4503037929534912, 3.471595048904419, 3.1659231185913086, 0.17757362127304077, 2.0471320152282715, 1.8936290740966797, 0.6544108986854553, 3.9987339973449707, 2.951303482055664, 2.6148641109466553, 1.1824184656143188, 2.378976821899414, 1.6197631359100342, 0.3015262484550476, 1.5137436389923096, 1.0880521535873413, 2.6294503211975098, 2.4621989727020264, 2.761378288269043, 2.3299317359924316, 2.515475273132324, 1.6965570449829102, 2.5724594593048096, 1.5680465698242188, 1.5326452255249023, 1.3165451288223267, 2.7721214294433594, 1.1900396347045898, 2.056757926940918, 3.5434160232543945, 0.7625882625579834, 2.0169870853424072, 3.1382012367248535, 1.8215827941894531, 3.132412910461426, 2.7882730960845947, 3.77596378326416, 2.1152029037475586, 3.2879691123962402, 1.001629114151001, 1.9789469242095947, 1.535637617111206, 2.0367326736450195, 0.9419885873794556, 2.152000904083252, 3.507235288619995, 1.561152458190918, 0.58571457862854, 3.74200439453125, 1.982067584991455, 4.453578472137451, 1.6326987743377686, 2.412238597869873, 5.535124778747559, 0.5119996070861816, 3.351814031600952, 1.9616050720214844, 2.2220535278320312, 0.7666172981262207, 1.0703598260879517, 2.615156650543213, 1.8154075145721436, 3.2882041931152344, 1.9733631610870361, 3.0108590126037598, 1.198519229888916, 4.290157794952393, 2.667595148086548, 1.772268295288086, 0.7504505515098572, 0.9018160700798035, 1.9634236097335815, 1.3488068580627441, 2.408247232437134, 2.658273935317993, 4.49484920501709, 2.9217114448547363, 2.1774187088012695, 2.6000499725341797, 1.1715540885925293, 1.6202342510223389, 1.818465232849121, 3.0546722412109375, 3.27791166305542, 3.693647861480713], "mean_td_error": 2.212871551513672, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.192309379577637, "actor_loss": -5.866118907928467, "critic_loss": 0.16284213960170746, "alpha_loss": -0.10101114213466644, "alpha_value": 0.9901384115219116, "log_alpha_value": -0.00991052482277155, "target_entropy": -6.0, "policy_t": 0.011732345446944237, "mean_q": 2.0731613636016846, "max_q": 2.8053267002105713, "min_q": 1.5994553565979004}, "td_error": [1.686759114265442, 2.410693645477295, 0.7814592719078064, 1.505990982055664, 0.4064342975616455, 0.8459520936012268, 0.9581373929977417, 1.1906888484954834, 1.4008601903915405, 0.4965680241584778, 1.17508864402771, 1.5163384675979614, 0.2639525532722473, 0.511439859867096, 0.7983360886573792, 0.8183658123016357, 0.27205950021743774, 1.1610175371170044, 0.35481250286102295, 0.10632896423339844, 0.689305305480957, 0.7147942781448364, 0.8981430530548096, 0.5425251722335815, 1.0790860652923584, 0.6426647901535034, 0.45536941289901733, 0.3699026107788086, 0.7986565828323364, 2.0111775398254395, 0.4618847966194153, 1.4973827600479126, 1.5401413440704346, 0.5916889309883118, 0.4091932773590088, 0.3998992443084717, 2.3426506519317627, 0.8125661611557007, 0.3282408118247986, 1.177386999130249, 0.19449567794799805, 0.4941706657409668, 1.7613203525543213, 1.4103114604949951, 0.2991747260093689, 0.4102877378463745, 1.5537128448486328, 1.1389837265014648, 1.2284501791000366, 0.5853849649429321, 1.6884140968322754, 0.21683597564697266, 2.0675911903381348, 2.6116385459899902, 1.9413982629776, 0.3984784483909607, 0.9502739906311035, 0.3938283920288086, 0.5438514947891235, 0.31151866912841797, 1.3577823638916016, 1.0080426931381226, 0.4307301640510559, 1.9584773778915405, 0.9666468501091003, 0.026422619819641113, 0.46750861406326294, 0.16140317916870117, 1.4654353857040405, 0.5459154844284058, 1.7206788063049316, 1.3152588605880737, 0.9532296657562256, 0.754231333732605, 1.663405179977417, 1.4801379442214966, 1.3431050777435303, 1.42018461227417, 1.0430734157562256, 0.14542019367218018, 0.49549734592437744, 2.2191522121429443, 2.7001419067382812, 0.40685105323791504, 0.17938798666000366, 1.8172407150268555], "mean_td_error": 0.9845283031463623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081289291381836, "actor_loss": -5.951412677764893, "critic_loss": 0.2120535671710968, "alpha_loss": -0.09983835369348526, "alpha_value": 0.9901455640792847, "log_alpha_value": -0.00990333128720522, "target_entropy": -6.0, "policy_t": 0.05880933627486229, "mean_q": 1.9008575677871704, "max_q": 2.4133026599884033, "min_q": 1.521864891052246}, "td_error": [0.3155202865600586, 0.4263177514076233, 0.2385604977607727, 0.30476808547973633, 0.8380203247070312, 1.8888721466064453, 0.2277711033821106, 1.8951627016067505, 0.9449500441551208, 0.44140708446502686, 3.0617666244506836, 0.6566305160522461, 0.8232892155647278, 1.0202085971832275, 3.0143377780914307, 0.6762961745262146, 0.280204176902771, 2.4039220809936523, 1.5550400018692017, 0.5368607640266418, 1.2100862264633179, 0.9827136993408203, 0.3300545811653137, 1.219858169555664, 0.4684640169143677, 1.67434823513031, 1.0594836473464966, 0.9344507455825806, 0.20643234252929688, 0.8487050533294678, 1.119706630706787, 1.8549633026123047, 0.9652280807495117, 0.27639079093933105, 0.6247785091400146, 0.06308096647262573, 0.6635971069335938, 2.1546499729156494, 1.1838366985321045, 0.7045415043830872, 1.213068962097168, 0.5710793137550354, 0.5111926794052124, 1.4094825983047485, 0.3273913264274597, 0.3294244408607483, 0.12090879678726196, 0.6740139126777649, 0.6572730541229248, 0.49148160219192505, 2.1648683547973633, 0.27985918521881104, 0.6483222246170044, 2.1853063106536865, 0.2571721076965332, 0.1383034586906433, 0.7396755218505859, 0.80772465467453, 1.0856467485427856, 0.6276990175247192, 0.11820840835571289, 0.8092454671859741, 0.5089657306671143, 0.38538414239883423, 0.31198757886886597, 0.29015886783599854, 0.9278159141540527, 0.8022699356079102, 1.0126056671142578, 1.2015831470489502, 0.44509702920913696, 3.1763625144958496, 0.8656406402587891, 0.560958206653595, 0.2690807580947876, 0.4328569173812866, 0.9874422550201416, 0.3216150999069214, 0.6220012307167053, 1.9653706550598145, 0.11753112077713013, 1.7540168762207031, 3.2049217224121094, 0.15811026096343994, 0.07042801380157471, 2.4845800399780273], "mean_td_error": 0.9202256202697754, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 346.5975319162672, "num_env_steps_trained_throughput_per_sec": 99.80152146696086, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 2161.103, "sample_time_ms": 1579.186, "load_time_ms": 0.548, "load_throughput": 470409.682, "learn_time_ms": 63.859, "learn_throughput": 4040.161, "synch_weights_time_ms": 17.597}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-33", "timestamp": 1700203053, "time_this_iter_s": 2.5977001190185547, "time_total_s": 73.31307768821716, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052649d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 73.31307768821716, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 80.925, "ram_util_percent": 92.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063514709472656, "actor_loss": -5.93033504486084, "critic_loss": 0.9114294648170471, "alpha_loss": -0.10265593975782394, "alpha_value": 0.9898510575294495, "log_alpha_value": -0.010200803168118, "target_entropy": -6.0, "policy_t": 0.021775851026177406, "mean_q": 2.0516488552093506, "max_q": 2.467855453491211, "min_q": 1.6587082147598267}, "td_error": [2.3370909690856934, 2.098879814147949, 3.2144603729248047, 1.6042901277542114, 1.189719796180725, 0.6230384111404419, 1.0220353603363037, 1.8676217794418335, 0.576066255569458, 4.759132385253906, 1.0568166971206665, 1.5467549562454224, 2.7579517364501953, 2.324666976928711, 0.8755802512168884, 1.0970648527145386, 3.0631258487701416, 2.792508363723755, 2.426710605621338, 0.8383249044418335, 4.141118049621582, 1.6636219024658203, 4.419294357299805, 3.3158295154571533, 3.3346915245056152, 3.177884578704834, 2.1554107666015625, 4.231959819793701, 3.350857973098755, 2.189263105392456, 1.4356622695922852, 0.8615844249725342, 4.316695213317871, 0.8098149299621582, 3.536162853240967, 2.039640426635742, 1.9213236570358276, 0.6784740686416626, 0.062485575675964355, 4.03602933883667, 3.1734251976013184, 2.3395910263061523, 1.356250524520874, 1.7028052806854248, 2.018435478210449, 1.5894312858581543, 2.281865119934082, 1.9303666353225708, 2.3697803020477295, 3.197611093521118, 1.4079854488372803, 2.1820356845855713, 1.8998146057128906, 3.2619800567626953, 2.453127145767212, 1.6138792037963867, 3.54323410987854, 2.2860631942749023, 0.04384809732437134, 3.149876117706299, 0.5077239274978638, 3.9269518852233887, 1.4493541717529297, 2.7935800552368164, 3.336738109588623, 2.0067386627197266, 1.7313522100448608, 1.9281244277954102, 2.0218355655670166, 3.349388360977173, 2.694549560546875, 1.0501021146774292, 2.3739991188049316, 2.864823579788208, 0.4820716381072998, 1.6886987686157227, 2.8534326553344727, 2.402357578277588, 2.554835796356201, 2.55332612991333, 0.8589358925819397, 0.1919856071472168, 3.7638049125671387, 3.368093490600586, 0.17156827449798584, 2.204087734222412], "mean_td_error": 2.1939477920532227, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118378639221191, "actor_loss": -5.977606296539307, "critic_loss": 0.22346125543117523, "alpha_loss": -0.1033194363117218, "alpha_value": 0.9898408651351929, "log_alpha_value": -0.010211066342890263, "target_entropy": -6.0, "policy_t": -0.022905386984348297, "mean_q": 2.2831265926361084, "max_q": 2.887207269668579, "min_q": 1.7090299129486084}, "td_error": [1.3498412370681763, 1.7084964513778687, 1.9553065299987793, 0.3520066738128662, 2.071995258331299, 1.7062573432922363, 1.3188495635986328, 0.6898362636566162, 1.2219129800796509, 1.5464801788330078, 1.3232101202011108, 0.5440071821212769, 0.24792098999023438, 0.5026606321334839, 0.5366355776786804, 1.547257661819458, 0.6398488283157349, 0.6291140913963318, 0.7780779600143433, 1.0525076389312744, 1.5888806581497192, 0.7514084577560425, 0.7387139797210693, 0.9477651119232178, 1.9463624954223633, 3.583643913269043, 1.8804371356964111, 0.49251681566238403, 1.8254940509796143, 0.9428670406341553, 1.3806530237197876, 0.29766666889190674, 0.2821396589279175, 2.1792640686035156, 0.6143065094947815, 0.9042865633964539, 0.8202580809593201, 0.5090680718421936, 0.24583685398101807, 1.514955759048462, 1.0165627002716064, 1.8585171699523926, 1.2189900875091553, 1.937286615371704, 2.151672124862671, 1.0314466953277588, 1.4117027521133423, 1.3631408214569092, 0.636228084564209, 0.6813971400260925, 1.8932150602340698, 1.6939078569412231, 0.7105033993721008, 1.4985957145690918, 1.861508846282959, 1.1103321313858032, 0.5160943269729614, 1.046868920326233, 2.4460368156433105, 2.0227441787719727, 0.21187710762023926, 1.0413196086883545, 0.5983403921127319, 1.8108720779418945, 0.7554560899734497, 0.15571177005767822, 0.22441017627716064, 1.6423996686935425, 0.8187038898468018, 1.1395196914672852, 0.6506608724594116, 0.35482943058013916, 2.3539531230926514, 2.497657299041748, 2.333174705505371, 2.6019155979156494, 1.4780890941619873, 1.9728177785873413, 3.1559343338012695, 0.21583527326583862, 0.7477743625640869, 1.0045160055160522, 2.302079439163208, 1.412376046180725, 0.9420101642608643, 1.4580450057983398], "mean_td_error": 1.245997428894043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05426025390625, "actor_loss": -6.0943708419799805, "critic_loss": 0.27109038829803467, "alpha_loss": -0.10258756577968597, "alpha_value": 0.9898484945297241, "log_alpha_value": -0.010203393176198006, "target_entropy": -6.0, "policy_t": 0.029484152793884277, "mean_q": 2.0782663822174072, "max_q": 2.4892396926879883, "min_q": 1.6891571283340454}, "td_error": [0.8274328708648682, 1.1820120811462402, 2.6119158267974854, 1.7795681953430176, 0.6875345706939697, 0.18923568725585938, 1.6508033275604248, 1.6937143802642822, 2.1907739639282227, 1.6997705698013306, 1.282559871673584, 0.7985581159591675, 0.544123649597168, 1.3583427667617798, 0.25363826751708984, 0.5936232805252075, 1.369459867477417, 0.07866412401199341, 0.9564077258110046, 1.7772091627120972, 1.8632466793060303, 0.38927626609802246, 0.03153955936431885, 1.0614023208618164, 0.12675225734710693, 0.3891705274581909, 0.43396663665771484, 2.5335865020751953, 1.129995346069336, 2.231750249862671, 0.8321723937988281, 0.8200039267539978, 1.3904542922973633, 1.0512232780456543, 0.5617842674255371, 0.14520883560180664, 1.3638359308242798, 2.7377638816833496, 2.173881769180298, 0.36608242988586426, 1.7063801288604736, 0.9163966178894043, 0.22936779260635376, 2.8024508953094482, 1.9002711772918701, 0.18845105171203613, 0.3796154260635376, 0.27727723121643066, 1.9841063022613525, 1.145197868347168, 1.5843393802642822, 0.6466883420944214, 0.28832435607910156, 2.04158878326416, 1.2337387800216675, 1.64861261844635, 1.0553183555603027, 0.46693503856658936, 0.8644797801971436, 0.035335540771484375, 1.1588103771209717, 1.3886903524398804, 0.5356538891792297, 0.22066259384155273, 1.7087186574935913, 1.099457859992981, 2.2578024864196777, 1.4041218757629395, 1.027093768119812, 1.0718077421188354, 0.20457255840301514, 1.9454234838485718, 0.4539201259613037, 1.5121958255767822, 0.7738771438598633, 1.3458764553070068, 0.4006878137588501, 0.3483160734176636, 1.1304469108581543, 0.88698410987854, 0.6136201024055481, 1.2821952104568481, 0.9965425729751587, 0.17199409008026123, 2.47542142868042, 2.2074379920959473], "mean_td_error": 1.1066936254501343, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 444.07350586922973, "num_env_steps_trained_throughput_per_sec": 127.86938003823802, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 2161.077, "sample_time_ms": 1581.023, "load_time_ms": 0.55, "load_throughput": 469063.906, "learn_time_ms": 63.679, "learn_throughput": 4051.542, "synch_weights_time_ms": 17.167}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-35", "timestamp": 1700203055, "time_this_iter_s": 2.033723831176758, "time_total_s": 75.34680151939392, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 75.34680151939392, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 71.26666666666667, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13838005065918, "actor_loss": -6.145358562469482, "critic_loss": 0.6484251022338867, "alpha_loss": -0.1064620092511177, "alpha_value": 0.9895540475845337, "log_alpha_value": -0.010500890202820301, "target_entropy": -6.0, "policy_t": 0.0013791442615911365, "mean_q": 2.2371068000793457, "max_q": 2.6878726482391357, "min_q": 1.8551510572433472}, "td_error": [1.5022586584091187, 2.4931693077087402, 0.3722105026245117, 1.4461548328399658, 1.507461428642273, 4.233138084411621, 3.248595714569092, 1.0526812076568604, 3.613741874694824, 2.6548912525177, 1.8082376718521118, 2.188004493713379, 1.1280125379562378, 1.9433393478393555, 1.3940250873565674, 1.5505253076553345, 1.3966306447982788, 3.4881396293640137, 0.14061987400054932, 4.020456314086914, 1.399523377418518, 0.9180972576141357, 1.902984857559204, 2.1966500282287598, 0.5140070915222168, 0.4493412971496582, 3.0344839096069336, 4.089158535003662, 1.359973430633545, 2.478661060333252, 2.8147506713867188, 0.9027912616729736, 1.6229373216629028, 2.350618362426758, 0.8805309534072876, 2.1394903659820557, 0.7531042098999023, 2.626401901245117, 1.4433619976043701, 0.35415375232696533, 0.37119388580322266, 1.3184654712677002, 3.5454254150390625, 3.3067474365234375, 2.550668716430664, 1.0777475833892822, 1.9253689050674438, 2.6693942546844482, 4.015361309051514, 1.341614007949829, 0.7432748079299927, 2.598240375518799, 2.7295093536376953, 3.903897523880005, 1.6192759275436401, 2.6007039546966553, 1.4984220266342163, 1.4651471376419067, 3.473933696746826, 3.2389912605285645, 0.928821325302124, 1.642874836921692, 1.4802318811416626, 1.6079192161560059, 1.911734938621521, 1.7945069074630737, 0.8433653116226196, 1.7368035316467285, 1.4108777046203613, 2.383910894393921, 1.0693867206573486, 3.0296125411987305, 0.7329419851303101, 1.700177550315857, 1.346290111541748, 1.4820003509521484, 3.9789633750915527, 1.704451084136963, 2.6578171253204346, 2.8643369674682617, 1.5881896018981934, 2.329620122909546, 0.9602500200271606, 1.7998968362808228, 0.4140366315841675, 1.8397518396377563], "mean_td_error": 1.9377379417419434, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048425674438477, "actor_loss": -6.026727676391602, "critic_loss": 0.17672425508499146, "alpha_loss": -0.10562535375356674, "alpha_value": 0.9895434379577637, "log_alpha_value": -0.01051163300871849, "target_entropy": -6.0, "policy_t": 0.017795000225305557, "mean_q": 2.3373310565948486, "max_q": 3.3524699211120605, "min_q": 1.6680699586868286}, "td_error": [1.8578754663467407, 1.9353855848312378, 0.15210628509521484, 0.3996952772140503, 0.669554591178894, 0.23112016916275024, 0.2872889041900635, 1.3015637397766113, 1.3796533346176147, 1.5067894458770752, 0.44792401790618896, 0.9463515281677246, 0.8569072484970093, 0.6133016347885132, 1.6734614372253418, 1.2968345880508423, 1.1205917596817017, 0.9806479215621948, 3.303819179534912, 0.49630963802337646, 0.5893214344978333, 0.8164652585983276, 1.0266063213348389, 0.37114059925079346, 0.6587104797363281, 0.8833479881286621, 0.1373087763786316, 0.7654758095741272, 0.2635226249694824, 1.4639723300933838, 1.485616683959961, 0.2643967866897583, 0.461428165435791, 2.1966214179992676, 0.33773088455200195, 0.8716732263565063, 2.309196949005127, 1.3614164590835571, 0.3835480213165283, 2.0840601921081543, 1.751434326171875, 2.5560851097106934, 0.8298563361167908, 1.3790295124053955, 0.7097548246383667, 0.3840968608856201, 2.0336990356445312, 0.4111652374267578, 1.2151210308074951, 1.1949529647827148, 1.2558847665786743, 1.148056983947754, 0.5134341716766357, 0.1970452070236206, 0.6567038297653198, 1.7340037822723389, 0.2629433870315552, 1.8956475257873535, 2.3291821479797363, 1.3400064706802368, 0.2606492042541504, 0.1992008090019226, 2.0492353439331055, 0.3295801877975464, 0.08823299407958984, 1.0363062620162964, 0.20781022310256958, 0.5605844259262085, 0.8398305177688599, 1.3867968320846558, 1.5057387351989746, 0.6768208742141724, 0.4164797067642212, 0.3539010286331177, 0.322634756565094, 0.6276545524597168, 1.5369904041290283, 0.8042529821395874, 1.0900743007659912, 1.9866106510162354, 2.737602710723877, 1.444882869720459, 0.21256399154663086, 2.6127634048461914, 1.2644740343093872, 0.257301390171051], "mean_td_error": 1.0325095653533936, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078187942504883, "actor_loss": -6.288389205932617, "critic_loss": 0.27239924669265747, "alpha_loss": -0.10585498064756393, "alpha_value": 0.9895516037940979, "log_alpha_value": -0.0105033740401268, "target_entropy": -6.0, "policy_t": -0.051896803081035614, "mean_q": 2.2142767906188965, "max_q": 2.73266863822937, "min_q": 1.7151705026626587}, "td_error": [1.0382193326950073, 1.036942958831787, 0.804675817489624, 1.1591010093688965, 0.698201060295105, 0.34490931034088135, 0.7164350748062134, 0.16329967975616455, 3.5734362602233887, 0.7891476154327393, 0.6665403246879578, 3.666815757751465, 1.3373794555664062, 0.4330461025238037, 2.358690023422241, 0.5180771350860596, 0.1479097604751587, 1.130563497543335, 0.8845407962799072, 1.5884969234466553, 0.7244768738746643, 0.13168776035308838, 0.12232756614685059, 2.502739906311035, 2.217888832092285, 1.5216871500015259, 0.08295023441314697, 0.5414173007011414, 2.0575509071350098, 0.6228972673416138, 0.4593433737754822, 0.5533401966094971, 1.033416509628296, 1.2236530780792236, 0.649329423904419, 0.4394080638885498, 0.2518802881240845, 0.6649363040924072, 1.5054007768630981, 2.548698902130127, 0.2815312147140503, 0.8242347240447998, 1.7461496591567993, 0.08283603191375732, 0.1849653720855713, 2.0678625106811523, 0.16215550899505615, 1.2066185474395752, 3.0288124084472656, 0.5341565608978271, 0.48332977294921875, 1.315421223640442, 2.489562511444092, 1.6044609546661377, 2.114532470703125, 1.1071616411209106, 1.195542573928833, 0.4577566385269165, 2.5640063285827637, 1.0016123056411743, 1.550771713256836, 0.10304272174835205, 0.18651151657104492, 2.9831342697143555, 0.07873940467834473, 3.2422561645507812, 0.8069287538528442, 1.315626859664917, 0.5321561098098755, 0.10062181949615479, 1.8940101861953735, 1.3761299848556519, 1.4262892007827759, 0.5640417337417603, 0.8653255701065063, 1.1446560621261597, 0.025434494018554688, 1.4631134271621704, 0.12375223636627197, 1.0968446731567383, 1.136646032333374, 1.2179867029190063, 0.32945823669433594, 0.3616631031036377, 1.0148727893829346, 0.5624219179153442], "mean_td_error": 1.0798442363739014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 463.3422100092173, "num_env_steps_trained_throughput_per_sec": 133.41773457854694, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 2138.142, "sample_time_ms": 1560.369, "load_time_ms": 0.547, "load_throughput": 471968.96, "learn_time_ms": 63.508, "learn_throughput": 4062.507, "synch_weights_time_ms": 17.112}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-37", "timestamp": 1700203057, "time_this_iter_s": 1.9504179954528809, "time_total_s": 77.2972195148468, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052644c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.2972195148468, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 68.96666666666667, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110535621643066, "actor_loss": -6.248019218444824, "critic_loss": 0.6783602237701416, "alpha_loss": -0.1092047169804573, "alpha_value": 0.9892570376396179, "log_alpha_value": -0.010801082476973534, "target_entropy": -6.0, "policy_t": 0.011360283009707928, "mean_q": 2.3171231746673584, "max_q": 3.011366128921509, "min_q": 1.9434351921081543}, "td_error": [3.632626533508301, 1.4844974279403687, 0.07599842548370361, 2.870326042175293, 2.8651986122131348, 1.7709728479385376, 2.1261982917785645, 1.125730276107788, 2.9168996810913086, 4.425616264343262, 3.314471960067749, 0.33444178104400635, 1.28782057762146, 1.7254524230957031, 0.45280885696411133, 1.3756910562515259, 2.4989607334136963, 2.515221118927002, 1.5879374742507935, 0.7486213445663452, 2.4188432693481445, 2.711214065551758, 0.44175195693969727, 2.6721267700195312, 1.1438089609146118, 3.3558638095855713, 1.9472997188568115, 2.248872756958008, 1.4034465551376343, 1.7322169542312622, 1.5523358583450317, 1.2225964069366455, 1.2471948862075806, 4.395730972290039, 1.6039665937423706, 1.079463243484497, 1.7405704259872437, 2.734419345855713, 3.7105612754821777, 1.5246690511703491, 1.7155678272247314, 0.7188543677330017, 4.637026786804199, 3.052093982696533, 0.9214447736740112, 2.205138683319092, 2.306213140487671, 2.3038673400878906, 3.0836007595062256, 1.1695231199264526, 1.4297075271606445, 1.1740248203277588, 1.1349226236343384, 2.576129913330078, 0.17577743530273438, 1.2796635627746582, 1.0068625211715698, 0.8037395477294922, 0.23977786302566528, 4.201066970825195, 0.27650976181030273, 2.8450255393981934, 0.2590838670730591, 3.6987876892089844, 2.551175594329834, 2.2055225372314453, 3.1513679027557373, 3.3098154067993164, 0.6077355146408081, 2.3977718353271484, 0.2557946443557739, 3.5174601078033447, 1.801635980606079, 3.241997480392456, 2.7974953651428223, 1.7196323871612549, 2.4138846397399902, 3.341548442840576, 2.4670591354370117, 3.7890758514404297, 1.325621247291565, 1.5539822578430176, 3.203411102294922, 2.182330846786499, 0.11280512809753418, 1.8461264371871948], "mean_td_error": 2.0119779109954834, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047687530517578, "actor_loss": -6.162689208984375, "critic_loss": 0.1864379346370697, "alpha_loss": -0.10863626003265381, "alpha_value": 0.9892461895942688, "log_alpha_value": -0.010812066495418549, "target_entropy": -6.0, "policy_t": -0.015033219009637833, "mean_q": 2.5183212757110596, "max_q": 3.214324474334717, "min_q": 1.8788044452667236}, "td_error": [2.275303363800049, 1.8201102018356323, 2.1183834075927734, 0.944177508354187, 0.3108348846435547, 3.489428997039795, 0.44681692123413086, 0.8594598770141602, 2.216295003890991, 0.6250065565109253, 0.2406744360923767, 0.9311109781265259, 1.4759070873260498, 1.5047955513000488, 0.9600715637207031, 0.07132720947265625, 1.1496398448944092, 0.650892972946167, 2.379340410232544, 0.17747068405151367, 1.1822137832641602, 0.356827974319458, 2.4383814334869385, 0.16523951292037964, 0.2820080518722534, 0.18356835842132568, 0.3345450162887573, 1.2924705743789673, 0.574547529220581, 0.21022558212280273, 1.4305129051208496, 0.2855870723724365, 1.399040937423706, 0.21806812286376953, 1.2633306980133057, 2.2926340103149414, 0.3181394934654236, 0.1950206756591797, 0.2110804319381714, 0.6740830540657043, 1.607410192489624, 0.5776188373565674, 0.8558900356292725, 1.062193512916565, 0.9257177114486694, 0.8739986419677734, 1.0719597339630127, 0.7845140695571899, 1.5970118045806885, 1.9085099697113037, 1.1198937892913818, 2.361825942993164, 0.6097275018692017, 0.2912912368774414, 1.727044939994812, 2.2640252113342285, 1.750373363494873, 0.2666527032852173, 0.746759295463562, 0.1465291976928711, 1.3742902278900146, 0.4165576696395874, 2.1680917739868164, 1.8357092142105103, 0.2717992067337036, 1.482248306274414, 0.8045538663864136, 0.4129762649536133, 3.656259059906006, 1.9923969507217407, 0.4204014539718628, 0.6258662939071655, 1.0276525020599365, 0.2851064205169678, 1.3502037525177002, 2.211582899093628, 1.3569557666778564, 0.11379009485244751, 1.1015065908432007, 0.2529366612434387, 1.9381043910980225, 0.23903071880340576, 0.3435765504837036, 1.246239185333252, 0.24731087684631348, 0.8673940896987915], "mean_td_error": 1.052861213684082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055635452270508, "actor_loss": -6.376266002655029, "critic_loss": 0.23497512936592102, "alpha_loss": -0.10863442718982697, "alpha_value": 0.9892548322677612, "log_alpha_value": -0.010803336277604103, "target_entropy": -6.0, "policy_t": -0.037410322576761246, "mean_q": 2.3565690517425537, "max_q": 3.0546844005584717, "min_q": 1.7781152725219727}, "td_error": [1.1913267374038696, 0.8553814888000488, 1.5222312211990356, 1.423182725906372, 0.5308390855789185, 0.09245049953460693, 1.0917993783950806, 0.7598671913146973, 0.964533805847168, 1.0510388612747192, 0.8125320672988892, 0.6379550695419312, 0.5979548692703247, 0.7756025791168213, 0.22977769374847412, 0.817341685295105, 0.05046969652175903, 1.7368104457855225, 1.52665376663208, 0.3010944128036499, 0.905199408531189, 1.5719199180603027, 0.9254858493804932, 0.06836450099945068, 0.33658552169799805, 0.4186701774597168, 0.1752840280532837, 1.8985962867736816, 0.5279041528701782, 1.7589505910873413, 1.97104811668396, 0.9729015827178955, 0.9157384634017944, 0.4814479351043701, 1.2688106298446655, 0.29100358486175537, 0.02452671527862549, 1.2632139921188354, 0.9897531270980835, 0.3744959831237793, 0.3289443254470825, 0.17553818225860596, 0.2555539608001709, 1.4798262119293213, 0.6470794677734375, 0.8447273969650269, 2.5488688945770264, 2.236846923828125, 0.6517590284347534, 2.9579405784606934, 1.4660484790802002, 0.1824878454208374, 2.5420024394989014, 1.4404082298278809, 1.042230248451233, 3.223936080932617, 0.5711730718612671, 0.19821715354919434, 0.6392520666122437, 0.5771106481552124, 0.9239532947540283, 1.8571438789367676, 0.7681440114974976, 0.05574989318847656, 0.6210805177688599, 1.0113521814346313, 0.6929905414581299, 0.23752009868621826, 0.20201551914215088, 0.8374357223510742, 0.8980258703231812, 0.8878078460693359, 0.9607760906219482, 0.22887825965881348, 1.3522769212722778, 1.6322160959243774, 2.610170841217041, 0.733124852180481, 2.2879319190979004, 0.3314265012741089, 2.7593507766723633, 1.9540880918502808, 0.4246327877044678, 1.0516502857208252, 1.1244477033615112, 0.2018502950668335], "mean_td_error": 0.9856365323066711, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 401.1075304566542, "num_env_steps_trained_throughput_per_sec": 115.4974808680991, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 2153.538, "sample_time_ms": 1545.015, "load_time_ms": 0.547, "load_throughput": 471804.339, "learn_time_ms": 63.469, "learn_throughput": 4064.952, "synch_weights_time_ms": 17.03}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-39", "timestamp": 1700203059, "time_this_iter_s": 2.2484359741210938, "time_total_s": 79.5456554889679, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052649d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.5456554889679, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 72.60000000000001, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073129653930664, "actor_loss": -6.3655686378479, "critic_loss": 0.5401636362075806, "alpha_loss": -0.1118248775601387, "alpha_value": 0.9889600872993469, "log_alpha_value": -0.011101304553449154, "target_entropy": -6.0, "policy_t": 0.02876095287501812, "mean_q": 2.5121939182281494, "max_q": 3.0851211547851562, "min_q": 2.096320867538452}, "td_error": [2.8598852157592773, 2.708303928375244, 0.008521676063537598, 1.0824841260910034, 0.7924764156341553, 1.334837794303894, 1.4451950788497925, 0.7099281549453735, 0.773770809173584, 0.48127293586730957, 0.35953474044799805, 2.29268741607666, 1.6934837102890015, 1.5176877975463867, 0.43230926990509033, 1.5243661403656006, 0.36317288875579834, 1.9542475938796997, 1.8444339036941528, 0.817868709564209, 2.5314884185791016, 1.1659361124038696, 3.563201904296875, 1.6500810384750366, 1.885614037513733, 1.5120326280593872, 2.8080272674560547, 0.45477819442749023, 2.7076797485351562, 4.119237422943115, 1.9825761318206787, 1.2023664712905884, 0.3136333227157593, 3.3327760696411133, 1.8349336385726929, 2.026254177093506, 0.9405876398086548, 2.430063486099243, 0.16205453872680664, 0.9461191892623901, 2.352208137512207, 2.769343376159668, 1.5004075765609741, 2.2822649478912354, 2.5985569953918457, 1.8700459003448486, 2.4639158248901367, 1.5671800374984741, 3.009428024291992, 2.2491114139556885, 3.1062934398651123, 2.3380179405212402, 1.4076281785964966, 4.448871612548828, 1.5357153415679932, 1.3752124309539795, 0.4080694913864136, 0.42968857288360596, 0.7941319942474365, 1.1779723167419434, 3.6230101585388184, 1.7564635276794434, 0.8217755556106567, 1.7538198232650757, 0.42375385761260986, 0.8050137758255005, 1.6151635646820068, 3.0341176986694336, 2.7530517578125, 0.3316303491592407, 0.7012114524841309, 1.8364155292510986, 1.4766745567321777, 0.3493245840072632, 0.9988394975662231, 2.5781455039978027, 1.1818311214447021, 3.902580738067627, 2.193589448928833, 3.450558662414551, 0.42157578468322754, 0.38743793964385986, 4.303895950317383, 0.3016519546508789, 0.7248797416687012, 1.1367660760879517], "mean_td_error": 1.6873623132705688, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07551383972168, "actor_loss": -6.375981330871582, "critic_loss": 0.1900167614221573, "alpha_loss": -0.1119629368185997, "alpha_value": 0.9889491200447083, "log_alpha_value": -0.011112380772829056, "target_entropy": -6.0, "policy_t": 0.017807792872190475, "mean_q": 2.7554893493652344, "max_q": 3.7734594345092773, "min_q": 2.0597219467163086}, "td_error": [1.2937278747558594, 1.3608046770095825, 0.9384665489196777, 1.1154062747955322, 0.9096101522445679, 0.9865484237670898, 1.3765428066253662, 1.2692646980285645, 0.23370778560638428, 1.1910260915756226, 0.35730671882629395, 1.036719560623169, 1.1244899034500122, 1.146507740020752, 0.9253678321838379, 0.5500674247741699, 0.29807937145233154, 1.7909289598464966, 0.2883666753768921, 0.7808094024658203, 1.3586026430130005, 0.8163653612136841, 2.7511072158813477, 0.8517473936080933, 1.2837071418762207, 1.2645080089569092, 2.977135181427002, 0.055609822273254395, 0.419399619102478, 0.5495933294296265, 0.1081920862197876, 1.0770409107208252, 1.6465257406234741, 1.1034281253814697, 1.981906533241272, 2.0066328048706055, 1.4521253108978271, 2.405055046081543, 1.3136872053146362, 0.2284843921661377, 0.2516787052154541, 1.2427442073822021, 0.4601482152938843, 0.740541934967041, 2.2709364891052246, 0.4838080406188965, 0.4501420259475708, 0.26740992069244385, 0.7939596176147461, 1.0294386148452759, 0.17602312564849854, 2.331326961517334, 1.2105571031570435, 1.0847117900848389, 0.12941908836364746, 1.5807430744171143, 0.27640843391418457, 4.082037925720215, 0.925335168838501, 2.2668356895446777, 0.6563475131988525, 0.9536248445510864, 0.797848105430603, 0.9006304740905762, 1.0822081565856934, 1.2124390602111816, 1.622424840927124, 1.1868840456008911, 0.9686017036437988, 2.3602676391601562, 0.4181114435195923, 0.16528940200805664, 1.0555436611175537, 0.29974663257598877, 0.3554384708404541, 0.6230533123016357, 0.8904515504837036, 0.6332306861877441, 1.0832082033157349, 2.899637222290039, 0.35018718242645264, 1.568361520767212, 2.3640732765197754, 0.4890568256378174, 0.28573524951934814, 0.5501613616943359], "mean_td_error": 1.075015902519226, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084218978881836, "actor_loss": -6.584318161010742, "critic_loss": 0.2874431312084198, "alpha_loss": -0.11196742206811905, "alpha_value": 0.9889581799507141, "log_alpha_value": -0.011103232391178608, "target_entropy": -6.0, "policy_t": 0.04204202815890312, "mean_q": 2.5397543907165527, "max_q": 3.063324213027954, "min_q": 1.910117506980896}, "td_error": [0.17282438278198242, 0.5112495422363281, 0.44819867610931396, 3.177635669708252, 0.3707914352416992, 2.0961222648620605, 1.8011668920516968, 0.5107413530349731, 2.5537853240966797, 1.705564260482788, 1.5053374767303467, 1.600036859512329, 0.6054326295852661, 0.6177971363067627, 1.9544543027877808, 2.237494468688965, 1.1129480600357056, 0.7071183919906616, 0.19059395790100098, 1.4193466901779175, 1.1172547340393066, 2.231858253479004, 0.12058508396148682, 0.10968351364135742, 1.2452707290649414, 0.4126012325286865, 0.7886581420898438, 1.0052546262741089, 0.9164016246795654, 0.10190141201019287, 0.6551415920257568, 2.058244228363037, 1.4308830499649048, 1.0837762355804443, 1.2438737154006958, 0.6122455596923828, 3.664325475692749, 0.43915045261383057, 1.228901982307434, 1.0330841541290283, 1.0693949460983276, 0.6669520139694214, 2.357344388961792, 1.0346381664276123, 2.8536996841430664, 0.5359581708908081, 2.99526047706604, 0.7214063405990601, 0.5987647771835327, 0.06686842441558838, 1.4747892618179321, 0.9858654737472534, 1.6663105487823486, 0.9313012361526489, 0.7482287883758545, 0.29438626766204834, 1.261738657951355, 1.7061684131622314, 2.58970046043396, 0.09874248504638672, 0.2673259973526001, 0.45962584018707275, 0.43953919410705566, 1.7757060527801514, 0.5933808088302612, 1.3833227157592773, 0.4311939477920532, 1.452836513519287, 2.6956443786621094, 0.1995534896850586, 0.451016902923584, 0.7688510417938232, 1.1947119235992432, 0.4245413541793823, 1.0852508544921875, 2.2619080543518066, 2.1199941635131836, 0.03106689453125, 0.4115868806838989, 0.5202614068984985, 1.2870994806289673, 1.7795665264129639, 0.20851659774780273, 1.269650936126709, 1.1192989349365234, 0.02805638313293457], "mean_td_error": 1.1176135540008545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 471.317218075693, "num_env_steps_trained_throughput_per_sec": 135.71410966911697, "timesteps_total": 34944, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 104832, "timers": {"training_iteration_time_ms": 2156.617, "sample_time_ms": 1549.303, "load_time_ms": 0.545, "load_throughput": 473621.513, "learn_time_ms": 63.434, "learn_throughput": 4067.227, "synch_weights_time_ms": 16.769}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 104832, "num_agent_steps_trained": 9804, "last_target_update_ts": 34944, "num_target_updates": 38}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-41", "timestamp": 1700203061, "time_this_iter_s": 1.9167072772979736, "time_total_s": 81.46236276626587, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.46236276626587, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 69.49999999999999, "ram_util_percent": 92.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08950138092041, "actor_loss": -6.5869269371032715, "critic_loss": 0.38724687695503235, "alpha_loss": -0.11503513157367706, "alpha_value": 0.9886632561683655, "log_alpha_value": -0.011401469819247723, "target_entropy": -6.0, "policy_t": 0.01844640076160431, "mean_q": 2.6841604709625244, "max_q": 3.358882427215576, "min_q": 2.2353246212005615}, "td_error": [1.3715132474899292, 1.6587061882019043, 3.1624908447265625, 1.3044688701629639, 2.9021031856536865, 1.4250949621200562, 4.213979721069336, 0.5458880662918091, 1.372844934463501, 2.473344326019287, 1.490967035293579, 0.32245635986328125, 1.2472243309020996, 0.8455170392990112, 2.4537267684936523, 1.5190922021865845, 2.278110980987549, 3.868612766265869, 1.4794089794158936, 0.6173986196517944, 0.4905351400375366, 1.4264733791351318, 2.0512871742248535, 1.226866602897644, 1.5823619365692139, 0.7225948572158813, 2.395096778869629, 0.6063429117202759, 2.9317474365234375, 2.844743251800537, 0.7890714406967163, 0.7218085527420044, 2.7178869247436523, 1.2138216495513916, 2.0987653732299805, 0.3051924705505371, 2.503108501434326, 0.8074679374694824, 2.5182948112487793, 1.5552997589111328, 2.3399391174316406, 2.223478317260742, 0.8617221117019653, 0.9261616468429565, 0.43357646465301514, 0.9284601211547852, 3.3162012100219727, 2.2535347938537598, 1.8945013284683228, 3.3063347339630127, 1.2835724353790283, 0.8313865661621094, 3.1719343662261963, 1.1080676317214966, 3.08734130859375, 1.8506977558135986, 0.7837402820587158, 0.7049171924591064, 2.687509536743164, 1.1844663619995117, 2.589878559112549, 2.8612704277038574, 2.612691879272461, 2.8704419136047363, 2.7438721656799316, 0.6433857679367065, 2.3488893508911133, 1.2583848237991333, 0.8870006799697876, 2.609285831451416, 0.19224882125854492, 0.25642716884613037, 0.9340579509735107, 1.3926209211349487, 0.4156019687652588, 3.011338710784912, 3.3293304443359375, 2.019273042678833, 1.2279925346374512, 0.7524958848953247, 3.647843360900879, 0.9385131597518921, 0.8291521072387695, 0.775365948677063, 2.644223690032959, 1.0935633182525635], "mean_td_error": 1.722376823425293, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07634162902832, "actor_loss": -6.5021796226501465, "critic_loss": 0.1710841953754425, "alpha_loss": -0.11499779671430588, "alpha_value": 0.988652229309082, "log_alpha_value": -0.01141265220940113, "target_entropy": -6.0, "policy_t": 0.007959526963531971, "mean_q": 2.877040147781372, "max_q": 3.78767991065979, "min_q": 2.0171711444854736}, "td_error": [0.1540006399154663, 0.42633044719696045, 0.40148091316223145, 0.36482036113739014, 1.1960328817367554, 0.01635921001434326, 0.9630588293075562, 0.3311336040496826, 0.7775239944458008, 1.1249359846115112, 0.9289729595184326, 0.4632762670516968, 2.093928337097168, 0.29814088344573975, 2.4870667457580566, 1.6305779218673706, 1.0441230535507202, 0.370599627494812, 1.4206093549728394, 0.08493626117706299, 1.7298933267593384, 0.12167096138000488, 0.4895913600921631, 1.8587737083435059, 2.3282480239868164, 1.1537843942642212, 0.2426522970199585, 0.9329490661621094, 0.31869637966156006, 1.4555747509002686, 1.2749649286270142, 0.634101152420044, 1.0672239065170288, 0.07935607433319092, 0.22036659717559814, 2.7298812866210938, 0.07556617259979248, 1.0028632879257202, 2.912663698196411, 1.4955545663833618, 0.5870976448059082, 0.7538517713546753, 0.4814251661300659, 0.17545807361602783, 1.0951881408691406, 0.1030203104019165, 0.6759152412414551, 2.259500503540039, 0.6898857355117798, 2.0528969764709473, 0.365946888923645, 0.5706051588058472, 1.2906854152679443, 1.2664616107940674, 0.25423896312713623, 1.242956519126892, 0.5773283243179321, 2.3884615898132324, 1.2006741762161255, 0.18747591972351074, 1.0232770442962646, 0.6408505439758301, 0.5708656311035156, 0.853392481803894, 2.000424861907959, 3.2358059883117676, 0.28835558891296387, 1.7001361846923828, 1.0984115600585938, 0.9858765602111816, 1.7954518795013428, 0.294874906539917, 1.8481088876724243, 1.3886315822601318, 0.7471543550491333, 0.5694347620010376, 2.7784104347229004, 0.8984338045120239, 0.5479799509048462, 1.2107534408569336, 0.9648569822311401, 0.20470929145812988, 1.6216751337051392, 0.2478266954421997, 0.501567006111145, 0.4859333038330078], "mean_td_error": 0.9933088421821594, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09290885925293, "actor_loss": -6.649025917053223, "critic_loss": 0.2731260061264038, "alpha_loss": -0.11509079486131668, "alpha_value": 0.9886616468429565, "log_alpha_value": -0.01140313409268856, "target_entropy": -6.0, "policy_t": 0.004246537573635578, "mean_q": 2.59525465965271, "max_q": 3.2745349407196045, "min_q": 2.0116965770721436}, "td_error": [2.315857172012329, 1.4355146884918213, 0.6661659479141235, 3.290478229522705, 0.20768916606903076, 0.22056961059570312, 0.34855473041534424, 1.932914137840271, 0.15387260913848877, 0.5772478580474854, 0.38661205768585205, 1.2453954219818115, 1.5088237524032593, 1.5560522079467773, 2.257253885269165, 1.10652494430542, 0.42261803150177, 2.2604918479919434, 0.5314462184906006, 0.9869081974029541, 1.9658297300338745, 0.2918299436569214, 0.6476233005523682, 0.22809302806854248, 2.1868951320648193, 0.41672658920288086, 1.0900635719299316, 1.1914901733398438, 1.3405694961547852, 2.4148619174957275, 0.5224902629852295, 1.7821755409240723, 0.5527850389480591, 0.7951916456222534, 1.1200288534164429, 1.2633401155471802, 1.6901044845581055, 0.2541682720184326, 2.5865135192871094, 2.4148061275482178, 0.19951248168945312, 0.4911308288574219, 0.19000184535980225, 0.15271472930908203, 0.21197926998138428, 1.6449503898620605, 0.5708699226379395, 1.3575668334960938, 0.8199455738067627, 1.20743989944458, 1.0831799507141113, 1.994823932647705, 0.4819960594177246, 2.139331579208374, 0.20591473579406738, 0.27212607860565186, 0.237585186958313, 0.1432201862335205, 1.189975619316101, 1.0565509796142578, 1.1904195547103882, 1.76711905002594, 0.3512779474258423, 0.3415259122848511, 0.9185621738433838, 0.0981067419052124, 2.7691128253936768, 1.3770735263824463, 1.490140676498413, 2.3463597297668457, 0.7731621265411377, 0.25591492652893066, 0.7932422161102295, 1.491684913635254, 2.248891830444336, 0.15188360214233398, 0.5152202844619751, 1.018014669418335, 0.4758331775665283, 1.3395763635635376, 0.8481451272964478, 0.7905614376068115, 2.010164976119995, 3.1856613159179688, 0.37920963764190674, 0.7833570241928101], "mean_td_error": 1.087530493736267, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 444.4312447729225, "num_env_steps_trained_throughput_per_sec": 127.97238967791742, "timesteps_total": 35840, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 2147.898, "sample_time_ms": 1539.839, "load_time_ms": 0.543, "load_throughput": 474743.543, "learn_time_ms": 63.478, "learn_throughput": 4064.387, "synch_weights_time_ms": 16.771}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-43", "timestamp": 1700203063, "time_this_iter_s": 2.030900001525879, "time_total_s": 83.49326276779175, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07593a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.49326276779175, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 70.86666666666667, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11003589630127, "actor_loss": -6.755727291107178, "critic_loss": 0.3513655364513397, "alpha_loss": -0.1183038055896759, "alpha_value": 0.9883666038513184, "log_alpha_value": -0.011701621115207672, "target_entropy": -6.0, "policy_t": 0.012118708342313766, "mean_q": 2.873689889907837, "max_q": 3.574138879776001, "min_q": 2.2557101249694824}, "td_error": [2.3270978927612305, 1.2681655883789062, 1.0183372497558594, 0.715492844581604, 0.18277525901794434, 3.326906204223633, 0.8410872220993042, 1.4788215160369873, 0.7823477983474731, 0.3107476234436035, 1.776049256324768, 1.6015782356262207, 1.1886032819747925, 1.6039493083953857, 0.8158069849014282, 0.8566973209381104, 1.0686575174331665, 2.828974485397339, 1.341158390045166, 0.18497610092163086, 1.8700789213180542, 0.2506682872772217, 0.4892681837081909, 0.21511435508728027, 1.110150933265686, 2.1389355659484863, 0.3549027442932129, 2.320840835571289, 1.8193376064300537, 3.428008794784546, 1.768973708152771, 3.0683207511901855, 0.9676274061203003, 3.8392467498779297, 3.7217702865600586, 0.9083658456802368, 1.6845589876174927, 2.0144543647766113, 1.8787111043930054, 0.8909376859664917, 2.736943244934082, 1.7687631845474243, 2.9393744468688965, 2.1329574584960938, 3.397392749786377, 1.9175211191177368, 1.4741991758346558, 1.1413872241973877, 2.5026397705078125, 2.4189281463623047, 0.6762751340866089, 0.421725869178772, 0.22293579578399658, 0.45492851734161377, 1.526642918586731, 1.1265336275100708, 1.4286104440689087, 0.9115211963653564, 1.354459524154663, 1.7695919275283813, 1.5417855978012085, 1.0449090003967285, 2.356898546218872, 2.875, 0.35267627239227295, 0.14618360996246338, 0.712810754776001, 0.5445566177368164, 1.5077279806137085, 2.9181594848632812, 1.8929771184921265, 1.465895652770996, 2.8730549812316895, 1.4715913534164429, 2.429682731628418, 1.1433614492416382, 3.0785422325134277, 0.8204492330551147, 0.6420198678970337, 2.8538787364959717, 3.348879337310791, 3.8456382751464844, 0.262410044670105, 3.5153708457946777, 0.9698628187179565, 2.1983046531677246], "mean_td_error": 1.6208657026290894, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12183952331543, "actor_loss": -6.703979015350342, "critic_loss": 0.18961921334266663, "alpha_loss": -0.11855597048997879, "alpha_value": 0.9883554577827454, "log_alpha_value": -0.011712886393070221, "target_entropy": -6.0, "policy_t": -0.05570640787482262, "mean_q": 3.101947546005249, "max_q": 4.0292205810546875, "min_q": 2.1930041313171387}, "td_error": [1.4672534465789795, 1.1037001609802246, 0.25823140144348145, 0.5794374942779541, 0.5814166069030762, 0.7416499853134155, 0.7078450918197632, 0.2540842294692993, 0.20964670181274414, 0.4703669548034668, 0.2546052932739258, 0.6952186822891235, 0.12975060939788818, 0.3416482210159302, 2.8815507888793945, 1.6153333187103271, 0.6735047101974487, 0.7899833917617798, 0.529245138168335, 0.7571074962615967, 1.8478047847747803, 0.8215165138244629, 1.6537922620773315, 4.806084156036377, 0.89357590675354, 1.9696615934371948, 2.321244239807129, 0.9694981575012207, 0.2837599515914917, 0.32645702362060547, 0.2113267183303833, 2.107529640197754, 0.9876030683517456, 1.5812249183654785, 0.7149715423583984, 0.36138200759887695, 2.916196346282959, 0.6671597957611084, 0.5476055145263672, 0.7975044250488281, 1.0330049991607666, 0.29798901081085205, 1.4462729692459106, 1.0228745937347412, 0.7765440940856934, 0.34045231342315674, 0.3490053415298462, 1.3835252523422241, 0.6221318244934082, 0.4155048131942749, 1.6355427503585815, 0.93095862865448, 0.6442612409591675, 1.8854830265045166, 1.2336972951889038, 0.47522544860839844, 1.1804347038269043, 2.834442615509033, 1.1908437013626099, 0.8088901042938232, 2.127265691757202, 1.2692677974700928, 0.6804330348968506, 1.1754542589187622, 0.486614465713501, 1.8287832736968994, 1.8964967727661133, 0.8004519939422607, 0.28576338291168213, 4.117659568786621, 2.32950496673584, 1.1824610233306885, 0.8628555536270142, 0.19896209239959717, 1.9039264917373657, 0.47080349922180176, 0.3571106195449829, 1.4842711687088013, 0.31931018829345703, 0.29321444034576416, 0.22284722328186035, 2.1578969955444336, 0.4076077938079834, 0.17823827266693115, 2.2227706909179688, 1.4294593334197998], "mean_td_error": 1.081674337387085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034247398376465, "actor_loss": -6.741731643676758, "critic_loss": 0.26949137449264526, "alpha_loss": -0.11743141710758209, "alpha_value": 0.9883651733398438, "log_alpha_value": -0.011703060939908028, "target_entropy": -6.0, "policy_t": -0.04436657205224037, "mean_q": 2.756927728652954, "max_q": 3.5668303966522217, "min_q": 2.2241504192352295}, "td_error": [3.601306915283203, 0.10433077812194824, 0.7671101093292236, 0.8833982944488525, 0.9482975006103516, 1.1848151683807373, 0.18333160877227783, 0.6534585952758789, 0.38086891174316406, 0.09851634502410889, 0.8163005113601685, 0.6157900094985962, 0.09902763366699219, 2.6343488693237305, 1.179766058921814, 2.050534248352051, 2.259002208709717, 0.49366462230682373, 0.3079625368118286, 0.27857840061187744, 0.9524796009063721, 1.7719489336013794, 0.8434393405914307, 0.5190435647964478, 1.53022038936615, 0.19681024551391602, 0.6104521751403809, 2.878826856613159, 1.338287591934204, 0.33902132511138916, 3.8283510208129883, 1.0741740465164185, 1.1554150581359863, 0.7687661647796631, 0.11644911766052246, 1.5043230056762695, 1.3331018686294556, 0.17133140563964844, 3.5525026321411133, 1.2124313116073608, 0.11866569519042969, 2.380080223083496, 0.6583365201950073, 0.7331861257553101, 0.6177538633346558, 0.04212033748626709, 0.8585312366485596, 0.19801950454711914, 0.33353304862976074, 3.520434617996216, 0.9905053377151489, 0.7486963272094727, 1.0937681198120117, 1.6286953687667847, 2.775376319885254, 0.5759491920471191, 0.8235939741134644, 1.5818486213684082, 1.1014211177825928, 1.889087438583374, 0.3602566719055176, 1.990818977355957, 2.932332754135132, 0.1178656816482544, 1.0672446489334106, 0.028470277786254883, 1.7789499759674072, 0.4168355464935303, 1.1690424680709839, 0.47808837890625, 0.9489099979400635, 0.6431807279586792, 0.5313054323196411, 1.332060694694519, 1.0106037855148315, 0.40078580379486084, 1.44918692111969, 0.24653494358062744, 1.7236624956130981, 0.5927329063415527, 0.5845065116882324, 1.3697855472564697, 1.1916091442108154, 0.2645761966705322, 0.2444387674331665, 0.2828099727630615], "mean_td_error": 1.058883547782898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.0936417866717, "num_env_steps_trained_throughput_per_sec": 138.81714238946574, "timesteps_total": 36736, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 110208, "timers": {"training_iteration_time_ms": 2127.587, "sample_time_ms": 1520.049, "load_time_ms": 0.536, "load_throughput": 481289.109, "learn_time_ms": 63.279, "learn_throughput": 4077.189, "synch_weights_time_ms": 16.567}, "counters": {"num_env_steps_sampled": 36736, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 110208, "num_agent_steps_trained": 10320, "last_target_update_ts": 36736, "num_target_updates": 40}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-45", "timestamp": 1700203065, "time_this_iter_s": 1.875669002532959, "time_total_s": 85.3689317703247, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.3689317703247, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 89.3, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115234375, "actor_loss": -6.892049312591553, "critic_loss": 0.3608298897743225, "alpha_loss": -0.12140108644962311, "alpha_value": 0.9880699515342712, "log_alpha_value": -0.012001805938780308, "target_entropy": -6.0, "policy_t": 0.030285868793725967, "mean_q": 2.9948339462280273, "max_q": 3.681549310684204, "min_q": 2.409356117248535}, "td_error": [4.463099479675293, 1.9418525695800781, 1.621683955192566, 0.9832440614700317, 2.145811080932617, 1.0254548788070679, 3.2264952659606934, 0.6469972133636475, 2.4031691551208496, 1.2271220684051514, 1.2627333402633667, 1.3635811805725098, 1.8002933263778687, 1.7811585664749146, 1.3388572931289673, 2.330282211303711, 0.27285778522491455, 3.2478795051574707, 0.9938100576400757, 2.2189993858337402, 0.5348068475723267, 0.43600499629974365, 3.0473644733428955, 2.079275608062744, 3.230156898498535, 1.498489499092102, 2.3915960788726807, 1.3541862964630127, 2.3725695610046387, 0.9157238006591797, 2.1660428047180176, 2.1846468448638916, 2.3066368103027344, 0.748908519744873, 0.2973283529281616, 2.153560161590576, 1.9552898406982422, 2.4981093406677246, 1.9023584127426147, 0.3855074644088745, 1.4057250022888184, 2.6147518157958984, 0.19333386421203613, 1.7239230871200562, 0.46890294551849365, 1.6495985984802246, 2.3022351264953613, 2.2472646236419678, 1.228522777557373, 2.7204830646514893, 1.3791728019714355, 0.992950439453125, 1.2114605903625488, 1.7940325736999512, 0.545773983001709, 2.4271559715270996, 2.0599658489227295, 2.673109531402588, 0.7199437618255615, 2.5939395427703857, 2.6180481910705566, 2.839555263519287, 3.318286418914795, 0.49800944328308105, 1.9262633323669434, 1.134572148323059, 0.13766860961914062, 2.9987974166870117, 1.8386588096618652, 1.2917637825012207, 2.4277138710021973, 0.5816082954406738, 2.0005524158477783, 2.1773173809051514, 3.286926746368408, 0.7440723180770874, 0.8868361711502075, 0.6967463493347168, 0.6483683586120605, 0.17946326732635498, 2.3560352325439453, 0.5058227777481079, 2.981924057006836, 0.18963992595672607, 0.42175745964050293, 1.192746639251709], "mean_td_error": 1.6695970296859741, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135875701904297, "actor_loss": -6.839845180511475, "critic_loss": 0.17580868303775787, "alpha_loss": -0.12176421284675598, "alpha_value": 0.9880586862564087, "log_alpha_value": -0.012013190425932407, "target_entropy": -6.0, "policy_t": -0.03907792642712593, "mean_q": 3.1246793270111084, "max_q": 4.051350116729736, "min_q": 2.142390012741089}, "td_error": [0.5757429599761963, 0.3328632116317749, 1.4217811822891235, 0.11384999752044678, 1.1576433181762695, 0.22552788257598877, 1.6164509057998657, 2.0709331035614014, 0.8016362190246582, 0.41194796562194824, 0.29796087741851807, 1.0862513780593872, 1.0826966762542725, 1.415757179260254, 0.09115219116210938, 2.7372453212738037, 0.4313603639602661, 0.3147156238555908, 0.3650789260864258, 0.35013318061828613, 0.7488857507705688, 0.13811421394348145, 0.47658681869506836, 1.1389403343200684, 2.9722113609313965, 0.7879278659820557, 1.086471438407898, 1.8636106252670288, 2.169717311859131, 0.13557720184326172, 0.23163557052612305, 1.8564635515213013, 1.2033867835998535, 3.798778772354126, 1.488718032836914, 0.9596778154373169, 0.21035277843475342, 0.6338890790939331, 0.31213057041168213, 0.9760603904724121, 0.6141011714935303, 0.2621091604232788, 1.4086201190948486, 0.3392421007156372, 0.6728024482727051, 2.226257562637329, 0.933286190032959, 0.38539648056030273, 3.136183261871338, 0.5243120193481445, 1.2935813665390015, 1.0031739473342896, 0.5044121742248535, 1.1716302633285522, 0.21814501285552979, 0.25246334075927734, 0.24804282188415527, 0.7033358812332153, 0.9229713678359985, 1.5099869966506958, 1.2953308820724487, 1.1448030471801758, 1.0226632356643677, 0.8833340406417847, 0.09851515293121338, 0.7088332176208496, 0.6146277189254761, 0.9855351448059082, 2.1051249504089355, 0.6533002853393555, 0.8197667598724365, 0.25488853454589844, 1.6620713472366333, 4.127492904663086, 0.12833499908447266, 2.4342923164367676, 2.224940299987793, 0.32010769844055176, 0.7745020389556885, 0.8164173364639282, 0.6355563402175903, 1.6537195444107056, 0.40029585361480713, 0.16152751445770264, 1.2481530904769897, 0.5081404447555542], "mean_td_error": 1.0011882781982422, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037376403808594, "actor_loss": -6.856086254119873, "critic_loss": 0.25906357169151306, "alpha_loss": -0.12047737836837769, "alpha_value": 0.9880688786506653, "log_alpha_value": -0.012002876959741116, "target_entropy": -6.0, "policy_t": 0.020611384883522987, "mean_q": 2.889711856842041, "max_q": 3.570364236831665, "min_q": 2.193662405014038}, "td_error": [1.4020249843597412, 3.537952184677124, 0.8815279006958008, 1.1310102939605713, 1.3621934652328491, 0.5556395053863525, 1.3591046333312988, 2.0035014152526855, 0.10500216484069824, 0.7412537336349487, 0.482257604598999, 0.8123552799224854, 0.4732736349105835, 1.7804503440856934, 0.7675951719284058, 0.21278345584869385, 1.9124394655227661, 0.43097078800201416, 0.9881229400634766, 1.1001871824264526, 0.03989100456237793, 0.0780794620513916, 0.12844061851501465, 0.704501748085022, 3.445098400115967, 0.27485382556915283, 0.9305950403213501, 1.4639614820480347, 1.328690767288208, 0.9293397665023804, 1.3732261657714844, 1.3933368921279907, 0.4597897529602051, 0.32306528091430664, 2.671698570251465, 0.13913726806640625, 2.350661277770996, 0.44462430477142334, 3.4087986946105957, 0.2947676181793213, 0.291595458984375, 0.5757949352264404, 2.152155876159668, 0.4432462453842163, 0.37191104888916016, 1.1761001348495483, 0.6799006462097168, 0.09896969795227051, 2.6827392578125, 1.6642297506332397, 1.4677433967590332, 0.39435601234436035, 0.09528303146362305, 1.2224544286727905, 0.9046047925949097, 0.29577887058258057, 0.0466611385345459, 0.17075133323669434, 0.3961828947067261, 0.1776365041732788, 0.312924861907959, 0.8288710117340088, 1.0541735887527466, 0.20511722564697266, 0.6552228927612305, 1.3690451383590698, 1.2168455123901367, 1.6259711980819702, 0.9263595342636108, 0.650525689125061, 1.2205153703689575, 1.0666959285736084, 0.48328697681427, 1.130507230758667, 0.30883753299713135, 1.8553880453109741, 1.634981632232666, 1.3575782775878906, 1.9230929613113403, 3.326704502105713, 1.4773145914077759, 0.9430136680603027, 1.1536178588867188, 0.699941873550415, 1.3635174036026, 0.8540501594543457], "mean_td_error": 1.0369116067886353, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 483.4645824963294, "num_env_steps_trained_throughput_per_sec": 139.21189987059486, "timesteps_total": 37632, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 2116.114, "sample_time_ms": 1509.365, "load_time_ms": 0.538, "load_throughput": 479944.308, "learn_time_ms": 63.317, "learn_throughput": 4074.737, "synch_weights_time_ms": 16.284}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-47", "timestamp": 1700203067, "time_this_iter_s": 1.869387149810791, "time_total_s": 87.2383189201355, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 87.2383189201355, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 66.0, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076644897460938, "actor_loss": -7.060021877288818, "critic_loss": 0.3439563512802124, "alpha_loss": -0.12396323680877686, "alpha_value": 0.9877732992172241, "log_alpha_value": -0.012302032671868801, "target_entropy": -6.0, "policy_t": -0.00664876401424408, "mean_q": 3.2045888900756836, "max_q": 4.021709442138672, "min_q": 2.6223392486572266}, "td_error": [1.8865588903427124, 1.0901378393173218, 2.9824209213256836, 2.649740695953369, 1.291306734085083, 1.8094831705093384, 1.1528300046920776, 0.646801233291626, 1.1797629594802856, 2.2614078521728516, 2.835909366607666, 2.6605312824249268, 0.49763989448547363, 3.817356824874878, 1.8390110731124878, 1.8769537210464478, 0.906617283821106, 2.370096206665039, 2.6900506019592285, 0.18937408924102783, 0.44776713848114014, 2.3058362007141113, 3.219738006591797, 4.92282772064209, 1.9915663003921509, 0.24710798263549805, 1.50465989112854, 1.6856598854064941, 3.6675710678100586, 1.6925671100616455, 0.3354748487472534, 0.8605066537857056, 1.4498133659362793, 1.596186876296997, 1.0511506795883179, 0.3676180839538574, 0.7279456853866577, 1.2173423767089844, 2.5675106048583984, 0.339213490486145, 3.019286632537842, 0.13086462020874023, 0.6914031505584717, 3.0745177268981934, 0.7753967046737671, 1.3956754207611084, 0.4485257863998413, 0.4976956844329834, 1.3233356475830078, 1.8978824615478516, 0.840492844581604, 1.040424108505249, 0.3639422655105591, 2.6309492588043213, 0.21612024307250977, 0.8071719408035278, 1.0766302347183228, 2.983142375946045, 1.2794737815856934, 2.300668239593506, 0.2712974548339844, 1.8255598545074463, 3.065545082092285, 0.12876272201538086, 1.0981228351593018, 2.0897488594055176, 2.2560958862304688, 1.8051198720932007, 2.026515007019043, 1.0931620597839355, 1.1453596353530884, 0.4693669080734253, 1.465574860572815, 1.7640984058380127, 1.2414262294769287, 1.9646390676498413, 0.2213832139968872, 4.654758453369141, 1.5595619678497314, 3.1635470390319824, 1.5102870464324951, 1.027856469154358, 0.12743759155273438, 0.6278402805328369, 0.37019777297973633, 2.03861665725708], "mean_td_error": 1.565552830696106, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08476448059082, "actor_loss": -6.8965044021606445, "critic_loss": 0.15903867781162262, "alpha_loss": -0.12417963147163391, "alpha_value": 0.987761914730072, "log_alpha_value": -0.012313587591052055, "target_entropy": -6.0, "policy_t": -0.027249997481703758, "mean_q": 3.2049779891967773, "max_q": 4.358152866363525, "min_q": 2.355292797088623}, "td_error": [1.1648306846618652, 1.548003911972046, 2.1971280574798584, 0.3154110908508301, 0.4834630489349365, 0.39044713973999023, 0.13836324214935303, 0.8320280313491821, 1.6491581201553345, 1.0011481046676636, 0.3240464925765991, 0.13480496406555176, 0.7269525527954102, 0.6636966466903687, 0.19897520542144775, 0.3497196435928345, 0.9247651100158691, 1.3378709554672241, 1.0294969081878662, 0.36802589893341064, 0.9285125732421875, 0.950215220451355, 0.10891902446746826, 1.345375895500183, 0.4258086681365967, 0.918897271156311, 1.6724244356155396, 0.8582431077957153, 0.5790045261383057, 0.08579623699188232, 1.6512700319290161, 0.10978114604949951, 4.5801215171813965, 1.243782639503479, 2.3883056640625, 1.161446452140808, 0.21920883655548096, 0.2763298749923706, 0.46301496028900146, 0.5034416913986206, 2.3360629081726074, 0.8464400768280029, 1.7591710090637207, 0.5090504884719849, 0.08096778392791748, 0.1636519432067871, 0.28856945037841797, 1.4984108209609985, 3.009885787963867, 0.3517662286758423, 2.0995030403137207, 1.5642294883728027, 0.6670873165130615, 2.9462709426879883, 0.47890782356262207, 0.8232122659683228, 1.3991851806640625, 1.5010753870010376, 0.44477570056915283, 0.9547551870346069, 0.31618964672088623, 0.3254505395889282, 1.0072928667068481, 0.6267317533493042, 0.558144211769104, 0.8080369234085083, 0.6608418226242065, 0.21448147296905518, 0.6697186231613159, 0.24216771125793457, 0.11770594120025635, 1.333740472793579, 0.31640195846557617, 0.5135089159011841, 2.4266855716705322, 0.7386900186538696, 0.7100259065628052, 1.2543400526046753, 0.6270323991775513, 0.8565970659255981, 0.06055617332458496, 1.3211373090744019, 0.3058408498764038, 0.13368582725524902, 2.7477641105651855, 1.788182258605957], "mean_td_error": 0.9378158450126648, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129669189453125, "actor_loss": -7.091248989105225, "critic_loss": 0.29623305797576904, "alpha_loss": -0.12462130188941956, "alpha_value": 0.9877727627754211, "log_alpha_value": -0.012302602641284466, "target_entropy": -6.0, "policy_t": 0.01932337135076523, "mean_q": 3.0439672470092773, "max_q": 3.846285104751587, "min_q": 2.3849754333496094}, "td_error": [0.6273325681686401, 0.11546313762664795, 0.24663197994232178, 1.0315591096878052, 1.58900785446167, 0.36005091667175293, 0.5630084276199341, 0.9258829355239868, 1.0158778429031372, 0.6353151798248291, 1.6853150129318237, 0.5695673227310181, 1.4728546142578125, 0.9121296405792236, 0.8608207702636719, 1.5089119672775269, 2.1377716064453125, 0.7891826629638672, 2.2378787994384766, 1.2152764797210693, 0.7837643623352051, 2.260528087615967, 0.09389948844909668, 1.7237095832824707, 1.21609628200531, 1.0971243381500244, 1.3492833375930786, 1.133998990058899, 0.28455913066864014, 0.9991270303726196, 0.9578307867050171, 0.18086457252502441, 0.4868670701980591, 2.1129989624023438, 0.2962120771408081, 0.20316946506500244, 1.1044111251831055, 1.2443140745162964, 1.63527250289917, 0.9031379222869873, 1.563907504081726, 0.3144022226333618, 1.9171582460403442, 0.5716735124588013, 0.42501914501190186, 0.907397985458374, 0.3594602346420288, 0.6455671787261963, 0.2838836908340454, 1.112796664237976, 0.8827970027923584, 1.8834432363510132, 1.6324710845947266, 1.7216365337371826, 1.1887792348861694, 1.1486111879348755, 1.9716975688934326, 3.108952522277832, 0.7411791086196899, 0.5741546154022217, 1.57856285572052, 1.3301503658294678, 2.8059630393981934, 2.4864213466644287, 1.2251358032226562, 2.723651885986328, 0.8272885084152222, 1.0197077989578247, 0.12572085857391357, 3.5451860427856445, 0.19694674015045166, 1.1349682807922363, 0.23448920249938965, 1.095887303352356, 0.15539121627807617, 0.27300262451171875, 0.9964401721954346, 3.0538597106933594, 1.3050620555877686, 1.459177851676941, 0.20673143863677979, 1.5973209142684937, 1.7289294004440308, 3.516991138458252, 0.2433987855911255, 1.6223231554031372], "mean_td_error": 1.1629152297973633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 484.3144251504036, "num_env_steps_trained_throughput_per_sec": 139.45660902768319, "timesteps_total": 38528, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 2110.42, "sample_time_ms": 1504.571, "load_time_ms": 0.533, "load_throughput": 483720.188, "learn_time_ms": 63.081, "learn_throughput": 4089.962, "synch_weights_time_ms": 16.119}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-49", "timestamp": 1700203069, "time_this_iter_s": 1.8668100833892822, "time_total_s": 89.10512900352478, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.10512900352478, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 64.46666666666667, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043889999389648, "actor_loss": -7.1838178634643555, "critic_loss": 0.28461623191833496, "alpha_loss": -0.12657518684864044, "alpha_value": 0.9874768853187561, "log_alpha_value": -0.012602207250893116, "target_entropy": -6.0, "policy_t": 0.021740121766924858, "mean_q": 3.3644518852233887, "max_q": 4.46584415435791, "min_q": 2.7419779300689697}, "td_error": [0.9409803152084351, 0.7385189533233643, 2.4716439247131348, 2.2886948585510254, 1.0504029989242554, 0.7088483572006226, 0.8684346675872803, 2.732050895690918, 0.36532604694366455, 0.7513717412948608, 0.10336768627166748, 0.1009448766708374, 1.850937008857727, 2.114471912384033, 1.7021453380584717, 1.5122431516647339, 3.9366111755371094, 1.6205042600631714, 0.05266249179840088, 1.5465370416641235, 2.5230512619018555, 1.6621812582015991, 0.5386617183685303, 3.8522591590881348, 0.8227760791778564, 1.0541603565216064, 0.7874112129211426, 2.291621208190918, 1.0367242097854614, 0.4834800958633423, 1.9292587041854858, 2.523465156555176, 1.219232439994812, 0.16385746002197266, 0.5808485746383667, 1.72764253616333, 3.9585065841674805, 2.043382406234741, 1.8041034936904907, 1.1722652912139893, 1.8565454483032227, 0.6930243968963623, 1.5249649286270142, 1.387685775756836, 0.4860684871673584, 0.4619532823562622, 1.984987497329712, 0.664857029914856, 2.1962594985961914, 2.415404796600342, 1.1607965230941772, 2.239469289779663, 0.16790878772735596, 2.6715173721313477, 3.286381959915161, 3.1629977226257324, 1.5082142353057861, 0.2528578042984009, 1.4471744298934937, 0.43112313747406006, 1.6913120746612549, 0.18785464763641357, 2.7710680961608887, 1.1132352352142334, 1.225123405456543, 1.4393737316131592, 2.3831284046173096, 0.22659647464752197, 1.2515840530395508, 0.631243109703064, 2.609785318374634, 2.941612482070923, 0.9304050207138062, 0.1406693458557129, 0.2003946304321289, 0.12351703643798828, 0.4280034303665161, 2.0843048095703125, 0.8856863975524902, 1.992277979850769, 1.6229372024536133, 1.8578801155090332, 0.3900028467178345, 0.21379780769348145, 0.07789266109466553, 1.72187077999115], "mean_td_error": 1.4043411016464233, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046732902526855, "actor_loss": -6.979835510253906, "critic_loss": 0.20113927125930786, "alpha_loss": -0.12672899663448334, "alpha_value": 0.9874652624130249, "log_alpha_value": -0.012613949365913868, "target_entropy": -6.0, "policy_t": -0.032064683735370636, "mean_q": 3.2484259605407715, "max_q": 4.419803619384766, "min_q": 2.3303163051605225}, "td_error": [1.3697845935821533, 1.6689510345458984, 0.5586732625961304, 0.5608998537063599, 2.3264474868774414, 0.6161521673202515, 0.2568739652633667, 0.7331830263137817, 0.8551141023635864, 0.5085692405700684, 0.8210909366607666, 0.6002171039581299, 2.6091160774230957, 1.8838458061218262, 0.09544754028320312, 1.8101327419281006, 0.21397113800048828, 0.5762686729431152, 1.2749698162078857, 1.861712098121643, 0.7138625383377075, 1.3553781509399414, 1.5565353631973267, 0.5916135311126709, 1.4977587461471558, 0.8823086023330688, 1.4792269468307495, 0.2242286205291748, 2.148735284805298, 0.039130568504333496, 2.0634641647338867, 3.6386122703552246, 0.42094171047210693, 2.099595069885254, 1.600029468536377, 0.3778167963027954, 1.0836567878723145, 0.9934707880020142, 0.43422412872314453, 1.9959381818771362, 2.30161190032959, 0.1960146427154541, 0.4788762331008911, 1.7909669876098633, 1.7510312795639038, 0.5344986915588379, 2.591702938079834, 0.6604592800140381, 2.471231698989868, 0.5782228708267212, 2.1623787879943848, 0.25026071071624756, 0.29486584663391113, 1.4595597982406616, 1.165261149406433, 0.7826361656188965, 0.6178996562957764, 0.5740231275558472, 1.2544831037521362, 2.443427085876465, 1.160313367843628, 1.969647765159607, 0.27831077575683594, 0.32472705841064453, 1.393454909324646, 0.20287001132965088, 0.6169178485870361, 0.7576335668563843, 0.43504178524017334, 1.2583478689193726, 0.17273461818695068, 1.7319905757904053, 0.23201918601989746, 0.683424711227417, 1.1128195524215698, 1.571287751197815, 0.790693998336792, 1.7253973484039307, 0.28191208839416504, 0.3812922239303589, 0.507293701171875, 2.3708839416503906, 1.1526906490325928, 0.48598992824554443, 2.7116243839263916, 1.478378176689148], "mean_td_error": 1.1226170063018799, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063993453979492, "actor_loss": -7.0611371994018555, "critic_loss": 0.25682753324508667, "alpha_loss": -0.1268310695886612, "alpha_value": 0.9874765872955322, "log_alpha_value": -0.012602461501955986, "target_entropy": -6.0, "policy_t": -0.013443896546959877, "mean_q": 3.08000111579895, "max_q": 3.9436519145965576, "min_q": 2.467541217803955}, "td_error": [0.6574708223342896, 0.38758277893066406, 0.14439237117767334, 1.513575553894043, 1.365054965019226, 0.9879684448242188, 1.068331241607666, 0.6587785482406616, 0.2444692850112915, 0.8657650947570801, 0.33215224742889404, 1.8026816844940186, 1.3052482604980469, 0.2994101047515869, 0.616418719291687, 0.8727942705154419, 1.120849847793579, 2.0273518562316895, 0.29319822788238525, 2.070237874984741, 0.36325502395629883, 0.6351414918899536, 0.35850250720977783, 1.2995543479919434, 1.4913893938064575, 1.270540714263916, 0.5881049633026123, 2.9290361404418945, 0.9231467247009277, 1.0597578287124634, 3.1076560020446777, 1.3531932830810547, 0.5586855411529541, 0.2477947473526001, 0.985741376876831, 2.0417542457580566, 0.2664538621902466, 0.8356837034225464, 0.1250746250152588, 1.4046367406845093, 0.7933714389801025, 0.31822073459625244, 0.7813904285430908, 1.1665881872177124, 1.056795358657837, 0.999005913734436, 0.04869723320007324, 1.4818528890609741, 2.69406795501709, 1.4881764650344849, 0.18479704856872559, 0.3128845691680908, 1.4168366193771362, 1.102996826171875, 0.3974539041519165, 0.36881792545318604, 0.19993269443511963, 1.1746525764465332, 0.40398943424224854, 1.5159807205200195, 0.32467222213745117, 0.4894770383834839, 1.7600921392440796, 0.7046586275100708, 0.8844172954559326, 0.7017189264297485, 0.7778369188308716, 0.8816676139831543, 1.378156065940857, 0.3876063823699951, 0.4976685047149658, 0.2125699520111084, 0.2214876413345337, 1.1968082189559937, 1.106014609336853, 2.2153356075286865, 0.7155545949935913, 0.4499927759170532, 1.0447896718978882, 1.8480910062789917, 1.1006379127502441, 5.674379825592041, 2.302729606628418, 0.8947908878326416, 2.3986666202545166, 0.8382986783981323], "mean_td_error": 1.039458990097046, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 484.9729205448127, "num_env_steps_trained_throughput_per_sec": 139.64622042473403, "timesteps_total": 39424, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 118272, "timers": {"training_iteration_time_ms": 2009.649, "sample_time_ms": 1414.583, "load_time_ms": 0.524, "load_throughput": 492571.547, "learn_time_ms": 62.043, "learn_throughput": 4158.411, "synch_weights_time_ms": 15.679}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 11094, "num_agent_steps_sampled": 118272, "num_agent_steps_trained": 11094, "last_target_update_ts": 39424, "num_target_updates": 43}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-51", "timestamp": 1700203071, "time_this_iter_s": 1.8644301891326904, "time_total_s": 90.96955919265747, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e08478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 90.96955919265747, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 85.45, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085901260375977, "actor_loss": -7.2999444007873535, "critic_loss": 0.3103586435317993, "alpha_loss": -0.13013091683387756, "alpha_value": 0.9871805906295776, "log_alpha_value": -0.012902259826660156, "target_entropy": -6.0, "policy_t": 0.03753406181931496, "mean_q": 3.4507641792297363, "max_q": 4.361469745635986, "min_q": 2.816143274307251}, "td_error": [0.12283134460449219, 3.460354804992676, 0.17433786392211914, 1.7068960666656494, 3.308281421661377, 0.8650188446044922, 1.8683116436004639, 0.31158876419067383, 0.17223429679870605, 1.3055651187896729, 1.344227910041809, 0.40877997875213623, 1.2505275011062622, 1.1855645179748535, 0.8606500625610352, 1.390192985534668, 1.28034245967865, 0.5792865753173828, 1.0519955158233643, 1.3689203262329102, 0.8168871402740479, 1.3554130792617798, 3.021023988723755, 0.36966097354888916, 0.49932312965393066, 0.07749199867248535, 0.7535820007324219, 1.9761183261871338, 2.0966758728027344, 1.980715036392212, 1.7813725471496582, 2.0242393016815186, 1.0915141105651855, 2.523242473602295, 2.049445629119873, 4.540073394775391, 2.3996243476867676, 2.765209913253784, 1.1949383020401, 0.1863945722579956, 1.7811462879180908, 0.5907589197158813, 1.1543548107147217, 4.358160972595215, 2.618828296661377, 1.8254581689834595, 1.8837683200836182, 1.1023279428482056, 1.6951589584350586, 2.364410638809204, 0.2996407747268677, 0.7028505802154541, 1.0027130842208862, 2.6554245948791504, 1.0929858684539795, 2.1925127506256104, 0.6058883666992188, 0.7039519548416138, 1.590166449546814, 1.558842420578003, 0.8945169448852539, 0.2414989471435547, 1.9081308841705322, 0.08239686489105225, 1.9888513088226318, 2.1995596885681152, 2.5528440475463867, 0.1707092523574829, 0.35402607917785645, 1.8281264305114746, 1.7760411500930786, 2.470945119857788, 0.9583477973937988, 1.783324956893921, 0.14987802505493164, 2.545982837677002, 0.6259340047836304, 1.722124457359314, 0.4488708972930908, 1.1047298908233643, 2.0672380924224854, 0.07910394668579102, 0.057303786277770996, 2.7644619941711426, 2.0618162155151367, 2.600672483444214], "mean_td_error": 1.4504142999649048, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.16077995300293, "actor_loss": -7.1352667808532715, "critic_loss": 0.246730238199234, "alpha_loss": -0.13121826946735382, "alpha_value": 0.9871688485145569, "log_alpha_value": -0.012914191000163555, "target_entropy": -6.0, "policy_t": 0.035767994821071625, "mean_q": 3.2882208824157715, "max_q": 4.512892723083496, "min_q": 2.3092293739318848}, "td_error": [0.1857738494873047, 1.078865647315979, 1.294895887374878, 2.644286632537842, 0.7626155614852905, 3.322996139526367, 0.8799570798873901, 1.1015701293945312, 2.0669519901275635, 1.1195088624954224, 1.750017762184143, 1.309262752532959, 0.9283503293991089, 0.85699462890625, 2.2716479301452637, 1.5591307878494263, 0.5896587371826172, 1.7832753658294678, 0.580973744392395, 1.010703682899475, 1.5073153972625732, 3.681807518005371, 1.3367868661880493, 2.739673614501953, 1.5163288116455078, 3.732337474822998, 0.7486685514450073, 1.3300329446792603, 2.392988681793213, 2.803280830383301, 0.5165374279022217, 0.6101419925689697, 1.0374420881271362, 0.33184289932250977, 3.1304471492767334, 1.4821808338165283, 1.2463105916976929, 0.8791202306747437, 0.14088594913482666, 1.0117603540420532, 1.284521460533142, 0.8674588203430176, 0.3030916452407837, 0.7971415519714355, 0.3828561305999756, 2.4148693084716797, 1.050682544708252, 2.0150864124298096, 1.9586879014968872, 0.5564136505126953, 0.2339491844177246, 1.0649462938308716, 0.030014514923095703, 0.5798249244689941, 1.8223658800125122, 0.95313560962677, 0.4038904905319214, 0.5332188606262207, 1.5351791381835938, 0.6887564659118652, 0.17334115505218506, 1.6651555299758911, 3.7370810508728027, 0.7125849723815918, 1.375584602355957, 0.3050590753555298, 3.9217493534088135, 0.6012400388717651, 0.1444995403289795, 0.11377298831939697, 1.8641210794448853, 3.940789222717285, 1.0465199947357178, 1.851324200630188, 2.273057460784912, 0.468377947807312, 1.3501167297363281, 0.4114816188812256, 1.1998130083084106, 0.792519211769104, 1.6372549533843994, 0.6416751146316528, 0.46759772300720215, 0.759793758392334, 0.374165415763855, 0.5768325328826904], "mean_td_error": 1.29249906539917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02242374420166, "actor_loss": -7.118565082550049, "critic_loss": 0.2767069935798645, "alpha_loss": -0.1293121725320816, "alpha_value": 0.9871805906295776, "log_alpha_value": -0.012902285903692245, "target_entropy": -6.0, "policy_t": 0.05579973757266998, "mean_q": 3.1923677921295166, "max_q": 4.084866046905518, "min_q": 2.3523061275482178}, "td_error": [0.8523033857345581, 0.5129600763320923, 1.1076549291610718, 1.659132719039917, 1.0280998945236206, 3.0316576957702637, 0.23113858699798584, 1.0617538690567017, 1.0193933248519897, 0.29909205436706543, 0.2548401355743408, 1.7138983011245728, 1.4267960786819458, 1.3633161783218384, 0.5711898803710938, 0.16549408435821533, 1.9989715814590454, 1.7236028909683228, 0.8617954254150391, 2.5012106895446777, 0.8590397834777832, 0.3419029712677002, 1.3859888315200806, 1.0080584287643433, 1.405318260192871, 3.191445827484131, 3.617797374725342, 1.5931261777877808, 0.420749306678772, 0.5548290014266968, 0.06880521774291992, 0.30824387073516846, 1.1773525476455688, 0.6812914609909058, 1.0968888998031616, 2.4667813777923584, 1.008594274520874, 0.6931099891662598, 1.1688917875289917, 0.4928196668624878, 0.6804696321487427, 3.4133639335632324, 0.07551896572113037, 0.5980309247970581, 1.8174813985824585, 1.9659277200698853, 0.16587376594543457, 2.609614610671997, 1.654962420463562, 2.1877036094665527, 1.6632708311080933, 0.9143201112747192, 0.10371077060699463, 0.17494642734527588, 1.8634346723556519, 2.0663390159606934, 1.8908354043960571, 0.9837671518325806, 2.119870901107788, 0.45600855350494385, 0.20445573329925537, 0.06564164161682129, 0.8584758043289185, 0.5587724447250366, 0.9772270917892456, 0.10382509231567383, 0.2573237419128418, 0.7145171165466309, 2.1796364784240723, 2.0469987392425537, 0.512352466583252, 0.25843024253845215, 1.3388667106628418, 0.6067794561386108, 0.04280662536621094, 0.09945762157440186, 0.311901330947876, 0.3166118860244751, 0.7155767679214478, 0.8953089714050293, 1.6573539972305298, 0.5478707551956177, 0.09051215648651123, 0.15028512477874756, 1.7091225385665894, 0.7442147731781006], "mean_td_error": 1.0731990337371826, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 492.4251136656519, "num_env_steps_trained_throughput_per_sec": 141.79205281890424, "timesteps_total": 40320, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1933.094, "sample_time_ms": 1336.296, "load_time_ms": 0.524, "load_throughput": 492549.127, "learn_time_ms": 62.068, "learn_throughput": 4156.715, "synch_weights_time_ms": 15.051}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-53", "timestamp": 1700203073, "time_this_iter_s": 1.8356361389160156, "time_total_s": 92.80519533157349, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.80519533157349, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 64.03333333333335, "ram_util_percent": 92.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118127822875977, "actor_loss": -7.408262252807617, "critic_loss": 0.27888035774230957, "alpha_loss": -0.13358257710933685, "alpha_value": 0.9868844747543335, "log_alpha_value": -0.013202302157878876, "target_entropy": -6.0, "policy_t": 0.003575734794139862, "mean_q": 3.581547975540161, "max_q": 4.701333522796631, "min_q": 2.8034932613372803}, "td_error": [0.2410893440246582, 3.1496829986572266, 0.9959925413131714, 3.496713161468506, 0.6136916875839233, 0.3927195072174072, 1.9591264724731445, 0.5573991537094116, 1.4954614639282227, 1.9081300497055054, 1.9052766561508179, 2.7821106910705566, 1.0489662885665894, 0.08663356304168701, 0.29784369468688965, 2.0765953063964844, 0.32738733291625977, 1.040463924407959, 1.9052042961120605, 1.489984393119812, 1.3349456787109375, 2.084383249282837, 2.368655204772949, 0.4289674758911133, 1.0505815744400024, 0.050045132637023926, 2.676100015640259, 1.1112682819366455, 2.131094217300415, 0.6642051935195923, 0.8683298826217651, 0.8881553411483765, 2.5897531509399414, 0.4215949773788452, 2.405918598175049, 1.6615923643112183, 1.2112911939620972, 2.3372716903686523, 1.5334373712539673, 1.817689061164856, 0.9706754684448242, 2.3123040199279785, 0.3988363742828369, 2.4488348960876465, 0.8651516437530518, 0.7602349519729614, 0.1452789306640625, 1.9113825559616089, 1.0388810634613037, 1.4788974523544312, 0.250230073928833, 0.6047683954238892, 1.068332314491272, 0.5489505529403687, 1.5525829792022705, 1.6726893186569214, 0.03269040584564209, 0.7759813070297241, 0.24633288383483887, 2.5877184867858887, 2.6911587715148926, 0.22497272491455078, 1.0950007438659668, 1.081470251083374, 0.8443359136581421, 0.8860143423080444, 1.2608964443206787, 2.5068373680114746, 2.468015670776367, 1.614135980606079, 6.478144645690918, 0.021673083305358887, 0.10769021511077881, 1.470619797706604, 2.2650132179260254, 0.4220590591430664, 0.8833678960800171, 0.1306908130645752, 0.23159265518188477, 0.12165498733520508, 2.8593268394470215, 0.8144475221633911, 2.174001693725586, 0.5801510810852051, 2.5684316158294678, 2.1241960525512695], "mean_td_error": 1.3604930639266968, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109270095825195, "actor_loss": -7.125082492828369, "critic_loss": 0.2280256748199463, "alpha_loss": -0.13358986377716064, "alpha_value": 0.9868723154067993, "log_alpha_value": -0.013214590959250927, "target_entropy": -6.0, "policy_t": -0.009460964240133762, "mean_q": 3.254425048828125, "max_q": 4.721489906311035, "min_q": 2.325458526611328}, "td_error": [2.709357738494873, 1.4333404302597046, 1.320876955986023, 1.268149971961975, 2.335890293121338, 1.8513381481170654, 2.296907901763916, 0.3177602291107178, 0.9710378646850586, 0.36075079441070557, 0.1850452423095703, 2.6644954681396484, 0.20859599113464355, 0.9455935955047607, 0.07114660739898682, 0.35444796085357666, 2.714277505874634, 0.9753901958465576, 1.4854447841644287, 1.424843192100525, 0.8884569406509399, 1.4171409606933594, 0.16547703742980957, 0.9199197292327881, 3.211555004119873, 1.359584927558899, 0.7777543067932129, 2.8788886070251465, 2.2728114128112793, 0.6323373317718506, 0.5589612722396851, 0.652877688407898, 0.1234138011932373, 0.30345940589904785, 0.8130096197128296, 0.16193675994873047, 0.06508290767669678, 0.1671161651611328, 2.3201382160186768, 1.7726209163665771, 1.327897548675537, 0.2569401264190674, 0.3802945613861084, 0.7842562198638916, 0.4400756359100342, 1.13541841506958, 0.3563106060028076, 0.33006322383880615, 0.2439866065979004, 3.3369760513305664, 0.5805078744888306, 2.6874749660491943, 0.7950589656829834, 3.981289863586426, 0.8971617221832275, 1.4002541303634644, 1.0782538652420044, 0.4467592239379883, 3.41195011138916, 0.5464975833892822, 1.778576374053955, 1.6123448610305786, 1.2086204290390015, 1.7510647773742676, 0.5615942478179932, 0.5711574554443359, 2.8266537189483643, 1.64774751663208, 1.1555054187774658, 3.8611702919006348, 2.1064958572387695, 0.11071741580963135, 1.294676661491394, 0.4595377445220947, 1.4570246934890747, 0.18636727333068848, 0.40280091762542725, 0.8830204010009766, 0.7204657793045044, 0.8100817203521729, 0.4946843385696411, 0.521216630935669, 0.18641424179077148, 1.2508255243301392, 2.7603378295898438, 0.8905318975448608], "mean_td_error": 1.2009801864624023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086174964904785, "actor_loss": -7.218151569366455, "critic_loss": 0.2771384119987488, "alpha_loss": -0.13315749168395996, "alpha_value": 0.9868847727775574, "log_alpha_value": -0.013201983645558357, "target_entropy": -6.0, "policy_t": -0.013332411646842957, "mean_q": 3.2399566173553467, "max_q": 4.108313083648682, "min_q": 2.5168895721435547}, "td_error": [1.0489237308502197, 0.17393994331359863, 0.361767053604126, 0.15522706508636475, 0.5383691787719727, 1.3093011379241943, 2.0096817016601562, 1.3668404817581177, 1.0360302925109863, 2.422790765762329, 0.2460416555404663, 0.7160919904708862, 0.8747678995132446, 1.4532262086868286, 0.5950089693069458, 3.1186790466308594, 0.2264648675918579, 1.410244345664978, 0.2894192934036255, 1.6087994575500488, 1.2483196258544922, 0.9053394794464111, 0.019665241241455078, 1.4975253343582153, 1.9322465658187866, 2.2387020587921143, 0.49693751335144043, 1.068604588508606, 1.5364301204681396, 0.5291367769241333, 2.0132670402526855, 1.4564536809921265, 0.47826480865478516, 0.22594976425170898, 0.5009489059448242, 0.9085791110992432, 1.2631103992462158, 1.119960069656372, 0.3964407444000244, 0.04376983642578125, 1.6813108921051025, 2.5814900398254395, 1.0667273998260498, 0.8447692394256592, 0.6270983219146729, 0.11945450305938721, 0.08698379993438721, 0.06473302841186523, 0.9371311664581299, 1.3883150815963745, 3.7440829277038574, 2.808197498321533, 2.0926523208618164, 1.0966569185256958, 2.261953830718994, 0.6979292631149292, 0.31719970703125, 2.092686176300049, 1.078304648399353, 0.10214865207672119, 0.548147439956665, 0.7394182682037354, 0.09539675712585449, 0.22611546516418457, 2.3470330238342285, 0.6305564641952515, 2.154041051864624, 0.5712748765945435, 2.171428918838501, 0.9646056890487671, 0.36497950553894043, 0.8944072723388672, 0.2972186803817749, 1.974162220954895, 0.04432046413421631, 1.111080288887024, 0.7826375961303711, 1.8195841312408447, 1.2991383075714111, 0.23485934734344482, 1.431209683418274, 1.1580780744552612, 0.31014037132263184, 1.7356059551239014, 0.8498128652572632, 1.7007579803466797], "mean_td_error": 1.0812453031539917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.23549092893137, "num_env_steps_trained_throughput_per_sec": 138.85798734337533, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1917.125, "sample_time_ms": 1318.3, "load_time_ms": 0.522, "load_throughput": 494236.324, "learn_time_ms": 62.096, "learn_throughput": 4154.887, "synch_weights_time_ms": 14.863}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-55", "timestamp": 1700203075, "time_this_iter_s": 1.8744819164276123, "time_total_s": 94.6796772480011, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.6796772480011, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 65.53333333333333, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149267196655273, "actor_loss": -7.711909770965576, "critic_loss": 0.35219693183898926, "alpha_loss": -0.13703955709934235, "alpha_value": 0.9865883588790894, "log_alpha_value": -0.013502409681677818, "target_entropy": -6.0, "policy_t": 0.01748751662671566, "mean_q": 3.7556800842285156, "max_q": 4.688935279846191, "min_q": 3.018364906311035}, "td_error": [1.5641844272613525, 1.418100357055664, 1.0312697887420654, 1.125416874885559, 1.0226216316223145, 0.8676354885101318, 2.338376045227051, 0.8912022113800049, 0.5875879526138306, 4.043290615081787, 1.9934338331222534, 0.11619198322296143, 0.08724391460418701, 0.3061048984527588, 0.6287188529968262, 0.6531298160552979, 1.4545629024505615, 1.402782917022705, 3.409125328063965, 2.1486082077026367, 1.6508116722106934, 1.8023414611816406, 0.08584558963775635, 1.8405920267105103, 3.2232959270477295, 2.8100788593292236, 2.4689459800720215, 0.8121671676635742, 3.6261801719665527, 2.7338032722473145, 0.09449267387390137, 0.13958168029785156, 0.7612731456756592, 0.8603662252426147, 0.28715837001800537, 3.4768495559692383, 0.3358635902404785, 1.969249963760376, 3.2949166297912598, 1.9355137348175049, 0.9164353609085083, 2.9432551860809326, 2.5835609436035156, 0.8405011892318726, 1.1063058376312256, 3.950963020324707, 0.679446816444397, 1.4189980030059814, 2.380321979522705, 1.4749032258987427, 1.3523328304290771, 2.4334163665771484, 3.3259944915771484, 2.442446708679199, 0.6937247514724731, 0.309627890586853, 0.3351031541824341, 3.3888473510742188, 2.178133726119995, 1.6756325960159302, 1.1005889177322388, 0.9692082405090332, 1.959486961364746, 0.7394434213638306, 2.0301032066345215, 2.4673349857330322, 2.658742904663086, 2.968489170074463, 1.417999505996704, 0.4176204204559326, 1.3836610317230225, 0.2477015256881714, 0.023040294647216797, 1.1319139003753662, 3.6734461784362793, 0.5150293111801147, 2.3378443717956543, 0.66978919506073, 0.38178110122680664, 0.6202893257141113, 0.06466543674468994, 1.3678498268127441, 0.12799227237701416, 3.99786639213562, 0.5778292417526245, 2.6438727378845215], "mean_td_error": 1.560726284980774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.151244163513184, "actor_loss": -7.26397705078125, "critic_loss": 0.2542364299297333, "alpha_loss": -0.1371941715478897, "alpha_value": 0.9865759015083313, "log_alpha_value": -0.013515009544789791, "target_entropy": -6.0, "policy_t": -0.03552936017513275, "mean_q": 3.3730170726776123, "max_q": 4.61704158782959, "min_q": 2.404815673828125}, "td_error": [0.6933844089508057, 0.19473791122436523, 2.8053581714630127, 0.08882331848144531, 1.8290919065475464, 0.16379642486572266, 3.741448402404785, 1.5683269500732422, 0.9124358892440796, 0.07617533206939697, 0.851250410079956, 0.3284342288970947, 0.4396979808807373, 1.3171378374099731, 1.4603564739227295, 1.5760257244110107, 1.275848627090454, 1.4370064735412598, 0.06315982341766357, 2.4744997024536133, 1.6401715278625488, 0.28905200958251953, 1.9144235849380493, 0.46215832233428955, 0.8413996696472168, 0.6952980756759644, 0.1591343879699707, 0.21762478351593018, 2.207994222640991, 2.530327558517456, 0.16810846328735352, 2.1270217895507812, 1.713852047920227, 0.5709266662597656, 0.31281304359436035, 0.39629387855529785, 1.7506786584854126, 0.6912870407104492, 0.3511160612106323, 1.2857921123504639, 1.0554910898208618, 0.09670364856719971, 0.6491503715515137, 0.6540833711624146, 0.5519083738327026, 1.1687326431274414, 0.31956958770751953, 0.5988655090332031, 0.042737603187561035, 1.017570972442627, 1.8648737668991089, 1.101847529411316, 1.8636945486068726, 0.5767265558242798, 1.0776485204696655, 3.3137669563293457, 1.6406900882720947, 0.819709300994873, 3.4981250762939453, 1.015680193901062, 3.8261008262634277, 1.5552161931991577, 1.832025408744812, 2.210618019104004, 0.2523850202560425, 3.417870283126831, 0.4318162202835083, 2.522024393081665, 3.222351312637329, 2.5813522338867188, 0.254286527633667, 0.33530235290527344, 1.7334126234054565, 0.41613030433654785, 1.3648178577423096, 3.7383880615234375, 0.19409394264221191, 0.9493486881256104, 0.27344250679016113, 2.416799545288086, 1.4852516651153564, 2.9792227745056152, 1.860095500946045, 1.4847160577774048, 2.9283900260925293, 0.4108985662460327], "mean_td_error": 1.2933303117752075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121138572692871, "actor_loss": -7.272883415222168, "critic_loss": 0.28216683864593506, "alpha_loss": -0.13665278255939484, "alpha_value": 0.9865890145301819, "log_alpha_value": -0.013501719571650028, "target_entropy": -6.0, "policy_t": -0.04325580596923828, "mean_q": 3.2902402877807617, "max_q": 4.211043834686279, "min_q": 2.6475465297698975}, "td_error": [0.3022497892379761, 1.5179717540740967, 0.7319638729095459, 0.703011155128479, 0.7903150320053101, 0.048686861991882324, 0.32630324363708496, 0.13265037536621094, 0.9909442663192749, 0.43035733699798584, 0.7454915046691895, 1.8262698650360107, 1.8849657773971558, 0.6826411485671997, 0.9134935140609741, 0.4629042148590088, 1.3902008533477783, 0.6459829807281494, 2.527926445007324, 1.5555816888809204, 0.5625067949295044, 2.047025442123413, 1.1332248449325562, 0.5016806125640869, 0.2537928819656372, 1.9085323810577393, 1.000471591949463, 1.1691914796829224, 1.3957326412200928, 0.7535061836242676, 0.16587984561920166, 0.2525634765625, 1.2659512758255005, 0.19547820091247559, 1.2850909233093262, 0.06084001064300537, 0.7583706378936768, 0.6300538778305054, 1.3945461511611938, 0.5779861211776733, 2.489919662475586, 2.154987335205078, 1.2457677125930786, 2.1883277893066406, 1.123087763786316, 2.237771511077881, 2.195918083190918, 2.025775909423828, 0.4106783866882324, 0.8753519058227539, 2.7345476150512695, 1.0914596319198608, 0.4346364736557007, 2.250562906265259, 1.963796854019165, 1.3168948888778687, 0.20471537113189697, 1.2882400751113892, 3.8775429725646973, 0.10352981090545654, 1.4423656463623047, 0.4679391384124756, 0.4814263582229614, 0.23916363716125488, 0.33050012588500977, 0.22466671466827393, 1.7942312955856323, 0.015440106391906738, 3.866273880004883, 0.19084131717681885, 1.5470079183578491, 1.68864905834198, 2.102102041244507, 0.16366326808929443, 1.9825323820114136, 1.635920763015747, 1.642812728881836, 0.13934457302093506, 1.4734681844711304, 0.6414591073989868, 0.49840354919433594, 1.772006869316101, 1.297627329826355, 1.7140276432037354, 0.8272641897201538, 2.6686134338378906], "mean_td_error": 1.1509720087051392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 478.4640531588194, "num_env_steps_trained_throughput_per_sec": 137.7720153068922, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1911.012, "sample_time_ms": 1309.347, "load_time_ms": 0.525, "load_throughput": 491698.67, "learn_time_ms": 62.091, "learn_throughput": 4155.222, "synch_weights_time_ms": 14.992}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-57", "timestamp": 1700203077, "time_this_iter_s": 1.885713815689087, "time_total_s": 96.56539106369019, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07505e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.56539106369019, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.06666666666668, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007248878479004, "actor_loss": -7.815810203552246, "critic_loss": 0.32990044355392456, "alpha_loss": -0.13812652230262756, "alpha_value": 0.9862921833992004, "log_alpha_value": -0.013802647590637207, "target_entropy": -6.0, "policy_t": -0.014437641017138958, "mean_q": 3.9563918113708496, "max_q": 5.053467273712158, "min_q": 3.082737684249878}, "td_error": [0.6379382610321045, 1.9888509511947632, 3.2695930004119873, 0.8142709732055664, 0.8730624914169312, 1.3177039623260498, 0.6403266191482544, 0.2123711109161377, 0.2973724603652954, 2.621119499206543, 1.9842910766601562, 0.5867197513580322, 2.764078378677368, 1.1153943538665771, 0.4772385358810425, 1.4939367771148682, 0.8379700183868408, 1.6088615655899048, 1.538827896118164, 1.8537952899932861, 1.24631667137146, 0.1463860273361206, 3.460749864578247, 0.884469747543335, 3.6646182537078857, 1.1203827857971191, 1.9072433710098267, 2.463407516479492, 2.4535043239593506, 0.755340576171875, 0.9150569438934326, 1.1233936548233032, 3.9436726570129395, 0.4283667802810669, 0.7512993812561035, 0.9716405868530273, 1.933385968208313, 1.6022239923477173, 1.170682668685913, 0.316699743270874, 1.745978593826294, 1.5268287658691406, 3.2061803340911865, 2.34427547454834, 0.21642792224884033, 2.293821334838867, 1.0283600091934204, 4.150920867919922, 2.0515339374542236, 0.7463074922561646, 0.29027533531188965, 0.14397597312927246, 0.5454778671264648, 1.5503307580947876, 1.5316407680511475, 0.36734938621520996, 1.412566900253296, 0.7190862894058228, 0.9738128185272217, 0.3846184015274048, 0.40999341011047363, 0.8655527830123901, 1.6301002502441406, 0.37460625171661377, 1.1473692655563354, 0.7122697830200195, 1.2827401161193848, 1.8835787773132324, 1.8757755756378174, 2.469853162765503, 2.3708114624023438, 0.39067625999450684, 1.2252389192581177, 0.6348403692245483, 1.801321029663086, 0.1605280637741089, 2.410630226135254, 1.5329185724258423, 2.186903476715088, 3.347848653793335, 2.3795838356018066, 3.4873569011688232, 1.802411675453186, 0.3970944881439209, 4.879595756530762, 0.6749470233917236], "mean_td_error": 1.4855451583862305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131363868713379, "actor_loss": -7.272167205810547, "critic_loss": 0.28481990098953247, "alpha_loss": -0.13997028768062592, "alpha_value": 0.9862794280052185, "log_alpha_value": -0.013815541751682758, "target_entropy": -6.0, "policy_t": -0.0031405456829816103, "mean_q": 3.31489634513855, "max_q": 4.545423984527588, "min_q": 2.191913366317749}, "td_error": [0.09777271747589111, 1.4026896953582764, 0.950586199760437, 0.24739491939544678, 2.505998134613037, 0.3605746030807495, 1.9701194763183594, 3.1571555137634277, 0.44233787059783936, 3.9695324897766113, 1.0126439332962036, 4.096743106842041, 0.2882239818572998, 3.97885799407959, 0.5041681528091431, 0.21620547771453857, 0.2742908000946045, 0.30990540981292725, 2.725348949432373, 0.6146208047866821, 0.3987499475479126, 0.2656686305999756, 2.0696940422058105, 0.3951369524002075, 0.6621979475021362, 3.20382022857666, 0.2608999013900757, 1.7302367687225342, 1.0677077770233154, 4.021902561187744, 0.727951169013977, 1.2319296598434448, 2.674139976501465, 1.713038444519043, 0.14921557903289795, 4.424666404724121, 0.7900090217590332, 1.9578847885131836, 0.007032036781311035, 0.9835724830627441, 0.15076792240142822, 2.415750026702881, 0.9726163148880005, 2.135498523712158, 1.315505862236023, 0.3017817735671997, 4.219054222106934, 1.0743402242660522, 2.3042080402374268, 0.8907983303070068, 0.04788529872894287, 1.0403200387954712, 1.1292004585266113, 1.9989051818847656, 1.2559269666671753, 1.083499789237976, 0.20123291015625, 0.32075071334838867, 2.416701316833496, 0.9005279541015625, 3.5550546646118164, 3.4375381469726562, 0.47148072719573975, 2.3284354209899902, 1.70427405834198, 1.040766954421997, 2.1968109607696533, 1.20409095287323, 1.5980619192123413, 2.341823101043701, 0.21700584888458252, 1.1501127481460571, 1.8950945138931274, 0.4147365093231201, 0.15279889106750488, 1.8622524738311768, 1.2114112377166748, 1.9076241254806519, 0.552077054977417, 0.45846378803253174, 0.8750699758529663, 0.977001428604126, 1.8100279569625854, 0.24015367031097412, 1.8764394521713257, 0.8824821710586548], "mean_td_error": 1.3999649286270142, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.133991241455078, "actor_loss": -7.3569841384887695, "critic_loss": 0.26887062191963196, "alpha_loss": -0.139864981174469, "alpha_value": 0.9862932562828064, "log_alpha_value": -0.013801570981740952, "target_entropy": -6.0, "policy_t": -0.044095609337091446, "mean_q": 3.3696072101593018, "max_q": 4.251378536224365, "min_q": 2.5481083393096924}, "td_error": [1.3545477390289307, 1.5587607622146606, 1.2093764543533325, 0.40075647830963135, 1.867019772529602, 0.6418272256851196, 0.1929938793182373, 1.9076162576675415, 0.39479947090148926, 2.3774914741516113, 0.024936556816101074, 3.401132345199585, 0.05074048042297363, 0.5703088045120239, 1.8011964559555054, 1.5471961498260498, 0.9174206256866455, 0.17294156551361084, 0.6964210271835327, 4.008866310119629, 0.14976584911346436, 1.0126395225524902, 0.2851288318634033, 0.8183000087738037, 1.0216867923736572, 0.06709325313568115, 0.7115898132324219, 0.2493196725845337, 0.7714500427246094, 1.4564839601516724, 0.6231108903884888, 0.2826451063156128, 2.0323071479797363, 2.009053945541382, 0.7278242111206055, 1.9035961627960205, 0.6891380548477173, 1.2421473264694214, 0.6458539962768555, 1.8750245571136475, 0.5122313499450684, 3.878976821899414, 0.5180684328079224, 1.7689183950424194, 2.7854812145233154, 0.37502622604370117, 3.5606651306152344, 0.6679887771606445, 0.8925193548202515, 2.574854850769043, 2.16709566116333, 1.4566208124160767, 0.26417994499206543, 1.097224235534668, 1.3334013223648071, 0.835079550743103, 0.4854738712310791, 1.3633328676223755, 1.392077088356018, 0.8351699113845825, 3.5752837657928467, 1.129882574081421, 1.4011660814285278, 0.24683356285095215, 0.9045114517211914, 0.8737779855728149, 0.6806323528289795, 0.4478893280029297, 1.787780523300171, 1.0947275161743164, 0.12156367301940918, 2.270020008087158, 1.9196412563323975, 1.3996883630752563, 0.42112481594085693, 0.48267555236816406, 0.5979400873184204, 2.051337718963623, 0.33860325813293457, 0.3839946985244751, 0.1776409149169922, 1.8924543857574463, 0.4140065908432007, 1.6005232334136963, 0.048850417137145996, 0.24923837184906006], "mean_td_error": 1.150542974472046, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 475.64596697876493, "num_env_steps_trained_throughput_per_sec": 136.960557455939, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1876.006, "sample_time_ms": 1305.172, "load_time_ms": 0.526, "load_throughput": 490295.153, "learn_time_ms": 62.088, "learn_throughput": 4155.377, "synch_weights_time_ms": 14.921}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "939a2_00000", "date": "2023-11-16_22-37-59", "timestamp": 1700203079, "time_this_iter_s": 1.8981027603149414, "time_total_s": 98.46349382400513, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e08478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 98.46349382400513, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 86.45, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085062980651855, "actor_loss": -7.883982181549072, "critic_loss": 0.3219086825847626, "alpha_loss": -0.14222629368305206, "alpha_value": 0.9859963059425354, "log_alpha_value": -0.014102667570114136, "target_entropy": -6.0, "policy_t": 0.02686522901058197, "mean_q": 4.0323004722595215, "max_q": 5.272725582122803, "min_q": 3.0705506801605225}, "td_error": [0.48860740661621094, 2.2743399143218994, 0.9088070392608643, 3.7757606506347656, 0.7367446422576904, 1.1992214918136597, 1.3738622665405273, 0.3946981430053711, 0.8731032609939575, 2.496931314468384, 2.0076956748962402, 2.0694804191589355, 1.7033843994140625, 1.0958209037780762, 4.3634033203125, 0.28386974334716797, 1.7695871591567993, 0.7840464115142822, 2.535404682159424, 1.9237409830093384, 1.7737658023834229, 0.38757991790771484, 0.9659994840621948, 2.5623440742492676, 0.22034966945648193, 0.2823293209075928, 1.5155901908874512, 1.1270678043365479, 1.5330283641815186, 0.06739997863769531, 0.3125423192977905, 2.9063591957092285, 2.0333142280578613, 2.3773386478424072, 0.23646306991577148, 0.6343541145324707, 1.3133974075317383, 1.268770456314087, 3.008531332015991, 3.3632235527038574, 0.7115914821624756, 0.11978769302368164, 1.3138395547866821, 0.13733112812042236, 0.9199161529541016, 0.5495049953460693, 0.4398612976074219, 1.0039020776748657, 1.2322752475738525, 0.2921844720840454, 0.1474926471710205, 4.897761821746826, 4.383627891540527, 1.4642549753189087, 1.5461997985839844, 0.7878955602645874, 1.852882981300354, 0.09342503547668457, 0.4362192153930664, 2.0359115600585938, 1.8174359798431396, 4.366520404815674, 2.428664207458496, 3.9233620166778564, 1.2361094951629639, 1.425755262374878, 0.6911163330078125, 1.2232232093811035, 2.5902822017669678, 1.2905018329620361, 0.7234780788421631, 0.5855941772460938, 0.7791979312896729, 1.8545995950698853, 1.0770864486694336, 1.3726177215576172, 0.6975066661834717, 1.2108380794525146, 1.218902826309204, 2.271162986755371, 0.8233758211135864, 1.988553762435913, 1.0626895427703857, 0.8375768661499023, 1.372739553451538, 3.1803810596466064], "mean_td_error": 1.480969786643982, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068760871887207, "actor_loss": -7.095120429992676, "critic_loss": 0.19126303493976593, "alpha_loss": -0.14213190972805023, "alpha_value": 0.9859830141067505, "log_alpha_value": -0.014116127043962479, "target_entropy": -6.0, "policy_t": 0.002726890379562974, "mean_q": 3.1393442153930664, "max_q": 4.337516784667969, "min_q": 2.253366470336914}, "td_error": [0.2919570207595825, 0.4444997310638428, 1.5992625951766968, 0.2981034517288208, 1.5442299842834473, 0.17024445533752441, 0.2693915367126465, 2.4429826736450195, 2.3500866889953613, 0.37055492401123047, 1.1872543096542358, 1.7686213254928589, 2.0834150314331055, 1.0600459575653076, 0.5288690328598022, 1.8456264734268188, 0.5889617204666138, 0.6238225698471069, 1.276113510131836, 0.9324710369110107, 1.2323487997055054, 0.6119650602340698, 0.08679354190826416, 2.505612850189209, 2.6767172813415527, 1.9810959100723267, 1.185081124305725, 1.4652869701385498, 1.3045982122421265, 1.400148868560791, 0.6594518423080444, 0.30670368671417236, 1.4162389039993286, 2.2307636737823486, 0.33245742321014404, 0.611101508140564, 0.6026178598403931, 0.274432897567749, 0.8863257169723511, 1.5891733169555664, 0.2565732002258301, 0.1218869686126709, 2.5327401161193848, 1.7866045236587524, 1.7816258668899536, 0.8194599151611328, 0.41604721546173096, 0.19707059860229492, 0.19634199142456055, 0.3794093132019043, 0.5768958330154419, 0.9169900417327881, 0.907934308052063, 1.7512539625167847, 0.0551145076751709, 2.208970069885254, 0.6518442630767822, 2.064380168914795, 0.641318678855896, 1.3577226400375366, 2.205655574798584, 1.6995455026626587, 2.2490930557250977, 0.29175078868865967, 1.653867244720459, 1.0731867551803589, 0.7240921258926392, 0.3422229290008545, 2.783148765563965, 0.18995285034179688, 1.0116771459579468, 1.497797966003418, 0.09589231014251709, 0.07163739204406738, 1.2123525142669678, 1.082329511642456, 0.17423665523529053, 0.8271445035934448, 0.3496403694152832, 0.16717088222503662, 2.6986939907073975, 0.7688947916030884, 0.5799504518508911, 1.569973349571228, 1.3254189491271973, 0.25026965141296387], "mean_td_error": 1.0645489692687988, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0715913772583, "actor_loss": -7.207975387573242, "critic_loss": 0.25291720032691956, "alpha_loss": -0.14202508330345154, "alpha_value": 0.9859973788261414, "log_alpha_value": -0.01410155463963747, "target_entropy": -6.0, "policy_t": -0.05691101402044296, "mean_q": 3.290626287460327, "max_q": 4.162032604217529, "min_q": 2.5368425846099854}, "td_error": [0.36166083812713623, 0.35759854316711426, 0.9790530204772949, 0.6990355253219604, 0.1662236452102661, 0.8421270847320557, 0.07770800590515137, 1.8114019632339478, 0.743614912033081, 0.215873122215271, 0.12027263641357422, 2.587691307067871, 0.150365948677063, 1.1207844018936157, 0.47987794876098633, 1.0644843578338623, 1.530124306678772, 1.1150270700454712, 0.6972769498825073, 1.4198260307312012, 0.9315043687820435, 0.49212563037872314, 1.6898177862167358, 1.1472697257995605, 1.0663964748382568, 0.04495406150817871, 0.1710188388824463, 0.41453444957733154, 1.714507818222046, 2.791602849960327, 0.5984011888504028, 0.044812560081481934, 1.2778164148330688, 1.6514884233474731, 3.918248176574707, 0.07651185989379883, 0.8649741411209106, 0.8888745307922363, 1.7403035163879395, 1.1162400245666504, 1.5173285007476807, 0.7151037454605103, 0.7094864845275879, 0.7043275833129883, 1.1674307584762573, 1.9088860750198364, 0.12677478790283203, 2.093310594558716, 1.1874563694000244, 0.672968864440918, 0.3437228202819824, 1.1737017631530762, 1.8350040912628174, 1.836974024772644, 0.43622398376464844, 3.3650426864624023, 3.116037130355835, 1.0916146039962769, 1.4503941535949707, 1.797293782234192, 0.9279440641403198, 0.18512797355651855, 0.17509019374847412, 0.5989691019058228, 1.1045790910720825, 0.18833017349243164, 0.8863059282302856, 2.842146873474121, 0.9074447154998779, 0.7475935220718384, 0.36029136180877686, 1.8170584440231323, 1.5659152269363403, 3.2395694255828857, 1.6011611223220825, 1.2633413076400757, 0.6588189601898193, 0.41209876537323, 1.0619357824325562, 2.7942280769348145, 0.3633303642272949, 0.6697319746017456, 0.11683917045593262, 2.577279806137085, 0.4705026149749756, 0.48749756813049316], "mean_td_error": 1.098298192024231, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 416.75179296816475, "num_env_steps_trained_throughput_per_sec": 120.00219038592245, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1900.903, "sample_time_ms": 1329.876, "load_time_ms": 0.529, "load_throughput": 487907.675, "learn_time_ms": 61.964, "learn_throughput": 4163.694, "synch_weights_time_ms": 15.343}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-01", "timestamp": 1700203081, "time_this_iter_s": 2.1636109352111816, "time_total_s": 100.62710475921631, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.62710475921631, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 76.5, "ram_util_percent": 92.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049116134643555, "actor_loss": -8.003206253051758, "critic_loss": 0.26972752809524536, "alpha_loss": -0.14473417401313782, "alpha_value": 0.9857005476951599, "log_alpha_value": -0.014402677305042744, "target_entropy": -6.0, "policy_t": 0.004605485592037439, "mean_q": 4.145467281341553, "max_q": 5.308725357055664, "min_q": 3.3173089027404785}, "td_error": [0.9934902191162109, 0.9028456211090088, 1.5246334075927734, 1.6076023578643799, 0.6822030544281006, 0.327980637550354, 2.088898181915283, 0.646294116973877, 0.21784234046936035, 0.15307366847991943, 0.24673497676849365, 0.806670069694519, 0.7662888765335083, 1.0285704135894775, 0.214821457862854, 2.487269639968872, 0.3224329948425293, 2.461703062057495, 1.3104485273361206, 2.5965399742126465, 0.13043689727783203, 0.4772214889526367, 0.5937892198562622, 3.27664852142334, 0.21332597732543945, 4.322425842285156, 6.34886360168457, 0.38661181926727295, 2.086484909057617, 0.05397605895996094, 2.54601788520813, 0.21906888484954834, 0.5344568490982056, 2.261399745941162, 0.633880615234375, 0.6531102657318115, 1.708597183227539, 1.9222235679626465, 0.7851814031600952, 1.3395885229110718, 0.008573055267333984, 1.6109967231750488, 0.8134132623672485, 2.447742462158203, 0.3472471237182617, 1.3069047927856445, 1.5142052173614502, 0.6989824771881104, 0.826805830001831, 0.04667627811431885, 1.617276906967163, 0.2198563814163208, 1.383838176727295, 2.0948243141174316, 0.12176239490509033, 1.7146048545837402, 1.9756730794906616, 3.1985533237457275, 0.6534826755523682, 0.3250439167022705, 1.6071274280548096, 0.8489370346069336, 1.1554014682769775, 0.8656864166259766, 2.05961275100708, 0.8922538757324219, 0.1755213737487793, 4.106314659118652, 0.977669358253479, 0.15812325477600098, 0.38965559005737305, 0.8622245788574219, 2.115992784500122, 2.4009907245635986, 0.42194855213165283, 0.32508158683776855, 4.0902862548828125, 0.44342708587646484, 1.281467318534851, 3.9339261054992676, 1.285864233970642, 0.9345746040344238, 1.45866060256958, 0.40062105655670166, 0.4455101490020752, 0.25212597846984863], "mean_td_error": 1.2638968229293823, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132963180541992, "actor_loss": -7.221426486968994, "critic_loss": 0.24014031887054443, "alpha_loss": -0.14608299732208252, "alpha_value": 0.9856868386268616, "log_alpha_value": -0.014416610822081566, "target_entropy": -6.0, "policy_t": -0.021655045449733734, "mean_q": 3.260643243789673, "max_q": 4.1944050788879395, "min_q": 2.2376556396484375}, "td_error": [3.0748491287231445, 2.621068239212036, 0.38875246047973633, 2.694744825363159, 1.8312177658081055, 0.9628599882125854, 3.579768657684326, 0.08578145503997803, 0.08317577838897705, 0.0942995548248291, 1.1487630605697632, 2.0183398723602295, 0.1185981035232544, 0.5299817323684692, 0.9430360794067383, 0.39068055152893066, 1.1028358936309814, 0.9100786447525024, 0.7617906332015991, 0.7210749387741089, 0.9722721576690674, 0.38864684104919434, 1.5419609546661377, 1.689375638961792, 1.6353598833084106, 0.1780097484588623, 0.9980610609054565, 0.25313234329223633, 0.550858736038208, 1.0526580810546875, 1.7249356508255005, 3.0318691730499268, 0.3431798219680786, 0.19903647899627686, 0.05018496513366699, 0.6027944087982178, 2.1123456954956055, 4.312159061431885, 2.58158802986145, 2.4835619926452637, 0.16811490058898926, 0.7940024137496948, 0.6391353607177734, 1.1196719408035278, 1.8564602136611938, 0.7726044654846191, 4.294580459594727, 0.1946864128112793, 0.8145396709442139, 2.133280038833618, 0.7231423854827881, 0.5872533321380615, 1.7874376773834229, 0.5272951126098633, 1.4616011381149292, 0.564643383026123, 0.39663469791412354, 0.8277124166488647, 0.6023432016372681, 3.823009490966797, 0.8554433584213257, 0.13365530967712402, 0.7284277677536011, 1.3742016553878784, 1.085414171218872, 0.5029892921447754, 3.502967357635498, 0.5799397230148315, 0.798133134841919, 2.0052132606506348, 1.4933828115463257, 4.017222881317139, 0.4361739158630371, 0.8787449598312378, 0.39519500732421875, 0.5842349529266357, 2.3612220287323, 1.1443443298339844, 0.49219799041748047, 0.6948064565658569, 1.0478579998016357, 0.2581300735473633, 2.682234764099121, 0.2609219551086426, 0.5798264741897583, 2.9317402839660645], "mean_td_error": 1.2404239177703857, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100895881652832, "actor_loss": -7.110264301300049, "critic_loss": 0.2822287678718567, "alpha_loss": -0.14546813070774078, "alpha_value": 0.9857016801834106, "log_alpha_value": -0.014401507563889027, "target_entropy": -6.0, "policy_t": -0.025437379255890846, "mean_q": 3.1947357654571533, "max_q": 4.146552562713623, "min_q": 2.442857265472412}, "td_error": [0.8432979583740234, 0.13408958911895752, 2.1281986236572266, 1.989001989364624, 1.3790968656539917, 0.5355194807052612, 0.23110592365264893, 1.604821801185608, 0.9059650897979736, 4.51284122467041, 1.5195002555847168, 2.187954902648926, 3.2696194648742676, 1.8793821334838867, 1.0429539680480957, 1.2134103775024414, 0.21045136451721191, 0.6167949438095093, 0.6455913782119751, 2.1067700386047363, 3.0013556480407715, 0.3066229820251465, 2.0942866802215576, 0.09178614616394043, 0.15230607986450195, 1.3008840084075928, 0.13900768756866455, 1.452438473701477, 0.8064055442810059, 1.3590179681777954, 2.235434055328369, 3.2743475437164307, 0.31740081310272217, 0.2588006258010864, 0.11499273777008057, 1.3190569877624512, 1.633205771446228, 0.5576789379119873, 0.891355037689209, 1.357343316078186, 2.213613986968994, 0.8537130355834961, 0.14148271083831787, 0.8962929248809814, 0.1075202226638794, 2.5431551933288574, 0.08656835556030273, 0.8807252645492554, 0.7960044145584106, 0.9111889600753784, 1.640920639038086, 1.2222524881362915, 1.571772813796997, 0.47735297679901123, 1.651437759399414, 0.7045577764511108, 1.5365033149719238, 1.1407971382141113, 0.9304779767990112, 0.4081761837005615, 0.8289872407913208, 1.2226059436798096, 2.199697256088257, 1.7780840396881104, 0.650733470916748, 0.13540971279144287, 2.2123823165893555, 0.4517561197280884, 1.4596762657165527, 0.24547266960144043, 1.5433440208435059, 0.3393259048461914, 0.20006942749023438, 0.22202026844024658, 2.307413101196289, 0.36437666416168213, 1.5037274360656738, 0.12533962726593018, 0.3549830913543701, 1.1459872722625732, 2.2901558876037598, 0.9786807298660278, 1.865993857383728, 1.4358551502227783, 1.6536556482315063, 1.93936288356781], "mean_td_error": 1.1836012601852417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 447.88510027697134, "num_env_steps_trained_throughput_per_sec": 128.96691503511005, "timesteps_total": 44800, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 134400, "timers": {"training_iteration_time_ms": 1899.346, "sample_time_ms": 1329.136, "load_time_ms": 0.532, "load_throughput": 484782.023, "learn_time_ms": 62.174, "learn_throughput": 4149.671, "synch_weights_time_ms": 15.155}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 12642, "num_agent_steps_sampled": 134400, "num_agent_steps_trained": 12642, "last_target_update_ts": 44800, "num_target_updates": 49}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-03", "timestamp": 1700203083, "time_this_iter_s": 2.0178160667419434, "time_total_s": 102.64492082595825, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07370d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.64492082595825, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 71.3, "ram_util_percent": 92.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115779876708984, "actor_loss": -8.123764038085938, "critic_loss": 0.37146687507629395, "alpha_loss": -0.14872822165489197, "alpha_value": 0.9854049682617188, "log_alpha_value": -0.01470259390771389, "target_entropy": -6.0, "policy_t": 0.0065277148969471455, "mean_q": 4.264525413513184, "max_q": 5.7731146812438965, "min_q": 3.4455132484436035}, "td_error": [1.022184133529663, 2.8701395988464355, 1.3994851112365723, 3.1437504291534424, 0.6176841259002686, 1.624221682548523, 0.5720047950744629, 1.0391647815704346, 2.5637214183807373, 1.987046718597412, 0.40918564796447754, 3.7708566188812256, 0.5161819458007812, 2.3650851249694824, 1.4814817905426025, 2.648418426513672, 1.0709517002105713, 0.764643669128418, 0.410957932472229, 0.7543296813964844, 2.893435478210449, 4.217895030975342, 0.9471185207366943, 0.8750795125961304, 0.3506733179092407, 4.921058654785156, 0.4632852077484131, 1.4869823455810547, 1.5468692779541016, 0.3745766878128052, 1.4444665908813477, 1.437486171722412, 1.7896897792816162, 2.0851709842681885, 0.6758159399032593, 0.7958425283432007, 3.3217620849609375, 2.0645363330841064, 2.5146448612213135, 0.21571433544158936, 0.6372109651565552, 4.68056583404541, 0.24889826774597168, 1.3891704082489014, 0.4276149272918701, 1.6200282573699951, 0.7348105907440186, 0.8573063611984253, 2.696715831756592, 6.548311710357666, 1.105130672454834, 0.5883958339691162, 0.5778673887252808, 0.2629091739654541, 5.553380489349365, 1.1574428081512451, 0.9916012287139893, 0.24833416938781738, 1.661879062652588, 1.2681388854980469, 1.277605652809143, 0.0872201919555664, 2.1599862575531006, 5.717466831207275, 3.220921754837036, 0.48613429069519043, 0.9015109539031982, 0.27894043922424316, 2.258443593978882, 1.2708256244659424, 0.05151939392089844, 0.08028721809387207, 0.8735225200653076, 0.8867638111114502, 1.3415732383728027, 0.978402853012085, 6.8089070320129395, 1.3982146978378296, 0.7458605766296387, 1.7749645709991455, 4.009888648986816, 1.6241693496704102, 0.24048268795013428, 1.416256070137024, 0.46953463554382324, 1.7052170038223267], "mean_td_error": 1.6369061470031738, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090632438659668, "actor_loss": -7.072105884552002, "critic_loss": 0.23517942428588867, "alpha_loss": -0.14850541949272156, "alpha_value": 0.9853906035423279, "log_alpha_value": -0.014717156067490578, "target_entropy": -6.0, "policy_t": 0.020744647830724716, "mean_q": 3.0446794033050537, "max_q": 4.1714301109313965, "min_q": 2.195564031600952}, "td_error": [2.960240364074707, 1.6092169284820557, 0.724372386932373, 1.171769380569458, 0.21712756156921387, 2.0433754920959473, 0.19883334636688232, 2.184264898300171, 0.6217479705810547, 1.269658088684082, 1.4001102447509766, 1.5921212434768677, 1.093864917755127, 0.6065725088119507, 0.7527705430984497, 0.27916038036346436, 2.2847440242767334, 1.9665476083755493, 0.15849053859710693, 1.5174474716186523, 1.977526068687439, 1.743638277053833, 0.915976881980896, 5.326995849609375, 1.118035912513733, 0.18770551681518555, 4.211359977722168, 0.5031819343566895, 0.09402203559875488, 0.9950331449508667, 1.1465461254119873, 0.4861658811569214, 1.0740431547164917, 0.7665767669677734, 0.07268881797790527, 0.4101787805557251, 1.5184804201126099, 1.3352913856506348, 0.8352183103561401, 1.0565561056137085, 1.6574698686599731, 2.747150182723999, 0.7787138223648071, 0.529044508934021, 0.3684957027435303, 0.9830043315887451, 3.2865684032440186, 2.717205047607422, 1.1553983688354492, 0.36970818042755127, 2.1391499042510986, 0.2667883634567261, 1.9064747095108032, 1.0220613479614258, 2.077066421508789, 0.6615769863128662, 0.7048786878585815, 1.4457844495773315, 3.0490365028381348, 0.7060856819152832, 1.0906412601470947, 0.4194815158843994, 0.4426994323730469, 0.27065837383270264, 1.1663062572479248, 0.2687758207321167, 4.616582870483398, 0.5457983016967773, 0.23560070991516113, 1.7300806045532227, 0.5367757081985474, 0.4174381494522095, 1.878434658050537, 0.8885810375213623, 0.03967249393463135, 0.08577513694763184, 0.447554349899292, 0.0022819042205810547, 1.1621111631393433, 2.0981876850128174, 3.433326482772827, 1.1701431274414062, 0.17520105838775635, 1.710754156112671, 0.6140482425689697, 2.8900530338287354], "mean_td_error": 1.2480963468551636, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113499641418457, "actor_loss": -7.172995567321777, "critic_loss": 0.3063009977340698, "alpha_loss": -0.14868365228176117, "alpha_value": 0.9854060411453247, "log_alpha_value": -0.014701503328979015, "target_entropy": -6.0, "policy_t": 0.0006080625462345779, "mean_q": 3.222234010696411, "max_q": 4.330224990844727, "min_q": 2.364931106567383}, "td_error": [0.3458184003829956, 0.9660392999649048, 0.45540285110473633, 0.375799298286438, 0.5650204420089722, 0.9578979015350342, 0.7975010871887207, 1.6738131046295166, 0.17436563968658447, 1.6985013484954834, 2.5483574867248535, 1.6683295965194702, 1.3193700313568115, 1.4539673328399658, 3.260936737060547, 1.7809131145477295, 0.28762340545654297, 1.0111817121505737, 1.2464768886566162, 0.3293724060058594, 0.5984052419662476, 0.4413948059082031, 0.9768373966217041, 2.0279688835144043, 0.9578315019607544, 0.7825920581817627, 3.5266337394714355, 0.5324790477752686, 0.8954290151596069, 0.3833038806915283, 0.8919723033905029, 2.5687637329101562, 1.2391364574432373, 1.5499272346496582, 0.5155181884765625, 0.07436215877532959, 1.8096253871917725, 0.08661317825317383, 1.1070877313613892, 2.434117078781128, 3.368443489074707, 0.3487304449081421, 0.08408594131469727, 3.188991069793701, 1.7271232604980469, 0.8547524213790894, 1.27776038646698, 0.19896912574768066, 0.44761765003204346, 1.5884547233581543, 0.18113327026367188, 2.2939186096191406, 0.9337325096130371, 0.8039511442184448, 1.4880478382110596, 1.4509910345077515, 1.0653373003005981, 0.7836720943450928, 2.1778666973114014, 1.3770928382873535, 1.6512484550476074, 0.5780603885650635, 2.087190628051758, 1.973352313041687, 5.035208702087402, 0.2691655158996582, 2.511410713195801, 2.2192225456237793, 3.7544894218444824, 0.11092305183410645, 0.3938889503479004, 1.4560325145721436, 0.1510629653930664, 0.17628633975982666, 1.131435513496399, 0.18076753616333008, 0.9224824905395508, 1.2625707387924194, 2.00357723236084, 0.9514797925949097, 2.0668647289276123, 0.12064599990844727, 0.7184402942657471, 3.9216442108154297, 0.48425865173339844, 0.8455220460891724], "mean_td_error": 1.26668119430542, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 362.88365020303775, "num_env_steps_trained_throughput_per_sec": 104.49105106292828, "timesteps_total": 45696, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 137088, "timers": {"training_iteration_time_ms": 1960.401, "sample_time_ms": 1356.443, "load_time_ms": 0.531, "load_throughput": 485892.161, "learn_time_ms": 62.252, "learn_throughput": 4144.437, "synch_weights_time_ms": 15.222}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-05", "timestamp": 1700203085, "time_this_iter_s": 2.4876391887664795, "time_total_s": 105.13256001472473, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 105.13256001472473, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 63.8, "ram_util_percent": 92.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.148290634155273, "actor_loss": -8.169596672058105, "critic_loss": 0.384005069732666, "alpha_loss": -0.15225057303905487, "alpha_value": 0.9851093888282776, "log_alpha_value": -0.01500258594751358, "target_entropy": -6.0, "policy_t": -0.0508258193731308, "mean_q": 4.354501247406006, "max_q": 5.7919135093688965, "min_q": 3.3278324604034424}, "td_error": [0.8895038366317749, 0.29155540466308594, 5.792083263397217, 1.9720335006713867, 2.966856002807617, 0.6527004241943359, 1.3096444606781006, 0.30545854568481445, 1.7527166604995728, 1.3884007930755615, 0.25179266929626465, 4.007994651794434, 1.9230728149414062, 1.0087127685546875, 1.194664478302002, 2.6656646728515625, 4.922476768493652, 2.5775606632232666, 0.94938063621521, 2.2064037322998047, 4.995340824127197, 2.7892019748687744, 0.5382015705108643, 1.6805849075317383, 1.673781156539917, 0.39525532722473145, 1.686922550201416, 2.3008220195770264, 0.3978133201599121, 2.9364635944366455, 4.094807147979736, 1.7250882387161255, 0.23521161079406738, 1.5440752506256104, 1.2423710823059082, 1.0172691345214844, 1.1024110317230225, 1.4204812049865723, 1.7722326517105103, 0.7121603488922119, 4.883378982543945, 0.8908934593200684, 0.582080602645874, 2.5067429542541504, 1.3169121742248535, 1.804375171661377, 1.3458733558654785, 3.138451099395752, 0.43976545333862305, 3.0358684062957764, 0.3336665630340576, 1.6008763313293457, 2.877246856689453, 0.967118501663208, 3.080413818359375, 3.307326316833496, 0.32533085346221924, 0.4131354093551636, 0.44409847259521484, 1.1550372838974, 3.7638683319091797, 1.9476993083953857, 0.0530853271484375, 0.67177414894104, 4.976046562194824, 0.5778963565826416, 1.503670334815979, 0.40610742568969727, 1.2478151321411133, 2.0721726417541504, 0.5715258121490479, 0.12213420867919922, 0.7044957876205444, 1.5448304414749146, 1.967329740524292, 1.608325481414795, 0.22516870498657227, 1.1303491592407227, 3.158163070678711, 0.30238568782806396, 1.7499985694885254, 1.1476919651031494, 2.9638333320617676, 0.622921347618103, 0.8033063411712646, 0.2705425024032593], "mean_td_error": 1.6726847887039185, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053662300109863, "actor_loss": -6.8395514488220215, "critic_loss": 0.14668244123458862, "alpha_loss": -0.15098240971565247, "alpha_value": 0.9850945472717285, "log_alpha_value": -0.015017653815448284, "target_entropy": -6.0, "policy_t": -0.016874678432941437, "mean_q": 2.8498246669769287, "max_q": 3.9912893772125244, "min_q": 2.117527484893799}, "td_error": [0.36242783069610596, 0.7609078884124756, 1.6499227285385132, 1.3450311422348022, 1.2722585201263428, 0.08581125736236572, 0.07899034023284912, 1.0912246704101562, 0.07440686225891113, 1.04716157913208, 0.1825956106185913, 0.1281524896621704, 2.6939454078674316, 0.5941950082778931, 0.500231146812439, 0.899437427520752, 2.661881446838379, 5.083505630493164, 0.16732358932495117, 0.5411324501037598, 0.3588036298751831, 0.2637295722961426, 3.416806221008301, 0.7464053630828857, 0.37815892696380615, 0.5745141506195068, 1.8062236309051514, 0.3391348123550415, 1.3861490488052368, 0.8989980220794678, 1.2259706258773804, 0.7999547719955444, 0.20911145210266113, 2.6164627075195312, 0.8216160535812378, 0.5188601016998291, 1.0325242280960083, 1.7316292524337769, 1.118467926979065, 0.7259663343429565, 1.8985964059829712, 2.1783413887023926, 1.6684330701828003, 0.33693766593933105, 3.6350982189178467, 1.927779197692871, 0.6150274276733398, 1.4955953359603882, 0.6361701488494873, 0.23129642009735107, 1.89183509349823, 0.9073876142501831, 2.5005221366882324, 0.5327026844024658, 2.281744956970215, 0.3640177249908447, 0.3910973072052002, 1.5200908184051514, 1.248583197593689, 1.1677594184875488, 0.5740097761154175, 0.37228357791900635, 1.273967981338501, 1.5757195949554443, 0.339699387550354, 0.33242499828338623, 0.2925870418548584, 0.07251501083374023, 1.1400409936904907, 0.9014965295791626, 0.7237100601196289, 0.9497796297073364, 1.255828619003296, 0.9772340059280396, 2.1572327613830566, 0.7127282619476318, 1.01522696018219, 0.26513350009918213, 1.093272089958191, 0.43726229667663574, 1.03516685962677, 0.8891197443008423, 0.5869971513748169, 0.9446425437927246, 0.4801607131958008, 0.618526816368103], "mean_td_error": 1.0539050102233887, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079824447631836, "actor_loss": -7.101924419403076, "critic_loss": 0.28880852460861206, "alpha_loss": -0.1512131541967392, "alpha_value": 0.9851104021072388, "log_alpha_value": -0.015001567080616951, "target_entropy": -6.0, "policy_t": 0.033044733107089996, "mean_q": 3.233167886734009, "max_q": 4.267362594604492, "min_q": 2.4889631271362305}, "td_error": [1.0757311582565308, 1.5452792644500732, 0.6528342962265015, 0.4047178030014038, 0.5421880483627319, 2.381101608276367, 0.11622607707977295, 0.48647260665893555, 0.9549777507781982, 1.5386258363723755, 4.133547782897949, 0.14448761940002441, 0.5781451463699341, 1.912657380104065, 0.8203409910202026, 0.6521540880203247, 0.044274091720581055, 2.180187940597534, 0.24356985092163086, 1.8661998510360718, 0.5487462282180786, 2.215902328491211, 0.2106684446334839, 0.5495578050613403, 0.12103009223937988, 0.3341329097747803, 1.6373776197433472, 0.28129053115844727, 0.15306735038757324, 0.36132311820983887, 1.0171607732772827, 0.43176496028900146, 1.7521132230758667, 0.8223925828933716, 0.27081823348999023, 1.6489404439926147, 3.5148520469665527, 1.3286091089248657, 0.5834459066390991, 0.6336733102798462, 3.027679920196533, 3.1339619159698486, 2.992600917816162, 0.3979306221008301, 2.0404677391052246, 0.49075353145599365, 0.14774048328399658, 1.1309903860092163, 0.9898734092712402, 4.010052680969238, 0.1722506284713745, 2.977445363998413, 0.2808624505996704, 0.1941227912902832, 1.3570561408996582, 1.1791858673095703, 0.4003174304962158, 2.068990707397461, 0.28552138805389404, 1.4683173894882202, 1.0623197555541992, 0.36605989933013916, 3.088634490966797, 2.0842771530151367, 2.541672706604004, 0.5503120422363281, 0.5902479887008667, 0.8535852432250977, 0.2498701810836792, 1.7494322061538696, 0.532349705696106, 1.8215423822402954, 2.782073974609375, 0.992967963218689, 0.8104845285415649, 2.334247350692749, 0.2662910223007202, 1.7312910556793213, 1.2105867862701416, 1.7984507083892822, 0.382593035697937, 0.5784547328948975, 0.9573332071304321, 2.3379361629486084, 0.5699158906936646, 1.2564568519592285], "mean_td_error": 1.1969313621520996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 440.6720726370299, "num_env_steps_trained_throughput_per_sec": 126.88994948700191, "timesteps_total": 46592, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1978.4, "sample_time_ms": 1373.344, "load_time_ms": 0.531, "load_throughput": 485979.446, "learn_time_ms": 62.325, "learn_throughput": 4139.577, "synch_weights_time_ms": 15.32}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-08", "timestamp": 1700203088, "time_this_iter_s": 2.0504302978515625, "time_total_s": 107.1829903125763, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e08478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.1829903125763, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 73.56666666666666, "ram_util_percent": 92.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113544464111328, "actor_loss": -8.235821723937988, "critic_loss": 0.3471183776855469, "alpha_loss": -0.15476474165916443, "alpha_value": 0.9848137497901917, "log_alpha_value": -0.01530272327363491, "target_entropy": -6.0, "policy_t": 0.0040137008763849735, "mean_q": 4.419423580169678, "max_q": 5.4597649574279785, "min_q": 3.6028289794921875}, "td_error": [1.579599380493164, 1.5615907907485962, 0.3381427526473999, 2.523402214050293, 0.9759254455566406, 2.744076728820801, 1.1935325860977173, 0.2567253112792969, 0.8859763145446777, 1.0612459182739258, 1.4564173221588135, 2.7555696964263916, 0.7774655818939209, 0.5491461753845215, 0.28406822681427, 0.9171813726425171, 3.764322280883789, 0.4553403854370117, 4.7294020652771, 4.699644088745117, 0.8479349613189697, 0.7796013355255127, 0.5812360048294067, 0.7664121389389038, 2.213350534439087, 0.21858417987823486, 0.39544248580932617, 0.07479441165924072, 3.2266926765441895, 2.244955062866211, 2.7318785190582275, 0.4813694953918457, 0.6920526027679443, 7.153676986694336, 0.8165533542633057, 2.58724045753479, 2.225594997406006, 0.12839996814727783, 0.9177780151367188, 0.80548095703125, 0.33074522018432617, 4.139107704162598, 3.094085454940796, 0.1765981912612915, 0.1672074794769287, 3.651711940765381, 0.15140974521636963, 0.668236494064331, 1.0233423709869385, 2.863302230834961, 4.08677864074707, 0.7563043832778931, 0.2527885437011719, 0.3447844982147217, 2.678243637084961, 1.6849474906921387, 0.08882403373718262, 0.4690423011779785, 1.6982488632202148, 2.4685258865356445, 0.6349101066589355, 1.8138349056243896, 0.3221743106842041, 0.8988308906555176, 2.919638156890869, 1.1771812438964844, 0.737074613571167, 0.30015480518341064, 0.8574068546295166, 2.337731122970581, 0.5156075954437256, 0.41167163848876953, 0.30666863918304443, 3.2861385345458984, 0.49440813064575195, 0.8793039321899414, 4.069594383239746, 3.6796371936798096, 1.1358156204223633, 2.126823663711548, 0.9092674255371094, 0.36345577239990234, 0.8164621591567993, 2.4674665927886963, 1.8387666940689087, 1.9583690166473389], "mean_td_error": 1.5284932851791382, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07927417755127, "actor_loss": -6.820408344268799, "critic_loss": 0.1950298696756363, "alpha_loss": -0.15439456701278687, "alpha_value": 0.9847987294197083, "log_alpha_value": -0.015318021178245544, "target_entropy": -6.0, "policy_t": -0.03448837995529175, "mean_q": 2.8353989124298096, "max_q": 4.042087078094482, "min_q": 1.950311303138733}, "td_error": [0.9061279296875, 2.514357328414917, 1.124045968055725, 1.4747934341430664, 3.504934310913086, 0.6724411249160767, 3.085956335067749, 2.314411163330078, 1.9197982549667358, 1.3996480703353882, 1.0307668447494507, 0.38840508460998535, 0.37177276611328125, 1.2882094383239746, 0.42732858657836914, 0.5021265745162964, 1.4040918350219727, 3.338496208190918, 0.21140384674072266, 1.1668877601623535, 2.0372657775878906, 0.23070240020751953, 0.15063095092773438, 0.3404350280761719, 1.742781639099121, 1.610908031463623, 2.1616272926330566, 0.34526318311691284, 1.5188289880752563, 0.6248632669448853, 0.14664137363433838, 0.49423933029174805, 0.40845799446105957, 0.635079026222229, 0.37019777297973633, 1.9839410781860352, 1.124451756477356, 2.405453681945801, 1.8963621854782104, 2.003221035003662, 1.995873212814331, 1.5449981689453125, 0.4804508686065674, 1.1707797050476074, 0.31541013717651367, 0.80063796043396, 0.47510647773742676, 0.6228237152099609, 1.151075839996338, 2.2934703826904297, 1.0495063066482544, 1.2244465351104736, 0.9293169975280762, 0.36757218837738037, 1.3404208421707153, 0.2714637517929077, 0.4769437313079834, 0.60141921043396, 3.729292392730713, 1.4954949617385864, 3.8711509704589844, 2.155752182006836, 1.4156625270843506, 0.9697072505950928, 0.47427451610565186, 0.9016162157058716, 0.10770583152770996, 0.08932995796203613, 0.9956598281860352, 0.43436193466186523, 0.839313268661499, 4.326961517333984, 2.476372241973877, 0.6774981021881104, 1.5355417728424072, 0.9835240840911865, 0.5745929479598999, 1.2602565288543701, 0.12192511558532715, 1.2987966537475586, 2.709406852722168, 2.002742290496826, 1.3690927028656006, 0.6700482368469238, 1.9654064178466797, 1.2710041999816895], "mean_td_error": 1.268739104270935, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112653732299805, "actor_loss": -6.918240547180176, "critic_loss": 0.303410142660141, "alpha_loss": -0.1547398865222931, "alpha_value": 0.9848148822784424, "log_alpha_value": -0.015301610343158245, "target_entropy": -6.0, "policy_t": 0.019592268392443657, "mean_q": 3.0307564735412598, "max_q": 4.032456398010254, "min_q": 2.4587013721466064}, "td_error": [0.6193546056747437, 0.5952233076095581, 1.4299236536026, 2.292630195617676, 0.6142730712890625, 1.7664964199066162, 0.7625364065170288, 0.9742227792739868, 1.934619665145874, 1.4846248626708984, 1.3730262517929077, 0.07938361167907715, 1.3349343538284302, 0.22848403453826904, 2.9210033416748047, 0.8035029172897339, 3.338934898376465, 0.5979903936386108, 1.504490852355957, 1.7514610290527344, 0.6344931125640869, 2.132622003555298, 0.7550926208496094, 1.4953358173370361, 0.6886476278305054, 1.1425470113754272, 0.43122386932373047, 1.7049450874328613, 0.9926173686981201, 0.45545268058776855, 1.2170038223266602, 0.06457459926605225, 1.8856151103973389, 5.589040756225586, 0.8455568552017212, 0.616023063659668, 3.965557098388672, 2.0811166763305664, 0.7730190753936768, 1.7448043823242188, 0.9754348993301392, 0.3782517910003662, 1.0125927925109863, 1.3056268692016602, 1.187254548072815, 1.8834642171859741, 0.1274045705795288, 1.1627702713012695, 1.3458330631256104, 0.7754440307617188, 1.8614332675933838, 0.5069817304611206, 3.5654478073120117, 0.6138942241668701, 1.1788662672042847, 2.46773624420166, 2.5549447536468506, 1.310648798942566, 0.8450360298156738, 0.6724053621292114, 0.9572813510894775, 2.078810214996338, 0.5323323011398315, 0.5389426946640015, 0.7377732992172241, 4.054828643798828, 0.9095591306686401, 0.17132508754730225, 2.95820951461792, 1.2763488292694092, 1.1196963787078857, 0.4679161310195923, 0.1935594081878662, 1.0027058124542236, 0.7611984014511108, 0.715567946434021, 0.46249163150787354, 0.08292746543884277, 1.1917537450790405, 2.5367159843444824, 0.6476455926895142, 0.9637981653213501, 1.412733793258667, 1.2740854024887085, 1.0935351848602295, 0.28324317932128906], "mean_td_error": 1.2764984369277954, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 418.2587154288767, "num_env_steps_trained_throughput_per_sec": 120.43610332661851, "timesteps_total": 47488, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 142464, "timers": {"training_iteration_time_ms": 2007.619, "sample_time_ms": 1402.882, "load_time_ms": 0.533, "load_throughput": 484239.689, "learn_time_ms": 62.335, "learn_throughput": 4138.907, "synch_weights_time_ms": 15.448}, "counters": {"num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-10", "timestamp": 1700203090, "time_this_iter_s": 2.1564249992370605, "time_total_s": 109.33941531181335, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 109.33941531181335, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 76.73333333333333, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028017044067383, "actor_loss": -8.153304100036621, "critic_loss": 0.30816906690597534, "alpha_loss": -0.15646621584892273, "alpha_value": 0.9845181703567505, "log_alpha_value": -0.015602905303239822, "target_entropy": -6.0, "policy_t": -0.017305554822087288, "mean_q": 4.37058162689209, "max_q": 5.7222065925598145, "min_q": 3.547887086868286}, "td_error": [0.6139179468154907, 1.802720069885254, 0.44034266471862793, 0.9207336902618408, 0.057680606842041016, 2.527017116546631, 0.31658828258514404, 2.187033176422119, 2.598630905151367, 1.3995823860168457, 1.3480877876281738, 0.4117884635925293, 0.2813272476196289, 0.9572021961212158, 0.709662914276123, 0.07126784324645996, 2.7308807373046875, 0.6413142681121826, 1.6565098762512207, 1.6961050033569336, 1.9461073875427246, 0.9651196002960205, 0.40036702156066895, 0.7303643226623535, 2.330061912536621, 0.519524335861206, 1.9456490278244019, 1.6173114776611328, 0.353710412979126, 1.8716635704040527, 0.3454711437225342, 1.414873719215393, 0.3292485475540161, 1.1559491157531738, 2.6959800720214844, 0.5833814144134521, 0.5209686756134033, 1.4410545825958252, 2.21805477142334, 2.0326390266418457, 2.8183627128601074, 0.4480854272842407, 0.676084041595459, 0.250141978263855, 3.3552002906799316, 2.1666200160980225, 2.0761680603027344, 0.7644158601760864, 5.00003719329834, 0.14361917972564697, 2.135587692260742, 1.0821714401245117, 1.0596827268600464, 2.3873939514160156, 4.6385016441345215, 1.017956018447876, 0.08138132095336914, 2.359257459640503, 2.4864814281463623, 1.0623621940612793, 0.23655688762664795, 3.1201212406158447, 0.11710929870605469, 1.7631638050079346, 2.8015475273132324, 0.16309332847595215, 4.294807434082031, 1.666222095489502, 2.4607551097869873, 1.899768352508545, 2.396327018737793, 1.3657832145690918, 0.22097206115722656, 1.082314133644104, 1.393648386001587, 0.786270260810852, 1.0967364311218262, 2.682351589202881, 0.5779595375061035, 0.7272752523422241, 1.4564175605773926, 1.9683432579040527, 1.2029168605804443, 0.13971304893493652, 0.27856552600860596, 1.2434712648391724], "mean_td_error": 1.417879343032837, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111287117004395, "actor_loss": -6.894166469573975, "critic_loss": 0.15303999185562134, "alpha_loss": -0.15792147815227509, "alpha_value": 0.9845029711723328, "log_alpha_value": -0.015618333593010902, "target_entropy": -6.0, "policy_t": 0.005108834709972143, "mean_q": 2.8454320430755615, "max_q": 3.973750352859497, "min_q": 1.9386523962020874}, "td_error": [1.5554360151290894, 1.6018277406692505, 2.162172317504883, 0.5114270448684692, 0.7092866897583008, 1.0178483724594116, 0.31077873706817627, 3.3235974311828613, 3.8052620887756348, 0.1350318193435669, 1.2803678512573242, 0.5852017402648926, 0.1270432472229004, 0.297640323638916, 0.5303064584732056, 1.4421981573104858, 1.999298334121704, 0.6532386541366577, 1.3687500953674316, 1.2780935764312744, 1.1267985105514526, 1.9047635793685913, 1.0827043056488037, 1.6100788116455078, 0.6375654935836792, 0.19987130165100098, 0.2833211421966553, 0.22316479682922363, 0.1878594160079956, 1.5564615726470947, 2.064246892929077, 0.18664515018463135, 0.47511839866638184, 1.8145091533660889, 0.08946585655212402, 1.8529878854751587, 1.2859766483306885, 0.29442429542541504, 0.15886914730072021, 0.1347944736480713, 1.0052039623260498, 1.6387659311294556, 1.2039005756378174, 1.6972713470458984, 1.0778405666351318, 0.7824909687042236, 0.26912200450897217, 0.4955657720565796, 0.2858269214630127, 0.5550916194915771, 1.2967416048049927, 3.0541956424713135, 0.304986834526062, 0.3902333974838257, 1.4398258924484253, 1.0058891773223877, 1.1587246656417847, 1.4501807689666748, 0.29567694664001465, 0.9877421855926514, 0.5244399309158325, 1.5650861263275146, 2.8383285999298096, 2.3207874298095703, 0.6580910682678223, 0.6304341554641724, 0.6295568943023682, 2.391785144805908, 0.4772406816482544, 0.16982579231262207, 2.164041042327881, 1.4711554050445557, 0.5362849235534668, 2.137223243713379, 0.6855216026306152, 0.7747793197631836, 1.0782639980316162, 0.4173227548599243, 0.7483298778533936, 0.6723380088806152, 0.6203212738037109, 0.5176582336425781, 2.351412534713745, 0.3998546600341797, 1.7806557416915894, 0.21022260189056396], "mean_td_error": 1.058496117591858, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063570022583008, "actor_loss": -6.9678521156311035, "critic_loss": 0.2854311466217041, "alpha_loss": -0.15700893104076385, "alpha_value": 0.984519362449646, "log_alpha_value": -0.01560171414166689, "target_entropy": -6.0, "policy_t": 0.012799409218132496, "mean_q": 3.1068930625915527, "max_q": 3.9946861267089844, "min_q": 2.349262237548828}, "td_error": [0.3245828151702881, 0.262975811958313, 2.4676356315612793, 0.8680765628814697, 1.2254348993301392, 1.9462974071502686, 0.8412649631500244, 1.5223863124847412, 0.33531415462493896, 0.6951272487640381, 1.1960498094558716, 0.5358854532241821, 0.9957892894744873, 1.2905397415161133, 1.0976828336715698, 1.7330859899520874, 1.2201054096221924, 0.1352229118347168, 0.005211353302001953, 1.1365071535110474, 0.8059574365615845, 1.5092425346374512, 0.4278770685195923, 2.5465073585510254, 1.3766963481903076, 5.084432601928711, 0.021570563316345215, 0.8988679647445679, 0.6029123067855835, 1.829325556755066, 0.323250412940979, 1.170169472694397, 0.12774264812469482, 1.7485787868499756, 3.1906661987304688, 0.5939021110534668, 0.283486008644104, 1.1784861087799072, 0.43884265422821045, 1.3139113187789917, 0.583379864692688, 0.438018798828125, 3.602525472640991, 0.07415807247161865, 1.2254345417022705, 1.5851871967315674, 2.6408486366271973, 2.905034303665161, 2.1493871212005615, 0.8479112386703491, 0.7359260320663452, 2.509998321533203, 1.037135362625122, 1.8331680297851562, 0.4879058599472046, 0.6718403100967407, 2.776303768157959, 0.4519824981689453, 0.173639178276062, 2.247610092163086, 0.42361509799957275, 0.803555965423584, 0.19605183601379395, 3.737034797668457, 1.0589946508407593, 0.16342926025390625, 1.2542643547058105, 1.6916030645370483, 1.289505124092102, 1.068546175956726, 0.41997551918029785, 1.3363813161849976, 1.2584798336029053, 1.4463998079299927, 0.24937200546264648, 0.21160554885864258, 0.2677809000015259, 0.11343753337860107, 2.3239943981170654, 1.900423526763916, 1.9533932209014893, 0.5209016799926758, 1.9307918548583984, 0.35101187229156494, 1.9421117305755615, 0.39774811267852783], "mean_td_error": 1.192969799041748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 438.74061836557553, "num_env_steps_trained_throughput_per_sec": 126.3337941275876, "timesteps_total": 48384, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 2027.087, "sample_time_ms": 1422.733, "load_time_ms": 0.534, "load_throughput": 483158.652, "learn_time_ms": 62.371, "learn_throughput": 4136.521, "synch_weights_time_ms": 15.473}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-12", "timestamp": 1700203092, "time_this_iter_s": 2.0569159984588623, "time_total_s": 111.39633131027222, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 111.39633131027222, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 69.93333333333334, "ram_util_percent": 92.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.004545211791992, "actor_loss": -8.356574058532715, "critic_loss": 0.41354215145111084, "alpha_loss": -0.1591014713048935, "alpha_value": 0.9842228889465332, "log_alpha_value": -0.015902919694781303, "target_entropy": -6.0, "policy_t": 0.030414236709475517, "mean_q": 4.522138595581055, "max_q": 5.991447925567627, "min_q": 3.562741279602051}, "td_error": [0.3245900869369507, 1.4171613454818726, 1.6387019157409668, 5.002130508422852, 4.408685684204102, 3.8630776405334473, 1.2570087909698486, 0.6296350955963135, 2.7349047660827637, 0.06980371475219727, 0.3713451623916626, 3.462271213531494, 1.1965793371200562, 2.52803111076355, 1.321162462234497, 0.5469663143157959, 1.0918048620224, 0.2361752986907959, 0.8110998868942261, 0.17468500137329102, 0.8341314792633057, 0.6966972351074219, 2.425100326538086, 1.458867073059082, 0.9522849321365356, 1.093470811843872, 0.16327929496765137, 3.9007091522216797, 3.844647169113159, 0.3542666435241699, 0.8379065990447998, 1.2075393199920654, 4.620439529418945, 1.6347756385803223, 1.7829091548919678, 3.2916438579559326, 1.4183950424194336, 0.23307716846466064, 0.3025803565979004, 2.5519139766693115, 0.3814605474472046, 1.608783483505249, 0.1182565689086914, 0.6219230890274048, 0.4470055103302002, 0.561687707901001, 4.481307029724121, 0.20827484130859375, 2.4113547801971436, 6.570298671722412, 1.8129568099975586, 2.147808790206909, 2.36877703666687, 2.162992000579834, 0.14374661445617676, 1.1876004934310913, 0.1351761817932129, 1.8310236930847168, 0.03988814353942871, 4.929081439971924, 1.0909565687179565, 2.9997622966766357, 1.242142677307129, 0.3838179111480713, 1.3329217433929443, 0.7561838626861572, 2.0654966831207275, 0.5654354095458984, 1.9087433815002441, 0.9706001281738281, 3.3134233951568604, 1.3987947702407837, 4.740551948547363, 2.292541027069092, 1.7294907569885254, 1.5155351161956787, 0.41832685470581055, 3.9153780937194824, 1.0134888887405396, 0.6024715900421143, 7.1743903160095215, 0.46147024631500244, 1.1304185390472412, 3.2924764156341553, 3.887518882751465, 1.879663109779358], "mean_td_error": 1.7783937454223633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.161080360412598, "actor_loss": -6.961729526519775, "critic_loss": 0.13554984331130981, "alpha_loss": -0.1617509424686432, "alpha_value": 0.9842073321342468, "log_alpha_value": -0.0159186739474535, "target_entropy": -6.0, "policy_t": -0.02792312763631344, "mean_q": 2.9030416011810303, "max_q": 3.845879554748535, "min_q": 1.9380147457122803}, "td_error": [0.41020798683166504, 0.15757691860198975, 0.7254154682159424, 0.5739985704421997, 1.6824908256530762, 1.0392118692398071, 1.05374276638031, 0.6153331995010376, 1.3866064548492432, 0.10387706756591797, 0.27772510051727295, 0.6698442697525024, 2.3461520671844482, 0.1963132619857788, 0.9264867305755615, 1.3205863237380981, 1.6633819341659546, 0.40379130840301514, 0.6757708787918091, 1.4338558912277222, 3.9551119804382324, 0.7788712978363037, 0.5097405910491943, 0.4246382713317871, 0.5769535303115845, 0.08651793003082275, 2.2437992095947266, 1.2493013143539429, 0.1776266098022461, 0.719258189201355, 0.49571120738983154, 0.3789360523223877, 2.100409984588623, 1.619214415550232, 0.4166092872619629, 0.3990858793258667, 2.0570449829101562, 0.733269453048706, 0.10851180553436279, 1.5788954496383667, 2.7893478870391846, 1.308382511138916, 0.25284314155578613, 1.0410165786743164, 0.7488378286361694, 1.2184512615203857, 0.9704939126968384, 1.9995722770690918, 2.5163607597351074, 0.2285306453704834, 1.7511690855026245, 0.2834010124206543, 1.4217478036880493, 2.809971809387207, 1.7877833843231201, 0.18756961822509766, 1.2917567491531372, 1.1317393779754639, 2.269167900085449, 0.13649940490722656, 1.139060616493225, 1.2348439693450928, 0.2673819065093994, 0.22864806652069092, 0.06839585304260254, 0.10889434814453125, 0.5659494400024414, 0.10995447635650635, 0.06541454792022705, 0.14494848251342773, 0.6177908182144165, 1.042711615562439, 0.5285487174987793, 0.7861315011978149, 0.2971609830856323, 0.03805959224700928, 1.5472183227539062, 1.2995566129684448, 1.265014410018921, 1.6237828731536865, 0.66283118724823, 1.0409271717071533, 0.2655240297317505, 1.1128548383712769, 1.8422269821166992, 1.9262233972549438], "mean_td_error": 0.979611337184906, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114701271057129, "actor_loss": -6.865151405334473, "critic_loss": 0.21188843250274658, "alpha_loss": -0.16084147989749908, "alpha_value": 0.9842240214347839, "log_alpha_value": -0.015901753678917885, "target_entropy": -6.0, "policy_t": -0.002479899674654007, "mean_q": 2.9496657848358154, "max_q": 3.811490297317505, "min_q": 2.2732367515563965}, "td_error": [1.1757631301879883, 0.6945291757583618, 2.8042874336242676, 1.6931722164154053, 0.11566901206970215, 0.35788869857788086, 3.1084916591644287, 1.1287732124328613, 0.46527886390686035, 1.9008655548095703, 1.0601682662963867, 2.399503707885742, 0.25561821460723877, 2.8363380432128906, 0.18376433849334717, 0.5494757890701294, 1.3870067596435547, 0.056887030601501465, 1.1654597520828247, 1.1550096273422241, 0.7106920480728149, 0.7388620376586914, 0.35469698905944824, 0.6412757635116577, 0.7417384386062622, 0.17612087726593018, 0.5041714906692505, 0.28296661376953125, 1.2430498600006104, 1.000445008277893, 0.05808532238006592, 2.7779617309570312, 1.4544413089752197, 0.9529803991317749, 0.8345757722854614, 0.19252943992614746, 2.072089672088623, 1.3760912418365479, 1.4536315202713013, 0.46801257133483887, 0.653069019317627, 2.162600517272949, 2.204071044921875, 4.299571514129639, 1.5550806522369385, 0.8432387113571167, 1.101487636566162, 1.8298941850662231, 1.196746587753296, 1.1143403053283691, 0.8074755668640137, 1.6059637069702148, 1.2007910013198853, 0.27126049995422363, 0.756696343421936, 2.1330957412719727, 1.114457368850708, 1.6060872077941895, 1.6259815692901611, 0.15111398696899414, 0.6340508460998535, 1.3414238691329956, 0.8261152505874634, 0.28844738006591797, 2.083240270614624, 1.0798039436340332, 1.0870368480682373, 1.625723123550415, 0.2709214687347412, 2.097724437713623, 0.5256738662719727, 0.07292187213897705, 0.7051331996917725, 2.150210380554199, 0.7912986278533936, 1.3603887557983398, 4.195897102355957, 0.41207432746887207, 2.2202529907226562, 2.1390299797058105, 0.3198510408401489, 0.47163474559783936, 1.1317659616470337, 1.0922927856445312, 0.3211725950241089, 0.9069260358810425], "mean_td_error": 1.1734000444412231, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.53747946099736, "num_env_steps_trained_throughput_per_sec": 138.08110457693897, "timesteps_total": 49280, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 147840, "timers": {"training_iteration_time_ms": 2031.975, "sample_time_ms": 1426.791, "load_time_ms": 0.536, "load_throughput": 481717.607, "learn_time_ms": 62.342, "learn_throughput": 4138.453, "synch_weights_time_ms": 15.514}, "counters": {"num_env_steps_sampled": 49280, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 13932, "last_target_update_ts": 49280, "num_target_updates": 54}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-14", "timestamp": 1700203094, "time_this_iter_s": 1.886934757232666, "time_total_s": 113.28326606750488, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052641f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 113.28326606750488, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 92.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047173500061035, "actor_loss": -8.421870231628418, "critic_loss": 0.43868303298950195, "alpha_loss": -0.1627916395664215, "alpha_value": 0.983927845954895, "log_alpha_value": -0.01620272919535637, "target_entropy": -6.0, "policy_t": -0.051699571311473846, "mean_q": 4.553858280181885, "max_q": 6.0584845542907715, "min_q": 3.611750364303589}, "td_error": [0.5629615783691406, 0.8959124088287354, 3.2528254985809326, 0.25373411178588867, 0.33161330223083496, 3.80586838722229, 1.2143062353134155, 0.30837130546569824, 2.858546733856201, 2.2454802989959717, 0.5265188217163086, 4.190064907073975, 2.3891608715057373, 0.9955503940582275, 1.418525218963623, 0.1673588752746582, 1.33907151222229, 5.323227882385254, 5.931727886199951, 5.9230732917785645, 1.1219165325164795, 1.3981513977050781, 0.6560995578765869, 2.229135513305664, 0.8902719020843506, 0.18298912048339844, 0.49521446228027344, 4.038288116455078, 0.22458791732788086, 3.531538724899292, 0.9080865383148193, 0.2502901554107666, 0.11320996284484863, 0.8432159423828125, 3.178398847579956, 1.1547226905822754, 2.097628116607666, 1.197035551071167, 0.9777553081512451, 2.019697666168213, 1.2132139205932617, 5.017008304595947, 2.288534641265869, 4.572960376739502, 3.4857218265533447, 0.7672381401062012, 0.5366151332855225, 4.6850738525390625, 0.29865026473999023, 0.22424077987670898, 1.3814735412597656, 2.330169200897217, 2.058462142944336, 1.941802978515625, 0.5808265209197998, 1.6533911228179932, 3.8976755142211914, 2.4224166870117188, 3.248842477798462, 2.1708059310913086, 0.3701314926147461, 4.653355598449707, 2.247194766998291, 2.94398832321167, 0.423378586769104, 2.9933536052703857, 2.022550582885742, 0.723217248916626, 0.09614944458007812, 3.2618885040283203, 0.9016920328140259, 1.4519317150115967, 2.2653942108154297, 1.2175776958465576, 1.187140703201294, 1.7790002822875977, 1.4519054889678955, 0.9547922611236572, 0.6420910358428955, 0.9897754192352295, 1.1422531604766846, 1.0299335718154907, 1.148728847503662, 2.802690267562866, 2.6074130535125732, 0.6222023963928223], "mean_td_error": 1.8389184474945068, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0764799118042, "actor_loss": -6.742788791656494, "critic_loss": 0.15975028276443481, "alpha_loss": -0.16343200206756592, "alpha_value": 0.9839116930961609, "log_alpha_value": -0.016219157725572586, "target_entropy": -6.0, "policy_t": 0.014682506211102009, "mean_q": 2.7229177951812744, "max_q": 3.669285297393799, "min_q": 1.863830804824829}, "td_error": [0.2699505090713501, 0.26742756366729736, 0.3191922903060913, 1.4945319890975952, 0.30554401874542236, 0.18065333366394043, 1.7426648139953613, 0.1292123794555664, 3.7793240547180176, 2.597416877746582, 0.3352009057998657, 3.142183303833008, 2.3493590354919434, 0.13051629066467285, 2.769639492034912, 0.14535462856292725, 1.9032824039459229, 0.7812310457229614, 1.433385968208313, 0.1508122682571411, 2.2168776988983154, 1.2398502826690674, 1.154934287071228, 1.0603817701339722, 0.6685717105865479, 0.9900542497634888, 1.092656135559082, 1.3294717073440552, 0.7185076475143433, 1.1246190071105957, 0.61646568775177, 1.3487639427185059, 2.5568575859069824, 1.4383881092071533, 0.4020068645477295, 0.5693076848983765, 0.7958641052246094, 1.3770760297775269, 1.604386806488037, 0.5896440744400024, 1.7966313362121582, 1.2719929218292236, 0.11326062679290771, 1.7375235557556152, 1.819473385810852, 1.3329368829727173, 1.3744195699691772, 1.6358184814453125, 0.39734315872192383, 0.10991048812866211, 0.8719432353973389, 0.20699608325958252, 1.294323444366455, 2.1005992889404297, 0.3079882860183716, 3.1080636978149414, 0.09313416481018066, 0.1093970537185669, 0.5787591934204102, 3.246830701828003, 0.2999446392059326, 2.415696382522583, 0.2848353385925293, 0.24161291122436523, 2.0226433277130127, 0.44098973274230957, 0.2243901491165161, 1.4549386501312256, 0.5083103179931641, 0.10617268085479736, 1.130348801612854, 2.132061243057251, 0.500327467918396, 3.0720062255859375, 0.19289696216583252, 0.06226217746734619, 1.2080024480819702, 1.1212364435195923, 0.9625189304351807, 1.9166823625564575, 1.0059902667999268, 0.26195311546325684, 0.14505791664123535, 0.14195942878723145, 0.49762821197509766, 0.2145174741744995], "mean_td_error": 1.08364999294281, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105552673339844, "actor_loss": -6.897439479827881, "critic_loss": 0.22708114981651306, "alpha_loss": -0.163728728890419, "alpha_value": 0.9839286804199219, "log_alpha_value": -0.016201859340071678, "target_entropy": -6.0, "policy_t": 0.01874556951224804, "mean_q": 2.951049566268921, "max_q": 3.7704966068267822, "min_q": 2.287137269973755}, "td_error": [1.6512789726257324, 1.2397465705871582, 1.1020886898040771, 2.1792874336242676, 0.9269049167633057, 1.2839031219482422, 2.1783690452575684, 0.14658260345458984, 1.381345510482788, 1.8227444887161255, 0.6138734817504883, 0.57841956615448, 1.6427007913589478, 0.15598881244659424, 0.32169032096862793, 0.2440330982208252, 4.0659613609313965, 0.573275089263916, 0.33273589611053467, 1.057883858680725, 2.117964744567871, 0.835834264755249, 2.144486904144287, 2.063518524169922, 3.429713487625122, 0.8674745559692383, 0.4671151638031006, 4.0235137939453125, 0.45489394664764404, 0.8210543394088745, 0.4063318967819214, 2.2966501712799072, 2.3069872856140137, 1.6792528629302979, 0.31120920181274414, 0.8106470108032227, 0.49458444118499756, 0.21466326713562012, 0.37859296798706055, 2.360191583633423, 1.001049280166626, 1.0764636993408203, 2.8336806297302246, 0.5089399814605713, 1.9005070924758911, 0.15553069114685059, 1.5601979494094849, 1.018608570098877, 1.3202375173568726, 0.9754836559295654, 1.9114820957183838, 1.2182939052581787, 1.6220316886901855, 2.3222270011901855, 0.8693622350692749, 0.43729138374328613, 0.4409834146499634, 1.1772786378860474, 0.7907177209854126, 1.7689573764801025, 1.0845613479614258, 0.10732793807983398, 0.47453761100769043, 0.9427869319915771, 1.2065424919128418, 1.5851118564605713, 2.0863614082336426, 0.11486256122589111, 0.44129765033721924, 1.7793498039245605, 0.8373240232467651, 0.06410980224609375, 0.29229414463043213, 2.353855609893799, 1.529247760772705, 2.056006908416748, 1.5999611616134644, 1.7407267093658447, 0.7004849910736084, 2.675692081451416, 2.2553374767303467, 0.39953935146331787, 0.11693549156188965, 1.489851474761963, 0.8274781703948975, 1.1051806211471558], "mean_td_error": 1.2413904666900635, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 435.69212219749215, "num_env_steps_trained_throughput_per_sec": 125.4559905434743, "timesteps_total": 50176, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 2051.825, "sample_time_ms": 1445.732, "load_time_ms": 0.537, "load_throughput": 480178.573, "learn_time_ms": 62.412, "learn_throughput": 4133.813, "synch_weights_time_ms": 15.518}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-16", "timestamp": 1700203096, "time_this_iter_s": 2.073080062866211, "time_total_s": 115.3563461303711, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 115.3563461303711, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.023526191711426, "actor_loss": -8.261478424072266, "critic_loss": 0.3788154721260071, "alpha_loss": -0.16541288793087006, "alpha_value": 0.9836329817771912, "log_alpha_value": -0.016502462327480316, "target_entropy": -6.0, "policy_t": -0.012097814120352268, "mean_q": 4.385807991027832, "max_q": 5.850107669830322, "min_q": 3.6907060146331787}, "td_error": [1.6466305255889893, 1.161736011505127, 0.22245216369628906, 1.045398473739624, 0.7174215316772461, 2.0144262313842773, 4.6016716957092285, 1.1412463188171387, 0.5294950008392334, 0.5007089376449585, 2.947376251220703, 1.5832258462905884, 2.0430142879486084, 1.8971694707870483, 1.8212000131607056, 0.6672240495681763, 1.9635071754455566, 3.1848762035369873, 0.1908881664276123, 0.2090766429901123, 3.6018471717834473, 1.5441408157348633, 0.30905401706695557, 1.2903692722320557, 1.8497204780578613, 0.5065335035324097, 1.7370750904083252, 1.446730613708496, 1.1522278785705566, 0.36411595344543457, 3.123638391494751, 1.0847325325012207, 1.640501856803894, 1.4581201076507568, 0.4671895503997803, 0.5012998580932617, 4.400483131408691, 0.3933262825012207, 1.2544461488723755, 0.12920713424682617, 0.43587183952331543, 1.9476313591003418, 3.341599702835083, 1.9110279083251953, 1.975475549697876, 1.673701524734497, 2.771228313446045, 3.6225388050079346, 0.6921813488006592, 0.23219990730285645, 1.4404432773590088, 3.9429378509521484, 2.4991636276245117, 1.7662017345428467, 1.3640475273132324, 1.4537267684936523, 3.1668541431427, 2.0437660217285156, 3.5356128215789795, 0.17105364799499512, 3.8542397022247314, 2.2485084533691406, 0.10415363311767578, 0.4324219226837158, 3.60965633392334, 0.7522162199020386, 1.7126328945159912, 6.918435096740723, 0.5399563312530518, 2.2858996391296387, 0.13277757167816162, 2.9436264038085938, 3.2708945274353027, 0.5112793445587158, 1.580257773399353, 0.8343729972839355, 1.5367405414581299, 0.41205620765686035, 3.7718536853790283, 1.8319880962371826, 1.5120885372161865, 0.4596066474914551, 0.25030970573425293, 0.5430347919464111, 0.20057320594787598, 0.7103497982025146], "mean_td_error": 1.6429152488708496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10783576965332, "actor_loss": -6.718226432800293, "critic_loss": 0.17171666026115417, "alpha_loss": -0.16697703301906586, "alpha_value": 0.9836161136627197, "log_alpha_value": -0.016519563272595406, "target_entropy": -6.0, "policy_t": 0.027792004868388176, "mean_q": 2.701817035675049, "max_q": 3.5833487510681152, "min_q": 1.8340840339660645}, "td_error": [3.64223575592041, 1.5784577131271362, 0.22247660160064697, 1.868200421333313, 0.3399031162261963, 0.29241907596588135, 0.1030418872833252, 0.7158404588699341, 1.9261656999588013, 1.7205854654312134, 0.9192303419113159, 2.127810478210449, 0.23871755599975586, 1.2443933486938477, 0.13416564464569092, 0.6744338274002075, 0.9130555391311646, 2.582247018814087, 0.314656138420105, 0.2595928907394409, 2.8214375972747803, 1.2823612689971924, 0.4030933380126953, 0.87168288230896, 3.97841739654541, 0.6548072099685669, 0.42509138584136963, 2.252331256866455, 0.10461890697479248, 0.3269275426864624, 0.742340087890625, 1.3463951349258423, 1.9048134088516235, 0.4062511920928955, 2.2010233402252197, 1.5850919485092163, 1.2771449089050293, 1.5135974884033203, 0.6352031230926514, 1.5868043899536133, 0.21195638179779053, 0.6614786386489868, 0.33311307430267334, 1.0731066465377808, 0.28503501415252686, 0.288753867149353, 1.2471824884414673, 1.124234676361084, 2.904025077819824, 1.194349765777588, 0.345430850982666, 2.7164182662963867, 0.9144583940505981, 1.0293337106704712, 0.33585071563720703, 0.6989026069641113, 1.2287665605545044, 0.3451632261276245, 2.185293197631836, 0.964289665222168, 1.2424567937850952, 0.6898360252380371, 1.4554729461669922, 0.6582655906677246, 1.9398921728134155, 0.5976680517196655, 1.1676814556121826, 1.8201773166656494, 0.8834179639816284, 1.0516518354415894, 3.250852584838867, 1.2857856750488281, 0.7785505056381226, 0.9708099365234375, 0.7581945657730103, 0.14002621173858643, 1.3537201881408691, 0.16661560535430908, 0.8007668256759644, 1.2974112033843994, 0.762012243270874, 2.185288667678833, 2.3541290760040283, 1.9999240636825562, 1.689531922340393, 1.708251714706421], "mean_td_error": 1.1771231889724731, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02881908416748, "actor_loss": -6.741761684417725, "critic_loss": 0.23939213156700134, "alpha_loss": -0.1654955893754959, "alpha_value": 0.9836333990097046, "log_alpha_value": -0.016502000391483307, "target_entropy": -6.0, "policy_t": -0.044710107147693634, "mean_q": 2.905484199523926, "max_q": 3.8711178302764893, "min_q": 2.1829583644866943}, "td_error": [1.0331861972808838, 1.210375189781189, 0.9803524017333984, 0.5223355293273926, 0.5464023351669312, 0.2397991418838501, 0.5381385087966919, 0.2074345350265503, 3.3612136840820312, 1.18031907081604, 0.48130857944488525, 2.017025947570801, 0.7692862749099731, 0.953481912612915, 0.19669342041015625, 2.5624561309814453, 1.017798662185669, 0.08956992626190186, 0.1037602424621582, 0.5963058471679688, 0.5177179574966431, 2.358330726623535, 0.6164348125457764, 3.0290966033935547, 0.7110856771469116, 1.0600589513778687, 0.9925767183303833, 0.27988600730895996, 1.6936570405960083, 1.0179930925369263, 0.44426512718200684, 2.981334686279297, 0.2471766471862793, 0.10501539707183838, 0.3893245458602905, 3.3487253189086914, 2.9401803016662598, 2.1038436889648438, 2.8731818199157715, 1.3331800699234009, 1.8608670234680176, 0.2552691698074341, 0.9963140487670898, 0.061669230461120605, 0.10763669013977051, 2.016387462615967, 1.520866870880127, 0.7770129442214966, 1.145965576171875, 2.1223206520080566, 0.49384498596191406, 3.408043622970581, 0.1076430082321167, 0.8849451541900635, 1.0788971185684204, 1.2055466175079346, 0.383813738822937, 0.7795358896255493, 0.6296720504760742, 3.5341124534606934, 0.07460582256317139, 0.7850092649459839, 3.0691583156585693, 0.16958391666412354, 0.36568009853363037, 0.6886157989501953, 2.642427921295166, 0.8123031854629517, 1.2541707754135132, 0.6743144989013672, 1.060509443283081, 1.1654638051986694, 1.855368733406067, 1.3315460681915283, 0.1397770643234253, 2.1804728507995605, 1.5925902128219604, 0.951562762260437, 2.4407222270965576, 1.7381097078323364, 1.924147367477417, 0.4712258577346802, 2.6011180877685547, 1.6600773334503174, 3.053256034851074, 4.201592445373535], "mean_td_error": 1.2781869173049927, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 479.47360608872486, "num_env_steps_trained_throughput_per_sec": 138.06271246751228, "timesteps_total": 51072, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 153216, "timers": {"training_iteration_time_ms": 2051.431, "sample_time_ms": 1446.356, "load_time_ms": 0.535, "load_throughput": 481996.54, "learn_time_ms": 62.504, "learn_throughput": 4127.71, "synch_weights_time_ms": 15.462}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 153216, "num_agent_steps_trained": 14448, "last_target_update_ts": 51072, "num_target_updates": 56}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-18", "timestamp": 1700203098, "time_this_iter_s": 1.885239839553833, "time_total_s": 117.24158596992493, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0847c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 117.24158596992493, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 86.7, "ram_util_percent": 92.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007978439331055, "actor_loss": -8.267183303833008, "critic_loss": 0.3178127408027649, "alpha_loss": -0.1681547462940216, "alpha_value": 0.9833382964134216, "log_alpha_value": -0.016802068799734116, "target_entropy": -6.0, "policy_t": 0.036625996232032776, "mean_q": 4.446068286895752, "max_q": 5.50239896774292, "min_q": 3.3939456939697266}, "td_error": [0.1290968656539917, 1.8898067474365234, 1.5509154796600342, 0.27245450019836426, 1.6492723226547241, 2.065582513809204, 1.5519945621490479, 0.22138738632202148, 2.2943217754364014, 0.6484732627868652, 1.263627290725708, 0.8360202312469482, 0.5254824161529541, 3.446030616760254, 1.0403094291687012, 2.0633723735809326, 1.1985325813293457, 0.4342668056488037, 1.066248893737793, 5.408797264099121, 0.44607996940612793, 3.7446916103363037, 0.31169116497039795, 1.9602975845336914, 0.3070186376571655, 1.0769333839416504, 0.9552264213562012, 0.6375877857208252, 2.1857452392578125, 0.9485477209091187, 4.084629058837891, 0.3627302646636963, 1.8975670337677002, 0.9029176235198975, 0.32437872886657715, 2.452247381210327, 0.7475488185882568, 2.4410719871520996, 1.3993219137191772, 5.546124458312988, 1.1382603645324707, 0.34853196144104004, 0.29822278022766113, 2.488086700439453, 1.0981616973876953, 0.6948404312133789, 0.19628691673278809, 0.3338589668273926, 1.8241569995880127, 1.3960988521575928, 0.5016878843307495, 0.42234158515930176, 0.07284903526306152, 1.0241436958312988, 2.2836856842041016, 0.6766407489776611, 0.3578531742095947, 2.259998083114624, 2.2299811840057373, 0.5037107467651367, 0.13222002983093262, 0.8505502939224243, 1.5232126712799072, 0.7917718887329102, 4.171352863311768, 0.5022774934768677, 1.7045936584472656, 3.870619535446167, 0.5817892551422119, 3.6308541297912598, 0.5374701023101807, 1.2258960008621216, 2.6064887046813965, 3.939075469970703, 0.5347418785095215, 3.9130141735076904, 3.7165513038635254, 0.6329748630523682, 2.8255233764648438, 0.8115042448043823, 0.29581379890441895, 0.8877785205841064, 0.8797017335891724, 0.22292733192443848, 3.8553531169891357, 0.3878955841064453], "mean_td_error": 1.482205867767334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064841270446777, "actor_loss": -6.754241943359375, "critic_loss": 0.1661686897277832, "alpha_loss": -0.16929036378860474, "alpha_value": 0.9833207130432129, "log_alpha_value": -0.016819976270198822, "target_entropy": -6.0, "policy_t": -0.0600917711853981, "mean_q": 2.794421434402466, "max_q": 3.6115643978118896, "min_q": 1.9809194803237915}, "td_error": [1.6703940629959106, 3.2509989738464355, 0.36569666862487793, 1.1659176349639893, 1.624653935432434, 0.8400405645370483, 1.2248563766479492, 0.9475312232971191, 0.5577355623245239, 0.9530119895935059, 2.598198413848877, 0.11612105369567871, 1.4240671396255493, 1.0499972105026245, 0.5421582460403442, 1.4856129884719849, 0.8099639415740967, 1.3192745447158813, 1.0570882558822632, 0.6110942363739014, 1.9300106763839722, 1.1527520418167114, 0.2334156036376953, 2.2280826568603516, 1.316848635673523, 0.9066400527954102, 0.022149205207824707, 0.28114795684814453, 0.8047077655792236, 2.1489815711975098, 1.1670591831207275, 0.31473851203918457, 0.8725185394287109, 2.3918018341064453, 0.29945313930511475, 1.3840134143829346, 0.2371903657913208, 1.1877182722091675, 1.4317326545715332, 0.5569177865982056, 0.9215570688247681, 0.23029327392578125, 1.5373210906982422, 0.9857689142227173, 0.3776230812072754, 1.3716424703598022, 1.6506245136260986, 1.1096019744873047, 3.3682925701141357, 0.23123085498809814, 0.9437215328216553, 2.8156752586364746, 0.24114298820495605, 1.2578407526016235, 0.22518670558929443, 0.1713186502456665, 1.6837772130966187, 2.002762794494629, 1.0435562133789062, 1.8673440217971802, 2.574599266052246, 0.8009165525436401, 1.483684778213501, 2.727753162384033, 1.1689261198043823, 0.2777673006057739, 1.548143982887268, 0.6291718482971191, 0.37323474884033203, 0.8405954837799072, 1.3086493015289307, 0.3334777355194092, 0.2269679307937622, 0.5850324630737305, 0.35216593742370605, 0.5430169105529785, 2.333366870880127, 1.160330891609192, 1.418713927268982, 2.20904541015625, 1.2078262567520142, 1.4006693363189697, 0.44341397285461426, 1.3005852699279785, 0.25618720054626465, 2.3593854904174805], "mean_td_error": 1.1439790725708008, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046956062316895, "actor_loss": -6.688179969787598, "critic_loss": 0.2488754838705063, "alpha_loss": -0.16880883276462555, "alpha_value": 0.9833383560180664, "log_alpha_value": -0.01680198684334755, "target_entropy": -6.0, "policy_t": 0.012203643098473549, "mean_q": 2.826115131378174, "max_q": 3.7454724311828613, "min_q": 2.1497817039489746}, "td_error": [2.6269161701202393, 2.8526501655578613, 0.7583209276199341, 0.2556518316268921, 0.3715585470199585, 0.866671085357666, 1.2700788974761963, 0.6230045557022095, 2.229891061782837, 1.5933830738067627, 1.0330448150634766, 2.100940227508545, 2.6181790828704834, 0.7144237756729126, 0.46131646633148193, 0.36733829975128174, 0.562203049659729, 2.804675579071045, 0.18802762031555176, 2.2651209831237793, 0.7059086561203003, 0.9369279146194458, 1.283296823501587, 3.2994048595428467, 0.20296525955200195, 0.9584524631500244, 0.04663431644439697, 0.8077726364135742, 0.06714117527008057, 2.017373561859131, 1.0599863529205322, 1.2757235765457153, 3.8046371936798096, 1.7254602909088135, 0.0830003023147583, 0.6998293399810791, 1.8471885919570923, 1.7996119260787964, 3.220834255218506, 0.8285776376724243, 1.6150190830230713, 0.5051453113555908, 4.0103325843811035, 1.446539282798767, 1.9150426387786865, 0.17503488063812256, 0.2990133762359619, 0.7703655958175659, 2.964447259902954, 0.42221295833587646, 0.9435083866119385, 0.2312403917312622, 0.1522594690322876, 4.323136329650879, 0.04982709884643555, 1.7766505479812622, 2.8090600967407227, 0.8402378559112549, 1.6521461009979248, 0.09940731525421143, 1.4081424474716187, 0.1700962781906128, 2.3000171184539795, 0.15548813343048096, 0.5955052375793457, 0.7841098308563232, 2.69075870513916, 4.495335578918457, 0.73542320728302, 2.6145811080932617, 0.6209867000579834, 0.6279151439666748, 1.2865359783172607, 0.5426225662231445, 0.37582695484161377, 0.7943079471588135, 1.0168839693069458, 2.875112533569336, 0.3884779214859009, 2.0013201236724854, 2.2148375511169434, 1.132501244544983, 0.6865178346633911, 0.2660198211669922, 1.4134273529052734, 0.7425854206085205], "mean_td_error": 1.3159313201904297, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 465.8632963061261, "num_env_steps_trained_throughput_per_sec": 134.1436723738622, "timesteps_total": 51968, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 2055.386, "sample_time_ms": 1449.777, "load_time_ms": 0.54, "load_throughput": 478078.388, "learn_time_ms": 62.819, "learn_throughput": 4107.03, "synch_weights_time_ms": 15.607}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-20", "timestamp": 1700203100, "time_this_iter_s": 1.9404280185699463, "time_total_s": 119.18201398849487, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 119.18201398849487, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 63.833333333333336, "ram_util_percent": 92.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028940200805664, "actor_loss": -8.305554389953613, "critic_loss": 0.3463539481163025, "alpha_loss": -0.17151017487049103, "alpha_value": 0.9830438494682312, "log_alpha_value": -0.017101526260375977, "target_entropy": -6.0, "policy_t": -0.05458897352218628, "mean_q": 4.470112323760986, "max_q": 5.6724677085876465, "min_q": 3.291154384613037}, "td_error": [2.0691184997558594, 2.2760472297668457, 6.030921459197998, 2.2355105876922607, 0.9050478935241699, 2.015360116958618, 0.3106793165206909, 0.13232898712158203, 0.8643602132797241, 2.2579097747802734, 0.12072527408599854, 1.8671913146972656, 0.9912714958190918, 4.18173885345459, 1.6927216053009033, 2.6163716316223145, 0.2030184268951416, 0.41605186462402344, 0.5150494575500488, 2.00114107131958, 0.9478569030761719, 0.3012864589691162, 0.7555705308914185, 2.0374085903167725, 4.492542743682861, 1.2316255569458008, 0.8113840818405151, 0.45026612281799316, 1.0005191564559937, 0.9251832962036133, 0.2753859758377075, 1.9960403442382812, 1.2193114757537842, 1.6444344520568848, 0.5269012451171875, 0.9495267868041992, 0.20542049407958984, 3.193848133087158, 0.3959956169128418, 1.047391653060913, 3.0026369094848633, 2.942533016204834, 4.115706920623779, 2.9277327060699463, 3.2591636180877686, 2.2007198333740234, 0.40819764137268066, 0.11516809463500977, 1.7847157716751099, 0.18381643295288086, 1.5419554710388184, 1.3023152351379395, 0.8180625438690186, 0.5054898262023926, 1.2018096446990967, 0.6603024005889893, 1.7076027393341064, 0.6959855556488037, 0.5924055576324463, 1.4864239692687988, 4.254402160644531, 1.849644422531128, 1.4383864402770996, 1.1476645469665527, 0.16618645191192627, 0.21921849250793457, 6.457520961761475, 1.6984477043151855, 0.32701778411865234, 2.2922446727752686, 0.3817155361175537, 1.9902911186218262, 0.7359213829040527, 0.018168210983276367, 2.257948875427246, 0.9000818729400635, 3.7213261127471924, 0.5768237113952637, 4.260629653930664, 0.5855333805084229, 3.016676664352417, 0.1442556381225586, 1.802603006362915, 2.5106163024902344, 0.6327435970306396, 1.1504039764404297], "mean_td_error": 1.5592986345291138, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126721382141113, "actor_loss": -6.7133989334106445, "critic_loss": 0.19019418954849243, "alpha_loss": -0.17337240278720856, "alpha_value": 0.9830254316329956, "log_alpha_value": -0.01712029054760933, "target_entropy": -6.0, "policy_t": -0.03838144242763519, "mean_q": 2.7188730239868164, "max_q": 3.737657070159912, "min_q": 1.8908100128173828}, "td_error": [2.4303336143493652, 1.1374828815460205, 1.9533324241638184, 0.7603350877761841, 1.2366728782653809, 0.9811984300613403, 0.4748110771179199, 3.3295578956604004, 1.1389182806015015, 0.5797237157821655, 0.7687839269638062, 0.24889326095581055, 3.3921775817871094, 2.406339645385742, 1.3467154502868652, 0.5196335315704346, 0.6972676515579224, 3.139592409133911, 3.02634334564209, 0.21623623371124268, 0.14638781547546387, 0.3888695240020752, 5.384134292602539, 0.23672640323638916, 2.08392333984375, 2.132173538208008, 1.2062097787857056, 0.42756545543670654, 3.7319698333740234, 0.6242789030075073, 0.4949343204498291, 1.7431172132492065, 0.48774242401123047, 0.2260749340057373, 0.26169025897979736, 2.511347770690918, 1.8979460000991821, 0.3303941488265991, 0.619174599647522, 1.300706386566162, 3.9004409313201904, 0.779841423034668, 1.6424596309661865, 0.7488420009613037, 1.0456173419952393, 0.4483100175857544, 2.5089612007141113, 1.4302520751953125, 0.7899972200393677, 1.2345390319824219, 0.05440413951873779, 0.4832894802093506, 0.6991395950317383, 2.4625988006591797, 0.152565598487854, 0.3528635501861572, 1.675935983657837, 0.23069274425506592, 2.3020987510681152, 0.31115710735321045, 1.5180143117904663, 0.3811534643173218, 2.038510799407959, 0.08341753482818604, 0.31593096256256104, 0.821764349937439, 1.5844287872314453, 0.7223027944564819, 0.11824607849121094, 0.21827435493469238, 2.7299389839172363, 1.0908936262130737, 1.8976109027862549, 0.9234614372253418, 0.7441200017929077, 0.2853652238845825, 0.5938237905502319, 2.296844482421875, 0.5436869859695435, 0.1441020965576172, 3.1087679862976074, 0.37645065784454346, 0.18129205703735352, 1.3998687267303467, 0.8751739263534546, 0.27740275859832764], "mean_td_error": 1.2156345844268799, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135528564453125, "actor_loss": -6.720703601837158, "critic_loss": 0.22617945075035095, "alpha_loss": -0.17333661019802094, "alpha_value": 0.9830435514450073, "log_alpha_value": -0.01710188016295433, "target_entropy": -6.0, "policy_t": 0.0046190316788852215, "mean_q": 2.7445342540740967, "max_q": 3.4479916095733643, "min_q": 2.201756238937378}, "td_error": [0.9398539066314697, 1.708260416984558, 0.22686445713043213, 1.0756241083145142, 0.44483494758605957, 0.03953254222869873, 3.1349880695343018, 1.4183363914489746, 2.2105343341827393, 0.9969241619110107, 0.07040786743164062, 1.8583860397338867, 3.117607831954956, 2.2251620292663574, 1.0650250911712646, 0.546261191368103, 2.1974852085113525, 3.0415704250335693, 0.3673964738845825, 2.535304069519043, 1.9886170625686646, 0.3788447380065918, 0.24091243743896484, 2.385190486907959, 1.3590424060821533, 0.5336804389953613, 1.5468661785125732, 1.1507446765899658, 0.8115192651748657, 1.294675350189209, 0.6901654005050659, 3.2971882820129395, 0.5059844255447388, 1.2633265256881714, 1.4701502323150635, 4.0700178146362305, 0.9438176155090332, 1.0428462028503418, 0.6196072101593018, 0.4795994758605957, 0.9760892391204834, 0.23306703567504883, 1.5757274627685547, 0.03911888599395752, 0.9931846857070923, 3.6882753372192383, 0.6212664842605591, 2.734553575515747, 2.1330347061157227, 2.2450850009918213, 2.000744342803955, 2.074085235595703, 1.0217550992965698, 0.1502007246017456, 0.6294747591018677, 0.32311344146728516, 0.017398357391357422, 0.3524177074432373, 0.25816071033477783, 1.063886284828186, 2.9691386222839355, 0.30836963653564453, 1.8296592235565186, 1.7892203330993652, 0.17633318901062012, 1.9638183116912842, 0.2866029739379883, 0.82301926612854, 1.6177544593811035, 2.2473630905151367, 0.6186130046844482, 0.5040239095687866, 0.32401132583618164, 0.8479934930801392, 0.5324015617370605, 0.7176738977432251, 1.0013928413391113, 0.773594856262207, 0.36019861698150635, 1.5992826223373413, 0.7115437984466553, 1.669669270515442, 0.11277437210083008, 0.5284711122512817, 0.9675273895263672, 0.20196139812469482], "mean_td_error": 1.2082116603851318, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 437.4098995961686, "num_env_steps_trained_throughput_per_sec": 125.9506184105039, "timesteps_total": 52864, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 158592, "timers": {"training_iteration_time_ms": 2045.232, "sample_time_ms": 1439.455, "load_time_ms": 0.538, "load_throughput": 479561.459, "learn_time_ms": 62.819, "learn_throughput": 4107.022, "synch_weights_time_ms": 15.13}, "counters": {"num_env_steps_sampled": 52864, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 158592, "num_agent_steps_trained": 14964, "last_target_update_ts": 52864, "num_target_updates": 58}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-22", "timestamp": 1700203102, "time_this_iter_s": 2.063972234725952, "time_total_s": 121.24598622322083, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 121.24598622322083, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 74.46666666666667, "ram_util_percent": 92.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05165958404541, "actor_loss": -8.363451957702637, "critic_loss": 0.41507160663604736, "alpha_loss": -0.17490795254707336, "alpha_value": 0.9827496409416199, "log_alpha_value": -0.01740090362727642, "target_entropy": -6.0, "policy_t": 0.029784992337226868, "mean_q": 4.467477321624756, "max_q": 5.6437530517578125, "min_q": 3.4950451850891113}, "td_error": [0.501720666885376, 0.43835341930389404, 0.8409794569015503, 2.3594369888305664, 0.2736678123474121, 0.07540392875671387, 2.4071950912475586, 0.9342894554138184, 3.361029624938965, 1.7986725568771362, 0.20170044898986816, 1.2093851566314697, 0.5472257137298584, 0.018711090087890625, 0.7667832374572754, 4.774594306945801, 0.09864306449890137, 1.45902681350708, 2.6875264644622803, 3.3267035484313965, 0.6164491176605225, 2.8130645751953125, 1.6512324810028076, 0.24553179740905762, 0.3648974895477295, 3.5535295009613037, 0.6558221578598022, 0.12389445304870605, 2.556347370147705, 3.9354135990142822, 1.4407989978790283, 1.671875238418579, 0.4290738105773926, 0.49707627296447754, 0.3438987731933594, 2.8113820552825928, 1.5983304977416992, 5.877779960632324, 0.8508384227752686, 1.384230375289917, 5.139649391174316, 1.964731216430664, 1.2068119049072266, 0.3570902347564697, 1.6025276184082031, 1.6116182804107666, 1.102492332458496, 2.6941375732421875, 0.4128580093383789, 0.10581231117248535, 5.950874328613281, 0.7705830335617065, 0.7188282012939453, 1.7770683765411377, 1.763695240020752, 2.672119379043579, 0.5303819179534912, 0.49314045906066895, 7.197075366973877, 5.3444061279296875, 2.2216150760650635, 0.6486716270446777, 1.5365995168685913, 0.29380035400390625, 0.5600849390029907, 1.3902616500854492, 3.461794376373291, 4.0371904373168945, 3.1663296222686768, 1.80867600440979, 1.3019834756851196, 2.364945650100708, 2.2135937213897705, 1.3807780742645264, 1.5298082828521729, 2.5707175731658936, 0.024595260620117188, 2.894455909729004, 3.319697141647339, 0.13249731063842773, 3.0966744422912598, 1.6951611042022705, 0.7988733053207397, 1.6894196271896362, 2.430182456970215, 1.680269479751587], "mean_td_error": 1.7810126543045044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124491691589355, "actor_loss": -6.659887313842773, "critic_loss": 0.17593154311180115, "alpha_loss": -0.1763754040002823, "alpha_value": 0.9827302098274231, "log_alpha_value": -0.01742066629230976, "target_entropy": -6.0, "policy_t": -0.006029568146914244, "mean_q": 2.594306468963623, "max_q": 3.706587314605713, "min_q": 1.8779457807540894}, "td_error": [0.22615957260131836, 0.8061171770095825, 0.2928067445755005, 0.9214059114456177, 0.6085834503173828, 1.1662707328796387, 0.3247509002685547, 0.5149654150009155, 0.43562233448028564, 1.591148853302002, 4.41762638092041, 0.09686052799224854, 0.28677546977996826, 0.15199685096740723, 0.929837703704834, 2.975759506225586, 3.311131477355957, 1.3872716426849365, 1.629647970199585, 1.239380121231079, 0.19388103485107422, 1.4703606367111206, 1.4011585712432861, 0.3863505721092224, 0.9009298086166382, 0.152044415473938, 1.3327627182006836, 1.26320219039917, 0.2048780918121338, 1.0514099597930908, 0.8342161178588867, 0.125, 0.8800650835037231, 0.2603771686553955, 0.6629939079284668, 1.767829179763794, 1.921545147895813, 0.3499598503112793, 2.082634687423706, 2.106538772583008, 0.29984402656555176, 2.838064670562744, 1.0752055644989014, 1.5989925861358643, 0.26791298389434814, 0.2025456428527832, 2.0892434120178223, 0.5482280254364014, 2.8146424293518066, 1.2615418434143066, 0.7604930400848389, 1.0679030418395996, 0.5197398066520691, 1.8880513906478882, 0.5450299978256226, 1.3849291801452637, 0.4704914093017578, 0.8626409769058228, 1.1777753829956055, 0.22274279594421387, 1.7157001495361328, 2.1309304237365723, 1.314088225364685, 1.9514116048812866, 0.1338576078414917, 0.9215861558914185, 0.2739757299423218, 0.17934787273406982, 2.300283432006836, 0.031170010566711426, 0.6862488985061646, 0.21377837657928467, 3.2992732524871826, 2.313544750213623, 0.1817854642868042, 2.017949104309082, 2.694859027862549, 1.9288315773010254, 2.2968389987945557, 0.9160183668136597, 2.8869993686676025, 2.080220937728882, 0.13539636135101318, 0.6748080253601074, 0.22303122282028198, 1.476072072982788], "mean_td_error": 1.1573985815048218, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099608421325684, "actor_loss": -6.677587985992432, "critic_loss": 0.2508620619773865, "alpha_loss": -0.1757524460554123, "alpha_value": 0.9827486276626587, "log_alpha_value": -0.017401907593011856, "target_entropy": -6.0, "policy_t": -0.02011224627494812, "mean_q": 2.749551773071289, "max_q": 3.5332844257354736, "min_q": 2.0560476779937744}, "td_error": [2.137589931488037, 1.601443886756897, 1.0749307870864868, 0.8316577672958374, 0.9358776807785034, 0.7298825979232788, 0.29708921909332275, 0.972684383392334, 1.3400195837020874, 2.3964433670043945, 0.9132074117660522, 1.6948277950286865, 1.7740682363510132, 0.5733489990234375, 0.915406346321106, 2.0126354694366455, 1.0950372219085693, 0.3235621452331543, 0.05139291286468506, 2.864467144012451, 2.866715908050537, 5.73635721206665, 2.6649117469787598, 0.13775038719177246, 0.6685688495635986, 0.9968403577804565, 0.2436462640762329, 0.6628032922744751, 1.9765684604644775, 0.546789288520813, 0.5820918083190918, 1.2548869848251343, 1.2189679145812988, 1.093501329421997, 2.4942431449890137, 1.1160892248153687, 3.979175090789795, 0.46369361877441406, 0.4523240327835083, 0.12934041023254395, 1.1318590641021729, 1.524393916130066, 0.0977938175201416, 0.2274000644683838, 0.10692644119262695, 0.5364151000976562, 2.012545585632324, 0.9906034469604492, 0.18224692344665527, 1.823024868965149, 0.8648718595504761, 0.336963415145874, 1.0746549367904663, 0.10518169403076172, 0.9226508140563965, 1.4643585681915283, 3.1035780906677246, 0.9920336008071899, 2.739861488342285, 1.6294965744018555, 3.4417543411254883, 1.1176795959472656, 0.7807630300521851, 1.1661155223846436, 1.7726457118988037, 1.9330708980560303, 2.4082813262939453, 5.310109615325928, 1.0236411094665527, 3.453868865966797, 0.644597053527832, 0.7639099359512329, 0.3167893886566162, 0.16000592708587646, 0.5854181051254272, 0.9122301340103149, 0.623361349105835, 0.5297777652740479, 3.5785441398620605, 0.820728063583374, 0.18868231773376465, 2.7562334537506104, 2.1321187019348145, 1.5440311431884766, 0.1460576057434082, 0.49024498462677], "mean_td_error": 1.3289344310760498, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 486.2784342339519, "num_env_steps_trained_throughput_per_sec": 140.02213842897277, "timesteps_total": 53760, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 2029.437, "sample_time_ms": 1424.207, "load_time_ms": 0.535, "load_throughput": 482168.352, "learn_time_ms": 62.495, "learn_throughput": 4128.326, "synch_weights_time_ms": 15.118}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-24", "timestamp": 1700203104, "time_this_iter_s": 1.859238862991333, "time_total_s": 123.10522508621216, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff505264a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 123.10522508621216, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 64.23333333333333, "ram_util_percent": 92.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.959240913391113, "actor_loss": -8.20472240447998, "critic_loss": 0.4115546643733978, "alpha_loss": -0.17628122866153717, "alpha_value": 0.9824554324150085, "log_alpha_value": -0.01770026795566082, "target_entropy": -6.0, "policy_t": 0.005761425476521254, "mean_q": 4.443935871124268, "max_q": 6.093152046203613, "min_q": 3.5748846530914307}, "td_error": [2.479759693145752, 1.7681840658187866, 0.5187548398971558, 0.08541345596313477, 2.1393656730651855, 1.2309455871582031, 1.2719839811325073, 1.94956636428833, 5.307270050048828, 5.137938976287842, 2.6580722332000732, 0.10462021827697754, 1.651426911354065, 4.681243896484375, 0.6316056251525879, 0.4840075969696045, 4.56711483001709, 0.4707953929901123, 0.8950334787368774, 1.903893232345581, 0.23867619037628174, 0.49433207511901855, 0.16611623764038086, 0.9568688869476318, 1.0910906791687012, 0.841760516166687, 1.9283689260482788, 0.16330456733703613, 1.0730805397033691, 0.338381290435791, 1.8362244367599487, 0.8010599613189697, 1.1381959915161133, 2.0021069049835205, 0.9722079038619995, 0.9890532493591309, 1.5453903675079346, 0.35142433643341064, 0.6450424194335938, 1.460784912109375, 0.7819652557373047, 0.742661714553833, 4.838443756103516, 0.25188231468200684, 1.7283918857574463, 0.31577587127685547, 1.2117619514465332, 0.5747172832489014, 0.975175142288208, 4.094084739685059, 2.386110544204712, 0.8279106616973877, 3.6540720462799072, 4.553750514984131, 0.23629701137542725, 1.169480800628662, 0.16545701026916504, 1.2197556495666504, 0.08984816074371338, 7.064976215362549, 2.619619607925415, 0.08966207504272461, 2.1291182041168213, 0.5028325319290161, 1.3424791097640991, 3.55318021774292, 3.7191238403320312, 0.9732286930084229, 2.5386548042297363, 0.8242557048797607, 4.16078519821167, 0.2629718780517578, 0.8041998147964478, 1.3104140758514404, 0.6701436042785645, 2.442934989929199, 3.260274648666382, 0.3162086009979248, 2.2796788215637207, 1.6685150861740112, 2.77439546585083, 1.4583728313446045, 6.483160972595215, 4.863479137420654, 2.7171788215637207, 1.414087176322937], "mean_td_error": 1.756185531616211, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09335708618164, "actor_loss": -6.617805004119873, "critic_loss": 0.17319589853286743, "alpha_loss": -0.17886532843112946, "alpha_value": 0.9824349880218506, "log_alpha_value": -0.017721092328429222, "target_entropy": -6.0, "policy_t": 0.0179018285125494, "mean_q": 2.6109251976013184, "max_q": 3.465956687927246, "min_q": 1.891628384590149}, "td_error": [2.613586664199829, 0.5750772953033447, 1.2144569158554077, 0.39569318294525146, 0.37263381481170654, 0.9448363780975342, 0.6965323686599731, 0.6702029705047607, 0.5992764234542847, 0.7253568172454834, 1.9219847917556763, 0.5587252378463745, 0.744779109954834, 1.1431838274002075, 2.685673236846924, 0.528509259223938, 0.35628700256347656, 1.7117782831192017, 0.4055386781692505, 2.3153955936431885, 2.563650608062744, 0.3209443688392639, 0.9996051788330078, 0.03989303112030029, 0.5508346557617188, 0.3129068613052368, 0.3553274869918823, 2.4191038608551025, 3.553793430328369, 0.7593603134155273, 0.3707287311553955, 2.0856986045837402, 1.753639578819275, 1.8929057121276855, 1.2618225812911987, 0.37502050399780273, 0.7378793954849243, 0.9656332731246948, 2.3586063385009766, 0.26157212257385254, 1.4578100442886353, 3.1536812782287598, 2.104624032974243, 0.9245307445526123, 3.033175230026245, 0.2003459334373474, 0.20627331733703613, 0.5185014009475708, 1.9160223007202148, 0.28832995891571045, 0.794528603553772, 3.658690929412842, 1.9072717428207397, 0.2054816484451294, 3.0985870361328125, 1.8422210216522217, 0.05433213710784912, 1.3646209239959717, 1.9165066480636597, 2.0290374755859375, 1.516173005104065, 1.1084190607070923, 0.27177417278289795, 0.02651798725128174, 2.9188146591186523, 1.8826600313186646, 0.5359611511230469, 0.19276463985443115, 0.5029977560043335, 2.956887722015381, 1.8231048583984375, 0.14501440525054932, 1.1935914754867554, 0.09229636192321777, 0.7837510704994202, 0.27590060234069824, 0.4939415454864502, 2.050180196762085, 0.4157928228378296, 1.1815223693847656, 1.1907137632369995, 1.6456602811813354, 0.18045365810394287, 0.4629932641983032, 0.4042140245437622, 0.3063642978668213], "mean_td_error": 1.1668776273727417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093510627746582, "actor_loss": -6.640679836273193, "critic_loss": 0.23396340012550354, "alpha_loss": -0.17867498099803925, "alpha_value": 0.9824537634849548, "log_alpha_value": -0.01770196668803692, "target_entropy": -6.0, "policy_t": 0.021717924624681473, "mean_q": 2.721362829208374, "max_q": 3.3095908164978027, "min_q": 1.9460493326187134}, "td_error": [2.914809465408325, 2.568049192428589, 0.7668427228927612, 1.0880060195922852, 0.18745994567871094, 0.36417412757873535, 1.4207768440246582, 0.11903315782546997, 2.588931083679199, 0.8097121715545654, 0.717778205871582, 0.34145355224609375, 1.245718240737915, 0.39597606658935547, 2.7135136127471924, 0.7525064945220947, 3.3488214015960693, 0.5222434997558594, 0.8438740968704224, 0.5772374868392944, 1.4195677042007446, 1.1246802806854248, 0.90886390209198, 1.2405238151550293, 1.5000486373901367, 0.21666383743286133, 2.3753578662872314, 0.10602009296417236, 1.3659660816192627, 0.4687204360961914, 0.10453832149505615, 0.47838640213012695, 1.601722240447998, 3.3878235816955566, 0.9798171520233154, 2.3644626140594482, 0.8424626588821411, 0.996253490447998, 1.880588412284851, 0.28729987144470215, 0.46809089183807373, 0.4906003475189209, 0.2848395109176636, 2.8767294883728027, 1.924487590789795, 1.443908452987671, 1.0559011697769165, 0.7132221460342407, 2.1848278045654297, 0.055060505867004395, 0.3436770439147949, 0.822527289390564, 0.9920034408569336, 1.3962688446044922, 1.0042599439620972, 0.27130043506622314, 0.25425922870635986, 0.7870931625366211, 0.5010603666305542, 0.8834011554718018, 0.36626946926116943, 2.3185646533966064, 3.0441858768463135, 4.083865165710449, 0.4498482346534729, 0.5616945028305054, 3.6286873817443848, 1.3445520401000977, 3.951587200164795, 1.021968126296997, 1.5653173923492432, 1.7595690488815308, 0.6659328937530518, 0.9014431238174438, 2.128175735473633, 0.7563313245773315, 2.0636346340179443, 2.0950331687927246, 1.8883943557739258, 0.09204733371734619, 1.822609782218933, 0.6388322114944458, 1.2463806867599487, 0.9722410440444946, 2.555665969848633, 0.6308932304382324], "mean_td_error": 1.2702782154083252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 459.4798088378271, "num_env_steps_trained_throughput_per_sec": 132.30556995553505, "timesteps_total": 54656, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 1977.531, "sample_time_ms": 1404.867, "load_time_ms": 0.538, "load_throughput": 479370.263, "learn_time_ms": 62.53, "learn_throughput": 4126.029, "synch_weights_time_ms": 15.21}, "counters": {"num_env_steps_sampled": 54656, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 15480, "last_target_update_ts": 54656, "num_target_updates": 60}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-26", "timestamp": 1700203106, "time_this_iter_s": 1.9666779041290283, "time_total_s": 125.07190299034119, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07633a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 125.07190299034119, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 68.8, "ram_util_percent": 92.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073799133300781, "actor_loss": -8.10824966430664, "critic_loss": 0.3667640686035156, "alpha_loss": -0.18132229149341583, "alpha_value": 0.9821616411209106, "log_alpha_value": -0.01799939200282097, "target_entropy": -6.0, "policy_t": -0.007717328146100044, "mean_q": 4.265829563140869, "max_q": 5.494886875152588, "min_q": 3.423574447631836}, "td_error": [3.6886963844299316, 1.463742733001709, 1.3928089141845703, 2.1033341884613037, 0.4958144426345825, 0.029777884483337402, 2.029745101928711, 3.6966538429260254, 4.553361892700195, 1.1763899326324463, 2.4446356296539307, 1.4274462461471558, 0.19932079315185547, 0.20455682277679443, 1.3869318962097168, 0.9240097999572754, 0.8165379762649536, 1.6249440908432007, 2.116576671600342, 1.9255056381225586, 0.25854480266571045, 1.6026642322540283, 0.5895731449127197, 0.9600701332092285, 2.7449839115142822, 0.28175508975982666, 1.1625916957855225, 0.6124558448791504, 5.493334770202637, 0.3384819030761719, 1.9079859256744385, 3.256528377532959, 0.20996129512786865, 0.25681018829345703, 0.3571760654449463, 4.933061599731445, 0.21067631244659424, 2.3274054527282715, 3.1125407218933105, 0.8017152547836304, 0.33274614810943604, 0.31467723846435547, 2.1535792350769043, 4.65380334854126, 0.6365795135498047, 0.8591097593307495, 0.37638068199157715, 1.6246979236602783, 1.1715220212936401, 6.196699619293213, 0.7366447448730469, 0.368380069732666, 0.3301882743835449, 1.8675639629364014, 3.2376983165740967, 0.7114355564117432, 1.570180058479309, 2.1243882179260254, 0.6876034736633301, 0.2228463888168335, 1.4030046463012695, 3.77336049079895, 9.129781723022461, 0.4276564121246338, 0.9327176809310913, 1.7600446939468384, 1.9394927024841309, 1.0927269458770752, 1.3041119575500488, 0.7205772399902344, 0.7651116847991943, 0.4713265895843506, 2.7724146842956543, 1.2267719507217407, 1.4920706748962402, 0.12027251720428467, 1.5799591541290283, 0.19535505771636963, 0.43379080295562744, 1.8107540607452393, 2.269331216812134, 1.9153544902801514, 1.396464228630066, 1.3795487880706787, 0.24270176887512207, 1.5540239810943604], "mean_td_error": 1.5977274179458618, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083076477050781, "actor_loss": -6.665132522583008, "critic_loss": 0.21463556587696075, "alpha_loss": -0.18171200156211853, "alpha_value": 0.9821399450302124, "log_alpha_value": -0.018021484836935997, "target_entropy": -6.0, "policy_t": -0.005466114729642868, "mean_q": 2.65842342376709, "max_q": 3.5586345195770264, "min_q": 1.8086307048797607}, "td_error": [0.9554915428161621, 3.3070335388183594, 0.9135586023330688, 0.8957037925720215, 2.312286376953125, 0.9423062801361084, 1.5048367977142334, 3.5572800636291504, 0.7937239408493042, 0.16917943954467773, 0.1485844850540161, 0.45444369316101074, 2.8794126510620117, 0.15731370449066162, 1.418792486190796, 1.4842276573181152, 1.411383867263794, 0.718032717704773, 0.5663808584213257, 1.105237603187561, 1.247353196144104, 1.9321001768112183, 3.0462889671325684, 0.9041516780853271, 2.881762981414795, 0.5649158358573914, 3.2088890075683594, 4.782113075256348, 1.0232596397399902, 0.7977957725524902, 1.2537100315093994, 1.2396451234817505, 0.05254185199737549, 1.6219559907913208, 0.3490922451019287, 0.9575389623641968, 1.0460606813430786, 4.590856075286865, 2.0933666229248047, 0.7849987745285034, 0.3914988040924072, 1.7131403684616089, 0.4918452501296997, 0.3656960725784302, 2.16377854347229, 2.6156978607177734, 0.8264487981796265, 0.3436051607131958, 1.8522604703903198, 0.3929750919342041, 0.8499244451522827, 0.850212812423706, 0.8257595300674438, 0.2507162094116211, 0.8093641996383667, 0.6912788152694702, 1.133594274520874, 1.3863861560821533, 0.2922006845474243, 1.9872902631759644, 1.448417067527771, 0.9736464023590088, 0.6005648374557495, 1.7207648754119873, 1.946528673171997, 2.2678844928741455, 3.581162452697754, 1.0396316051483154, 0.7677047252655029, 0.599352240562439, 0.9762657880783081, 4.57208251953125, 0.33470284938812256, 0.6533122062683105, 0.7821264266967773, 1.1974055767059326, 0.33252787590026855, 0.37152111530303955, 0.07152855396270752, 1.992746114730835, 0.42825162410736084, 1.9629580974578857, 1.8354653120040894, 2.600231647491455, 3.5203702449798584, 1.090103030204773], "mean_td_error": 1.3717968463897705, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069822311401367, "actor_loss": -6.563226699829102, "critic_loss": 0.25018054246902466, "alpha_loss": -0.1812773197889328, "alpha_value": 0.9821590185165405, "log_alpha_value": -0.018002038821578026, "target_entropy": -6.0, "policy_t": -0.01100841723382473, "mean_q": 2.642287254333496, "max_q": 3.451616048812866, "min_q": 1.9373695850372314}, "td_error": [1.5336166620254517, 0.5142383575439453, 0.6937940120697021, 1.2149274349212646, 2.2853386402130127, 0.09823024272918701, 3.734020709991455, 3.386234998703003, 1.8917009830474854, 0.3475968837738037, 0.5566924810409546, 0.4788527488708496, 0.3086881637573242, 2.3604955673217773, 0.06703376770019531, 4.862677574157715, 2.8288540840148926, 2.6975948810577393, 2.1707546710968018, 0.7815903425216675, 0.5272338390350342, 2.025538206100464, 1.3294545412063599, 0.8168692588806152, 1.9833056926727295, 0.8545870780944824, 1.2845598459243774, 0.5260970592498779, 0.4415719509124756, 1.10231351852417, 0.020018458366394043, 0.68543940782547, 0.5479481220245361, 0.9967812299728394, 0.3706181049346924, 0.0701528787612915, 0.6575268507003784, 0.5395573377609253, 0.3630564212799072, 0.6246927380561829, 1.446761965751648, 2.008610248565674, 0.3809918165206909, 2.534883499145508, 1.7020785808563232, 2.85555362701416, 0.14559471607208252, 0.4754716157913208, 1.991878628730774, 1.414267897605896, 0.6087762117385864, 1.5167282819747925, 2.6457676887512207, 2.105325937271118, 0.8480958938598633, 1.8195016384124756, 0.34838879108428955, 2.590693235397339, 0.987094521522522, 0.14951622486114502, 0.17404234409332275, 0.5176713466644287, 1.4574518203735352, 1.2989883422851562, 1.111757516860962, 0.7814159393310547, 2.3475213050842285, 1.8690487146377563, 2.0379438400268555, 0.6977496147155762, 1.9194475412368774, 2.041067123413086, 4.264957427978516, 0.420330286026001, 0.8350871801376343, 1.3043935298919678, 1.4243375062942505, 1.795785903930664, 1.2060191631317139, 1.1818408966064453, 0.17458724975585938, 0.06590569019317627, 0.10966825485229492, 0.821251630783081, 3.121847152709961, 2.4462943077087402], "mean_td_error": 1.3091005086898804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 440.6085757487897, "num_env_steps_trained_throughput_per_sec": 126.87166578480775, "timesteps_total": 55552, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 1977.559, "sample_time_ms": 1405.478, "load_time_ms": 0.538, "load_throughput": 479816.624, "learn_time_ms": 62.383, "learn_throughput": 4135.724, "synch_weights_time_ms": 15.117}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-28", "timestamp": 1700203108, "time_this_iter_s": 2.0500829219818115, "time_total_s": 127.121985912323, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0763040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 127.121985912323, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 71.63333333333334, "ram_util_percent": 92.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090540885925293, "actor_loss": -8.208874702453613, "critic_loss": 0.37554025650024414, "alpha_loss": -0.18464262783527374, "alpha_value": 0.981867790222168, "log_alpha_value": -0.018298586830496788, "target_entropy": -6.0, "policy_t": 0.043288666754961014, "mean_q": 4.285787105560303, "max_q": 5.482813835144043, "min_q": 3.2690367698669434}, "td_error": [4.6644792556762695, 0.6626696586608887, 1.2684623003005981, 0.2942800521850586, 2.3851778507232666, 1.0139703750610352, 1.9178946018218994, 5.003318786621094, 0.9405651092529297, 6.382117748260498, 0.363383412361145, 0.7091629505157471, 5.9031662940979, 0.5087968111038208, 1.1671268939971924, 0.18466484546661377, 0.510643720626831, 5.789758205413818, 1.4438672065734863, 1.3048348426818848, 0.24279236793518066, 0.758371114730835, 0.39365196228027344, 2.9210479259490967, 0.41866469383239746, 0.8974463939666748, 0.788777232170105, 3.195234537124634, 1.9580069780349731, 0.18799901008605957, 0.5161468982696533, 0.07123351097106934, 2.68210768699646, 0.8355011940002441, 3.941603899002075, 1.1884806156158447, 3.3806142807006836, 1.3933583498001099, 0.15571343898773193, 1.4973102807998657, 0.28605878353118896, 0.13161790370941162, 1.0191066265106201, 2.6657376289367676, 0.5205976963043213, 0.07812309265136719, 1.4252866506576538, 2.71943736076355, 2.862851858139038, 1.264262080192566, 0.37849390506744385, 0.7824791669845581, 0.9734721183776855, 2.5506680011749268, 1.9532936811447144, 3.4442806243896484, 0.24030208587646484, 4.9011549949646, 1.0062652826309204, 0.7933845520019531, 1.3280689716339111, 0.5893738269805908, 3.508419990539551, 0.46083664894104004, 1.0755383968353271, 0.9616672992706299, 0.509441614151001, 1.6119250059127808, 0.35842669010162354, 3.516573190689087, 1.588439702987671, 1.6444272994995117, 0.1839733123779297, 1.431513786315918, 1.9672975540161133, 3.154656410217285, 3.1070845127105713, 0.31501173973083496, 1.4264236688613892, 0.2738245725631714, 5.411391735076904, 0.9820666313171387, 0.39059877395629883, 1.1745747327804565, 1.078815221786499, 0.9911322593688965], "mean_td_error": 1.614892840385437, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.170616149902344, "actor_loss": -6.56794548034668, "critic_loss": 0.18060538172721863, "alpha_loss": -0.1863442361354828, "alpha_value": 0.9818450212478638, "log_alpha_value": -0.018321821466088295, "target_entropy": -6.0, "policy_t": 0.019832739606499672, "mean_q": 2.472951650619507, "max_q": 3.446579694747925, "min_q": 1.8209683895111084}, "td_error": [2.324509620666504, 1.2502704858779907, 2.475062847137451, 1.957977294921875, 0.731205940246582, 1.2158069610595703, 0.4819362163543701, 1.4072296619415283, 0.23539721965789795, 0.19364488124847412, 2.4209675788879395, 1.143932580947876, 0.9358018636703491, 1.7702170610427856, 1.5426349639892578, 0.30911409854888916, 0.6665955185890198, 0.5505555868148804, 1.010561227798462, 1.869931936264038, 1.7413785457611084, 1.084882378578186, 0.2996460199356079, 1.8073341846466064, 0.1139070987701416, 1.3533899784088135, 0.4348143935203552, 1.208917260169983, 0.9259068965911865, 2.070949077606201, 0.8097256422042847, 0.998822808265686, 0.9324545860290527, 2.300990343093872, 1.2975916862487793, 0.17178237438201904, 0.09702682495117188, 1.2738631963729858, 1.12276291847229, 2.3897247314453125, 1.2903228998184204, 0.8650333881378174, 1.2490869760513306, 0.02879047393798828, 1.8426899909973145, 0.2695390582084656, 0.8683502674102783, 0.6182498931884766, 1.2094932794570923, 0.7103359699249268, 3.6753077507019043, 3.69171142578125, 0.03490757942199707, 0.4474306106567383, 0.06740415096282959, 0.29609405994415283, 0.6797086000442505, 4.045461654663086, 0.30520009994506836, 1.2495684623718262, 0.14144062995910645, 0.7792383432388306, 1.9820184707641602, 1.6355328559875488, 2.7896323204040527, 2.353740930557251, 0.5105934143066406, 2.0489416122436523, 2.0036683082580566, 0.31404781341552734, 1.9624178409576416, 1.0413944721221924, 0.4331604242324829, 0.5553199052810669, 0.19135868549346924, 2.269153118133545, 0.5716062784194946, 0.9867984056472778, 0.5376510620117188, 2.078277587890625, 1.5526846647262573, 1.185420036315918, 1.0863566398620605, 2.4819164276123047, 1.621269941329956, 0.4583491086959839], "mean_td_error": 1.208673119544983, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.157889366149902, "actor_loss": -6.568551540374756, "critic_loss": 0.24559840559959412, "alpha_loss": -0.18591031432151794, "alpha_value": 0.9818643927574158, "log_alpha_value": -0.018302062526345253, "target_entropy": -6.0, "policy_t": -0.003516400931403041, "mean_q": 2.5771660804748535, "max_q": 3.2930562496185303, "min_q": 1.8678171634674072}, "td_error": [0.2971053123474121, 1.6222585439682007, 1.3570185899734497, 4.15314245223999, 1.5946788787841797, 0.8650718927383423, 0.103171706199646, 0.07364952564239502, 0.5897209644317627, 0.5496983528137207, 0.5184236764907837, 0.6612126231193542, 0.43005216121673584, 0.0948019027709961, 4.566143989562988, 1.4459583759307861, 0.8458395004272461, 2.167971611022949, 0.690840482711792, 1.2745906114578247, 1.0204168558120728, 0.31675219535827637, 3.334024429321289, 1.2701482772827148, 1.5290586948394775, 2.189061403274536, 0.5578606128692627, 2.306626796722412, 1.0396227836608887, 2.062516689300537, 0.3429652452468872, 1.8417493104934692, 0.820050835609436, 1.5552576780319214, 1.6612497568130493, 0.1060795783996582, 0.06301248073577881, 1.0417786836624146, 1.6334396600723267, 1.0538755655288696, 1.1220587491989136, 1.999474287033081, 0.968167781829834, 0.9227654933929443, 0.24979913234710693, 1.2516186237335205, 1.1255314350128174, 3.067857027053833, 0.6754237413406372, 0.7788717746734619, 4.184459209442139, 1.2423057556152344, 4.240377426147461, 0.27453410625457764, 1.5891114473342896, 0.2401217222213745, 0.07609856128692627, 1.4744188785552979, 0.14744532108306885, 1.2618930339813232, 0.5304303169250488, 0.6344923973083496, 1.2894766330718994, 0.47742950916290283, 2.7144174575805664, 1.279974102973938, 3.866365909576416, 0.46803414821624756, 2.44484806060791, 1.7763307094573975, 0.9383459091186523, 0.11101841926574707, 0.30659782886505127, 1.196053385734558, 0.11284160614013672, 1.466499924659729, 2.336878776550293, 1.5660083293914795, 2.569572925567627, 1.0800691843032837, 0.7291666269302368, 2.410001754760742, 0.7675920724868774, 1.2390110492706299, 1.9082095623016357, 0.841404914855957], "mean_td_error": 1.2976778745651245, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 463.14966029989836, "num_env_steps_trained_throughput_per_sec": 133.36229057742608, "timesteps_total": 56448, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 169344, "timers": {"training_iteration_time_ms": 1956.797, "sample_time_ms": 1383.864, "load_time_ms": 0.537, "load_throughput": 480093.359, "learn_time_ms": 62.265, "learn_throughput": 4143.588, "synch_weights_time_ms": 15.143}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 169344, "num_agent_steps_trained": 15996, "last_target_update_ts": 56448, "num_target_updates": 62}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-30", "timestamp": 1700203110, "time_this_iter_s": 1.9477171897888184, "time_total_s": 129.06970310211182, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 129.06970310211182, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 90.65, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028279304504395, "actor_loss": -8.030573844909668, "critic_loss": 0.35067522525787354, "alpha_loss": -0.18650482594966888, "alpha_value": 0.9815739989280701, "log_alpha_value": -0.018597889691591263, "target_entropy": -6.0, "policy_t": -0.0031325076706707478, "mean_q": 4.166426181793213, "max_q": 5.722611904144287, "min_q": 3.3592753410339355}, "td_error": [4.328464031219482, 0.11694562435150146, 4.3568010330200195, 0.33896195888519287, 0.35817980766296387, 0.42391538619995117, 0.5569777488708496, 1.808721661567688, 0.05893993377685547, 0.15441489219665527, 1.7836834192276, 4.693490028381348, 0.12681710720062256, 0.8442802429199219, 0.24841809272766113, 0.417622447013855, 1.4645644426345825, 0.3926299810409546, 4.832164287567139, 2.7770700454711914, 0.5514507293701172, 1.027984619140625, 1.2776492834091187, 0.5343785285949707, 4.454008102416992, 0.6676397323608398, 0.9392318725585938, 2.96220064163208, 0.5740265846252441, 2.1143009662628174, 0.5860763788223267, 1.0907765626907349, 1.385723352432251, 2.124509811401367, 1.1780061721801758, 1.5042548179626465, 3.596738815307617, 1.2846040725708008, 2.850087881088257, 4.0035624504089355, 1.668686032295227, 1.957607626914978, 0.9960426092147827, 0.8655612468719482, 0.1069788932800293, 0.19157958030700684, 1.695460557937622, 0.3304729461669922, 1.7017680406570435, 0.2576380968093872, 3.158336639404297, 3.5238592624664307, 3.251267910003662, 1.781853437423706, 0.28907597064971924, 2.587278366088867, 0.2048501968383789, 0.8554748296737671, 1.6356854438781738, 4.99448823928833, 2.298171043395996, 3.8734428882598877, 3.4805543422698975, 0.5690680742263794, 0.6460573673248291, 0.558273196220398, 1.053224802017212, 1.5228955745697021, 0.3599228858947754, 1.2446483373641968, 1.7858388423919678, 1.041808009147644, 0.8129935264587402, 1.4514973163604736, 1.0898855924606323, 1.9484312534332275, 2.3328027725219727, 2.1052157878875732, 2.52130389213562, 0.8978443145751953, 0.46864891052246094, 0.03720355033874512, 0.23505353927612305, 1.2207849025726318, 0.21191394329071045, 0.26970362663269043], "mean_td_error": 1.5218771696090698, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106648445129395, "actor_loss": -6.533050537109375, "critic_loss": 0.16363593935966492, "alpha_loss": -0.18820929527282715, "alpha_value": 0.9815499782562256, "log_alpha_value": -0.018622325733304024, "target_entropy": -6.0, "policy_t": -0.005604730919003487, "mean_q": 2.547050714492798, "max_q": 3.5299174785614014, "min_q": 1.6558741331100464}, "td_error": [0.3253387212753296, 0.23183071613311768, 1.6909687519073486, 0.7439851760864258, 0.49690473079681396, 0.6184616088867188, 1.4176232814788818, 4.192024230957031, 1.2967727184295654, 0.5244839191436768, 1.3687167167663574, 1.6906452178955078, 0.10309791564941406, 2.0621261596679688, 1.6771022081375122, 0.8516271114349365, 2.1990840435028076, 0.7748216390609741, 1.1456378698349, 1.3581777811050415, 0.5143734216690063, 0.6619203090667725, 1.9788364171981812, 0.13004231452941895, 0.5336661338806152, 0.33634281158447266, 1.539097547531128, 1.4073657989501953, 3.0182528495788574, 0.2634720802307129, 0.7526588439941406, 1.6393965482711792, 0.20371246337890625, 1.6719703674316406, 0.29665279388427734, 1.0837267637252808, 1.8420263528823853, 0.18945860862731934, 1.6827378273010254, 0.705470085144043, 3.1711184978485107, 0.2660819888114929, 0.6465388536453247, 0.5220557451248169, 3.077238082885742, 1.610733985900879, 0.6408287286758423, 1.0982097387313843, 1.100663185119629, 0.6321591138839722, 0.3612818717956543, 2.2626523971557617, 0.5994687080383301, 0.37654852867126465, 1.1232812404632568, 0.5333616733551025, 0.30223894119262695, 0.3343358039855957, 0.6642706394195557, 0.44894278049468994, 0.5782158374786377, 0.6775158643722534, 2.123044013977051, 2.404329776763916, 3.967945098876953, 0.8393824100494385, 0.2791482210159302, 0.8673112392425537, 1.5708003044128418, 0.8973292112350464, 1.3587665557861328, 1.817946434020996, 1.9220654964447021, 0.346441388130188, 2.8448944091796875, 1.7053226232528687, 2.345677614212036, 0.8375431299209595, 1.082588791847229, 1.0119493007659912, 1.6258771419525146, 0.33844542503356934, 0.8701720237731934, 0.2629544734954834, 0.4056241512298584, 0.5671297311782837], "mean_td_error": 1.145825982093811, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090130805969238, "actor_loss": -6.511579513549805, "critic_loss": 0.2106894552707672, "alpha_loss": -0.18769927322864532, "alpha_value": 0.9815697073936462, "log_alpha_value": -0.018602263182401657, "target_entropy": -6.0, "policy_t": -0.0028899579774588346, "mean_q": 2.579024314880371, "max_q": 3.2877819538116455, "min_q": 1.9786752462387085}, "td_error": [0.30191493034362793, 0.13353610038757324, 1.1023225784301758, 3.2812857627868652, 0.44755351543426514, 1.5501689910888672, 0.4458238482475281, 1.416221261024475, 1.0757098197937012, 0.6517255306243896, 2.9598231315612793, 0.47790563106536865, 1.4709385633468628, 0.12326359748840332, 0.26821160316467285, 0.9806632995605469, 2.6067142486572266, 0.6228296756744385, 0.6492793560028076, 0.5142737627029419, 0.9408353567123413, 1.078614592552185, 1.2987850904464722, 6.7199602127075195, 1.81948983669281, 0.7099868059158325, 1.549237847328186, 0.37040019035339355, 1.164857268333435, 2.6753835678100586, 0.1250138282775879, 0.7026058435440063, 1.946503758430481, 0.06287550926208496, 2.2215943336486816, 0.6035908460617065, 1.5236343145370483, 0.7183581590652466, 2.141324758529663, 1.6470836400985718, 1.1457070112228394, 1.4745514392852783, 0.99129319190979, 3.3763976097106934, 0.47846031188964844, 0.4355117082595825, 1.7228437662124634, 0.6019866466522217, 2.263730764389038, 2.801823854446411, 0.25813210010528564, 1.428783893585205, 0.6243265867233276, 0.7061376571655273, 0.9890004396438599, 0.6901476383209229, 0.8072588443756104, 3.722489833831787, 0.4208947420120239, 0.9916013479232788, 1.9346164464950562, 0.18224191665649414, 0.11260056495666504, 0.9425371885299683, 0.818619966506958, 0.8063163757324219, 0.4976910352706909, 0.31085634231567383, 0.7794536352157593, 0.9169546365737915, 1.0349239110946655, 1.0996254682540894, 1.278756856918335, 1.0465772151947021, 1.6616302728652954, 0.24137663841247559, 2.4711050987243652, 2.16086483001709, 0.2985210418701172, 0.5446940660476685, 1.016548752784729, 1.53335440158844, 0.3529853820800781, 1.076562523841858, 0.13711762428283691, 1.1698086261749268], "mean_td_error": 1.1797410249710083, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 421.1568611058502, "num_env_steps_trained_throughput_per_sec": 121.27061402378276, "timesteps_total": 57344, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 1965.325, "sample_time_ms": 1392.615, "load_time_ms": 0.537, "load_throughput": 480818.64, "learn_time_ms": 62.249, "learn_throughput": 4144.628, "synch_weights_time_ms": 15.685}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-32", "timestamp": 1700203112, "time_this_iter_s": 2.1408798694610596, "time_total_s": 131.21058297157288, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07633a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 131.21058297157288, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 62.900000000000006, "ram_util_percent": 92.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083486557006836, "actor_loss": -8.09654426574707, "critic_loss": 0.37873971462249756, "alpha_loss": -0.19054898619651794, "alpha_value": 0.9812803268432617, "log_alpha_value": -0.018897132948040962, "target_entropy": -6.0, "policy_t": 0.030548032373189926, "mean_q": 4.165215969085693, "max_q": 5.140941619873047, "min_q": 3.122755765914917}, "td_error": [1.33433198928833, 4.211967945098877, 1.1150500774383545, 2.8496499061584473, 0.9356603622436523, 0.10721158981323242, 1.09698486328125, 0.8791799545288086, 2.516876697540283, 4.526922702789307, 0.40090203285217285, 0.7108640670776367, 1.953432559967041, 0.2170727252960205, 3.0819091796875, 2.0426928997039795, 0.29671525955200195, 0.6829104423522949, 0.671096682548523, 2.305206775665283, 2.7416744232177734, 0.6340087652206421, 0.7522757053375244, 0.3093125820159912, 0.19749140739440918, 0.24648308753967285, 1.7362494468688965, 0.37928175926208496, 2.37031888961792, 2.7005884647369385, 0.3695237636566162, 3.406482458114624, 0.9104655981063843, 1.5799312591552734, 1.4789628982543945, 0.21518778800964355, 2.428203582763672, 4.303374767303467, 0.8516755104064941, 4.431471824645996, 0.5492507219314575, 2.8273427486419678, 0.48903167247772217, 0.7478979825973511, 0.9522876739501953, 1.490196943283081, 0.8473677635192871, 1.0121532678604126, 4.765843391418457, 0.2287006378173828, 0.2613677978515625, 2.0242385864257812, 3.7386538982391357, 0.90586256980896, 0.8926297426223755, 0.33094513416290283, 0.1554112434387207, 4.242854595184326, 1.1426767110824585, 2.6979517936706543, 4.309544086456299, 1.4347801208496094, 3.7544264793395996, 0.4402608871459961, 0.20931458473205566, 2.2016377449035645, 1.8860793113708496, 0.2920718193054199, 2.3116321563720703, 2.7601706981658936, 5.377262115478516, 2.9667446613311768, 0.06956660747528076, 0.36517155170440674, 0.6383665800094604, 2.0045785903930664, 2.563875436782837, 2.7331109046936035, 0.3865983486175537, 0.8755793571472168, 2.4112253189086914, 0.5532212257385254, 0.24099576473236084, 1.7516303062438965, 2.154679775238037, 1.6996228694915771], "mean_td_error": 1.6357489824295044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069449424743652, "actor_loss": -6.494211673736572, "critic_loss": 0.20425420999526978, "alpha_loss": -0.19054239988327026, "alpha_value": 0.9812551140785217, "log_alpha_value": -0.018922818824648857, "target_entropy": -6.0, "policy_t": 0.015396424569189548, "mean_q": 2.5173861980438232, "max_q": 3.4037423133850098, "min_q": 1.6541105508804321}, "td_error": [1.2752310037612915, 0.404657244682312, 2.506408214569092, 0.37122488021850586, 0.14876770973205566, 3.442355155944824, 2.14577579498291, 0.8028929233551025, 0.3728048801422119, 0.2492811679840088, 2.0728847980499268, 1.4668223857879639, 2.2619566917419434, 0.067230224609375, 2.937990188598633, 0.7633099555969238, 1.9576607942581177, 0.31115221977233887, 0.20501601696014404, 1.9904202222824097, 1.0629266500473022, 2.2448668479919434, 0.12810909748077393, 1.7683839797973633, 1.5912708044052124, 1.0246613025665283, 1.496035099029541, 1.0363564491271973, 1.8138242959976196, 1.6880828142166138, 0.47455906867980957, 1.2777483463287354, 1.8719899654388428, 0.3101004958152771, 1.1390657424926758, 0.4759488105773926, 1.6359474658966064, 0.4311354160308838, 0.2138807773590088, 0.795222282409668, 0.10517525672912598, 0.8026230335235596, 0.4859623908996582, 1.9336092472076416, 1.408329963684082, 3.8632607460021973, 1.7309061288833618, 1.8930250406265259, 1.1264913082122803, 1.0990955829620361, 0.5120958089828491, 0.6098711490631104, 2.137951135635376, 1.1839869022369385, 2.5484418869018555, 1.5308818817138672, 0.18088841438293457, 0.15283405780792236, 1.2348747253417969, 2.556178331375122, 1.5151649713516235, 0.3715618848800659, 0.8875032663345337, 0.9434226155281067, 0.11655521392822266, 0.9122002124786377, 0.9077785015106201, 1.8681927919387817, 1.8219982385635376, 2.0993614196777344, 1.9564608335494995, 3.454894542694092, 0.8543409109115601, 2.438675880432129, 0.6588858366012573, 2.4476237297058105, 1.7653868198394775, 0.1404486894607544, 2.3554980754852295, 0.7594679594039917, 1.8410223722457886, 0.3197040557861328, 2.1599040031433105, 1.953183650970459, 2.2760066986083984, 0.47644495964050293], "mean_td_error": 1.309675931930542, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136478424072266, "actor_loss": -6.468795299530029, "critic_loss": 0.21945995092391968, "alpha_loss": -0.19160428643226624, "alpha_value": 0.9812750816345215, "log_alpha_value": -0.018902450799942017, "target_entropy": -6.0, "policy_t": 0.008112622424960136, "mean_q": 2.4835948944091797, "max_q": 3.1646127700805664, "min_q": 1.8883171081542969}, "td_error": [0.2880204916000366, 3.849599838256836, 1.0379546880722046, 0.7607403993606567, 0.5068656206130981, 0.18215394020080566, 0.9443423748016357, 0.5884041786193848, 1.49396812915802, 2.1008808612823486, 1.1549702882766724, 0.25983941555023193, 0.12594592571258545, 1.067265510559082, 0.8898259401321411, 0.054283976554870605, 0.06519508361816406, 2.312800884246826, 0.28777265548706055, 2.1894588470458984, 0.8868429660797119, 1.5924464464187622, 0.5939271450042725, 0.14823293685913086, 1.964364767074585, 0.656139612197876, 0.19810104370117188, 0.07497382164001465, 1.5769811868667603, 0.8359013795852661, 1.4893481731414795, 0.258586049079895, 0.4441976547241211, 1.9720202684402466, 1.366992712020874, 0.5735321044921875, 1.4715752601623535, 2.647256851196289, 1.8291869163513184, 0.4684981107711792, 0.07214748859405518, 0.7614496946334839, 0.6452072858810425, 2.46624755859375, 0.1182975172996521, 1.4218350648880005, 1.2687228918075562, 0.07375538349151611, 1.4673120975494385, 3.8478524684906006, 0.44166338443756104, 1.5069667100906372, 1.5543711185455322, 0.8908849954605103, 0.7785211801528931, 1.1545354127883911, 4.124317169189453, 0.3754764795303345, 1.224969744682312, 0.9826304912567139, 0.8589427471160889, 2.6096372604370117, 1.4958035945892334, 0.8034476041793823, 0.05150485038757324, 1.303261399269104, 2.8811912536621094, 1.2924566268920898, 1.5278470516204834, 1.0934168100357056, 4.3144989013671875, 1.53371000289917, 1.7245200872421265, 1.1707789897918701, 0.27519655227661133, 1.8418376445770264, 1.262345790863037, 0.7531434297561646, 1.9425415992736816, 2.590820789337158, 0.5910561084747314, 1.4331653118133545, 0.1907862424850464, 0.16829371452331543, 0.9568696022033691, 1.5077825784683228], "mean_td_error": 1.192574381828308, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 448.1050737714897, "num_env_steps_trained_throughput_per_sec": 129.03025561723697, "timesteps_total": 58240, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 174720, "timers": {"training_iteration_time_ms": 1978.432, "sample_time_ms": 1405.814, "load_time_ms": 0.538, "load_throughput": 479497.71, "learn_time_ms": 62.362, "learn_throughput": 4137.158, "synch_weights_time_ms": 15.623}, "counters": {"num_env_steps_sampled": 58240, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 174720, "num_agent_steps_trained": 16512, "last_target_update_ts": 58240, "num_target_updates": 64}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-34", "timestamp": 1700203114, "time_this_iter_s": 2.0169968605041504, "time_total_s": 133.22757983207703, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e08478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 133.22757983207703, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 95.7, "ram_util_percent": 92.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083564758300781, "actor_loss": -7.944555282592773, "critic_loss": 0.3674858808517456, "alpha_loss": -0.19356876611709595, "alpha_value": 0.9809865951538086, "log_alpha_value": -0.019196461886167526, "target_entropy": -6.0, "policy_t": -0.013709262944757938, "mean_q": 4.0748748779296875, "max_q": 5.338257789611816, "min_q": 3.2145066261291504}, "td_error": [1.5420607328414917, 0.586254358291626, 0.9980010986328125, 0.6316592693328857, 0.7321343421936035, 0.3839144706726074, 0.2419832944869995, 0.4529125690460205, 1.166589617729187, 3.398716926574707, 3.0598819255828857, 0.8443901538848877, 1.1817137002944946, 0.22202551364898682, 4.974234580993652, 0.42229652404785156, 3.349336862564087, 0.27905869483947754, 0.8851844072341919, 0.39698076248168945, 5.270181179046631, 0.5915248394012451, 0.2596628665924072, 1.84725022315979, 1.5349079370498657, 0.812288761138916, 3.0071001052856445, 1.2884652614593506, 3.5133252143859863, 3.527039051055908, 0.6182694435119629, 0.9725005626678467, 0.28804051876068115, 0.8351995944976807, 0.28891491889953613, 1.0396753549575806, 0.6086556911468506, 3.2901453971862793, 1.4538562297821045, 0.061408400535583496, 0.6775531768798828, 1.7807865142822266, 0.4880404472351074, 0.5507644414901733, 0.13562464714050293, 0.5263895988464355, 1.8282650709152222, 1.6459892988204956, 0.28057992458343506, 2.3261334896087646, 1.4693859815597534, 1.4621225595474243, 3.623852014541626, 0.7287085056304932, 3.0516934394836426, 0.824779748916626, 3.05336332321167, 1.6129841804504395, 3.018065929412842, 7.145583629608154, 2.6689159870147705, 1.6510692834854126, 1.145004391670227, 0.21793246269226074, 0.2764146327972412, 6.0225749015808105, 0.9137407541275024, 1.1831740140914917, 1.5570050477981567, 2.2833452224731445, 1.1072121858596802, 0.12733876705169678, 2.7618513107299805, 1.6125686168670654, 0.7625473737716675, 5.308386325836182, 3.7932052612304688, 0.13420605659484863, 1.1894350051879883, 0.5118653774261475, 0.4234689474105835, 3.8495051860809326, 0.2606440782546997, 0.526543140411377, 3.2829158306121826, 1.049890160560608], "mean_td_error": 1.6012693643569946, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007657051086426, "actor_loss": -6.488095283508301, "critic_loss": 0.18948745727539062, "alpha_loss": -0.19237923622131348, "alpha_value": 0.9809603691101074, "log_alpha_value": -0.019223207607865334, "target_entropy": -6.0, "policy_t": 0.03863569721579552, "mean_q": 2.5711584091186523, "max_q": 3.5587995052337646, "min_q": 1.8518375158309937}, "td_error": [3.318026542663574, 3.2497398853302, 1.8398633003234863, 0.7735553979873657, 2.0618984699249268, 1.352950930595398, 0.39800846576690674, 0.4533994197845459, 0.420576810836792, 1.1246984004974365, 0.15118837356567383, 0.6894737482070923, 3.335414409637451, 2.1274185180664062, 0.796290934085846, 0.9262109994888306, 0.1798953413963318, 1.4366416931152344, 2.7489089965820312, 1.3054234981536865, 1.0887219905853271, 0.6754156351089478, 1.3986924886703491, 0.5747419595718384, 1.7448807954788208, 4.6658124923706055, 0.42366838455200195, 0.3830897808074951, 0.61985182762146, 0.280086874961853, 0.3352145552635193, 0.9223836660385132, 1.6855096817016602, 0.44877123832702637, 2.1425204277038574, 0.7599494457244873, 1.9164016246795654, 2.4162144660949707, 0.8397049903869629, 2.6958236694335938, 1.613061547279358, 1.0141196250915527, 0.5531210899353027, 0.19296300411224365, 0.7987594604492188, 0.5563393831253052, 0.7192293405532837, 0.06740367412567139, 0.9052034616470337, 0.8211833238601685, 1.475709080696106, 0.6522648334503174, 3.6367554664611816, 2.9375152587890625, 0.8722193241119385, 4.201290130615234, 1.4874346256256104, 0.41229188442230225, 1.263337254524231, 0.9701874256134033, 0.6232116222381592, 1.3112971782684326, 2.473438262939453, 1.882239580154419, 1.2215272188186646, 0.8761534690856934, 1.6588120460510254, 0.25042295455932617, 0.4545522928237915, 1.262161374092102, 0.4562225341796875, 2.1381285190582275, 0.19022834300994873, 1.0883506536483765, 1.1053729057312012, 1.1501870155334473, 0.6136837005615234, 2.242824077606201, 0.7475248575210571, 2.2998242378234863, 0.6515400409698486, 0.9605015516281128, 1.5433777570724487, 2.2561120986938477, 0.35765671730041504, 0.27976858615875244], "mean_td_error": 1.2785179615020752, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055269241333008, "actor_loss": -6.377406120300293, "critic_loss": 0.2412310391664505, "alpha_loss": -0.19308872520923615, "alpha_value": 0.9809804558753967, "log_alpha_value": -0.019202742725610733, "target_entropy": -6.0, "policy_t": 0.08008960634469986, "mean_q": 2.4441771507263184, "max_q": 3.154862642288208, "min_q": 1.846488356590271}, "td_error": [1.6410927772521973, 1.3688679933547974, 0.9054433107376099, 1.46996009349823, 1.710679292678833, 0.9921590089797974, 0.7223474979400635, 1.3078404664993286, 0.0465240478515625, 0.42254626750946045, 1.9716275930404663, 2.2381975650787354, 1.729142427444458, 1.3839927911758423, 1.194718360900879, 0.10151875019073486, 0.35280072689056396, 1.082821011543274, 2.039778470993042, 0.8270799517631531, 0.5266565084457397, 0.029819011688232422, 0.863337516784668, 1.7978283166885376, 0.6625633239746094, 1.7595467567443848, 1.199519157409668, 0.91945481300354, 0.36560535430908203, 0.44632458686828613, 2.3958730697631836, 3.2268848419189453, 1.1266982555389404, 3.495448112487793, 0.026001691818237305, 2.970550537109375, 0.0945749282836914, 1.5511584281921387, 0.32853639125823975, 2.081325054168701, 0.995168924331665, 1.689404010772705, 0.1788419485092163, 1.0699269771575928, 0.2932392358779907, 1.6250877380371094, 0.013783454895019531, 4.728392124176025, 0.45775067806243896, 1.9236997365951538, 2.188054084777832, 0.5669074058532715, 4.2750139236450195, 1.1826380491256714, 2.03164005279541, 0.4999948740005493, 0.8482799530029297, 0.048543334007263184, 0.35975193977355957, 0.022504687309265137, 0.4628530740737915, 3.753026247024536, 0.5423505306243896, 0.27497053146362305, 0.8041021823883057, 0.7163214683532715, 0.18917930126190186, 4.422242164611816, 2.8829617500305176, 2.678865432739258, 1.0770599842071533, 1.6113641262054443, 0.16989386081695557, 1.011362075805664, 1.6851539611816406, 1.5468064546585083, 1.2538259029388428, 1.0612118244171143, 2.8349921703338623, 1.4601597785949707, 1.1348178386688232, 1.0210496187210083, 0.8692595958709717, 0.6378339529037476, 0.8865487575531006, 0.7056738138198853], "mean_td_error": 1.2798762321472168, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 355.7267637958196, "num_env_steps_trained_throughput_per_sec": 102.43025118227841, "timesteps_total": 59136, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 2024.659, "sample_time_ms": 1453.462, "load_time_ms": 0.539, "load_throughput": 478628.171, "learn_time_ms": 62.42, "learn_throughput": 4133.273, "synch_weights_time_ms": 15.773}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-37", "timestamp": 1700203117, "time_this_iter_s": 2.532484769821167, "time_total_s": 135.7600646018982, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff50526cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 135.7600646018982, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 73.7, "ram_util_percent": 92.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015670776367188, "actor_loss": -7.862966060638428, "critic_loss": 0.42172831296920776, "alpha_loss": -0.19526419043540955, "alpha_value": 0.9806929230690002, "log_alpha_value": -0.019495869055390358, "target_entropy": -6.0, "policy_t": 0.006656760815531015, "mean_q": 3.981204032897949, "max_q": 5.156519889831543, "min_q": 3.1500673294067383}, "td_error": [0.5487061738967896, 2.53887677192688, 1.0684688091278076, 1.0759680271148682, 2.1829309463500977, 1.340886116027832, 1.747681975364685, 0.9287822246551514, 2.287313222885132, 0.4149740934371948, 2.03188419342041, 5.109075546264648, 1.0480761528015137, 0.17121505737304688, 1.4445343017578125, 1.8035061359405518, 0.6893465518951416, 0.5461035966873169, 1.2096920013427734, 3.781658411026001, 0.3800020217895508, 2.2390213012695312, 1.4504576921463013, 5.125473976135254, 0.8673126697540283, 1.116330862045288, 0.7433884143829346, 0.398496150970459, 0.8705849647521973, 3.0975289344787598, 1.9233882427215576, 3.0620367527008057, 0.36341428756713867, 1.2304614782333374, 1.3776198625564575, 0.9251084327697754, 0.29758191108703613, 2.86739444732666, 2.134878396987915, 0.7898728847503662, 5.210453987121582, 2.6993396282196045, 2.207455635070801, 0.30800867080688477, 0.2536226511001587, 1.945199966430664, 2.9923171997070312, 0.21220660209655762, 1.5467898845672607, 1.5603870153427124, 1.646607518196106, 7.33430814743042, 2.7739548683166504, 1.7388238906860352, 0.11928915977478027, 0.9216302633285522, 1.0116000175476074, 7.687382698059082, 2.366725444793701, 1.4443507194519043, 1.9809406995773315, 2.5749707221984863, 1.336253046989441, 1.0488450527191162, 4.174200057983398, 6.174479961395264, 0.24296557903289795, 0.8387809991836548, 0.795966386795044, 0.32106995582580566, 2.226752281188965, 0.9869580268859863, 0.16201305389404297, 0.2280440330505371, 2.3635497093200684, 0.30849242210388184, 2.9642720222473145, 2.8459296226501465, 1.6116244792938232, 1.5427172183990479, 1.436002492904663, 0.0860058069229126, 2.12914776802063, 1.091423749923706, 4.4234700202941895, 0.8714486360549927], "mean_td_error": 1.7904281616210938, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13578987121582, "actor_loss": -6.602597236633301, "critic_loss": 0.17596563696861267, "alpha_loss": -0.19788455963134766, "alpha_value": 0.9806659817695618, "log_alpha_value": -0.01952335052192211, "target_entropy": -6.0, "policy_t": 0.04188993573188782, "mean_q": 2.6049437522888184, "max_q": 3.5027759075164795, "min_q": 1.7826324701309204}, "td_error": [1.2766859531402588, 2.3634347915649414, 0.8841091394424438, 0.6670769453048706, 1.3198505640029907, 2.364165782928467, 1.4632595777511597, 0.05260574817657471, 0.36658740043640137, 0.2638894319534302, 0.5323576927185059, 0.7970610857009888, 0.6247571706771851, 1.1594260931015015, 0.10455155372619629, 0.25938862562179565, 2.22346830368042, 2.0379714965820312, 1.6272317171096802, 4.358254432678223, 0.07363903522491455, 1.9858758449554443, 1.6086928844451904, 0.054923415184020996, 2.3905296325683594, 0.6125221252441406, 0.27179229259490967, 1.6735879182815552, 0.2939159870147705, 0.29113495349884033, 1.5848147869110107, 1.441511869430542, 2.3785510063171387, 1.7999720573425293, 0.4586688280105591, 1.668902039527893, 2.0429868698120117, 0.8474164605140686, 0.809830904006958, 2.061798095703125, 1.3830952644348145, 0.1963409185409546, 0.5054712295532227, 1.5967998504638672, 1.1178966760635376, 0.40332818031311035, 0.925193190574646, 1.2946531772613525, 0.2231212854385376, 2.399644136428833, 0.20464611053466797, 0.6724559664726257, 1.179584264755249, 1.7877914905548096, 0.8326869010925293, 0.1273859739303589, 0.3030507564544678, 0.6964730620384216, 2.2814698219299316, 1.459420084953308, 1.8398962020874023, 4.252470970153809, 0.6330665349960327, 0.34133046865463257, 1.1923959255218506, 0.4367039203643799, 1.7881674766540527, 0.5515786409378052, 0.7894922494888306, 0.35644984245300293, 0.8451495170593262, 0.8493228554725647, 0.16588008403778076, 0.33826136589050293, 0.9650272130966187, 1.1180790662765503, 0.09271097183227539, 3.1819472312927246, 0.4427241086959839, 0.8358687162399292, 2.3069164752960205, 1.1463905572891235, 4.301206588745117, 1.6531888246536255, 0.6964284181594849, 1.444831371307373], "mean_td_error": 1.1773627996444702, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087742805480957, "actor_loss": -6.4559197425842285, "critic_loss": 0.2184445559978485, "alpha_loss": -0.1967405080795288, "alpha_value": 0.9806860089302063, "log_alpha_value": -0.019502924755215645, "target_entropy": -6.0, "policy_t": 0.028540251776576042, "mean_q": 2.475141763687134, "max_q": 3.189810037612915, "min_q": 1.8466581106185913}, "td_error": [0.8801244497299194, 1.096063494682312, 0.14522457122802734, 0.7694377303123474, 1.0068625211715698, 1.8150546550750732, 0.42529296875, 0.3095201253890991, 0.8163385391235352, 1.689347743988037, 0.2553344964981079, 0.8750767707824707, 1.036767601966858, 0.1443539261817932, 0.9673675298690796, 0.9371727705001831, 0.14134550094604492, 2.130197525024414, 2.002861499786377, 1.2163394689559937, 2.000089168548584, 0.3872663974761963, 0.9625595808029175, 0.7913213968276978, 0.6530684232711792, 0.16692286729812622, 0.3130074739456177, 1.1994134187698364, 0.49268633127212524, 0.5503537058830261, 1.4009512662887573, 0.7747994661331177, 1.5922211408615112, 2.474135398864746, 3.3203125, 1.0152842998504639, 2.7921924591064453, 2.12825345993042, 0.6258031129837036, 1.4150145053863525, 0.5372141599655151, 1.6507230997085571, 2.328446388244629, 1.0808762311935425, 1.1389228105545044, 3.204723358154297, 0.39661097526550293, 1.7574102878570557, 2.3973388671875, 0.772957444190979, 4.281652450561523, 0.4309401512145996, 3.730071544647217, 2.970534324645996, 1.3464773893356323, 0.14086949825286865, 0.09343087673187256, 1.693114161491394, 0.6035388708114624, 0.5665373802185059, 0.26719796657562256, 0.3814340829849243, 3.0649795532226562, 1.5970350503921509, 0.17110705375671387, 0.33936363458633423, 1.089949607849121, 0.6577833890914917, 2.6059906482696533, 1.6395816802978516, 1.566354751586914, 0.034586310386657715, 0.14464831352233887, 1.545982837677002, 1.0257567167282104, 1.7393518686294556, 1.186882495880127, 0.37659865617752075, 0.2683037519454956, 1.132866621017456, 1.1375830173492432, 2.4273569583892822, 0.11877024173736572, 1.491646647453308, 0.9645603895187378, 0.3683180809020996], "mean_td_error": 1.188164234161377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 379.2978128056862, "num_env_steps_trained_throughput_per_sec": 109.21745056235162, "timesteps_total": 60032, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 180096, "timers": {"training_iteration_time_ms": 2074.011, "sample_time_ms": 1462.698, "load_time_ms": 0.542, "load_throughput": 476247.88, "learn_time_ms": 62.409, "learn_throughput": 4134.048, "synch_weights_time_ms": 15.862}, "counters": {"num_env_steps_sampled": 60032, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 180096, "num_agent_steps_trained": 17028, "last_target_update_ts": 60032, "num_target_updates": 66}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-39", "timestamp": 1700203119, "time_this_iter_s": 2.3770530223846436, "time_total_s": 138.13711762428284, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 138.13711762428284, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 67.26666666666667, "ram_util_percent": 92.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072979927062988, "actor_loss": -7.807476043701172, "critic_loss": 0.3435259461402893, "alpha_loss": -0.19939641654491425, "alpha_value": 0.980399489402771, "log_alpha_value": -0.01979517564177513, "target_entropy": -6.0, "policy_t": -0.004323598928749561, "mean_q": 3.8889458179473877, "max_q": 5.005531311035156, "min_q": 3.102156639099121}, "td_error": [0.47858500480651855, 1.257153868675232, 1.1885305643081665, 0.14267492294311523, 1.3775889873504639, 2.2304229736328125, 2.1348390579223633, 1.0780630111694336, 1.8473094701766968, 0.6121244430541992, 0.48699951171875, 2.65106463432312, 1.6321375370025635, 1.0243070125579834, 1.1018939018249512, 6.338390350341797, 0.576092004776001, 0.4301166534423828, 1.377122163772583, 0.8605046272277832, 2.385998487472534, 0.39261627197265625, 1.087690830230713, 0.5966504812240601, 0.526392936706543, 1.3265423774719238, 3.6075780391693115, 0.07721734046936035, 1.103269338607788, 3.4613184928894043, 0.3992958068847656, 1.3775204420089722, 1.0117090940475464, 1.8704006671905518, 0.20792770385742188, 4.783184051513672, 0.8825273513793945, 1.0224531888961792, 1.4358707666397095, 0.953089714050293, 0.6059505939483643, 0.9419705867767334, 0.17521190643310547, 0.287575364112854, 1.4208483695983887, 0.9477589130401611, 0.25173699855804443, 2.1156258583068848, 2.084521770477295, 2.358119487762451, 2.2740135192871094, 3.600557327270508, 7.532657623291016, 1.9981019496917725, 0.21589279174804688, 1.148478627204895, 2.315124988555908, 0.6955806016921997, 0.918987512588501, 0.23300814628601074, 0.2942161560058594, 1.1433621644973755, 1.3044817447662354, 0.3902519941329956, 4.813981056213379, 1.3510959148406982, 2.7689216136932373, 1.339079737663269, 0.48870861530303955, 2.7380521297454834, 1.9757156372070312, 2.2842564582824707, 0.6497238874435425, 0.4861934185028076, 0.10659945011138916, 4.932897567749023, 1.538611650466919, 0.07134628295898438, 0.6815700531005859, 0.7548000812530518, 1.6971945762634277, 2.111382007598877, 1.278761625289917, 1.408264398574829, 1.6870545148849487, 3.230940818786621], "mean_td_error": 1.5230741500854492, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079689025878906, "actor_loss": -6.536998748779297, "critic_loss": 0.1760471761226654, "alpha_loss": -0.19981564581394196, "alpha_value": 0.9803715944290161, "log_alpha_value": -0.019823594018816948, "target_entropy": -6.0, "policy_t": -0.011230158619582653, "mean_q": 2.5798261165618896, "max_q": 3.5095298290252686, "min_q": 1.8021475076675415}, "td_error": [1.1627233028411865, 3.0155839920043945, 1.7135117053985596, 0.4018160104751587, 1.5220842361450195, 0.9787007570266724, 0.39494287967681885, 0.7547934055328369, 1.4151332378387451, 1.0909937620162964, 0.9660214185714722, 1.964209794998169, 1.7896004915237427, 0.4221888780593872, 1.019102931022644, 0.09417402744293213, 1.4211074113845825, 1.1886829137802124, 1.1835968494415283, 0.4893249273300171, 0.8519003391265869, 0.1918647289276123, 2.3744869232177734, 1.1419684886932373, 0.2973930835723877, 1.5554910898208618, 3.9816105365753174, 0.61617112159729, 0.09904372692108154, 0.48588037490844727, 2.3390517234802246, 2.0066137313842773, 3.0965468883514404, 1.4245494604110718, 1.274048924446106, 0.6323854923248291, 0.21535253524780273, 1.269909143447876, 0.46608150005340576, 5.02902889251709, 0.17498743534088135, 1.5438729524612427, 0.5702580213546753, 1.1789814233779907, 0.8073214292526245, 0.03841578960418701, 0.6292871236801147, 0.49341416358947754, 1.3178704977035522, 3.059751510620117, 0.4106934070587158, 1.263563632965088, 0.5092967748641968, 0.17681670188903809, 0.5457671880722046, 3.3593451976776123, 0.4387795925140381, 0.14262932538986206, 0.5825077295303345, 1.6906269788742065, 0.30544209480285645, 1.6037360429763794, 0.5826572179794312, 1.5951074361801147, 0.5719770193099976, 0.18831640481948853, 1.8089207410812378, 1.0274786949157715, 0.11157739162445068, 2.640408515930176, 1.0788638591766357, 0.5153976678848267, 0.03314530849456787, 0.5123565196990967, 1.4915422201156616, 2.1060547828674316, 0.44676637649536133, 0.8109923601150513, 0.10562801361083984, 1.552329421043396, 0.5718778371810913, 0.7342615723609924, 1.6541608572006226, 2.5503358840942383, 4.350907802581787, 0.9315366744995117], "mean_td_error": 1.1762051582336426, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079669952392578, "actor_loss": -6.429288864135742, "critic_loss": 0.31014615297317505, "alpha_loss": -0.19960860908031464, "alpha_value": 0.9803916811943054, "log_alpha_value": -0.019803088158369064, "target_entropy": -6.0, "policy_t": 0.011414803564548492, "mean_q": 2.5025980472564697, "max_q": 3.314483880996704, "min_q": 1.9301122426986694}, "td_error": [0.923747181892395, 1.4666022062301636, 4.539701461791992, 2.1383767127990723, 1.1246447563171387, 2.3144588470458984, 2.0215609073638916, 2.0671677589416504, 2.2929344177246094, 0.5556906461715698, 2.45985746383667, 2.180525779724121, 2.0735456943511963, 1.0957295894622803, 1.8385388851165771, 2.3115744590759277, 0.05323612689971924, 1.4309844970703125, 1.5392990112304688, 1.0706866979599, 0.5254110097885132, 0.27518749237060547, 2.653994560241699, 1.5155067443847656, 0.19088470935821533, 1.260767936706543, 2.99904727935791, 1.1138129234313965, 1.2928509712219238, 0.33260083198547363, 1.5997337102890015, 0.22560834884643555, 0.7117087841033936, 1.1444008350372314, 3.0443382263183594, 0.08925223350524902, 3.3495287895202637, 0.6086600422859192, 0.04908567667007446, 2.565648078918457, 1.3536604642868042, 0.597959041595459, 2.887420654296875, 0.7023169994354248, 1.911988377571106, 2.251990795135498, 0.7865671515464783, 0.5503745079040527, 1.0938807725906372, 2.42673921585083, 1.2202937602996826, 1.9009981155395508, 0.27625060081481934, 2.4606423377990723, 1.9434994459152222, 2.4950180053710938, 3.2148213386535645, 3.9877710342407227, 2.136411666870117, 1.4317952394485474, 0.9123779535293579, 0.8315219879150391, 0.8491430282592773, 1.031873106956482, 0.354406476020813, 0.9220510721206665, 0.6362165212631226, 0.6056678295135498, 1.735329508781433, 1.5256088972091675, 2.8799076080322266, 0.5213862657546997, 0.5124270915985107, 2.9145991802215576, 0.9599545001983643, 0.5604372024536133, 3.7956719398498535, 2.3759491443634033, 0.3573033809661865, 1.9109539985656738, 2.31032133102417, 2.540621280670166, 5.53102445602417, 0.8627753257751465, 0.1965014934539795, 0.9109803438186646], "mean_td_error": 1.572352409362793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 470.95155388723066, "num_env_steps_trained_throughput_per_sec": 135.60881797199275, "timesteps_total": 60928, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 182784, "timers": {"training_iteration_time_ms": 2071.933, "sample_time_ms": 1459.645, "load_time_ms": 0.536, "load_throughput": 481117.923, "learn_time_ms": 62.309, "learn_throughput": 4140.631, "synch_weights_time_ms": 15.746}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 68, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-41", "timestamp": 1700203121, "time_this_iter_s": 1.9205970764160156, "time_total_s": 140.05771470069885, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0763ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 140.05771470069885, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 68.0, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124510765075684, "actor_loss": -7.701736927032471, "critic_loss": 0.366840660572052, "alpha_loss": -0.2034473568201065, "alpha_value": 0.980105996131897, "log_alpha_value": -0.02009453810751438, "target_entropy": -6.0, "policy_t": 0.0008817862835712731, "mean_q": 3.819248914718628, "max_q": 4.743088722229004, "min_q": 3.1180965900421143}, "td_error": [0.7848351001739502, 1.7692441940307617, 3.5217185020446777, 0.46210789680480957, 2.350602388381958, 0.9309730529785156, 2.9338436126708984, 3.298142433166504, 0.4121510982513428, 1.7524982690811157, 0.3727341890335083, 0.1383209228515625, 0.4759562015533447, 4.1016082763671875, 3.578752279281616, 0.9704357385635376, 3.9604196548461914, 0.5815798044204712, 1.2485389709472656, 1.7945778369903564, 1.6215219497680664, 1.5814030170440674, 6.636555194854736, 1.5909401178359985, 1.1114921569824219, 0.05682647228240967, 1.1057581901550293, 2.130110263824463, 0.09143471717834473, 0.8558214902877808, 2.2514660358428955, 2.739386558532715, 0.3374103307723999, 0.593083381652832, 5.3288750648498535, 1.5817244052886963, 1.7370110750198364, 0.17604279518127441, 0.7483538389205933, 0.43132710456848145, 2.4484193325042725, 1.3383235931396484, 0.8581513166427612, 1.9090512990951538, 1.1036632061004639, 3.40855073928833, 0.596527099609375, 0.9838337898254395, 2.342413902282715, 0.224143385887146, 0.6917452812194824, 3.212311029434204, 1.325808048248291, 1.0058249235153198, 2.9357945919036865, 2.0897674560546875, 2.5497684478759766, 0.6748437881469727, 1.1010690927505493, 5.348598480224609, 0.19575059413909912, 1.1565005779266357, 3.2250988483428955, 0.9771223068237305, 0.23415470123291016, 0.8609850406646729, 4.124176502227783, 0.5025250911712646, 1.0636579990386963, 2.4094200134277344, 3.8823049068450928, 1.8369078636169434, 0.20946836471557617, 0.9955223798751831, 2.321634292602539, 1.4436208009719849, 0.08241140842437744, 1.6114323139190674, 0.5691236257553101, 0.7425825595855713, 1.0139423608779907, 1.9345457553863525, 0.8455289602279663, 2.014812469482422, 0.2759835720062256, 1.2227689027786255], "mean_td_error": 1.6284438371658325, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.982012748718262, "actor_loss": -6.551692485809326, "critic_loss": 0.21014656126499176, "alpha_loss": -0.200875923037529, "alpha_value": 0.98007732629776, "log_alpha_value": -0.020123787224292755, "target_entropy": -6.0, "policy_t": 0.030792253091931343, "mean_q": 2.685889959335327, "max_q": 3.6316652297973633, "min_q": 1.763427495956421}, "td_error": [1.8033348321914673, 0.6301894187927246, 0.4574267864227295, 2.9763283729553223, 0.6838103532791138, 0.0269622802734375, 0.37589776515960693, 0.2182832956314087, 0.5269496440887451, 0.2392594814300537, 1.2414876222610474, 1.013482928276062, 0.4036980867385864, 1.352871060371399, 1.6719359159469604, 0.40781188011169434, 0.47673773765563965, 0.6635322570800781, 0.35436367988586426, 0.2933305501937866, 0.24650442600250244, 1.8178502321243286, 1.4433765411376953, 0.3287050724029541, 1.19773530960083, 5.002960205078125, 0.7243366241455078, 1.685731053352356, 0.8023049831390381, 1.6942870616912842, 1.6115515232086182, 1.5656853914260864, 0.19021546840667725, 1.3583400249481201, 0.7149258852005005, 3.7160181999206543, 1.7933855056762695, 1.7779626846313477, 1.0338801145553589, 1.6983944177627563, 2.9446005821228027, 1.467992901802063, 4.547199249267578, 0.9457169771194458, 0.9683219194412231, 1.1444889307022095, 1.1181576251983643, 1.2919976711273193, 1.200866460800171, 2.5819778442382812, 0.717863917350769, 0.2290104627609253, 0.08792340755462646, 0.48724329471588135, 3.005373001098633, 2.0052366256713867, 3.1912143230438232, 0.21621203422546387, 1.450925588607788, 1.3885403871536255, 2.0587048530578613, 3.028561592102051, 2.2954983711242676, 0.2331317663192749, 1.0872925519943237, 1.8625839948654175, 1.065259337425232, 1.334701657295227, 2.39962100982666, 0.5622361898422241, 1.2385300397872925, 0.5707908868789673, 0.5473989248275757, 0.9167709350585938, 2.018376350402832, 1.3396605253219604, 0.9806095361709595, 2.590376853942871, 1.7974731922149658, 3.3141279220581055, 2.116311550140381, 1.0463885068893433, 2.3600430488586426, 0.2830965518951416, 0.2576873302459717, 0.6123471260070801], "mean_td_error": 1.3387242555618286, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120749473571777, "actor_loss": -6.409469127655029, "critic_loss": 0.24020273983478546, "alpha_loss": -0.20345963537693024, "alpha_value": 0.9800975322723389, "log_alpha_value": -0.02010321617126465, "target_entropy": -6.0, "policy_t": -0.009436589665710926, "mean_q": 2.4177651405334473, "max_q": 3.0944652557373047, "min_q": 1.9131109714508057}, "td_error": [1.9472945928573608, 3.2707948684692383, 0.8767549991607666, 0.11918342113494873, 4.118408203125, 0.3509618043899536, 0.45305371284484863, 0.6015180349349976, 2.031002998352051, 0.9962990283966064, 0.6053521633148193, 0.26643455028533936, 1.86979341506958, 0.8280651569366455, 1.685392141342163, 2.700223445892334, 2.8016300201416016, 0.835026741027832, 3.077944755554199, 0.1549232006072998, 0.1595144271850586, 0.606890082359314, 0.5814251899719238, 0.2140035629272461, 3.2410216331481934, 2.036771297454834, 1.8377399444580078, 1.8136268854141235, 2.1369075775146484, 1.2082363367080688, 0.24239206314086914, 1.7429454326629639, 1.0416606664657593, 1.0597401857376099, 0.8595064878463745, 0.2365279197692871, 2.8787970542907715, 1.008060097694397, 1.0938669443130493, 0.8434690237045288, 1.362855315208435, 2.8603122234344482, 1.296640157699585, 0.9506415128707886, 1.7091891765594482, 0.8072881698608398, 1.0188782215118408, 1.012058973312378, 2.5406076908111572, 1.6083900928497314, 0.5089681148529053, 2.6246914863586426, 1.7922279834747314, 0.3936002254486084, 0.23089611530303955, 0.9614063501358032, 1.6933525800704956, 2.1027750968933105, 0.4244396686553955, 1.5346596240997314, 1.7076928615570068, 0.6052528619766235, 2.1840009689331055, 2.5690865516662598, 1.1713149547576904, 0.8933221101760864, 1.948408603668213, 1.445911169052124, 0.5839462280273438, 0.273525595664978, 1.752706527709961, 1.0133410692214966, 2.015364170074463, 0.10051000118255615, 0.2703087329864502, 0.3965874910354614, 1.8708345890045166, 1.0908361673355103, 0.45346570014953613, 0.41132473945617676, 1.0668781995773315, 0.7343779802322388, 3.3051655292510986, 0.5899722576141357, 1.2414414882659912, 0.7817273139953613], "mean_td_error": 1.306329369544983, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 445.8176818525895, "num_env_steps_trained_throughput_per_sec": 128.37160928344653, "timesteps_total": 61824, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 185472, "timers": {"training_iteration_time_ms": 2068.064, "sample_time_ms": 1456.65, "load_time_ms": 0.536, "load_throughput": 481481.838, "learn_time_ms": 62.315, "learn_throughput": 4140.247, "synch_weights_time_ms": 15.809}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "done": false, "episodes_total": 0, "training_iteration": 69, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-43", "timestamp": 1700203123, "time_this_iter_s": 2.026055097579956, "time_total_s": 142.0837697982788, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0763040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 142.0837697982788, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 70.89999999999999, "ram_util_percent": 92.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111433029174805, "actor_loss": -7.561580181121826, "critic_loss": 0.35972490906715393, "alpha_loss": -0.20621339976787567, "alpha_value": 0.9798124432563782, "log_alpha_value": -0.020394081249833107, "target_entropy": -6.0, "policy_t": 0.018477177247405052, "mean_q": 3.6650209426879883, "max_q": 4.616688251495361, "min_q": 2.8342514038085938}, "td_error": [0.5975629091262817, 0.6733545064926147, 1.0723274946212769, 4.6508331298828125, 0.6255073547363281, 2.5898852348327637, 0.03859889507293701, 0.4722585678100586, 1.9824113845825195, 0.18691587448120117, 1.6292328834533691, 5.004640579223633, 3.8421630859375, 3.3565855026245117, 0.9488122463226318, 2.6683225631713867, 4.096085548400879, 2.8569862842559814, 2.580580711364746, 4.1930131912231445, 1.4827897548675537, 0.1870572566986084, 1.0478763580322266, 1.8141095638275146, 1.4630086421966553, 0.8207290172576904, 2.4345102310180664, 0.10671341419219971, 3.1219663619995117, 0.07924103736877441, 2.64309024810791, 0.4475283622741699, 0.47297120094299316, 3.1481707096099854, 1.448907732963562, 3.2583861351013184, 1.6897335052490234, 2.3226630687713623, 0.2535383701324463, 0.4685201644897461, 1.6939855813980103, 1.085422158241272, 0.11845386028289795, 0.5788145065307617, 0.8929985761642456, 0.529869556427002, 0.47974610328674316, 1.2940666675567627, 0.9095525741577148, 2.548445224761963, 0.1466977596282959, 0.5007810592651367, 0.16673529148101807, 1.0522326231002808, 1.160535216331482, 1.3245363235473633, 2.039761543273926, 0.5002726316452026, 0.5726543664932251, 1.010249376296997, 0.668041467666626, 0.5906686782836914, 2.396878242492676, 3.0349645614624023, 0.8406556844711304, 1.2177178859710693, 0.4676647186279297, 0.4221463203430176, 0.8207170963287354, 1.8148765563964844, 0.7076607942581177, 2.542174816131592, 1.6405972242355347, 4.64406681060791, 3.160120964050293, 0.7195394039154053, 0.5182664394378662, 4.261293411254883, 0.5513885021209717, 1.19545578956604, 0.434955358505249, 2.6396639347076416, 2.378239631652832, 2.1674461364746094, 2.262777328491211, 3.3642683029174805], "mean_td_error": 1.5912286043167114, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.039338111877441, "actor_loss": -6.527419090270996, "critic_loss": 0.16548991203308105, "alpha_loss": -0.20504030585289001, "alpha_value": 0.9797834753990173, "log_alpha_value": -0.020423687994480133, "target_entropy": -6.0, "policy_t": -0.041868072003126144, "mean_q": 2.6599419116973877, "max_q": 3.4729514122009277, "min_q": 1.9071072340011597}, "td_error": [2.4470667839050293, 0.08964067697525024, 0.1707444190979004, 0.6326323747634888, 1.6999411582946777, 0.9432185888290405, 0.35560059547424316, 0.6564441919326782, 0.8723089694976807, 1.5614237785339355, 1.2789769172668457, 1.459741234779358, 1.2866225242614746, 2.276820182800293, 0.4200751781463623, 0.3155090808868408, 1.5865355730056763, 1.1053860187530518, 2.9116106033325195, 1.2516738176345825, 1.5454970598220825, 1.9589141607284546, 0.6503181457519531, 0.022286057472229004, 0.6197760105133057, 0.8178527355194092, 0.4035923480987549, 2.3782308101654053, 0.8498903512954712, 0.9066901206970215, 0.4066520929336548, 1.5978114604949951, 2.039186477661133, 0.24721670150756836, 1.0001881122589111, 2.738114833831787, 1.6696065664291382, 0.8039090633392334, 1.4402661323547363, 0.3560359477996826, 1.8152103424072266, 0.2764699459075928, 0.5643548965454102, 1.7994211912155151, 0.8820438385009766, 0.07578575611114502, 0.13723337650299072, 0.33372020721435547, 0.4499473571777344, 0.45976126194000244, 2.4840288162231445, 1.874315619468689, 1.2752830982208252, 1.0156126022338867, 1.2857799530029297, 0.592780590057373, 0.6411712169647217, 0.22140932083129883, 1.6481349468231201, 0.917046308517456, 0.2084752321243286, 0.08191323280334473, 1.4641950130462646, 1.044669270515442, 0.857940673828125, 2.266249179840088, 2.350229501724243, 0.6813867092132568, 3.1485297679901123, 1.0226154327392578, 1.225560188293457, 0.053998351097106934, 1.0082942247390747, 0.7774561643600464, 5.948576927185059, 0.7665048837661743, 1.5664294958114624, 0.5347990989685059, 1.5728049278259277, 0.8104418516159058, 0.8886435031890869, 0.01056361198425293, 0.05052804946899414, 1.6070106029510498, 0.08521044254302979, 1.7652108669281006], "mean_td_error": 1.1200203895568848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106973648071289, "actor_loss": -6.4170966148376465, "critic_loss": 0.2072288691997528, "alpha_loss": -0.20621681213378906, "alpha_value": 0.9798033237457275, "log_alpha_value": -0.020403414964675903, "target_entropy": -6.0, "policy_t": -0.04281748831272125, "mean_q": 2.434133529663086, "max_q": 3.0870327949523926, "min_q": 1.914652705192566}, "td_error": [0.6385809183120728, 2.3953166007995605, 0.4804598093032837, 0.549878716468811, 0.13098013401031494, 2.679378032684326, 1.9292747974395752, 2.061584949493408, 1.0038163661956787, 0.5357517004013062, 1.8678004741668701, 0.3110182285308838, 0.6158968210220337, 0.9426506161689758, 0.24996483325958252, 0.10341525077819824, 1.414417028427124, 0.19171154499053955, 1.5265198945999146, 3.0992774963378906, 0.24119949340820312, 0.33461666107177734, 0.5132445096969604, 1.025215744972229, 1.547141671180725, 0.7211481332778931, 2.520429849624634, 1.7176214456558228, 0.5331339836120605, 2.79799222946167, 1.0314184427261353, 0.873734712600708, 1.7551279067993164, 0.47123026847839355, 2.1316041946411133, 1.3119233846664429, 1.1944990158081055, 1.7186675071716309, 1.506951928138733, 1.3146576881408691, 0.7889131903648376, 1.3208048343658447, 0.26438987255096436, 0.20897144079208374, 0.7921881675720215, 1.021134853363037, 0.873742938041687, 1.8834707736968994, 0.2686103582382202, 3.1206583976745605, 1.0287152528762817, 0.5962387323379517, 2.4521868228912354, 1.0594749450683594, 0.4832286834716797, 2.675992250442505, 0.6077388525009155, 1.5444657802581787, 1.4748135805130005, 0.9847906827926636, 0.43880927562713623, 1.420128583908081, 1.2205193042755127, 1.2167776823043823, 1.4789454936981201, 0.6682848930358887, 2.4233052730560303, 1.5358721017837524, 1.143375277519226, 2.1756269931793213, 2.427525520324707, 1.042507290840149, 0.9156914949417114, 0.08990156650543213, 0.5712320804595947, 1.967464566230774, 1.2313073873519897, 1.2013400793075562, 0.7670446634292603, 0.15875977277755737, 1.0830612182617188, 0.846233606338501, 1.5096639394760132, 0.18318402767181396, 0.1007150411605835, 1.3267327547073364], "mean_td_error": 1.169579029083252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 68.0}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 375.38354054312947, "num_env_steps_trained_throughput_per_sec": 108.0903498438922, "timesteps_total": 62720, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 188160, "timers": {"training_iteration_time_ms": 2122.498, "sample_time_ms": 1511.323, "load_time_ms": 0.535, "load_throughput": 482469.317, "learn_time_ms": 62.345, "learn_throughput": 4138.236, "synch_weights_time_ms": 15.991}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 17802, "num_agent_steps_sampled": 188160, "num_agent_steps_trained": 17802, "last_target_update_ts": 62720, "num_target_updates": 69}, "done": false, "episodes_total": 0, "training_iteration": 70, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-45", "timestamp": 1700203125, "time_this_iter_s": 2.4037868976593018, "time_total_s": 144.4875566959381, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07950d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 144.4875566959381, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 69.17500000000001, "ram_util_percent": 92.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058734893798828, "actor_loss": -7.583115577697754, "critic_loss": 0.3594534397125244, "alpha_loss": -0.20815294981002808, "alpha_value": 0.9795188903808594, "log_alpha_value": -0.02069375105202198, "target_entropy": -6.0, "policy_t": 0.0037501861806958914, "mean_q": 3.6688618659973145, "max_q": 4.467296600341797, "min_q": 2.943732261657715}, "td_error": [1.344237208366394, 1.4705238342285156, 0.33616411685943604, 0.7891019582748413, 0.3148763179779053, 0.05333852767944336, 0.738561749458313, 0.09942817687988281, 3.244063138961792, 5.5507965087890625, 0.3117333650588989, 1.923317551612854, 2.0730152130126953, 1.3420567512512207, 4.359226703643799, 2.3510944843292236, 1.6941051483154297, 2.861508369445801, 0.3284125328063965, 1.1167042255401611, 0.8337810039520264, 0.8911439180374146, 1.1121866703033447, 2.8746750354766846, 1.676411509513855, 0.9963333606719971, 0.12042999267578125, 1.3772010803222656, 0.5104544162750244, 0.9476346969604492, 0.8524554967880249, 4.971508979797363, 0.5210222005844116, 1.037789225578308, 2.1894114017486572, 1.4626884460449219, 0.07451152801513672, 1.7223789691925049, 0.920279860496521, 0.015371084213256836, 3.6175153255462646, 0.15364587306976318, 1.6837797164916992, 3.5827362537384033, 2.6044397354125977, 0.17775356769561768, 1.2709462642669678, 0.08280682563781738, 3.922412633895874, 0.20961439609527588, 0.972388505935669, 1.5433316230773926, 4.35757303237915, 1.5340349674224854, 0.0806887149810791, 0.946212887763977, 2.236654758453369, 4.434532165527344, 0.4276202917098999, 2.863201856613159, 0.9807407855987549, 1.6375093460083008, 0.9920706748962402, 2.8389382362365723, 1.544302225112915, 4.181947708129883, 2.681227684020996, 2.0348963737487793, 3.589709520339966, 1.2822744846343994, 1.4220272302627563, 0.22588539123535156, 0.5226290225982666, 1.8971121311187744, 0.7519429922103882, 0.5636706352233887, 0.8335437774658203, 4.698760509490967, 1.2181739807128906, 1.0951159000396729, 1.3028039932250977, 0.7698731422424316, 0.2716670036315918, 0.10636460781097412, 1.0539218187332153, 1.776861310005188], "mean_td_error": 1.5626256465911865, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045584678649902, "actor_loss": -6.5866193771362305, "critic_loss": 0.19325540959835052, "alpha_loss": -0.20817941427230835, "alpha_value": 0.979489803314209, "log_alpha_value": -0.020723475143313408, "target_entropy": -6.0, "policy_t": 0.04386138170957565, "mean_q": 2.68137264251709, "max_q": 3.6922872066497803, "min_q": 1.6937819719314575}, "td_error": [0.8844151496887207, 1.43245530128479, 0.4813448190689087, 0.5042152404785156, 3.7962799072265625, 0.2695201635360718, 1.3628690242767334, 2.1264219284057617, 0.4701005220413208, 0.6106607913970947, 1.011095404624939, 0.48380327224731445, 0.11559665203094482, 0.8663990497589111, 1.6190358400344849, 3.3591794967651367, 0.44010162353515625, 3.9721992015838623, 1.815832495689392, 0.5630321502685547, 0.46642863750457764, 0.6857562065124512, 0.04829096794128418, 0.4065566062927246, 1.2607914209365845, 0.5242927074432373, 0.2254924774169922, 2.2410130500793457, 0.45571231842041016, 3.2067952156066895, 0.14192509651184082, 0.24035680294036865, 1.2729456424713135, 0.9947129487991333, 1.65778648853302, 1.874779462814331, 1.5261170864105225, 1.7872536182403564, 0.9918410778045654, 2.4627771377563477, 1.0405621528625488, 0.8105157613754272, 1.0964807271957397, 0.03231513500213623, 2.351511240005493, 0.4430394172668457, 0.16164743900299072, 1.8191595077514648, 0.7587178945541382, 0.4075683355331421, 2.0538721084594727, 0.3820943832397461, 1.8661036491394043, 0.7986457347869873, 0.9472376108169556, 0.31640374660491943, 2.2626705169677734, 1.4219005107879639, 1.5258946418762207, 2.531080961227417, 2.5950927734375, 0.6779193878173828, 0.6459102630615234, 1.0133476257324219, 1.0859756469726562, 0.1537787914276123, 0.6511188745498657, 1.225219964981079, 0.4635038375854492, 1.994962215423584, 0.7158408164978027, 0.32438433170318604, 0.6530793309211731, 2.1352336406707764, 1.2275855541229248, 3.6181676387786865, 0.4931941032409668, 1.399800419807434, 1.6843712329864502, 3.7088658809661865, 0.18564367294311523, 0.1618671417236328, 2.1208252906799316, 5.816667556762695, 1.2788752317428589, 0.3578835725784302], "mean_td_error": 1.2566596269607544, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03095531463623, "actor_loss": -6.383431434631348, "critic_loss": 0.24032385647296906, "alpha_loss": -0.20767734944820404, "alpha_value": 0.9795092344284058, "log_alpha_value": -0.020703643560409546, "target_entropy": -6.0, "policy_t": -0.03765157237648964, "mean_q": 2.4821107387542725, "max_q": 3.2563974857330322, "min_q": 1.9673817157745361}, "td_error": [0.29405730962753296, 1.5635720491409302, 0.4128512144088745, 0.7822142839431763, 1.0879729986190796, 0.5981591939926147, 2.427480936050415, 2.0660481452941895, 1.0670126676559448, 0.48083722591400146, 0.41615116596221924, 2.5474915504455566, 0.09469008445739746, 1.4293748140335083, 0.7169063091278076, 0.3669074773788452, 5.4869232177734375, 0.9848581552505493, 0.9734472036361694, 1.1460093259811401, 1.6677100658416748, 1.2137645483016968, 0.9679710865020752, 0.8648892641067505, 0.6729397773742676, 2.13460111618042, 0.1532893180847168, 0.030521512031555176, 1.1864718198776245, 0.5424154996871948, 1.1295207738876343, 0.3856562376022339, 2.196537971496582, 1.9681499004364014, 0.3845771551132202, 4.050703048706055, 1.7625187635421753, 1.0719716548919678, 2.3438594341278076, 1.011698842048645, 3.824228525161743, 0.7363630533218384, 0.11204230785369873, 0.9729025363922119, 0.5192338228225708, 0.11281073093414307, 0.9540120363235474, 1.913963794708252, 0.14197862148284912, 5.020979881286621, 0.5302554965019226, 1.1238962411880493, 0.2358335256576538, 0.1555495262145996, 0.7164318561553955, 0.2419828176498413, 0.43661558628082275, 1.0172837972640991, 2.720437526702881, 1.3132951259613037, 3.037355422973633, 0.771285891532898, 0.6040644645690918, 4.013967514038086, 1.386808156967163, 0.1374295949935913, 0.8333892822265625, 2.0023880004882812, 2.315220832824707, 0.06940829753875732, 1.4894578456878662, 0.47542452812194824, 0.6477446556091309, 1.3828321695327759, 0.5182440280914307, 0.39913463592529297, 2.384068012237549, 0.13991880416870117, 0.11553633213043213, 0.5633081197738647, 0.7734265327453613, 0.5388398170471191, 2.0224859714508057, 1.6371372938156128, 4.79374361038208, 1.8387174606323242], "mean_td_error": 1.260164737701416, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 452.3425076585111, "num_env_steps_trained_throughput_per_sec": 130.25040957131236, "timesteps_total": 63616, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 190848, "timers": {"training_iteration_time_ms": 2125.574, "sample_time_ms": 1513.914, "load_time_ms": 0.533, "load_throughput": 483676.946, "learn_time_ms": 62.256, "learn_throughput": 4144.156, "synch_weights_time_ms": 15.968}, "counters": {"num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "done": false, "episodes_total": 0, "training_iteration": 71, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-48", "timestamp": 1700203128, "time_this_iter_s": 1.9963021278381348, "time_total_s": 146.48385882377625, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 146.48385882377625, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 70.36666666666667, "ram_util_percent": 92.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073382377624512, "actor_loss": -7.419152736663818, "critic_loss": 0.3846968412399292, "alpha_loss": -0.21147456765174866, "alpha_value": 0.9792253971099854, "log_alpha_value": -0.02099340222775936, "target_entropy": -6.0, "policy_t": -0.03487205505371094, "mean_q": 3.529172420501709, "max_q": 4.731465816497803, "min_q": 2.779634714126587}, "td_error": [0.1168900728225708, 4.373730182647705, 1.1030254364013672, 0.12963533401489258, 1.1234664916992188, 1.8461734056472778, 3.069613218307495, 0.7113689184188843, 4.20457649230957, 1.823232650756836, 0.2907932996749878, 0.173087477684021, 1.8414756059646606, 0.21072566509246826, 1.9067431688308716, 5.723570823669434, 0.010803461074829102, 3.9823360443115234, 4.256706237792969, 0.9698865413665771, 1.5708706378936768, 2.493044853210449, 0.749179482460022, 1.234567403793335, 1.4145379066467285, 2.082651138305664, 2.4575421810150146, 0.6581401824951172, 0.6817878484725952, 1.0462061166763306, 1.6424764394760132, 0.33369338512420654, 0.2416015863418579, 2.099317789077759, 2.764235496520996, 5.433801651000977, 0.5046554803848267, 2.1541526317596436, 1.7122917175292969, 2.0087027549743652, 2.003632068634033, 1.4669227600097656, 1.9103604555130005, 0.3372371196746826, 0.09910821914672852, 1.3341623544692993, 3.330660581588745, 2.130838394165039, 3.234482526779175, 3.1958999633789062, 0.8678354024887085, 1.1739921569824219, 3.1946723461151123, 0.7062304019927979, 0.6860899925231934, 0.2860114574432373, 0.9557127952575684, 2.764008045196533, 0.4615750312805176, 2.690396785736084, 0.6893701553344727, 1.616266131401062, 1.4678263664245605, 2.875715732574463, 2.2650234699249268, 0.5542900562286377, 5.899949073791504, 0.5068103075027466, 0.4171541929244995, 0.9211300611495972, 1.284149169921875, 0.7659308910369873, 1.3442527055740356, 1.987028956413269, 2.189922332763672, 0.312322735786438, 1.773106575012207, 2.6553549766540527, 1.336158275604248, 2.616474151611328, 2.5954408645629883, 1.0405240058898926, 0.8371075391769409, 0.35304129123687744, 1.759605050086975, 3.9480700492858887], "mean_td_error": 1.7208505868911743, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11344051361084, "actor_loss": -6.597304344177246, "critic_loss": 0.18410414457321167, "alpha_loss": -0.21261663734912872, "alpha_value": 0.9791962504386902, "log_alpha_value": -0.021023176610469818, "target_entropy": -6.0, "policy_t": -0.06498415768146515, "mean_q": 2.6716055870056152, "max_q": 3.5687830448150635, "min_q": 2.112619161605835}, "td_error": [0.20195496082305908, 1.1559298038482666, 0.5865797996520996, 1.8726863861083984, 2.8678646087646484, 1.8014795780181885, 0.712827205657959, 0.5654685497283936, 0.47744619846343994, 0.7219078540802002, 0.4234358072280884, 1.0267956256866455, 1.625910758972168, 3.9790589809417725, 0.5442557334899902, 0.7171262502670288, 2.4895262718200684, 2.1415910720825195, 0.4342663288116455, 0.43381428718566895, 1.9734899997711182, 0.9732356071472168, 2.2196531295776367, 0.724236249923706, 1.6486451625823975, 0.6307600736618042, 0.7754675149917603, 3.6739847660064697, 0.6674014329910278, 0.6668063402175903, 2.1310126781463623, 0.12259149551391602, 1.1802006959915161, 0.11469507217407227, 2.772120475769043, 0.3144721984863281, 2.063438892364502, 1.7353346347808838, 0.5252007246017456, 1.2186461687088013, 1.0712803602218628, 0.8628818988800049, 1.3919192552566528, 0.7094810009002686, 1.2461990118026733, 0.09904289245605469, 0.078155517578125, 1.9391496181488037, 0.8258973360061646, 2.4428770542144775, 0.44879651069641113, 0.6973079442977905, 1.9045026302337646, 0.9291977882385254, 0.25352442264556885, 0.6267609596252441, 5.013286113739014, 1.6736830472946167, 0.10764896869659424, 1.9958269596099854, 0.21966552734375, 1.7525423765182495, 0.1200796365737915, 1.8923996686935425, 4.5633745193481445, 1.6904603242874146, 0.045439958572387695, 4.348308563232422, 0.7171667814254761, 0.06918275356292725, 0.3163875341415405, 0.10172820091247559, 0.5434473752975464, 0.17079520225524902, 1.9679908752441406, 1.3553401231765747, 0.8679683208465576, 0.1580413579940796, 0.19837403297424316, 0.7925525903701782, 0.7546659708023071, 2.3866748809814453, 0.6213439702987671, 2.5334384441375732, 0.39381933212280273, 0.7467284202575684], "mean_td_error": 1.2157751321792603, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100502014160156, "actor_loss": -6.462864398956299, "critic_loss": 0.2668420672416687, "alpha_loss": -0.21214798092842102, "alpha_value": 0.9792153239250183, "log_alpha_value": -0.021003704518079758, "target_entropy": -6.0, "policy_t": -0.027629341930150986, "mean_q": 2.4907422065734863, "max_q": 3.24161434173584, "min_q": 1.938319444656372}, "td_error": [1.684874176979065, 2.089754581451416, 2.051426410675049, 0.08406341075897217, 0.6180280447006226, 0.5889402627944946, 1.2291983366012573, 0.3371157646179199, 1.742005467414856, 1.088702917098999, 3.170184373855591, 1.971825361251831, 2.2297463417053223, 0.8150211572647095, 2.428739309310913, 0.19425594806671143, 0.3158916234970093, 1.6244614124298096, 0.13891422748565674, 3.367821216583252, 0.8757320642471313, 0.789353609085083, 0.7813839912414551, 3.5534844398498535, 1.3408746719360352, 0.5237113237380981, 0.5802633762359619, 0.3021434545516968, 1.2659783363342285, 0.8462072610855103, 0.5729380249977112, 1.3464373350143433, 0.20276504755020142, 0.9026342034339905, 3.2127976417541504, 0.2626924514770508, 0.473117470741272, 1.3887057304382324, 2.4295458793640137, 2.985530376434326, 1.8079153299331665, 1.2696360349655151, 1.0047155618667603, 1.7894996404647827, 0.2986356019973755, 0.5182298421859741, 0.9403237104415894, 2.0305662155151367, 0.259177565574646, 0.18083655834197998, 1.4584821462631226, 1.2185344696044922, 0.9038325548171997, 0.1549443006515503, 1.847974181175232, 1.074752688407898, 0.6142752170562744, 0.6496056318283081, 2.7210874557495117, 1.1344959735870361, 1.5991226434707642, 1.0578784942626953, 1.1761683225631714, 1.391537070274353, 0.2910064458847046, 2.293335199356079, 1.5073072910308838, 2.971710205078125, 6.330162048339844, 1.6726514101028442, 2.0372180938720703, 1.7052780389785767, 3.490830421447754, 2.179710865020752, 2.5118069648742676, 0.4488353729248047, 1.1894549131393433, 1.4135348796844482, 2.368077039718628, 0.10214054584503174, 1.1329196691513062, 0.8586034774780273, 0.1106177568435669, 1.3109773397445679, 0.3227708339691162, 2.2681446075439453], "mean_td_error": 1.372402310371399, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 459.46076534321804, "num_env_steps_trained_throughput_per_sec": 132.30008644927483, "timesteps_total": 64512, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 2117.228, "sample_time_ms": 1505.406, "load_time_ms": 0.533, "load_throughput": 483849.958, "learn_time_ms": 62.282, "learn_throughput": 4142.427, "synch_weights_time_ms": 15.967}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 18318, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 18318, "last_target_update_ts": 64512, "num_target_updates": 71}, "done": false, "episodes_total": 0, "training_iteration": 72, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-50", "timestamp": 1700203130, "time_this_iter_s": 1.965893030166626, "time_total_s": 148.44975185394287, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 148.44975185394287, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 92.95, "ram_util_percent": 92.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030786514282227, "actor_loss": -7.45640754699707, "critic_loss": 0.3503943681716919, "alpha_loss": -0.21358627080917358, "alpha_value": 0.9789320230484009, "log_alpha_value": -0.021293073892593384, "target_entropy": -6.0, "policy_t": 0.0058858077973127365, "mean_q": 3.5506584644317627, "max_q": 4.328250408172607, "min_q": 2.874913454055786}, "td_error": [1.084616780281067, 0.5249520540237427, 2.700169563293457, 0.9738636016845703, 1.1861933469772339, 1.3363977670669556, 0.7465254068374634, 2.758922576904297, 0.9078426361083984, 0.3641359806060791, 2.251962900161743, 0.5934238433837891, 2.0330581665039062, 1.1835737228393555, 0.7724555730819702, 1.9077855348587036, 1.2916598320007324, 0.5359705686569214, 0.6430824995040894, 0.8441061973571777, 0.44628894329071045, 0.19807422161102295, 5.41239595413208, 3.541090488433838, 0.3635241985321045, 1.7352792024612427, 2.0740528106689453, 1.184062123298645, 2.2448325157165527, 2.5347037315368652, 1.380130648612976, 1.8035027980804443, 2.8495023250579834, 1.5911599397659302, 0.5034728050231934, 1.7814403772354126, 3.193122148513794, 2.0917601585388184, 3.002830982208252, 1.8044211864471436, 0.7125884294509888, 0.2010633945465088, 0.6879441738128662, 2.4979496002197266, 0.30587995052337646, 1.3980351686477661, 1.8866738080978394, 5.482966423034668, 3.0175998210906982, 3.5377845764160156, 0.9259686470031738, 0.17106151580810547, 4.794924736022949, 1.7036124467849731, 0.6472046375274658, 1.0765032768249512, 0.791404128074646, 0.64192795753479, 0.4583204984664917, 0.8704578876495361, 1.3593494892120361, 2.108311176300049, 2.959444046020508, 1.2451590299606323, 1.669357419013977, 0.5495212078094482, 1.8377892971038818, 0.12228786945343018, 0.5583466291427612, 3.2683234214782715, 1.316239833831787, 2.469308376312256, 0.4054129123687744, 0.6480766534805298, 1.3981531858444214, 2.945979595184326, 0.3801008462905884, 1.311320424079895, 3.3885366916656494, 0.5480711460113525, 1.3071134090423584, 0.9917169809341431, 0.6203356981277466, 1.6474061012268066, 0.3254401683807373, 2.4524941444396973], "mean_td_error": 1.5583698749542236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091267585754395, "actor_loss": -6.6389479637146, "critic_loss": 0.22204166650772095, "alpha_loss": -0.2151758223772049, "alpha_value": 0.9789027571678162, "log_alpha_value": -0.02132297493517399, "target_entropy": -6.0, "policy_t": 0.029541537165641785, "mean_q": 2.7235639095306396, "max_q": 3.6139631271362305, "min_q": 1.9350323677062988}, "td_error": [1.047837734222412, 2.72277569770813, 0.1713634729385376, 0.09167814254760742, 0.2833077907562256, 0.3227792978286743, 2.225782871246338, 0.33774352073669434, 0.1144413948059082, 0.6621739268302917, 0.17279016971588135, 2.158867120742798, 4.06718111038208, 0.09751510620117188, 2.782611131668091, 0.15713083744049072, 0.9883280992507935, 2.6095690727233887, 0.8901984095573425, 0.8545924425125122, 1.449819803237915, 0.6826050281524658, 2.6102075576782227, 1.8865768909454346, 3.1336922645568848, 0.624548077583313, 0.39607810974121094, 1.483285665512085, 0.5580416917800903, 1.3719781637191772, 1.5816901922225952, 2.324197769165039, 1.9050413370132446, 1.6605114936828613, 0.26551127433776855, 1.367476224899292, 0.526046633720398, 0.06437885761260986, 0.8355900049209595, 2.1141347885131836, 0.950927734375, 1.72781503200531, 1.1575610637664795, 3.138394832611084, 2.893899440765381, 2.1093568801879883, 2.9559831619262695, 0.38082659244537354, 0.38833630084991455, 1.5892281532287598, 2.7359609603881836, 0.18169426918029785, 1.218879222869873, 1.1931790113449097, 0.36076438426971436, 1.2463266849517822, 1.7407041788101196, 0.6647103428840637, 1.4129135608673096, 2.7946009635925293, 1.3605821132659912, 2.36491060256958, 0.6205474138259888, 1.6071574687957764, 2.953371524810791, 2.471081256866455, 2.1574535369873047, 0.3242151737213135, 0.2794382572174072, 3.9190778732299805, 4.747918128967285, 1.2295186519622803, 0.9022133350372314, 0.9386975765228271, 0.14249193668365479, 2.350353956222534, 0.4490504264831543, 1.7925620079040527, 0.11890923976898193, 1.4960553646087646, 3.393880844116211, 0.441308856010437, 0.8315274715423584, 0.375510573387146, 1.340519905090332, 0.48189496994018555], "mean_td_error": 1.3899115324020386, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127321243286133, "actor_loss": -6.46577787399292, "critic_loss": 0.24885176122188568, "alpha_loss": -0.2157503366470337, "alpha_value": 0.9789215326309204, "log_alpha_value": -0.021303793415427208, "target_entropy": -6.0, "policy_t": 0.010121933184564114, "mean_q": 2.4655725955963135, "max_q": 3.257230758666992, "min_q": 1.850135326385498}, "td_error": [1.2724294662475586, 2.536040782928467, 0.34497684240341187, 2.479912757873535, 3.7556800842285156, 2.5795648097991943, 0.7011662721633911, 2.3650050163269043, 1.2407472133636475, 4.105010509490967, 0.2352147102355957, 1.1865062713623047, 0.8543496131896973, 1.8714759349822998, 1.2389205694198608, 0.5016336441040039, 0.6629185676574707, 0.18471956253051758, 0.7307717800140381, 2.0974063873291016, 1.1161928176879883, 0.048888206481933594, 1.6313574314117432, 2.5546481609344482, 1.3800067901611328, 1.6365071535110474, 0.5795307159423828, 0.8513196706771851, 0.8949882984161377, 0.48983991146087646, 0.734223484992981, 3.07631254196167, 2.4762792587280273, 0.33234965801239014, 3.0233139991760254, 1.1484384536743164, 0.16659438610076904, 0.6048476696014404, 1.030243992805481, 1.1297807693481445, 2.825157642364502, 2.261539936065674, 0.1740255355834961, 0.19373106956481934, 1.4514243602752686, 0.29793238639831543, 2.095184803009033, 2.618866205215454, 2.62052059173584, 0.19057083129882812, 0.3326129913330078, 0.818440318107605, 0.8053604364395142, 2.9753947257995605, 0.7118362188339233, 1.2013434171676636, 1.2184512615203857, 1.7821604013442993, 0.8463430404663086, 1.6158661842346191, 2.9072377681732178, 0.6039680242538452, 2.367345094680786, 0.056192994117736816, 1.3637949228286743, 0.740868091583252, 1.3035509586334229, 1.8179974555969238, 2.9250364303588867, 1.1945170164108276, 1.3596254587173462, 0.09297919273376465, 0.4811248779296875, 0.8185751438140869, 2.2832999229431152, 2.6492810249328613, 0.4543682336807251, 1.0791001319885254, 1.231412649154663, 0.610492467880249, 0.17374610900878906, 1.5482161045074463, 0.94524085521698, 1.0270167589187622, 0.4047527313232422, 1.4245705604553223], "mean_td_error": 1.3343161344528198, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 429.5351668612174, "num_env_steps_trained_throughput_per_sec": 123.68311724352019, "timesteps_total": 65408, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 196224, "timers": {"training_iteration_time_ms": 2132.366, "sample_time_ms": 1520.793, "load_time_ms": 0.535, "load_throughput": 482018.01, "learn_time_ms": 62.45, "learn_throughput": 4131.33, "synch_weights_time_ms": 15.947}, "counters": {"num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "done": false, "episodes_total": 0, "training_iteration": 73, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-52", "timestamp": 1700203132, "time_this_iter_s": 2.1008481979370117, "time_total_s": 150.55060005187988, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 150.55060005187988, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 74.26666666666667, "ram_util_percent": 92.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017128944396973, "actor_loss": -7.327603340148926, "critic_loss": 0.42362403869628906, "alpha_loss": -0.21629638969898224, "alpha_value": 0.9786388278007507, "log_alpha_value": -0.021592654287815094, "target_entropy": -6.0, "policy_t": 0.03775842487812042, "mean_q": 3.472466468811035, "max_q": 4.2794575691223145, "min_q": 2.7734367847442627}, "td_error": [3.776968002319336, 0.8939260244369507, 0.10040068626403809, 3.0807526111602783, 0.9886970520019531, 4.201592922210693, 0.6136090755462646, 0.007248044013977051, 1.4386930465698242, 1.1995106935501099, 1.3662828207015991, 1.6795724630355835, 2.329850912094116, 5.358768939971924, 1.7775664329528809, 2.185314178466797, 1.2040190696716309, 4.424074172973633, 2.1545681953430176, 0.5223753452301025, 2.4421675205230713, 0.31147658824920654, 2.7342677116394043, 1.79214608669281, 2.762988567352295, 0.1155853271484375, 0.4088757038116455, 1.8835088014602661, 0.9647706747055054, 5.441012382507324, 0.5685460567474365, 0.5440050363540649, 2.449873924255371, 2.416675090789795, 1.8085856437683105, 0.1936948299407959, 1.153069019317627, 2.3119499683380127, 2.914364814758301, 5.630394458770752, 4.72556209564209, 0.15290367603302002, 1.0149823427200317, 0.2238161563873291, 1.6670767068862915, 1.3080180883407593, 2.123666286468506, 2.2763888835906982, 0.765661358833313, 0.7050206661224365, 0.17902052402496338, 2.929802179336548, 2.924304485321045, 2.5206356048583984, 0.1584327220916748, 0.458501935005188, 5.278278350830078, 1.0788867473602295, 0.896248459815979, 5.850278854370117, 1.0677019357681274, 0.18746638298034668, 0.6947306394577026, 0.0667344331741333, 1.4531418085098267, 1.3209254741668701, 0.1349048614501953, 1.9098055362701416, 0.40611493587493896, 1.7979841232299805, 0.08405172824859619, 4.773595809936523, 1.2662144899368286, 1.3646221160888672, 0.5532017946243286, 0.7338712215423584, 3.686877727508545, 0.3090554475784302, 0.33044111728668213, 0.7674732208251953, 3.04779052734375, 1.6242539882659912, 1.8908065557479858, 2.51442289352417, 3.6148452758789062, 2.2977280616760254], "mean_td_error": 1.7824184894561768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09196949005127, "actor_loss": -6.540741443634033, "critic_loss": 0.1992034912109375, "alpha_loss": -0.2182166576385498, "alpha_value": 0.9786093235015869, "log_alpha_value": -0.021622803062200546, "target_entropy": -6.0, "policy_t": 0.0028816387057304382, "mean_q": 2.633162021636963, "max_q": 3.621309757232666, "min_q": 1.929422378540039}, "td_error": [0.42817938327789307, 1.1592048406600952, 1.099954605102539, 1.6146550178527832, 0.8396787643432617, 0.754393458366394, 1.8255771398544312, 0.4130812883377075, 2.022756814956665, 1.1073627471923828, 0.4708794355392456, 0.17070770263671875, 2.9581098556518555, 1.6039093732833862, 0.13056933879852295, 2.6890735626220703, 0.5993740558624268, 0.7617592811584473, 1.1442588567733765, 1.6130021810531616, 2.962507724761963, 4.90847635269165, 3.139410972595215, 3.0680510997772217, 0.9628229141235352, 0.7018842697143555, 1.7806415557861328, 1.5084455013275146, 1.291197657585144, 0.3789401054382324, 1.3962522745132446, 2.3829874992370605, 0.21643853187561035, 1.1095973253250122, 2.1232571601867676, 0.521750807762146, 0.48069334030151367, 1.896684169769287, 1.587162733078003, 0.4181710481643677, 0.8097155094146729, 1.3254799842834473, 3.062253952026367, 0.5836620330810547, 0.3074817657470703, 2.295042037963867, 1.6827375888824463, 0.6199449300765991, 0.36857783794403076, 2.5749640464782715, 1.047377109527588, 0.08592450618743896, 0.7839850187301636, 0.6347125768661499, 2.445631980895996, 1.1687953472137451, 0.6864051818847656, 1.5083832740783691, 0.9292013645172119, 2.753082752227783, 1.1849359273910522, 0.33617424964904785, 1.1376497745513916, 0.4199342727661133, 0.6864796876907349, 1.31415855884552, 2.1059608459472656, 1.0525294542312622, 1.5141754150390625, 0.3598978519439697, 1.6153068542480469, 0.49835205078125, 1.0702201128005981, 0.14592647552490234, 2.6649556159973145, 1.016876459121704, 1.8628772497177124, 0.42331182956695557, 0.4582265615463257, 2.7757997512817383, 1.025145411491394, 2.4365506172180176, 1.07479727268219, 1.2681727409362793, 1.4994083642959595, 1.9795567989349365], "mean_td_error": 1.3237512111663818, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107458114624023, "actor_loss": -6.540985584259033, "critic_loss": 0.30830010771751404, "alpha_loss": -0.2183612734079361, "alpha_value": 0.9786277413368225, "log_alpha_value": -0.02160397358238697, "target_entropy": -6.0, "policy_t": -0.01899300515651703, "mean_q": 2.537445306777954, "max_q": 3.2658047676086426, "min_q": 1.823712944984436}, "td_error": [2.10237979888916, 1.288251519203186, 0.023946166038513184, 0.6225945949554443, 2.3575081825256348, 0.9597309827804565, 0.048499107360839844, 0.2915019989013672, 2.038486957550049, 0.9815616607666016, 1.0358659029006958, 1.197746992111206, 0.8393036127090454, 0.5551671981811523, 0.941658616065979, 1.3014041185379028, 1.6203200817108154, 2.3345580101013184, 2.92594051361084, 0.9048753976821899, 0.644644021987915, 3.239943027496338, 4.487247467041016, 2.0818352699279785, 2.5503275394439697, 0.3908424377441406, 1.3651151657104492, 0.7272430658340454, 0.4290945529937744, 1.7028818130493164, 1.2185804843902588, 1.1984541416168213, 4.140496730804443, 4.032299041748047, 1.7817115783691406, 3.1267988681793213, 4.6570539474487305, 1.1237313747406006, 0.3963521718978882, 3.6492228507995605, 2.311105489730835, 0.11972314119338989, 1.7093548774719238, 0.6139955520629883, 0.24485039710998535, 1.2911297082901, 0.6592456102371216, 1.1077524423599243, 4.958968162536621, 0.39392518997192383, 3.072430372238159, 1.7738090753555298, 0.5122177600860596, 1.6911053657531738, 0.2609262466430664, 1.0494285821914673, 3.284388542175293, 0.4393503665924072, 1.256328821182251, 0.8964396715164185, 0.7258619070053101, 1.6294567584991455, 2.334730625152588, 0.008046865463256836, 0.07729959487915039, 0.4981098175048828, 0.8899195194244385, 1.6638761758804321, 2.7374320030212402, 1.081082820892334, 2.0197596549987793, 2.1788506507873535, 0.6337071657180786, 2.099414825439453, 0.9498031139373779, 1.1942658424377441, 0.4293334484100342, 2.119290590286255, 0.05961441993713379, 3.8891801834106445, 0.6894649267196655, 0.69317626953125, 1.5631730556488037, 2.7590725421905518, 0.2231292724609375, 3.975376844406128], "mean_td_error": 1.5358613729476929, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 455.86163025669396, "num_env_steps_trained_throughput_per_sec": 131.26372835516412, "timesteps_total": 66304, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 198912, "timers": {"training_iteration_time_ms": 2116.167, "sample_time_ms": 1504.903, "load_time_ms": 0.535, "load_throughput": 482211.324, "learn_time_ms": 62.5, "learn_throughput": 4127.973, "synch_weights_time_ms": 15.433}, "counters": {"num_env_steps_sampled": 66304, "num_env_steps_trained": 18834, "num_agent_steps_sampled": 198912, "num_agent_steps_trained": 18834, "last_target_update_ts": 66304, "num_target_updates": 73}, "done": false, "episodes_total": 0, "training_iteration": 74, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-54", "timestamp": 1700203134, "time_this_iter_s": 1.9807419776916504, "time_total_s": 152.53134202957153, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 152.53134202957153, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 67.96666666666665, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075346946716309, "actor_loss": -7.243774890899658, "critic_loss": 0.36498090624809265, "alpha_loss": -0.22057071328163147, "alpha_value": 0.9783457517623901, "log_alpha_value": -0.0218921210616827, "target_entropy": -6.0, "policy_t": -0.0038337144069373608, "mean_q": 3.333782911300659, "max_q": 4.296509265899658, "min_q": 2.6744253635406494}, "td_error": [0.3768867254257202, 0.3522615432739258, 3.1206483840942383, 0.8048883676528931, 0.10172832012176514, 1.127903938293457, 1.1369599103927612, 0.8351469039916992, 3.1703433990478516, 1.9017142057418823, 1.788133978843689, 0.08283591270446777, 7.741150856018066, 3.519317150115967, 0.7800360918045044, 1.4225109815597534, 1.3605557680130005, 1.5476974248886108, 0.5075287818908691, 1.8166170120239258, 1.9981592893600464, 1.1116554737091064, 0.41017282009124756, 0.7256189584732056, 1.7843420505523682, 2.438232421875, 2.3508529663085938, 5.189596652984619, 0.317923903465271, 1.56816565990448, 3.0795745849609375, 1.737531065940857, 0.142328143119812, 3.450275421142578, 1.7316950559616089, 2.6313371658325195, 1.6499873399734497, 0.5761312246322632, 1.6679245233535767, 1.5245448350906372, 1.9826173782348633, 1.4570226669311523, 0.6551213264465332, 1.119458556175232, 2.8968796730041504, 1.2609132528305054, 2.5533876419067383, 0.14661109447479248, 0.18766963481903076, 4.307809829711914, 1.9917001724243164, 0.963037371635437, 1.4774116277694702, 0.20992302894592285, 0.7045592069625854, 3.041480302810669, 1.0075339078903198, 0.3249458074569702, 2.8827943801879883, 1.2347463369369507, 1.5004291534423828, 2.261652708053589, 0.7234116792678833, 0.8128695487976074, 2.9493446350097656, 0.6540862321853638, 0.823728084564209, 3.881606340408325, 0.990662693977356, 3.6084461212158203, 0.995011568069458, 3.15938401222229, 1.7418471574783325, 3.1834564208984375, 3.0428032875061035, 0.6311668157577515, 0.19032633304595947, 1.4599723815917969, 2.2649343013763428, 0.15091419219970703, 0.752609372138977, 0.29471397399902344, 2.8615074157714844, 3.1281518936157227, 0.8226345777511597, 0.0788259506225586], "mean_td_error": 1.6622215509414673, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.182401657104492, "actor_loss": -6.631618976593018, "critic_loss": 0.1761278510093689, "alpha_loss": -0.22322532534599304, "alpha_value": 0.9783158898353577, "log_alpha_value": -0.021922659128904343, "target_entropy": -6.0, "policy_t": 0.027759777382016182, "mean_q": 2.6993050575256348, "max_q": 3.670271396636963, "min_q": 1.9305088520050049}, "td_error": [1.1060943603515625, 0.7871687412261963, 1.9422872066497803, 1.8893930912017822, 0.01479041576385498, 0.7904417514801025, 1.4592469930648804, 1.2127141952514648, 2.2134921550750732, 0.7883189916610718, 1.039327621459961, 1.6522425413131714, 1.245714783668518, 0.2685253620147705, 2.385312795639038, 1.913722038269043, 1.494094967842102, 0.6515034437179565, 2.2208404541015625, 1.5419975519180298, 1.0386161804199219, 0.5014382600784302, 0.37159836292266846, 0.20498132705688477, 0.36220240592956543, 0.42981767654418945, 1.2933814525604248, 1.8325355052947998, 2.0498032569885254, 0.04156935214996338, 0.021823763847351074, 0.8274677991867065, 1.1552671194076538, 0.39286768436431885, 0.1875014305114746, 1.5824735164642334, 1.8971699476242065, 1.423161268234253, 2.4445290565490723, 0.777234673500061, 1.7531709671020508, 2.5400004386901855, 2.5875329971313477, 0.9266912937164307, 0.17728674411773682, 0.5258349180221558, 0.2091888189315796, 1.387096643447876, 5.727803707122803, 2.0804085731506348, 0.5140104293823242, 3.011103630065918, 0.8460116386413574, 0.24726033210754395, 0.42732810974121094, 1.7835991382598877, 1.0944305658340454, 0.06004440784454346, 0.5232880115509033, 0.24952149391174316, 1.1570911407470703, 2.6804449558258057, 1.38172447681427, 0.26086509227752686, 0.21425294876098633, 3.025862455368042, 1.7580296993255615, 0.5456162691116333, 1.3188008069992065, 0.32524287700653076, 0.3607679605484009, 0.9092748165130615, 2.2236952781677246, 2.603041172027588, 0.3644486665725708, 1.8643264770507812, 0.019330739974975586, 1.6770797967910767, 1.3713202476501465, 1.0988057851791382, 0.11770069599151611, 0.13294482231140137, 0.2981363534927368, 1.4479840993881226, 0.7329334020614624, 1.4705493450164795], "mean_td_error": 1.1800528764724731, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.139835357666016, "actor_loss": -6.588709831237793, "critic_loss": 0.275858074426651, "alpha_loss": -0.22210484743118286, "alpha_value": 0.9783339500427246, "log_alpha_value": -0.02190418541431427, "target_entropy": -6.0, "policy_t": -0.03165114298462868, "mean_q": 2.575270175933838, "max_q": 3.278899669647217, "min_q": 2.0044567584991455}, "td_error": [2.1533453464508057, 0.6011495590209961, 0.4577345848083496, 1.8238927125930786, 0.6635013818740845, 1.5383079051971436, 1.6635328531265259, 0.4125279188156128, 0.5948759317398071, 2.1621532440185547, 3.757452964782715, 1.704868197441101, 0.5459688901901245, 0.3971186876296997, 0.32468128204345703, 1.6580383777618408, 1.0293290615081787, 0.19906044006347656, 1.4853949546813965, 0.6344557404518127, 1.679857611656189, 2.0725793838500977, 1.9991408586502075, 0.1304394006729126, 0.35974442958831787, 1.7029625177383423, 2.0629310607910156, 2.3993217945098877, 0.6874490976333618, 0.17405664920806885, 0.20631062984466553, 1.1720095872879028, 1.5191917419433594, 0.9708436727523804, 2.7535223960876465, 1.5765736103057861, 2.1955533027648926, 0.6751697063446045, 1.1619536876678467, 0.5650613307952881, 3.021442174911499, 0.7875972986221313, 0.22404944896697998, 1.3353370428085327, 1.9002639055252075, 0.6304895877838135, 0.43860816955566406, 0.14622414112091064, 1.7752457857131958, 1.0971013307571411, 6.25731086730957, 0.2243971824645996, 1.7636895179748535, 2.2850093841552734, 1.2123947143554688, 0.7864401340484619, 1.457404375076294, 1.813915491104126, 2.4796018600463867, 0.5615836381912231, 0.9188424348831177, 0.6195327043533325, 0.8685590028762817, 0.08304047584533691, 3.7487635612487793, 0.7026549577713013, 0.8039556741714478, 3.4476852416992188, 0.6403591632843018, 2.10506534576416, 1.9799977540969849, 1.0292234420776367, 0.23805475234985352, 2.4534778594970703, 1.8899650573730469, 0.8965721130371094, 0.6357172727584839, 2.4571590423583984, 7.533801078796387, 1.3992244005203247, 2.0835318565368652, 0.4536895751953125, 0.37014949321746826, 0.6933940649032593, 1.6538515090942383, 1.9064359664916992], "mean_td_error": 1.4149171113967896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 469.9142414749577, "num_env_steps_trained_throughput_per_sec": 135.31012756756596, "timesteps_total": 67200, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 201600, "timers": {"training_iteration_time_ms": 2106.887, "sample_time_ms": 1496.911, "load_time_ms": 0.533, "load_throughput": 483914.87, "learn_time_ms": 62.388, "learn_throughput": 4135.424, "synch_weights_time_ms": 15.55}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "done": false, "episodes_total": 0, "training_iteration": 75, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-56", "timestamp": 1700203136, "time_this_iter_s": 1.9215121269226074, "time_total_s": 154.45285415649414, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 154.45285415649414, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 66.00000000000001, "ram_util_percent": 92.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01077938079834, "actor_loss": -7.191903114318848, "critic_loss": 0.3356609344482422, "alpha_loss": -0.22215557098388672, "alpha_value": 0.9780527949333191, "log_alpha_value": -0.02219163440167904, "target_entropy": -6.0, "policy_t": 0.01952318847179413, "mean_q": 3.330019474029541, "max_q": 4.21358585357666, "min_q": 2.6686525344848633}, "td_error": [4.478361129760742, 0.7962125539779663, 0.7484550476074219, 3.3204729557037354, 0.6187043190002441, 1.0084973573684692, 3.0489888191223145, 0.782860279083252, 1.768408179283142, 0.7464648485183716, 0.5999113321304321, 3.472024917602539, 1.5721750259399414, 1.277853012084961, 1.425917387008667, 0.055403828620910645, 7.326882362365723, 0.5610653162002563, 3.6062963008880615, 5.691987037658691, 0.23934173583984375, 1.1695092916488647, 1.1280033588409424, 0.8366656303405762, 0.17182636260986328, 0.5859445333480835, 1.8519493341445923, 1.4941415786743164, 0.07501614093780518, 0.5279176235198975, 0.4494485855102539, 3.7099907398223877, 1.6813408136367798, 0.685875654220581, 0.20597302913665771, 0.4857044219970703, 0.7225455045700073, 2.430347442626953, 0.9126070737838745, 0.5257080793380737, 2.121589183807373, 0.1523681879043579, 1.5213258266448975, 1.063937783241272, 3.9277045726776123, 0.2227572202682495, 0.45727217197418213, 3.401121139526367, 0.7005194425582886, 0.9099180698394775, 3.791888475418091, 1.321601152420044, 0.17252421379089355, 0.3515620231628418, 2.5577659606933594, 0.13018715381622314, 1.9542155265808105, 2.9824440479278564, 1.350775122642517, 1.0772019624710083, 0.6148964166641235, 1.868312120437622, 1.8811814785003662, 0.9339010715484619, 2.691352367401123, 2.6244454383850098, 8.164111137390137, 0.7555660009384155, 0.2533036470413208, 1.491042971611023, 0.5298477411270142, 0.34942877292633057, 2.3302440643310547, 1.3108701705932617, 0.8586362600326538, 2.8189849853515625, 1.272017478942871, 1.134080171585083, 1.905574917793274, 0.5220931768417358, 1.0294259786605835, 0.8983474969863892, 2.158731460571289, 1.3045597076416016, 1.0535011291503906, 0.9203085899353027], "mean_td_error": 1.5655841827392578, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048616409301758, "actor_loss": -6.676849365234375, "critic_loss": 0.22912561893463135, "alpha_loss": -0.22330811619758606, "alpha_value": 0.9780223369598389, "log_alpha_value": -0.022222772240638733, "target_entropy": -6.0, "policy_t": 0.04674680903553963, "mean_q": 2.8260810375213623, "max_q": 3.762983560562134, "min_q": 1.8982020616531372}, "td_error": [0.8591634035110474, 3.285961151123047, 0.03939414024353027, 2.7629950046539307, 1.2116984128952026, 1.5191365480422974, 1.4956306219100952, 2.2780325412750244, 1.4730198383331299, 0.49867379665374756, 0.534713864326477, 2.5462701320648193, 1.992533564567566, 0.7149088382720947, 0.6373920440673828, 1.750429630279541, 3.1851696968078613, 3.3486695289611816, 1.2242844104766846, 2.0054543018341064, 1.3891631364822388, 1.2682570219039917, 0.5122361183166504, 1.0201457738876343, 1.3548219203948975, 0.5592062473297119, 0.6100081205368042, 0.25969916582107544, 1.0697683095932007, 1.0944479703903198, 0.7802956104278564, 1.4699177742004395, 0.6261281967163086, 1.5114564895629883, 0.7712396383285522, 1.0630455017089844, 0.8865753412246704, 1.0614656209945679, 1.9663320779800415, 0.40264832973480225, 0.6301436424255371, 0.21903300285339355, 2.4369149208068848, 2.25083065032959, 0.9480395317077637, 0.7221261262893677, 1.643388032913208, 6.5771307945251465, 0.7335691452026367, 0.36039459705352783, 1.0858951807022095, 1.312889814376831, 4.065038681030273, 0.9026446342468262, 1.0872453451156616, 0.7677046060562134, 1.2036283016204834, 0.33119046688079834, 0.09485518932342529, 0.09725356101989746, 0.19077742099761963, 1.561633586883545, 2.154987335205078, 0.8129850625991821, 0.6139731407165527, 0.20570874214172363, 3.159229278564453, 0.1744704246520996, 1.05809485912323, 0.13303470611572266, 3.141751289367676, 1.108335018157959, 3.658879518508911, 2.554525136947632, 3.9648213386535645, 4.968271255493164, 0.7399835586547852, 2.107003688812256, 0.5005606412887573, 1.3529505729675293, 0.25214123725891113, 0.3886610269546509, 2.196420669555664, 0.5207366943359375, 2.22462797164917, 3.5914626121520996], "mean_td_error": 1.4400737285614014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060868263244629, "actor_loss": -6.560606479644775, "critic_loss": 0.28945863246917725, "alpha_loss": -0.22339662909507751, "alpha_value": 0.9780402183532715, "log_alpha_value": -0.022204509004950523, "target_entropy": -6.0, "policy_t": 0.008145431987941265, "mean_q": 2.6169703006744385, "max_q": 3.262026309967041, "min_q": 2.0213022232055664}, "td_error": [0.2640547752380371, 0.5099543333053589, 0.12041187286376953, 0.386175274848938, 0.05704331398010254, 0.46193015575408936, 3.2508926391601562, 0.3159376382827759, 0.25816285610198975, 1.2167092561721802, 3.1812987327575684, 0.4296882152557373, 0.10753262042999268, 2.7449073791503906, 2.1727936267852783, 3.7576732635498047, 1.9663918018341064, 0.33896374702453613, 0.25986790657043457, 2.015287399291992, 1.4930124282836914, 2.4534473419189453, 0.8460135459899902, 0.9867953062057495, 0.9003875255584717, 1.1032801866531372, 2.258763313293457, 0.05085623264312744, 1.0524394512176514, 1.0769093036651611, 1.2025591135025024, 0.12132894992828369, 2.641571044921875, 0.38984215259552, 0.2752569913864136, 2.038442850112915, 0.8362499475479126, 2.288689136505127, 0.9279599189758301, 0.44105076789855957, 0.19603466987609863, 5.074530124664307, 0.5591424703598022, 1.5503976345062256, 0.5261989831924438, 0.019717097282409668, 5.217990875244141, 0.5124481916427612, 1.3753504753112793, 3.3446688652038574, 1.301328420639038, 1.0509415864944458, 5.539619445800781, 0.5342506170272827, 4.285333156585693, 0.7147136926651001, 1.0111479759216309, 3.4249279499053955, 0.4427696466445923, 0.9638484716415405, 0.05166280269622803, 0.4561554193496704, 1.0569971799850464, 0.4844883680343628, 0.2618154287338257, 5.109992980957031, 2.137904167175293, 0.35273921489715576, 3.187636375427246, 0.29692840576171875, 0.44037795066833496, 1.1357320547103882, 0.0668109655380249, 3.579012632369995, 0.8953782320022583, 3.0646092891693115, 3.2311363220214844, 1.5972689390182495, 0.04065132141113281, 2.339641571044922, 0.5521942377090454, 0.2660200595855713, 0.9853154420852661, 1.4031264781951904, 3.127903461456299, 2.2267022132873535], "mean_td_error": 1.4324893951416016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 488.62263749602795, "num_env_steps_trained_throughput_per_sec": 140.69714338613304, "timesteps_total": 68096, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 204288, "timers": {"training_iteration_time_ms": 2038.382, "sample_time_ms": 1428.734, "load_time_ms": 0.531, "load_throughput": 486001.272, "learn_time_ms": 62.244, "learn_throughput": 4144.99, "synch_weights_time_ms": 15.373}, "counters": {"num_env_steps_sampled": 68096, "num_env_steps_trained": 19350, "num_agent_steps_sampled": 204288, "num_agent_steps_trained": 19350, "last_target_update_ts": 68096, "num_target_updates": 75}, "done": false, "episodes_total": 0, "training_iteration": 76, "trial_id": "939a2_00000", "date": "2023-11-16_22-38-57", "timestamp": 1700203137, "time_this_iter_s": 1.8502869606018066, "time_total_s": 156.30314111709595, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 156.30314111709595, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 63.96666666666666, "ram_util_percent": 92.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03074836730957, "actor_loss": -7.15883207321167, "critic_loss": 0.34005868434906006, "alpha_loss": -0.22560182213783264, "alpha_value": 0.9777600169181824, "log_alpha_value": -0.022491024807095528, "target_entropy": -6.0, "policy_t": 0.034254901111125946, "mean_q": 3.2879674434661865, "max_q": 4.038440704345703, "min_q": 2.6162829399108887}, "td_error": [0.9668976068496704, 1.1205406188964844, 0.18715286254882812, 0.19516479969024658, 4.174277305603027, 0.723738431930542, 3.449660301208496, 2.407315254211426, 0.4544661045074463, 0.3375887870788574, 0.13508760929107666, 2.0805511474609375, 5.465197563171387, 4.6761627197265625, 3.277595043182373, 1.2495872974395752, 0.8251563310623169, 0.2891085147857666, 1.5103241205215454, 2.2109761238098145, 0.6365034580230713, 1.490386962890625, 2.0801749229431152, 1.190558910369873, 2.9177393913269043, 0.31814658641815186, 2.0897531509399414, 1.5234187841415405, 0.6278629302978516, 0.21400129795074463, 0.7460641860961914, 0.9311448335647583, 2.2332773208618164, 4.6152520179748535, 2.7311158180236816, 0.18225908279418945, 1.8359345197677612, 3.080833911895752, 2.1407055854797363, 0.6775997877120972, 0.07671725749969482, 1.7258061170578003, 1.9765639305114746, 1.4649379253387451, 0.5685452222824097, 1.5979468822479248, 0.8652595281600952, 1.254083275794983, 1.34485924243927, 1.1022286415100098, 0.5720177888870239, 0.12839341163635254, 1.2324516773223877, 1.897834062576294, 0.8125525712966919, 1.7076528072357178, 2.4995923042297363, 0.40962159633636475, 0.6457036733627319, 0.5909806489944458, 0.49360859394073486, 0.970349907875061, 2.5777058601379395, 0.8193119764328003, 0.04779517650604248, 0.6385021209716797, 1.1678516864776611, 6.882526874542236, 0.2893108129501343, 3.315049171447754, 0.49061858654022217, 0.7393345832824707, 2.309755802154541, 1.400354266166687, 2.36382794380188, 3.773527145385742, 0.5538978576660156, 0.5363881587982178, 2.1543121337890625, 1.4302690029144287, 1.364776372909546, 3.3931729793548584, 1.0065584182739258, 3.20758056640625, 3.16473388671875, 2.2031397819519043], "mean_td_error": 1.601945161819458, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1148042678833, "actor_loss": -6.7453179359436035, "critic_loss": 0.24432596564292908, "alpha_loss": -0.22781340777873993, "alpha_value": 0.9777289628982544, "log_alpha_value": -0.02252277173101902, "target_entropy": -6.0, "policy_t": 0.05163022130727768, "mean_q": 2.8547372817993164, "max_q": 3.806912899017334, "min_q": 1.9304696321487427}, "td_error": [0.2437688112258911, 2.351189136505127, 5.319953918457031, 0.21805548667907715, 0.6709164381027222, 0.44326329231262207, 3.3188323974609375, 0.8067294359207153, 1.146651268005371, 2.563532829284668, 1.5435080528259277, 1.2708927392959595, 3.3446784019470215, 1.395225167274475, 1.1707772016525269, 2.158869743347168, 0.4027583599090576, 2.5061771869659424, 1.4150406122207642, 0.34807848930358887, 2.0588464736938477, 0.1199808120727539, 1.047417163848877, 0.35968244075775146, 4.036742210388184, 1.0768498182296753, 1.1735254526138306, 0.5013258457183838, 0.6880062818527222, 1.9018138647079468, 2.133378505706787, 2.449415445327759, 2.495943784713745, 0.12472069263458252, 1.2081822156906128, 0.27785587310791016, 0.08507728576660156, 3.628859519958496, 1.0260200500488281, 0.4575786590576172, 0.7227910757064819, 1.3305588960647583, 1.9591755867004395, 0.7813498973846436, 1.463194489479065, 0.869213342666626, 0.25525104999542236, 2.9024529457092285, 0.9523178339004517, 3.254514694213867, 2.0136876106262207, 0.9907066822052002, 0.8744425773620605, 3.961484432220459, 1.5481574535369873, 1.2286007404327393, 0.8260043859481812, 1.094201683998108, 2.515305519104004, 1.4257029294967651, 1.5924837589263916, 1.8930422067642212, 2.915090322494507, 1.8501026630401611, 2.2877581119537354, 1.8804010152816772, 2.016324996948242, 0.8829396963119507, 2.9501378536224365, 1.2124649286270142, 0.22496676445007324, 0.5514718294143677, 2.528618335723877, 2.1892361640930176, 0.6370875835418701, 1.511473536491394, 0.657051682472229, 0.5585925579071045, 1.0714608430862427, 1.700666904449463, 1.1346193552017212, 0.5770479440689087, 2.4465980529785156, 0.9335362315177917, 3.245213031768799, 1.102984070777893], "mean_td_error": 1.5233790874481201, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118356704711914, "actor_loss": -6.605878829956055, "critic_loss": 0.23219239711761475, "alpha_loss": -0.22771085798740387, "alpha_value": 0.9777466058731079, "log_alpha_value": -0.02250472828745842, "target_entropy": -6.0, "policy_t": 0.00866912491619587, "mean_q": 2.595470666885376, "max_q": 3.4091765880584717, "min_q": 1.9707075357437134}, "td_error": [0.1426849365234375, 2.6104328632354736, 3.0663886070251465, 1.6815505027770996, 0.7421990633010864, 0.9747409820556641, 0.17899727821350098, 0.8139899969100952, 0.9383292198181152, 0.22308731079101562, 2.729795455932617, 3.073277235031128, 0.29946720600128174, 0.04727482795715332, 1.1876596212387085, 0.07978129386901855, 1.0495686531066895, 2.954660415649414, 0.5990705490112305, 0.8348865509033203, 1.1243250370025635, 0.07480752468109131, 0.5967899560928345, 0.3912084102630615, 0.49592840671539307, 2.135850429534912, 0.8621532917022705, 2.060938835144043, 0.9750779867172241, 1.4266692399978638, 0.0658729076385498, 1.1693776845932007, 1.2683749198913574, 1.1986854076385498, 0.03974306583404541, 3.9598183631896973, 0.6707873344421387, 0.7538256645202637, 1.6607931852340698, 2.1830296516418457, 0.19321119785308838, 0.9546146392822266, 1.784584879875183, 0.29547739028930664, 0.07003176212310791, 1.176544427871704, 0.19228339195251465, 0.3357677459716797, 1.2740379571914673, 0.6695833206176758, 2.5578298568725586, 1.3771647214889526, 2.172236442565918, 1.6324299573898315, 0.9110507965087891, 0.655759334564209, 1.9785066843032837, 0.6605756282806396, 0.4873882532119751, 0.04508781433105469, 0.215173602104187, 2.8657217025756836, 1.2834012508392334, 0.6351641416549683, 1.0878775119781494, 1.2839144468307495, 0.8491338491439819, 2.2489681243896484, 4.579595565795898, 0.29096221923828125, 3.1134767532348633, 1.1297560930252075, 2.4578447341918945, 1.664184808731079, 0.4797302484512329, 2.0802721977233887, 2.4798123836517334, 0.7491747140884399, 0.9045276641845703, 3.9944815635681152, 0.0572810173034668, 2.139622688293457, 0.25731515884399414, 0.3460348844528198, 0.7569519281387329, 0.5496165752410889], "mean_td_error": 1.2240239381790161, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 439.86147457729083, "num_env_steps_trained_throughput_per_sec": 126.65654067069313, "timesteps_total": 68992, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 206976, "timers": {"training_iteration_time_ms": 2005.856, "sample_time_ms": 1436.869, "load_time_ms": 0.529, "load_throughput": 487907.675, "learn_time_ms": 62.119, "learn_throughput": 4153.315, "synch_weights_time_ms": 15.378}, "counters": {"num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "done": false, "episodes_total": 0, "training_iteration": 77, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-00", "timestamp": 1700203140, "time_this_iter_s": 2.0518720149993896, "time_total_s": 158.35501313209534, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 158.35501313209534, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 68.23333333333333, "ram_util_percent": 92.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028637886047363, "actor_loss": -7.072554588317871, "critic_loss": 0.3232923746109009, "alpha_loss": -0.22855627536773682, "alpha_value": 0.9774673581123352, "log_alpha_value": -0.02279035933315754, "target_entropy": -6.0, "policy_t": 0.014672583900392056, "mean_q": 3.2471320629119873, "max_q": 3.939009428024292, "min_q": 2.723999261856079}, "td_error": [0.3431159257888794, 0.15653729438781738, 1.2654979228973389, 0.7531818151473999, 0.5706350803375244, 1.1782655715942383, 2.3400635719299316, 2.0269131660461426, 0.5305567979812622, 0.14057958126068115, 3.103908061981201, 2.9810791015625, 0.9718945026397705, 0.1338503360748291, 1.9592534303665161, 0.9523146152496338, 0.07463765144348145, 1.3873867988586426, 0.462923526763916, 0.8900179862976074, 1.716895580291748, 1.7330808639526367, 1.6894365549087524, 1.3393878936767578, 0.408750057220459, 1.974458932876587, 0.7595639228820801, 0.4499250650405884, 0.4331939220428467, 3.484314441680908, 3.630882740020752, 0.6977564096450806, 3.7348825931549072, 4.414316177368164, 0.6529227495193481, 0.887885332107544, 0.38508737087249756, 3.2887892723083496, 0.23752939701080322, 0.6134227514266968, 1.764419436454773, 1.2616523504257202, 1.1355327367782593, 4.524937152862549, 3.3386070728302, 0.6565103530883789, 0.18801891803741455, 1.2303699254989624, 0.5804034471511841, 2.6755824089050293, 4.77607536315918, 0.5890103578567505, 2.224700689315796, 2.3655619621276855, 1.5919709205627441, 1.1913440227508545, 1.4780423641204834, 1.0623447895050049, 1.089849591255188, 0.2220315933227539, 1.1375224590301514, 2.9393882751464844, 0.19037091732025146, 1.3647180795669556, 0.4080554246902466, 0.2343583106994629, 3.6435294151306152, 1.3092994689941406, 3.4725522994995117, 0.5474661588668823, 1.3858511447906494, 1.5670037269592285, 0.5268428325653076, 1.3018854856491089, 0.9294126033782959, 2.3942887783050537, 2.40842866897583, 0.20911288261413574, 1.3001399040222168, 1.3270360231399536, 2.670023202896118, 0.589991569519043, 2.962324380874634, 1.358776569366455, 2.367082357406616, 2.9607176780700684], "mean_td_error": 1.5140492916107178, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098810195922852, "actor_loss": -6.700656414031982, "critic_loss": 0.2334757149219513, "alpha_loss": -0.2304835170507431, "alpha_value": 0.9774356484413147, "log_alpha_value": -0.02282283827662468, "target_entropy": -6.0, "policy_t": -0.00463781226426363, "mean_q": 2.815350294113159, "max_q": 3.91873836517334, "min_q": 1.8615241050720215}, "td_error": [0.5607235431671143, 1.3819360733032227, 4.152746200561523, 3.1983206272125244, 0.14932143688201904, 0.4902229309082031, 2.1698899269104004, 0.156316876411438, 0.12538564205169678, 0.646925687789917, 2.236903667449951, 0.8021022081375122, 0.5409485101699829, 0.19614815711975098, 0.12592101097106934, 0.5125366449356079, 1.1786844730377197, 0.8599003553390503, 0.6745567321777344, 0.5562794208526611, 1.4834951162338257, 1.4955252408981323, 1.4757908582687378, 1.8949158191680908, 3.1947181224823, 0.15008461475372314, 2.001805305480957, 0.7917321920394897, 2.959350109100342, 1.3101223707199097, 0.356417179107666, 1.1056147813796997, 0.6370283365249634, 1.6275818347930908, 1.315200686454773, 1.519852638244629, 2.543592929840088, 0.137556791305542, 1.7432917356491089, 3.2725017070770264, 2.0503573417663574, 4.482383728027344, 0.11137855052947998, 0.24466264247894287, 1.1222655773162842, 3.984318256378174, 1.8559973239898682, 0.11605370044708252, 1.7866129875183105, 1.2311872243881226, 1.4322415590286255, 0.7377817630767822, 2.3546314239501953, 0.5150845050811768, 0.18040215969085693, 2.6452345848083496, 1.7973781824111938, 2.277381181716919, 0.460740327835083, 0.8228546380996704, 3.5210325717926025, 1.3037421703338623, 0.10707807540893555, 3.3937439918518066, 2.133053779602051, 0.1375797986984253, 0.15492522716522217, 2.2796878814697266, 1.871052622795105, 0.49838459491729736, 0.15415740013122559, 0.810397744178772, 0.6961345672607422, 0.11357593536376953, 0.47041165828704834, 1.8321467638015747, 0.37304437160491943, 0.7670367360115051, 2.9000518321990967, 4.23345947265625, 3.1682143211364746, 2.1502251625061035, 0.2549334764480591, 1.508239507675171, 2.5606045722961426, 3.074227809906006], "mean_td_error": 1.423349380493164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080665588378906, "actor_loss": -6.582522869110107, "critic_loss": 0.25715094804763794, "alpha_loss": -0.22988958656787872, "alpha_value": 0.9774530529975891, "log_alpha_value": -0.022805001586675644, "target_entropy": -6.0, "policy_t": -0.006834859494119883, "mean_q": 2.625490427017212, "max_q": 3.484163999557495, "min_q": 1.9220114946365356}, "td_error": [1.704615592956543, 1.1978638172149658, 4.011608600616455, 1.457399845123291, 2.3742005825042725, 2.0032243728637695, 0.39052915573120117, 2.570465087890625, 0.6454542875289917, 0.18014562129974365, 2.777618408203125, 0.4654116630554199, 1.2761653661727905, 1.7928389310836792, 0.1313936710357666, 1.8603979349136353, 0.8261805772781372, 4.524712085723877, 1.914063811302185, 0.34803974628448486, 1.5824618339538574, 1.4130192995071411, 2.921340227127075, 1.7998027801513672, 0.09161710739135742, 0.8923234939575195, 0.16248619556427002, 0.9876105785369873, 2.2319283485412598, 0.8971585035324097, 1.5247833728790283, 0.008706450462341309, 1.3463798761367798, 0.40080225467681885, 0.04155230522155762, 3.5198471546173096, 0.520544171333313, 0.2118816375732422, 0.8876914978027344, 1.3833465576171875, 2.5583722591400146, 1.7829508781433105, 2.28005313873291, 2.597069501876831, 2.047970771789551, 0.8832519054412842, 1.7115799188613892, 1.1408655643463135, 2.455444812774658, 0.19472360610961914, 2.0569937229156494, 0.6702982187271118, 0.7359527349472046, 0.2307143211364746, 0.691948652267456, 1.4381235837936401, 1.5395276546478271, 0.49671411514282227, 0.24473834037780762, 1.2913527488708496, 1.0920294523239136, 0.8440674543380737, 2.3885562419891357, 3.9486026763916016, 0.36999523639678955, 2.2102019786834717, 1.6533005237579346, 0.5389419794082642, 0.5384774208068848, 1.851183295249939, 2.0588202476501465, 0.3059515953063965, 0.9761154651641846, 0.36752212047576904, 0.2793557643890381, 1.3725016117095947, 0.37466132640838623, 2.9120492935180664, 1.6988533735275269, 1.8151438236236572, 1.795499563217163, 0.09621191024780273, 0.9533518552780151, 0.38740789890289307, 1.1852632761001587, 0.5072950124740601], "mean_td_error": 1.335437536239624, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.88242457150386, "num_env_steps_trained_throughput_per_sec": 135.0130195752768, "timesteps_total": 69888, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 2006.697, "sample_time_ms": 1437.722, "load_time_ms": 0.528, "load_throughput": 488458.261, "learn_time_ms": 61.99, "learn_throughput": 4161.984, "synch_weights_time_ms": 15.693}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 78, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-02", "timestamp": 1700203142, "time_this_iter_s": 1.9238147735595703, "time_total_s": 160.2788279056549, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 160.2788279056549, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 90.05000000000001, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09714126586914, "actor_loss": -7.05448579788208, "critic_loss": 0.3447013795375824, "alpha_loss": -0.233139306306839, "alpha_value": 0.9771748781204224, "log_alpha_value": -0.023089637979865074, "target_entropy": -6.0, "policy_t": 0.04661465436220169, "mean_q": 3.1354987621307373, "max_q": 3.834568500518799, "min_q": 2.6722445487976074}, "td_error": [1.3534622192382812, 0.14897942543029785, 2.659735679626465, 1.7440860271453857, 0.7360700368881226, 1.0856983661651611, 5.623172283172607, 1.0399563312530518, 2.620225429534912, 2.010977268218994, 1.6374011039733887, 1.7264081239700317, 0.31510496139526367, 1.7773175239562988, 2.680784225463867, 3.861351251602173, 0.4841564893722534, 0.7007777690887451, 0.5090746879577637, 2.0743517875671387, 1.4920066595077515, 0.9918675422668457, 0.662956953048706, 0.2993285655975342, 0.3367950916290283, 1.6900402307510376, 3.287994623184204, 2.4299049377441406, 0.7007595300674438, 0.5584017038345337, 0.528321385383606, 1.8990144729614258, 3.847963333129883, 2.5390172004699707, 2.9819369316101074, 1.7435837984085083, 1.387060523033142, 0.8779829740524292, 0.45160865783691406, 2.6903014183044434, 2.297307014465332, 1.6629611253738403, 4.989350318908691, 1.6426944732666016, 0.7132277488708496, 0.3015533685684204, 0.8170909881591797, 0.1389772891998291, 0.42036402225494385, 0.2926708459854126, 1.3953191041946411, 0.08578109741210938, 1.150092363357544, 2.2893052101135254, 2.63446044921875, 0.16023218631744385, 1.3101694583892822, 1.3669426441192627, 0.44363510608673096, 1.196256399154663, 0.0883951187133789, 3.597529411315918, 5.02078914642334, 2.173182964324951, 0.5522297620773315, 3.195966958999634, 0.9057449102401733, 5.012948989868164, 0.9535866975784302, 2.537750005722046, 1.4982118606567383, 2.0308594703674316, 1.0450596809387207, 1.995006799697876, 1.5717540979385376, 0.0761866569519043, 1.4004542827606201, 1.4149144887924194, 1.4158034324645996, 2.271981716156006, 0.9055526256561279, 1.7389860153198242, 0.09499871730804443, 2.768784523010254, 2.4001426696777344, 0.3891972303390503], "mean_td_error": 1.6110504865646362, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103972434997559, "actor_loss": -6.688235282897949, "critic_loss": 0.2444222867488861, "alpha_loss": -0.2336333990097046, "alpha_value": 0.977142333984375, "log_alpha_value": -0.02312292531132698, "target_entropy": -6.0, "policy_t": 0.012267015874385834, "mean_q": 2.7915878295898438, "max_q": 3.8451035022735596, "min_q": 1.9017056226730347}, "td_error": [2.1987953186035156, 0.2068268060684204, 1.627790927886963, 1.8546932935714722, 0.11239743232727051, 0.04986011981964111, 0.4966374635696411, 0.28170549869537354, 0.1976686716079712, 0.6074284315109253, 3.2843446731567383, 3.9426565170288086, 2.089059591293335, 1.946737289428711, 2.4940991401672363, 0.8556293249130249, 0.47336745262145996, 3.050236463546753, 1.3466731309890747, 3.5822787284851074, 0.47773659229278564, 1.5520838499069214, 2.3042407035827637, 0.17489445209503174, 1.9143261909484863, 1.769113540649414, 0.4793921709060669, 1.274195909500122, 3.134537935256958, 2.1912765502929688, 0.47574448585510254, 1.6610344648361206, 1.4775729179382324, 0.48703527450561523, 1.6523617506027222, 1.5406264066696167, 0.5188064575195312, 2.2908263206481934, 0.09864950180053711, 0.0653984546661377, 1.0478956699371338, 0.6074469089508057, 2.691344976425171, 0.8502415418624878, 0.5258001089096069, 0.11835300922393799, 2.4901680946350098, 2.5239391326904297, 1.8472919464111328, 0.46412432193756104, 2.4095120429992676, 1.129581093788147, 5.302566051483154, 0.4262838363647461, 0.17089176177978516, 0.9740829467773438, 1.0520235300064087, 0.5212557315826416, 0.6171258687973022, 1.6207212209701538, 1.0950177907943726, 0.5547329187393188, 2.5330147743225098, 4.095375061035156, 0.6989682912826538, 1.2458585500717163, 1.560360074043274, 0.9253994226455688, 1.6715493202209473, 1.2200736999511719, 2.2032718658447266, 0.28993844985961914, 0.8198068141937256, 2.719698905944824, 3.434727430343628, 3.458815574645996, 2.2649755477905273, 0.2752664089202881, 1.5902268886566162, 2.4748244285583496, 0.7938774824142456, 0.1483163833618164, 0.3111454248428345, 3.2098498344421387, 3.103562355041504, 2.2692155838012695], "mean_td_error": 1.495316982269287, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058526039123535, "actor_loss": -6.699438571929932, "critic_loss": 0.30018627643585205, "alpha_loss": -0.23240453004837036, "alpha_value": 0.9771596789360046, "log_alpha_value": -0.023105226457118988, "target_entropy": -6.0, "policy_t": -0.03315854072570801, "mean_q": 2.7629785537719727, "max_q": 3.417813539505005, "min_q": 2.0261762142181396}, "td_error": [4.422533988952637, 0.14420080184936523, 1.727186679840088, 1.2481610774993896, 2.367264747619629, 3.8066701889038086, 1.6237162351608276, 1.1344364881515503, 2.3462257385253906, 1.2088757753372192, 1.432287573814392, 3.720533847808838, 0.594082236289978, 0.17294621467590332, 0.4574263095855713, 0.8235738277435303, 0.9844478368759155, 0.04429304599761963, 2.234767436981201, 1.2087762355804443, 0.7613893747329712, 0.5676476359367371, 1.2517682313919067, 2.185330867767334, 0.8248218297958374, 2.239809274673462, 1.7507293224334717, 2.0696120262145996, 2.6354763507843018, 3.3539443016052246, 1.9908791780471802, 1.2547063827514648, 1.3551826477050781, 1.1609987020492554, 0.4924982786178589, 0.5347853899002075, 0.3773844242095947, 3.7400612831115723, 0.023155808448791504, 0.36864936351776123, 0.2225179672241211, 4.448940753936768, 3.354267120361328, 1.3513389825820923, 1.717561960220337, 2.55104923248291, 0.5455285310745239, 0.3456451892852783, 0.38231360912323, 1.882097840309143, 0.5448178052902222, 2.0158610343933105, 1.8063273429870605, 2.695420265197754, 1.9123013019561768, 1.1996557712554932, 0.5492604970932007, 2.157714366912842, 0.917756199836731, 0.8521950244903564, 2.8766603469848633, 2.32528018951416, 0.8268197774887085, 1.1603788137435913, 1.5854218006134033, 2.318406105041504, 1.155288815498352, 4.38228178024292, 2.522709846496582, 0.6839057207107544, 2.332003355026245, 0.4319072961807251, 1.8668352365493774, 0.5116089582443237, 0.12348783016204834, 0.06527554988861084, 1.8769878149032593, 1.3731815814971924, 1.484642744064331, 0.30082428455352783, 0.7978037595748901, 1.2328158617019653, 1.0482304096221924, 0.795519232749939, 1.5204222202301025, 1.8706583976745605], "mean_td_error": 1.506548523902893, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 488.4843716956173, "num_env_steps_trained_throughput_per_sec": 140.65733024271123, "timesteps_total": 70784, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 212352, "timers": {"training_iteration_time_ms": 1989.147, "sample_time_ms": 1419.321, "load_time_ms": 0.528, "load_throughput": 488921.715, "learn_time_ms": 61.981, "learn_throughput": 4162.554, "synch_weights_time_ms": 15.715}, "counters": {"num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "done": false, "episodes_total": 0, "training_iteration": 79, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-03", "timestamp": 1700203143, "time_this_iter_s": 1.848555088043213, "time_total_s": 162.12738299369812, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 162.12738299369812, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076476097106934, "actor_loss": -7.076420307159424, "critic_loss": 0.352400541305542, "alpha_loss": -0.23567913472652435, "alpha_value": 0.9768823385238647, "log_alpha_value": -0.023389045149087906, "target_entropy": -6.0, "policy_t": 0.01853807643055916, "mean_q": 3.169170379638672, "max_q": 3.8075215816497803, "min_q": 2.6827423572540283}, "td_error": [2.667581081390381, 3.184903621673584, 1.894068717956543, 0.34736108779907227, 0.5938835144042969, 0.6772468090057373, 0.30374670028686523, 1.705187439918518, 2.213937759399414, 1.051132082939148, 3.555764675140381, 1.3051353693008423, 1.6999329328536987, 2.3233964443206787, 0.5479408502578735, 0.617883563041687, 1.5314093828201294, 1.45082688331604, 1.2876157760620117, 4.586080551147461, 1.9910800457000732, 1.9205925464630127, 1.9606022834777832, 3.8389663696289062, 2.521310806274414, 2.1119191646575928, 4.55634880065918, 1.1325658559799194, 0.7278791666030884, 1.1622555255889893, 0.42049336433410645, 0.3416513204574585, 0.09211242198944092, 3.1076507568359375, 1.3017784357070923, 0.18430471420288086, 0.23315680027008057, 4.562022686004639, 3.9596385955810547, 3.4514169692993164, 0.13308072090148926, 0.45227718353271484, 1.9302045106887817, 1.7267346382141113, 0.9423885345458984, 0.4820876121520996, 3.236807346343994, 1.0189114809036255, 0.38064050674438477, 1.6490012407302856, 1.276532530784607, 1.5997530221939087, 1.0196566581726074, 2.348381757736206, 2.147193670272827, 0.15198171138763428, 0.1312042474746704, 0.9099898338317871, 0.8065599203109741, 2.859862804412842, 2.474827766418457, 0.9466966390609741, 2.460333824157715, 2.0776352882385254, 0.9411998987197876, 2.4917876720428467, 0.6392393112182617, 0.6187598705291748, 1.0444053411483765, 0.015582561492919922, 1.530896782875061, 0.3760310411453247, 3.8529865741729736, 2.2297897338867188, 0.48639416694641113, 0.5260635614395142, 1.4980629682540894, 2.850250720977783, 2.782648801803589, 0.9691442251205444, 2.407527446746826, 2.315821886062622, 3.1683523654937744, 0.20437240600585938, 0.4827078580856323, 0.33263540267944336], "mean_td_error": 1.6052347421646118, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052434921264648, "actor_loss": -6.672852993011475, "critic_loss": 0.2097092568874359, "alpha_loss": -0.235458642244339, "alpha_value": 0.9768491387367249, "log_alpha_value": -0.02342304214835167, "target_entropy": -6.0, "policy_t": 0.008586596697568893, "mean_q": 2.816673755645752, "max_q": 3.7265686988830566, "min_q": 2.0350341796875}, "td_error": [2.224903106689453, 1.2740471363067627, 2.919337749481201, 0.8789335489273071, 0.5904929637908936, 0.44833922386169434, 0.8569248914718628, 0.35721564292907715, 0.1626795530319214, 0.15727972984313965, 0.2756921052932739, 0.6739063262939453, 2.259969711303711, 3.2005186080932617, 0.3327186107635498, 1.6100813150405884, 3.014443874359131, 2.313826322555542, 1.6877715587615967, 4.513367176055908, 0.8358186483383179, 1.4129199981689453, 2.0473294258117676, 0.5828559398651123, 2.2817139625549316, 0.401684045791626, 0.52043616771698, 0.8708372116088867, 2.8483433723449707, 0.8076654672622681, 5.161458969116211, 1.923658013343811, 0.5198402404785156, 2.953779697418213, 1.146039366722107, 3.936976432800293, 1.7345229387283325, 1.3481043577194214, 0.9603365659713745, 0.4142177104949951, 0.736168622970581, 0.8682742118835449, 1.6482967138290405, 0.7244161367416382, 0.36607038974761963, 2.3815536499023438, 0.9819408655166626, 2.859595775604248, 0.9173997640609741, 1.0104862451553345, 1.179871678352356, 3.756763219833374, 0.16175687313079834, 0.47658824920654297, 0.883537769317627, 0.6783649921417236, 2.3820207118988037, 0.02852606773376465, 0.39871859550476074, 2.1343531608581543, 1.0463536977767944, 0.29527318477630615, 0.47104787826538086, 1.3919038772583008, 2.580763339996338, 0.8237756490707397, 0.721420168876648, 2.2928152084350586, 2.193394899368286, 2.1635167598724365, 1.6936317682266235, 0.8977714776992798, 0.39961767196655273, 0.9054840803146362, 1.715880274772644, 0.03553438186645508, 1.1372865438461304, 1.1188700199127197, 1.5502984523773193, 0.5961201190948486, 0.5792468786239624, 1.4692705869674683, 1.0889211893081665, 0.7390213012695312, 0.43892574310302734, 2.120701313018799], "mean_td_error": 1.366308569908142, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.143826484680176, "actor_loss": -6.643146514892578, "critic_loss": 0.26480746269226074, "alpha_loss": -0.23741979897022247, "alpha_value": 0.9768664240837097, "log_alpha_value": -0.023405348882079124, "target_entropy": -6.0, "policy_t": 0.020290091633796692, "mean_q": 2.661391258239746, "max_q": 3.5541133880615234, "min_q": 2.0326836109161377}, "td_error": [1.1054270267486572, 2.353884220123291, 0.21050047874450684, 1.9094767570495605, 1.2944260835647583, 1.9393759965896606, 0.3757021427154541, 3.077172040939331, 0.22200489044189453, 3.7894768714904785, 1.3037463426589966, 2.261345386505127, 0.06693458557128906, 1.1175191402435303, 0.5105655193328857, 1.1462128162384033, 2.24858021736145, 2.5225048065185547, 0.4485224485397339, 0.9168170690536499, 1.2218555212020874, 4.196449279785156, 2.0771610736846924, 0.14862847328186035, 0.34856700897216797, 2.0558547973632812, 0.5534025430679321, 1.4105350971221924, 3.2476348876953125, 0.6880754232406616, 1.211911678314209, 1.1802645921707153, 0.5844701528549194, 0.7996509075164795, 0.6972261667251587, 2.0882883071899414, 0.7720130681991577, 2.1505467891693115, 3.063450813293457, 3.370594024658203, 0.5810379981994629, 3.6660261154174805, 2.2044472694396973, 1.0924758911132812, 3.2381792068481445, 2.9358222484588623, 1.2009623050689697, 2.0283446311950684, 0.367389440536499, 0.1440424919128418, 0.46333110332489014, 0.07309269905090332, 0.0237501859664917, 0.8718491792678833, 0.1857144832611084, 0.5516972541809082, 1.4074410200119019, 0.5657808780670166, 0.34026551246643066, 2.0393474102020264, 3.8775179386138916, 5.745247840881348, 0.5237764120101929, 0.1865384578704834, 0.9825189113616943, 1.1394002437591553, 2.643002510070801, 0.6501593589782715, 0.9561132192611694, 0.290519654750824, 0.7082061767578125, 0.6415560245513916, 0.36343657970428467, 0.5931391716003418, 1.5944602489471436, 0.3816264867782593, 0.8316317796707153, 0.8078455924987793, 0.4441649913787842, 0.915185809135437, 2.1516194343566895, 1.7861605882644653, 3.685889720916748, 0.8591833114624023, 0.46692442893981934, 0.4768925905227661], "mean_td_error": 1.3764009475708008, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.0606695282216, "num_env_steps_trained_throughput_per_sec": 138.23175528826022, "timesteps_total": 71680, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 1937.1, "sample_time_ms": 1366.822, "load_time_ms": 0.531, "load_throughput": 485434.43, "learn_time_ms": 62.027, "learn_throughput": 4159.455, "synch_weights_time_ms": 15.621}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 80, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-05", "timestamp": 1700203145, "time_this_iter_s": 1.8808810710906982, "time_total_s": 164.00826406478882, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0754160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 164.00826406478882, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 64.9, "ram_util_percent": 92.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05815315246582, "actor_loss": -7.028803825378418, "critic_loss": 0.41048333048820496, "alpha_loss": -0.23826271295547485, "alpha_value": 0.9765898585319519, "log_alpha_value": -0.023688513785600662, "target_entropy": -6.0, "policy_t": 0.025557145476341248, "mean_q": 3.135493516921997, "max_q": 3.7954039573669434, "min_q": 2.5741238594055176}, "td_error": [0.21770989894866943, 3.5825490951538086, 0.8270777463912964, 0.5764669179916382, 0.7709399461746216, 0.5408183336257935, 0.4422069787979126, 0.45151782035827637, 1.6660255193710327, 0.26241934299468994, 3.229583740234375, 2.6648459434509277, 2.7667126655578613, 2.8250484466552734, 0.132726788520813, 1.1506426334381104, 2.857163429260254, 2.9397408962249756, 0.033046722412109375, 1.4789828062057495, 7.100460052490234, 3.2890543937683105, 0.7426247596740723, 1.5495314598083496, 0.20718228816986084, 0.39981818199157715, 1.8649637699127197, 1.9877859354019165, 0.25890660285949707, 2.9281363487243652, 0.16392993927001953, 1.7204136848449707, 2.049448251724243, 0.5384202003479004, 2.011699676513672, 0.04153859615325928, 1.367218255996704, 4.912069797515869, 5.480306148529053, 2.9593253135681152, 0.027999520301818848, 0.636684775352478, 1.895438313484192, 2.7205870151519775, 1.1080278158187866, 1.1025817394256592, 0.3573465347290039, 0.5642555952072144, 0.9400200843811035, 4.312327861785889, 1.2429474592208862, 1.2962651252746582, 2.57753849029541, 2.4872727394104004, 0.7588450908660889, 1.7542436122894287, 0.41961467266082764, 6.666482925415039, 0.6804956197738647, 2.0693137645721436, 3.2540385723114014, 0.4655047655105591, 3.9680209159851074, 1.7763351202011108, 1.8651801347732544, 3.2270050048828125, 4.056722640991211, 6.61068058013916, 3.117417335510254, 0.8309537172317505, 1.0860861539840698, 1.0863593816757202, 0.8986456394195557, 1.051841378211975, 0.690942645072937, 0.7091878652572632, 2.004990577697754, 2.44963002204895, 0.7319031953811646, 1.335178017616272, 1.1498205661773682, 3.652632236480713, 1.1077319383621216, 1.5782188177108765, 1.2359333038330078, 0.6976824998855591], "mean_td_error": 1.8051859140396118, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.138357162475586, "actor_loss": -6.6847124099731445, "critic_loss": 0.20870354771614075, "alpha_loss": -0.24051274359226227, "alpha_value": 0.976556122303009, "log_alpha_value": -0.023723052814602852, "target_entropy": -6.0, "policy_t": 0.000788485340308398, "mean_q": 2.7259063720703125, "max_q": 3.741689443588257, "min_q": 2.021294116973877}, "td_error": [0.8157449960708618, 1.679412841796875, 2.1316747665405273, 1.4942808151245117, 0.13690102100372314, 1.6202380657196045, 2.2338852882385254, 0.17433464527130127, 2.4858200550079346, 0.7492364645004272, 0.627515435218811, 1.967531442642212, 2.9298577308654785, 0.531219482421875, 0.7151521444320679, 3.653852939605713, 0.483325719833374, 0.16321909427642822, 1.125814437866211, 0.029126286506652832, 1.1327623128890991, 1.4972869157791138, 0.31381022930145264, 2.2280969619750977, 1.1258413791656494, 2.397582530975342, 0.7193350791931152, 0.4242621660232544, 0.938825249671936, 1.2514175176620483, 0.40345561504364014, 1.6336764097213745, 1.4543344974517822, 2.8550877571105957, 1.161577820777893, 0.7271590232849121, 0.807876706123352, 0.8547613620758057, 0.4122006893157959, 2.457282066345215, 0.5486663579940796, 0.2631235122680664, 0.8593401908874512, 3.109757900238037, 0.15829360485076904, 0.5881755352020264, 1.8219311237335205, 1.6687792539596558, 2.084840774536133, 2.3159091472625732, 1.3859723806381226, 0.10605955123901367, 0.3745332956314087, 3.414611577987671, 0.3570556640625, 0.4957524538040161, 4.792946815490723, 2.640040397644043, 2.22163724899292, 0.10278773307800293, 0.663784384727478, 3.862478733062744, 0.7117476463317871, 0.1944793462753296, 3.7526843547821045, 0.5887013673782349, 2.442413330078125, 2.07769775390625, 1.1916764974594116, 1.9138600826263428, 1.3480888605117798, 0.4735454320907593, 0.1947416067123413, 1.5138696432113647, 0.3037518262863159, 1.7205184698104858, 0.6076703071594238, 0.12547576427459717, 4.4364237785339355, 0.3250741958618164, 0.5532981157302856, 0.5557559728622437, 1.9769359827041626, 0.8922826051712036, 0.29597318172454834, 0.1003425121307373], "mean_td_error": 1.3102123737335205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077402114868164, "actor_loss": -6.687932968139648, "critic_loss": 0.22711758315563202, "alpha_loss": -0.2388908863067627, "alpha_value": 0.9765731692314148, "log_alpha_value": -0.023705601692199707, "target_entropy": -6.0, "policy_t": 0.008799877017736435, "mean_q": 2.723590850830078, "max_q": 3.59403395652771, "min_q": 2.088494062423706}, "td_error": [1.0301313400268555, 2.7858991622924805, 2.9741344451904297, 0.075156569480896, 1.9749677181243896, 0.29569709300994873, 1.2964653968811035, 0.08020460605621338, 2.7181010246276855, 0.04180705547332764, 0.23374009132385254, 0.5590189695358276, 0.19398343563079834, 0.5057685375213623, 0.5880023241043091, 2.5724399089813232, 0.6849290132522583, 1.782499074935913, 0.19388210773468018, 2.12888240814209, 2.7581193447113037, 1.2231956720352173, 0.9264382123947144, 0.9727330207824707, 1.0081387758255005, 0.3132026195526123, 0.7504853010177612, 0.42011451721191406, 0.7298833131790161, 0.2683037519454956, 0.4442509412765503, 2.5191211700439453, 0.7723095417022705, 1.9388295412063599, 0.6934000253677368, 0.35594213008880615, 1.5441216230392456, 0.7882493734359741, 0.11617124080657959, 3.195021629333496, 0.46068310737609863, 1.8262906074523926, 2.680528163909912, 3.3887155055999756, 0.38924992084503174, 1.1652028560638428, 0.24408197402954102, 0.3566070795059204, 0.08762657642364502, 0.03571212291717529, 0.1937413215637207, 0.5993061065673828, 1.7868220806121826, 1.4747003316879272, 0.582935094833374, 0.0596996545791626, 2.781521797180176, 0.7519370317459106, 2.548814535140991, 0.7594906091690063, 1.8500447273254395, 0.5654345750808716, 1.3565787076950073, 7.398654937744141, 1.973181128501892, 0.9492303133010864, 0.0510483980178833, 1.0364199876785278, 0.4854522943496704, 1.0842047929763794, 3.2500479221343994, 0.18176484107971191, 0.041198015213012695, 2.8006231784820557, 0.328421950340271, 0.9509297609329224, 0.36467456817626953, 0.7045773267745972, 1.9206502437591553, 1.0001285076141357, 4.240850448608398, 0.09699368476867676, 0.03092777729034424, 0.8796417713165283, 2.1458640098571777, 0.8528256416320801], "mean_td_error": 1.1996252536773682, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}}, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.2875376400497, "num_env_steps_trained_throughput_per_sec": 138.87297400796075, "timesteps_total": 72576, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 217728, "timers": {"training_iteration_time_ms": 1924.801, "sample_time_ms": 1355.097, "load_time_ms": 0.532, "load_throughput": 484977.561, "learn_time_ms": 62.058, "learn_throughput": 4157.432, "synch_weights_time_ms": 15.569}, "counters": {"num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "done": false, "episodes_total": 0, "training_iteration": 81, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-07", "timestamp": 1700203147, "time_this_iter_s": 1.872575283050537, "time_total_s": 165.88083934783936, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e07544c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 165.88083934783936, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 65.16666666666667, "ram_util_percent": 92.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090033531188965, "actor_loss": -6.980056285858154, "critic_loss": 0.3320958912372589, "alpha_loss": -0.24203962087631226, "alpha_value": 0.9762974381446838, "log_alpha_value": -0.023987989872694016, "target_entropy": -6.0, "policy_t": -0.006792913656681776, "mean_q": 3.07126784324646, "max_q": 3.8372063636779785, "min_q": 2.492544412612915}, "td_error": [2.0379481315612793, 2.49562406539917, 1.9123401641845703, 0.06836831569671631, 2.780867099761963, 0.261411190032959, 0.7095699310302734, 5.159763336181641, 1.8083124160766602, 4.424642562866211, 0.796457052230835, 1.8687751293182373, 1.1816452741622925, 0.17311859130859375, 1.286942720413208, 1.5231622457504272, 0.6651709079742432, 0.7143691778182983, 0.35796427726745605, 2.1946218013763428, 1.107877492904663, 2.5605263710021973, 3.316514015197754, 1.6495163440704346, 1.579686164855957, 0.5520827770233154, 0.3685349225997925, 1.7263214588165283, 0.09959721565246582, 0.043300509452819824, 3.076002836227417, 0.13469922542572021, 1.6628082990646362, 0.9201936721801758, 5.255923271179199, 2.071953058242798, 1.8057866096496582, 1.9287924766540527, 1.434655785560608, 0.6063127517700195, 0.3803095817565918, 3.797308921813965, 0.3914768695831299, 1.297759771347046, 1.5007003545761108, 3.740307092666626, 1.007092833518982, 0.4690897464752197, 1.783096432685852, 0.31358838081359863, 2.514801263809204, 0.9363266229629517, 1.933763027191162, 0.7059366703033447, 1.6003010272979736, 0.7606066465377808, 2.538724899291992, 0.22021245956420898, 2.0822057723999023, 3.0866010189056396, 2.1959142684936523, 2.8415756225585938, 1.1858360767364502, 0.5409848690032959, 0.6379984617233276, 0.6396516561508179, 0.11419129371643066, 0.3293330669403076, 2.3902904987335205, 1.3030530214309692, 0.16004502773284912, 0.3264634609222412, 0.45296311378479004, 0.9931250810623169, 3.603148937225342, 3.179325580596924, 1.970940113067627, 3.0334062576293945, 2.419449806213379, 2.9486889839172363, 0.830075740814209, 0.4711877107620239, 0.35522186756134033, 2.292515516281128, 1.5754849910736084, 1.737346887588501], "mean_td_error": 1.5570999383926392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047843933105469, "actor_loss": -6.741039752960205, "critic_loss": 0.22545590996742249, "alpha_loss": -0.24138128757476807, "alpha_value": 0.9762630462646484, "log_alpha_value": -0.024023190140724182, "target_entropy": -6.0, "policy_t": -0.016173310577869415, "mean_q": 2.875654697418213, "max_q": 3.8168511390686035, "min_q": 1.9400250911712646}, "td_error": [0.827459454536438, 1.9099726676940918, 1.7257325649261475, 0.24526941776275635, 0.7941106557846069, 1.946593165397644, 2.6244423389434814, 2.9358787536621094, 3.7297749519348145, 0.3364666700363159, 0.6293169260025024, 0.03426945209503174, 0.2741814851760864, 0.9418278932571411, 2.124079704284668, 1.152929663658142, 3.2809691429138184, 0.41374707221984863, 0.5570824146270752, 2.3547298908233643, 1.158453345298767, 1.068355679512024, 1.3967278003692627, 0.2819235324859619, 0.8699023723602295, 3.8066389560699463, 2.381397247314453, 3.2225208282470703, 0.4534999132156372, 2.432701587677002, 0.7281907796859741, 1.4005142450332642, 1.2432633638381958, 0.5622345209121704, 0.49013805389404297, 0.515270471572876, 1.4713127613067627, 0.05292618274688721, 1.540598750114441, 0.9280663728713989, 1.7541781663894653, 0.3625842332839966, 3.387417793273926, 2.699972152709961, 3.389734983444214, 0.3039463758468628, 3.025423526763916, 1.0337121486663818, 0.7029014825820923, 0.4073352813720703, 1.2295383214950562, 0.3795527219772339, 0.5349562168121338, 0.17675399780273438, 1.1291542053222656, 0.523642897605896, 0.9567282199859619, 0.12038660049438477, 0.9857771396636963, 3.576984405517578, 0.4372279644012451, 1.4021270275115967, 3.219054698944092, 0.32057011127471924, 0.10379552841186523, 4.961034774780273, 0.9116246700286865, 0.799456000328064, 0.3751344680786133, 2.032149314880371, 4.07652473449707, 1.4777365922927856, 0.7647662162780762, 2.461698532104492, 0.9604510068893433, 0.5331114530563354, 2.6538619995117188, 0.40894806385040283, 0.1839810609817505, 1.079724669456482, 0.6126807928085327, 1.731938362121582, 2.1091647148132324, 3.097682237625122, 1.512940764427185, 2.000491142272949], "mean_td_error": 1.4157211780548096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035195350646973, "actor_loss": -6.668105602264404, "critic_loss": 0.2410123199224472, "alpha_loss": -0.24090290069580078, "alpha_value": 0.9762800335884094, "log_alpha_value": -0.024005798622965813, "target_entropy": -6.0, "policy_t": 0.0278124138712883, "mean_q": 2.7301387786865234, "max_q": 3.7110605239868164, "min_q": 2.089956283569336}, "td_error": [0.826301097869873, 1.4533640146255493, 0.2050410509109497, 0.4873342514038086, 2.148876190185547, 0.07925748825073242, 3.8873705863952637, 0.061765074729919434, 0.7482821941375732, 1.497178077697754, 0.4244493246078491, 0.7223470211029053, 2.0686802864074707, 0.40481269359588623, 0.5846147537231445, 3.8567254543304443, 0.47446978092193604, 3.266617774963379, 2.7950167655944824, 0.8968702554702759, 1.025599479675293, 0.293387770652771, 3.366772174835205, 0.6508496999740601, 1.6844795942306519, 1.9969149827957153, 0.38616156578063965, 0.8626894950866699, 1.1262503862380981, 0.9981571435928345, 2.7172272205352783, 1.0369906425476074, 0.2944298982620239, 2.3900556564331055, 1.8268992900848389, 1.1987708806991577, 1.0428324937820435, 0.06084132194519043, 0.6565549373626709, 1.2531495094299316, 0.6748889684677124, 0.3099067211151123, 0.26958954334259033, 5.072816848754883, 0.6348214149475098, 0.27500593662261963, 0.6329840421676636, 1.44072425365448, 0.5588235855102539, 1.047919750213623, 0.043759703636169434, 1.5317742824554443, 0.5988689661026001, 2.4910950660705566, 0.8938953876495361, 0.4963947534561157, 1.3405483961105347, 1.2757726907730103, 5.421526908874512, 0.09575176239013672, 1.1317086219787598, 1.0525401830673218, 1.263975977897644, 4.292444229125977, 0.8525586128234863, 0.16198551654815674, 1.4974156618118286, 1.9809181690216064, 0.803342342376709, 0.060474514961242676, 0.7638274431228638, 0.6049913167953491, 0.6118284463882446, 1.9260543584823608, 1.902024507522583, 0.8115247488021851, 0.11421430110931396, 1.7180019617080688, 2.3410167694091797, 1.0857868194580078, 0.5169385671615601, 0.43947041034698486, 2.326768398284912, 1.6562042236328125, 0.05877971649169922, 3.0870707035064697], "mean_td_error": 1.2782223224639893, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 468.55277186491315, "num_env_steps_trained_throughput_per_sec": 134.91809725574507, "timesteps_total": 73472, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 1921.019, "sample_time_ms": 1352.053, "load_time_ms": 0.534, "load_throughput": 483352.882, "learn_time_ms": 61.986, "learn_throughput": 4162.253, "synch_weights_time_ms": 15.386}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 82, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-09", "timestamp": 1700203149, "time_this_iter_s": 1.9313101768493652, "time_total_s": 167.81214952468872, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0763430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 167.81214952468872, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 91.7, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116934776306152, "actor_loss": -6.991720676422119, "critic_loss": 0.4053736925125122, "alpha_loss": -0.2457156479358673, "alpha_value": 0.9760050177574158, "log_alpha_value": -0.02428755722939968, "target_entropy": -6.0, "policy_t": -0.010874706320464611, "mean_q": 3.0730068683624268, "max_q": 3.6533803939819336, "min_q": 2.4458703994750977}, "td_error": [0.6467782258987427, 2.008174419403076, 0.5849964618682861, 2.722186803817749, 0.5615851879119873, 2.5993075370788574, 3.5393810272216797, 2.82597017288208, 0.2991518974304199, 0.5087783336639404, 1.3429007530212402, 0.515618085861206, 2.6510376930236816, 4.066653251647949, 0.3483695983886719, 0.9826647043228149, 0.6299538612365723, 3.1531782150268555, 3.0807747840881348, 1.9774072170257568, 1.6715481281280518, 2.4858829975128174, 0.6614810228347778, 1.5307295322418213, 2.418684720993042, 0.2465207576751709, 3.0726561546325684, 1.0259950160980225, 1.1696075201034546, 2.6918349266052246, 0.0949317216873169, 4.337701797485352, 2.298144817352295, 0.40136635303497314, 2.878108024597168, 0.4178774356842041, 1.7638969421386719, 3.0749588012695312, 0.18569612503051758, 0.38786768913269043, 2.888908863067627, 0.4654700756072998, 4.272249221801758, 3.506686210632324, 2.1362385749816895, 0.12512242794036865, 2.5697150230407715, 0.3576090335845947, 2.379291296005249, 1.3283441066741943, 0.585006833076477, 0.9106369018554688, 1.5484914779663086, 1.2826693058013916, 4.388015270233154, 0.8957635164260864, 0.8524007797241211, 0.35883307456970215, 2.4184746742248535, 1.192887783050537, 1.2571265697479248, 1.8816159963607788, 5.816629886627197, 2.052002429962158, 2.1753482818603516, 2.3352560997009277, 3.250042200088501, 0.8915902376174927, 2.749330520629883, 2.12022066116333, 2.3376762866973877, 0.8613210916519165, 2.023771286010742, 1.444149374961853, 4.490251541137695, 2.109774589538574, 0.2910095453262329, 0.5940443277359009, 1.475504755973816, 1.767687201499939, 3.262831211090088, 3.6325016021728516, 0.5166193246841431, 1.3046386241912842, 3.0320630073547363, 0.16281437873840332], "mean_td_error": 1.8158023357391357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071871757507324, "actor_loss": -6.702755928039551, "critic_loss": 0.2420288622379303, "alpha_loss": -0.24498021602630615, "alpha_value": 0.9759702086448669, "log_alpha_value": -0.024323206394910812, "target_entropy": -6.0, "policy_t": -0.006641435902565718, "mean_q": 2.8030245304107666, "max_q": 3.667588233947754, "min_q": 1.9284818172454834}, "td_error": [1.0292378664016724, 2.2882513999938965, 1.0031304359436035, 0.9313317537307739, 1.0726149082183838, 0.8271348476409912, 2.6040091514587402, 3.9543046951293945, 1.383055567741394, 1.4010932445526123, 2.316967487335205, 0.7140325307846069, 0.7309430837631226, 5.203029155731201, 1.4488364458084106, 1.9114128351211548, 0.02381277084350586, 0.8333358764648438, 0.9292131662368774, 0.9897699356079102, 1.702948808670044, 2.3216209411621094, 5.316417694091797, 0.8980159759521484, 2.0554213523864746, 0.1440880298614502, 0.09606468677520752, 0.22647345066070557, 2.108884572982788, 2.108083963394165, 1.348772406578064, 0.2568354606628418, 2.004645347595215, 3.190103769302368, 0.0750124454498291, 0.9814788103103638, 1.7863569259643555, 1.997589349746704, 0.36519432067871094, 0.29794275760650635, 1.5760095119476318, 0.06261909008026123, 0.8417072296142578, 0.17732226848602295, 3.430359363555908, 1.0031771659851074, 3.944613456726074, 1.6018983125686646, 0.3423769474029541, 0.4691801071166992, 2.471984386444092, 0.4120568037033081, 0.5489698648452759, 0.7006305456161499, 0.18635165691375732, 5.1075439453125, 1.2020670175552368, 5.0022807121276855, 1.1875920295715332, 0.5819070339202881, 0.3807511329650879, 0.051636576652526855, 1.4658855199813843, 3.166703939437866, 1.1247766017913818, 3.871941566467285, 1.2434645891189575, 1.8401340246200562, 2.204594612121582, 2.7152323722839355, 0.24714505672454834, 0.18524837493896484, 0.43921172618865967, 2.9245524406433105, 0.7002592086791992, 0.1535104513168335, 0.405248761177063, 0.8987656831741333, 3.0094809532165527, 1.0228124856948853, 1.1554805040359497, 0.36638426780700684, 2.537306308746338, 0.7856612205505371, 0.2700357437133789, 1.4985663890838623], "mean_td_error": 1.4696849584579468, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07706356048584, "actor_loss": -6.766355991363525, "critic_loss": 0.3083813190460205, "alpha_loss": -0.24493145942687988, "alpha_value": 0.9759871959686279, "log_alpha_value": -0.024305837228894234, "target_entropy": -6.0, "policy_t": 0.009572329930961132, "mean_q": 2.8287289142608643, "max_q": 3.7263495922088623, "min_q": 2.1701161861419678}, "td_error": [4.577076435089111, 0.3901623487472534, 0.1889115571975708, 0.8366892337799072, 3.1522769927978516, 1.3294118642807007, 0.48455703258514404, 1.0652798414230347, 1.767321228981018, 1.47427237033844, 2.5411977767944336, 0.991568922996521, 0.8365535736083984, 0.8426432609558105, 2.681173324584961, 0.4793504476547241, 5.200142860412598, 0.7837085723876953, 0.29924702644348145, 1.257368803024292, 2.063884735107422, 0.8171581029891968, 4.787748336791992, 0.5756227970123291, 0.09239709377288818, 1.1951777935028076, 0.5538947582244873, 1.0898956060409546, 1.453662633895874, 0.7764732837677002, 2.414006233215332, 0.8690038919448853, 2.330082893371582, 2.561023235321045, 2.031355857849121, 2.5291357040405273, 2.7646665573120117, 5.077940464019775, 2.3489506244659424, 0.8119202852249146, 1.4623314142227173, 5.160699844360352, 2.631441116333008, 1.8043335676193237, 1.1744714975357056, 2.9297046661376953, 0.8505613803863525, 0.09446406364440918, 1.1373012065887451, 0.2098606824874878, 0.8058407306671143, 1.4612432718276978, 0.692224383354187, 0.6847842931747437, 0.43120646476745605, 0.7025676965713501, 3.7215938568115234, 0.6277040243148804, 1.3653291463851929, 0.6180719137191772, 0.08869349956512451, 0.21156489849090576, 1.0631942749023438, 0.6522067785263062, 0.4731614589691162, 0.9978460073471069, 1.3897331953048706, 3.306929588317871, 5.338990211486816, 0.3378305435180664, 0.8364286422729492, 1.0710482597351074, 0.8765746355056763, 1.6027106046676636, 1.7970149517059326, 3.1750168800354004, 1.5909453630447388, 2.5184829235076904, 0.6283614635467529, 0.10209119319915771, 0.31017887592315674, 3.174471616744995, 0.790123462677002, 0.09289753437042236, 1.0052297115325928, 1.5811620950698853], "mean_td_error": 1.5337387323379517, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 485.45479915565585, "num_env_steps_trained_throughput_per_sec": 139.78497564973125, "timesteps_total": 74368, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 223104, "timers": {"training_iteration_time_ms": 1896.989, "sample_time_ms": 1329.277, "load_time_ms": 0.53, "load_throughput": 487007.395, "learn_time_ms": 61.901, "learn_throughput": 4167.955, "synch_weights_time_ms": 15.36}, "counters": {"num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "done": false, "episodes_total": 0, "training_iteration": 83, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-11", "timestamp": 1700203151, "time_this_iter_s": 1.8604001998901367, "time_total_s": 169.67254972457886, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e08478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 169.67254972457886, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 92.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109827041625977, "actor_loss": -7.011335372924805, "critic_loss": 0.365661084651947, "alpha_loss": -0.24857307970523834, "alpha_value": 0.9757125377655029, "log_alpha_value": -0.024587275460362434, "target_entropy": -6.0, "policy_t": 0.07135692983865738, "mean_q": 3.0300185680389404, "max_q": 3.7096774578094482, "min_q": 2.408945083618164}, "td_error": [1.5637437105178833, 0.6336665153503418, 5.748788833618164, 1.8896716833114624, 3.018866777420044, 2.5829544067382812, 0.12526381015777588, 1.556867241859436, 1.4609403610229492, 1.8195441961288452, 1.0737113952636719, 0.3437732458114624, 1.3265575170516968, 0.1039360761642456, 0.1454176902770996, 1.1027774810791016, 1.4073944091796875, 2.1778297424316406, 0.7364050149917603, 0.8705068826675415, 2.3135604858398438, 2.002196788787842, 2.268050193786621, 1.9554338455200195, 4.667917728424072, 1.348238229751587, 1.1855623722076416, 1.7183756828308105, 2.964860677719116, 1.0773510932922363, 3.338005304336548, 0.4223712682723999, 1.5053826570510864, 3.8097121715545654, 0.8385943174362183, 3.7765347957611084, 0.329409122467041, 0.9261281490325928, 0.7362257242202759, 0.06920242309570312, 2.6418681144714355, 0.08111965656280518, 1.0959126949310303, 0.5957465171813965, 0.41912972927093506, 0.9712584018707275, 2.1659445762634277, 1.8951939344406128, 0.7457536458969116, 0.3540217876434326, 4.0297441482543945, 3.1354408264160156, 2.4408583641052246, 1.7674992084503174, 1.5589646100997925, 0.9879132509231567, 0.38405680656433105, 2.289865732192993, 0.39808404445648193, 0.06896257400512695, 0.7787888050079346, 1.2672483921051025, 0.16900396347045898, 0.6027801036834717, 2.1165571212768555, 0.5062606334686279, 3.5368800163269043, 4.402643203735352, 2.9076576232910156, 1.9350590705871582, 1.7105286121368408, 5.408450126647949, 1.4544376134872437, 1.2651010751724243, 0.9353257417678833, 2.7430028915405273, 1.6900516748428345, 2.2365217208862305, 0.1076509952545166, 2.578946828842163, 0.9385546445846558, 1.177181601524353, 0.628792405128479, 1.8701932430267334, 2.231862783432007, 2.2740964889526367], "mean_td_error": 1.656309962272644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05497932434082, "actor_loss": -6.655654430389404, "critic_loss": 0.2131207287311554, "alpha_loss": -0.24758552014827728, "alpha_value": 0.975677490234375, "log_alpha_value": -0.02462317794561386, "target_entropy": -6.0, "policy_t": 0.03250739723443985, "mean_q": 2.7742040157318115, "max_q": 3.6995890140533447, "min_q": 2.042876958847046}, "td_error": [0.7215098142623901, 0.2747305631637573, 0.99411940574646, 2.0337791442871094, 1.2401931285858154, 0.2062242031097412, 1.310259222984314, 0.07695794105529785, 0.09542524814605713, 0.8384876251220703, 0.10393285751342773, 0.5440990924835205, 0.32087671756744385, 1.5195900201797485, 0.4860415458679199, 0.5278464555740356, 2.026642084121704, 2.1803481578826904, 0.9933789968490601, 2.2783915996551514, 2.5007071495056152, 4.597955703735352, 0.2867385149002075, 1.3813989162445068, 0.6014198064804077, 1.425723910331726, 1.3553111553192139, 0.3823055028915405, 1.9434988498687744, 1.0275598764419556, 0.19323134422302246, 3.085789918899536, 0.39389193058013916, 0.4145240783691406, 1.1172020435333252, 2.1638436317443848, 2.2422797679901123, 0.7383283376693726, 1.4040195941925049, 0.8722953796386719, 1.4965814352035522, 3.462164878845215, 0.7250525951385498, 1.4458473920822144, 0.5852242708206177, 0.0986928939819336, 2.312326431274414, 0.9978359937667847, 1.5547759532928467, 1.4589605331420898, 1.5420302152633667, 1.1824265718460083, 2.9106950759887695, 4.826900959014893, 0.8976516723632812, 0.7618780136108398, 1.6572096347808838, 2.0211830139160156, 1.6322580575942993, 2.0187220573425293, 2.740931272506714, 0.3548051118850708, 4.912032127380371, 1.0306264162063599, 1.0533573627471924, 2.405029535293579, 0.6304937601089478, 1.319658637046814, 2.3605661392211914, 2.2742581367492676, 0.14698219299316406, 3.1066126823425293, 0.17212963104248047, 1.1964468955993652, 0.4408860206604004, 1.934670090675354, 0.9660835266113281, 1.7288117408752441, 1.1811553239822388, 0.8903096914291382, 1.2774200439453125, 1.3415741920471191, 1.1166075468063354, 0.7766635417938232, 0.3357400894165039, 0.8716809749603271], "mean_td_error": 1.3611024618148804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128484725952148, "actor_loss": -6.852688312530518, "critic_loss": 0.22721701860427856, "alpha_loss": -0.24921993911266327, "alpha_value": 0.9756944179534912, "log_alpha_value": -0.02460584230720997, "target_entropy": -6.0, "policy_t": 0.05075043812394142, "mean_q": 2.859680414199829, "max_q": 3.776603937149048, "min_q": 2.162309408187866}, "td_error": [0.0663994550704956, 1.1057140827178955, 0.1271669864654541, 0.13362443447113037, 0.40120553970336914, 0.3720402717590332, 1.8559364080429077, 3.9292478561401367, 0.3981362581253052, 1.1736494302749634, 0.2770189046859741, 3.8739569187164307, 0.06544053554534912, 0.4344484806060791, 1.6257965564727783, 0.10637235641479492, 1.3773224353790283, 0.5523627996444702, 2.025236129760742, 1.4726431369781494, 0.5735170841217041, 0.7763055562973022, 1.348220944404602, 0.4174227714538574, 0.013583183288574219, 1.1283016204833984, 0.7479089498519897, 0.4099665880203247, 2.825073719024658, 1.1215121746063232, 2.413457155227661, 0.49136102199554443, 0.7938721179962158, 1.6614408493041992, 0.09436213970184326, 0.8495585918426514, 3.9765195846557617, 1.0655956268310547, 1.3633073568344116, 1.8576749563217163, 0.7872192859649658, 1.4664000272750854, 0.8250824213027954, 0.05626940727233887, 0.6664813756942749, 3.5441055297851562, 1.0015255212783813, 0.9747633934020996, 0.23576414585113525, 2.4248199462890625, 0.7079455852508545, 0.7973895072937012, 2.6379852294921875, 1.6376845836639404, 2.1260805130004883, 1.8240493535995483, 2.6447901725769043, 0.9500991106033325, 1.3199595212936401, 0.7774603366851807, 0.48570024967193604, 1.7907179594039917, 1.8911758661270142, 3.57039475440979, 3.0135674476623535, 0.7674049139022827, 0.11263322830200195, 0.754033088684082, 1.784462809562683, 0.5033355951309204, 1.1767549514770508, 0.2989015579223633, 2.3398571014404297, 1.0768718719482422, 0.5952326059341431, 3.427617073059082, 1.1549164056777954, 0.5406229496002197, 0.10063302516937256, 0.2647210359573364, 0.739025354385376, 1.2177296876907349, 2.122204542160034, 1.8562613725662231, 0.05047345161437988, 0.0896918773651123], "mean_td_error": 1.2143429517745972, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 482.0866535590693, "num_env_steps_trained_throughput_per_sec": 138.81513015428558, "timesteps_total": 75264, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 1886.297, "sample_time_ms": 1317.627, "load_time_ms": 0.529, "load_throughput": 487907.675, "learn_time_ms": 61.839, "learn_throughput": 4172.14, "synch_weights_time_ms": 15.322}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 84, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-13", "timestamp": 1700203153, "time_this_iter_s": 1.8750152587890625, "time_total_s": 171.54756498336792, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e0750ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 171.54756498336792, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 92.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132614135742188, "actor_loss": -6.921374797821045, "critic_loss": 0.31938520073890686, "alpha_loss": -0.25217148661613464, "alpha_value": 0.9754199981689453, "log_alpha_value": -0.02488710917532444, "target_entropy": -6.0, "policy_t": -0.00492886221036315, "mean_q": 3.0022008419036865, "max_q": 3.473576545715332, "min_q": 2.503795862197876}, "td_error": [0.20809626579284668, 0.9020103216171265, 3.7516980171203613, 3.099552631378174, 3.4987611770629883, 6.20081901550293, 0.6734747886657715, 2.169219732284546, 0.461112380027771, 1.5065929889678955, 0.31669676303863525, 1.7256046533584595, 2.5690793991088867, 0.9250539541244507, 2.665140151977539, 0.3278008699417114, 0.20244169235229492, 1.5110605955123901, 0.18390953540802002, 1.380226969718933, 0.5412963628768921, 0.4231332540512085, 2.153282642364502, 6.15985631942749, 0.45314860343933105, 0.8538500070571899, 0.6843210458755493, 0.37380266189575195, 0.09934937953948975, 0.5363146066665649, 2.3260703086853027, 3.8998169898986816, 6.89582633972168, 0.19062113761901855, 1.4724842309951782, 1.2960549592971802, 0.16372942924499512, 0.5791448354721069, 0.5427968502044678, 0.6484733819961548, 0.3178747892379761, 1.7681244611740112, 3.371903657913208, 1.2172150611877441, 0.8328380584716797, 2.9048800468444824, 0.5063484907150269, 0.6801191568374634, 0.42761528491973877, 2.217318058013916, 0.9365787506103516, 0.43092215061187744, 2.073737144470215, 3.6635499000549316, 0.6589761972427368, 1.5900081396102905, 3.337768077850342, 1.9583709239959717, 0.5837087631225586, 1.4849830865859985, 1.0429290533065796, 0.13907337188720703, 2.660849094390869, 0.1855717897415161, 0.819908857345581, 2.264998197555542, 3.9315452575683594, 1.606913685798645, 0.10207772254943848, 1.5320942401885986, 1.011883020401001, 1.0446621179580688, 0.4561285972595215, 0.27549993991851807, 5.161106109619141, 1.7777951955795288, 1.6554714441299438, 2.0991945266723633, 1.3780286312103271, 0.1922820806503296, 1.3105967044830322, 2.228813648223877, 0.096579909324646, 0.16418743133544922, 0.5179976224899292, 0.23203706741333008], "mean_td_error": 1.5049161911010742, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079309463500977, "actor_loss": -6.693758010864258, "critic_loss": 0.2410127818584442, "alpha_loss": -0.2512073218822479, "alpha_value": 0.9753849506378174, "log_alpha_value": -0.024923065677285194, "target_entropy": -6.0, "policy_t": -0.021401366218924522, "mean_q": 2.7643144130706787, "max_q": 3.7973015308380127, "min_q": 2.000408411026001}, "td_error": [1.6572397947311401, 0.8746393918991089, 1.9627405405044556, 0.39248204231262207, 0.47541940212249756, 0.6387029886245728, 0.954182505607605, 0.14607012271881104, 2.917689800262451, 2.8750381469726562, 0.12615430355072021, 2.6407132148742676, 1.8184183835983276, 1.0960564613342285, 0.05053532123565674, 1.1464593410491943, 1.7253938913345337, 1.5132616758346558, 0.47474586963653564, 2.1651647090911865, 2.3074662685394287, 4.956090927124023, 0.07854926586151123, 1.6924299001693726, 1.1583698987960815, 4.024035930633545, 2.3662681579589844, 0.3509950637817383, 1.5014716386795044, 1.974062204360962, 1.5877540111541748, 0.44225943088531494, 1.0965006351470947, 0.7225528955459595, 1.6125140190124512, 3.766540765762329, 0.5196889638900757, 3.7136783599853516, 1.3077678680419922, 1.673128604888916, 1.8321666717529297, 0.4490436315536499, 0.382696270942688, 0.14812910556793213, 0.605282187461853, 2.2405548095703125, 1.3629353046417236, 6.183889389038086, 0.3754124641418457, 2.352936267852783, 2.1713998317718506, 1.2358956336975098, 1.4777189493179321, 1.7889196872711182, 0.10392308235168457, 1.1720778942108154, 0.07516133785247803, 1.1228874921798706, 2.4898366928100586, 2.4498653411865234, 2.571244716644287, 0.9020076990127563, 1.6570720672607422, 0.5192810297012329, 0.1337834596633911, 2.518930196762085, 0.46337783336639404, 0.7231645584106445, 2.7728991508483887, 1.956396222114563, 1.1775050163269043, 2.1377410888671875, 0.06847178936004639, 2.7694127559661865, 0.5546460151672363, 1.4697283506393433, 2.2450883388519287, 1.1059147119522095, 1.3374390602111816, 0.2089097499847412, 1.596671462059021, 1.239581823348999, 0.5705499649047852, 0.5000650882720947, 3.2176551818847656, 0.5818346738815308], "mean_td_error": 1.4828294515609741, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058627128601074, "actor_loss": -6.709455490112305, "critic_loss": 0.2171982377767563, "alpha_loss": -0.25051969289779663, "alpha_value": 0.9754016399383545, "log_alpha_value": -0.02490595169365406, "target_entropy": -6.0, "policy_t": 0.006631405558437109, "mean_q": 2.8105201721191406, "max_q": 3.868654489517212, "min_q": 2.2326862812042236}, "td_error": [2.0493645668029785, 0.7421704530715942, 0.5291212797164917, 1.7796722650527954, 1.0433413982391357, 0.4579967260360718, 2.472569704055786, 1.5860673189163208, 2.4630491733551025, 1.003264307975769, 0.24480915069580078, 0.18782174587249756, 0.556248664855957, 0.6396980285644531, 1.2583345174789429, 0.6331459283828735, 2.8590989112854004, 1.0977084636688232, 0.8678474426269531, 2.0916295051574707, 0.33039402961730957, 0.5902936458587646, 2.101562976837158, 1.0660585165023804, 0.05806922912597656, 0.05761873722076416, 0.4797455072402954, 2.178884744644165, 0.690997838973999, 0.10757410526275635, 1.682821273803711, 0.6320750713348389, 2.548755168914795, 0.8023066520690918, 1.6921563148498535, 0.09150290489196777, 0.840779185295105, 2.2151975631713867, 0.36716461181640625, 1.148946762084961, 1.887978196144104, 0.6794719696044922, 0.5213160514831543, 1.5605318546295166, 1.0818442106246948, 2.444901466369629, 2.703001022338867, 0.516430139541626, 1.6343791484832764, 1.0355281829833984, 0.21734631061553955, 0.8545386791229248, 0.292904257774353, 0.3130279779434204, 3.5866963863372803, 1.431679606437683, 0.16949176788330078, 2.5860416889190674, 0.924494743347168, 0.9926087856292725, 2.828181743621826, 0.37773287296295166, 0.8152161836624146, 1.040046215057373, 0.7488209009170532, 0.8553541898727417, 0.280289888381958, 0.2024829387664795, 0.5895533561706543, 1.475917100906372, 1.5155810117721558, 1.0056700706481934, 0.11128294467926025, 8.23323917388916, 1.0298880338668823, 0.05133068561553955, 2.6479387283325195, 0.25999605655670166, 0.043799400329589844, 1.444370985031128, 1.0458341836929321, 1.7530615329742432, 1.5035247802734375, 0.07749927043914795, 1.6524536609649658, 0.7784119844436646], "mean_td_error": 1.186599612236023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}}, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 480.4323299398823, "num_env_steps_trained_throughput_per_sec": 138.33877357643934, "timesteps_total": 76160, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 228480, "timers": {"training_iteration_time_ms": 1882.123, "sample_time_ms": 1311.632, "load_time_ms": 0.527, "load_throughput": 489297.537, "learn_time_ms": 61.802, "learn_throughput": 4174.623, "synch_weights_time_ms": 15.434}, "counters": {"num_env_steps_sampled": 76160, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 21672, "last_target_update_ts": 76160, "num_target_updates": 84}, "done": false, "episodes_total": 0, "training_iteration": 85, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-15", "timestamp": 1700203155, "time_this_iter_s": 1.8781299591064453, "time_total_s": 173.42569494247437, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 173.42569494247437, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 88.0, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085359573364258, "actor_loss": -6.88392448425293, "critic_loss": 0.37278029322624207, "alpha_loss": -0.2540210485458374, "alpha_value": 0.9751274585723877, "log_alpha_value": -0.02518710494041443, "target_entropy": -6.0, "policy_t": -0.0029523437842726707, "mean_q": 2.9935083389282227, "max_q": 3.5546505451202393, "min_q": 2.5015146732330322}, "td_error": [1.8838386535644531, 1.4264538288116455, 0.09804487228393555, 2.817143678665161, 2.3850841522216797, 1.2844563722610474, 2.9294838905334473, 1.4515446424484253, 1.6841678619384766, 2.3360207080841064, 1.5978447198867798, 2.536914348602295, 0.05617332458496094, 1.4408323764801025, 4.066502571105957, 1.5110641717910767, 0.2595001459121704, 0.06015622615814209, 0.9625850915908813, 2.192361354827881, 1.4069170951843262, 0.06615734100341797, 0.7298891544342041, 0.2850348949432373, 3.2608261108398438, 0.7831312417984009, 1.4480366706848145, 0.8974127769470215, 0.9010518789291382, 2.974238395690918, 4.247965335845947, 2.726123332977295, 0.8838061094284058, 0.19087493419647217, 3.263059616088867, 2.3130943775177, 3.118377447128296, 0.4517785310745239, 0.9712702035903931, 2.3743937015533447, 0.5327271223068237, 0.2990533113479614, 1.931655764579773, 0.6552519798278809, 2.932830333709717, 4.443107604980469, 2.7601308822631836, 1.530922293663025, 0.24178564548492432, 0.9113892316818237, 0.13815462589263916, 1.4749971628189087, 0.6392492055892944, 0.4704850912094116, 1.5304665565490723, 3.2235379219055176, 2.344449996948242, 0.8036909103393555, 0.7908873558044434, 2.888498306274414, 2.193533420562744, 1.7814500331878662, 0.9177595376968384, 1.6783572435379028, 1.0785977840423584, 4.042749881744385, 1.4761890172958374, 0.022682666778564453, 3.848818778991699, 0.41557085514068604, 0.33970749378204346, 3.97011137008667, 1.841872215270996, 2.109847068786621, 2.120662212371826, 2.175786256790161, 0.07557487487792969, 0.878334641456604, 0.8788145780563354, 3.396625280380249, 2.3534274101257324, 1.1853331327438354, 1.5331321954727173, 3.391444206237793, 4.35609245300293, 0.9982752799987793], "mean_td_error": 1.696251630783081, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.141200065612793, "actor_loss": -6.715230464935303, "critic_loss": 0.2671815752983093, "alpha_loss": -0.25579091906547546, "alpha_value": 0.9750924706459045, "log_alpha_value": -0.025222942233085632, "target_entropy": -6.0, "policy_t": -0.022233963012695312, "mean_q": 2.7587273120880127, "max_q": 3.8040452003479004, "min_q": 2.024123430252075}, "td_error": [2.9277820587158203, 0.21316587924957275, 2.3296730518341064, 1.3037598133087158, 0.7260096073150635, 1.2620576620101929, 2.310971736907959, 2.0845589637756348, 1.7180079221725464, 0.6631205081939697, 3.0284924507141113, 1.7869951725006104, 0.09360098838806152, 2.0933260917663574, 0.27437102794647217, 0.7162638902664185, 2.2057456970214844, 0.499411940574646, 1.400669813156128, 0.8987118005752563, 1.0743908882141113, 0.2880638837814331, 2.300018548965454, 1.565824031829834, 3.82423734664917, 0.281280517578125, 1.2873128652572632, 0.5249183177947998, 1.5026147365570068, 0.11192584037780762, 1.299772024154663, 1.6603137254714966, 2.8584609031677246, 4.058220863342285, 1.035390019416809, 2.8623650074005127, 0.1772916316986084, 0.7335865497589111, 0.11643517017364502, 4.1583051681518555, 5.845081806182861, 1.2426904439926147, 0.10643303394317627, 1.6820789575576782, 0.6270943880081177, 1.116808533668518, 1.0921173095703125, 0.2614861726760864, 2.3654046058654785, 1.2055797576904297, 0.39221858978271484, 1.461051344871521, 0.8157250881195068, 0.5127317905426025, 0.7405602931976318, 1.779533863067627, 2.461188316345215, 0.15982413291931152, 1.8772765398025513, 2.149348258972168, 0.11406171321868896, 1.7476119995117188, 1.672571063041687, 1.595690131187439, 6.922144412994385, 5.244500637054443, 2.3867106437683105, 0.4764249324798584, 2.2730002403259277, 3.259552478790283, 2.8527793884277344, 2.6845638751983643, 0.5691615343093872, 0.36589741706848145, 1.27376127243042, 2.053696632385254, 0.4197542667388916, 4.15360164642334, 0.8993707895278931, 1.8406193256378174, 2.040530204772949, 0.5288705825805664, 1.4549716711044312, 0.18713784217834473, 1.5567647218704224, 0.06140005588531494], "mean_td_error": 1.5905442237854004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124019622802734, "actor_loss": -6.823317527770996, "critic_loss": 0.29560065269470215, "alpha_loss": -0.25518572330474854, "alpha_value": 0.9751090407371521, "log_alpha_value": -0.02520597167313099, "target_entropy": -6.0, "policy_t": -0.01828267239034176, "mean_q": 2.8393852710723877, "max_q": 3.7219603061676025, "min_q": 2.151604413986206}, "td_error": [1.738770604133606, 2.3501224517822266, 1.070908546447754, 1.0499547719955444, 0.9185640811920166, 0.8245335817337036, 0.7018234729766846, 1.5196939706802368, 1.9274965524673462, 1.9275542497634888, 1.084991455078125, 0.5464098453521729, 1.1437146663665771, 1.4163250923156738, 0.6896044015884399, 2.2149789333343506, 1.818200707435608, 0.8586623668670654, 4.30410099029541, 1.6809942722320557, 0.46578919887542725, 1.6275023221969604, 0.1527259349822998, 3.880563259124756, 2.5268754959106445, 1.3528978824615479, 1.6635193824768066, 0.632080078125, 3.02679443359375, 1.1416202783584595, 0.7245808839797974, 0.9595062732696533, 0.3343052864074707, 0.4311401844024658, 0.033656954765319824, 1.6996791362762451, 0.42663514614105225, 0.05538833141326904, 2.628051996231079, 1.1868408918380737, 1.3105552196502686, 0.1956883668899536, 0.11625838279724121, 4.89050817489624, 1.036476492881775, 0.11227357387542725, 1.8667025566101074, 1.1151739358901978, 0.9405896663665771, 2.5395054817199707, 2.0537490844726562, 0.45335352420806885, 0.0478893518447876, 1.4573500156402588, 0.5689655542373657, 1.508015513420105, 0.7431808710098267, 0.030887365341186523, 1.5197516679763794, 0.6808606386184692, 0.4555354118347168, 0.39328455924987793, 0.029433608055114746, 0.26993024349212646, 6.84443473815918, 1.8135061264038086, 0.9008513689041138, 0.3044806718826294, 1.8875200748443604, 0.6739906072616577, 1.5417349338531494, 5.741299629211426, 3.1775424480438232, 1.678389549255371, 1.332173228263855, 2.4365508556365967, 1.7297955751419067, 2.882322311401367, 2.260183095932007, 1.1335244178771973, 1.3499408960342407, 1.6041524410247803, 2.813232421875, 1.9598233699798584, 2.816833019256592, 1.8792160749435425], "mean_td_error": 1.4864531755447388, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 431.21355091121075, "num_env_steps_trained_throughput_per_sec": 124.16640193648702, "timesteps_total": 77056, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 231168, "timers": {"training_iteration_time_ms": 1906.533, "sample_time_ms": 1334.818, "load_time_ms": 0.528, "load_throughput": 488348.045, "learn_time_ms": 61.8, "learn_throughput": 4174.726, "synch_weights_time_ms": 15.386}, "counters": {"num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "done": false, "episodes_total": 0, "training_iteration": 86, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-17", "timestamp": 1700203157, "time_this_iter_s": 2.0940489768981934, "time_total_s": 175.51974391937256, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff4e08478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 175.51974391937256, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053529739379883, "actor_loss": -6.799992561340332, "critic_loss": 0.4062098264694214, "alpha_loss": -0.2562355101108551, "alpha_value": 0.9748349189758301, "log_alpha_value": -0.025487123057246208, "target_entropy": -6.0, "policy_t": -0.018157877027988434, "mean_q": 2.9377434253692627, "max_q": 3.3684096336364746, "min_q": 2.5154547691345215}, "td_error": [2.169490098953247, 2.77458119392395, 1.1912190914154053, 1.436265468597412, 4.161993980407715, 2.4122776985168457, 0.3124791383743286, 0.6890155076980591, 3.9183754920959473, 2.2027859687805176, 0.1982569694519043, 7.747861862182617, 0.8274681568145752, 0.4672985076904297, 0.08214223384857178, 3.1484732627868652, 3.305786609649658, 2.6851468086242676, 1.6591823101043701, 1.8531807661056519, 1.956977128982544, 0.6926939487457275, 0.9661056995391846, 0.4565286636352539, 1.788659930229187, 0.19872736930847168, 1.6709192991256714, 4.921478748321533, 0.37270498275756836, 0.5103291273117065, 3.8083620071411133, 0.09575057029724121, 2.7122058868408203, 0.8998507261276245, 1.9826998710632324, 2.139252185821533, 0.13792872428894043, 0.6232963800430298, 2.155673027038574, 2.336625099182129, 0.3289806842803955, 2.645203113555908, 1.5891393423080444, 2.789691925048828, 0.7740340232849121, 3.2192938327789307, 2.4553542137145996, 1.4200501441955566, 0.1011052131652832, 2.135310173034668, 0.10456323623657227, 0.9929752349853516, 2.628124952316284, 1.8761162757873535, 1.4404016733169556, 5.16687536239624, 0.5541800260543823, 2.0938501358032227, 3.0848758220672607, 0.7133469581604004, 2.544525623321533, 2.581949234008789, 1.638142466545105, 1.4046133756637573, 4.372063159942627, 1.6557023525238037, 2.377715587615967, 2.313601493835449, 2.4114978313446045, 0.5710177421569824, 0.7837036848068237, 1.213873267173767, 0.820997953414917, 1.8270739316940308, 0.14509177207946777, 1.5289809703826904, 0.5126973390579224, 0.0534512996673584, 2.7427639961242676, 0.898276686668396, 0.6961798667907715, 0.808353066444397, 0.6395446062088013, 4.290267467498779, 2.2417335510253906, 2.1451873779296875], "mean_td_error": 1.7790992259979248, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076051712036133, "actor_loss": -6.765929698944092, "critic_loss": 0.25774016976356506, "alpha_loss": -0.25717076659202576, "alpha_value": 0.9747999906539917, "log_alpha_value": -0.025522969663143158, "target_entropy": -6.0, "policy_t": -0.015247395262122154, "mean_q": 2.8740508556365967, "max_q": 3.944659948348999, "min_q": 2.024254083633423}, "td_error": [2.5269346237182617, 0.9178595542907715, 1.2157829999923706, 0.06619501113891602, 2.828313112258911, 3.4233007431030273, 0.5641398429870605, 2.347313404083252, 1.07985520362854, 0.680275559425354, 3.241074562072754, 2.8383030891418457, 0.6530178785324097, 4.6422882080078125, 3.7522172927856445, 0.9473830461502075, 0.9838216304779053, 1.1317813396453857, 2.7094550132751465, 0.30632758140563965, 0.7972716093063354, 0.02847278118133545, 0.08566749095916748, 5.954912185668945, 3.0971713066101074, 1.617666482925415, 1.3851491212844849, 0.3578537702560425, 1.3577696084976196, 1.4005793333053589, 1.2270463705062866, 0.5986067056655884, 1.9633355140686035, 2.4808945655822754, 2.43280029296875, 1.7710464000701904, 1.1428251266479492, 2.7850680351257324, 0.4859781265258789, 2.2656373977661133, 2.031853199005127, 1.4782894849777222, 0.7448195219039917, 0.13664352893829346, 2.5245590209960938, 1.4281116724014282, 0.21555650234222412, 3.2143988609313965, 1.076577067375183, 1.721342921257019, 1.256990671157837, 0.9268773794174194, 0.4202752113342285, 2.8511037826538086, 3.044227123260498, 0.4940917491912842, 1.720160722732544, 0.3135409355163574, 3.415067195892334, 8.197548866271973, 1.0574755668640137, 0.44113898277282715, 2.823129177093506, 0.6517572402954102, 0.7179578542709351, 1.5538856983184814, 0.8000965118408203, 0.5948551893234253, 1.270828366279602, 1.1234604120254517, 1.2355624437332153, 1.6346608400344849, 0.6735771894454956, 0.37024688720703125, 0.20699799060821533, 0.9172509908676147, 0.3676731586456299, 0.4299757480621338, 1.4340652227401733, 1.3020600080490112, 1.2748488187789917, 1.695858359336853, 1.3751978874206543, 0.39757633209228516, 0.35156679153442383, 3.351078987121582], "mean_td_error": 1.5739092826843262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102986335754395, "actor_loss": -6.887600421905518, "critic_loss": 0.3037659525871277, "alpha_loss": -0.25768762826919556, "alpha_value": 0.9748164415359497, "log_alpha_value": -0.02550608292222023, "target_entropy": -6.0, "policy_t": -0.00011648965300992131, "mean_q": 2.900442361831665, "max_q": 3.9002645015716553, "min_q": 2.103059768676758}, "td_error": [0.9281141757965088, 1.344639539718628, 1.082707166671753, 0.43984687328338623, 1.4703460931777954, 0.06652402877807617, 1.5205357074737549, 1.3288277387619019, 1.010446310043335, 1.6565076112747192, 2.6362218856811523, 0.24316167831420898, 0.0654376745223999, 1.7962768077850342, 0.9396475553512573, 3.7763097286224365, 0.18139350414276123, 0.7269779443740845, 0.330031156539917, 0.4512920379638672, 6.536384105682373, 0.07306861877441406, 4.701763153076172, 2.4263014793395996, 0.22507178783416748, 1.3796073198318481, 0.7387712001800537, 0.824027419090271, 0.9482506513595581, 1.2741740942001343, 0.7205357551574707, 0.3929555416107178, 0.2166309356689453, 0.7393006086349487, 0.36074209213256836, 0.15383625030517578, 2.0212159156799316, 1.6999210119247437, 1.7451897859573364, 1.1463642120361328, 0.2932792901992798, 0.20563066005706787, 3.7134623527526855, 6.657468318939209, 0.6312624216079712, 0.14260995388031006, 1.4294711351394653, 1.4774317741394043, 2.050835371017456, 1.3263771533966064, 0.7962683439254761, 0.4394087791442871, 2.134004592895508, 3.6123030185699463, 1.4575670957565308, 0.3715766668319702, 1.2984578609466553, 1.8235411643981934, 3.7449207305908203, 0.6501235961914062, 0.27185189723968506, 2.4306247234344482, 0.5097805261611938, 2.3606925010681152, 3.555124044418335, 0.022958993911743164, 3.4530725479125977, 0.055174827575683594, 1.6168112754821777, 1.6695481538772583, 4.6642632484436035, 0.8576138019561768, 0.11053252220153809, 0.41076719760894775, 0.30194950103759766, 4.910362243652344, 0.584074854850769, 2.7256760597229004, 1.908023715019226, 0.21628296375274658, 1.0378800630569458, 3.0338473320007324, 2.9453418254852295, 2.248263359069824, 0.5077763795852661, 1.135456919670105], "mean_td_error": 1.4897570610046387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 483.11628804459264, "num_env_steps_trained_throughput_per_sec": 139.111609727126, "timesteps_total": 77952, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 233856, "timers": {"training_iteration_time_ms": 1888.298, "sample_time_ms": 1315.418, "load_time_ms": 0.529, "load_throughput": 487358.328, "learn_time_ms": 61.871, "learn_throughput": 4169.937, "synch_weights_time_ms": 15.358}, "counters": {"num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "done": false, "episodes_total": 0, "training_iteration": 87, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-19", "timestamp": 1700203159, "time_this_iter_s": 1.868488073348999, "time_total_s": 177.38823199272156, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf09d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 177.38823199272156, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 66.06666666666666, "ram_util_percent": 92.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120354652404785, "actor_loss": -6.892898082733154, "critic_loss": 0.43591445684432983, "alpha_loss": -0.26097431778907776, "alpha_value": 0.9745425581932068, "log_alpha_value": -0.025787075981497765, "target_entropy": -6.0, "policy_t": -0.01093949843198061, "mean_q": 2.9369003772735596, "max_q": 3.453347682952881, "min_q": 2.418337345123291}, "td_error": [1.1521244049072266, 4.003665924072266, 2.6462583541870117, 1.7820674180984497, 1.769971489906311, 3.7914540767669678, 0.1701676845550537, 1.9099993705749512, 1.0245521068572998, 0.4676518440246582, 0.5481224060058594, 3.2389705181121826, 2.0661869049072266, 2.9597315788269043, 1.1631017923355103, 4.857926368713379, 0.5618563890457153, 2.4714932441711426, 2.0065810680389404, 4.409025192260742, 0.29150390625, 4.4125075340271, 2.3819260597229004, 3.0401248931884766, 1.6430413722991943, 1.8866171836853027, 3.1541295051574707, 4.405318737030029, 2.671578884124756, 1.7127137184143066, 0.053797006607055664, 2.71504545211792, 0.6192140579223633, 2.1388792991638184, 2.0067102909088135, 2.8013548851013184, 4.182964324951172, 1.7329459190368652, 1.6212377548217773, 0.5277044773101807, 1.7455812692642212, 1.5852301120758057, 1.2311394214630127, 3.001095771789551, 1.2014355659484863, 3.064457893371582, 1.326603651046753, 0.9195941686630249, 0.17253875732421875, 2.856228828430176, 3.5430047512054443, 0.2251647710800171, 2.3864142894744873, 0.24570870399475098, 1.919182300567627, 0.5161157846450806, 1.734704613685608, 3.295299530029297, 3.806457042694092, 4.023595333099365, 0.8600183725357056, 2.9948911666870117, 0.4307814836502075, 2.632847785949707, 0.9985582828521729, 1.5269763469696045, 1.1701688766479492, 1.7294411659240723, 0.3656071424484253, 0.5233253240585327, 0.4706984758377075, 1.8716168403625488, 0.7008445262908936, 2.9350273609161377, 3.2937328815460205, 4.192831039428711, 1.8049061298370361, 0.9948039054870605, 0.1391834020614624, 1.2164194583892822, 0.04754173755645752, 0.4190499782562256, 3.418858528137207, 0.648789644241333, 2.354431629180908, 0.46797025203704834], "mean_td_error": 1.9070826768875122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038482666015625, "actor_loss": -6.8229265213012695, "critic_loss": 0.24837806820869446, "alpha_loss": -0.2592233717441559, "alpha_value": 0.9745075702667236, "log_alpha_value": -0.025822961702942848, "target_entropy": -6.0, "policy_t": -0.02298642136156559, "mean_q": 2.9159281253814697, "max_q": 3.864832639694214, "min_q": 2.0862083435058594}, "td_error": [3.454986333847046, 0.7975250482559204, 2.4313676357269287, 0.6652175188064575, 0.7273896932601929, 2.0264735221862793, 0.24193346500396729, 2.855696201324463, 1.1270458698272705, 2.1959900856018066, 0.12273359298706055, 3.0126113891601562, 0.43372344970703125, 2.545083999633789, 1.3199069499969482, 1.1520253419876099, 2.1216979026794434, 1.19749915599823, 1.2447746992111206, 0.3701052665710449, 0.07425045967102051, 0.847692608833313, 4.591451168060303, 0.5572667121887207, 0.48515331745147705, 0.9244109392166138, 1.7554454803466797, 0.7801822423934937, 1.526357889175415, 1.0974124670028687, 0.43458032608032227, 0.15661025047302246, 1.6444666385650635, 0.31089508533477783, 1.1918843984603882, 1.4070523977279663, 0.6223348379135132, 3.6486949920654297, 2.9546289443969727, 3.1939468383789062, 0.1279691457748413, 0.7866872549057007, 0.890373945236206, 1.390307068824768, 2.0181567668914795, 1.1976975202560425, 1.8870022296905518, 0.8868515491485596, 0.6730358600616455, 0.2918379306793213, 1.4463392496109009, 0.7754080295562744, 5.905925273895264, 0.08561861515045166, 0.5858561992645264, 0.20412158966064453, 3.7081527709960938, 2.0820021629333496, 4.86643648147583, 3.2111144065856934, 1.547799825668335, 1.370328664779663, 1.2392438650131226, 0.225716233253479, 0.3875323534011841, 0.2194077968597412, 0.21275043487548828, 6.295987606048584, 1.149242877960205, 0.22364306449890137, 0.7129873037338257, 0.5952218770980835, 0.6781754493713379, 0.9587936401367188, 5.6489691734313965, 1.4282869100570679, 0.46933937072753906, 0.6290558576583862, 4.659659385681152, 0.592215895652771, 2.4787919521331787, 2.4070534706115723, 1.030429482460022, 1.9638200998306274, 0.20226609706878662, 1.0550155639648438], "mean_td_error": 1.5075712203979492, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110960006713867, "actor_loss": -6.872852325439453, "critic_loss": 0.30154311656951904, "alpha_loss": -0.26092565059661865, "alpha_value": 0.9745239019393921, "log_alpha_value": -0.02580621838569641, "target_entropy": -6.0, "policy_t": 0.04150630906224251, "mean_q": 2.9188342094421387, "max_q": 3.939361810684204, "min_q": 2.27355694770813}, "td_error": [1.5260542631149292, 0.9862756729125977, 0.1648731231689453, 2.174267053604126, 1.2812622785568237, 0.20701837539672852, 1.0302542448043823, 2.1204488277435303, 3.0712127685546875, 0.8216780424118042, 1.5811524391174316, 0.8139216899871826, 1.7752760648727417, 2.5107123851776123, 0.5546169281005859, 1.2951048612594604, 0.4650646448135376, 0.08921325206756592, 0.44093191623687744, 0.564732551574707, 4.137641906738281, 2.3761987686157227, 0.9760255813598633, 1.7119396924972534, 0.995783805847168, 1.6705774068832397, 2.906369209289551, 0.5879400968551636, 1.2184427976608276, 1.3802087306976318, 0.9254624843597412, 3.634711742401123, 0.2580519914627075, 0.7424437999725342, 0.8280307054519653, 0.09497964382171631, 0.7990339994430542, 1.2864891290664673, 1.0910282135009766, 3.2881155014038086, 1.145651936531067, 2.765014171600342, 0.8356242179870605, 0.05458343029022217, 0.15307462215423584, 6.340082168579102, 2.035217761993408, 1.5848740339279175, 0.9902530908584595, 0.08567750453948975, 1.008225440979004, 2.1356067657470703, 0.6082620620727539, 0.9817984104156494, 2.5273585319519043, 0.9945316314697266, 3.073276996612549, 1.544162631034851, 0.6220684051513672, 1.3799562454223633, 2.938234567642212, 1.4288297891616821, 1.5886597633361816, 0.17349004745483398, 8.310986518859863, 4.199057579040527, 0.8022286891937256, 1.1535247564315796, 0.5448542833328247, 0.46876490116119385, 0.8973349332809448, 1.7054013013839722, 0.24494707584381104, 0.7926647663116455, 3.637181043624878, 0.49546170234680176, 1.2089852094650269, 1.7949498891830444, 2.03354549407959, 0.7021849155426025, 1.4509034156799316, 0.4212442636489868, 2.985281467437744, 2.0469846725463867, 2.144289016723633, 0.5313397645950317], "mean_td_error": 1.5110485553741455, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 352.7690897345326, "num_env_steps_trained_throughput_per_sec": 101.57859949945247, "timesteps_total": 78848, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 1951.195, "sample_time_ms": 1380.538, "load_time_ms": 0.532, "load_throughput": 485347.341, "learn_time_ms": 61.847, "learn_throughput": 4171.569, "synch_weights_time_ms": 15.038}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 22446, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 22446, "last_target_update_ts": 78848, "num_target_updates": 87}, "done": false, "episodes_total": 0, "training_iteration": 88, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-22", "timestamp": 1700203162, "time_this_iter_s": 2.554903984069824, "time_total_s": 179.94313597679138, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff510bf0790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 179.94313597679138, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 68.03333333333333, "ram_util_percent": 92.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0660400390625, "actor_loss": -6.844235420227051, "critic_loss": 0.3734312057495117, "alpha_loss": -0.2625942528247833, "alpha_value": 0.9742501974105835, "log_alpha_value": -0.026087148115038872, "target_entropy": -6.0, "policy_t": 0.008664363995194435, "mean_q": 2.9600281715393066, "max_q": 3.532949209213257, "min_q": 2.47701358795166}, "td_error": [3.048159599304199, 2.7218027114868164, 2.0789031982421875, 1.5570021867752075, 1.4287161827087402, 0.5111844539642334, 0.026093721389770508, 1.6851232051849365, 1.3724205493927002, 0.018079280853271484, 1.1990779638290405, 0.28587210178375244, 5.509068012237549, 0.9564647674560547, 2.0020952224731445, 4.918704986572266, 2.8441736698150635, 0.20440161228179932, 3.489762783050537, 0.30778539180755615, 2.9535512924194336, 0.5914261341094971, 0.23903167247772217, 1.7180997133255005, 2.6809897422790527, 4.137595176696777, 2.1641011238098145, 1.3281055688858032, 0.6023069620132446, 2.3436827659606934, 2.4338393211364746, 7.144949913024902, 2.587214946746826, 0.46813106536865234, 1.164554476737976, 0.38693857192993164, 0.4469195604324341, 0.6770356893539429, 1.394278883934021, 0.40584826469421387, 2.0700807571411133, 2.042327880859375, 0.9193626642227173, 4.275132179260254, 3.4134061336517334, 2.765334129333496, 1.5184085369110107, 0.12796223163604736, 0.20678603649139404, 2.067017078399658, 2.5269596576690674, 1.4755500555038452, 1.2514042854309082, 1.8092060089111328, 0.11634242534637451, 0.6325607299804688, 0.6448161602020264, 1.784206509590149, 1.2076133489608765, 2.610708236694336, 0.8550616502761841, 1.8462951183319092, 0.1445322036743164, 0.8890128135681152, 3.040670871734619, 1.4349740743637085, 4.050682544708252, 0.4916898012161255, 0.3941936492919922, 1.0962929725646973, 1.374998688697815, 1.5239664316177368, 2.787027359008789, 0.24590182304382324, 0.1201484203338623, 1.0651167631149292, 2.4514732360839844, 1.0458632707595825, 0.6531273126602173, 1.4543423652648926, 1.0661993026733398, 2.3564648628234863, 0.636792778968811, 1.4741884469985962, 4.161938190460205, 0.2511798143386841], "mean_td_error": 1.6559396982192993, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089404106140137, "actor_loss": -6.781455993652344, "critic_loss": 0.17609405517578125, "alpha_loss": -0.26356372237205505, "alpha_value": 0.9742154479026794, "log_alpha_value": -0.026122823357582092, "target_entropy": -6.0, "policy_t": 0.006783238612115383, "mean_q": 2.827101707458496, "max_q": 3.9005558490753174, "min_q": 2.048079490661621}, "td_error": [2.475931167602539, 4.298519134521484, 0.6846952438354492, 0.18212056159973145, 0.40528321266174316, 0.8644589185714722, 1.435426950454712, 3.051603317260742, 0.5940823554992676, 0.918099045753479, 0.12761640548706055, 0.42401015758514404, 0.17827415466308594, 0.06880879402160645, 1.2294044494628906, 2.3665027618408203, 0.4340435266494751, 0.18632972240447998, 0.42129015922546387, 1.5728718042373657, 0.6266101598739624, 1.7887578010559082, 1.8972346782684326, 0.5706090927124023, 1.9366555213928223, 1.1184085607528687, 2.048062562942505, 1.0249601602554321, 0.7534773349761963, 2.3539514541625977, 2.5692451000213623, 0.6876507997512817, 0.13644325733184814, 2.6935009956359863, 2.661698818206787, 3.552140474319458, 2.7173986434936523, 0.26447272300720215, 0.07311868667602539, 1.7305806875228882, 1.9562658071517944, 1.2905484437942505, 1.0384281873703003, 0.28702616691589355, 1.7633376121520996, 0.949539303779602, 0.05139517784118652, 2.594331741333008, 1.1607224941253662, 1.5968886613845825, 1.9657264947891235, 0.7020953893661499, 0.07631063461303711, 0.614759087562561, 0.2509496212005615, 2.0650980472564697, 0.18831098079681396, 0.8547612428665161, 0.28334152698516846, 0.34786343574523926, 0.13632488250732422, 1.3038532733917236, 0.8197064399719238, 0.3040328025817871, 1.7767523527145386, 1.1284955739974976, 0.9234179258346558, 0.7182035446166992, 0.39768123626708984, 0.3021378517150879, 0.5513709783554077, 0.5567977428436279, 0.4897913932800293, 0.23108172416687012, 1.4304004907608032, 1.8326345682144165, 0.129325270652771, 0.29026997089385986, 0.9678353071212769, 1.032303810119629, 2.2514050006866455, 2.2220191955566406, 4.203700065612793, 0.6483113765716553, 1.7124603986740112, 3.054443359375], "mean_td_error": 1.192753553390503, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109291076660156, "actor_loss": -6.890649795532227, "critic_loss": 0.3017398715019226, "alpha_loss": -0.2639171779155731, "alpha_value": 0.9742314219474792, "log_alpha_value": -0.026106398552656174, "target_entropy": -6.0, "policy_t": -0.008521350100636482, "mean_q": 2.9257614612579346, "max_q": 3.8856704235076904, "min_q": 2.2455508708953857}, "td_error": [1.637742042541504, 0.030080199241638184, 1.5393638610839844, 3.6890981197357178, 2.95389986038208, 0.9778501987457275, 0.26325249671936035, 0.7691094875335693, 2.3845736980438232, 2.8619933128356934, 3.4631471633911133, 1.9667094945907593, 0.6700868606567383, 1.8865636587142944, 1.4863853454589844, 1.8650774955749512, 0.18086504936218262, 0.1514725685119629, 5.049397945404053, 1.6795079708099365, 0.19389259815216064, 2.8772430419921875, 2.794874668121338, 0.7017804384231567, 1.7692151069641113, 2.3400626182556152, 3.5743234157562256, 4.078932285308838, 1.918886661529541, 1.8527352809906006, 0.5571146011352539, 0.32314884662628174, 3.064208507537842, 3.686124324798584, 2.3255155086517334, 2.636183500289917, 0.20008611679077148, 1.1620687246322632, 0.21630096435546875, 1.171208143234253, 1.5907844305038452, 1.3964346647262573, 1.3129019737243652, 0.33261632919311523, 0.7468247413635254, 0.2276933193206787, 0.7626132965087891, 0.6919959783554077, 1.5060490369796753, 0.3210362195968628, 3.4237146377563477, 0.30291318893432617, 0.23630130290985107, 0.03880667686462402, 0.8747565746307373, 0.34356021881103516, 0.4886050224304199, 0.9407824277877808, 1.3190677165985107, 0.5528188943862915, 3.7622203826904297, 1.9147948026657104, 0.05185890197753906, 6.327016830444336, 0.8871374130249023, 0.1766524314880371, 1.0678796768188477, 3.023383140563965, 0.06038796901702881, 0.18494319915771484, 1.172877550125122, 1.1610474586486816, 0.9890406131744385, 0.13670837879180908, 0.19416534900665283, 2.5318803787231445, 0.3428611755371094, 1.1441192626953125, 0.26921069622039795, 1.7864396572113037, 0.0815739631652832, 2.33790922164917, 0.7222652435302734, 1.5729703903198242, 3.011237621307373, 2.810129165649414], "mean_td_error": 1.4893147945404053, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 431.0271963386337, "num_env_steps_trained_throughput_per_sec": 124.11274180286551, "timesteps_total": 79744, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 239232, "timers": {"training_iteration_time_ms": 1975.646, "sample_time_ms": 1398.604, "load_time_ms": 0.535, "load_throughput": 481975.072, "learn_time_ms": 62.135, "learn_throughput": 4152.262, "synch_weights_time_ms": 15.264}, "counters": {"num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "done": false, "episodes_total": 0, "training_iteration": 89, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-24", "timestamp": 1700203164, "time_this_iter_s": 2.101294994354248, "time_total_s": 182.04443097114563, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052d5040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 182.04443097114563, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 72.5, "ram_util_percent": 92.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060035705566406, "actor_loss": -6.775069236755371, "critic_loss": 0.3574104309082031, "alpha_loss": -0.2654559910297394, "alpha_value": 0.973957896232605, "log_alpha_value": -0.026387182995676994, "target_entropy": -6.0, "policy_t": 0.016479115933179855, "mean_q": 2.878901720046997, "max_q": 3.3764874935150146, "min_q": 2.355314016342163}, "td_error": [0.13511061668395996, 1.8932420015335083, 0.2097381353378296, 0.6999087333679199, 2.6097116470336914, 2.2776496410369873, 0.23862206935882568, 2.2101094722747803, 2.1431467533111572, 2.576472043991089, 1.5075501203536987, 0.8835484981536865, 0.9944535493850708, 2.4271492958068848, 0.8696410655975342, 1.2161191701889038, 1.8566968441009521, 1.5125865936279297, 1.404970407485962, 3.7970354557037354, 1.596887469291687, 1.831400990486145, 0.20637595653533936, 3.0392158031463623, 0.17162346839904785, 1.5353105068206787, 0.012792229652404785, 1.3402432203292847, 1.1419847011566162, 2.8652663230895996, 0.24055922031402588, 0.49535512924194336, 2.6116561889648438, 3.4304697513580322, 0.30743515491485596, 0.5030533075332642, 4.744084358215332, 1.1283539533615112, 2.7807114124298096, 0.34897661209106445, 2.5312769412994385, 0.22660446166992188, 0.889879584312439, 4.63564395904541, 0.2828404903411865, 0.5876383781433105, 1.3915350437164307, 0.8072116374969482, 1.0037033557891846, 1.9344313144683838, 0.9436426162719727, 0.9181506633758545, 1.5031253099441528, 0.36553311347961426, 0.3211052417755127, 1.0635030269622803, 0.5481420755386353, 2.1151156425476074, 0.9164988994598389, 0.298625111579895, 0.8068790435791016, 1.7891901731491089, 2.384704828262329, 2.791322708129883, 2.0236802101135254, 0.21487104892730713, 2.6758198738098145, 2.2965338230133057, 3.5888266563415527, 1.6273385286331177, 1.6349788904190063, 0.6158409118652344, 0.45292460918426514, 1.132820963859558, 0.10118627548217773, 2.373810052871704, 3.1950104236602783, 1.335341215133667, 1.1424596309661865, 0.9703419208526611, 2.1296844482421875, 5.868430137634277, 3.2228925228118896, 0.17193448543548584, 8.40296745300293, 2.5352697372436523], "mean_td_error": 1.6344707012176514, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070749282836914, "actor_loss": -6.803061008453369, "critic_loss": 0.21815179288387299, "alpha_loss": -0.26609641313552856, "alpha_value": 0.9739233255386353, "log_alpha_value": -0.02642270363867283, "target_entropy": -6.0, "policy_t": 0.007594831753522158, "mean_q": 2.852545738220215, "max_q": 3.9636685848236084, "min_q": 2.0735738277435303}, "td_error": [1.3202741146087646, 3.334293842315674, 2.260770797729492, 0.22240304946899414, 0.8538476228713989, 1.2945876121520996, 0.1007223129272461, 0.5777807235717773, 0.514083743095398, 4.15419864654541, 1.779686450958252, 0.3751063346862793, 1.1391479969024658, 0.3600642681121826, 1.3915902376174927, 1.732727289199829, 1.1442855596542358, 0.40088868141174316, 1.8007999658584595, 0.3601834774017334, 0.2267090082168579, 1.3305785655975342, 0.7589890956878662, 1.040212631225586, 1.9277819395065308, 2.1481235027313232, 0.8906633853912354, 2.361292839050293, 1.1158971786499023, 1.0552256107330322, 0.6420590877532959, 0.42023277282714844, 2.2899112701416016, 3.3245904445648193, 3.9106154441833496, 0.14013850688934326, 0.25368547439575195, 0.024809956550598145, 1.1746877431869507, 1.772728681564331, 0.25101912021636963, 2.4170126914978027, 3.645120143890381, 1.0466959476470947, 0.5734070539474487, 0.7915182113647461, 2.226731300354004, 0.86921226978302, 0.13026583194732666, 0.1105492115020752, 1.3827791213989258, 3.531163215637207, 1.5483660697937012, 0.6333755254745483, 0.7020926475524902, 0.4524576663970947, 3.145730972290039, 2.361440658569336, 0.17424798011779785, 4.900481224060059, 1.3780336380004883, 2.570791244506836, 1.793778896331787, 1.1220628023147583, 0.5730979442596436, 0.30918240547180176, 0.13926219940185547, 1.377267599105835, 0.2766401767730713, 1.1975469589233398, 1.8907580375671387, 1.6310865879058838, 0.4652198553085327, 0.6712026596069336, 1.386051058769226, 1.1408565044403076, 2.1285605430603027, 1.0056636333465576, 2.2964048385620117, 1.7922253608703613, 0.7522554397583008, 3.422480583190918, 3.0452699661254883, 2.2307305335998535, 0.0417560338973999, 0.14267444610595703], "mean_td_error": 1.3674522638320923, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119721412658691, "actor_loss": -6.906238079071045, "critic_loss": 0.28453898429870605, "alpha_loss": -0.2672275900840759, "alpha_value": 0.9739390015602112, "log_alpha_value": -0.026406612247228622, "target_entropy": -6.0, "policy_t": -0.0034284840803593397, "mean_q": 2.9341466426849365, "max_q": 3.8096837997436523, "min_q": 2.2012481689453125}, "td_error": [0.11532092094421387, 1.792883038520813, 1.065745234489441, 2.17173433303833, 0.6781820058822632, 0.706427812576294, 1.0926473140716553, 0.45616579055786133, 1.2288413047790527, 0.6664174795150757, 0.6133172512054443, 1.7009806632995605, 0.9536975622177124, 0.9883435964584351, 0.3154078722000122, 1.6360912322998047, 0.041593313217163086, 0.0925760269165039, 0.019178152084350586, 1.356884479522705, 2.6333706378936768, 2.116257667541504, 0.0569533109664917, 0.023768305778503418, 4.217905521392822, 2.237736225128174, 1.292422890663147, 2.394167423248291, 1.4849351644515991, 0.632145881652832, 2.5407934188842773, 1.421202540397644, 1.4797484874725342, 3.117432117462158, 2.010941743850708, 5.879097938537598, 0.9348009824752808, 1.6551011800765991, 0.9758235216140747, 0.9967375993728638, 0.19857215881347656, 3.818795680999756, 1.1773403882980347, 0.16154062747955322, 1.6102150678634644, 0.3226391077041626, 2.432116746902466, 1.0439612865447998, 0.869144082069397, 0.544426441192627, 3.092869281768799, 0.4009047746658325, 0.5691611766815186, 1.6921718120574951, 1.7736232280731201, 0.07473015785217285, 2.1376776695251465, 3.670259714126587, 2.6469783782958984, 1.301783561706543, 0.8454979658126831, 1.9538623094558716, 3.220870018005371, 3.2035751342773438, 0.0779033899307251, 6.770800590515137, 0.2827852964401245, 4.0731425285339355, 0.39900290966033936, 0.762444257736206, 0.5510497093200684, 1.9893162250518799, 2.1285834312438965, 0.22316646575927734, 0.3339724540710449, 0.1976468563079834, 0.8749736547470093, 0.1812448501586914, 1.3198829889297485, 1.5888961553573608, 1.692643642425537, 0.10878860950469971, 0.6062064170837402, 0.7016098499298096, 0.5469284057617188, 1.0461781024932861], "mean_td_error": 1.4071354866027832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 425.8617682260876, "num_env_steps_trained_throughput_per_sec": 122.6253752258154, "timesteps_total": 80640, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 241920, "timers": {"training_iteration_time_ms": 1999.4, "sample_time_ms": 1424.046, "load_time_ms": 0.532, "load_throughput": 484673.459, "learn_time_ms": 62.045, "learn_throughput": 4158.296, "synch_weights_time_ms": 15.104}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 22962, "num_agent_steps_sampled": 241920, "num_agent_steps_trained": 22962, "last_target_update_ts": 80640, "num_target_updates": 89}, "done": false, "episodes_total": 0, "training_iteration": 90, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-26", "timestamp": 1700203166, "time_this_iter_s": 2.1207499504089355, "time_total_s": 184.16518092155457, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052e5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 184.16518092155457, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 74.56666666666666, "ram_util_percent": 92.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13766098022461, "actor_loss": -6.814746856689453, "critic_loss": 0.4793674349784851, "alpha_loss": -0.27054545283317566, "alpha_value": 0.9736657738685608, "log_alpha_value": -0.026687167584896088, "target_entropy": -6.0, "policy_t": 0.008747603744268417, "mean_q": 2.8812286853790283, "max_q": 3.598200798034668, "min_q": 2.3866472244262695}, "td_error": [1.7763285636901855, 6.894581317901611, 2.510964870452881, 2.3242669105529785, 2.0723628997802734, 1.3670769929885864, 1.0693691968917847, 0.48895764350891113, 0.5821037292480469, 2.208277463912964, 1.4206253290176392, 1.467376708984375, 1.8588130474090576, 0.4160315990447998, 2.7943687438964844, 0.030697345733642578, 0.8770807981491089, 0.6500613689422607, 4.559791564941406, 0.12211716175079346, 3.5237174034118652, 2.750683307647705, 2.4205610752105713, 1.289184808731079, 0.6678832769393921, 1.8796709775924683, 2.4469776153564453, 1.156333565711975, 3.0708751678466797, 0.28736770153045654, 0.7121291160583496, 1.972304344177246, 2.282574415206909, 2.983488082885742, 3.8205158710479736, 0.34741950035095215, 0.36159801483154297, 0.21324646472930908, 1.5937931537628174, 3.255084991455078, 2.316516876220703, 2.3567843437194824, 4.018124580383301, 0.42260825634002686, 1.8611339330673218, 0.9307905435562134, 2.198535203933716, 1.3548678159713745, 5.471786022186279, 1.0552968978881836, 0.9761440753936768, 2.248295783996582, 1.3343820571899414, 1.5756536722183228, 1.4109116792678833, 7.593000411987305, 0.8547090291976929, 2.495288610458374, 1.3809971809387207, 2.5364952087402344, 1.5139079093933105, 3.253276824951172, 1.260380744934082, 0.7987188100814819, 4.367544174194336, 2.0762319564819336, 3.487013578414917, 2.9278945922851562, 2.4905848503112793, 1.1442409753799438, 1.8990305662155151, 1.2377856969833374, 2.5268661975860596, 2.3950467109680176, 0.5515760183334351, 0.959170937538147, 1.0075668096542358, 8.33030891418457, 3.3876469135284424, 2.720217704772949, 2.2682671546936035, 3.210115432739258, 0.726421594619751, 2.5633280277252197, 1.7077728509902954, 1.544466257095337], "mean_td_error": 2.0613296031951904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08103084564209, "actor_loss": -6.807871341705322, "critic_loss": 0.23303523659706116, "alpha_loss": -0.26939085125923157, "alpha_value": 0.9736313223838806, "log_alpha_value": -0.02672255039215088, "target_entropy": -6.0, "policy_t": -0.05242333188652992, "mean_q": 2.877707004547119, "max_q": 3.939871072769165, "min_q": 2.0582566261291504}, "td_error": [2.2301411628723145, 1.0756617784500122, 0.10288512706756592, 1.0582153797149658, 2.0894947052001953, 0.08730006217956543, 0.9923523664474487, 0.6487619876861572, 2.8110880851745605, 6.26656436920166, 0.13883066177368164, 0.7150452136993408, 2.148754596710205, 0.5689765214920044, 1.2001075744628906, 2.1977102756500244, 0.26873111724853516, 1.0843815803527832, 0.18943428993225098, 6.552989959716797, 0.44559669494628906, 2.1164281368255615, 1.0983649492263794, 0.11107754707336426, 1.0510822534561157, 1.7072826623916626, 2.406292200088501, 4.108115196228027, 1.4336048364639282, 0.30308735370635986, 0.31252336502075195, 1.2307155132293701, 0.21760869026184082, 1.5629277229309082, 1.1617835760116577, 0.4761538505554199, 0.7675621509552002, 0.30159270763397217, 0.7193512916564941, 0.15459537506103516, 1.1320908069610596, 0.3068760633468628, 0.20022010803222656, 2.8507442474365234, 0.2776259183883667, 1.5461745262145996, 0.07198214530944824, 0.44302260875701904, 0.8267650604248047, 6.601667404174805, 0.24441099166870117, 3.1194629669189453, 2.017845869064331, 0.5305640697479248, 0.13960528373718262, 0.9894840717315674, 0.2959026098251343, 1.762668490409851, 0.3233375549316406, 2.1832022666931152, 0.8030427694320679, 2.8265042304992676, 0.9257233142852783, 2.096139669418335, 1.674694299697876, 0.0591127872467041, 0.15866684913635254, 0.3511209487915039, 0.6997894048690796, 1.2176942825317383, 2.7979960441589355, 2.060999870300293, 1.8366044759750366, 2.423140525817871, 2.8963446617126465, 0.5362932682037354, 0.04462742805480957, 1.3556607961654663, 0.09787845611572266, 1.6098790168762207, 2.616980791091919, 0.3605520725250244, 2.093858242034912, 4.215219974517822, 0.9296307563781738, 3.392019748687744], "mean_td_error": 1.396011471748352, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07159423828125, "actor_loss": -6.762850761413574, "critic_loss": 0.22456924617290497, "alpha_loss": -0.2689809501171112, "alpha_value": 0.9736465811729431, "log_alpha_value": -0.026706885546445847, "target_entropy": -6.0, "policy_t": -0.035127706825733185, "mean_q": 2.836820602416992, "max_q": 3.767955780029297, "min_q": 2.3060851097106934}, "td_error": [1.2990940809249878, 0.669651985168457, 0.12361276149749756, 0.8970683813095093, 0.7739400863647461, 0.8461438417434692, 1.2362028360366821, 0.7304437160491943, 0.9433468580245972, 0.4495199918746948, 2.2175445556640625, 0.19356191158294678, 1.2934337854385376, 1.1902189254760742, 0.2504974603652954, 0.44061279296875, 3.2778475284576416, 0.21888089179992676, 1.0039138793945312, 1.1808507442474365, 0.4445382356643677, 3.1232750415802, 0.9783293008804321, 2.970733165740967, 0.8468625545501709, 1.8106334209442139, 1.4450374841690063, 2.6095571517944336, 4.860129356384277, 0.46880042552948, 1.0541478395462036, 2.484313488006592, 0.14410865306854248, 1.514404535293579, 0.19175076484680176, 1.2825987339019775, 0.4617410898208618, 1.36432683467865, 0.8676333427429199, 1.5332951545715332, 2.277353525161743, 0.546805739402771, 0.22878038883209229, 1.0563477277755737, 2.993109703063965, 0.8121922016143799, 0.047950029373168945, 1.1948424577713013, 0.636947751045227, 0.6139887571334839, 0.023913860321044922, 2.2354981899261475, 4.185324668884277, 1.7221461534500122, 0.11616361141204834, 4.169589519500732, 0.374800443649292, 1.4532328844070435, 0.031184077262878418, 0.20655548572540283, 0.09533309936523438, 0.6935089826583862, 0.8103246688842773, 4.239147186279297, 0.2859879732131958, 1.2550406455993652, 1.7844780683517456, 0.36011624336242676, 0.8783763647079468, 0.5234012603759766, 1.5703179836273193, 0.9182161092758179, 2.5825579166412354, 1.090047836303711, 1.1925796270370483, 2.11318039894104, 1.1593929529190063, 0.9239088296890259, 1.6532078981399536, 0.415729284286499, 0.4127565622329712, 0.8096168041229248, 0.11316835880279541, 0.028476953506469727, 2.0475993156433105, 1.9076154232025146], "mean_td_error": 1.2149235010147095, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}}, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 457.8216027779483, "num_env_steps_trained_throughput_per_sec": 131.82809544275744, "timesteps_total": 81536, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 244608, "timers": {"training_iteration_time_ms": 2009.328, "sample_time_ms": 1432.31, "load_time_ms": 0.531, "load_throughput": 486328.898, "learn_time_ms": 62.047, "learn_throughput": 4158.114, "synch_weights_time_ms": 15.22}, "counters": {"num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "done": false, "episodes_total": 0, "training_iteration": 91, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-28", "timestamp": 1700203168, "time_this_iter_s": 1.9720008373260498, "time_total_s": 186.13718175888062, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052e50d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 186.13718175888062, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 67.83333333333333, "ram_util_percent": 92.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054574012756348, "actor_loss": -6.814323902130127, "critic_loss": 0.4710566997528076, "alpha_loss": -0.27134594321250916, "alpha_value": 0.9733735918998718, "log_alpha_value": -0.026987312361598015, "target_entropy": -6.0, "policy_t": -0.027283286675810814, "mean_q": 2.94701886177063, "max_q": 3.5030691623687744, "min_q": 2.3411266803741455}, "td_error": [2.502190113067627, 0.7013100385665894, 1.8000781536102295, 0.4641381502151489, 1.8525099754333496, 1.044755220413208, 3.166337013244629, 1.6190855503082275, 0.44049370288848877, 1.07304847240448, 5.282003879547119, 1.4190717935562134, 4.6036577224731445, 1.9297924041748047, 2.8827004432678223, 6.088589668273926, 1.2777551412582397, 2.5844104290008545, 1.5633084774017334, 1.1567503213882446, 8.956608772277832, 0.08518016338348389, 1.3189425468444824, 1.8482885360717773, 0.07075130939483643, 2.568305015563965, 1.246559739112854, 2.0369300842285156, 5.404632568359375, 0.7909170389175415, 1.8177580833435059, 6.609975814819336, 0.6787189245223999, 2.0571298599243164, 3.4835824966430664, 1.013750433921814, 3.2279365062713623, 2.748131036758423, 1.636283040046692, 3.9143474102020264, 1.157832384109497, 1.4342765808105469, 1.7747776508331299, 0.12227523326873779, 1.1138429641723633, 0.8018190860748291, 3.233567714691162, 1.2533257007598877, 0.5854251384735107, 0.7345218658447266, 0.28027665615081787, 4.044002056121826, 2.3630900382995605, 1.4525461196899414, 0.15282821655273438, 0.08251643180847168, 2.5778746604919434, 0.7066960334777832, 1.8205904960632324, 1.6800909042358398, 1.498014211654663, 1.9092751741409302, 2.051712989807129, 0.09253048896789551, 2.3156023025512695, 0.1900618076324463, 2.38667368888855, 1.974912405014038, 2.580512046813965, 2.735234498977661, 3.1360890865325928, 1.9746437072753906, 0.20952391624450684, 4.0236029624938965, 2.9885120391845703, 0.6476774215698242, 0.10923421382904053, 1.038414478302002, 5.051388740539551, 4.113051414489746, 0.2389676570892334, 1.5331569910049438, 2.588533401489258, 1.6551834344863892, 3.0067059993743896, 2.473259449005127], "mean_td_error": 2.0332717895507812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.169132232666016, "actor_loss": -6.906560897827148, "critic_loss": 0.2851393222808838, "alpha_loss": -0.274794340133667, "alpha_value": 0.9733394384384155, "log_alpha_value": -0.02702239528298378, "target_entropy": -6.0, "policy_t": -0.035195864737033844, "mean_q": 2.939624071121216, "max_q": 3.880786895751953, "min_q": 2.0920252799987793}, "td_error": [1.2541321516036987, 1.39674973487854, 4.1134233474731445, 0.384462833404541, 0.04221975803375244, 4.247852325439453, 1.655418038368225, 2.717542886734009, 1.8716027736663818, 5.461176872253418, 2.547236919403076, 1.9168713092803955, 2.9329445362091064, 1.0280336141586304, 2.2808098793029785, 4.148226737976074, 0.141923189163208, 2.1477322578430176, 3.267296552658081, 0.2993816137313843, 3.8962292671203613, 2.5326740741729736, 0.15691828727722168, 1.573823094367981, 0.9852783679962158, 0.3004477024078369, 0.12730693817138672, 0.4179985523223877, 0.1416184902191162, 1.6240262985229492, 1.1804499626159668, 2.123964309692383, 1.2480223178863525, 2.671117067337036, 1.4547194242477417, 3.6689188480377197, 0.7889715433120728, 0.9222369194030762, 2.231691837310791, 3.8385729789733887, 2.2479000091552734, 1.9232566356658936, 0.8517953157424927, 0.6459342241287231, 0.342487096786499, 2.6916661262512207, 1.254157543182373, 0.3264967203140259, 1.4483461380004883, 0.15959548950195312, 2.3117380142211914, 0.3507348299026489, 1.3188616037368774, 0.7990988492965698, 0.1163034439086914, 0.6605253219604492, 1.9942898750305176, 2.8810696601867676, 1.7563122510910034, 3.3899526596069336, 2.602935791015625, 0.08002710342407227, 1.4890210628509521, 4.754621505737305, 1.8925551176071167, 0.21660447120666504, 3.0440657138824463, 2.756946086883545, 0.2925851345062256, 4.550721645355225, 0.06288599967956543, 0.8280642032623291, 1.2401642799377441, 2.1007580757141113, 1.056075096130371, 0.5086357593536377, 1.1902433633804321, 2.659573554992676, 0.5990070104598999, 0.26085948944091797, 2.2130818367004395, 1.149990200996399, 2.270786762237549, 0.7464333772659302, 1.4166358709335327, 0.26947271823883057], "mean_td_error": 1.6681777238845825, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.146383285522461, "actor_loss": -6.787215232849121, "critic_loss": 0.2797827124595642, "alpha_loss": -0.27402418851852417, "alpha_value": 0.9733543395996094, "log_alpha_value": -0.027007082477211952, "target_entropy": -6.0, "policy_t": -0.0037016416899859905, "mean_q": 2.7756073474884033, "max_q": 3.842616558074951, "min_q": 2.121325731277466}, "td_error": [2.4956905841827393, 0.3575550317764282, 3.372887134552002, 0.4984426498413086, 1.4975011348724365, 1.0835338830947876, 0.16562938690185547, 2.5402297973632812, 1.3495360612869263, 0.2778538465499878, 3.950338840484619, 1.2077744007110596, 2.706517219543457, 2.612484931945801, 0.861121654510498, 0.1108560562133789, 0.37719106674194336, 1.1767553091049194, 0.8959920406341553, 1.2239964008331299, 2.3158044815063477, 1.3464093208312988, 0.8249256610870361, 0.7008320093154907, 2.928318500518799, 1.4551535844802856, 3.1074044704437256, 0.6806470155715942, 0.8580528497695923, 0.23007023334503174, 0.1306847333908081, 0.322786808013916, 1.2215067148208618, 0.913025975227356, 0.7337774038314819, 0.6585854291915894, 1.073468804359436, 1.0576363801956177, 1.6602200269699097, 1.7586500644683838, 0.9801589250564575, 1.5113829374313354, 0.4411652088165283, 1.710157871246338, 0.7301394939422607, 0.4378509521484375, 4.156559944152832, 2.415111541748047, 0.6452126502990723, 0.07645249366760254, 1.6957803964614868, 0.7345196008682251, 1.0123194456100464, 0.7372102737426758, 1.8995825052261353, 5.398832321166992, 3.619661808013916, 0.27426040172576904, 0.05784142017364502, 2.2966670989990234, 0.0563356876373291, 3.911869525909424, 2.530208110809326, 2.4920265674591064, 0.23573565483093262, 3.443589210510254, 1.455880880355835, 0.3235158920288086, 0.11470472812652588, 0.7677885293960571, 0.8241137266159058, 0.7777727842330933, 0.6749750375747681, 1.6660927534103394, 2.4191887378692627, 3.3594698905944824, 1.0484256744384766, 1.7639027833938599, 0.3820394277572632, 0.8372141122817993, 2.0327022075653076, 3.021522045135498, 3.673161029815674, 1.4257169961929321, 1.2470128536224365, 1.0272704362869263], "mean_td_error": 1.4544528722763062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "last_target_update_ts": 82432, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 436.6169795035776, "num_env_steps_trained_throughput_per_sec": 125.7222999016998, "timesteps_total": 82432, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 247296, "timers": {"training_iteration_time_ms": 2023.315, "sample_time_ms": 1442.845, "load_time_ms": 0.529, "load_throughput": 488171.801, "learn_time_ms": 62.163, "learn_throughput": 4150.378, "synch_weights_time_ms": 15.744}, "counters": {"num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "last_target_update_ts": 82432, "num_target_updates": 91}, "done": false, "episodes_total": 0, "training_iteration": 92, "trial_id": "939a2_00000", "date": "2023-11-16_22-39-30", "timestamp": 1700203170, "time_this_iter_s": 2.0660171508789062, "time_total_s": 188.20319890975952, "pid": 49913, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7ff5052e5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 188.20319890975952, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 75.16666666666667, "ram_util_percent": 92.76666666666667}}
