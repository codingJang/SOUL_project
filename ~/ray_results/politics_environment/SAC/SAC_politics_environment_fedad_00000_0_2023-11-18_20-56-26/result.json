{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 675.7209484304005, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1325.969, "sample_time_ms": 749.785}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-37", "timestamp": 1700369797, "time_this_iter_s": 1.328589916229248, "time_total_s": 1.328589916229248, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742de0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.328589916229248, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.85, "ram_util_percent": 64.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056028366088867, "actor_loss": -4.0672807693481445, "critic_loss": 3.830193519592285, "alpha_loss": -0.0030168083030730486, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": -0.014638504944741726, "mean_q": 0.016513600945472717, "max_q": 0.1254863142967224, "min_q": 0.010633355937898159}, "td_error": [4.416955947875977, 5.593640327453613, 4.227949142456055, 3.136413335800171, 5.892328262329102, 5.56077241897583, 4.183187961578369, 4.610989570617676, 4.209022045135498, 3.829893112182617, 3.8828635215759277, 5.167019844055176, 5.015700817108154, 3.2616937160491943, 2.611034393310547, 4.192078113555908, 3.468400001525879, 2.685682773590088, 4.379502296447754, 1.891053318977356, 3.528110980987549, 4.771728992462158, 4.111804008483887, 5.565913677215576, 5.824822902679443, 4.445042133331299, 3.6950466632843018, 4.805522918701172, 4.949820041656494, 5.118051052093506, 3.481973648071289, 3.2156150341033936, 5.1977925300598145, 3.7109177112579346, 2.8943724632263184, 5.684212684631348, 4.425442695617676, 4.51841926574707, 6.179764747619629, 5.571048259735107, 4.730972766876221, 6.077264785766602, 4.9708709716796875, 5.040463447570801, 4.703413009643555, 4.965000629425049, 4.99487829208374, 2.92048978805542, 4.482299327850342, 3.5677199363708496, 4.101922988891602, 4.475222110748291, 5.887977123260498, 3.0803685188293457, 4.548427104949951, 3.85197114944458, 5.1539106369018555, 5.403112411499023, 3.807126522064209, 4.436076641082764, 6.683352470397949, 3.109693765640259, 3.06782603263855, 5.1016926765441895, 3.848484516143799, 2.203789710998535, 4.660362720489502, 4.91558837890625, 3.9067983627319336, 3.7072091102600098, 4.447320938110352, 4.84857702255249, 6.514603614807129, 5.301845073699951, 5.6599860191345215, 2.9816813468933105, 4.691460609436035, 3.238945484161377, 4.824739456176758, 4.124413967132568, 4.959234237670898, 4.230824947357178, 4.628822326660156, 3.8181467056274414, 5.616954803466797, 5.713977336883545], "mean_td_error": 4.4409003257751465, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.039396286010742, "actor_loss": -4.052933692932129, "critic_loss": 1.971741795539856, "alpha_loss": -0.00301181897521019, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -6.0, "policy_t": 0.03873005136847496, "mean_q": 0.016432179138064384, "max_q": 0.11343864351511002, "min_q": 0.01234348863363266}, "td_error": [3.106459140777588, 1.729766845703125, 1.897262454032898, 2.5966219902038574, 2.0825576782226562, 3.498490333557129, 1.7569512128829956, 1.6526813507080078, 2.437171459197998, 0.5420711040496826, 3.066847801208496, 2.990135669708252, 2.3602161407470703, 2.140113353729248, 2.17541241645813, 2.678938865661621, 2.4078211784362793, 2.075680732727051, 3.973443031311035, 0.0988122969865799, 3.122830867767334, 4.4108405113220215, 2.5158915519714355, 2.6981210708618164, 2.5779531002044678, 2.0124874114990234, 2.2049293518066406, 2.9206018447875977, 2.062480926513672, 2.5276780128479004, 1.5118129253387451, 2.581054210662842, 2.811502456665039, 2.7481541633605957, 5.461411952972412, 2.427938938140869, 2.31296706199646, 3.3273677825927734, 2.0302977561950684, 1.7822970151901245, 2.7283759117126465, 3.070683479309082, 2.622530937194824, 3.79298734664917, 2.533520221710205, 2.229247570037842, 3.338139057159424, 4.15194034576416, 4.004971504211426, 4.143488883972168, 1.5131068229675293, 4.398050308227539, 1.9799129962921143, 4.668265342712402, 0.8861295580863953, 2.610290050506592, 1.9717371463775635, 2.328242301940918, 4.496370315551758, 0.6850043535232544, 2.3129191398620605, 0.9995303750038147, 2.3975987434387207, 3.4795589447021484, 3.1196951866149902, 4.4110331535339355, 2.456216812133789, 4.04356575012207, 2.783910036087036, 2.5648388862609863, 2.433990716934204, 1.1940689086914062, 3.6140189170837402, 3.316531181335449, 3.4355993270874023, 5.236609935760498, 5.421302795410156, 0.9245789051055908, 3.5504322052001953, 2.6029319763183594, 2.5563461780548096, 1.8991392850875854, 4.3193678855896, 5.320568084716797, 2.546088218688965, 1.6132371425628662], "mean_td_error": 2.744450330734253, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.942030906677246, "actor_loss": -3.9490067958831787, "critic_loss": 0.8457769155502319, "alpha_loss": -0.0029826094396412373, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.0003000000142492354, "target_entropy": -6.0, "policy_t": 0.005501479376107454, "mean_q": 0.01503266952931881, "max_q": 0.16217276453971863, "min_q": 0.0098206652328372}, "td_error": [1.9813119173049927, 3.490370750427246, 3.0634360313415527, 4.078274726867676, 1.8186664581298828, 2.258608102798462, 2.2164602279663086, 2.921318531036377, 2.558058500289917, 1.0815465450286865, 0.8605122566223145, 3.432495355606079, 1.6451170444488525, 3.5680856704711914, 1.3486591577529907, 3.228200912475586, 1.1789942979812622, 2.130094051361084, 1.2274274826049805, 2.792220115661621, 1.4740915298461914, 2.8351635932922363, 0.9926614165306091, 3.2137374877929688, 1.823473334312439, 3.040320873260498, 3.4766147136688232, 4.251894950866699, 3.1603217124938965, 3.0523266792297363, 3.083937168121338, 3.086550235748291, 1.626718282699585, 4.9429802894592285, 0.8117386102676392, 3.1896653175354004, 2.4752440452575684, 2.9804580211639404, 4.689445495605469, 2.494051933288574, 1.1983788013458252, 3.2675721645355225, 2.269217014312744, 1.448737382888794, 4.855797290802002, 4.781726837158203, 2.2554125785827637, 3.2377266883850098, 2.042299270629883, 1.8461483716964722, 0.6054643392562866, 3.7355120182037354, 0.9484232664108276, 2.2310142517089844, 2.2998247146606445, 2.834519386291504, 3.54732608795166, 0.4601111114025116, 3.1221048831939697, 3.5476837158203125, 1.4226843118667603, 1.4086254835128784, 0.18561115860939026, 2.1693055629730225, 2.7473785877227783, 4.352487564086914, 1.8652989864349365, 1.5798976421356201, 2.5226364135742188, 3.7869434356689453, 2.2517497539520264, 1.6673253774642944, 3.163794994354248, 1.8612442016601562, 4.280993461608887, 1.219289779663086, 1.8062622547149658, 2.731860637664795, 3.7345902919769287, 2.2600297927856445, 3.097663164138794, 2.697234630584717, 1.9180657863616943, 3.6291074752807617, 2.838810443878174, 2.1244959831237793], "mean_td_error": 2.528367757797241, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 926.83971522236, "num_env_steps_trained_throughput_per_sec": 266.88018585643846, "timesteps_total": 2688, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1086.446, "sample_time_ms": 706.53, "load_time_ms": 0.309, "load_throughput": 834655.173, "learn_time_ms": 29.952, "learn_throughput": 8613.905, "synch_weights_time_ms": 9.443}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 516, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 516, "last_target_update_ts": 2688, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-39", "timestamp": 1700369799, "time_this_iter_s": 1.9421029090881348, "time_total_s": 3.270692825317383, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.270692825317383, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 65.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010278701782227, "actor_loss": -4.0333380699157715, "critic_loss": 3.9325270652770996, "alpha_loss": -0.006006377283483744, "alpha_value": 0.9994001388549805, "log_alpha_value": -0.0006000209832563996, "target_entropy": -6.0, "policy_t": -0.0214463472366333, "mean_q": 0.03194646164774895, "max_q": 0.23711805045604706, "min_q": 0.021589023992419243}, "td_error": [5.218307971954346, 3.2329723834991455, 5.05635929107666, 5.285187244415283, 5.397861480712891, 3.1885242462158203, 3.655853271484375, 5.373169898986816, 5.722966194152832, 3.705518960952759, 4.132473945617676, 3.561695098876953, 4.947983741760254, 4.654387474060059, 4.379096984863281, 4.285213947296143, 5.4293532371521, 4.376415252685547, 4.419619083404541, 5.030951023101807, 6.208643913269043, 4.261551856994629, 4.872725963592529, 5.729334354400635, 6.2629852294921875, 5.114850044250488, 5.257098197937012, 3.8321306705474854, 6.978942394256592, 5.82969856262207, 4.140027046203613, 4.169364929199219, 3.205824375152588, 5.748377799987793, 5.033123970031738, 3.1149516105651855, 3.8175253868103027, 3.015467882156372, 4.6480278968811035, 4.368456840515137, 4.498607158660889, 4.750098705291748, 5.3754563331604, 2.4091320037841797, 4.357230186462402, 4.237949371337891, 3.7952468395233154, 5.344692230224609, 3.566030502319336, 8.244213104248047, 4.12483024597168, 4.174185752868652, 6.0887041091918945, 5.781068801879883, 4.791270732879639, 6.7543511390686035, 5.3889594078063965, 4.351337432861328, 5.1291608810424805, 3.861177682876587, 2.799163818359375, 5.344514846801758, 3.9927196502685547, 4.978435516357422, 4.545423984527588, 3.497567892074585, 4.545970916748047, 4.476228713989258, 4.92832612991333, 4.329890251159668, 3.541579008102417, 3.6090517044067383, 3.401073932647705, 4.332893371582031, 4.379472732543945, 5.683921813964844, 4.161906719207764, 4.336638450622559, 4.830019950866699, 3.288881778717041, 5.390742778778076, 5.128725528717041, 3.847069263458252, 4.661281585693359, 3.607682704925537, 5.379724502563477], "mean_td_error": 4.612856388092041, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049424171447754, "actor_loss": -4.074212551116943, "critic_loss": 1.2068376541137695, "alpha_loss": -0.006029688287526369, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0006000033463351429, "target_entropy": -6.0, "policy_t": -0.021289555355906487, "mean_q": 0.035288456827402115, "max_q": 0.3008202016353607, "min_q": 0.02355114370584488}, "td_error": [0.6225358843803406, 3.3992862701416016, 3.783569574356079, 2.2785866260528564, 3.816318988800049, 0.8405092358589172, 2.64312744140625, 1.470120906829834, 2.115595817565918, 1.8160043954849243, 1.866898775100708, 3.7957849502563477, 4.333654880523682, 2.7932558059692383, 3.1768150329589844, 1.7239562273025513, 2.5213563442230225, 3.646496295928955, 1.631338357925415, 2.28104829788208, 2.2926127910614014, 5.518570899963379, 1.3090500831604004, 1.5664002895355225, 2.655158758163452, 2.699554204940796, 3.494108200073242, 3.0550479888916016, 1.661043643951416, 1.566718339920044, 4.022026538848877, 2.939263343811035, 1.0392448902130127, 1.9799354076385498, 2.315633773803711, 2.6538100242614746, 5.354358673095703, 4.08051872253418, 4.583914756774902, 2.5020670890808105, 3.8619542121887207, 3.1529321670532227, 1.8709228038787842, 4.69228458404541, 3.0406908988952637, 3.466538906097412, 2.52671480178833, 2.658118486404419, 3.745532512664795, 5.044968605041504, 1.8738576173782349, 2.022461175918579, 2.241598129272461, 3.58441162109375, 0.3844541609287262, 0.3524194359779358, 1.441094160079956, 2.8606624603271484, 2.3769326210021973, 1.0873348712921143, 3.1359992027282715, 2.362095832824707, 2.448014736175537, 2.0634517669677734, 2.7659730911254883, 3.060420513153076, 3.2315168380737305, 2.3987483978271484, 4.008033752441406, 1.8674075603485107, 3.9489269256591797, 2.656674385070801, 3.487614154815674, 3.9380247592926025, 3.191920042037964, 1.270723819732666, 0.522547721862793, 2.024022102355957, 0.8865047693252563, 4.087989807128906, 3.8218183517456055, 3.546950578689575, 3.6221511363983154, 3.5344464778900146, 2.122929573059082, 1.9779419898986816], "mean_td_error": 2.699000358581543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.99389934539795, "actor_loss": -4.0102996826171875, "critic_loss": 0.8523159027099609, "alpha_loss": -0.005995181389153004, "alpha_value": 0.9994003176689148, "log_alpha_value": -0.0005998840788379312, "target_entropy": -6.0, "policy_t": -0.005468423943966627, "mean_q": 0.04105701297521591, "max_q": 0.3149196207523346, "min_q": 0.01878468692302704}, "td_error": [3.47328519821167, 3.4726669788360596, 2.799941062927246, 3.089845657348633, 1.2143430709838867, 1.7239549160003662, 2.3279144763946533, 2.1297988891601562, 2.593425750732422, 1.6675105094909668, 1.5392760038375854, 2.3919734954833984, 2.809885263442993, 2.782809257507324, 3.9191999435424805, 3.6360929012298584, 4.058206558227539, 3.6460325717926025, 0.7479731440544128, 2.548513889312744, 1.725642204284668, 4.321521759033203, 1.645387887954712, 2.5540318489074707, 3.0500593185424805, 2.6335995197296143, 1.7406853437423706, 2.658586025238037, 2.382784605026245, 0.7501826286315918, 1.854097843170166, 1.2796874046325684, 1.831425428390503, 2.9138262271881104, 2.4623684883117676, 1.6003921031951904, 4.395964622497559, 1.4646375179290771, 0.9952875375747681, 3.9647817611694336, 2.153979778289795, 0.8179202079772949, 1.9528305530548096, 1.4107269048690796, 3.976431369781494, 0.46077966690063477, 4.497978210449219, 4.079730987548828, 4.788877010345459, 4.382913589477539, 2.994075298309326, 2.043853759765625, 3.940558433532715, 2.3348915576934814, 3.779832363128662, 3.8104381561279297, 2.5555429458618164, 2.6261472702026367, 2.5208911895751953, 2.0787038803100586, 2.0472397804260254, 1.6212406158447266, 1.3429079055786133, 1.8085216283798218, 4.353809833526611, 3.068708896636963, 3.315279483795166, 2.1688232421875, 2.852837562561035, 2.226219654083252, 2.744600296020508, 2.2968590259552, 3.0890209674835205, 3.448512315750122, 2.04156231880188, 3.0167853832244873, 1.2419432401657104, 0.7279269099235535, 3.0422377586364746, 3.173696994781494, 1.0559229850769043, 2.6502792835235596, 3.090843677520752, 2.9696528911590576, 1.2377033233642578, 2.375237464904785], "mean_td_error": 2.546663761138916, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 824.3357465410263, "num_env_steps_trained_throughput_per_sec": 237.36453416025088, "timesteps_total": 3584, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1086.563, "sample_time_ms": 702.788, "load_time_ms": 0.313, "load_throughput": 824166.361, "learn_time_ms": 26.246, "learn_throughput": 9829.954, "synch_weights_time_ms": 9.87}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 774, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 774, "last_target_update_ts": 3584, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-40", "timestamp": 1700369800, "time_this_iter_s": 1.0946688652038574, "time_total_s": 4.36536169052124, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177436a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.36536169052124, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.650000000000006, "ram_util_percent": 65.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11098575592041, "actor_loss": -4.158862590789795, "critic_loss": 3.815187931060791, "alpha_loss": -0.012132744304835796, "alpha_value": 0.9988007545471191, "log_alpha_value": -0.0011999566340819001, "target_entropy": -6.0, "policy_t": 0.037841930985450745, "mean_q": 0.07448626309633255, "max_q": 0.5479305982589722, "min_q": 0.045048732310533524}, "td_error": [3.379141330718994, 5.010944366455078, 4.721089839935303, 3.923544406890869, 5.073424816131592, 4.044306755065918, 2.9190635681152344, 3.9999799728393555, 4.339183330535889, 4.402132987976074, 5.989256858825684, 3.122586965560913, 5.228451728820801, 1.9472508430480957, 4.119433403015137, 4.938382148742676, 2.942582607269287, 5.324954032897949, 3.2984910011291504, 5.048294544219971, 6.942075252532959, 3.7472329139709473, 4.665043830871582, 4.329098701477051, 4.5437211990356445, 5.034006118774414, 5.031072616577148, 3.629507541656494, 5.221553325653076, 4.770237922668457, 4.921457290649414, 2.8302409648895264, 3.27254056930542, 5.113509178161621, 5.379899978637695, 4.243576526641846, 3.8907904624938965, 4.913465976715088, 3.8365330696105957, 4.222853183746338, 3.337017774581909, 4.270698547363281, 4.6780595779418945, 4.90665864944458, 4.43582010269165, 5.7074079513549805, 6.116301536560059, 4.55501651763916, 2.7176051139831543, 6.4297614097595215, 5.287731647491455, 3.4543232917785645, 5.998777866363525, 5.863739967346191, 4.705282688140869, 5.670586585998535, 5.829046726226807, 5.314389228820801, 3.3680405616760254, 3.6631722450256348, 5.87045955657959, 5.958940505981445, 5.112227916717529, 3.8255863189697266, 2.3874189853668213, 3.1370816230773926, 4.164334297180176, 5.195826530456543, 5.674680709838867, 4.8793840408325195, 3.8762197494506836, 4.585297584533691, 3.001150369644165, 3.43765926361084, 5.1864471435546875, 4.49774169921875, 4.80771541595459, 3.6260385513305664, 4.671025276184082, 4.962285041809082, 2.6050236225128174, 6.828108787536621, 4.651408672332764, 5.358948707580566, 3.291576862335205, 4.697906494140625], "mean_td_error": 4.498962879180908, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115638732910156, "actor_loss": -4.162554740905762, "critic_loss": 1.3385779857635498, "alpha_loss": -0.01214014645665884, "alpha_value": 0.9988005757331848, "log_alpha_value": -0.001200136379338801, "target_entropy": -6.0, "policy_t": 0.009932857938110828, "mean_q": 0.0898170918226242, "max_q": 0.6061086058616638, "min_q": 0.04708614945411682}, "td_error": [0.5832675099372864, 3.2907848358154297, 4.148304462432861, 3.536372184753418, 2.3852176666259766, 2.8493494987487793, 3.2799477577209473, 3.2715349197387695, 2.7075867652893066, 3.534738063812256, 3.8299078941345215, 1.016679048538208, 2.2664194107055664, 2.7818307876586914, 3.449406862258911, 1.9867546558380127, 2.0634765625, 3.4572439193725586, 1.7600774765014648, 2.4959635734558105, 2.530775547027588, 1.3792624473571777, 3.3859236240386963, 2.7292943000793457, 3.9907760620117188, 4.689423084259033, 2.685029983520508, 4.012101173400879, 2.7650556564331055, 4.445379257202148, 2.8026158809661865, 3.64477801322937, 3.077808141708374, 0.8190001249313354, 0.284809410572052, 4.865768909454346, 1.1313185691833496, 2.9550399780273438, 3.4301345348358154, 2.7442562580108643, 4.058249473571777, 2.972601890563965, 3.285844564437866, 3.5199074745178223, 3.746310234069824, 1.2572202682495117, 2.0210938453674316, 2.5911202430725098, 2.178521156311035, 3.821887493133545, 2.777968406677246, 3.9390509128570557, 3.3805203437805176, 3.170999526977539, 2.7950210571289062, 3.228806972503662, 3.2445907592773438, 1.1114633083343506, 3.300769090652466, 3.565195083618164, 2.8642325401306152, 3.7899208068847656, 3.6041762828826904, 4.957114219665527, 2.8699119091033936, 3.643829584121704, 4.141808986663818, 2.849132537841797, 2.1100988388061523, 2.282900094985962, 1.4965298175811768, 2.2726118564605713, 3.9438397884368896, 3.472029209136963, 4.005342960357666, 3.999385356903076, 1.8850657939910889, 1.6359779834747314, 1.9846504926681519, 2.7153749465942383, 2.369792938232422, 2.641843795776367, 4.912998199462891, 2.449021339416504, 0.6350377798080444, 1.6492578983306885], "mean_td_error": 2.8861913681030273, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.18970012664795, "actor_loss": -4.223832130432129, "critic_loss": 0.7926549911499023, "alpha_loss": -0.01222610380500555, "alpha_value": 0.9988008737564087, "log_alpha_value": -0.0011998491827398539, "target_entropy": -6.0, "policy_t": 0.01775326021015644, "mean_q": 0.08061883598566055, "max_q": 0.6749283671379089, "min_q": 0.03755227476358414}, "td_error": [1.8136276006698608, 2.4978649616241455, 0.18873074650764465, 2.122800827026367, 2.798412561416626, 0.6773985028266907, 3.8680481910705566, 1.6342835426330566, 2.3652942180633545, 2.7724034786224365, 2.7877321243286133, 2.8745779991149902, 0.5045134425163269, 2.05112886428833, 2.8710415363311768, 3.143068790435791, 2.9396133422851562, 1.5964295864105225, 1.6877028942108154, 1.6016676425933838, 0.6005538702011108, 3.8361520767211914, 1.6442188024520874, 3.1910359859466553, 2.2298426628112793, 1.1777912378311157, 2.2947466373443604, 3.349914073944092, 2.1130824089050293, 1.775834560394287, 3.226731061935425, 2.6602249145507812, 3.207871913909912, 2.6488735675811768, 1.1238502264022827, 2.8262829780578613, 2.6309823989868164, 4.397810935974121, 3.2774906158447266, 2.4614651203155518, 1.5193140506744385, 2.658015012741089, 1.6029086112976074, 1.5681037902832031, 1.111534833908081, 0.21283775568008423, 3.4814958572387695, 1.8525722026824951, 1.7040029764175415, 1.8554513454437256, 2.5113525390625, 3.3009870052337646, 4.385369300842285, 2.195038318634033, 2.1794276237487793, 1.9061634540557861, 2.317807674407959, 4.265063285827637, 3.641434907913208, 3.4227309226989746, 3.1833977699279785, 2.884415626525879, 1.9445338249206543, 1.5783891677856445, 1.5978515148162842, 2.7095794677734375, 2.7314887046813965, 2.307706356048584, 0.028718765825033188, 4.279306411743164, 2.1068153381347656, 2.0750131607055664, 2.264148235321045, 2.5762972831726074, 3.3372631072998047, 3.006129264831543, 2.1029844284057617, 2.835249423980713, 5.468688011169434, 1.0265283584594727, 1.2517194747924805, 5.06121301651001, 3.2698702812194824, 2.8685221672058105, 1.1228818893432617, 2.26046085357666], "mean_td_error": 2.407463550567627, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 938.4837867224182, "num_env_steps_trained_throughput_per_sec": 270.2330546589106, "timesteps_total": 5376, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1042.611, "sample_time_ms": 695.421, "load_time_ms": 0.316, "load_throughput": 815348.427, "learn_time_ms": 23.19, "learn_throughput": 11125.498, "synch_weights_time_ms": 10.228}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 1290, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 1290, "last_target_update_ts": 5376, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-42", "timestamp": 1700369802, "time_this_iter_s": 1.9185080528259277, "time_total_s": 6.283869743347168, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317553ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 6.283869743347168, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 65.66666666666667, "ram_util_percent": 65.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147181510925293, "actor_loss": -4.221792697906494, "critic_loss": 3.6356282234191895, "alpha_loss": -0.01826559752225876, "alpha_value": 0.9982015490531921, "log_alpha_value": -0.0018000659765675664, "target_entropy": -6.0, "policy_t": 0.021270427852869034, "mean_q": 0.138432115316391, "max_q": 0.8712118864059448, "min_q": 0.07170626521110535}, "td_error": [5.543985366821289, 3.3713903427124023, 5.125180244445801, 3.1203975677490234, 5.281255722045898, 5.843112945556641, 4.425386428833008, 4.457437515258789, 2.040806531906128, 5.285892486572266, 5.287446975708008, 4.987530708312988, 3.011781692504883, 4.517952919006348, 4.328031539916992, 3.4803061485290527, 5.29332160949707, 2.8104114532470703, 4.827553749084473, 5.919645309448242, 5.210849761962891, 5.5181355476379395, 4.023488998413086, 3.1889333724975586, 4.549610137939453, 4.921070575714111, 4.012506484985352, 3.9199538230895996, 4.594090461730957, 5.255222320556641, 3.6826086044311523, 5.393578052520752, 4.594694137573242, 4.498425006866455, 4.6124114990234375, 3.3315672874450684, 1.7385780811309814, 3.6003050804138184, 4.721372127532959, 5.201214790344238, 4.267712593078613, 4.7713141441345215, 3.6021227836608887, 5.383089542388916, 5.163618564605713, 4.817027568817139, 3.2168686389923096, 3.5959632396698, 3.5683085918426514, 5.148526191711426, 4.613847732543945, 4.167547225952148, 4.272747039794922, 4.109994411468506, 5.80816650390625, 4.889470100402832, 6.817363739013672, 3.8244922161102295, 3.8092422485351562, 4.396193504333496, 5.183406352996826, 3.069068193435669, 2.8195242881774902, 5.727163314819336, 4.7001633644104, 3.5783791542053223, 5.779624938964844, 4.178849220275879, 4.085111618041992, 3.26992130279541, 4.276277542114258, 3.4247865676879883, 2.451549530029297, 3.736072540283203, 4.949452877044678, 4.492510795593262, 4.514565467834473, 2.48995304107666, 4.115733623504639, 3.768678665161133, 5.701934814453125, 4.617831230163574, 2.622227191925049, 3.701223373413086, 5.4369964599609375, 3.337374687194824], "mean_td_error": 4.323249340057373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119527816772461, "actor_loss": -4.193252086639404, "critic_loss": 1.246911644935608, "alpha_loss": -0.018220089375972748, "alpha_value": 0.9982011318206787, "log_alpha_value": -0.001800487982109189, "target_entropy": -6.0, "policy_t": -0.024115778505802155, "mean_q": 0.09711002558469772, "max_q": 0.61668860912323, "min_q": 0.0742606520652771}, "td_error": [3.6090519428253174, 2.6953258514404297, 4.9568305015563965, 2.7809271812438965, 2.204925060272217, 2.371168375015259, 1.3970565795898438, 1.7383456230163574, 4.095900535583496, 2.6242995262145996, 4.174604892730713, 2.001957893371582, 3.875629186630249, 3.11466646194458, 1.9242247343063354, 0.9152746200561523, 4.939579963684082, 1.756699800491333, 2.789307117462158, 1.7253508567810059, 1.978907585144043, 3.7279117107391357, 2.5392346382141113, 3.7119803428649902, 4.158212184906006, 0.9751877188682556, 3.2417030334472656, 1.9354403018951416, 2.586507797241211, 2.14906644821167, 3.0636351108551025, 4.182063102722168, 1.6284173727035522, 0.7352339029312134, 3.9507803916931152, 2.869274616241455, 2.0449886322021484, 2.2873830795288086, 3.625375747680664, 2.4839463233947754, 2.853593587875366, 1.8408234119415283, 2.969658136367798, 2.222626209259033, 3.735917091369629, 2.728091239929199, 2.642436981201172, 1.7800323963165283, 3.721663475036621, 3.7146871089935303, 3.5285122394561768, 2.430967330932617, 2.8564934730529785, 1.3305439949035645, 2.259666919708252, 4.535483360290527, 3.8090415000915527, 2.958273410797119, 1.8255679607391357, 2.696284532546997, 3.2597105503082275, 0.9020710587501526, 3.1193623542785645, 2.680955171585083, 2.2554917335510254, 3.9617128372192383, 1.935497760772705, 2.726470708847046, 4.555807590484619, 2.650062322616577, 3.3421425819396973, 2.9002633094787598, 1.816044807434082, 2.7115817070007324, 3.3386611938476562, 1.907840371131897, 3.4689812660217285, 2.2638421058654785, 3.154038906097412, 3.7565574645996094, 2.4797940254211426, 1.3907655477523804, 2.7875447273254395, 3.0005569458007812, 1.962113618850708, 1.238470196723938], "mean_td_error": 2.7392220497131348, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.176061630249023, "actor_loss": -4.232263565063477, "critic_loss": 0.8850342035293579, "alpha_loss": -0.01832060143351555, "alpha_value": 0.9982012510299683, "log_alpha_value": -0.0018003627192229033, "target_entropy": -6.0, "policy_t": 0.025617262348532677, "mean_q": 0.11930281668901443, "max_q": 1.0520329475402832, "min_q": 0.058731257915496826}, "td_error": [1.3968045711517334, 3.276339054107666, 2.5069122314453125, 2.6870880126953125, 0.434456467628479, 2.3807220458984375, 3.6233441829681396, 3.144268035888672, 1.3662521839141846, 1.833127737045288, 1.603564739227295, 1.916905403137207, 3.3255598545074463, 2.3337960243225098, 2.4653372764587402, 3.8107240200042725, 2.8181018829345703, 2.4230170249938965, 3.9501466751098633, 2.0402333736419678, 3.12823748588562, 2.0339608192443848, 3.6944477558135986, 4.814421653747559, 4.5766215324401855, 3.652406692504883, 4.043307781219482, 3.6727352142333984, 3.7605714797973633, 3.587841033935547, 2.9651694297790527, 1.272003412246704, 1.3385789394378662, 3.155627489089966, 2.0474138259887695, 0.30017948150634766, 1.4052629470825195, 3.499993324279785, 2.355233669281006, 1.9424060583114624, 1.1005008220672607, 2.0484580993652344, 3.4788312911987305, 0.5007990598678589, 2.715393543243408, 2.9848337173461914, 4.318881988525391, 2.486344814300537, 3.625873565673828, 3.15641188621521, 2.081371545791626, 1.4156569242477417, 0.5496329069137573, 2.0018813610076904, 0.809319257736206, 3.2788023948669434, 1.794084906578064, 4.105111122131348, 4.038305282592773, 3.309565782546997, 2.055100917816162, 4.159933567047119, 2.7706871032714844, 1.1948533058166504, 1.6663377285003662, 3.1964111328125, 4.391059398651123, 4.000161170959473, 3.817786693572998, 3.540924549102783, 1.0999311208724976, 2.710352897644043, 3.8137922286987305, 1.9739278554916382, 1.3691020011901855, 2.3096213340759277, 1.5650207996368408, 1.4915555715560913, 1.961254358291626, 3.4067959785461426, 3.7175240516662598, 3.7327229976654053, 3.224902629852295, 2.9344544410705566, 1.240875482559204, 3.6677393913269043], "mean_td_error": 2.6441397666931152, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 919.3425729214076, "num_env_steps_trained_throughput_per_sec": 264.7214105063875, "timesteps_total": 7168, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1025.605, "sample_time_ms": 698.479, "load_time_ms": 0.319, "load_throughput": 809718.121, "learn_time_ms": 21.748, "learn_throughput": 11863.012, "synch_weights_time_ms": 9.705}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 1806, "last_target_update_ts": 7168, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-44", "timestamp": 1700369804, "time_this_iter_s": 1.9587619304656982, "time_total_s": 8.242631673812866, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.242631673812866, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 78.55, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070050239562988, "actor_loss": -4.176931858062744, "critic_loss": 3.7675130367279053, "alpha_loss": -0.024172674864530563, "alpha_value": 0.9976024031639099, "log_alpha_value": -0.0024004520382732153, "target_entropy": -6.0, "policy_t": -0.03223053738474846, "mean_q": 0.1447249948978424, "max_q": 1.2390778064727783, "min_q": 0.10265426337718964}, "td_error": [3.803527355194092, 4.058476448059082, 4.322723388671875, 3.8845958709716797, 4.664839267730713, 4.830595016479492, 4.198014259338379, 6.404749870300293, 5.130649566650391, 3.175434112548828, 5.612995147705078, 4.214966773986816, 4.904300689697266, 4.455836296081543, 4.878922939300537, 4.554078578948975, 4.645394325256348, 6.540007591247559, 4.676886558532715, 2.8567070960998535, 4.137988090515137, 4.995429515838623, 5.584596633911133, 3.16317081451416, 5.37527322769165, 3.4825005531311035, 5.308347702026367, 5.9609575271606445, 5.097638130187988, 4.419228553771973, 3.527296543121338, 3.5340476036071777, 3.195013999938965, 4.6763200759887695, 6.493842124938965, 6.48328161239624, 2.270876884460449, 5.097315788269043, 5.408604621887207, 3.8440451622009277, 4.486391067504883, 5.4931182861328125, 5.1999359130859375, 4.514504432678223, 5.548709869384766, 4.80286979675293, 4.423031806945801, 4.03294563293457, 3.640530586242676, 5.804337024688721, 3.430408477783203, 5.454557418823242, 2.6458237171173096, 4.903575897216797, 4.207962512969971, 5.542464256286621, 4.826582431793213, 4.010788917541504, 4.656103610992432, 2.310189962387085, 4.895936965942383, 2.5309462547302246, 2.8337717056274414, 4.832245826721191, 3.2112932205200195, 5.01998233795166, 5.256795883178711, 5.547292709350586, 5.376785755157471, 6.188305854797363, 4.084874629974365, 5.019935131072998, 4.008493900299072, 4.0032057762146, 4.869192123413086, 4.485843658447266, 2.3607563972473145, 5.015727996826172, 4.709925651550293, 3.742924213409424, 4.392195701599121, 5.289230823516846, 2.8073580265045166, 4.5667724609375, 3.50118350982666, 4.333840370178223], "mean_td_error": 4.49638557434082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106175422668457, "actor_loss": -4.20863676071167, "critic_loss": 1.151764154434204, "alpha_loss": -0.02426527626812458, "alpha_value": 0.9976018667221069, "log_alpha_value": -0.0024010345805436373, "target_entropy": -6.0, "policy_t": 0.025089848786592484, "mean_q": 0.15156853199005127, "max_q": 1.3690584897994995, "min_q": 0.10590964555740356}, "td_error": [2.032396078109741, 2.3479719161987305, 3.018768787384033, 3.534654140472412, 2.079418182373047, 1.8674898147583008, 0.6290557384490967, 3.1617562770843506, 2.9773616790771484, 3.8228042125701904, 2.7438697814941406, 3.450674295425415, 3.5943360328674316, 1.6153638362884521, 3.945200204849243, 0.7747523784637451, 4.753093719482422, 2.7562317848205566, 2.8482422828674316, 2.475686550140381, 3.6627488136291504, 0.7480349540710449, 2.5180444717407227, 2.430466651916504, 2.9441866874694824, 3.563230037689209, 2.9582881927490234, 1.8830976486206055, 2.7099626064300537, 0.8441817760467529, 4.04573917388916, 2.8360462188720703, 2.059058666229248, 1.3430567979812622, 2.5301055908203125, 2.3487813472747803, 3.1323819160461426, 1.9678714275360107, 0.24738118052482605, 1.6854705810546875, 3.1819100379943848, 2.290030002593994, 0.6688556671142578, 3.1577839851379395, 2.414551258087158, 4.420702934265137, 3.044489860534668, 3.0072214603424072, 1.7403863668441772, 1.611288070678711, 1.7277216911315918, 0.5587626695632935, 2.2623095512390137, 4.1750407218933105, 3.2577741146087646, 4.404486656188965, 1.8991316556930542, 5.448951721191406, 3.0292768478393555, 2.5607001781463623, 3.1268796920776367, 3.9882235527038574, 2.6145224571228027, 2.4724411964416504, 1.4796758890151978, 3.860285758972168, 2.368354320526123, 3.44856595993042, 2.7372794151306152, 1.5305869579315186, 1.7752604484558105, 2.9825615882873535, 1.7584784030914307, 1.9794902801513672, 1.4955971240997314, 3.8957436084747314, 2.5465049743652344, 1.7409484386444092, 2.102715492248535, 1.098948359489441, 1.9868205785751343, 1.241838812828064, 2.1070427894592285, 2.511355400085449, 3.070216655731201, 3.130160331726074], "mean_td_error": 2.544175863265991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109715461730957, "actor_loss": -4.189188480377197, "critic_loss": 0.7954592704772949, "alpha_loss": -0.024273298680782318, "alpha_value": 0.9976018667221069, "log_alpha_value": -0.0024009873159229755, "target_entropy": -6.0, "policy_t": 0.000861641950905323, "mean_q": 0.20157304406166077, "max_q": 1.4899792671203613, "min_q": 0.08327773213386536}, "td_error": [3.396261215209961, 1.9287643432617188, 4.49250602722168, 4.728420734405518, 1.0162925720214844, 1.5457508563995361, 3.1658921241760254, 2.1273367404937744, 1.4083372354507446, 3.0252432823181152, 4.449006080627441, 1.2976272106170654, 0.8319370746612549, 1.6985894441604614, 2.9534108638763428, 2.534147262573242, 4.998564720153809, 2.454202175140381, 2.3699254989624023, 2.725768566131592, 3.330965042114258, 3.103576421737671, 2.104698896408081, 1.9939417839050293, 2.575080394744873, 1.8187332153320312, 1.9959568977355957, 3.74299955368042, 2.7279250621795654, 2.9531030654907227, 2.15848970413208, 2.544767141342163, 3.2548890113830566, 3.679914951324463, 2.9026079177856445, 1.762313723564148, 2.174900770187378, 3.4118051528930664, 3.298128604888916, 2.2989776134490967, 4.049810409545898, 1.4776649475097656, 2.4864120483398438, 1.6541651487350464, 1.5410597324371338, 3.4411461353302, 2.883002281188965, 2.4383487701416016, 1.7265217304229736, 2.451972484588623, 2.5297727584838867, 1.961949110031128, 0.22845616936683655, 2.433703899383545, 1.7455520629882812, 2.9153459072113037, 4.7388105392456055, 2.5096540451049805, 2.3087103366851807, 2.4054181575775146, 1.7323625087738037, 3.65592622756958, 3.3331716060638428, 1.6501177549362183, 3.403524875640869, 2.5038726329803467, 0.9608479738235474, 3.760209321975708, 4.4992218017578125, 3.007164478302002, 2.1694960594177246, 2.1270878314971924, 1.0243394374847412, 2.920363426208496, 1.5037798881530762, 1.9488906860351562, 1.4080008268356323, 1.0082777738571167, 1.9993176460266113, 2.1257500648498535, 2.17293381690979, 2.6410739421844482, 2.1829605102539062, 1.171557903289795, 2.6074588298797607, 1.926759123802185], "mean_td_error": 2.4924848079681396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 864.0000183922908, "num_env_steps_trained_throughput_per_sec": 248.78571958170872, "timesteps_total": 8960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1027.889, "sample_time_ms": 699.387, "load_time_ms": 0.316, "load_throughput": 816976.251, "learn_time_ms": 21.075, "learn_throughput": 12242.125, "synch_weights_time_ms": 9.871}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 2322, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 2322, "last_target_update_ts": 8960, "num_target_updates": 9}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-46", "timestamp": 1700369806, "time_this_iter_s": 2.084313154220581, "time_total_s": 10.326944828033447, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742de0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.326944828033447, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 68.86666666666666, "ram_util_percent": 65.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071187019348145, "actor_loss": -4.219649314880371, "critic_loss": 3.8437681198120117, "alpha_loss": -0.030221059918403625, "alpha_value": 0.9970037341117859, "log_alpha_value": -0.0030007443856447935, "target_entropy": -6.0, "policy_t": -0.014142231084406376, "mean_q": 0.2645762264728546, "max_q": 1.6713085174560547, "min_q": 0.1386173516511917}, "td_error": [4.435756683349609, 4.156264781951904, 2.1967742443084717, 3.6171278953552246, 2.3141040802001953, 5.555357933044434, 7.104331016540527, 3.54779052734375, 5.717763900756836, 3.2002291679382324, 6.09453010559082, 6.347096920013428, 4.651688575744629, 3.6196982860565186, 5.115022659301758, 5.026188373565674, 4.437934875488281, 5.340980529785156, 5.480110168457031, 3.7216567993164062, 6.311702728271484, 4.059548377990723, 2.921348810195923, 5.149922847747803, 4.051862716674805, 3.215237617492676, 4.141547203063965, 4.815917015075684, 4.926192283630371, 6.533555030822754, 5.2308244705200195, 4.851864814758301, 4.1359758377075195, 2.5701746940612793, 3.6931731700897217, 5.599056243896484, 4.050680160522461, 5.015345573425293, 4.604780673980713, 6.540672302246094, 4.518006324768066, 6.248138427734375, 2.446354389190674, 4.371188640594482, 4.008059501647949, 2.9092226028442383, 4.024349689483643, 3.533517599105835, 4.353944778442383, 7.433436870574951, 5.046879768371582, 4.49951171875, 3.801978826522827, 5.080536365509033, 4.730268955230713, 3.7923583984375, 4.580925941467285, 4.7730560302734375, 2.2240183353424072, 4.555998802185059, 2.9212021827697754, 5.479336738586426, 6.879214763641357, 2.6293506622314453, 3.8750123977661133, 4.689274787902832, 5.142401695251465, 4.3569159507751465, 4.551627159118652, 3.0381665229797363, 4.542071342468262, 4.256951332092285, 3.3017690181732178, 4.062719345092773, 4.07589054107666, 4.402636528015137, 3.009931802749634, 5.1698713302612305, 3.2844200134277344, 5.1875152587890625, 5.670787811279297, 5.557381629943848, 3.8933513164520264, 4.278373718261719, 5.0879225730896, 5.511925220489502], "mean_td_error": 4.487065315246582, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.188718795776367, "actor_loss": -4.327538967132568, "critic_loss": 1.040055274963379, "alpha_loss": -0.030582178384065628, "alpha_value": 0.997002899646759, "log_alpha_value": -0.003001572098582983, "target_entropy": -6.0, "policy_t": 0.021678602322936058, "mean_q": 0.28973469138145447, "max_q": 1.85636305809021, "min_q": 0.14298902451992035}, "td_error": [2.2840991020202637, 3.1161632537841797, 2.6167593002319336, 2.355009078979492, 2.1004724502563477, 3.631743907928467, 3.1405394077301025, 1.5707292556762695, 3.117225170135498, 2.434044599533081, 2.4510531425476074, 2.900297164916992, 2.6430506706237793, 1.7071305513381958, 2.5668246746063232, 2.4722306728363037, 0.833088755607605, 3.6753153800964355, 2.7431302070617676, 1.5177756547927856, 1.9977363348007202, 0.6093204021453857, 1.7117375135421753, 2.132841110229492, 3.5338428020477295, 2.7237331867218018, 1.2807118892669678, 2.1467232704162598, 2.3080973625183105, 1.3354663848876953, 2.867521286010742, 2.1043334007263184, 3.736168622970581, 0.3413664698600769, 4.809356689453125, 4.023246765136719, 3.748049736022949, 0.233496755361557, 3.9447216987609863, 2.1012797355651855, 3.1425132751464844, 3.480945110321045, 3.422961473464966, 2.5858101844787598, 4.103631973266602, 3.0962390899658203, 2.773772716522217, 2.368692398071289, 2.2139105796813965, 1.1580817699432373, 1.1555850505828857, 1.617318868637085, 2.8102171421051025, 2.5128703117370605, 2.7029669284820557, 2.5353379249572754, 2.252535343170166, 1.3852561712265015, 3.080319404602051, 2.479727268218994, 1.3180160522460938, 0.10562175512313843, 2.7238733768463135, 1.2276997566223145, 0.10553079843521118, 0.9799270629882812, 4.045698642730713, 3.4055662155151367, 2.548461437225342, 2.2733139991760254, 2.071645736694336, 0.6739835739135742, 0.4367847442626953, 1.352826476097107, 2.7430148124694824, 2.2238688468933105, 1.2005302906036377, 2.043095827102661, 2.995368003845215, 4.3617143630981445, 3.1276071071624756, 1.8190943002700806, 3.2505269050598145, 4.012369632720947, 1.355502963066101, 3.558110237121582], "mean_td_error": 2.376800775527954, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082674026489258, "actor_loss": -4.195330619812012, "critic_loss": 0.8517353534698486, "alpha_loss": -0.030262596905231476, "alpha_value": 0.9970030784606934, "log_alpha_value": -0.0030014459043741226, "target_entropy": -6.0, "policy_t": -0.024938315153121948, "mean_q": 0.15791596472263336, "max_q": 1.831738829612732, "min_q": 0.11201579868793488}, "td_error": [4.566546440124512, 2.878657341003418, 3.7651922702789307, 0.5567139387130737, 1.5026895999908447, 3.505436897277832, 4.299032211303711, 1.7307478189468384, 3.0640921592712402, 3.958890199661255, 3.6141138076782227, 1.5799601078033447, 3.015133857727051, 3.708486557006836, 3.259540319442749, 3.6085801124572754, 1.3104746341705322, 1.5440607070922852, 1.6324033737182617, 3.368191719055176, 1.8356561660766602, 1.8380459547042847, 1.387303113937378, 3.479722499847412, 2.0430164337158203, 3.1990108489990234, 3.24159574508667, 3.1606903076171875, 2.7597298622131348, 4.1648993492126465, 2.086456775665283, 3.6937906742095947, 2.562816619873047, 1.9613878726959229, 2.5074210166931152, 3.488703727722168, 2.8185863494873047, 3.4493722915649414, 3.6223604679107666, 4.514867782592773, 1.3023879528045654, 2.7874033451080322, 3.2455520629882812, 3.0766849517822266, 1.4852429628372192, 1.6409138441085815, 2.674642562866211, 2.02597713470459, 3.1705057621002197, 2.8863162994384766, 1.4274669885635376, 1.9895801544189453, 1.1173346042633057, 0.6092101335525513, 3.064502239227295, 3.1735682487487793, 3.371753215789795, 2.006045341491699, 3.2513186931610107, 2.075543165206909, 1.9824953079223633, 1.1471917629241943, 3.1658365726470947, 1.4962983131408691, 2.074232578277588, 1.2838228940963745, 3.707155466079712, 4.019908905029297, 3.1693408489227295, 2.179147243499756, 3.161126136779785, 2.5801315307617188, 1.4798557758331299, 3.128307342529297, 4.230769634246826, 3.5711169242858887, 1.2692933082580566, 2.95011830329895, 0.5962094068527222, 1.1759393215179443, 0.18975304067134857, 2.6646223068237305, 1.0885987281799316, 3.542207717895508, 2.186776638031006, 1.4523448944091797], "mean_td_error": 2.5599875450134277, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 955.3881975975831, "num_env_steps_trained_throughput_per_sec": 275.10061939751836, "timesteps_total": 10752, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 987.991, "sample_time_ms": 691.325, "load_time_ms": 0.315, "load_throughput": 818679.401, "learn_time_ms": 18.505, "learn_throughput": 13941.818, "synch_weights_time_ms": 9.966}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 2838, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 2838, "last_target_update_ts": 10752, "num_target_updates": 11}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-48", "timestamp": 1700369808, "time_this_iter_s": 1.8841729164123535, "time_total_s": 12.2111177444458, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 12.2111177444458, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 67.06666666666666, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118391990661621, "actor_loss": -4.284487724304199, "critic_loss": 3.5878207683563232, "alpha_loss": -0.033399347215890884, "alpha_value": 0.9967045783996582, "log_alpha_value": -0.0033008551690727472, "target_entropy": -6.0, "policy_t": -0.009574268013238907, "mean_q": 0.2722897529602051, "max_q": 1.9162534475326538, "min_q": 0.15881697833538055}, "td_error": [5.203802108764648, 4.940427780151367, 4.893489360809326, 3.973263740539551, 3.801891803741455, 3.7887790203094482, 6.698676109313965, 3.1127333641052246, 3.9226388931274414, 5.388874053955078, 4.310507774353027, 4.612234115600586, 3.372574806213379, 2.902656078338623, 3.4266839027404785, 3.6247012615203857, 4.288102149963379, 4.514830589294434, 4.44398832321167, 3.652036190032959, 4.364921569824219, 0.9543532729148865, 3.852766513824463, 2.1478123664855957, 6.37261438369751, 3.89280366897583, 4.760157585144043, 6.668427467346191, 5.313464164733887, 4.859548568725586, 2.762739419937134, 4.894830703735352, 5.212873458862305, 4.418249130249023, 4.76402473449707, 5.2851152420043945, 3.5372262001037598, 2.941446542739868, 3.224966049194336, 3.442566394805908, 4.686555862426758, 3.798823356628418, 5.614437103271484, 3.6117372512817383, 3.4867048263549805, 3.865875244140625, 3.1412930488586426, 6.7764177322387695, 4.6034255027771, 3.457056999206543, 3.9390006065368652, 4.1096954345703125, 5.245772838592529, 4.9271955490112305, 3.544156789779663, 1.7561850547790527, 4.796164512634277, 4.030556678771973, 3.956770420074463, 4.129996299743652, 5.427857875823975, 4.715381145477295, 4.934566974639893, 5.268973350524902, 1.9588465690612793, 6.441965103149414, 5.5130534172058105, 2.9148995876312256, 4.454314231872559, 6.758264541625977, 2.9266538619995117, 1.9699342250823975, 1.7306342124938965, 2.7681057453155518, 4.885009288787842, 5.7003173828125, 3.807659149169922, 5.732638359069824, 4.309272766113281, 4.728436470031738, 4.75225830078125, 3.547776460647583, 4.37574577331543, 4.130370140075684, 2.222031354904175, 6.421385765075684], "mean_td_error": 4.237418174743652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090633392333984, "actor_loss": -4.251284599304199, "critic_loss": 1.1494401693344116, "alpha_loss": -0.03331848233938217, "alpha_value": 0.9967035055160522, "log_alpha_value": -0.003301922231912613, "target_entropy": -6.0, "policy_t": 0.032142523676157, "mean_q": 0.3033722937107086, "max_q": 2.1340200901031494, "min_q": 0.16370700299739838}, "td_error": [1.8076317310333252, 3.164158582687378, 1.9710700511932373, 1.249840497970581, 1.645435094833374, 2.8866634368896484, 3.042982578277588, 0.624694287776947, 1.2407069206237793, 2.067850112915039, 1.5241172313690186, 3.725463628768921, 2.8099875450134277, 2.4846673011779785, 2.270482301712036, 2.256990909576416, 2.497145652770996, 1.3303172588348389, 1.5189464092254639, 3.143059730529785, 3.662540912628174, 3.7343735694885254, 3.6250452995300293, 1.5542473793029785, 2.260336399078369, 2.5187370777130127, 3.5021557807922363, 2.3713903427124023, 3.1434009075164795, 1.3514784574508667, 3.731736660003662, 3.5942234992980957, 1.242375373840332, 3.5248990058898926, 4.016534805297852, 2.4362125396728516, 3.096421718597412, 4.357859134674072, 3.1625685691833496, 2.7196903228759766, 3.0556859970092773, 2.793102741241455, 3.1443910598754883, 2.400692939758301, 1.7787973880767822, 0.9936740398406982, 3.027400016784668, 3.186310291290283, 5.862576007843018, 4.225467681884766, 2.5416905879974365, 2.4112281799316406, 1.3228332996368408, 3.70212459564209, 1.081396460533142, 1.3138270378112793, 2.9217095375061035, 2.3547208309173584, 1.7402987480163574, 3.8864808082580566, 0.8490976691246033, 3.7653651237487793, 2.078369140625, 2.2819020748138428, 1.3910613059997559, 3.1934640407562256, 0.4735320806503296, 1.6093664169311523, 3.726952075958252, 2.0321998596191406, 2.0343198776245117, 2.6398189067840576, 3.011509895324707, 1.4321675300598145, 2.986647844314575, 3.227877616882324, 3.8673417568206787, 4.523750305175781, 2.6431689262390137, 2.4598965644836426, 0.028906799852848053, 3.033018112182617, 2.154484987258911, 3.095851421356201, 2.8633971214294434, 0.1518900990486145], "mean_td_error": 2.536839723587036, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144927024841309, "actor_loss": -4.268560886383057, "critic_loss": 0.740971565246582, "alpha_loss": -0.03349461778998375, "alpha_value": 0.9967038035392761, "log_alpha_value": -0.0033016125671565533, "target_entropy": -6.0, "policy_t": -0.019960137084126472, "mean_q": 0.23055076599121094, "max_q": 2.0831518173217773, "min_q": 0.12799394130706787}, "td_error": [2.4030981063842773, 2.3975448608398438, 2.8753585815429688, 1.6818102598190308, 3.7976417541503906, 1.8353452682495117, 2.696682929992676, 2.7944388389587402, 0.694557249546051, 3.7642569541931152, 3.470515251159668, 4.140830993652344, 3.8183865547180176, 3.336421012878418, 3.829848289489746, 0.10538292676210403, 3.464024543762207, 2.793789863586426, 1.1026394367218018, 2.5982680320739746, 3.3356075286865234, 1.838073968887329, 0.1286933422088623, 4.760688781738281, 2.739192485809326, 4.600043296813965, 1.708884596824646, 2.5339715480804443, 2.3126378059387207, 2.436527729034424, 1.7518808841705322, 2.2641310691833496, 2.9442014694213867, 2.4876203536987305, 0.4970906972885132, 1.1781904697418213, 2.5474934577941895, 2.2378177642822266, 2.155879497528076, 2.960771322250366, 1.3058032989501953, 3.602825403213501, 2.7497787475585938, 1.7497222423553467, 2.6022112369537354, 1.744783878326416, 2.2366185188293457, 1.8370466232299805, 0.8037521839141846, 0.5104498863220215, 2.354464054107666, 1.889959692955017, 1.2998822927474976, 1.412063479423523, 1.151399850845337, 2.5411667823791504, 3.2470192909240723, 3.0169529914855957, 0.8807136416435242, 1.6123061180114746, 3.2244176864624023, 1.302494764328003, 0.47728341817855835, 3.7779946327209473, 1.827174425125122, 2.880795478820801, 0.9536149501800537, 3.5196175575256348, 2.825009346008301, 2.897095203399658, 1.99922776222229, 0.4417595863342285, 3.730257272720337, 0.05620918422937393, 1.9185242652893066, 2.4504196643829346, 0.35447776317596436, 3.516281843185425, 1.9821895360946655, 0.7159253358840942, 2.1910152435302734, 3.733658790588379, 1.8050189018249512, 4.577366828918457, 3.1961166858673096, 1.4843634366989136], "mean_td_error": 2.295435667037964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 756.174167515446, "num_env_steps_trained_throughput_per_sec": 217.73765091404584, "timesteps_total": 11648, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1008.008, "sample_time_ms": 710.745, "load_time_ms": 0.314, "load_throughput": 822350.051, "learn_time_ms": 18.336, "learn_throughput": 14070.472, "synch_weights_time_ms": 10.123}, "counters": {"num_env_steps_sampled": 11648, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 3096, "last_target_update_ts": 11648, "num_target_updates": 12}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-49", "timestamp": 1700369809, "time_this_iter_s": 1.1944808959960938, "time_total_s": 13.405598640441895, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.405598640441895, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.85, "ram_util_percent": 65.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093945503234863, "actor_loss": -4.288473129272461, "critic_loss": 3.5230350494384766, "alpha_loss": -0.036348793655633926, "alpha_value": 0.9964054226875305, "log_alpha_value": -0.003601048607379198, "target_entropy": -6.0, "policy_t": 0.0016606810968369246, "mean_q": 0.30134710669517517, "max_q": 2.183018445968628, "min_q": 0.18051360547542572}, "td_error": [4.441257476806641, 5.751859664916992, 5.052282333374023, 2.6079399585723877, 3.1608493328094482, 3.832305908203125, 4.474204063415527, 4.759222030639648, 6.121176719665527, 2.629225015640259, 4.383234024047852, 5.2325439453125, 3.3831844329833984, 4.7963361740112305, 3.95803165435791, 6.049490928649902, 3.425968647003174, 3.094973087310791, 5.222036838531494, 4.127433776855469, 4.953012466430664, 4.087234020233154, 3.3759825229644775, 5.953036785125732, 3.695145606994629, 5.232065200805664, 4.124366283416748, 4.865103244781494, 3.8109827041625977, 5.184517860412598, 2.7575736045837402, 4.113494873046875, 4.874628067016602, 5.836787223815918, 3.7429234981536865, 1.3751142024993896, 5.388880729675293, 3.8625245094299316, 3.464510440826416, 6.821981430053711, 4.840919494628906, 4.500192642211914, 1.3386330604553223, 1.7732126712799072, 4.0499677658081055, 4.101461410522461, 4.547901630401611, 5.430863857269287, 3.9122233390808105, 3.362269401550293, 4.423102855682373, 4.697383880615234, 4.9947052001953125, 4.87507438659668, 3.3416152000427246, 4.389339447021484, 4.94022274017334, 3.9539856910705566, 5.339853763580322, 3.684011459350586, 4.194146156311035, 4.65017032623291, 3.3588781356811523, 4.58975076675415, 5.190440654754639, 4.460511207580566, 4.98544979095459, 3.482846260070801, 3.7559497356414795, 2.5326590538024902, 6.145642280578613, 5.604028701782227, 3.450863838195801, 3.3163437843322754, 3.5529303550720215, 5.735548973083496, 2.930112361907959, 3.356287717819214, 4.277956008911133, 3.1009275913238525, 3.9193453788757324, 5.372133255004883, 2.0735199451446533, 4.365860462188721, 4.175515174865723, 6.398702144622803], "mean_td_error": 4.249963760375977, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077886581420898, "actor_loss": -4.259941101074219, "critic_loss": 0.8572835922241211, "alpha_loss": -0.03630245476961136, "alpha_value": 0.9964042901992798, "log_alpha_value": -0.0036021892447024584, "target_entropy": -6.0, "policy_t": -0.013078839518129826, "mean_q": 0.23984846472740173, "max_q": 1.7867891788482666, "min_q": 0.18609678745269775}, "td_error": [3.4136416912078857, 4.007054328918457, 2.840914249420166, 2.2006826400756836, 2.8483221530914307, 3.656756639480591, 0.7736015915870667, 1.9525871276855469, 5.287579536437988, 3.508305549621582, 2.280205726623535, 1.9234833717346191, 3.1703078746795654, 2.3116960525512695, 2.0166988372802734, 2.863327980041504, 2.678605079650879, 2.626251220703125, 1.305321216583252, 2.2637405395507812, 3.5188770294189453, 3.1971168518066406, 1.8910281658172607, 1.5070927143096924, 0.4436119794845581, 3.052661418914795, 2.466949224472046, 0.506502091884613, 1.538265347480774, 1.8495399951934814, 0.9468084573745728, 2.0974974632263184, 3.265167713165283, 3.2551350593566895, 1.7098608016967773, 2.994987726211548, 1.1473290920257568, 4.727768898010254, 3.9080493450164795, 2.7312018871307373, 2.94626784324646, 3.656749963760376, 3.50942063331604, 2.4046332836151123, 3.2966198921203613, 3.610274076461792, 3.148505449295044, 2.9006664752960205, 2.6183037757873535, 3.7408981323242188, 1.5102286338806152, 1.7689478397369385, 3.2493515014648438, 2.207648754119873, 4.058260917663574, 0.9516493082046509, 3.506159543991089, 1.043656349182129, 4.6982421875, 2.7287209033966064, 1.9626538753509521, 1.6925690174102783, 2.902479887008667, 2.8911168575286865, 3.919368267059326, 2.873171329498291, 2.915530204772949, 2.092209577560425, 2.72027587890625, 2.616619110107422, 3.7381625175476074, 2.823702573776245, 2.2495803833007812, 4.057143211364746, 2.108830690383911, 2.062668800354004, 4.7432026863098145, 1.4347610473632812, 1.6522955894470215, 2.36568021774292, 2.348878860473633, 1.0081989765167236, 0.645175039768219, 3.5219531059265137, 1.6256458759307861, 1.5830919742584229], "mean_td_error": 2.5906360149383545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063884735107422, "actor_loss": -4.20652961730957, "critic_loss": 0.8289215564727783, "alpha_loss": -0.03624862805008888, "alpha_value": 0.9964046478271484, "log_alpha_value": -0.0036018521059304476, "target_entropy": -6.0, "policy_t": -0.008756501600146294, "mean_q": 0.24713294208049774, "max_q": 2.5801048278808594, "min_q": 0.1452012062072754}, "td_error": [2.0960283279418945, 2.1921887397766113, 3.9595084190368652, 4.921418190002441, 3.873572826385498, 1.892953872680664, 1.5390006303787231, 1.504544973373413, 3.412980556488037, 0.8410391807556152, 0.15579932928085327, 2.1287641525268555, 2.2848052978515625, 3.7924814224243164, 2.0270304679870605, 4.145264625549316, 2.7602601051330566, 2.2356491088867188, 1.7684943675994873, 1.1531164646148682, 2.034128189086914, 2.5234551429748535, 1.7034492492675781, 2.094193458557129, 2.6904945373535156, 3.7766075134277344, 3.2005486488342285, 0.17320697009563446, 3.615457773208618, 3.5554027557373047, 1.529525876045227, 0.7671886682510376, 2.922618865966797, 2.3839268684387207, 3.2635388374328613, 3.4619150161743164, 2.4096198081970215, 1.3938969373703003, 3.8407676219940186, 0.1288752555847168, 3.260939121246338, 2.8647685050964355, 2.2760844230651855, 3.1345224380493164, 3.2480878829956055, 0.7928334474563599, 3.0250802040100098, 3.9533164501190186, 3.385718822479248, 2.490694522857666, 2.161074638366699, 1.8607518672943115, 2.262402057647705, 3.2544679641723633, 2.7661404609680176, 4.197332859039307, 2.8726117610931396, 0.604089617729187, 2.643986701965332, 1.1999760866165161, 2.622682809829712, 0.4539541006088257, 3.9541873931884766, 1.4149667024612427, 3.49906063079834, 1.7563546895980835, 5.023088455200195, 4.496923923492432, 2.030177593231201, 1.3905800580978394, 3.8967742919921875, 2.635934352874756, 2.5323657989501953, 0.9938054084777832, 4.20377779006958, 1.378279209136963, 1.048195719718933, 3.8084840774536133, 1.8145619630813599, 3.0009355545043945, 2.830052375793457, 2.9845571517944336, 2.9206738471984863, 2.480160713195801, 1.3287286758422852, 1.4778635501861572], "mean_td_error": 2.4928572177886963, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 689.9472389324415, "num_env_steps_trained_throughput_per_sec": 198.6678433533146, "timesteps_total": 12544, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1029.179, "sample_time_ms": 743.133, "load_time_ms": 0.313, "load_throughput": 825171.902, "learn_time_ms": 18.297, "learn_throughput": 14100.54, "synch_weights_time_ms": 9.983}, "counters": {"num_env_steps_sampled": 12544, "num_env_steps_trained": 3354, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 3354, "last_target_update_ts": 12544, "num_target_updates": 13}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-50", "timestamp": 1700369810, "time_this_iter_s": 1.3075599670410156, "time_total_s": 14.71315860748291, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 14.71315860748291, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 74.5, "ram_util_percent": 65.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056724548339844, "actor_loss": -4.306741237640381, "critic_loss": 3.4842708110809326, "alpha_loss": -0.04225319251418114, "alpha_value": 0.9958073496818542, "log_alpha_value": -0.004201486241072416, "target_entropy": -6.0, "policy_t": 0.005544004030525684, "mean_q": 0.27230510115623474, "max_q": 1.7895641326904297, "min_q": 0.22882413864135742}, "td_error": [2.6503379344940186, 4.346037864685059, 2.688958168029785, 4.506125450134277, 2.9922571182250977, 4.598565101623535, 4.194509983062744, 3.066333293914795, 3.8892412185668945, 5.156527519226074, 3.530809164047241, 3.6040420532226562, 3.476485013961792, 4.302807807922363, 6.467199325561523, 4.427646160125732, 4.994441509246826, 2.247903347015381, 4.484172821044922, 4.5535688400268555, 3.7707009315490723, 4.512430191040039, 5.3472394943237305, 5.286402702331543, 4.411601543426514, 5.074902057647705, 4.0581135749816895, 4.1168670654296875, 4.645673751831055, 4.670717239379883, 4.622140884399414, 3.666584014892578, 3.340571880340576, 4.428593635559082, 4.8775634765625, 4.012411594390869, 3.5200867652893066, 6.9541120529174805, 4.3895745277404785, 2.6120200157165527, 4.245711326599121, 4.797010898590088, 3.3469009399414062, 3.743399143218994, 4.980158805847168, 5.197961807250977, 5.168595314025879, 5.234830856323242, 3.971160411834717, 4.654183387756348, 4.650101661682129, 4.702114582061768, 3.8158326148986816, 2.918609142303467, 3.6552371978759766, 3.9898734092712402, 3.9462618827819824, 4.099490165710449, 4.491971015930176, 6.120967864990234, 5.5423054695129395, 4.000335693359375, 2.790715217590332, 3.8733065128326416, 5.401162147521973, 5.242348670959473, 4.430832862854004, 3.3486838340759277, 3.310262680053711, 5.133063793182373, 6.336592674255371, 4.881267547607422, 3.453462600708008, 4.579859733581543, 3.0199623107910156, 4.060877799987793, 2.1895554065704346, 2.9392919540405273, 6.885775566101074, 5.229389190673828, 3.621105909347534, 4.657296180725098, 3.65576434135437, 5.026518821716309, 3.2027106285095215, 2.3724851608276367], "mean_td_error": 4.248971462249756, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064763069152832, "actor_loss": -4.296075820922852, "critic_loss": 0.7635546922683716, "alpha_loss": -0.04229777306318283, "alpha_value": 0.9958062767982483, "log_alpha_value": -0.004202560521662235, "target_entropy": -6.0, "policy_t": -0.003826823551207781, "mean_q": 0.35500848293304443, "max_q": 2.7995758056640625, "min_q": 0.2347472608089447}, "td_error": [2.5177268981933594, 1.8963074684143066, 1.0418754816055298, 2.0720813274383545, 4.5640482902526855, 1.3146553039550781, 2.1495556831359863, 2.7936830520629883, 2.0355212688446045, 3.3238017559051514, 2.409444808959961, 1.795957088470459, 1.516491174697876, 2.592484474182129, 1.125049352645874, 3.089385986328125, 2.4615402221679688, 2.2145183086395264, 0.787317156791687, 1.4558451175689697, 2.476166248321533, 3.1372382640838623, 2.739448070526123, 1.5027954578399658, 1.4022060632705688, 1.7052531242370605, 2.4677343368530273, 3.7863950729370117, 2.959730625152588, 0.4200458526611328, 2.3348233699798584, 2.172802448272705, 2.488462448120117, 5.071598529815674, 1.6681721210479736, 3.983170509338379, 3.1123032569885254, 0.5240063667297363, 2.1446480751037598, 3.5290191173553467, 1.868058681488037, 2.738368034362793, 2.7897396087646484, 2.3594160079956055, 0.9731557369232178, 2.7630271911621094, 1.5405330657958984, 2.571258068084717, 2.982436180114746, 3.8749136924743652, 2.497971534729004, 2.1269052028656006, 2.73734450340271, 2.522427797317505, 3.671086311340332, 0.9964756369590759, 2.390559196472168, 2.236604690551758, 2.9997239112854004, 0.3584495782852173, 2.5549638271331787, 0.5995011925697327, 3.8903870582580566, 0.8236185312271118, 1.1684682369232178, 2.0365383625030518, 1.71945059299469, 0.7827450633049011, 1.7301764488220215, 1.5894501209259033, 2.1847422122955322, 4.517148017883301, 2.4847443103790283, 3.045389175415039, 1.0712212324142456, 2.098437786102295, 1.9209181070327759, 2.4191484451293945, 2.590067148208618, 1.9329869747161865, 3.160597562789917, 3.4893739223480225, 2.3714513778686523, 2.5706701278686523, 3.42012619972229, 3.0774788856506348], "mean_td_error": 2.3143205642700195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132457733154297, "actor_loss": -4.311014652252197, "critic_loss": 0.8276087641716003, "alpha_loss": -0.042577195912599564, "alpha_value": 0.9958067536354065, "log_alpha_value": -0.004202059470117092, "target_entropy": -6.0, "policy_t": -0.003291686298325658, "mean_q": 0.32173392176628113, "max_q": 3.1710567474365234, "min_q": 0.18312013149261475}, "td_error": [4.276393890380859, 1.790944218635559, 2.988654136657715, 4.131573677062988, 2.6690797805786133, 1.5771993398666382, 3.133030891418457, 2.6207199096679688, 0.43844348192214966, 3.636871814727783, 2.1549320220947266, 3.145587921142578, 1.4981348514556885, 1.8148252964019775, 4.1649322509765625, 2.531342029571533, 1.3939507007598877, 3.5599942207336426, 4.234047889709473, 2.724033832550049, 1.623823881149292, 3.269496440887451, 3.6915745735168457, 2.108794927597046, 2.0034406185150146, 0.8885983228683472, 1.3088605403900146, 1.2741187810897827, 2.344265937805176, 3.05464506149292, 1.2256972789764404, 1.6807339191436768, 1.2223567962646484, 1.9039645195007324, 3.3381834030151367, 2.4872865676879883, 1.9904239177703857, 2.1561079025268555, 3.7094240188598633, 3.1761770248413086, 3.233461856842041, 4.431397438049316, 3.0435500144958496, 2.6317856311798096, 3.370084762573242, 0.19761371612548828, 3.280829429626465, 1.2122619152069092, 3.0661816596984863, 1.9235975742340088, 2.1399879455566406, 3.983700752258301, 2.431528091430664, 3.2927355766296387, 1.4087045192718506, 2.067953109741211, 2.7539501190185547, 0.1496140956878662, 3.425687551498413, 3.3843579292297363, 1.803553819656372, 2.3046011924743652, 2.270082950592041, 3.4387571811676025, 3.192375421524048, 2.800713062286377, 0.6169260740280151, 3.1516427993774414, 5.201859951019287, 2.18179988861084, 1.0871827602386475, 2.678234577178955, 2.9721426963806152, 0.9855055212974548, 3.158128261566162, 3.0186376571655273, 1.8856267929077148, 3.360760450363159, 2.58981990814209, 3.0242018699645996, 0.20437315106391907, 4.4009246826171875, 1.8888287544250488, 3.4345521926879883, 1.9977408647537231, 2.889988422393799], "mean_td_error": 2.522216558456421, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 917.6768485568022, "num_env_steps_trained_throughput_per_sec": 264.2417711246149, "timesteps_total": 14336, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1033.509, "sample_time_ms": 749.1, "load_time_ms": 0.314, "load_throughput": 822600.1, "learn_time_ms": 18.053, "learn_throughput": 14291.607, "synch_weights_time_ms": 9.857}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 3870, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 3870, "last_target_update_ts": 14336, "num_target_updates": 15}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-52", "timestamp": 1700369812, "time_this_iter_s": 1.9607419967651367, "time_total_s": 16.673900604248047, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.673900604248047, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 75.65, "ram_util_percent": 66.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088200569152832, "actor_loss": -4.361648082733154, "critic_loss": 3.4277267456054688, "alpha_loss": -0.04541363567113876, "alpha_value": 0.9955084323883057, "log_alpha_value": -0.004501659423112869, "target_entropy": -6.0, "policy_t": -0.003836955176666379, "mean_q": 0.3816259205341339, "max_q": 2.274351119995117, "min_q": 0.25543883442878723}, "td_error": [2.3930201530456543, 5.189255237579346, 5.069693565368652, 3.611595630645752, 3.1451168060302734, 3.3604323863983154, 1.6962627172470093, 5.1696929931640625, 3.3800787925720215, 3.3188014030456543, 3.2631616592407227, 5.598690986633301, 3.06480073928833, 4.7540388107299805, 3.6642346382141113, 3.9523699283599854, 4.189496040344238, 0.33061641454696655, 4.726899147033691, 3.8718483448028564, 4.7571120262146, 3.822288751602173, 3.9605462551116943, 4.0263261795043945, 5.791171073913574, 4.282114028930664, 5.297750473022461, 4.159850120544434, 4.880125045776367, 4.246332168579102, 3.3507046699523926, 5.656185150146484, 2.224297046661377, 6.356867790222168, 4.289778709411621, 3.9177684783935547, 5.047708988189697, 3.5169992446899414, 3.3082070350646973, 4.278762340545654, 3.5458450317382812, 5.146309852600098, 4.593536853790283, 3.805372476577759, 4.1853742599487305, 4.806214332580566, 2.3066329956054688, 3.289093017578125, 4.489409446716309, 3.4469432830810547, 5.590925216674805, 1.9622068405151367, 4.096589088439941, 5.536076545715332, 2.6762027740478516, 5.702785968780518, 4.486405372619629, 4.2498931884765625, 5.168356895446777, 5.943506240844727, 5.948261260986328, 4.336965560913086, 3.238116502761841, 4.599495887756348, 5.885457992553711, 4.028973579406738, 3.564823865890503, 5.057742595672607, 4.883414268493652, 6.289431095123291, 4.007632732391357, 6.588418960571289, 2.700758457183838, 3.0760092735290527, 2.868281841278076, 4.65053653717041, 1.582547903060913, 5.7993011474609375, 3.1708438396453857, 5.700447082519531, 6.034499645233154, 4.470754623413086, 5.244338035583496, 5.233900547027588, 3.6762912273406982, 4.642184257507324], "mean_td_error": 4.2235822677612305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105732917785645, "actor_loss": -4.359213829040527, "critic_loss": 0.8038796186447144, "alpha_loss": -0.04550260677933693, "alpha_value": 0.9955074787139893, "log_alpha_value": -0.004502652678638697, "target_entropy": -6.0, "policy_t": 0.0401800163090229, "mean_q": 0.3756555914878845, "max_q": 3.4055607318878174, "min_q": 0.261172890663147}, "td_error": [1.9724829196929932, 1.384106159210205, 3.9951188564300537, 4.831207752227783, 3.449690341949463, 2.564958333969116, 2.978278636932373, 2.508326530456543, 2.230281114578247, 2.173455238342285, 3.7547078132629395, 2.768461227416992, 1.0530049800872803, 2.095266580581665, 1.6922677755355835, 2.6535768508911133, 1.522695541381836, 3.522536039352417, 3.2830276489257812, 0.3941691517829895, 2.762160301208496, 2.3356828689575195, 1.5265073776245117, 0.21378552913665771, 1.7216448783874512, 1.4110631942749023, 1.3714953660964966, 2.262428045272827, 2.702364444732666, 2.974573850631714, 2.433952808380127, 1.7860262393951416, 1.9871947765350342, 2.8102951049804688, 3.611736536026001, 0.866863489151001, 2.846001625061035, 2.3476033210754395, 2.3524465560913086, 1.7095342874526978, 3.273507833480835, 0.924704372882843, 2.740098476409912, 2.6001713275909424, 2.0403599739074707, 1.7954777479171753, 2.3996472358703613, 4.614556789398193, 4.390768051147461, 1.3758149147033691, 2.2755250930786133, 3.454477071762085, 3.504591464996338, 1.596410870552063, 3.9519762992858887, 4.742069244384766, 2.061328411102295, 1.0860451459884644, 1.971818447113037, 1.9706220626831055, 2.2254157066345215, 3.6424121856689453, 3.1864328384399414, 1.3305822610855103, 2.7024617195129395, 0.45835456252098083, 2.3304426670074463, 2.917538642883301, 2.2454185485839844, 2.3926949501037598, 2.583219528198242, 1.9466828107833862, 3.16410493850708, 5.322373390197754, 2.0599474906921387, 0.6462144255638123, 1.1166529655456543, 1.2442376613616943, 3.5327305793762207, 3.4902358055114746, 3.5524532794952393, 2.5961532592773438, 2.5197982788085938, 2.301969051361084, 1.8537133932113647, 2.633835792541504], "mean_td_error": 2.43752384185791, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.119498252868652, "actor_loss": -4.319911479949951, "critic_loss": 0.7642912268638611, "alpha_loss": -0.045559823513031006, "alpha_value": 0.9955079555511475, "log_alpha_value": -0.0045021818950772285, "target_entropy": -6.0, "policy_t": -0.017746390774846077, "mean_q": 0.2882305681705475, "max_q": 2.2266452312469482, "min_q": 0.20403152704238892}, "td_error": [2.4341771602630615, 0.23157867789268494, 2.660844326019287, 2.1373450756073, 3.088942050933838, 2.802325963973999, 1.9443583488464355, 2.7606375217437744, 2.423131227493286, 2.6410491466522217, 3.2303085327148438, 4.774818420410156, 0.6966944932937622, 0.919521689414978, 2.5481159687042236, 2.565107822418213, 1.6159484386444092, 3.6656837463378906, 3.919994831085205, 4.551209449768066, 1.4985628128051758, 0.8594425916671753, 2.413163185119629, 3.3277153968811035, 1.4767475128173828, 2.8454675674438477, 2.849085807800293, 2.925304889678955, 3.3845374584198, 2.191028118133545, 2.291132926940918, 4.443485736846924, 0.9604518413543701, 1.1576087474822998, 2.8697566986083984, 1.796459436416626, 2.091604232788086, 2.2067508697509766, 0.8459548950195312, 3.130613327026367, 3.662616729736328, 0.46343907713890076, 2.0665993690490723, 2.529160499572754, 1.9049330949783325, 3.319491386413574, 2.051603317260742, 2.567218065261841, 2.859970808029175, 1.7963902950286865, 2.976693630218506, 2.531893253326416, 2.734771728515625, 3.1265549659729004, 1.5851255655288696, 2.824643850326538, 0.2786252498626709, 2.312410831451416, 3.72505521774292, 2.6538193225860596, 3.5469729900360107, 2.974483013153076, 3.324493408203125, 4.681712627410889, 2.5802040100097656, 0.6984255313873291, 1.2897891998291016, 0.1836896538734436, 0.44841575622558594, 1.6929152011871338, 2.143630266189575, 1.488126277923584, 2.574263095855713, 2.699014663696289, 1.3423511981964111, 2.435183525085449, 3.7449162006378174, 0.15646469593048096, 4.58767032623291, 2.0332190990448, 0.5926152467727661, 3.655752182006836, 0.8576771020889282, 3.39456844329834, 2.5213632583618164, 3.030975818634033], "mean_td_error": 2.3700764179229736, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 774.2753477505282, "num_env_steps_trained_throughput_per_sec": 222.9498211156655, "timesteps_total": 15232, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1049.571, "sample_time_ms": 747.721, "load_time_ms": 0.313, "load_throughput": 823664.509, "learn_time_ms": 18.087, "learn_throughput": 14264.572, "synch_weights_time_ms": 10.202}, "counters": {"num_env_steps_sampled": 15232, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 4128, "last_target_update_ts": 15232, "num_target_updates": 16}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-53", "timestamp": 1700369813, "time_this_iter_s": 1.1644628047943115, "time_total_s": 17.83836340904236, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8d60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 17.83836340904236, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 71.15, "ram_util_percent": 65.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059000968933105, "actor_loss": -4.396553993225098, "critic_loss": 2.5679807662963867, "alpha_loss": -0.05132201686501503, "alpha_value": 0.9949108958244324, "log_alpha_value": -0.005102098919451237, "target_entropy": -6.0, "policy_t": 0.026301823556423187, "mean_q": 0.5139933824539185, "max_q": 3.4780843257904053, "min_q": 0.31391772627830505}, "td_error": [3.929168224334717, 4.847616672515869, 4.019624710083008, 3.613443613052368, 4.738626480102539, 4.596322536468506, 4.310900688171387, 4.228549480438232, 4.822056293487549, 4.066666603088379, 3.3407459259033203, 4.574457168579102, 3.122058153152466, 2.1183857917785645, 2.8716394901275635, 5.437636375427246, 4.28403377532959, 4.860750198364258, 4.738438606262207, 1.0688693523406982, 3.320845603942871, 4.120486259460449, 2.5845580101013184, 5.647514343261719, 1.2987432479858398, 4.570043563842773, 5.625901222229004, 5.77336311340332, 2.8872060775756836, 4.209153652191162, 5.799655914306641, 5.472189903259277, 3.583543062210083, 5.895350456237793, 3.8558926582336426, 3.951448440551758, 4.529208183288574, 5.553903579711914, 3.869032859802246, 4.719931602478027, 3.029449701309204, 5.540924072265625, 4.256001949310303, 4.988472938537598, 5.348236083984375, 4.345686912536621, 3.6715307235717773, 2.2100157737731934, 2.7321395874023438, 2.4549059867858887, 4.80752420425415, 4.489042282104492, 3.1603164672851562, 4.2931318283081055, 2.3180954456329346, 2.916436195373535, 5.348899841308594, 3.224151134490967, 2.9628467559814453, 0.5491536855697632, 5.719137191772461, 4.028513431549072, 3.6913397312164307, 5.946154594421387, 4.207459449768066, 3.2955117225646973, 4.067739486694336, 5.227754592895508, 5.365964889526367, 4.292834281921387, 3.4423763751983643, 3.9663188457489014, 2.994077205657959, 2.074782371520996, 2.6353840827941895, 4.951474189758301, 2.4640932083129883, 3.3903396129608154, 3.2387402057647705, 5.710723400115967, 5.167638778686523, 1.879852533340454, 5.327107906341553, 4.1816325187683105, 3.506706714630127, 5.79637336730957], "mean_td_error": 4.02412748336792, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085865020751953, "actor_loss": -4.4009480476379395, "critic_loss": 0.8404062986373901, "alpha_loss": -0.05146608129143715, "alpha_value": 0.9949101805686951, "log_alpha_value": -0.0051027932204306126, "target_entropy": -6.0, "policy_t": 0.03343246877193451, "mean_q": 0.460129052400589, "max_q": 3.725308656692505, "min_q": 0.3187509775161743}, "td_error": [2.4076907634735107, 2.707868814468384, 2.1342878341674805, 1.8375962972640991, 2.5604043006896973, 2.457566738128662, 3.8085803985595703, 1.869113802909851, 3.1912264823913574, 4.903710842132568, 2.7703304290771484, 3.494765281677246, 1.1988131999969482, 1.7149524688720703, 3.257540225982666, 3.438058853149414, 4.315718173980713, 0.9764578342437744, 2.5595321655273438, 1.8939013481140137, 2.008052110671997, 0.3029974102973938, 2.5682098865509033, 3.9601054191589355, 1.786991000175476, 1.3783273696899414, 2.349050760269165, 1.2854175567626953, 3.098687171936035, 3.458522319793701, 3.105621337890625, 2.262924909591675, 2.235868453979492, 2.714064598083496, 1.2199686765670776, 2.0515847206115723, 2.9218380451202393, 2.8082358837127686, 0.6690170764923096, 2.821676015853882, 2.6632437705993652, 1.0274349451065063, 2.7813453674316406, 2.1758458614349365, 2.043635368347168, 3.872685432434082, 2.806122303009033, 2.0249452590942383, 3.5860676765441895, 3.251161575317383, 1.884857177734375, 2.7241451740264893, 1.275780200958252, 3.896024465560913, 2.0830330848693848, 1.6799123287200928, 3.2893757820129395, 1.681532382965088, 3.8451695442199707, 0.5061095952987671, 2.302340507507324, 1.9591944217681885, 2.131932020187378, 3.4706783294677734, 3.2290468215942383, 1.802632451057434, 3.5268516540527344, 1.169982671737671, 0.5923943519592285, 2.843963384628296, 3.691399335861206, 2.8845419883728027, 2.469215154647827, 1.1846314668655396, 1.6898729801177979, 3.1819543838500977, 3.374734401702881, 3.4406514167785645, 4.665653705596924, 2.565622329711914, 2.7429182529449463, 4.6129302978515625, 3.138754367828369, 3.27670955657959, 3.809635639190674, 0.6272343397140503], "mean_td_error": 2.5347580909729004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071342468261719, "actor_loss": -4.322722434997559, "critic_loss": 0.7417157888412476, "alpha_loss": -0.05138920620083809, "alpha_value": 0.994910478591919, "log_alpha_value": -0.005102518480271101, "target_entropy": -6.0, "policy_t": -0.003812610637396574, "mean_q": 0.3765336275100708, "max_q": 4.073840141296387, "min_q": 0.24987158179283142}, "td_error": [1.8935210704803467, 0.4824126660823822, 0.5866881608963013, 2.4749062061309814, 2.6939878463745117, 2.7931485176086426, 3.0621328353881836, 1.7916133403778076, 0.23624107241630554, 3.139261245727539, 1.2774958610534668, 0.6437544822692871, 2.922665596008301, 3.2976999282836914, 3.5408029556274414, 2.2350354194641113, 1.670546293258667, 1.1523172855377197, 3.8886404037475586, 2.386340618133545, 1.1966042518615723, 4.0198445320129395, 2.9902877807617188, 3.755239248275757, 3.0912489891052246, 2.731921672821045, 1.8054649829864502, 3.5064148902893066, 3.6969799995422363, 0.18624341487884521, 3.1137633323669434, 1.4785758256912231, 1.678992748260498, 2.411144256591797, 1.0473124980926514, 2.404010772705078, 1.5433554649353027, 3.621732711791992, 1.3947774171829224, 2.4458017349243164, 3.6635866165161133, 3.451521158218384, 0.6945695877075195, 1.8232300281524658, 1.6789426803588867, 2.1297011375427246, 1.9105490446090698, 3.0723602771759033, 1.3803741931915283, 1.678078055381775, 2.9789469242095947, 2.0952606201171875, 3.8207130432128906, 0.13208627700805664, 3.7146553993225098, 1.1760165691375732, 0.10130852460861206, 2.98508882522583, 2.1371519565582275, 2.9607810974121094, 3.2777771949768066, 1.4757087230682373, 3.404517650604248, 3.1330208778381348, 2.278428077697754, 1.059718132019043, 3.526933431625366, 3.274278163909912, 3.3512721061706543, 1.7517950534820557, 2.381577491760254, 2.269045352935791, 4.799609661102295, 1.7661281824111938, 3.444061279296875, 2.306796073913574, 2.0752525329589844, 2.2502079010009766, 2.6871581077575684, 2.8178064823150635, 1.1678376197814941, 2.114579200744629, 2.617889404296875, 2.3584635257720947, 3.1619272232055664, 2.9987974166870117], "mean_td_error": 2.344470262527466, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 932.921229383882, "num_env_steps_trained_throughput_per_sec": 268.6313361395553, "timesteps_total": 17024, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1050.135, "sample_time_ms": 745.585, "load_time_ms": 0.308, "load_throughput": 837756.779, "learn_time_ms": 17.957, "learn_throughput": 14367.278, "synch_weights_time_ms": 10.585}, "counters": {"num_env_steps_sampled": 17024, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 4644, "last_target_update_ts": 17024, "num_target_updates": 18}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-55", "timestamp": 1700369815, "time_this_iter_s": 1.9290580749511719, "time_total_s": 19.76742148399353, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.76742148399353, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 68.23333333333333, "ram_util_percent": 66.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113693237304688, "actor_loss": -4.5175580978393555, "critic_loss": 2.578277587890625, "alpha_loss": -0.057673148810863495, "alpha_value": 0.9943137764930725, "log_alpha_value": -0.005702481139451265, "target_entropy": -6.0, "policy_t": -0.04978232458233833, "mean_q": 0.5810973644256592, "max_q": 4.200709342956543, "min_q": 0.37904804944992065}, "td_error": [4.123612403869629, 4.032193183898926, 4.520957946777344, 2.084190607070923, 4.855315685272217, 5.066340446472168, 6.207237720489502, 4.090325355529785, 1.7095487117767334, 3.634348154067993, 3.942800521850586, 4.394570350646973, 2.5444858074188232, 3.724945545196533, 4.700748443603516, 4.556032180786133, 4.053692817687988, 4.303162574768066, 2.9265594482421875, 2.0491232872009277, 4.903120040893555, 4.060924530029297, 2.027472496032715, 0.48523712158203125, 5.0832133293151855, 3.522183418273926, 4.141633987426758, 1.9806008338928223, 3.4539988040924072, 2.428629159927368, 4.578743934631348, 2.8156991004943848, 3.552517890930176, 4.045413970947266, 5.931274890899658, 2.7222900390625, 4.766931056976318, 3.0863125324249268, 5.193089485168457, 3.7345781326293945, 5.199835300445557, 5.642541408538818, 3.7526564598083496, 3.1840200424194336, 2.4762158393859863, 2.8161098957061768, 4.372496128082275, 5.629241943359375, 3.4469776153564453, 3.683602809906006, 5.299413681030273, 4.626409530639648, 5.601703643798828, 3.4554738998413086, 3.653292179107666, 5.1994123458862305, 5.705315589904785, 3.6692259311676025, 3.7703161239624023, 5.59906005859375, 3.2428691387176514, 3.821474075317383, 6.625969886779785, 4.175197601318359, 2.8240151405334473, 4.608437538146973, 4.678349494934082, 4.452489852905273, 3.645129680633545, 4.909686088562012, 3.866271495819092, 4.882981777191162, 4.744195461273193, 3.425499439239502, 5.229785919189453, 0.8309204578399658, 4.673135757446289, 4.085582256317139, 5.481894493103027, 5.080752849578857, 4.07382869720459, 3.4878766536712646, 1.5955097675323486, 4.968472480773926, 3.463726043701172, 5.700199127197266], "mean_td_error": 4.016181468963623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032150268554688, "actor_loss": -4.418015003204346, "critic_loss": 0.6347271203994751, "alpha_loss": -0.05721169337630272, "alpha_value": 0.9943134188652039, "log_alpha_value": -0.0057028355076909065, "target_entropy": -6.0, "policy_t": 0.010874038562178612, "mean_q": 0.5455959439277649, "max_q": 3.8716437816619873, "min_q": 0.38122668862342834}, "td_error": [1.8070645332336426, 1.5066306591033936, 3.099411725997925, 2.348158359527588, 3.269611120223999, 1.9815292358398438, 1.3974308967590332, 0.2065005600452423, 4.106056213378906, 1.06248140335083, 3.658268928527832, 3.04004168510437, 2.2291457653045654, 2.924427032470703, 2.7671000957489014, 1.767838954925537, 1.695643663406372, 2.7511093616485596, 0.8756313920021057, 2.805142879486084, 1.894582986831665, 0.6301530599594116, 3.072287082672119, 2.3977158069610596, 2.297367572784424, 0.4150840640068054, 1.8961231708526611, 0.3262941241264343, 2.3196492195129395, 2.962491035461426, 1.5742037296295166, 1.1590826511383057, 2.208690881729126, 3.4290261268615723, 1.8849234580993652, 3.123110771179199, 2.7479138374328613, 1.5464670658111572, 4.957436561584473, 0.5296974182128906, 0.6812751889228821, 0.3578953146934509, 2.380740165710449, 3.2438607215881348, 0.9698350429534912, 3.180981397628784, 0.42444902658462524, 0.6227366924285889, 3.4180006980895996, 2.0945863723754883, 2.2725162506103516, 2.506129741668701, 2.779057025909424, 2.4118638038635254, 3.636211395263672, 2.2340145111083984, 1.597283124923706, 3.4777610301971436, 0.4438199996948242, 2.8498682975769043, 3.091188430786133, 2.6046981811523438, 2.3864023685455322, 1.2900390625, 1.5175776481628418, 3.017054557800293, 2.703531265258789, 3.301765203475952, 1.148654580116272, 2.6006827354431152, 1.5716404914855957, 2.508258581161499, 2.2345528602600098, 3.8485946655273438, 2.78743052482605, 1.8912224769592285, 3.818471908569336, 4.249216079711914, 1.3817756175994873, 2.558987617492676, 3.2402796745300293, 1.3121097087860107, 4.276371955871582, 0.9165655374526978, 3.551680564880371, 3.461129665374756], "mean_td_error": 2.27353835105896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097789764404297, "actor_loss": -4.402516841888428, "critic_loss": 0.8071871399879456, "alpha_loss": -0.05758608877658844, "alpha_value": 0.9943133592605591, "log_alpha_value": -0.0057028415612876415, "target_entropy": -6.0, "policy_t": -0.023323625326156616, "mean_q": 0.4128448963165283, "max_q": 4.163228511810303, "min_q": 0.3004503846168518}, "td_error": [1.0094590187072754, 1.3633898496627808, 1.850574254989624, 3.1592392921447754, 2.050947904586792, 2.679060459136963, 3.0411267280578613, 2.578103542327881, 1.4341399669647217, 3.2618212699890137, 2.6977410316467285, 3.7952048778533936, 2.940704822540283, 1.8921396732330322, 2.3285346031188965, 3.6527042388916016, 2.706880569458008, 1.4829119443893433, 3.358135938644409, 2.488689422607422, 3.551405429840088, 2.831644058227539, 2.4017181396484375, 5.007894515991211, 2.6697299480438232, 1.7515339851379395, 1.6222952604293823, 3.144951343536377, 1.9978415966033936, 1.7963001728057861, 1.8222397565841675, 4.91579532623291, 2.2489137649536133, 1.7935186624526978, 3.362929344177246, 0.18345612287521362, 1.8450450897216797, 1.0110862255096436, 3.7795791625976562, 3.5033206939697266, 2.497035503387451, 2.931885242462158, 3.583372116088867, 3.56730055809021, 1.4907307624816895, 4.406572341918945, 3.5669851303100586, 3.053313970565796, 2.934166669845581, 1.8025298118591309, 3.781751871109009, 2.324796676635742, 1.5688835382461548, 3.034083843231201, 2.7380762100219727, 0.5754647850990295, 2.106682300567627, 2.314912796020508, 3.1046907901763916, 1.7394251823425293, 0.35718274116516113, 2.080873489379883, 2.1772608757019043, 2.942746162414551, 1.6567163467407227, 0.8719791173934937, 3.2230331897735596, 3.641758441925049, 3.0385115146636963, 2.6710143089294434, 2.0375185012817383, 2.110232353210449, 4.326789855957031, 2.4887351989746094, 2.2734313011169434, 0.9361953735351562, 2.3391170501708984, 1.2231707572937012, 2.3754289150238037, 2.8195714950561523, 2.2830231189727783, 1.8084750175476074, 2.6538100242614746, 3.4919803142547607, 3.068829298019409, 1.8206607103347778], "mean_td_error": 2.498295545578003, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 914.9364372855521, "num_env_steps_trained_throughput_per_sec": 263.45267948624155, "timesteps_total": 18816, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1042.344, "sample_time_ms": 752.22, "load_time_ms": 0.309, "load_throughput": 835880.142, "learn_time_ms": 17.866, "learn_throughput": 14440.863, "synch_weights_time_ms": 10.412}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 5160, "last_target_update_ts": 18816, "num_target_updates": 20}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-57", "timestamp": 1700369817, "time_this_iter_s": 1.966710090637207, "time_total_s": 21.734131574630737, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b9260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.734131574630737, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 67.2, "ram_util_percent": 65.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082818031311035, "actor_loss": -4.530774116516113, "critic_loss": 2.5500030517578125, "alpha_loss": -0.06052439287304878, "alpha_value": 0.9940152764320374, "log_alpha_value": -0.006002725102007389, "target_entropy": -6.0, "policy_t": 0.0029801453929394484, "mean_q": 0.6892778873443604, "max_q": 3.682213306427002, "min_q": 0.4140323996543884}, "td_error": [5.026342391967773, 2.7412962913513184, 4.6457719802856445, 4.561069488525391, 4.5849761962890625, 5.029160499572754, 3.8133397102355957, 3.9882922172546387, 4.541070938110352, 3.8276071548461914, 5.0456438064575195, 2.822441816329956, 4.881498336791992, 5.056580543518066, 5.545695781707764, 4.154973983764648, 5.336057186126709, 2.3486745357513428, 4.485221862792969, 3.977663993835449, 5.566775321960449, 4.063175201416016, 3.978085994720459, 4.76564359664917, 4.878260612487793, 4.533873081207275, 5.535602569580078, 0.43648576736450195, 4.488478660583496, 3.621377944946289, 2.674018383026123, 3.9233975410461426, 0.43653082847595215, 0.883746862411499, 4.048826217651367, 0.49712300300598145, 3.7726173400878906, 3.5282187461853027, 5.116551876068115, 4.3649139404296875, 4.755500793457031, 4.2752509117126465, 5.410995960235596, 4.654796600341797, 5.08078670501709, 5.198273181915283, 1.8929100036621094, 3.506852626800537, 3.857013702392578, 3.6512815952301025, 4.6391754150390625, 4.2534284591674805, 6.1773362159729, 3.766075372695923, 3.6247987747192383, 3.510406017303467, 6.907746315002441, 4.937088966369629, 0.6098356246948242, 0.7542616128921509, 3.417546272277832, 4.915384292602539, 4.460723876953125, 4.956358909606934, 1.3964056968688965, 4.4189653396606445, 3.3829660415649414, 4.0025315284729, 0.37396812438964844, 3.485901117324829, 3.8336873054504395, 4.458874225616455, 5.164852142333984, 3.167680501937866, 5.175439834594727, 3.3635997772216797, 4.887551784515381, 5.272363662719727, 5.700679779052734, 4.338397026062012, 3.323038339614868, 5.836056709289551, 5.438917636871338, 4.581247806549072, 3.719027519226074, 3.4770822525024414], "mean_td_error": 4.017909049987793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056317329406738, "actor_loss": -4.472403526306152, "critic_loss": 0.6239989399909973, "alpha_loss": -0.06036527082324028, "alpha_value": 0.9940152764320374, "log_alpha_value": -0.006002721376717091, "target_entropy": -6.0, "policy_t": 0.016022711992263794, "mean_q": 0.550376832485199, "max_q": 5.0210466384887695, "min_q": 0.4147096872329712}, "td_error": [0.884223222732544, 2.392221450805664, 0.6530179381370544, 0.8058353662490845, 3.817721128463745, 0.7860508561134338, 1.6718764305114746, 3.3193514347076416, 3.5194478034973145, 1.4259638786315918, 1.8437373638153076, 4.242182731628418, 3.776595115661621, 2.278676986694336, 1.2058675289154053, 3.6795129776000977, 1.680497407913208, 0.08072052896022797, 1.4786254167556763, 2.4882960319519043, 3.870802879333496, 2.849919319152832, 2.438199520111084, 0.19336092472076416, 0.395538866519928, 0.5248032212257385, 3.578555107116699, 1.644946813583374, 2.3602182865142822, 1.9542925357818604, 1.697608232498169, 3.401545524597168, 1.5244948863983154, 3.896610975265503, 2.2021632194519043, 1.4202051162719727, 3.2330679893493652, 1.3641259670257568, 2.273275852203369, 1.4554051160812378, 2.606821298599243, 2.4730160236358643, 3.0228099822998047, 2.4872806072235107, 0.1765650361776352, 0.9987053275108337, 1.9588935375213623, 3.082307815551758, 0.3077946901321411, 1.3249582052230835, 1.646958351135254, 1.231557011604309, 1.8382048606872559, 2.6460771560668945, 1.4281988143920898, 2.7777092456817627, 2.072110652923584, 2.088009834289551, 2.3782753944396973, 3.10007905960083, 1.8693187236785889, 1.5599608421325684, 2.849661350250244, 1.8570380210876465, 2.9626691341400146, 0.13856235146522522, 1.0906219482421875, 2.6728312969207764, 2.0019426345825195, 2.7998571395874023, 3.370593547821045, 3.3730106353759766, 2.477067708969116, 1.034204363822937, 1.8458253145217896, 2.3392748832702637, 1.880985975265503, 2.745941162109375, 2.42716646194458, 3.6439290046691895, 2.2107934951782227, 4.147514343261719, 2.497915267944336, 3.5774970054626465, 4.51576042175293, 4.238404750823975], "mean_td_error": 2.2102818489074707, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088515281677246, "actor_loss": -4.417248725891113, "critic_loss": 0.7792835235595703, "alpha_loss": -0.06056170165538788, "alpha_value": 0.9940149188041687, "log_alpha_value": -0.006003033369779587, "target_entropy": -6.0, "policy_t": 0.020864928141236305, "mean_q": 0.6429393887519836, "max_q": 4.816259384155273, "min_q": 0.3281528353691101}, "td_error": [0.8758877515792847, 1.5411370992660522, 3.3505702018737793, 2.4703688621520996, 2.2807579040527344, 3.5016281604766846, 0.7470295429229736, 3.3614797592163086, 1.4915189743041992, 2.69655179977417, 3.3401858806610107, 2.6050171852111816, 3.5311710834503174, 0.9899729490280151, 2.7584848403930664, 3.0454742908477783, 1.925783395767212, 2.6413416862487793, 1.8606566190719604, 3.366690158843994, 2.183163642883301, 3.866792678833008, 1.6273820400238037, 3.908334255218506, 0.39670681953430176, 0.6113770008087158, 1.5496028661727905, 4.5054216384887695, 2.416368246078491, 1.1069597005844116, 0.8315693736076355, 2.330873489379883, 1.2230690717697144, 3.8677639961242676, 2.836698532104492, 0.18828701972961426, 0.9295767545700073, 2.9886937141418457, 3.449897527694702, 2.5623600482940674, 3.8135693073272705, 4.083101749420166, 4.3392486572265625, 1.7086107730865479, 1.4543076753616333, 3.148714303970337, 2.176957607269287, 0.9326596260070801, 1.8129076957702637, 1.3106813430786133, 1.794978380203247, 3.005216598510742, 1.3630067110061646, 4.208332538604736, 1.8702113628387451, 3.675412178039551, 2.6880781650543213, 3.694326877593994, 2.490020275115967, 1.4188921451568604, 3.4223601818084717, 2.822683811187744, 3.496826171875, 3.4937896728515625, 2.528871774673462, 1.9499883651733398, 2.254180669784546, 3.174994707107544, 4.324497222900391, 2.7832651138305664, 2.06581974029541, 2.758808135986328, 2.1072137355804443, 2.625016689300537, 2.995398998260498, 1.4231585264205933, 0.4223312735557556, 2.821833848953247, 1.2330327033996582, 2.5539517402648926, 2.0331127643585205, 1.9818347692489624, 0.050394609570503235, 2.57142972946167, 2.7852792739868164, 1.1484159231185913], "mean_td_error": 2.3788411617279053, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 20.0}}, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 834.6623366614585, "num_env_steps_trained_throughput_per_sec": 240.33803890475033, "timesteps_total": 19712, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1054.629, "sample_time_ms": 765.488, "load_time_ms": 0.311, "load_throughput": 829155.185, "learn_time_ms": 17.916, "learn_throughput": 14400.718, "synch_weights_time_ms": 10.697}, "counters": {"num_env_steps_sampled": 19712, "num_env_steps_trained": 5418, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 5418, "last_target_update_ts": 19712, "num_target_updates": 21}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "fedad_00000", "date": "2023-11-18_20-56-58", "timestamp": 1700369818, "time_this_iter_s": 1.0817506313323975, "time_total_s": 22.815882205963135, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177425c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.815882205963135, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 83.7, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107662200927734, "actor_loss": -4.644126892089844, "critic_loss": 2.517599582672119, "alpha_loss": -0.06674356013536453, "alpha_value": 0.9934185147285461, "log_alpha_value": -0.006603263784199953, "target_entropy": -6.0, "policy_t": 0.016151677817106247, "mean_q": 0.7216417789459229, "max_q": 5.930145740509033, "min_q": 0.49010950326919556}, "td_error": [4.761350631713867, 0.5529608726501465, 4.082577705383301, 4.828859806060791, 1.676351547241211, 4.749056816101074, 2.5354325771331787, 4.754741668701172, 3.531985282897949, 4.546783447265625, 3.1909642219543457, 4.317996978759766, 3.8467772006988525, 3.073683738708496, 3.3835554122924805, 3.1622912883758545, 4.436448097229004, 3.583143711090088, 3.340341806411743, 4.502906799316406, 5.8296966552734375, 4.189019203186035, 5.114996910095215, 5.119544982910156, 5.5459136962890625, 4.235465049743652, 3.7354700565338135, 3.9045705795288086, 3.4039337635040283, 4.592296600341797, 3.4692883491516113, 3.3117551803588867, 4.122868061065674, 5.497915267944336, 4.1004438400268555, 4.431014060974121, 4.831354141235352, 5.314403533935547, 4.259025573730469, 4.234799385070801, 4.718357086181641, 4.696878910064697, 4.804136276245117, 5.190052509307861, 4.288628578186035, 5.077547073364258, 4.837061405181885, 3.610074520111084, 3.5850625038146973, 5.567912578582764, 5.229298114776611, 0.6128556728363037, 3.8847649097442627, 3.3483481407165527, 3.2858071327209473, 3.1277992725372314, 3.930734157562256, 5.471619606018066, 3.1211862564086914, 6.030327320098877, 4.4644455909729, 4.046745777130127, 4.697735786437988, 4.338150978088379, 4.906104564666748, 4.014901638031006, 3.198533535003662, 3.110135555267334, 4.400016784667969, 3.9104137420654297, 5.744455814361572, 3.5416297912597656, 2.850037097930908, 3.831066131591797, 4.550328254699707, 3.057709217071533, 3.6617636680603027, 3.782417058944702, 3.6436610221862793, 3.50258469581604, 3.8934402465820312, 1.6907532215118408, 2.3650617599487305, 3.585097312927246, 3.5407423973083496, 3.6398472785949707], "mean_td_error": 4.005676746368408, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078741073608398, "actor_loss": -4.569579601287842, "critic_loss": 0.5602745413780212, "alpha_loss": -0.06654296815395355, "alpha_value": 0.9934194684028625, "log_alpha_value": -0.006602308712899685, "target_entropy": -6.0, "policy_t": 0.004745281767100096, "mean_q": 0.93550705909729, "max_q": 5.0595173835754395, "min_q": 0.48425978422164917}, "td_error": [2.494966983795166, 1.005141258239746, 0.3914778232574463, 2.599255084991455, 2.3430821895599365, 3.439822196960449, 1.7846925258636475, 2.7647857666015625, 1.6967636346817017, 0.598259687423706, 2.5491607189178467, 3.950361728668213, 2.675638198852539, 1.5218379497528076, 3.8867287635803223, 3.0574090480804443, 2.1181082725524902, 2.40529465675354, 1.7981853485107422, 0.4665701389312744, 3.879422664642334, 4.3241095542907715, 3.433464527130127, 0.19311678409576416, 3.4442436695098877, 2.0440735816955566, 1.6478157043457031, 3.7775051593780518, 0.20657594501972198, 1.1891695261001587, 2.655026912689209, 1.9116265773773193, 2.460217237472534, 0.18993377685546875, 2.367952823638916, 1.7123574018478394, 2.688760280609131, 2.489820957183838, 0.49803775548934937, 2.968662738800049, 0.1698734164237976, 1.127387523651123, 2.1484951972961426, 0.23427905142307281, 2.3274006843566895, 1.1759490966796875, 4.0370330810546875, 2.2073917388916016, 2.7718520164489746, 2.598942279815674, 2.181602716445923, 1.6748636960983276, 0.24798940122127533, 3.417325019836426, 0.6983765363693237, 3.1840667724609375, 1.190374732017517, 3.7011842727661133, 1.446693778038025, 2.984473705291748, 1.0808731317520142, 1.478664755821228, 2.995453119277954, 0.9219603538513184, 1.4426438808441162, 1.8152351379394531, 3.0287041664123535, 2.259373664855957, 2.8697640895843506, 1.952556848526001, 0.2956511974334717, 2.449063539505005, 1.723109245300293, 1.3044036626815796, 3.174931049346924, 1.2764301300048828, 2.1531786918640137, 1.1692955493927002, 1.057136058807373, 1.0919584035873413, 1.67036771774292, 2.7057790756225586, 1.713212251663208, 2.385188102722168, 1.4149603843688965, 2.4247264862060547], "mean_td_error": 2.0349955558776855, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09753131866455, "actor_loss": -4.483544826507568, "critic_loss": 0.7487969994544983, "alpha_loss": -0.0666760727763176, "alpha_value": 0.9934185743331909, "log_alpha_value": -0.00660320557653904, "target_entropy": -6.0, "policy_t": -0.008244727738201618, "mean_q": 0.5531207323074341, "max_q": 5.098543643951416, "min_q": 0.3853277564048767}, "td_error": [2.4313762187957764, 1.4388549327850342, 3.996105909347534, 3.1219539642333984, 1.3069612979888916, 2.460934638977051, 2.0560755729675293, 2.4096336364746094, 2.6044113636016846, 3.5110678672790527, 4.43211030960083, 1.5702171325683594, 2.0497548580169678, 2.7236852645874023, 2.341035842895508, 1.9792040586471558, 1.696423053741455, 0.8844007253646851, 4.386612415313721, 1.2901067733764648, 2.5727932453155518, 3.0379934310913086, 3.2126874923706055, 0.43777716159820557, 3.187195301055908, 1.4693548679351807, 1.8988709449768066, 1.8012123107910156, 2.748173952102661, 3.0112991333007812, 2.228015661239624, 2.8807361125946045, 4.496533393859863, 3.5745348930358887, 0.8214309215545654, 0.24671043455600739, 1.8654978275299072, 1.3531471490859985, 3.737034797668457, 3.120551586151123, 2.2223801612854004, 3.765928268432617, 1.291981816291809, 1.4190274477005005, 1.6489918231964111, 3.143044948577881, 1.06215238571167, 2.4159128665924072, 0.7875760793685913, 2.2939367294311523, 2.547004222869873, 3.211904525756836, 2.40081787109375, 2.3332691192626953, 2.557310104370117, 2.4767770767211914, 2.230921745300293, 1.6368846893310547, 1.534595012664795, 2.2094805240631104, 4.543709754943848, 1.4464970827102661, 3.242556571960449, 0.37277722358703613, 2.039888620376587, 3.5660452842712402, 1.856344223022461, 1.6197845935821533, 2.2353079319000244, 1.3064759969711304, 1.459263563156128, 2.914510488510132, 1.9131134748458862, 0.6753689050674438, 1.6451656818389893, 1.2097234725952148, 1.6923977136611938, 3.713735580444336, 2.1940627098083496, 3.4716577529907227, 3.3071107864379883, 2.2863781452178955, 3.2977137565612793, 2.4307708740234375, 2.386988639831543, 2.7379822731018066], "mean_td_error": 2.315670967102051, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 865.1921904479062, "num_env_steps_trained_throughput_per_sec": 249.12900126736585, "timesteps_total": 21504, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1013.394, "sample_time_ms": 724.157, "load_time_ms": 0.311, "load_throughput": 828456.922, "learn_time_ms": 18.256, "learn_throughput": 14132.121, "synch_weights_time_ms": 10.992}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 5934, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 5934, "last_target_update_ts": 21504, "num_target_updates": 23}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-00", "timestamp": 1700369820, "time_this_iter_s": 2.081231117248535, "time_total_s": 24.89711332321167, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.89711332321167, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 72.8, "ram_util_percent": 65.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08108901977539, "actor_loss": -4.653897762298584, "critic_loss": 2.3216958045959473, "alpha_loss": -0.06959576159715652, "alpha_value": 0.9931201934814453, "log_alpha_value": -0.006903595756739378, "target_entropy": -6.0, "policy_t": 0.013290214352309704, "mean_q": 0.7629298567771912, "max_q": 5.241898536682129, "min_q": 0.5307623147964478}, "td_error": [5.065406799316406, 3.785355567932129, 2.7386865615844727, 3.169039487838745, 4.719026565551758, 4.488166809082031, 2.4553303718566895, 2.7434966564178467, 3.6854395866394043, 3.5732507705688477, 3.015110492706299, 3.4624104499816895, 6.166502475738525, 3.20123291015625, 4.1060404777526855, 5.213903427124023, 3.9033501148223877, 1.758453607559204, 3.573713779449463, 5.958456993103027, 4.383540153503418, 4.205986022949219, 2.4861226081848145, 4.267894744873047, 4.541038513183594, 2.669940948486328, 4.016180038452148, 1.1833128929138184, 3.892454147338867, 3.585193634033203, 3.8309550285339355, 4.820418357849121, 3.0592072010040283, 1.265500783920288, 1.308532476425171, 5.000873565673828, 3.0529122352600098, 4.193632125854492, 2.4573681354522705, 4.76967716217041, 2.733562469482422, 5.269774913787842, 3.4666800498962402, 3.6250576972961426, 3.369398593902588, 5.624595642089844, 3.1933412551879883, 5.019961357116699, 3.7180867195129395, 4.1264238357543945, 4.63194465637207, 4.662551403045654, 3.351922035217285, 2.30572772026062, 4.223649978637695, 3.7151808738708496, 3.671196699142456, 3.7259840965270996, 4.017139434814453, 3.0231471061706543, 3.1738879680633545, 5.610026836395264, 3.932326078414917, 3.4231529235839844, 4.7869462966918945, 5.481281280517578, 4.2709197998046875, 4.245190620422363, 3.313386917114258, 3.588249444961548, 3.5965893268585205, 5.017131805419922, 0.5446364879608154, 2.1212706565856934, 2.948342800140381, 4.819183826446533, 3.9887502193450928, 3.831373453140259, 2.6851251125335693, 3.317654609680176, 4.841779708862305, 4.5147905349731445, 3.2338924407958984, 6.093465328216553, 5.244613170623779, 4.8752121925354], "mean_td_error": 3.799391031265259, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113167762756348, "actor_loss": -4.638404369354248, "critic_loss": 0.592345118522644, "alpha_loss": -0.06980179995298386, "alpha_value": 0.9931216835975647, "log_alpha_value": -0.006902070716023445, "target_entropy": -6.0, "policy_t": 0.012837971560657024, "mean_q": 0.7486486434936523, "max_q": 5.221434593200684, "min_q": 0.5192716121673584}, "td_error": [1.295272946357727, 1.9272717237472534, 1.8882261514663696, 3.3871572017669678, 1.2616225481033325, 1.7434577941894531, 2.2000904083251953, 1.6848751306533813, 2.6850805282592773, 1.0887947082519531, 1.71431565284729, 4.693787574768066, 0.9144406914710999, 2.3373143672943115, 3.7650771141052246, 1.8962684869766235, 1.6908406019210815, 4.2091193199157715, 2.3716630935668945, 3.9041616916656494, 1.0261189937591553, 2.709949016571045, 3.410154342651367, 1.8474907875061035, 0.18598604202270508, 1.4375081062316895, 2.5022897720336914, 3.4781532287597656, 2.4322147369384766, 3.227196216583252, 2.1418254375457764, 1.8059495687484741, 2.932553768157959, 3.1542580127716064, 1.656705379486084, 0.12195265293121338, 2.1055409908294678, 1.1111184358596802, 3.9921061992645264, 1.543708086013794, 1.9147276878356934, 1.2097331285476685, 2.0812439918518066, 0.2617748975753784, 2.500159502029419, 1.924849033355713, 1.8128494024276733, 0.9283666610717773, 2.0974936485290527, 0.5707911252975464, 3.113753318786621, 1.1723263263702393, 1.2802739143371582, 2.3908791542053223, 3.8759398460388184, 2.3380322456359863, 3.0621819496154785, 2.212202548980713, 0.377485066652298, 2.3039729595184326, 2.1693942546844482, 1.3672925233840942, 3.19027042388916, 1.223376750946045, 2.1274657249450684, 3.089174747467041, 1.5234746932983398, 3.0561165809631348, 4.137030601501465, 2.8437552452087402, 2.958718776702881, 1.9277303218841553, 1.8300814628601074, 3.3989181518554688, 1.385087490081787, 0.9513446092605591, 2.5413036346435547, 0.6572625637054443, 2.2160518169403076, 1.0844883918762207, 4.166918754577637, 1.3361926078796387, 1.4285030364990234, 0.18598926067352295, 1.03104829788208, 3.0029497146606445], "mean_td_error": 2.113262891769409, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10428237915039, "actor_loss": -4.515618801116943, "critic_loss": 0.7012271285057068, "alpha_loss": -0.06975218653678894, "alpha_value": 0.993120551109314, "log_alpha_value": -0.006903230212628841, "target_entropy": -6.0, "policy_t": 0.013695175759494305, "mean_q": 0.4885713756084442, "max_q": 3.361067295074463, "min_q": 0.41570204496383667}, "td_error": [0.842643141746521, 1.717147707939148, 2.6681509017944336, 3.766026496887207, 2.1190829277038574, 1.6333884000778198, 2.9873595237731934, 1.7614651918411255, 2.0603556632995605, 1.4749178886413574, 3.099079132080078, 2.3470916748046875, 2.4806723594665527, 1.258892297744751, 1.185870885848999, 3.6371636390686035, 3.3950133323669434, 2.422165632247925, 0.25617140531539917, 2.2198662757873535, 4.369391441345215, 3.1462512016296387, 2.5875425338745117, 1.9918514490127563, 2.037031412124634, 3.5988667011260986, 1.5548648834228516, 2.720578193664551, 3.392788887023926, 2.8799805641174316, 2.967742443084717, 3.10396409034729, 2.26822566986084, 1.060018539428711, 1.8119750022888184, 3.1055312156677246, 3.504868984222412, 1.342519998550415, 1.49798583984375, 1.583221673965454, 0.7254434823989868, 2.2535879611968994, 2.5272674560546875, 1.5998506546020508, 0.9814115762710571, 2.18961238861084, 0.0958297848701477, 0.020652219653129578, 0.7510432004928589, 1.497971773147583, 3.1819677352905273, 2.581951379776001, 2.421813488006592, 1.3733909130096436, 4.028360366821289, 3.022854804992676, 3.389484405517578, 3.657639980316162, 1.1077086925506592, 2.857306480407715, 1.9643847942352295, 2.818866729736328, 1.8778901100158691, 3.6214308738708496, 4.3020830154418945, 2.8713436126708984, 2.5199153423309326, 1.8973387479782104, 2.8835065364837646, 0.25571703910827637, 2.8169026374816895, 1.1895707845687866, 1.7523796558380127, 1.7065496444702148, 2.7734618186950684, 2.8559675216674805, 0.09132838249206543, 2.3343448638916016, 1.5231895446777344, 3.2258856296539307, 2.6338233947753906, 0.40820980072021484, 1.856569766998291, 2.846588611602783, 2.322507858276367, 0.8665736317634583], "mean_td_error": 2.2132468223571777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 761.5312147854039, "num_env_steps_trained_throughput_per_sec": 219.28019354311851, "timesteps_total": 22400, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1032.108, "sample_time_ms": 742.614, "load_time_ms": 0.308, "load_throughput": 836720.353, "learn_time_ms": 18.263, "learn_throughput": 14126.679, "synch_weights_time_ms": 10.945}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 6192, "last_target_update_ts": 22400, "num_target_updates": 24}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-02", "timestamp": 1700369822, "time_this_iter_s": 1.186218023300171, "time_total_s": 26.08333134651184, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 26.08333134651184, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 73.1, "ram_util_percent": 66.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098785400390625, "actor_loss": -4.715091228485107, "critic_loss": 2.394101858139038, "alpha_loss": -0.07275065034627914, "alpha_value": 0.992821991443634, "log_alpha_value": -0.007203900720924139, "target_entropy": -6.0, "policy_t": -0.05169469490647316, "mean_q": 0.8588689565658569, "max_q": 6.815075397491455, "min_q": 0.5730517506599426}, "td_error": [2.809178352355957, 4.469614028930664, 3.914246082305908, 3.099686622619629, 5.2497429847717285, 3.11922025680542, 2.58219051361084, 3.0353150367736816, 5.023234844207764, 3.3091235160827637, 5.869189262390137, 3.997964382171631, 4.115712642669678, 1.9086573123931885, 4.684294700622559, 3.943397045135498, 2.766928195953369, 4.03275203704834, 4.703819274902344, 5.282796859741211, 2.923877239227295, 5.67277717590332, 1.6554076671600342, 4.428635597229004, 4.935179710388184, 2.1889636516571045, 3.6887876987457275, 4.59560489654541, 3.213036060333252, 4.649130821228027, 3.9516100883483887, 2.078382730484009, 2.8756790161132812, 5.303098201751709, 3.7447023391723633, 5.7560811042785645, 2.924267530441284, 3.198314905166626, 4.959647178649902, 3.3333747386932373, 5.529419898986816, 3.5147666931152344, 4.442763805389404, 2.746509552001953, 3.985700845718384, 4.858402252197266, 4.039976596832275, 4.217528343200684, 3.690558910369873, 2.6257591247558594, 4.500954627990723, 2.2384352684020996, 2.9240384101867676, 4.65736198425293, 2.2291312217712402, 3.715984582901001, 4.193066596984863, 3.7132649421691895, 4.970939636230469, 2.9058609008789062, 2.207308530807495, 3.2655134201049805, 3.394219398498535, 2.6293654441833496, 6.464390754699707, 4.89902400970459, 4.644392967224121, 3.511089324951172, 5.4818315505981445, 0.5107042789459229, 2.1424970626831055, 4.563836097717285, 3.892745018005371, 4.984587669372559, 5.817437648773193, 3.0792369842529297, 5.173433303833008, 3.457007646560669, 4.1591796875, 2.8162670135498047, 3.3926451206207275, 2.0150113105773926, 4.305464267730713, 5.107391834259033, 2.6042542457580566, 2.365849733352661], "mean_td_error": 3.797427177429199, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.021198272705078, "actor_loss": -4.586763381958008, "critic_loss": 0.6660282611846924, "alpha_loss": -0.07217158377170563, "alpha_value": 0.9928239583969116, "log_alpha_value": -0.007201891392469406, "target_entropy": -6.0, "policy_t": -0.037095312029123306, "mean_q": 0.8312381505966187, "max_q": 5.881190776824951, "min_q": 0.5554795265197754}, "td_error": [3.29315185546875, 1.843687653541565, 1.646135687828064, 2.305584669113159, 3.2241315841674805, 1.9742857217788696, 2.0191142559051514, 2.3905234336853027, 3.2684357166290283, 1.5277791023254395, 3.9496328830718994, 2.5124545097351074, 3.4641571044921875, 1.9248018264770508, 2.3571724891662598, 4.2769951820373535, 1.7528984546661377, 2.2624948024749756, 3.7381296157836914, 1.3603119850158691, 2.089277505874634, 1.794800043106079, 2.854706287384033, 3.1581223011016846, 0.44115859270095825, 1.9429101943969727, 2.942288398742676, 2.274600028991699, 1.872992992401123, 2.0402369499206543, 3.282985210418701, 2.218085289001465, 3.226128578186035, 2.199648857116699, 1.6816688776016235, 2.1556568145751953, 1.6182528734207153, 2.1490821838378906, 1.7573044300079346, 1.2819342613220215, 2.214380979537964, 1.3321605920791626, 1.1103484630584717, 0.9394270181655884, 2.923794984817505, 3.6049609184265137, 3.054020881652832, 1.706322431564331, 1.8768377304077148, 1.9231610298156738, 0.04234698414802551, 1.9421086311340332, 1.929520606994629, 2.0526909828186035, 0.1917717456817627, 2.9603731632232666, 1.814107894897461, 2.916627883911133, 3.534278392791748, 0.8736972808837891, 1.4182021617889404, 2.0366997718811035, 0.638607919216156, 2.2328333854675293, 2.4096217155456543, 1.8710789680480957, 3.8723607063293457, 1.523841142654419, 2.7466533184051514, 2.857311487197876, 2.064049005508423, 1.895796775817871, 3.5785748958587646, 1.06343412399292, 3.731152296066284, 0.43288734555244446, 3.1648478507995605, 2.9570350646972656, 4.141827583312988, 4.516484260559082, 2.0149331092834473, 1.8704427480697632, 2.712493896484375, 2.6970739364624023, 1.9518076181411743, 2.869473934173584], "mean_td_error": 2.282397508621216, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105386734008789, "actor_loss": -4.550241947174072, "critic_loss": 0.6718939542770386, "alpha_loss": -0.0727919191122055, "alpha_value": 0.9928225874900818, "log_alpha_value": -0.007203279063105583, "target_entropy": -6.0, "policy_t": -0.0456133633852005, "mean_q": 0.5707175135612488, "max_q": 5.324375152587891, "min_q": 0.4483366310596466}, "td_error": [3.6127777099609375, 1.7896195650100708, 3.519493579864502, 3.53426456451416, 2.3016929626464844, 2.4640276432037354, 2.015845775604248, 3.307353973388672, 2.5443480014801025, 0.7654143571853638, 1.813088297843933, 1.6272152662277222, 1.3149654865264893, 2.232839584350586, 3.1028594970703125, 1.1617460250854492, 4.001013278961182, 1.6152317523956299, 2.256509304046631, 1.9474542140960693, 2.559534788131714, 2.873861789703369, 1.0018646717071533, 3.1447834968566895, 2.413715124130249, 2.8577401638031006, 3.3799586296081543, 1.2912483215332031, 2.058560848236084, 2.2132534980773926, 1.7548245191574097, 3.4235191345214844, 3.2572262287139893, 2.193209171295166, 1.0909526348114014, 3.029208183288574, 2.4725475311279297, 3.3361740112304688, 1.2037713527679443, 2.1731719970703125, 2.3610711097717285, 2.7889256477355957, 1.6107202768325806, 2.3151888847351074, 1.1696863174438477, 2.3602395057678223, 3.8198094367980957, 2.3613123893737793, 2.211446762084961, 3.014676809310913, 2.7073683738708496, 2.6328792572021484, 0.15504132211208344, 1.6892260313034058, 1.4510418176651, 0.6326126456260681, 3.2624623775482178, 0.16582629084587097, 1.8331506252288818, 2.810678482055664, 1.7231501340866089, 0.8963783979415894, 1.314002513885498, 1.1904394626617432, 2.8354477882385254, 2.8072242736816406, 1.856715202331543, 2.407931327819824, 2.2417523860931396, 3.1738805770874023, 1.8613380193710327, 1.9964206218719482, 4.624249458312988, 0.902449905872345, 2.2326016426086426, 2.644361972808838, 0.7640438079833984, 2.0448954105377197, 2.0142483711242676, 1.292519450187683, 2.4601798057556152, 3.12947416305542, 4.574952125549316, 2.312117576599121, 1.769157886505127, 0.5384494066238403], "mean_td_error": 2.228123664855957, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 780.5980424066978, "num_env_steps_trained_throughput_per_sec": 224.77041846085717, "timesteps_total": 23296, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 69888, "timers": {"training_iteration_time_ms": 1050.562, "sample_time_ms": 741.45, "load_time_ms": 0.308, "load_throughput": 836461.646, "learn_time_ms": 18.305, "learn_throughput": 14094.571, "synch_weights_time_ms": 10.848}, "counters": {"num_env_steps_sampled": 23296, "num_env_steps_trained": 6450, "num_agent_steps_sampled": 69888, "num_agent_steps_trained": 6450, "last_target_update_ts": 23296, "num_target_updates": 25}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-03", "timestamp": 1700369823, "time_this_iter_s": 1.157749891281128, "time_total_s": 27.24108123779297, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177427a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.24108123779297, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 55.1, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.142083168029785, "actor_loss": -4.859594821929932, "critic_loss": 2.2723565101623535, "alpha_loss": -0.07915445417165756, "alpha_value": 0.9922258257865906, "log_alpha_value": -0.00780455581843853, "target_entropy": -6.0, "policy_t": -0.003555124159902334, "mean_q": 1.1130778789520264, "max_q": 7.63847017288208, "min_q": 0.6625936031341553}, "td_error": [1.5557664632797241, 0.9130058288574219, 3.4141030311584473, 3.4297127723693848, 3.475395679473877, 2.5652337074279785, 0.9268444776535034, 3.196824312210083, 2.297595977783203, 2.0350844860076904, 5.340137481689453, 6.619840145111084, 5.200140953063965, 3.9465739727020264, 2.826995849609375, 3.733829975128174, 2.8960518836975098, 3.818556547164917, 4.494377136230469, 5.040356636047363, 4.535162925720215, 1.5001381635665894, 3.9385855197906494, 2.673466682434082, 2.934141159057617, 3.234614133834839, 3.5849554538726807, 4.8729681968688965, 4.415421009063721, 4.3278350830078125, 3.420990228652954, 3.4574990272521973, 5.171205043792725, 5.004260063171387, 4.553053379058838, 3.612027168273926, 3.7181053161621094, 4.432717323303223, 4.486541748046875, 3.7564785480499268, 3.7609705924987793, 1.5999388694763184, 3.322382688522339, 2.967386245727539, 0.4086618423461914, 4.608924388885498, 4.721303939819336, 3.928555488586426, 4.136555194854736, 5.572070121765137, 3.878554344177246, 4.42159366607666, 3.9422013759613037, 4.058197498321533, 4.663967132568359, 5.213142395019531, 3.46958065032959, 4.161306858062744, 3.446927547454834, 4.061921119689941, 3.3267674446105957, 4.460921287536621, 2.9417879581451416, 4.658673286437988, 3.6849379539489746, 4.137585639953613, 4.036055088043213, 5.689001560211182, 2.922800064086914, 2.8623104095458984, 2.583096742630005, 4.238926887512207, 3.602544069290161, 3.5473616123199463, 5.195652961730957, 4.227569580078125, 3.481081485748291, 3.3132410049438477, 1.4790568351745605, 4.443633079528809, 3.321190357208252, 4.477840423583984, 3.3434219360351562, 2.520799160003662, 4.4731550216674805, 1.7190077304840088], "mean_td_error": 3.678943634033203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147327423095703, "actor_loss": -4.78437614440918, "critic_loss": 0.5066826343536377, "alpha_loss": -0.07916246354579926, "alpha_value": 0.9922290444374084, "log_alpha_value": -0.0078013124875724316, "target_entropy": -6.0, "policy_t": -0.021124504506587982, "mean_q": 0.8267967104911804, "max_q": 6.106324195861816, "min_q": 0.6309536099433899}, "td_error": [1.4721503257751465, 1.3646373748779297, 0.26802289485931396, 1.555428385734558, 2.425947666168213, 2.9486608505249023, 1.3126797676086426, 1.8757503032684326, 3.0584728717803955, 2.3018057346343994, 3.0287232398986816, 2.6958718299865723, 0.8372011780738831, 1.1924829483032227, 2.8044071197509766, 3.943974494934082, 3.2094502449035645, 4.559436798095703, 2.7437400817871094, 1.186863899230957, 0.10676908493041992, 2.3165535926818848, 1.9005050659179688, 1.4568946361541748, 1.502211332321167, 2.4760706424713135, 1.69606614112854, 1.46225905418396, 1.7458298206329346, 1.4833698272705078, 0.2833806574344635, 1.4815046787261963, 0.02821171283721924, 1.2969493865966797, 1.976191520690918, 1.9724576473236084, 1.649678349494934, 2.6145424842834473, 1.9045000076293945, 2.0444228649139404, 0.829081654548645, 1.0524728298187256, 0.5164812803268433, 1.9478638172149658, 0.5740765333175659, 1.8041889667510986, 1.5985379219055176, 1.787825107574463, 1.3423137664794922, 0.43363600969314575, 2.0290350914001465, 1.094509482383728, 1.4577275514602661, 0.8514436483383179, 0.3053901791572571, 2.0894854068756104, 1.1444268226623535, 3.6990890502929688, 2.5870144367218018, 2.5643224716186523, 3.0262813568115234, 1.088548183441162, 1.1030781269073486, 2.5001683235168457, 2.376507043838501, 1.9477505683898926, 1.9123704433441162, 2.1206717491149902, 2.452761173248291, 3.0243701934814453, 0.6601094007492065, 3.1285526752471924, 1.236043930053711, 3.0424270629882812, 3.1436104774475098, 2.038800001144409, 2.7391343116760254, 2.754074811935425, 3.0768086910247803, 1.8319714069366455, 2.131547689437866, 1.6982219219207764, 1.6702231168746948, 2.8922057151794434, 2.199970006942749, 3.727787971496582], "mean_td_error": 1.9234535694122314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102350234985352, "actor_loss": -4.6143598556518555, "critic_loss": 0.6127793788909912, "alpha_loss": -0.07883299887180328, "alpha_value": 0.9922269582748413, "log_alpha_value": -0.007803431246429682, "target_entropy": -6.0, "policy_t": 0.00921925250440836, "mean_q": 0.8810819387435913, "max_q": 5.559418678283691, "min_q": 0.5191718339920044}, "td_error": [2.132356882095337, 2.721221923828125, 0.8815170526504517, 2.389493465423584, 3.0939650535583496, 2.6800897121429443, 2.72703218460083, 3.0344276428222656, 2.2850117683410645, 1.9967875480651855, 2.1824326515197754, 1.8122440576553345, 0.2556821405887604, 1.5447767972946167, 3.191671133041382, 1.4702177047729492, 2.3622121810913086, 2.940431594848633, 1.8122739791870117, 1.4754326343536377, 2.872004508972168, 2.4899630546569824, 2.352815628051758, 3.2478878498077393, 2.808180332183838, 1.1827813386917114, 2.652862071990967, 0.08564627170562744, 2.075925827026367, 1.596285104751587, 1.2695810794830322, 2.4715957641601562, 1.0945779085159302, 1.834580898284912, 1.5494868755340576, 2.8852977752685547, 2.896094799041748, 3.8057873249053955, 4.380697250366211, 2.7211833000183105, 1.7599666118621826, 1.7779473066329956, 0.7923808097839355, 3.716888904571533, 2.715251922607422, 2.2129170894622803, 0.9336581826210022, 3.348484992980957, 2.3124923706054688, 0.5290102958679199, 1.1138103008270264, 1.7721912860870361, 3.3270504474639893, 0.5336465835571289, 2.110553741455078, 2.0859274864196777, 2.112778663635254, 2.2084388732910156, 2.5671305656433105, 1.3755979537963867, 0.420126736164093, 2.2194364070892334, 1.3907166719436646, 3.2953569889068604, 2.269632339477539, 0.5125912427902222, 0.9427434206008911, 1.865612506866455, 2.196788787841797, 1.669701337814331, 2.160659074783325, 2.173987865447998, 2.750720500946045, 3.0901589393615723, 2.072859764099121, 1.3185310363769531, 3.179159641265869, 2.0666449069976807, 1.6271339654922485, 1.6340076923370361, 0.8794893026351929, 1.371956706047058, 2.4505844116210938, 3.169793128967285, 2.223658561706543, 2.698988676071167], "mean_td_error": 2.0955777168273926, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 956.5251346112975, "num_env_steps_trained_throughput_per_sec": 275.42799635012807, "timesteps_total": 25088, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 75264, "timers": {"training_iteration_time_ms": 1030.856, "sample_time_ms": 739.611, "load_time_ms": 0.311, "load_throughput": 830364.052, "learn_time_ms": 18.422, "learn_throughput": 14005.133, "synch_weights_time_ms": 10.073}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 6966, "num_agent_steps_sampled": 75264, "num_agent_steps_trained": 6966, "last_target_update_ts": 25088, "num_target_updates": 27}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-05", "timestamp": 1700369825, "time_this_iter_s": 1.8825039863586426, "time_total_s": 29.12358522415161, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.12358522415161, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 74.8, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114336013793945, "actor_loss": -4.9389848709106445, "critic_loss": 2.3559765815734863, "alpha_loss": -0.08501558750867844, "alpha_value": 0.9916297793388367, "log_alpha_value": -0.008405453525483608, "target_entropy": -6.0, "policy_t": -0.023855336010456085, "mean_q": 0.9460569620132446, "max_q": 5.486101150512695, "min_q": 0.7604750394821167}, "td_error": [5.404880523681641, 5.026946067810059, 3.498109817504883, 1.697887659072876, 2.8124992847442627, 3.1995325088500977, 4.394296646118164, 3.325892925262451, 3.2791695594787598, 3.529402494430542, 4.348489761352539, 4.29356575012207, 3.226492404937744, 3.356106996536255, 3.9692044258117676, 3.995317220687866, 3.3314123153686523, 3.314762592315674, 3.6327004432678223, 2.946658134460449, 4.565195560455322, 3.785367012023926, 5.339824199676514, 3.5672526359558105, 3.171494483947754, 3.91190242767334, 3.2328178882598877, 1.9391509294509888, 0.6588547229766846, 5.747641563415527, 3.177013874053955, 0.28587794303894043, 4.196911811828613, 2.2730712890625, 4.880224704742432, 0.27280187606811523, 2.6721880435943604, 4.52983283996582, 5.152379989624023, 2.8536248207092285, 4.395243167877197, 3.771695137023926, 2.3972322940826416, 4.74611234664917, 4.053411960601807, 4.101987838745117, 4.380465507507324, 4.818543910980225, 4.3379011154174805, 4.781681060791016, 4.007560729980469, 4.230792999267578, 3.2059881687164307, 5.280066013336182, 4.257946014404297, 4.432692050933838, 3.659123420715332, 4.210038185119629, 3.918027400970459, 3.000202178955078, 3.3311524391174316, 4.779208660125732, 4.0434956550598145, 3.533367156982422, 3.511539936065674, 3.1458077430725098, 3.2269186973571777, 3.3933568000793457, 3.7882840633392334, 5.8519463539123535, 3.5556960105895996, 0.7345904111862183, 5.136087894439697, 4.975241661071777, 3.818108558654785, 2.848902463912964, 4.744496822357178, 4.097420692443848, 2.170504570007324, 4.440975666046143, 4.610106468200684, 4.167478084564209, 1.8525800704956055, 2.2535271644592285, 4.676095962524414, 2.862771987915039], "mean_td_error": 3.6782922744750977, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.013731002807617, "actor_loss": -4.7400736808776855, "critic_loss": 0.527759850025177, "alpha_loss": -0.0841255709528923, "alpha_value": 0.99163419008255, "log_alpha_value": -0.008401022292673588, "target_entropy": -6.0, "policy_t": -0.01923084259033203, "mean_q": 0.9945268630981445, "max_q": 6.262643814086914, "min_q": 0.7117902040481567}, "td_error": [1.5399940013885498, 0.166436105966568, 5.163426399230957, 1.068864345550537, 2.5330686569213867, 3.9019289016723633, 0.7687596082687378, 1.9472358226776123, 3.0529699325561523, 1.2263597249984741, 1.4877254962921143, 0.40189841389656067, 0.9638873338699341, 1.0378272533416748, 2.3417482376098633, 3.1751561164855957, 3.708009958267212, 1.8618404865264893, 0.6824703812599182, 2.312541961669922, 1.5979554653167725, 2.451038360595703, 0.14452385902404785, 1.6433675289154053, 3.192194938659668, 2.280900478363037, 2.7721898555755615, 2.275561809539795, 1.0503000020980835, 1.4575788974761963, 0.1970994472503662, 1.3555641174316406, 3.452603816986084, 0.43352508544921875, 1.6412174701690674, 3.1604323387145996, 1.0630171298980713, 1.5985536575317383, 3.8501689434051514, 4.476713180541992, 3.391019105911255, 0.3668373227119446, 1.7152352333068848, 3.0819926261901855, 1.3648860454559326, 2.013279676437378, 2.3705456256866455, 1.5788817405700684, 1.1391764879226685, 0.6276475191116333, 1.6509580612182617, 2.114838123321533, 1.2379406690597534, 3.3732967376708984, 1.0910594463348389, 1.7027586698532104, 2.464139938354492, 4.196908950805664, 1.665130376815796, 1.6401078701019287, 2.3624720573425293, 1.08920156955719, 1.3176343441009521, 1.864699125289917, 0.8733326196670532, 3.5743465423583984, 1.0150847434997559, 1.1254686117172241, 2.6582226753234863, 1.6044886112213135, 0.7360828518867493, 1.9520528316497803, 1.1441724300384521, 2.7830018997192383, 2.546602964401245, 2.295987129211426, 2.9492900371551514, 1.4143670797348022, 1.1711580753326416, 3.0412824153900146, 1.5653579235076904, 4.226634979248047, 1.8001877069473267, 1.9383729696273804, 1.0566762685775757, 1.7381501197814941], "mean_td_error": 1.9542747735977173, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130647659301758, "actor_loss": -4.707302570343018, "critic_loss": 0.6128745079040527, "alpha_loss": -0.08513399213552475, "alpha_value": 0.9916316270828247, "log_alpha_value": -0.00840360764414072, "target_entropy": -6.0, "policy_t": -0.00012062871246598661, "mean_q": 0.9107536673545837, "max_q": 5.63572883605957, "min_q": 0.5936316251754761}, "td_error": [2.6043269634246826, 0.8945412635803223, 1.839858055114746, 2.271501064300537, 1.138497233390808, 2.801058292388916, 2.139772891998291, 2.2139177322387695, 1.4256603717803955, 1.2381627559661865, 3.043809413909912, 1.6689658164978027, 0.8364835977554321, 0.5475145578384399, 3.738386631011963, 2.976226329803467, 1.1444401741027832, 0.4202793538570404, 0.05280795693397522, 3.0268900394439697, 1.5240590572357178, 1.2641658782958984, 3.1151487827301025, 1.8336155414581299, 1.8466291427612305, 2.1056065559387207, 2.209871768951416, 1.5326813459396362, 1.3503139019012451, 2.3225245475769043, 1.1997997760772705, 0.8537925481796265, 0.2013542652130127, 2.364987373352051, 1.7201542854309082, 2.448096752166748, 1.9928524494171143, 4.0996904373168945, 1.2891478538513184, 2.808678150177002, 2.6977148056030273, 3.732326030731201, 0.16814371943473816, 2.292548418045044, 2.5706162452697754, 4.121671676635742, 2.1262054443359375, 2.282928466796875, 1.7220335006713867, 1.7500241994857788, 2.521196126937866, 2.85703182220459, 2.889464855194092, 0.8555114269256592, 2.9487974643707275, 1.2545616626739502, 2.227698802947998, 1.8544862270355225, 2.4486517906188965, 3.0892648696899414, 3.2832722663879395, 0.9399759769439697, 2.3253488540649414, 2.4397640228271484, 2.9537177085876465, 1.0474815368652344, 1.4762897491455078, 2.5652103424072266, 1.4157938957214355, 1.9079973697662354, 1.6863707304000854, 2.4429872035980225, 3.001978635787964, 0.5436670184135437, 3.4396839141845703, 2.419215679168701, 2.5262694358825684, 2.4049315452575684, 3.045762538909912, 2.211050033569336, 2.2094509601593018, 3.9956398010253906, 2.454120635986328, 1.5405941009521484, 1.1473345756530762, 1.8522270917892456], "mean_td_error": 2.067363739013672, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 908.2690809860146, "num_env_steps_trained_throughput_per_sec": 261.53283805177654, "timesteps_total": 26880, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 1031.631, "sample_time_ms": 741.214, "load_time_ms": 0.312, "load_throughput": 825927.669, "learn_time_ms": 18.394, "learn_throughput": 14026.536, "synch_weights_time_ms": 10.42}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 7482, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 7482, "last_target_update_ts": 26880, "num_target_updates": 29}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-07", "timestamp": 1700369827, "time_this_iter_s": 1.9832780361175537, "time_total_s": 31.106863260269165, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b96c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 31.106863260269165, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 71.16666666666667, "ram_util_percent": 65.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070104598999023, "actor_loss": -5.018606662750244, "critic_loss": 2.263015031814575, "alpha_loss": -0.09069561958312988, "alpha_value": 0.9910340309143066, "log_alpha_value": -0.009006422944366932, "target_entropy": -6.0, "policy_t": 0.0076792119070887566, "mean_q": 1.1184722185134888, "max_q": 7.77688455581665, "min_q": 0.8688005208969116}, "td_error": [3.2965903282165527, 6.237795829772949, 4.580394744873047, 5.69183874130249, 4.118299961090088, 3.2171216011047363, 3.3678767681121826, 2.787933588027954, 3.1431150436401367, 2.7680306434631348, 4.2822265625, 2.9569079875946045, 4.267102241516113, 2.4791924953460693, 3.7587809562683105, 3.0627946853637695, 3.2474005222320557, 4.691205024719238, 3.2228827476501465, 5.672285556793213, 5.225063323974609, 1.7879555225372314, 2.831808090209961, 4.7496185302734375, 3.010159730911255, 3.0049924850463867, 2.740525722503662, 6.840317726135254, 6.168612957000732, 3.0153117179870605, 4.243241786956787, 2.812894344329834, 3.0554111003875732, 3.761500120162964, 4.022688865661621, 2.1292519569396973, 4.710198402404785, 4.1620330810546875, 2.313835620880127, 5.488258361816406, 2.994579315185547, 5.06305456161499, 2.5370612144470215, 4.863875389099121, 2.761645555496216, 6.031935691833496, 4.781654357910156, 4.073802471160889, 3.913280487060547, 2.6946563720703125, 3.853560209274292, 2.545353412628174, 3.6090762615203857, 4.121731758117676, 3.024376392364502, 5.249776840209961, 2.9644594192504883, 4.709534168243408, 3.3220744132995605, 1.9006298780441284, 5.881097316741943, 3.7856240272521973, 4.363156318664551, 4.404575347900391, 1.627854585647583, 2.476832866668701, 4.358454704284668, 3.1648921966552734, 3.663449287414551, 5.111454010009766, 4.076154708862305, 4.508045196533203, 1.3442782163619995, 3.702580690383911, 4.310205459594727, 4.807502746582031, 2.7331621646881104, 5.2962188720703125, 1.8931655883789062, 4.504543304443359, 5.246342658996582, 3.4097251892089844, 3.6256942749023438, 1.95370614528656, 2.670121669769287, 1.2203834056854248], "mean_td_error": 3.7451021671295166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107933044433594, "actor_loss": -4.922260284423828, "critic_loss": 0.5306721925735474, "alpha_loss": -0.09097588062286377, "alpha_value": 0.9910399317741394, "log_alpha_value": -0.009000442922115326, "target_entropy": -6.0, "policy_t": 0.007311098277568817, "mean_q": 0.8936909437179565, "max_q": 3.606311559677124, "min_q": 0.7963069677352905}, "td_error": [1.7704589366912842, 1.7414122819900513, 0.24479517340660095, 1.0955798625946045, 1.7747701406478882, 2.476566791534424, 0.8134366273880005, 0.35139861702919006, 1.5166287422180176, 2.895219326019287, 0.16773858666419983, 0.5292821526527405, 2.007838487625122, 0.44374120235443115, 3.2740955352783203, 1.2842248678207397, 1.406203031539917, 2.6821787357330322, 3.1750550270080566, 1.6407102346420288, 1.9255199432373047, 1.171409249305725, 2.644974708557129, 2.1485652923583984, 2.2818470001220703, 2.329700469970703, 2.4457504749298096, 0.8691778182983398, 0.10593271255493164, 2.167124032974243, 2.9653103351593018, 3.0440893173217773, 3.088773012161255, 1.6114532947540283, 0.06483769416809082, 0.2065369188785553, 0.3465460538864136, 2.010918378829956, 0.951749324798584, 3.372276544570923, 1.3529744148254395, 3.2169711589813232, 2.8320112228393555, 1.172919511795044, 3.5961554050445557, 1.913672685623169, 2.150599956512451, 1.9613791704177856, 3.495187282562256, 2.102252960205078, 3.1199214458465576, 3.1713337898254395, 2.7225823402404785, 2.883340835571289, 2.7590694427490234, 2.3229074478149414, 1.4061206579208374, 1.7005033493041992, 3.5676374435424805, 3.434518337249756, 0.3707878291606903, 2.418275833129883, 2.7622921466827393, 2.40616512298584, 1.5337979793548584, 2.086613178253174, 1.480392575263977, 3.3216755390167236, 0.6173278093338013, 1.3260157108306885, 2.112520456314087, 1.6344678401947021, 2.7083194255828857, 1.2674026489257812, 1.941293716430664, 0.8671663999557495, 1.091284990310669, 3.401885986328125, 1.6277737617492676, 1.6157174110412598, 1.3989773988723755, 2.621455669403076, 0.920443594455719, 2.745135545730591, 1.0563569068908691, 4.104549884796143], "mean_td_error": 1.9460928440093994, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122719764709473, "actor_loss": -4.770897388458252, "critic_loss": 0.6484397053718567, "alpha_loss": -0.09114468097686768, "alpha_value": 0.9910364151000977, "log_alpha_value": -0.00900397077202797, "target_entropy": -6.0, "policy_t": 0.0011660780292004347, "mean_q": 0.8861215114593506, "max_q": 5.601450443267822, "min_q": 0.6717043519020081}, "td_error": [2.4789552688598633, 1.9038724899291992, 2.229156255722046, 2.498279094696045, 1.4726550579071045, 2.0527641773223877, 1.8083454370498657, 0.7052290439605713, 2.8095247745513916, 2.0605366230010986, 2.403693675994873, 0.528387188911438, 1.510735034942627, 2.8078250885009766, 2.4833860397338867, 2.702918529510498, 1.8129312992095947, 3.1399900913238525, 3.7405569553375244, 2.3086400032043457, 3.565446615219116, 0.8857439756393433, 3.1756250858306885, 0.5731360912322998, 2.6824305057525635, 3.3280680179595947, 3.9110891819000244, 0.9566052556037903, 1.2193219661712646, 3.1714701652526855, 0.5453319549560547, 2.3312551975250244, 1.5611369609832764, 1.2654988765716553, 1.7810862064361572, 0.6606494188308716, 2.7244839668273926, 2.1423282623291016, 2.8416848182678223, 2.3070850372314453, 2.4669244289398193, 3.476591110229492, 1.6007975339889526, 4.375307083129883, 1.710472583770752, 2.830361843109131, 2.2407169342041016, 2.9686007499694824, 1.694879412651062, 2.0521955490112305, 2.8784890174865723, 2.6631765365600586, 2.7198903560638428, 3.6275243759155273, 3.25612735748291, 3.3422694206237793, 1.8708173036575317, 2.171379566192627, 2.081984281539917, 2.4050562381744385, 4.398323059082031, 2.2562241554260254, 1.9616620540618896, 2.1145987510681152, 2.1392393112182617, 3.053387403488159, 3.6091041564941406, 0.5901451110839844, 2.159604072570801, 2.3203630447387695, 1.7526884078979492, 1.5406759977340698, 0.16539981961250305, 2.8429245948791504, 1.472411870956421, 1.8876588344573975, 2.080972194671631, 3.0513250827789307, 1.4167499542236328, 1.2586321830749512, 2.957709550857544, 0.6318966150283813, 1.32266366481781, 0.5202155113220215, 2.430384874343872, 3.1523826122283936], "mean_td_error": 2.216381072998047, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 836.772324609905, "num_env_steps_trained_throughput_per_sec": 240.94560239883424, "timesteps_total": 28672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 1038.344, "sample_time_ms": 746.738, "load_time_ms": 0.311, "load_throughput": 830491.506, "learn_time_ms": 18.517, "learn_throughput": 13933.147, "synch_weights_time_ms": 9.857}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 7998, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 7998, "last_target_update_ts": 28672, "num_target_updates": 31}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-09", "timestamp": 1700369829, "time_this_iter_s": 2.152038097381592, "time_total_s": 33.25890135765076, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.25890135765076, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.36666666666666, "ram_util_percent": 65.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101266860961914, "actor_loss": -5.121565818786621, "critic_loss": 2.191107749938965, "alpha_loss": -0.09401076287031174, "alpha_value": 0.9907363653182983, "log_alpha_value": -0.009306828491389751, "target_entropy": -6.0, "policy_t": 0.03998187556862831, "mean_q": 1.1825222969055176, "max_q": 8.142013549804688, "min_q": 0.9257702827453613}, "td_error": [4.189028739929199, 4.491968154907227, 3.8789544105529785, 2.6724488735198975, 4.82185697555542, 4.586321830749512, 4.541222095489502, 4.326689720153809, 3.9384114742279053, 4.018289089202881, 4.409087181091309, 3.4595236778259277, 3.466268539428711, 2.5181469917297363, 3.8998796939849854, 5.422946453094482, 4.0115203857421875, 2.9521660804748535, 1.6838362216949463, 4.318794250488281, 3.908295154571533, 2.674333095550537, 0.16827630996704102, 5.228764057159424, 3.1399307250976562, 3.6707448959350586, 4.519225120544434, 6.388746738433838, 3.1060051918029785, 4.586795806884766, 3.6097052097320557, 2.579862356185913, 5.0838117599487305, 4.952968120574951, 2.7844667434692383, 3.5459702014923096, 3.9992122650146484, 4.423149108886719, 2.648029088973999, 4.3774309158325195, 3.691270351409912, 3.911957025527954, 5.014759063720703, 3.4081859588623047, 2.183931827545166, 3.1815850734710693, 3.9062728881835938, 5.470841407775879, 4.7110514640808105, 1.209089994430542, 1.7873423099517822, 4.334773063659668, 3.6969094276428223, 3.7549691200256348, 4.297548294067383, 2.014711856842041, 2.8319315910339355, 5.394729137420654, 4.647247314453125, 3.005620002746582, 3.696824550628662, 2.4680957794189453, 3.353647232055664, 2.5186338424682617, 4.523522853851318, 3.671975612640381, 5.532146453857422, 1.8795018196105957, 3.404651641845703, 3.71736478805542, 4.238778591156006, 3.4815118312835693, 3.6446566581726074, 2.4917755126953125, 4.332484245300293, 2.2044591903686523, 4.427287578582764, 2.4229259490966797, 3.061448574066162, 1.6766884326934814, 2.6010687351226807, 4.593029022216797, 3.8500359058380127, 1.5713889598846436, 2.2536780834198, 2.4253721237182617], "mean_td_error": 3.5988457202911377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08358383178711, "actor_loss": -4.943573474884033, "critic_loss": 0.5538855195045471, "alpha_loss": -0.09377970546483994, "alpha_value": 0.9907428622245789, "log_alpha_value": -0.009300236590206623, "target_entropy": -6.0, "policy_t": -0.024352343752980232, "mean_q": 1.2173373699188232, "max_q": 6.332035064697266, "min_q": 0.8408764600753784}, "td_error": [2.9032764434814453, 0.2966965138912201, 1.5482282638549805, 1.8857979774475098, 2.8831894397735596, 0.6256166696548462, 3.8889780044555664, 2.21634840965271, 2.616478443145752, 2.902794599533081, 2.949514150619507, 0.3993247449398041, 2.0893359184265137, 3.8356757164001465, 1.5160019397735596, 0.8630695939064026, 1.4844214916229248, 1.3619670867919922, 1.7460322380065918, 0.8456718921661377, 1.0938682556152344, 1.7019264698028564, 1.929673671722412, 1.7399001121520996, 3.407052755355835, 0.29251736402511597, 1.723772644996643, 0.6671889424324036, 0.08659380674362183, 1.6615517139434814, 1.2073761224746704, 1.8517043590545654, 2.8892409801483154, 1.1834619045257568, 2.225130796432495, 2.957674503326416, 3.234833240509033, 3.106043815612793, 1.0615792274475098, 2.3341634273529053, 1.8789153099060059, 2.5930962562561035, 2.602599620819092, 1.4384949207305908, 1.745289921760559, 1.0625336170196533, 2.0325913429260254, 3.5955698490142822, 1.9219317436218262, 2.9508285522460938, 2.1900413036346436, 2.592827796936035, 0.20761048793792725, 0.13940545916557312, 0.34954118728637695, 1.4210050106048584, 2.752213478088379, 3.4683468341827393, 1.9914189577102661, 1.3281540870666504, 0.13050687313079834, 1.6874362230300903, 2.1678242683410645, 4.513162612915039, 3.64750337600708, 1.0761494636535645, 0.15151840448379517, 2.260096549987793, 4.026687145233154, 2.56349515914917, 1.7306609153747559, 1.649472951889038, 0.15155541896820068, 1.991835594177246, 1.7423194646835327, 2.9635186195373535, 3.243943691253662, 1.8855534791946411, 4.943819046020508, 3.1447272300720215, 2.370110511779785, 2.2883970737457275, 0.2882954180240631, 1.8362069129943848, 1.2259576320648193, 2.7565829753875732], "mean_td_error": 1.975737452507019, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108955383300781, "actor_loss": -4.791224002838135, "critic_loss": 0.581012487411499, "alpha_loss": -0.09405592083930969, "alpha_value": 0.9907389283180237, "log_alpha_value": -0.00930421706289053, "target_entropy": -6.0, "policy_t": 0.000866561196744442, "mean_q": 0.9366776943206787, "max_q": 5.080839157104492, "min_q": 0.7132570147514343}, "td_error": [3.1529653072357178, 0.4718291759490967, 1.2916144132614136, 1.6061406135559082, 2.639801502227783, 2.7056596279144287, 1.726923942565918, 2.945474147796631, 5.131373405456543, 1.1666579246520996, 2.4903578758239746, 2.9967827796936035, 3.583266258239746, 1.8657231330871582, 1.5300827026367188, 2.032737970352173, 2.8698935508728027, 3.9237546920776367, 0.6680591106414795, 1.4321072101593018, 0.9439244866371155, 2.4634838104248047, 2.5991735458374023, 1.0674104690551758, 1.616362452507019, 0.4156421422958374, 3.9805734157562256, 1.2761683464050293, 1.2045297622680664, 1.466652750968933, 3.8970561027526855, 0.3769610822200775, 3.0345818996429443, 2.8482227325439453, 2.1274795532226562, 3.407444953918457, 0.7392537593841553, 1.7196680307388306, 1.9891631603240967, 1.3396540880203247, 0.7634307146072388, 0.48589664697647095, 2.4703922271728516, 2.0957679748535156, 2.1414458751678467, 2.6623663902282715, 1.549439787864685, 2.19692325592041, 2.6021578311920166, 2.3889708518981934, 2.5518815517425537, 3.8614487648010254, 1.012371301651001, 1.6089547872543335, 0.46030139923095703, 1.8596901893615723, 1.9462110996246338, 1.1702920198440552, 1.3598626852035522, 0.33625611662864685, 3.463581085205078, 1.9963726997375488, 3.540726661682129, 2.1139190196990967, 1.3551766872406006, 0.7956019639968872, 0.3815930187702179, 3.1578328609466553, 0.36832836270332336, 1.4324266910552979, 1.076574444770813, 2.5311279296875, 1.5587799549102783, 0.8550651669502258, 1.3223402500152588, 1.5569062232971191, 3.425671100616455, 2.2671031951904297, 1.6377122402191162, 0.40212559700012207, 1.4972622394561768, 1.0405292510986328, 3.0368313789367676, 2.210174560546875, 1.8795255422592163, 4.325299263000488], "mean_td_error": 1.9708985090255737, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 855.6027300266965, "num_env_steps_trained_throughput_per_sec": 246.36775038715143, "timesteps_total": 29568, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 88704, "timers": {"training_iteration_time_ms": 1045.167, "sample_time_ms": 753.458, "load_time_ms": 0.312, "load_throughput": 826495.404, "learn_time_ms": 18.526, "learn_throughput": 13926.674, "synch_weights_time_ms": 9.869}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 88704, "num_agent_steps_trained": 8256, "last_target_update_ts": 29568, "num_target_updates": 32}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-10", "timestamp": 1700369830, "time_this_iter_s": 1.0560991764068604, "time_total_s": 34.31500053405762, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 34.31500053405762, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.69999999999999, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094293594360352, "actor_loss": -5.1582932472229, "critic_loss": 2.085477828979492, "alpha_loss": -0.09697818011045456, "alpha_value": 0.9904387593269348, "log_alpha_value": -0.009607228450477123, "target_entropy": -6.0, "policy_t": 0.02496269717812538, "mean_q": 1.3350645303726196, "max_q": 10.286096572875977, "min_q": 0.9842962026596069}, "td_error": [3.4931983947753906, 3.8167884349823, 2.101065158843994, 5.047451019287109, 4.660846710205078, 2.787759780883789, 5.618497848510742, 3.0973281860351562, 2.9430456161499023, 5.493903160095215, 3.80859375, 4.754667282104492, 3.639282703399658, 3.684626579284668, 2.4089341163635254, 3.194157123565674, 3.7962076663970947, 2.03623628616333, 3.1320078372955322, 3.5999388694763184, 2.498044729232788, 4.174321174621582, 4.02834415435791, 4.426216125488281, 5.659440994262695, 4.221627235412598, 2.9338645935058594, 7.304230690002441, 3.7752323150634766, 3.859382152557373, 5.082154750823975, 5.112139701843262, 3.4184813499450684, 6.052976131439209, 1.8711512088775635, 3.5670785903930664, 2.6352269649505615, 4.271590232849121, 4.031245231628418, 3.953199625015259, 1.3763937950134277, 1.386902093887329, 2.3133881092071533, 2.4714579582214355, 6.571030616760254, 2.7562856674194336, 4.854459762573242, 1.9359123706817627, 2.4337615966796875, 4.6724443435668945, 4.570883274078369, 3.7045798301696777, 4.574640274047852, 5.516900062561035, 4.835829734802246, 2.867335796356201, 2.8221378326416016, 3.2390074729919434, 4.415594100952148, 2.9732229709625244, 4.3233442306518555, 3.604686737060547, 3.7188658714294434, 1.899244785308838, 5.513182640075684, 3.3724365234375, 3.874051094055176, 3.6295104026794434, 3.503772735595703, 4.30873966217041, 1.548598051071167, 4.516622543334961, 4.580723762512207, 3.6959400177001953, 4.828339099884033, 3.764712333679199, 4.811066150665283, 3.738563299179077, 3.6555933952331543, 3.970923662185669, 4.264616966247559, 2.9393093585968018, 5.124393463134766, 4.353704452514648, 4.352542877197266, 3.884408473968506], "mean_td_error": 3.81465744972229, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115753173828125, "actor_loss": -5.015090465545654, "critic_loss": 0.5262854099273682, "alpha_loss": -0.0971115380525589, "alpha_value": 0.9904459118843079, "log_alpha_value": -0.00960003025829792, "target_entropy": -6.0, "policy_t": -0.0016253890935331583, "mean_q": 1.005286693572998, "max_q": 5.249211311340332, "min_q": 0.886262059211731}, "td_error": [1.127954363822937, 2.322075128555298, 1.1543097496032715, 2.7630176544189453, 1.1303778886795044, 2.292487621307373, 1.3863067626953125, 1.4865885972976685, 1.3384358882904053, 2.061152935028076, 2.7193045616149902, 1.6380505561828613, 0.10272222757339478, 0.5237244367599487, 0.822596549987793, 2.874281883239746, 1.2581098079681396, 1.1537199020385742, 0.15170571208000183, 2.1842007637023926, 1.498450517654419, 2.176849842071533, 3.679255247116089, 2.9435601234436035, 1.9704880714416504, 3.4576101303100586, 1.6863114833831787, 1.7138893604278564, 2.1319005489349365, 2.650674819946289, 2.401035785675049, 1.3952536582946777, 3.170351982116699, 2.7379469871520996, 3.0128350257873535, 1.4551348686218262, 2.275207042694092, 3.4570412635803223, 2.348588466644287, 2.7506449222564697, 0.2711698114871979, 1.0770249366760254, 0.5038431286811829, 2.503526210784912, 1.20377516746521, 1.9562797546386719, 2.0207488536834717, 1.7048499584197998, 2.0388991832733154, 2.5792579650878906, 1.9785590171813965, 2.556598663330078, 2.609844923019409, 1.6910107135772705, 3.2686784267425537, 0.5704225301742554, 2.99967622756958, 3.158906936645508, 0.9398986101150513, 3.242743730545044, 2.4685511589050293, 1.6836774349212646, 2.0076160430908203, 2.6453752517700195, 2.7703018188476562, 1.7515770196914673, 1.1707119941711426, 2.11643385887146, 2.1964192390441895, 1.1895115375518799, 1.2245121002197266, 2.216202974319458, 1.9095487594604492, 2.606292247772217, 0.4907809793949127, 3.0047898292541504, 2.720815658569336, 1.4498937129974365, 0.5636119842529297, 3.762354850769043, 1.4344286918640137, 0.8131462335586548, 2.4679272174835205, 1.0675437450408936, 1.956329107284546, 1.2715775966644287], "mean_td_error": 1.9446487426757812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077011108398438, "actor_loss": -4.809835910797119, "critic_loss": 0.5786162614822388, "alpha_loss": -0.0967843234539032, "alpha_value": 0.9904415011405945, "log_alpha_value": -0.009604466147720814, "target_entropy": -6.0, "policy_t": -0.004622557200491428, "mean_q": 0.9991726279258728, "max_q": 5.067410469055176, "min_q": 0.7574611306190491}, "td_error": [2.764324188232422, 2.388375759124756, 3.004408121109009, 2.199578046798706, 0.6462965607643127, 3.009028434753418, 2.400817632675171, 1.8351062536239624, 3.345766544342041, 1.6423301696777344, 2.280979633331299, 1.6184855699539185, 1.2899467945098877, 3.0898733139038086, 3.204566478729248, 3.328543186187744, 3.576902389526367, 1.9317318201065063, 2.3457183837890625, 1.4427038431167603, 2.789926052093506, 1.9656851291656494, 0.6986346244812012, 0.6022429466247559, 1.345792531967163, 1.9148099422454834, 4.237544059753418, 1.636064887046814, 0.7947053909301758, 4.697325706481934, 0.9780710935592651, 3.605715274810791, 0.8476414084434509, 2.358217716217041, 0.9348362684249878, 2.9604616165161133, 1.463697910308838, 5.512809753417969, 3.1694416999816895, 2.095305919647217, 3.402841567993164, 0.16121089458465576, 0.9675896167755127, 2.173962116241455, 1.411463975906372, 2.5431525707244873, 2.8223037719726562, 1.2299387454986572, 2.57641863822937, 0.7583339810371399, 2.3323211669921875, 2.2020020484924316, 2.779606342315674, 1.7973456382751465, 3.0866241455078125, 1.5566251277923584, 1.2154805660247803, 0.06250566244125366, 1.315659999847412, 1.1873204708099365, 1.6323018074035645, 3.256673574447632, 1.1535362005233765, 2.0144472122192383, 0.6652252674102783, 1.3548424243927002, 1.5275412797927856, 2.704244375228882, 1.8507341146469116, 0.987718939781189, 1.92961847782135, 2.1041059494018555, 1.7331185340881348, 3.002413749694824, 3.3998680114746094, 1.5020620822906494, 0.9596998691558838, 0.897960901260376, 0.33138906955718994, 0.035480767488479614, 1.0400723218917847, 2.1980791091918945, 1.366355538368225, 2.105525016784668, 0.16615748405456543, 1.950910210609436], "mean_td_error": 1.9698512554168701, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 873.9051779065322, "num_env_steps_trained_throughput_per_sec": 251.63787488826486, "timesteps_total": 30464, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 91392, "timers": {"training_iteration_time_ms": 1038.474, "sample_time_ms": 748.367, "load_time_ms": 0.313, "load_throughput": 825171.902, "learn_time_ms": 18.256, "learn_throughput": 14132.564, "synch_weights_time_ms": 9.51}, "counters": {"num_env_steps_sampled": 30464, "num_env_steps_trained": 8514, "num_agent_steps_sampled": 91392, "num_agent_steps_trained": 8514, "last_target_update_ts": 30464, "num_target_updates": 33}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-11", "timestamp": 1700369831, "time_this_iter_s": 1.0344760417938232, "time_total_s": 35.34947657585144, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177439c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.34947657585144, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 74.7, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107257843017578, "actor_loss": -5.241916656494141, "critic_loss": 2.024554491043091, "alpha_loss": -0.10013875365257263, "alpha_value": 0.9901413321495056, "log_alpha_value": -0.009907607920467854, "target_entropy": -6.0, "policy_t": 0.034257084131240845, "mean_q": 1.3252393007278442, "max_q": 10.621689796447754, "min_q": 1.0439949035644531}, "td_error": [4.7966108322143555, 2.0673723220825195, 3.7933597564697266, 4.696378707885742, 3.9833767414093018, 3.7458372116088867, 2.544992446899414, 3.9267001152038574, 5.677400588989258, 5.048511505126953, 2.9951062202453613, 2.7524795532226562, 3.0057497024536133, 1.2371406555175781, 3.7271366119384766, 3.458343744277954, 2.2968971729278564, 0.8188964128494263, 3.9358620643615723, 3.3176698684692383, 2.9523353576660156, 4.27371883392334, 2.0233144760131836, 3.3695216178894043, 3.714829206466675, 3.436723232269287, 2.6121368408203125, 3.961927652359009, 3.2484893798828125, 4.273195266723633, 4.945289611816406, 3.822701930999756, 2.9755845069885254, 3.97829532623291, 3.947756290435791, 4.034004211425781, 1.6258846521377563, 5.886325359344482, 2.5154881477355957, 2.6252217292785645, 5.013294219970703, 4.138819694519043, 3.777653217315674, 5.579113960266113, 2.8726043701171875, 3.9097681045532227, 3.2281570434570312, 3.809340000152588, 2.592686653137207, 4.145252704620361, 4.360550880432129, 2.8796377182006836, 2.958847999572754, 4.993412017822266, 5.097159385681152, 4.219431400299072, 2.6307530403137207, 4.433098316192627, 3.92563796043396, 3.681487798690796, 5.416140079498291, 3.723538875579834, 3.4586639404296875, 3.2075765132904053, 3.83597731590271, 2.3597216606140137, 6.862610340118408, 4.287112712860107, 3.926220417022705, 4.268467426300049, 3.3172354698181152, 4.311119079589844, 3.7075276374816895, 3.9123880863189697, 4.358834266662598, 0.5775649547576904, 3.863616466522217, 4.748264789581299, 4.418868541717529, 3.914095878601074, 4.505336761474609, 4.813467979431152, 4.250612258911133, 3.958085775375366, 2.6255993843078613, 4.495755672454834], "mean_td_error": 3.7141823768615723, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091824531555176, "actor_loss": -5.04164457321167, "critic_loss": 0.576724648475647, "alpha_loss": -0.09990798681974411, "alpha_value": 0.9901489615440369, "log_alpha_value": -0.009899892844259739, "target_entropy": -6.0, "policy_t": 0.006725158076733351, "mean_q": 1.256300687789917, "max_q": 6.32899284362793, "min_q": 0.9342519044876099}, "td_error": [2.7792482376098633, 1.8373923301696777, 2.1675949096679688, 1.8196409940719604, 1.4299747943878174, 1.1458954811096191, 2.3559396266937256, 1.4858075380325317, 0.760405957698822, 2.573896884918213, 1.414048433303833, 2.605747699737549, 1.3563592433929443, 1.1169397830963135, 3.0104475021362305, 1.4154802560806274, 4.604011535644531, 2.2884304523468018, 2.863539695739746, 2.3377771377563477, 3.709716796875, 0.8536115884780884, 3.985346794128418, 1.249010443687439, 1.441131830215454, 1.7450369596481323, 2.339358329772949, 1.4499573707580566, 1.8503867387771606, 2.305854558944702, 2.1577727794647217, 0.030052542686462402, 3.4219253063201904, 1.7106070518493652, 4.044207572937012, 2.543055534362793, 4.376651763916016, 2.057664394378662, 0.28446805477142334, 2.8203208446502686, 0.8795602321624756, 1.8655672073364258, 1.8937036991119385, 1.7535781860351562, 0.4548271596431732, 2.960604190826416, 3.404240131378174, 2.387784004211426, 4.478057861328125, 2.7325291633605957, 2.090000629425049, 1.7675588130950928, 2.920722007751465, 3.6624956130981445, 2.3380486965179443, 0.048974454402923584, 0.8356583118438721, 2.2402472496032715, 2.661581039428711, 3.061966896057129, 0.3437631130218506, 0.18404224514961243, 1.2211538553237915, 1.4302211999893188, 1.4741092920303345, 3.600065231323242, 3.093667984008789, 2.2587506771087646, 2.6620354652404785, 3.931666135787964, 2.1591598987579346, 1.6711158752441406, 1.000260353088379, 1.7729594707489014, 0.2479552924633026, 0.9683676958084106, 2.070601463317871, 1.0311079025268555, 2.7096757888793945, 2.430427074432373, 1.9272816181182861, 0.08000165224075317, 2.662240505218506, 3.327589511871338, 3.0830678939819336, 1.4927948713302612], "mean_td_error": 2.081587076187134, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135380744934082, "actor_loss": -4.897643566131592, "critic_loss": 0.5852801203727722, "alpha_loss": -0.10038738697767258, "alpha_value": 0.9901442527770996, "log_alpha_value": -0.009904648177325726, "target_entropy": -6.0, "policy_t": 0.009498286060988903, "mean_q": 0.9873562455177307, "max_q": 5.5313310623168945, "min_q": 0.8037436604499817}, "td_error": [3.4296884536743164, 3.724172592163086, 2.8760690689086914, 0.7668206691741943, 1.2047951221466064, 1.790001630783081, 0.7036111950874329, 0.8623442649841309, 2.6061341762542725, 2.767529010772705, 2.48714280128479, 4.738650321960449, 0.9108771085739136, 0.48426616191864014, 2.9654908180236816, 3.4812893867492676, 2.097640037536621, 1.9843288660049438, 2.1208198070526123, 3.0920305252075195, 2.765317678451538, 0.6701570749282837, 1.3324105739593506, 2.0783822536468506, 2.6030869483947754, 2.6841375827789307, 1.9263105392456055, 2.1927330493927, 3.5151236057281494, 1.9467703104019165, 1.9199657440185547, 1.3122711181640625, 0.9185639023780823, 1.5463454723358154, 1.9111526012420654, 2.248947858810425, 1.4892246723175049, 1.1416786909103394, 1.8047630786895752, 1.8813164234161377, 3.5309829711914062, 2.986661434173584, 1.4411273002624512, 3.109745502471924, 1.9583749771118164, 2.5814571380615234, 2.8288187980651855, 4.05869722366333, 0.9733501672744751, 3.1323132514953613, 1.7908387184143066, 1.3893933296203613, 0.465456485748291, 1.6424012184143066, 2.8669121265411377, 0.0656338632106781, 1.6254504919052124, 0.4852096140384674, 0.06598520278930664, 3.5423905849456787, 2.5059006214141846, 2.184852123260498, 1.4120852947235107, 1.6797800064086914, 1.2602887153625488, 2.9022369384765625, 2.3250885009765625, 1.6622059345245361, 3.0399560928344727, 1.8691954612731934, 1.0789278745651245, 2.8215177059173584, 0.39523953199386597, 2.7658591270446777, 1.8374292850494385, 0.29154008626937866, 2.366873264312744, 2.1444432735443115, 1.2926452159881592, 1.2822049856185913, 2.847731590270996, 2.2874417304992676, 2.9709553718566895, 2.0427141189575195, 0.2687203586101532, 1.0660959482192993], "mean_td_error": 2.0014591217041016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 775.6199039849289, "num_env_steps_trained_throughput_per_sec": 223.3369812813746, "timesteps_total": 31360, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 94080, "timers": {"training_iteration_time_ms": 1036.337, "sample_time_ms": 746.93, "load_time_ms": 0.313, "load_throughput": 823852.632, "learn_time_ms": 18.303, "learn_throughput": 14095.82, "synch_weights_time_ms": 9.467}, "counters": {"num_env_steps_sampled": 31360, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 94080, "num_agent_steps_trained": 8772, "last_target_update_ts": 31360, "num_target_updates": 34}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-12", "timestamp": 1700369832, "time_this_iter_s": 1.16451096534729, "time_total_s": 36.51398754119873, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 36.51398754119873, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 72.25, "ram_util_percent": 66.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098102569580078, "actor_loss": -5.278862476348877, "critic_loss": 1.7141363620758057, "alpha_loss": -0.10308138281106949, "alpha_value": 0.9898439049720764, "log_alpha_value": -0.01020799670368433, "target_entropy": -6.0, "policy_t": -0.03676203638315201, "mean_q": 1.4160051345825195, "max_q": 10.922870635986328, "min_q": 1.1049751043319702}, "td_error": [2.4646830558776855, 2.6906466484069824, 4.124056339263916, 3.7187230587005615, 2.078317165374756, 2.2186660766601562, 4.870535850524902, 2.7493109703063965, 4.986821174621582, 2.449742317199707, 2.4372146129608154, 2.450963020324707, 4.2490763664245605, 4.789947986602783, 6.590014457702637, 4.706838607788086, 2.4444518089294434, 2.615668773651123, 4.397810459136963, 3.92791748046875, 3.82352876663208, 0.7251112461090088, 3.466768741607666, 3.02394962310791, 3.305279016494751, 4.92059326171875, 2.876983165740967, 4.275599479675293, 3.8576741218566895, 2.6356329917907715, 3.3431754112243652, 2.4872708320617676, 0.6002678275108337, 3.8030498027801514, 7.537478923797607, 5.513461112976074, 2.2797293663024902, 3.248215675354004, 2.086087703704834, 3.729130744934082, 2.122189998626709, 2.971393585205078, 3.9848663806915283, 2.4800381660461426, 2.637650966644287, 1.7718143463134766, 6.062185287475586, 5.161576271057129, 3.1570987701416016, 2.376004934310913, 4.227132797241211, 4.096224784851074, 2.7966322898864746, 2.5907881259918213, 2.9180479049682617, 2.422722339630127, 1.4259381294250488, 2.2303404808044434, 2.466701030731201, 4.186476707458496, 3.5881004333496094, 3.2399864196777344, 5.113530158996582, 2.1969738006591797, 0.5728738307952881, 3.2483410835266113, 2.1181397438049316, 0.11924910545349121, 2.798048496246338, 3.433253288269043, 4.400385856628418, 3.623575210571289, 4.533066749572754, 3.061612129211426, 3.5679993629455566, 3.1570398807525635, 2.3651225566864014, 4.373534202575684, 4.749408721923828, 4.04287052154541, 1.9191910028457642, 2.816049098968506, 3.5993237495422363, 1.8061790466308594, 2.634474992752075, 3.714294672012329], "mean_td_error": 3.2718470096588135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132532119750977, "actor_loss": -5.133492946624756, "critic_loss": 0.4487346410751343, "alpha_loss": -0.10334943979978561, "alpha_value": 0.9898520708084106, "log_alpha_value": -0.010199764743447304, "target_entropy": -6.0, "policy_t": -0.022981008514761925, "mean_q": 1.3915457725524902, "max_q": 5.7854413986206055, "min_q": 0.9840056300163269}, "td_error": [0.6657165288925171, 0.6075422763824463, 2.5292093753814697, 2.0187385082244873, 0.6042792201042175, 2.1920347213745117, 0.3550472855567932, 1.7123188972473145, 1.1458790302276611, 2.2806763648986816, 2.9508533477783203, 1.0874500274658203, 3.296948194503784, 0.7782430648803711, 0.08833026885986328, 0.4096497595310211, 1.159429669380188, 2.854355812072754, 3.930971145629883, 1.5788220167160034, 1.8210197687149048, 3.882587432861328, 0.8615177273750305, 3.679492473602295, 2.184788227081299, 3.3302581310272217, 1.172835111618042, 2.1409120559692383, 2.707108497619629, 2.6982622146606445, 0.9423398375511169, 0.996649980545044, 3.1364316940307617, 1.0545930862426758, 0.1615387201309204, 0.8921425938606262, 1.5880554914474487, 0.6869159936904907, 1.4811313152313232, 0.6123921871185303, 0.1962248682975769, 1.5418486595153809, 2.0755040645599365, 0.49271658062934875, 0.6800537109375, 2.4099349975585938, 2.3557677268981934, 0.5887176990509033, 0.8752627968788147, 3.8618903160095215, 2.093663454055786, 1.5474568605422974, 3.452195405960083, 4.239658355712891, 0.22831019759178162, 1.6063005924224854, 1.085096836090088, 1.2939732074737549, 2.6562659740448, 0.4376325011253357, 1.326905369758606, 2.1450302600860596, 0.8084651827812195, 2.4958419799804688, 2.6016383171081543, 0.4801563024520874, 0.49646854400634766, 2.276519775390625, 0.8641660213470459, 1.5052555799484253, 1.9832470417022705, 2.2559568881988525, 0.9642028212547302, 2.622683525085449, 3.650362491607666, 1.4274680614471436, 0.12485623359680176, 1.7342623472213745, 0.9571933746337891, 1.5097956657409668, 1.112705945968628, 0.7171729803085327, 2.696720600128174, 3.932554006576538, 2.574957847595215, 0.45697230100631714], "mean_td_error": 1.6943894624710083, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128595352172852, "actor_loss": -4.949859619140625, "critic_loss": 0.48865675926208496, "alpha_loss": -0.10336128622293472, "alpha_value": 0.9898470044136047, "log_alpha_value": -0.010204898193478584, "target_entropy": -6.0, "policy_t": -0.04256469011306763, "mean_q": 1.140069603919983, "max_q": 5.057593822479248, "min_q": 0.853010892868042}, "td_error": [2.2415566444396973, 0.8459771871566772, 3.1055374145507812, 2.8907058238983154, 1.9995520114898682, 1.6991058588027954, 0.6983214616775513, 1.5792622566223145, 1.7405900955200195, 2.4996209144592285, 1.7611773014068604, 2.407884120941162, 1.7269771099090576, 1.0921721458435059, 0.24261116981506348, 0.5006141066551208, 1.5760045051574707, 1.599529504776001, 1.705873727798462, 1.9075103998184204, 1.1542387008666992, 2.023401975631714, 0.7291919589042664, 0.1554066240787506, 1.6128108501434326, 0.2933390140533447, 1.249286413192749, 2.0439181327819824, 1.5227513313293457, 1.913689374923706, 1.4018174409866333, 3.5916407108306885, 4.3803606033325195, 0.9278684258460999, 1.9193484783172607, 0.0425700843334198, 1.4978663921356201, 1.4061825275421143, 0.43197259306907654, 2.315138339996338, 1.3855781555175781, 3.1341214179992676, 1.2355401515960693, 3.5956976413726807, 0.6185187101364136, 0.7877073884010315, 0.6801261901855469, 2.3031373023986816, 2.8460633754730225, 1.1915334463119507, 0.28287601470947266, 3.25637149810791, 2.6776325702667236, 0.5647320747375488, 2.590961217880249, 0.6223133206367493, 2.423051118850708, 2.15004825592041, 0.3637394309043884, 0.987051248550415, 2.268333911895752, 2.012956142425537, 2.721170425415039, 0.2533568739891052, 3.0305612087249756, 0.6860318779945374, 2.2228920459747314, 1.820041537284851, 3.728531837463379, 0.30828845500946045, 2.553647994995117, 2.0791399478912354, 1.8920295238494873, 1.3710501194000244, 0.28405463695526123, 2.4524521827697754, 1.5188376903533936, 0.09978461265563965, 2.595294952392578, 2.1264548301696777, 2.1241073608398438, 1.6713039875030518, 1.9958982467651367, 5.415482521057129, 2.757687568664551, 1.044694423675537], "mean_td_error": 1.7344681024551392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 819.3669983222811, "num_env_steps_trained_throughput_per_sec": 235.93380085619256, "timesteps_total": 32256, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 96768, "timers": {"training_iteration_time_ms": 1030.905, "sample_time_ms": 761.389, "load_time_ms": 0.31, "load_throughput": 831576.448, "learn_time_ms": 18.266, "learn_throughput": 14124.909, "synch_weights_time_ms": 9.53}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 9030, "num_agent_steps_sampled": 96768, "num_agent_steps_trained": 9030, "last_target_update_ts": 32256, "num_target_updates": 35}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-13", "timestamp": 1700369833, "time_this_iter_s": 1.1026268005371094, "time_total_s": 37.61661434173584, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317553600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.61661434173584, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 59.15, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132055282592773, "actor_loss": -5.400354385375977, "critic_loss": 1.641392469406128, "alpha_loss": -0.10647141933441162, "alpha_value": 0.9895466566085815, "log_alpha_value": -0.010508372448384762, "target_entropy": -6.0, "policy_t": 0.031548261642456055, "mean_q": 1.3397915363311768, "max_q": 8.279121398925781, "min_q": 1.1683311462402344}, "td_error": [5.268337726593018, 3.1619937419891357, 1.8977973461151123, 2.8823976516723633, 3.1279351711273193, 2.53580641746521, 3.074195623397827, 4.719803810119629, 3.156081199645996, 2.319859027862549, 2.144050359725952, 3.344306230545044, 3.3910140991210938, 1.9921016693115234, 3.255078077316284, 3.571580171585083, 1.4880549907684326, 4.339023590087891, 4.421733856201172, 3.259361505508423, 4.8373613357543945, 4.306489944458008, 3.669576644897461, 0.29030346870422363, 2.786039352416992, 4.714653015136719, 4.2524285316467285, 4.5071611404418945, 2.7102909088134766, 2.9830634593963623, 4.512196063995361, 2.1625661849975586, 4.748635292053223, 2.9405641555786133, 4.755725860595703, 2.179044008255005, 3.4314346313476562, 4.521817684173584, 4.361145973205566, 2.932781457901001, 3.7683756351470947, 3.8345911502838135, 4.257651329040527, 4.1636962890625, 0.07699251174926758, 3.346141815185547, 3.121656894683838, 4.781577110290527, 1.168529748916626, 2.0925421714782715, 3.8201801776885986, 3.2358150482177734, 3.7276113033294678, 3.7613611221313477, 3.6625185012817383, 3.9818902015686035, 3.96726655960083, 2.023742198944092, 4.8985795974731445, 2.3018105030059814, 4.308615207672119, 2.14377498626709, 3.4784061908721924, 3.9939582347869873, 3.8096742630004883, 3.351757526397705, 2.000339984893799, 1.5088106393814087, 4.647148132324219, 4.103795528411865, 3.424914836883545, 4.340518951416016, 3.7882232666015625, 4.159204483032227, 3.2841098308563232, 2.1593265533447266, 3.0206856727600098, 3.3597588539123535, 5.935978889465332, 1.9589414596557617, 4.367408752441406, 3.053070545196533, 5.4153900146484375, 5.097506523132324, 1.1607768535614014, 3.43603515625], "mean_td_error": 3.3983073234558105, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.046821594238281, "actor_loss": -5.098127365112305, "critic_loss": 0.49771827459335327, "alpha_loss": -0.10548895597457886, "alpha_value": 0.9895551800727844, "log_alpha_value": -0.010499733500182629, "target_entropy": -6.0, "policy_t": -0.0283897016197443, "mean_q": 1.2475872039794922, "max_q": 6.301884651184082, "min_q": 1.0350379943847656}, "td_error": [1.5595979690551758, 1.464849591255188, 0.39076054096221924, 1.0066001415252686, 3.4235599040985107, 1.8529863357543945, 1.7843362092971802, 1.9822311401367188, 1.1357369422912598, 3.507676124572754, 2.6574931144714355, 0.34186989068984985, 2.2509796619415283, 1.3532589673995972, 2.5790553092956543, 1.1872912645339966, 1.0336439609527588, 2.364699125289917, 2.6367969512939453, 1.6548701524734497, 0.3954623341560364, 2.9253525733947754, 0.4268949031829834, 1.2141458988189697, 2.405459403991699, 2.603165626525879, 1.5759680271148682, 1.7782602310180664, 2.3662071228027344, 3.2863364219665527, 3.2262678146362305, 1.124467372894287, 0.15495657920837402, 1.6537163257598877, 2.567232131958008, 1.525267243385315, 2.168447494506836, 0.5524941086769104, 3.313270092010498, 1.7016286849975586, 3.75185489654541, 2.6735281944274902, 1.8730416297912598, 2.318118095397949, 2.6026182174682617, 3.29428768157959, 2.2255501747131348, 1.2952238321304321, 1.1631141901016235, 0.8184694051742554, 3.206315755844116, 0.43660134077072144, 1.459547996520996, 0.8990834951400757, 0.6217509508132935, 2.7028698921203613, 0.8931710720062256, 1.2840633392333984, 0.9663214683532715, 3.321798801422119, 2.2994155883789062, 3.0152225494384766, 2.694216728210449, 2.796536922454834, 2.3871498107910156, 1.2718018293380737, 1.7336935997009277, 1.0971990823745728, 1.8322064876556396, 1.4668453931808472, 1.1892187595367432, 2.4974398612976074, 2.5310800075531006, 1.0360183715820312, 4.708346843719482, 3.234654426574707, 0.09480094909667969, 1.982056736946106, 0.7121850252151489, 0.13697361946105957, 2.1352152824401855, 2.3296523094177246, 0.031069040298461914, 1.3075931072235107, 1.3345167636871338, 1.7265825271606445], "mean_td_error": 1.843282699584961, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117867469787598, "actor_loss": -4.978498458862305, "critic_loss": 0.5047825574874878, "alpha_loss": -0.10629013925790787, "alpha_value": 0.9895498156547546, "log_alpha_value": -0.01050519198179245, "target_entropy": -6.0, "policy_t": -0.005072542931884527, "mean_q": 1.1254749298095703, "max_q": 5.504687309265137, "min_q": 0.903106689453125}, "td_error": [0.07104089856147766, 2.4417076110839844, 1.123692512512207, 1.0072027444839478, 1.943846344947815, 1.5128118991851807, 1.552093744277954, 2.807908535003662, 1.1388893127441406, 0.15564733743667603, 4.231717109680176, 0.9374390840530396, 0.8679574728012085, 1.192793846130371, 1.3496665954589844, 3.6782217025756836, 1.1559300422668457, 1.5266493558883667, 0.712814450263977, 0.046222418546676636, 2.008671283721924, 1.8749442100524902, 1.2936092615127563, 2.1137773990631104, 1.632934331893921, 0.4267096519470215, 0.5529286861419678, 2.08035945892334, 0.04672306776046753, 3.3533060550689697, 1.6096397638320923, 1.2732899188995361, 1.7122080326080322, 2.250784397125244, 1.2664968967437744, 1.707986831665039, 2.7638754844665527, 2.039956569671631, 2.011121988296509, 2.584879159927368, 2.4076039791107178, 2.04697322845459, 2.9279022216796875, 3.874180793762207, 1.1429643630981445, 2.814110517501831, 1.761256456375122, 0.9823493957519531, 1.269567608833313, 2.555396556854248, 3.1972527503967285, 2.8732028007507324, 1.0463664531707764, 2.117969512939453, 0.43822771310806274, 2.049281597137451, 3.051868438720703, 1.8623735904693604, 2.16331148147583, 3.878934144973755, 2.2726004123687744, 2.241628885269165, 0.13243240118026733, 2.430675983428955, 2.1802988052368164, 1.3977391719818115, 2.0704355239868164, 1.7935068607330322, 1.250411033630371, 2.091618537902832, 1.1916382312774658, 1.3761296272277832, 2.2598276138305664, 2.5423636436462402, 0.030269980430603027, 2.689798593521118, 1.647249698638916, 2.9477341175079346, 2.366163730621338, 0.25028467178344727, 0.918083131313324, 2.4062089920043945, 0.8534543514251709, 2.237799644470215, 1.4179186820983887, 2.5280168056488037], "mean_td_error": 1.7912074327468872, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 845.7618771021133, "num_env_steps_trained_throughput_per_sec": 243.53411193342103, "timesteps_total": 33152, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 99456, "timers": {"training_iteration_time_ms": 1046.566, "sample_time_ms": 777.101, "load_time_ms": 0.31, "load_throughput": 832343.998, "learn_time_ms": 18.14, "learn_throughput": 14222.932, "synch_weights_time_ms": 9.522}, "counters": {"num_env_steps_sampled": 33152, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 99456, "num_agent_steps_trained": 9288, "last_target_update_ts": 33152, "num_target_updates": 36}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-14", "timestamp": 1700369834, "time_this_iter_s": 1.068892240524292, "time_total_s": 38.68550658226013, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x1010d18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 38.68550658226013, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 94.7, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097622871398926, "actor_loss": -5.428911209106445, "critic_loss": 1.541872262954712, "alpha_loss": -0.10914330184459686, "alpha_value": 0.9892494082450867, "log_alpha_value": -0.010808811523020267, "target_entropy": -6.0, "policy_t": 0.023193448781967163, "mean_q": 1.5468636751174927, "max_q": 10.518106460571289, "min_q": 1.2334190607070923}, "td_error": [5.170660972595215, 4.358797073364258, 3.750868558883667, 3.9498448371887207, 3.4653139114379883, 2.1844747066497803, 3.0518457889556885, 4.035579681396484, 4.422440052032471, 2.3195130825042725, 3.961507558822632, 4.274280548095703, 4.663668155670166, 2.738199234008789, 4.999039649963379, 3.722940444946289, 2.263638973236084, 4.163340091705322, 3.3672330379486084, 2.328564167022705, 4.846180438995361, 2.6849002838134766, 2.68696928024292, 0.12404096126556396, 3.786489963531494, 2.8331174850463867, 3.2884151935577393, 3.1289868354797363, 3.9205222129821777, 4.332318305969238, 3.554349184036255, 4.713457107543945, 1.780231237411499, 3.177201509475708, 3.396101474761963, 1.9082832336425781, 3.2928600311279297, 2.856862783432007, 4.068674087524414, 2.0085813999176025, 0.7701671123504639, 2.7101151943206787, 3.65643310546875, 3.710958480834961, 3.509831428527832, 3.3631019592285156, 3.21547532081604, 4.108435153961182, 4.025467395782471, 3.523789167404175, 3.5603578090667725, 2.7430880069732666, 4.247891426086426, 4.0117363929748535, 3.5077216625213623, 1.3714799880981445, 4.701377868652344, 4.798892974853516, 4.565751075744629, 3.312467575073242, 2.178276538848877, 5.026976585388184, 4.704150199890137, 2.452690362930298, 3.714221954345703, 6.112344741821289, 3.31618332862854, 3.081470489501953, 1.6325663328170776, 3.33134126663208, 6.49644660949707, 4.791894435882568, 3.5228023529052734, 4.944239616394043, 3.4299418926239014, 2.347714900970459, 2.0470573902130127, 2.9136571884155273, 2.3135530948638916, 3.5330758094787598, 3.7213099002838135, 3.813720703125, 4.435460090637207, 4.0702996253967285, 2.7875869274139404, 2.617464065551758], "mean_td_error": 3.468968629837036, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093460083007812, "actor_loss": -5.196526050567627, "critic_loss": 0.4476892352104187, "alpha_loss": -0.10900533199310303, "alpha_value": 0.9892585277557373, "log_alpha_value": -0.010799599811434746, "target_entropy": -6.0, "policy_t": 0.007627778220921755, "mean_q": 1.2078380584716797, "max_q": 5.2277374267578125, "min_q": 1.0886290073394775}, "td_error": [2.6187703609466553, 2.414672374725342, 3.543181896209717, 3.0864343643188477, 2.2800910472869873, 0.40602898597717285, 0.15425139665603638, 2.796788215637207, 2.449333667755127, 1.8132197856903076, 0.48071396350860596, 1.9086132049560547, 1.410904884338379, 1.624449610710144, 1.8036264181137085, 0.24908387660980225, 1.6929001808166504, 0.7532300353050232, 2.518481731414795, 0.1760404109954834, 1.0302075147628784, 1.6655563116073608, 2.388385772705078, 1.9859435558319092, 1.720017910003662, 1.7986854314804077, 1.4202797412872314, 2.6411690711975098, 1.4383108615875244, 2.3227288722991943, 2.2089691162109375, 2.4090898036956787, 3.3515868186950684, 0.3725450038909912, 3.2632882595062256, 3.817837715148926, 2.2973694801330566, 0.3136085867881775, 0.6614112257957458, 1.552666187286377, 2.2615203857421875, 1.2644683122634888, 1.4017744064331055, 0.9361311793327332, 0.45985621213912964, 2.800797939300537, 1.0063897371292114, 1.3128798007965088, 0.04050767421722412, 2.513923168182373, 1.6467671394348145, 1.511246919631958, 0.2838536500930786, 1.6424560546875, 1.731229543685913, 2.070059299468994, 1.2949861288070679, 1.4235458374023438, 0.4353565573692322, 2.8079237937927246, 0.30041515827178955, 3.0327229499816895, 1.4326328039169312, 1.1395831108093262, 2.2315833568573, 0.29301655292510986, 0.012219548225402832, 0.7064534425735474, 2.4107232093811035, 2.1623148918151855, 2.568817615509033, 1.4117913246154785, 0.1003190279006958, 0.34391188621520996, 1.904595971107483, 3.6976094245910645, 2.420897960662842, 2.235344409942627, 4.671999454498291, 2.568537712097168, 0.11404675245285034, 1.5795891284942627, 1.768324375152588, 1.6274375915527344, 2.094944477081299, 1.8913140296936035], "mean_td_error": 1.7024104595184326, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083948135375977, "actor_loss": -4.981855392456055, "critic_loss": 0.49133536219596863, "alpha_loss": -0.10896208882331848, "alpha_value": 0.9892526865005493, "log_alpha_value": -0.010805499739944935, "target_entropy": -6.0, "policy_t": -0.0003668282297439873, "mean_q": 1.0703649520874023, "max_q": 5.005781173706055, "min_q": 0.9554594159126282}, "td_error": [3.050480365753174, 1.7801833152770996, 0.04785439372062683, 2.4165658950805664, 1.4837312698364258, 1.9563416242599487, 1.9807062149047852, 1.145955204963684, 1.1279163360595703, 0.7491503953933716, 3.631838083267212, 0.05192536115646362, 1.2032124996185303, 1.2191858291625977, 1.8723468780517578, 1.6835439205169678, 1.0922045707702637, 1.1691222190856934, 2.328362464904785, 2.4043052196502686, 2.946773052215576, 2.4094419479370117, 0.6469091176986694, 0.7348058819770813, 2.1397995948791504, 2.400212287902832, 2.7137184143066406, 3.029961585998535, 2.0193817615509033, 2.0854451656341553, 2.609785556793213, 1.5054786205291748, 1.5929932594299316, 2.117556571960449, 0.6617093086242676, 1.9629592895507812, 0.51008540391922, 1.9257593154907227, 2.1942825317382812, 1.781197428703308, 1.912506341934204, 2.9821014404296875, 2.7965803146362305, 2.534285545349121, 0.20455363392829895, 0.5105082392692566, 2.151278018951416, 3.025233745574951, 3.4948129653930664, 0.3253052830696106, 4.558349132537842, 2.702669143676758, 1.0409905910491943, 2.590604305267334, 0.9659032821655273, 1.580354928970337, 0.18933701515197754, 1.01860511302948, 2.6560707092285156, 3.171180009841919, 0.3540513515472412, 1.5553076267242432, 3.0212788581848145, 0.903805136680603, 0.40032580494880676, 1.646761417388916, 0.4242857098579407, 2.537086009979248, 2.0527138710021973, 1.6829686164855957, 2.5484917163848877, 0.281445175409317, 2.3365392684936523, 3.2742669582366943, 1.645496129989624, 0.7456746697425842, 1.3624894618988037, 1.292785882949829, 0.24883520603179932, 2.9701833724975586, 0.7559309601783752, 0.6730125546455383, 1.8073093891143799, 2.654031276702881, 1.121187686920166, 2.733161449432373], "mean_td_error": 1.7653934955596924, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 693.0198726373525, "num_env_steps_trained_throughput_per_sec": 199.55259725495193, "timesteps_total": 34048, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 102144, "timers": {"training_iteration_time_ms": 1078.79, "sample_time_ms": 784.326, "load_time_ms": 0.313, "load_throughput": 824605.983, "learn_time_ms": 18.215, "learn_throughput": 14163.825, "synch_weights_time_ms": 9.562}, "counters": {"num_env_steps_sampled": 34048, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 102144, "num_agent_steps_trained": 9546, "last_target_update_ts": 34048, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-16", "timestamp": 1700369836, "time_this_iter_s": 1.3021728992462158, "time_total_s": 39.98767948150635, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 39.98767948150635, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 65.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042637825012207, "actor_loss": -5.524099826812744, "critic_loss": 1.389418363571167, "alpha_loss": -0.11458374559879303, "alpha_value": 0.9886550903320312, "log_alpha_value": -0.011409725993871689, "target_entropy": -6.0, "policy_t": -0.017357150092720985, "mean_q": 1.9042003154754639, "max_q": 10.952903747558594, "min_q": 1.3660136461257935}, "td_error": [1.637039303779602, 2.111753463745117, 2.9664015769958496, 3.216096878051758, 4.261661529541016, 4.29400634765625, 3.572627544403076, 3.8340249061584473, 2.684570789337158, 3.873897075653076, 2.5663604736328125, 1.930153727531433, 1.3538973331451416, 3.2444710731506348, 3.089224338531494, 3.590096950531006, 6.366700172424316, 1.7975242137908936, 2.8000612258911133, 4.056748390197754, 1.303199052810669, 2.7524514198303223, 2.496516704559326, 3.4066481590270996, 3.983651876449585, 3.200920581817627, 2.8061797618865967, 3.9783072471618652, 3.2712836265563965, 1.8938884735107422, 4.208171844482422, 2.824039936065674, 1.4747728109359741, 3.5582847595214844, 4.869950294494629, 2.644317626953125, 3.9761910438537598, 2.6295785903930664, 2.844346523284912, 3.868199348449707, 2.513627767562866, 3.988478660583496, 5.308539390563965, 5.624508857727051, 1.854341983795166, 2.6381309032440186, 3.124253988265991, 3.498486042022705, 5.328274250030518, 2.6082968711853027, 3.3987903594970703, 0.7969768047332764, 4.475496768951416, 2.6356024742126465, 2.188775062561035, 3.107123374938965, 4.495177268981934, 3.5242862701416016, 3.729832410812378, 8.52037239074707, 3.7361721992492676, 3.700252056121826, 2.6317830085754395, 4.502577781677246, 5.4214067459106445, 0.5537535548210144, 3.283440351486206, 2.2495932579040527, 3.1018288135528564, 2.508411407470703, 5.051155090332031, 3.13517427444458, 2.6314127445220947, 2.1365103721618652, 2.3190293312072754, 3.4830641746520996, 2.043674945831299, 1.5233628749847412, 2.7702670097351074, 3.9366281032562256, 2.081286907196045, 4.634066581726074, 4.408010959625244, 2.7159183025360107, 4.331311225891113, 2.6008479595184326], "mean_td_error": 3.256843328475952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058584213256836, "actor_loss": -5.284002304077148, "critic_loss": 0.3195299804210663, "alpha_loss": -0.11466244608163834, "alpha_value": 0.9886652827262878, "log_alpha_value": -0.011399460956454277, "target_entropy": -6.0, "policy_t": 0.02764834091067314, "mean_q": 1.457571029663086, "max_q": 6.295279502868652, "min_q": 1.203953504562378}, "td_error": [2.1374857425689697, 0.07078135013580322, 0.495991051197052, 0.6963689923286438, 1.7444570064544678, 1.4533350467681885, 0.6462545394897461, 3.0781006813049316, 0.8139073252677917, 2.3604581356048584, 1.527082920074463, 0.021464824676513672, 1.7425878047943115, 0.05327695608139038, 3.4986495971679688, 0.5661123991012573, 0.618152379989624, 2.690316915512085, 0.8141738772392273, 2.518758773803711, 2.147352933883667, 1.3728318214416504, 2.235579490661621, 1.9142637252807617, 1.8556586503982544, 1.9258549213409424, 1.8252348899841309, 1.0768256187438965, 1.248185396194458, 0.9358944892883301, 1.6377911567687988, 3.240353584289551, 0.4583331346511841, 0.741413414478302, 1.652136206626892, 2.5973567962646484, 2.276580810546875, 0.6517513394355774, 1.261261224746704, 1.2259126901626587, 1.0463998317718506, 0.09999018907546997, 0.9641098976135254, 1.876055359840393, 2.3922181129455566, 1.9449371099472046, 0.15313851833343506, 0.67751544713974, 0.8647946715354919, 0.9985636472702026, 3.170727491378784, 0.7696926593780518, 0.09125924110412598, 1.987833023071289, 0.7834726572036743, 2.352945327758789, 2.570979595184326, 0.657788097858429, 1.5864903926849365, 1.7706828117370605, 0.3375096321105957, 0.8780756592750549, 1.4581828117370605, 1.1335171461105347, 3.43316912651062, 2.373363971710205, 0.8190305829048157, 2.0513389110565186, 0.8236346244812012, 1.8843302726745605, 0.2693830132484436, 1.0358905792236328, 2.5826268196105957, 0.6389092803001404, 1.3725745677947998, 0.41053372621536255, 0.4291555881500244, 2.95725679397583, 0.48241984844207764, 0.943146824836731, 2.1862595081329346, 2.769709587097168, 0.12116408348083496, 1.0011625289916992, 0.22547149658203125, 0.8328357934951782], "mean_td_error": 1.3957968950271606, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111648559570312, "actor_loss": -5.114426136016846, "critic_loss": 0.547937273979187, "alpha_loss": -0.11533434689044952, "alpha_value": 0.9886587262153625, "log_alpha_value": -0.01140608824789524, "target_entropy": -6.0, "policy_t": 0.02839975617825985, "mean_q": 1.2034651041030884, "max_q": 5.463930606842041, "min_q": 1.069655418395996}, "td_error": [2.1249470710754395, 3.2648556232452393, 1.308457374572754, 2.794837236404419, 2.4782769680023193, 3.3085832595825195, 2.6910927295684814, 2.326559543609619, 1.9124993085861206, 0.28622788190841675, 1.3265857696533203, 1.88533616065979, 3.198291778564453, 2.5661139488220215, 2.914750337600708, 1.2064282894134521, 3.7153329849243164, 0.9887323379516602, 2.003333806991577, 0.12638899683952332, 2.5782864093780518, 1.8080415725708008, 0.7348974347114563, 1.2391002178192139, 1.0872007608413696, 3.2021048069000244, 1.992614507675171, 0.5509530305862427, 1.3468952178955078, 0.6839183568954468, 4.0732526779174805, 0.632603108882904, 1.6214015483856201, 0.057422757148742676, 0.7359069585800171, 2.5643351078033447, 1.8615784645080566, 2.2731432914733887, 0.10096859931945801, 2.1129188537597656, 2.342324733734131, 0.606997013092041, 3.65453839302063, 1.7039543390274048, 1.6959319114685059, 2.9840221405029297, 2.0681557655334473, 2.1210427284240723, 0.7828842997550964, 0.7552193403244019, 3.4969844818115234, 0.7854224443435669, 0.7682528495788574, 0.8611121773719788, 2.1428029537200928, 1.5083234310150146, 2.634951591491699, 3.9478392601013184, 1.15175461769104, 3.309185266494751, 1.7951000928878784, 3.265303611755371, 3.1911404132843018, 1.5194003582000732, 3.3523693084716797, 0.3583369255065918, 1.3093280792236328, 0.47473976016044617, 0.348882794380188, 1.072353720664978, 2.3520548343658447, 2.728740930557251, 1.096351981163025, 2.024292469024658, 1.4080350399017334, 2.256457805633545, 1.3971290588378906, 2.8545942306518555, 2.577882766723633, 4.063849925994873, 2.2210488319396973, 4.509763717651367, 2.6937942504882812, 1.1097478866577148, 2.175004005432129, 0.2308356761932373], "mean_td_error": 1.923179268836975, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 909.2058319776038, "num_env_steps_trained_throughput_per_sec": 261.80257215426536, "timesteps_total": 35840, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 1078.583, "sample_time_ms": 784.533, "load_time_ms": 0.313, "load_throughput": 823915.359, "learn_time_ms": 18.261, "learn_throughput": 14128.523, "synch_weights_time_ms": 9.368}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 10062, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 10062, "last_target_update_ts": 35840, "num_target_updates": 39}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-18", "timestamp": 1700369838, "time_this_iter_s": 1.9813508987426758, "time_total_s": 41.96903038024902, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177ba0c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 41.96903038024902, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 68.06666666666666, "ram_util_percent": 65.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033159255981445, "actor_loss": -5.64227294921875, "critic_loss": 1.2029014825820923, "alpha_loss": -0.12050250172615051, "alpha_value": 0.9880614280700684, "log_alpha_value": -0.012010426260530949, "target_entropy": -6.0, "policy_t": -0.003938428126275539, "mean_q": 1.7247976064682007, "max_q": 12.257521629333496, "min_q": 1.4995486736297607}, "td_error": [1.8802666664123535, 3.129823684692383, 1.5791447162628174, 2.098797082901001, 3.739104747772217, 3.8866562843322754, 4.745711326599121, 2.91975736618042, 2.3652305603027344, 0.9387437701225281, 3.3060522079467773, 2.9278674125671387, 1.835949420928955, 1.9389842748641968, 1.4855544567108154, 2.9528696537017822, 3.897662878036499, 3.1293280124664307, 2.283425807952881, 1.7149579524993896, 3.9452152252197266, 2.023979425430298, 3.3821353912353516, 1.8221957683563232, 1.943435788154602, 1.3019626140594482, 4.367224216461182, 2.1139438152313232, 5.729822635650635, 0.8527250289916992, 2.3269200325012207, 2.83042049407959, 2.546995162963867, 3.5337352752685547, 3.1427645683288574, 3.8128480911254883, 1.8319380283355713, 3.45941162109375, 1.6495509147644043, 4.0055389404296875, 2.646696090698242, 0.39763474464416504, 3.3245303630828857, 2.5366694927215576, 0.9618480205535889, 1.3690016269683838, 3.6897494792938232, 2.817688465118408, 3.329598903656006, 3.0227136611938477, 1.4932913780212402, 3.161982774734497, 4.1915740966796875, 2.907592535018921, 5.4109110832214355, 4.550889015197754, 0.8104221820831299, 2.0892510414123535, 2.478959560394287, 1.5970137119293213, 3.744251251220703, 4.021392345428467, 1.6747326850891113, 2.947416305541992, 3.795304775238037, 4.4548444747924805, 1.3674027919769287, 2.232593059539795, 5.346099853515625, 2.3669745922088623, 4.164630889892578, 3.192866325378418, 3.7334580421447754, 3.4592299461364746, 3.636232376098633, 2.246340036392212, 3.078465700149536, 7.597117900848389, 3.7413454055786133, 3.4656903743743896, 1.8984508514404297, 2.275000810623169, 3.944549560546875, 0.7304264903068542, 2.0088579654693604, 3.165316104888916], "mean_td_error": 2.8657634258270264, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108844757080078, "actor_loss": -5.469417095184326, "critic_loss": 0.33189862966537476, "alpha_loss": -0.1212996244430542, "alpha_value": 0.9880723357200623, "log_alpha_value": -0.011999355629086494, "target_entropy": -6.0, "policy_t": -0.0030126275960355997, "mean_q": 1.5312137603759766, "max_q": 5.778059959411621, "min_q": 1.3274481296539307}, "td_error": [1.1340572834014893, 0.7594143152236938, 1.6996806859970093, 3.23634672164917, 1.4452660083770752, 2.8144097328186035, 1.6741666793823242, 2.7238991260528564, 1.5976994037628174, 0.7270973324775696, 1.6184098720550537, 1.2476544380187988, 3.2210259437561035, 0.980983316898346, 0.11775374412536621, 1.470679759979248, 1.3388831615447998, 0.23620593547821045, 2.2813100814819336, 3.4669313430786133, 2.5200212001800537, 0.2777727246284485, 1.3372890949249268, 2.3107573986053467, 0.20725005865097046, 1.4477229118347168, 3.1310596466064453, 0.4275672435760498, 0.38209497928619385, 1.623026728630066, 1.0407061576843262, 0.5168418288230896, 3.0534746646881104, 2.16072940826416, 1.6801104545593262, 0.3114091753959656, 2.550879955291748, 0.5506902933120728, 0.7722342014312744, 0.5397932529449463, 3.4348795413970947, 2.557455539703369, 1.6199920177459717, 1.9337003231048584, 1.328118085861206, 0.9807863235473633, 0.2994488477706909, 2.267001152038574, 3.0512237548828125, 3.259089469909668, 0.46457964181900024, 2.364790678024292, 1.7951034307479858, 0.6127863526344299, 1.802347183227539, 2.725828170776367, 1.2676669359207153, 0.5078255534172058, 0.06120401620864868, 3.4378442764282227, 0.9476349353790283, 0.09142756462097168, 1.3427557945251465, 1.6289328336715698, 0.8682728409767151, 0.2368648648262024, 0.8226827383041382, 1.0706782341003418, 0.8696199655532837, 1.9234776496887207, 1.392803430557251, 2.3217897415161133, 2.668839454650879, 0.8206142783164978, 2.09889554977417, 3.3358333110809326, 0.47693997621536255, 1.3815345764160156, 1.6958301067352295, 2.8816745281219482, 0.7671019434928894, 2.147684097290039, 0.05225592851638794, 1.2033684253692627, 1.9684152603149414, 2.1374874114990234], "mean_td_error": 1.5530043840408325, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01954460144043, "actor_loss": -5.137331962585449, "critic_loss": 0.4047295153141022, "alpha_loss": -0.12030226737260818, "alpha_value": 0.9880650043487549, "log_alpha_value": -0.012006760574877262, "target_entropy": -6.0, "policy_t": 0.08462442457675934, "mean_q": 1.2606894969940186, "max_q": 4.144586563110352, "min_q": 1.1974515914916992}, "td_error": [0.9115034937858582, 2.564757823944092, 0.06491994857788086, 0.5619893670082092, 0.7451931238174438, 0.9503141641616821, 1.6785128116607666, 1.4936153888702393, 1.955479383468628, 0.6515562534332275, 0.4805508255958557, 2.7760143280029297, 2.0829694271087646, 2.498955249786377, 0.4001613259315491, 4.083258628845215, 0.16756737232208252, 0.19705229997634888, 1.9684113264083862, 2.2239041328430176, 0.3417903780937195, 0.82187420129776, 2.9494800567626953, 2.945986032485962, 2.2988195419311523, 1.1011450290679932, 2.4560599327087402, 1.3157413005828857, 1.8677434921264648, 0.8680183291435242, 2.880289316177368, 2.347822904586792, 0.7180894613265991, 0.51017826795578, 1.525364875793457, 1.3206921815872192, 1.0951720476150513, 2.2157459259033203, 4.241599082946777, 0.3058543801307678, 0.8662023544311523, 2.8872761726379395, 1.0065947771072388, 2.259941577911377, 2.2212612628936768, 2.4459054470062256, 0.39941537380218506, 0.37404465675354004, 0.9853217005729675, 1.831397533416748, 0.7708644270896912, 2.641903877258301, 1.2803337574005127, 0.7749177813529968, 0.7568711042404175, 1.4825549125671387, 1.0266649723052979, 2.5827202796936035, 1.4112863540649414, 2.052647113800049, 0.6710240244865417, 1.5826826095581055, 0.4959844946861267, 1.0588264465332031, 0.6829125881195068, 1.389070987701416, 2.283693313598633, 0.4642428159713745, 0.8496469855308533, 3.376791477203369, 0.6176342368125916, 3.089289426803589, 3.1108345985412598, 0.8537800312042236, 2.180050849914551, 2.065216064453125, 1.8569564819335938, 1.103340983390808, 2.2991771697998047, 0.9940558075904846, 1.2997069358825684, 0.7457503080368042, 0.6769931316375732, 0.06467640399932861, 1.0034420490264893, 2.6113345623016357], "mean_td_error": 1.5124348402023315, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 807.9656715843525, "num_env_steps_trained_throughput_per_sec": 232.65082954103008, "timesteps_total": 37632, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 112896, "timers": {"training_iteration_time_ms": 1086.219, "sample_time_ms": 789.434, "load_time_ms": 0.312, "load_throughput": 827569.924, "learn_time_ms": 18.194, "learn_throughput": 14180.679, "synch_weights_time_ms": 9.632}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 10578, "num_agent_steps_sampled": 112896, "num_agent_steps_trained": 10578, "last_target_update_ts": 37632, "num_target_updates": 41}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-20", "timestamp": 1700369840, "time_this_iter_s": 2.2281038761138916, "time_total_s": 44.197134256362915, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 44.197134256362915, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 75.56666666666666, "ram_util_percent": 65.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082829475402832, "actor_loss": -5.770153522491455, "critic_loss": 1.354871392250061, "alpha_loss": -0.1241258904337883, "alpha_value": 0.987764835357666, "log_alpha_value": -0.01231062225997448, "target_entropy": -6.0, "policy_t": 0.020075621083378792, "mean_q": 1.9239102602005005, "max_q": 8.114906311035156, "min_q": 1.5686500072479248}, "td_error": [1.7534680366516113, 2.574775218963623, 0.8773760795593262, 2.5774118900299072, 2.051567792892456, 2.6081931591033936, 3.6394083499908447, 2.6630301475524902, 3.9411182403564453, 3.360781669616699, 4.128847122192383, 4.668378829956055, 5.262107849121094, 1.8674142360687256, 3.7978124618530273, 2.354285478591919, 3.286468029022217, 2.9907386302948, 2.798401355743408, 2.6578421592712402, 4.197744369506836, 4.898894786834717, 2.996535301208496, 3.1057982444763184, 2.5175302028656006, 3.599410057067871, 3.617600202560425, 2.4290900230407715, 2.317384719848633, 2.632427215576172, 3.720730781555176, 3.234323024749756, 1.0025315284729004, 4.146450042724609, 4.255371570587158, 2.0945799350738525, 4.164356708526611, 3.78872013092041, 2.9675557613372803, 4.321103096008301, 0.8940373063087463, 3.0948920249938965, 3.8462655544281006, 3.653120994567871, 1.1155747175216675, 2.085357189178467, 3.9830245971679688, 3.345010280609131, 2.782302141189575, 2.3120532035827637, 2.6425414085388184, 3.092649221420288, 2.619875192642212, 2.702775239944458, 4.148704528808594, 3.9395196437835693, 2.101261615753174, 4.622062683105469, 1.257673740386963, 4.128729343414307, 3.0278472900390625, 3.3700881004333496, 3.974975109100342, 3.5887248516082764, 4.175074577331543, 2.5385475158691406, 3.714703321456909, 1.973379373550415, 3.9257373809814453, 4.897686958312988, 2.1234989166259766, 1.9976089000701904, 1.5838340520858765, 2.682736396789551, 2.3773226737976074, 3.658039093017578, 3.748056173324585, 2.2744247913360596, 5.612341403961182, 2.6890158653259277, 2.6402621269226074, 4.071578025817871, 4.644360542297363, 0.7590982913970947, 1.4709620475769043, 3.3474302291870117], "mean_td_error": 3.082584857940674, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.135586738586426, "actor_loss": -5.546966075897217, "critic_loss": 0.3714657723903656, "alpha_loss": -0.12466144561767578, "alpha_value": 0.9877759218215942, "log_alpha_value": -0.01229938119649887, "target_entropy": -6.0, "policy_t": 0.022071989253163338, "mean_q": 1.6914886236190796, "max_q": 6.27718448638916, "min_q": 1.3905476331710815}, "td_error": [1.4318554401397705, 2.66837477684021, 1.8828589916229248, 2.088418483734131, 0.4051029086112976, 2.1611626148223877, 0.9461436867713928, 2.3695404529571533, 0.3728480935096741, 3.538189172744751, 1.7759907245635986, 3.0667731761932373, 0.23719555139541626, 2.288128614425659, 0.7103617787361145, 0.1827409863471985, 1.1098575592041016, 1.460986614227295, 0.3142281174659729, 2.596818447113037, 2.134615182876587, 2.070101737976074, 1.020747423171997, 0.705255389213562, 0.07043653726577759, 2.4738762378692627, 0.8414673805236816, 0.2626039981842041, 2.3007283210754395, 3.685645580291748, 1.9111535549163818, 0.2961435914039612, 3.4092297554016113, 1.4878692626953125, 1.7286581993103027, 0.5392545461654663, 0.23232752084732056, 0.7653036117553711, 1.9797027111053467, 3.5589184761047363, 1.4788833856582642, 2.8452162742614746, 2.140497922897339, 1.304076910018921, 2.4202053546905518, 0.09927111864089966, 2.0164339542388916, 1.4944790601730347, 5.089010238647461, 3.2849044799804688, 0.12046778202056885, 0.773033082485199, 4.076976299285889, 1.2220418453216553, 0.7857300043106079, 1.1146149635314941, 0.6720649003982544, 1.8141188621520996, 1.527547836303711, 0.48624277114868164, 2.7576441764831543, 2.077906608581543, 2.027355670928955, 2.9307689666748047, 0.8113142251968384, 2.4928202629089355, 0.008079290390014648, 3.4292867183685303, 3.0934009552001953, 0.7846992015838623, 1.693887710571289, 1.0135512351989746, 0.4633888006210327, 1.6906481981277466, 1.0542021989822388, 0.5890712738037109, 1.9669933319091797, 1.814208984375, 1.0380425453186035, 1.7874975204467773, 3.500720262527466, 0.2465357780456543, 3.052507162094116, 0.31595754623413086, 1.026024580001831, 2.0041801929473877], "mean_td_error": 1.6455596685409546, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027820587158203, "actor_loss": -5.221328258514404, "critic_loss": 0.4330301880836487, "alpha_loss": -0.12341117858886719, "alpha_value": 0.9877685308456421, "log_alpha_value": -0.012306878343224525, "target_entropy": -6.0, "policy_t": -0.029927780851721764, "mean_q": 1.3079819679260254, "max_q": 3.3027701377868652, "min_q": 1.2655885219573975}, "td_error": [2.3437182903289795, 0.8208543658256531, 2.1405882835388184, 1.6227185726165771, 1.8028266429901123, 1.2839813232421875, 0.833864688873291, 0.48697733879089355, 1.9375044107437134, 1.2882757186889648, 2.7189745903015137, 2.3538336753845215, 0.9050957560539246, 0.22211146354675293, 2.450742483139038, 0.8746997714042664, 1.1249217987060547, 1.3009949922561646, 1.5777662992477417, 2.9928932189941406, 2.771047353744507, 1.5681426525115967, 0.8075778484344482, 1.2113256454467773, 0.6822299957275391, 0.3078438639640808, 1.87630295753479, 1.997931957244873, 2.950477123260498, 2.946958065032959, 3.2156167030334473, 2.804471969604492, 1.9283655881881714, 1.1578469276428223, 0.9693474769592285, 1.8356549739837646, 2.3363394737243652, 2.237213134765625, 3.955930709838867, 1.2757329940795898, 2.173203945159912, 0.2382882833480835, 1.8524848222732544, 1.9567112922668457, 1.7659962177276611, 2.1256394386291504, 1.6073105335235596, 1.0535955429077148, 1.736831545829773, 0.6873235106468201, 2.292255163192749, 1.171769618988037, 2.5833635330200195, 2.5327048301696777, 1.77317476272583, 0.8513787984848022, 0.07271069288253784, 0.9744002819061279, 0.3569990396499634, 3.64070463180542, 1.9504847526550293, 2.3515048027038574, 0.31874269247055054, 0.8449417352676392, 1.7739360332489014, 2.5798797607421875, 1.5854487419128418, 1.883207082748413, 1.9613940715789795, 0.4392838478088379, 0.8703444004058838, 1.1935172080993652, 0.1043475866317749, 0.9464564919471741, 1.400568962097168, 2.9332337379455566, 0.2946906089782715, 1.7396749258041382, 1.2264691591262817, 1.8715652227401733, 0.5452193021774292, 1.27992844581604, 1.4674415588378906, 2.3673183917999268, 1.3788169622421265, 1.5577335357666016], "mean_td_error": 1.6073569059371948, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 747.6016654498724, "num_env_steps_trained_throughput_per_sec": 215.26922956034272, "timesteps_total": 38528, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 115584, "timers": {"training_iteration_time_ms": 1101.346, "sample_time_ms": 805.036, "load_time_ms": 0.31, "load_throughput": 831320.913, "learn_time_ms": 18.152, "learn_throughput": 14213.33, "synch_weights_time_ms": 9.54}, "counters": {"num_env_steps_sampled": 38528, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 115584, "num_agent_steps_trained": 10836, "last_target_update_ts": 38528, "num_target_updates": 42}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-21", "timestamp": 1700369841, "time_this_iter_s": 1.2072691917419434, "time_total_s": 45.40440344810486, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.40440344810486, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 65.3, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08024787902832, "actor_loss": -5.878592014312744, "critic_loss": 1.1745576858520508, "alpha_loss": -0.13014613091945648, "alpha_value": 0.98717200756073, "log_alpha_value": -0.01291100587695837, "target_entropy": -6.0, "policy_t": -0.019328217953443527, "mean_q": 2.281385898590088, "max_q": 10.447736740112305, "min_q": 1.7143807411193848}, "td_error": [1.0460978746414185, 2.311375856399536, 3.371142625808716, 1.4042985439300537, 1.7907121181488037, 2.321120500564575, 1.2020982503890991, 3.2830569744110107, 2.3521203994750977, 0.3851790428161621, 3.218783378601074, 4.392529010772705, 2.5308732986450195, 3.486967086791992, 4.541170120239258, 3.035006284713745, 5.793771266937256, 2.6034936904907227, 4.021433353424072, 3.5081310272216797, 3.3688974380493164, 3.2400553226470947, 2.6096878051757812, 1.524159550666809, 2.1860060691833496, 2.589581251144409, 0.48032617568969727, 1.7169468402862549, 3.437178373336792, 2.0769567489624023, 3.1789493560791016, 2.213998317718506, 3.7281150817871094, 1.8227423429489136, 1.5910699367523193, 1.8953591585159302, 3.1018476486206055, 5.218316078186035, 2.2012319564819336, 1.3447520732879639, 3.215045928955078, 4.715212345123291, 0.9436149597167969, 1.6772880554199219, 2.593999147415161, 3.924309015274048, 0.8230785727500916, 3.7111310958862305, 2.473986864089966, 3.1641952991485596, 1.5766000747680664, 2.0077295303344727, 2.907395362854004, 4.351207733154297, 2.527613639831543, 2.624643564224243, 3.654330253601074, 3.04170560836792, 2.0175530910491943, 2.7544798851013184, 6.051448822021484, 3.2456307411193848, 4.074514389038086, 2.3370344638824463, 1.8649284839630127, 4.8452043533325195, 1.4166287183761597, 4.630784034729004, 2.429471492767334, 2.6149117946624756, 2.8434648513793945, 4.006838321685791, 1.4347357749938965, 1.1750067472457886, 3.420194625854492, 1.4556829929351807, 2.846341609954834, 2.1565933227539062, 1.2800707817077637, 4.320736885070801, 2.714873790740967, 2.956308603286743, 3.7520527839660645, 3.1735129356384277, 3.5821075439453125, 2.9201998710632324], "mean_td_error": 2.771859884262085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084017753601074, "actor_loss": -5.635653972625732, "critic_loss": 0.30523234605789185, "alpha_loss": -0.13007989525794983, "alpha_value": 0.9871832132339478, "log_alpha_value": -0.012899610213935375, "target_entropy": -6.0, "policy_t": -0.023406919091939926, "mean_q": 1.6435085535049438, "max_q": 5.132002830505371, "min_q": 1.51455557346344}, "td_error": [2.765648603439331, 1.345879316329956, 2.505319118499756, 0.24044781923294067, 2.2087960243225098, 1.2579705715179443, 0.7709352374076843, 0.3486126661300659, 1.8910629749298096, 0.38412898778915405, 3.595886707305908, 1.3364527225494385, 1.3554625511169434, 0.05794823169708252, 1.744497537612915, 0.27102500200271606, 3.4576263427734375, 0.03537893295288086, 0.4261714816093445, 0.32772374153137207, 2.1009316444396973, 3.0896406173706055, 2.080643653869629, 1.2697935104370117, 0.7951818704605103, 1.0458030700683594, 1.6293485164642334, 3.3716235160827637, 2.103330612182617, 0.8896723389625549, 3.355515956878662, 2.2000317573547363, 0.9922536015510559, 1.5471065044403076, 0.2365207076072693, 2.6285696029663086, 0.015835106372833252, 2.8505518436431885, 2.498408555984497, 2.8924014568328857, 0.18778330087661743, 0.2709091305732727, 2.3320703506469727, 0.5875741243362427, 2.51975679397583, 1.6551679372787476, 1.7476391792297363, 0.6485583186149597, 1.3924694061279297, 2.567986488342285, 0.43602532148361206, 0.41969072818756104, 0.6980782151222229, 0.056707143783569336, 0.45789432525634766, 1.5733935832977295, 1.9637787342071533, 0.7539684772491455, 0.2831212282180786, 2.0371828079223633, 2.3505325317382812, 0.11432862281799316, 1.6411463022232056, 0.568314254283905, 0.8015112280845642, 0.8462280035018921, 1.2211838960647583, 1.2369815111160278, 0.16119658946990967, 0.9186069965362549, 3.1748368740081787, 2.334739923477173, 0.7005928754806519, 1.7958345413208008, 1.1729812622070312, 1.7065670490264893, 2.5138397216796875, 2.346897602081299, 0.09957671165466309, 2.4093384742736816, 0.769413948059082, 1.9391837120056152, 2.1308746337890625, 1.786112666130066, 0.10225176811218262, 0.47285550832748413], "mean_td_error": 1.416579246520996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028108596801758, "actor_loss": -5.366164684295654, "critic_loss": 0.3860468864440918, "alpha_loss": -0.12943030893802643, "alpha_value": 0.9871761798858643, "log_alpha_value": -0.012906751595437527, "target_entropy": -6.0, "policy_t": -0.036085356026887894, "mean_q": 1.6072343587875366, "max_q": 4.758089542388916, "min_q": 1.4122376441955566}, "td_error": [1.7273497581481934, 2.808041572570801, 1.7863457202911377, 0.9372178912162781, 0.525658905506134, 1.5687334537506104, 0.07908433675765991, 0.48618096113204956, 3.2787556648254395, 2.0263915061950684, 2.6930551528930664, 2.5334835052490234, 1.5643820762634277, 2.272717237472534, 3.0372679233551025, 1.1572353839874268, 0.41551196575164795, 0.41689205169677734, 2.1490726470947266, 2.211102247238159, 0.933863639831543, 0.8775172829627991, 1.9525465965270996, 0.9232416152954102, 0.1416022777557373, 1.5030097961425781, 2.353445529937744, 0.25713902711868286, 4.339671611785889, 0.18874216079711914, 1.5397487878799438, 2.3987410068511963, 2.1858484745025635, 1.346174955368042, 0.5497086048126221, 1.8923090696334839, 2.7094879150390625, 1.5891978740692139, 2.6415703296661377, 0.2095346450805664, 1.7323590517044067, 0.17362570762634277, 1.0868421792984009, 0.5701143741607666, 0.23915541172027588, 1.647839069366455, 1.7034668922424316, 0.2427384853363037, 1.1813597679138184, 2.276961088180542, 2.120993137359619, 1.7486943006515503, 1.0824267864227295, 2.6187825202941895, 1.4644322395324707, 0.320949912071228, 1.2301456928253174, 3.7185072898864746, 1.6277201175689697, 0.19371777772903442, 2.4588866233825684, 1.4697558879852295, 1.5850560665130615, 0.0814664363861084, 1.8392986059188843, 1.8003954887390137, 0.9491497278213501, 1.094545602798462, 1.5569206476211548, 1.487239956855774, 1.3883438110351562, 0.35665786266326904, 1.663908839225769, 2.033130168914795, 0.2949044704437256, 1.410631537437439, 0.827182412147522, 0.8835528492927551, 0.5272859334945679, 1.458322525024414, 0.6436884999275208, 0.29018527269363403, 1.8764249086380005, 1.3595600128173828, 1.151138186454773, 1.0442049503326416], "mean_td_error": 1.4269797801971436, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 837.8134396944178, "num_env_steps_trained_throughput_per_sec": 241.24538776915153, "timesteps_total": 40320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 120960, "timers": {"training_iteration_time_ms": 1097.188, "sample_time_ms": 799.79, "load_time_ms": 0.315, "load_throughput": 817813.204, "learn_time_ms": 18.347, "learn_throughput": 14061.878, "synch_weights_time_ms": 9.987}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 120960, "num_agent_steps_trained": 11352, "last_target_update_ts": 40320, "num_target_updates": 44}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-23", "timestamp": 1700369843, "time_this_iter_s": 2.1467950344085693, "time_total_s": 47.55119848251343, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.55119848251343, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 73.83333333333334, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076375961303711, "actor_loss": -5.97285270690918, "critic_loss": 1.0775260925292969, "alpha_loss": -0.1331208497285843, "alpha_value": 0.9868757128715515, "log_alpha_value": -0.013211184181272984, "target_entropy": -6.0, "policy_t": -0.019200850278139114, "mean_q": 2.04015851020813, "max_q": 8.36839485168457, "min_q": 1.789975643157959}, "td_error": [2.5711119174957275, 0.867048978805542, 2.877790927886963, 2.2093234062194824, 1.3742350339889526, 3.2248826026916504, 2.539445400238037, 3.1025454998016357, 1.5474843978881836, 1.5660587549209595, 2.0299081802368164, 2.698699712753296, 2.6616339683532715, 3.839218854904175, 3.6233761310577393, 1.772980809211731, 1.7438127994537354, 2.3091368675231934, 3.789036273956299, 4.936203956604004, 2.7594916820526123, 1.08504056930542, 2.4325368404388428, 3.054698944091797, 0.4329648017883301, 3.2512969970703125, 4.084573745727539, 2.9215478897094727, 1.9190313816070557, 2.4883294105529785, 1.7278673648834229, 1.454986333847046, 3.6375222206115723, 2.3690781593322754, 2.43765926361084, 2.713582992553711, 2.118316650390625, 2.3095130920410156, 2.928204298019409, 3.8653509616851807, 2.472689390182495, 4.214765548706055, 3.4551780223846436, 3.3635895252227783, 2.5461812019348145, 2.4374685287475586, 3.044563055038452, 3.125448226928711, 2.945643901824951, 1.081965446472168, 2.904909372329712, 1.1772292852401733, 3.0096688270568848, 3.281407356262207, 1.3014450073242188, 3.650986671447754, 1.8991132974624634, 4.070746421813965, 4.815101146697998, 3.5354764461517334, 2.6811578273773193, 1.7054048776626587, 1.3707388639450073, 2.340803623199463, 3.1951518058776855, 3.2036497592926025, 2.573007822036743, 4.252309799194336, 3.072519302368164, 2.6784253120422363, 1.6163002252578735, 2.4723639488220215, 3.67633056640625, 2.054333209991455, 3.3101282119750977, 2.0628037452697754, 2.675919771194458, 2.398852825164795, 2.775151491165161, 2.6072287559509277, 2.8594727516174316, 1.9296138286590576, 2.365356922149658, 1.9479066133499146, 1.6356115341186523, 3.3604626655578613], "mean_td_error": 2.632908344268799, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13029670715332, "actor_loss": -5.73295259475708, "critic_loss": 0.24497392773628235, "alpha_loss": -0.13371671736240387, "alpha_value": 0.9868870377540588, "log_alpha_value": -0.013199685141444206, "target_entropy": -6.0, "policy_t": -0.020888041704893112, "mean_q": 1.6563785076141357, "max_q": 4.117542743682861, "min_q": 1.5774860382080078}, "td_error": [2.78717303276062, 0.608526349067688, 0.4552173614501953, 1.0109319686889648, 4.011655807495117, 1.2065516710281372, 1.6186473369598389, 0.8887822031974792, 0.5675620436668396, 1.2093067169189453, 2.5348801612854004, 0.3629190921783447, 0.4645270109176636, 0.4754050374031067, 0.6462372541427612, 2.168085813522339, 1.9272512197494507, 2.2069106101989746, 0.8167849779129028, 0.7688007354736328, 0.6262038946151733, 2.729445695877075, 0.28617918491363525, 1.0412791967391968, 2.504239082336426, 0.2771773338317871, 0.6792145371437073, 0.1338675618171692, 0.6619759798049927, 0.6254685521125793, 2.4581243991851807, 0.02879422903060913, 0.1393072009086609, 1.0199787616729736, 0.7475422620773315, 2.168257236480713, 2.1984829902648926, 0.8572260737419128, 1.3064746856689453, 2.7518062591552734, 1.7783019542694092, 1.4944770336151123, 0.4838104844093323, 2.727390766143799, 1.6536879539489746, 2.0371360778808594, 1.1593017578125, 0.03906667232513428, 1.0428717136383057, 0.13542801141738892, 1.7758558988571167, 1.072488784790039, 1.3956172466278076, 0.3125683069229126, 0.5996969938278198, 2.6958494186401367, 0.1660028100013733, 2.0679168701171875, 0.6593690514564514, 0.6289684772491455, 1.4189627170562744, 0.5517212748527527, 1.6124002933502197, 2.0474555492401123, 1.639206886291504, 1.49653959274292, 1.3782331943511963, 0.8196313381195068, 2.2936997413635254, 1.4134893417358398, 1.1967276334762573, 0.641250491142273, 1.6660147905349731, 1.1184803247451782, 0.15941643714904785, 0.2421565055847168, 2.8243329524993896, 2.7606263160705566, 0.5742636919021606, 0.7250967621803284, 0.7772920727729797, 2.480151891708374, 0.27298927307128906, 3.9311516284942627, 0.5432588458061218, 0.14798754453659058], "mean_td_error": 1.2632038593292236, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108589172363281, "actor_loss": -5.499104022979736, "critic_loss": 0.3898831009864807, "alpha_loss": -0.1334993839263916, "alpha_value": 0.9868803024291992, "log_alpha_value": -0.013206529431045055, "target_entropy": -6.0, "policy_t": 0.0012636780738830566, "mean_q": 1.590627670288086, "max_q": 4.76915979385376, "min_q": 1.4873356819152832}, "td_error": [2.1483891010284424, 3.3307442665100098, 2.2881102561950684, 1.1625361442565918, 1.8359687328338623, 0.3292313814163208, 2.8414347171783447, 1.5074701309204102, 3.107733964920044, 0.4665790796279907, 0.4547045826911926, 1.0959264039993286, 0.6649963855743408, 1.0891077518463135, 2.565737724304199, 0.18427079916000366, 0.7804518342018127, 1.1748394966125488, 1.3975697755813599, 2.1812820434570312, 1.2024980783462524, 0.7909789085388184, 2.4623827934265137, 2.111478328704834, 0.2532457113265991, 1.8537331819534302, 0.2373272180557251, 0.6245913505554199, 0.9790223836898804, 1.4387457370758057, 1.288994312286377, 1.1708488464355469, 0.3015657067298889, 0.45327216386795044, 2.056060791015625, 0.84649658203125, 1.4225833415985107, 0.2982434034347534, 1.5016272068023682, 1.9343430995941162, 2.061577320098877, 1.4810936450958252, 2.297779083251953, 3.0452628135681152, 2.5669898986816406, 1.3192086219787598, 0.21939849853515625, 0.23257708549499512, 2.224738597869873, 1.5064067840576172, 0.08511114120483398, 0.6799021363258362, 1.7077969312667847, 2.185898780822754, 4.732074737548828, 1.97123122215271, 2.196002960205078, 2.8170714378356934, 0.30542051792144775, 5.070748329162598, 2.7280642986297607, 1.7308158874511719, 1.3509628772735596, 0.8662421703338623, 2.329336643218994, 1.3233275413513184, 0.23088526725769043, 1.2054821252822876, 2.342392921447754, 0.911788821220398, 1.0196905136108398, 2.303490161895752, 0.7135796546936035, 0.9368737936019897, 1.3177403211593628, 1.0750367641448975, 2.7959280014038086, 0.8289061188697815, 1.2887301445007324, 1.4954655170440674, 1.4087669849395752, 0.294364869594574, 0.4604124426841736, 1.7070711851119995, 0.08496063947677612, 0.966920018196106], "mean_td_error": 1.4681239128112793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 44.0}}, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 832.405016008656, "num_env_steps_trained_throughput_per_sec": 239.68805148463534, "timesteps_total": 41216, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 123648, "timers": {"training_iteration_time_ms": 1095.475, "sample_time_ms": 793.98, "load_time_ms": 0.317, "load_throughput": 814427.961, "learn_time_ms": 18.45, "learn_throughput": 13983.687, "synch_weights_time_ms": 9.892}, "counters": {"num_env_steps_sampled": 41216, "num_env_steps_trained": 11610, "num_agent_steps_sampled": 123648, "num_agent_steps_trained": 11610, "last_target_update_ts": 41216, "num_target_updates": 45}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-25", "timestamp": 1700369845, "time_this_iter_s": 1.0859041213989258, "time_total_s": 48.63710260391235, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.63710260391235, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 83.2, "ram_util_percent": 66.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097116470336914, "actor_loss": -6.065018653869629, "critic_loss": 1.1317192316055298, "alpha_loss": -0.13642537593841553, "alpha_value": 0.9865795373916626, "log_alpha_value": -0.01351131871342659, "target_entropy": -6.0, "policy_t": -0.032835375517606735, "mean_q": 2.2834322452545166, "max_q": 12.798832893371582, "min_q": 1.8680589199066162}, "td_error": [2.5059704780578613, 4.116177558898926, 1.8201006650924683, 1.2465687990188599, 2.7580621242523193, 1.671099066734314, 2.3085947036743164, 1.4074997901916504, 3.5736145973205566, 2.129547357559204, 2.2342827320098877, 1.8478717803955078, 1.3736339807510376, 1.9426929950714111, 4.817791938781738, 2.39857816696167, 2.355247974395752, 2.768876552581787, 3.260514974594116, 0.6581952571868896, 3.1082253456115723, 0.945090651512146, 3.603379726409912, 0.6991465091705322, 4.247447967529297, 2.666497230529785, 1.3294072151184082, 1.2595734596252441, 4.039371490478516, 3.7226500511169434, 1.7773423194885254, 2.8750722408294678, 1.3075599670410156, 4.861841201782227, 3.6453187465667725, 2.1807618141174316, 2.391690731048584, 5.933923721313477, 3.048161268234253, 1.1774320602416992, 2.2513933181762695, 4.017860412597656, 2.5592470169067383, 0.8946516513824463, 1.9640859365463257, 5.992696762084961, 1.1868321895599365, 2.004505157470703, 0.2861332893371582, 3.526870012283325, 2.4552669525146484, 2.632202386856079, 3.052896738052368, 2.025280714035034, 5.251893043518066, 4.396807670593262, 3.7178144454956055, 1.4745261669158936, 4.671421051025391, 3.6036293506622314, 2.3261446952819824, 1.4257997274398804, 3.3773751258850098, 8.576400756835938, 2.8667774200439453, 2.063319206237793, 3.6937804222106934, 3.084165573120117, 2.818871021270752, 2.786339282989502, 1.7319130897521973, 3.7236881256103516, 2.460148572921753, 1.9528752565383911, 2.0526282787323, 4.274466037750244, 2.828958511352539, 1.8200650215148926, 1.9510465860366821, 2.663555145263672, 1.0736863613128662, 5.671021938323975, 1.202317714691162, 1.753442406654358, 4.638236999511719, 1.615926742553711], "mean_td_error": 2.7257416248321533, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098271369934082, "actor_loss": -5.790395259857178, "critic_loss": 0.19936491549015045, "alpha_loss": -0.13632497191429138, "alpha_value": 0.9865908622741699, "log_alpha_value": -0.013499831780791283, "target_entropy": -6.0, "policy_t": -0.02239912562072277, "mean_q": 1.8264050483703613, "max_q": 4.525578498840332, "min_q": 1.6428190469741821}, "td_error": [1.7712737321853638, 0.07641184329986572, 0.34361159801483154, 0.6861202716827393, 1.8203285932540894, 0.2370557188987732, 0.0389828085899353, 0.08829689025878906, 0.5935452580451965, 0.1589568853378296, 0.8342876434326172, 0.22006285190582275, 2.351449966430664, 0.6351737976074219, 1.382981300354004, 0.0462261438369751, 1.2903813123703003, 0.9104356169700623, 0.2604650855064392, 1.787920355796814, 2.0304460525512695, 2.123478412628174, 1.6185256242752075, 2.0387706756591797, 2.0902621746063232, 0.3218727707862854, 0.18264234066009521, 1.8735921382904053, 1.6490569114685059, 2.2522544860839844, 0.22925305366516113, 0.5439549088478088, 1.5210168361663818, 0.836681067943573, 0.38523316383361816, 1.299172043800354, 0.3235461115837097, 0.9066698551177979, 0.9672680497169495, 1.7845373153686523, 1.7229423522949219, 0.6666057705879211, 1.9809712171554565, 2.4645609855651855, 0.8182600736618042, 1.4247350692749023, 1.0401761531829834, 0.37366145849227905, 2.1093528270721436, 1.0833975076675415, 0.9488609433174133, 0.2268608808517456, 0.2832831144332886, 1.0043917894363403, 0.5588108897209167, 1.1950987577438354, 2.0197877883911133, 0.839724063873291, 0.33230292797088623, 1.1224323511123657, 3.581306219100952, 1.9330096244812012, 0.13847756385803223, 0.22514796257019043, 1.4614237546920776, 1.468994140625, 0.48893892765045166, 0.09920161962509155, 1.466622233390808, 1.9552528858184814, 0.42823266983032227, 2.031083106994629, 0.7369139194488525, 0.35494303703308105, 0.5588326454162598, 0.7396034002304077, 0.18769431114196777, 0.06376492977142334, 0.32512128353118896, 0.3145374655723572, 2.0912301540374756, 0.5759261250495911, 2.7572216987609863, 1.0888915061950684, 0.6569095849990845, 1.5985522270202637], "mean_td_error": 1.0471657514572144, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073748588562012, "actor_loss": -5.522686958312988, "critic_loss": 0.35832875967025757, "alpha_loss": -0.1360597014427185, "alpha_value": 0.9865844249725342, "log_alpha_value": -0.013506362214684486, "target_entropy": -6.0, "policy_t": 0.01652888022363186, "mean_q": 1.8264261484146118, "max_q": 5.257266521453857, "min_q": 1.5593531131744385}, "td_error": [0.8852295875549316, 1.2419323921203613, 0.8124709725379944, 0.43471163511276245, 0.25178539752960205, 2.117952823638916, 0.6420942544937134, 1.022282361984253, 0.551485538482666, 0.8878991603851318, 1.0350701808929443, 2.7492480278015137, 3.222459316253662, 1.3687628507614136, 0.4852316379547119, 1.3161019086837769, 2.4559247493743896, 1.9979699850082397, 1.9405021667480469, 1.7892401218414307, 0.5193588733673096, 0.5448693037033081, 1.3175632953643799, 0.08956688642501831, 2.5623831748962402, 1.8555594682693481, 1.8894455432891846, 0.8832233548164368, 2.0540876388549805, 2.0288689136505127, 1.6606711149215698, 1.6213970184326172, 1.7248351573944092, 0.14593929052352905, 0.8156806230545044, 2.211785316467285, 0.3632054328918457, 0.7548509240150452, 0.08924269676208496, 0.6893584132194519, 1.0708351135253906, 1.5377380847930908, 0.4206479787826538, 2.2180943489074707, 0.08854281902313232, 0.6873937845230103, 0.5256692171096802, 1.4304170608520508, 3.3116860389709473, 0.09002190828323364, 0.08983337879180908, 0.14169156551361084, 0.09205585718154907, 0.09159338474273682, 2.1708078384399414, 1.4119234085083008, 1.952112078666687, 1.042919397354126, 1.519773244857788, 0.8809077143669128, 1.604495882987976, 2.412203788757324, 0.43855035305023193, 2.3254237174987793, 2.458065986633301, 1.8166515827178955, 4.15159797668457, 0.9542884230613708, 0.4840549826622009, 1.5350213050842285, 0.7222917079925537, 3.184573173522949, 2.249960422515869, 3.0330257415771484, 3.0757150650024414, 0.35786688327789307, 1.1760406494140625, 1.1355806589126587, 2.0874762535095215, 1.4369226694107056, 0.72697913646698, 2.255614757537842, 0.22616612911224365, 1.1345336437225342, 2.853640556335449, 1.26631760597229], "mean_td_error": 1.359394907951355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 786.0056073097065, "num_env_steps_trained_throughput_per_sec": 226.32750746194674, "timesteps_total": 42112, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 126336, "timers": {"training_iteration_time_ms": 1103.529, "sample_time_ms": 801.612, "load_time_ms": 0.318, "load_throughput": 811618.114, "learn_time_ms": 18.548, "learn_throughput": 13910.025, "synch_weights_time_ms": 10.016}, "counters": {"num_env_steps_sampled": 42112, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 126336, "num_agent_steps_trained": 11868, "last_target_update_ts": 42112, "num_target_updates": 46}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-26", "timestamp": 1700369846, "time_this_iter_s": 1.1480960845947266, "time_total_s": 49.78519868850708, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 49.78519868850708, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069807052612305, "actor_loss": -6.133973598480225, "critic_loss": 1.0734670162200928, "alpha_loss": -0.1390787959098816, "alpha_value": 0.9862834811210632, "log_alpha_value": -0.013811462558805943, "target_entropy": -6.0, "policy_t": 0.01893068477511406, "mean_q": 2.314474105834961, "max_q": 12.870080947875977, "min_q": 1.9482078552246094}, "td_error": [1.4703094959259033, 3.113708257675171, 1.4686022996902466, 1.9175077676773071, 3.674225330352783, 3.0312042236328125, 1.5423064231872559, 8.63515853881836, 4.12894344329834, 4.560577869415283, 2.9260404109954834, 2.155336856842041, 0.7283197045326233, 2.453059673309326, 2.425610065460205, 2.3457350730895996, 1.019775152206421, 1.991769552230835, 3.5272440910339355, 3.049567937850952, 2.1366872787475586, 3.745450973510742, 1.4896875619888306, 3.036695718765259, 1.949381709098816, 1.7368714809417725, 0.7423329949378967, 2.745267152786255, 2.780289649963379, 3.885951519012451, 3.2404427528381348, 2.9026732444763184, 1.9989116191864014, 2.720120429992676, 2.0924386978149414, 1.8152707815170288, 2.6889185905456543, 3.2413363456726074, 2.6652579307556152, 3.019012451171875, 2.4083597660064697, 2.5955822467803955, 1.3903529644012451, 1.4489139318466187, 1.8440098762512207, 1.1591523885726929, 2.433835983276367, 1.7813007831573486, 0.22329747676849365, 2.123478889465332, 3.3495025634765625, 3.746699094772339, 2.1144654750823975, 2.3125035762786865, 0.7068485617637634, 1.2566323280334473, 1.433260202407837, 2.8252170085906982, 2.316290855407715, 1.5627821683883667, 1.7953059673309326, 1.510557770729065, 3.9277050495147705, 4.0001420974731445, 3.4099459648132324, 2.084458351135254, 3.048180103302002, 1.512940764427185, 3.484879970550537, 2.347708225250244, 2.5549535751342773, 4.71915864944458, 2.4337379932403564, 1.3796632289886475, 3.9097354412078857, 3.7837324142456055, 0.13649237155914307, 1.0737367868423462, 2.799859046936035, 5.58400821685791, 3.2805585861206055, 4.046250820159912, 4.313663959503174, 2.1537153720855713, 2.2568142414093018, 2.958949565887451], "mean_td_error": 2.5620620250701904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058029174804688, "actor_loss": -5.797709941864014, "critic_loss": 0.24604907631874084, "alpha_loss": -0.1388004720211029, "alpha_value": 0.9862948060035706, "log_alpha_value": -0.013799967244267464, "target_entropy": -6.0, "policy_t": 0.001398013555444777, "mean_q": 1.912810206413269, "max_q": 5.418212890625, "min_q": 1.710922122001648}, "td_error": [1.75044584274292, 0.26822471618652344, 0.5790406465530396, 1.483055591583252, 3.6945278644561768, 1.141740083694458, 1.1737828254699707, 0.897929310798645, 2.1738510131835938, 1.7608531713485718, 2.2410755157470703, 0.5925576686859131, 0.9780603647232056, 2.72743558883667, 1.6455647945404053, 0.058867692947387695, 1.3518469333648682, 1.9956027269363403, 0.383419394493103, 0.880403459072113, 2.744255781173706, 0.7829789519309998, 1.6194570064544678, 2.251985549926758, 0.9441531896591187, 1.8965749740600586, 1.322746992111206, 1.7637052536010742, 0.9977722764015198, 1.3601213693618774, 0.8971949815750122, 1.9041458368301392, 0.7078122496604919, 2.8568880558013916, 0.0868990421295166, 2.2218017578125, 2.213751792907715, 0.5905725359916687, 1.8246197700500488, 1.719444990158081, 0.5969319343566895, 0.8173026442527771, 0.7264068126678467, 1.3992772102355957, 0.5105926990509033, 1.1756772994995117, 1.601962924003601, 0.5135821104049683, 0.7853882312774658, 1.05729341506958, 0.17833691835403442, 0.35926544666290283, 0.06539028882980347, 2.0366451740264893, 0.6963641047477722, 2.3764631748199463, 2.110485076904297, 0.0731194019317627, 0.0530092716217041, 0.42860889434814453, 2.0805764198303223, 0.09540235996246338, 0.7186282873153687, 0.82387375831604, 1.2046551704406738, 1.5300463438034058, 1.6846532821655273, 0.0047332048416137695, 1.7126054763793945, 0.4074552655220032, 1.2908427715301514, 0.3614009618759155, 3.2114577293395996, 0.04619443416595459, 0.9114251136779785, 1.5692861080169678, 0.671969473361969, 2.514639377593994, 0.5916756391525269, 0.7183278203010559, 1.4615592956542969, 2.091181993484497, 0.9305717945098877, 0.9513559341430664, 0.5167715549468994, 0.750728964805603], "mean_td_error": 1.219759225845337, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.184255599975586, "actor_loss": -5.7022175788879395, "critic_loss": 0.42078468203544617, "alpha_loss": -0.14060549437999725, "alpha_value": 0.9862887263298035, "log_alpha_value": -0.013806162402033806, "target_entropy": -6.0, "policy_t": -0.007607051637023687, "mean_q": 1.7770321369171143, "max_q": 5.213714599609375, "min_q": 1.6434457302093506}, "td_error": [1.2606351375579834, 0.24319583177566528, 0.8136571049690247, 1.2424713373184204, 1.597192645072937, 0.6485232710838318, 1.7970423698425293, 0.43852144479751587, 2.632133960723877, 1.149587631225586, 1.3891572952270508, 1.6292648315429688, 0.3239510655403137, 3.1270008087158203, 0.9571593403816223, 0.8389843106269836, 0.8823546767234802, 0.09258347749710083, 3.0213782787323, 1.9280338287353516, 2.5263333320617676, 0.11297565698623657, 2.323517322540283, 0.7804719805717468, 3.1503467559814453, 0.8873995542526245, 3.7319998741149902, 2.4285049438476562, 1.1339524984359741, 0.929394006729126, 1.5943899154663086, 2.2797727584838867, 1.2661712169647217, 0.6110138297080994, 0.09377890825271606, 2.8292689323425293, 1.2024857997894287, 0.29033589363098145, 1.3504137992858887, 1.9099984169006348, 2.2882370948791504, 2.756009340286255, 1.7945163249969482, 0.1312018632888794, 4.000002384185791, 0.741446852684021, 0.9957147836685181, 0.389717161655426, 1.721364974975586, 1.934330701828003, 1.3030403852462769, 0.4744921326637268, 2.92950177192688, 3.0611205101013184, 0.9620281457901001, 0.5031490325927734, 1.5844700336456299, 1.822568416595459, 1.1133942604064941, 1.2938377857208252, 1.7230650186538696, 2.714045524597168, 1.8397094011306763, 2.375405788421631, 1.825451135635376, 2.2744064331054688, 1.1598128080368042, 1.9549996852874756, 0.3386988043785095, 2.1557116508483887, 2.34586238861084, 1.8502490520477295, 0.5553014278411865, 3.2267441749572754, 1.561082124710083, 0.6103808879852295, 0.5148226022720337, 1.098624587059021, 4.645586967468262, 1.6490058898925781, 2.743203639984131, 0.9864426851272583, 0.2245916724205017, 1.62644624710083, 0.563347339630127, 0.7048752307891846], "mean_td_error": 1.5408532619476318, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 783.0024862504081, "num_env_steps_trained_throughput_per_sec": 225.46276947835412, "timesteps_total": 43008, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 1088.671, "sample_time_ms": 809.227, "load_time_ms": 0.314, "load_throughput": 821975.262, "learn_time_ms": 18.386, "learn_throughput": 14032.684, "synch_weights_time_ms": 10.384}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 12126, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 12126, "last_target_update_ts": 43008, "num_target_updates": 47}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-27", "timestamp": 1700369847, "time_this_iter_s": 1.157862901687622, "time_total_s": 50.9430615901947, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.9430615901947, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 68.1, "ram_util_percent": 66.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122008323669434, "actor_loss": -6.270955562591553, "critic_loss": 1.0571916103363037, "alpha_loss": -0.14283724129199982, "alpha_value": 0.9859875440597534, "log_alpha_value": -0.014111550524830818, "target_entropy": -6.0, "policy_t": -0.02987126260995865, "mean_q": 2.3617522716522217, "max_q": 12.926806449890137, "min_q": 2.0304644107818604}, "td_error": [3.1754727363586426, 2.6337153911590576, 3.035611152648926, 1.937178611755371, 2.336498975753784, 1.767338752746582, 4.70650577545166, 3.2627201080322266, 4.011719703674316, 1.0677303075790405, 2.1163582801818848, 3.442749261856079, 3.550128936767578, 2.4868202209472656, 1.9131957292556763, 2.6324520111083984, 1.3088948726654053, 2.7815017700195312, 1.955755352973938, 0.5441594123840332, 1.5244317054748535, 1.0208938121795654, 2.0437591075897217, 1.7239910364151, 2.814723014831543, 3.942570686340332, 2.6733386516571045, 3.9745476245880127, 1.737646222114563, 2.3312318325042725, 2.1623973846435547, 0.7592952251434326, 9.267748832702637, 2.719926357269287, 1.4774445295333862, 3.9528722763061523, 4.344934463500977, 1.3519043922424316, 3.6140975952148438, 3.195375919342041, 0.1610487699508667, 1.2220834493637085, 0.8584467172622681, 3.414635419845581, 0.04336953163146973, 1.6880439519882202, 3.6616387367248535, 2.51908016204834, 3.3472514152526855, 2.747091293334961, 3.182528495788574, 1.3914275169372559, 4.070456504821777, 4.165471076965332, 1.2934119701385498, 4.337876796722412, 3.4514083862304688, 3.516613006591797, 3.869537830352783, 3.180040121078491, 0.8739916086196899, 3.0822086334228516, 2.6665234565734863, 1.4979461431503296, 3.0175108909606934, 1.2172956466674805, 2.0051846504211426, 2.5813302993774414, 0.7135696411132812, 1.944667100906372, 0.31058597564697266, 4.926002025604248, 2.779639959335327, 1.450208306312561, 3.3784329891204834, 3.2310924530029297, 1.5751969814300537, 3.3108811378479004, 2.3633224964141846, 0.7423313856124878, 3.2474441528320312, 2.9772496223449707, 1.152852177619934, 2.8199386596679688, 2.7159318923950195, 3.5653905868530273], "mean_td_error": 2.553114414215088, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08332347869873, "actor_loss": -5.912042140960693, "critic_loss": 0.19801194965839386, "alpha_loss": -0.1421748399734497, "alpha_value": 0.9859989285469055, "log_alpha_value": -0.014099998399615288, "target_entropy": -6.0, "policy_t": -0.03126872703433037, "mean_q": 1.9282054901123047, "max_q": 5.797143936157227, "min_q": 1.7772362232208252}, "td_error": [1.9972403049468994, 1.385232925415039, 1.74576735496521, 1.7893352508544922, 0.3958502411842346, 0.27505791187286377, 2.1262710094451904, 0.16428673267364502, 2.2686288356781006, 0.3123716115951538, 0.12470674514770508, 0.32936400175094604, 0.367565393447876, 1.9910396337509155, 0.7830119729042053, 1.6387842893600464, 1.8229413032531738, 1.5540251731872559, 0.571012556552887, 1.2838561534881592, 2.075169086456299, 1.6644808053970337, 2.3448667526245117, 1.4195175170898438, 1.000899076461792, 2.6766881942749023, 0.3138084411621094, 1.296332597732544, 1.5024908781051636, 1.6170339584350586, 0.08901196718215942, 2.441469669342041, 1.07374906539917, 0.48088085651397705, 2.3307769298553467, 1.1073341369628906, 0.3814263343811035, 0.3664274215698242, 2.271970272064209, 3.5768792629241943, 1.0848757028579712, 2.4011013507843018, 0.5773536562919617, 0.21650218963623047, 0.5111251473426819, 1.1920342445373535, 0.47426843643188477, 0.8912985324859619, 0.569689929485321, 2.3977339267730713, 1.2844109535217285, 0.026189148426055908, 1.8684278726577759, 0.8289699554443359, 1.234643578529358, 1.7045844793319702, 0.057024478912353516, 1.8666925430297852, 1.3265876770019531, 0.2937650680541992, 0.7297071814537048, 0.48970699310302734, 1.3784079551696777, 1.2083933353424072, 0.235304057598114, 0.7769244313240051, 0.33368051052093506, 0.19522416591644287, 0.9229183197021484, 2.899416923522949, 1.4226174354553223, 0.47407597303390503, 1.9314311742782593, 0.15128552913665771, 0.9534222483634949, 0.8138899803161621, 0.5219123959541321, 0.43268072605133057, 1.272759199142456, 0.40654200315475464, 0.41224026679992676, 1.2020964622497559, 4.113671779632568, 0.22145479917526245, 0.8370107412338257, 0.8551716208457947], "mean_td_error": 1.1506602764129639, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073392868041992, "actor_loss": -5.661282539367676, "critic_loss": 0.30109697580337524, "alpha_loss": -0.14209723472595215, "alpha_value": 0.9859928488731384, "log_alpha_value": -0.014106192626059055, "target_entropy": -6.0, "policy_t": 0.040608953684568405, "mean_q": 1.9121708869934082, "max_q": 5.643905162811279, "min_q": 1.7237074375152588}, "td_error": [2.207091808319092, 1.8162176609039307, 0.2207188606262207, 2.455230236053467, 0.32394248247146606, 1.9114831686019897, 0.09912192821502686, 0.9326491951942444, 2.1496176719665527, 1.9687716960906982, 1.180666208267212, 1.2597203254699707, 0.6859062314033508, 2.263906478881836, 0.8480080366134644, 2.0132923126220703, 1.3875675201416016, 0.15262740850448608, 1.2127424478530884, 1.9625881910324097, 2.010565996170044, 1.8124308586120605, 1.93021821975708, 2.4576587677001953, 0.5638176798820496, 0.7032424807548523, 0.11505436897277832, 1.7298285961151123, 0.7655195593833923, 0.1475622057914734, 1.310016393661499, 0.9427288770675659, 2.509874105453491, 1.5713346004486084, 0.137306809425354, 1.277441382408142, 0.6912541389465332, 1.74057936668396, 0.10031712055206299, 0.11900967359542847, 1.9634777307510376, 1.2082996368408203, 3.222233295440674, 0.891018271446228, 1.0373615026474, 0.6174297332763672, 1.885587453842163, 0.990264892578125, 0.46069878339767456, 2.4736876487731934, 0.2959449887275696, 2.602140426635742, 0.5533708333969116, 2.5056064128875732, 1.9982157945632935, 1.2455244064331055, 0.6201050281524658, 1.4777238368988037, 0.9547878503799438, 1.6351430416107178, 0.4621128439903259, 0.9751046299934387, 1.2916984558105469, 0.8973832726478577, 1.888137936592102, 1.8525917530059814, 0.6747437715530396, 1.2266993522644043, 0.10045081377029419, 0.541523814201355, 0.4746301770210266, 0.9106729030609131, 1.4888532161712646, 0.5721611380577087, 1.3708022832870483, 3.1054799556732178, 1.7750470638275146, 0.9293932914733887, 0.45623087882995605, 0.638066828250885, 0.16082245111465454, 1.3781094551086426, 0.1701682209968567, 0.12030637264251709, 0.6274962425231934, 1.908015489578247], "mean_td_error": 1.2130576372146606, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 766.1140004660169, "num_env_steps_trained_throughput_per_sec": 220.59979031275935, "timesteps_total": 43904, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 131712, "timers": {"training_iteration_time_ms": 1106.246, "sample_time_ms": 825.102, "load_time_ms": 0.313, "load_throughput": 824040.841, "learn_time_ms": 18.279, "learn_throughput": 14114.683, "synch_weights_time_ms": 10.497}, "counters": {"num_env_steps_sampled": 43904, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 131712, "num_agent_steps_trained": 12384, "last_target_update_ts": 43904, "num_target_updates": 48}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-28", "timestamp": 1700369848, "time_this_iter_s": 1.1789870262145996, "time_total_s": 52.1220486164093, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b9800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 52.1220486164093, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 95.5, "ram_util_percent": 67.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099534034729004, "actor_loss": -6.407317638397217, "critic_loss": 0.8890340924263, "alpha_loss": -0.14858172833919525, "alpha_value": 0.9853959679603577, "log_alpha_value": -0.014711741358041763, "target_entropy": -6.0, "policy_t": 0.03981873393058777, "mean_q": 2.5269930362701416, "max_q": 13.04633903503418, "min_q": 2.202364444732666}, "td_error": [0.5885133743286133, 2.4803833961486816, 1.5214099884033203, 0.549066424369812, 1.9817018508911133, 2.5621368885040283, 3.5061490535736084, 2.4885940551757812, 0.7501962184906006, 4.592880725860596, 4.036026477813721, 2.0194191932678223, 2.6325342655181885, 3.0751447677612305, 2.150740623474121, 2.8567614555358887, 1.9793190956115723, 1.829681634902954, 2.908085346221924, 1.2479766607284546, 2.8686680793762207, 2.4932668209075928, 3.7307357788085938, 0.964180588722229, 2.7477145195007324, 3.7370705604553223, 2.0989460945129395, 2.7696785926818848, 7.440280437469482, 0.2387145757675171, 2.3624267578125, 3.6121156215667725, 2.5805623531341553, 2.7810654640197754, 1.7229626178741455, 3.8334202766418457, 4.014303684234619, 2.9192943572998047, 3.81827712059021, 2.603433132171631, 1.0971556901931763, 3.797548294067383, 2.6630961894989014, 4.087921142578125, 2.793405055999756, 3.736271858215332, 0.7489980459213257, 3.0553104877471924, 0.1597599983215332, 2.550481081008911, 0.21906471252441406, 1.8275532722473145, 0.8217875957489014, 2.362610101699829, 4.177435874938965, 1.6623468399047852, 1.668076753616333, 3.7513978481292725, 2.876633405685425, 3.2634899616241455, 2.7751007080078125, 3.1310982704162598, 2.139699935913086, 1.2949509620666504, 4.090664863586426, 1.2508587837219238, 1.4072184562683105, 1.0076814889907837, 0.20617592334747314, 2.244251251220703, 1.1325712203979492, 2.4108352661132812, 2.0486831665039062, 1.2670928239822388, 3.327838659286499, 4.644678592681885, 2.984616279602051, 1.92582368850708, 1.6856415271759033, 2.2276558876037598, 4.633363246917725, 1.3096776008605957, 2.226652145385742, 2.4455699920654297, 3.1981592178344727, 0.40004050731658936], "mean_td_error": 2.4398927688598633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065855026245117, "actor_loss": -6.0184125900268555, "critic_loss": 0.1760484278202057, "alpha_loss": -0.14796867966651917, "alpha_value": 0.9854074716567993, "log_alpha_value": -0.014700060710310936, "target_entropy": -6.0, "policy_t": -0.031460538506507874, "mean_q": 2.065108299255371, "max_q": 5.14670991897583, "min_q": 1.9121859073638916}, "td_error": [1.1439259052276611, 2.273083209991455, 0.8307360410690308, 1.7408015727996826, 1.3692891597747803, 0.9833278656005859, 1.5179797410964966, 0.0915062427520752, 2.1479806900024414, 1.561116099357605, 1.4943047761917114, 1.216732144355774, 2.233764171600342, 1.03888738155365, 0.667748212814331, 3.2645299434661865, 0.22745126485824585, 1.4826081991195679, 0.9771626591682434, 2.607914447784424, 2.215332508087158, 1.0290882587432861, 1.3974997997283936, 0.7136003971099854, 0.5090413093566895, 0.3319353461265564, 0.17222219705581665, 1.7883415222167969, 2.2159423828125, 0.06198406219482422, 0.5928254127502441, 0.08111649751663208, 0.3313838839530945, 1.506518840789795, 0.09730172157287598, 1.6386992931365967, 1.4601285457611084, 1.496452808380127, 1.1870017051696777, 0.30527275800704956, 2.4928698539733887, 0.39333105087280273, 1.5577486753463745, 1.1933488845825195, 2.0911502838134766, 0.7375732660293579, 0.5215452909469604, 0.6512214541435242, 0.31256502866744995, 0.4615668058395386, 1.140538215637207, 0.8606770038604736, 1.2815487384796143, 1.0383810997009277, 1.3794618844985962, 0.16907858848571777, 0.29710835218429565, 1.0435032844543457, 0.4447020888328552, 0.8489634990692139, 1.0008050203323364, 1.746607780456543, 1.9632095098495483, 0.07300496101379395, 0.18757951259613037, 0.9383547306060791, 0.09688973426818848, 1.4771950244903564, 0.8854044079780579, 1.4722013473510742, 0.48320484161376953, 1.6964099407196045, 0.13876479864120483, 1.9772095680236816, 1.6160048246383667, 0.25524377822875977, 0.15444576740264893, 0.030410051345825195, 0.6624035239219666, 1.0102341175079346, 1.0381433963775635, 0.23334503173828125, 1.0486055612564087, 1.0325616598129272, 2.4068615436553955, 0.4178306460380554], "mean_td_error": 1.0577017068862915, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116284370422363, "actor_loss": -5.883003234863281, "critic_loss": 0.29073381423950195, "alpha_loss": -0.14876994490623474, "alpha_value": 0.9854016304016113, "log_alpha_value": -0.014705986715853214, "target_entropy": -6.0, "policy_t": -0.01334630697965622, "mean_q": 2.1180241107940674, "max_q": 5.0522847175598145, "min_q": 1.7824859619140625}, "td_error": [0.9012593030929565, 1.2163429260253906, 2.2464048862457275, 0.7852513194084167, 0.6204341650009155, 3.972970962524414, 3.89310359954834, 2.693427562713623, 0.995904803276062, 1.204702615737915, 0.3515509366989136, 0.23952889442443848, 0.9028187394142151, 1.2890098094940186, 0.925711989402771, 0.6869570016860962, 3.0246777534484863, 0.854759693145752, 1.5880976915359497, 0.5680188536643982, 2.1097898483276367, 0.2975512146949768, 0.28512871265411377, 1.1326698064804077, 0.4839664101600647, 0.1083478331565857, 1.0947386026382446, 1.8585457801818848, 0.8038911819458008, 0.8292707204818726, 0.3373802900314331, 1.9258711338043213, 0.7345145344734192, 1.3502323627471924, 0.666222333908081, 0.12638002634048462, 0.1134037971496582, 2.6901297569274902, 0.3476804494857788, 0.62274569272995, 1.3438884019851685, 0.46983611583709717, 1.3262531757354736, 2.3959717750549316, 0.10798060894012451, 3.4782657623291016, 3.0065371990203857, 2.0164833068847656, 1.113805890083313, 1.6413791179656982, 0.7203166484832764, 0.541581392288208, 0.5789313316345215, 0.495948851108551, 1.9417178630828857, 0.22154444456100464, 1.6259163618087769, 0.9392449855804443, 0.6948057413101196, 2.2832703590393066, 0.15789586305618286, 0.37195533514022827, 1.8893795013427734, 1.8218718767166138, 0.19256126880645752, 1.7454535961151123, 0.44428521394729614, 0.9021046161651611, 1.9455609321594238, 1.400949239730835, 0.1110495924949646, 3.0068609714508057, 1.1654411554336548, 0.8368037939071655, 0.7171802520751953, 1.239997148513794, 0.11578691005706787, 2.715916156768799, 0.5371490716934204, 1.3861232995986938, 0.331428587436676, 0.6104058623313904, 1.7232029438018799, 1.6393369436264038, 0.7728180289268494, 0.32390064001083374], "mean_td_error": 1.1852151155471802, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 888.9135791430932, "num_env_steps_trained_throughput_per_sec": 255.9594904228996, "timesteps_total": 45696, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 137088, "timers": {"training_iteration_time_ms": 1112.096, "sample_time_ms": 831.187, "load_time_ms": 0.313, "load_throughput": 824543.151, "learn_time_ms": 18.291, "learn_throughput": 14105.576, "synch_weights_time_ms": 10.714}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 137088, "num_agent_steps_trained": 12900, "last_target_update_ts": 45696, "num_target_updates": 50}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-30", "timestamp": 1700369850, "time_this_iter_s": 2.02323579788208, "time_total_s": 54.14528441429138, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b82c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 54.14528441429138, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 72.33333333333333, "ram_util_percent": 66.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.134695053100586, "actor_loss": -6.534428596496582, "critic_loss": 0.7585795521736145, "alpha_loss": -0.15213999152183533, "alpha_value": 0.9851003289222717, "log_alpha_value": -0.015011797659099102, "target_entropy": -6.0, "policy_t": -0.018934467807412148, "mean_q": 2.5670347213745117, "max_q": 13.10771369934082, "min_q": 2.291837692260742}, "td_error": [3.977573871612549, 3.1621434688568115, 2.4896278381347656, 2.8151021003723145, 2.0413126945495605, 2.5125341415405273, 2.6450817584991455, 2.1797215938568115, 0.33570075035095215, 1.7027078866958618, 2.685673713684082, 2.7412307262420654, 0.8386708498001099, 3.4878125190734863, 2.118759870529175, 3.020294666290283, 2.0229387283325195, 1.9440746307373047, 2.5080785751342773, 1.7055004835128784, 0.5145965814590454, 2.036034107208252, 1.376027226448059, 2.274779796600342, 1.6742255687713623, 1.3487118482589722, 0.033956050872802734, 0.6212139129638672, 2.3813300132751465, 0.38770484924316406, 2.022160053253174, 3.180694103240967, 1.9786244630813599, 2.100137233734131, 0.7886120080947876, 0.722474217414856, 0.6423436403274536, 1.7255065441131592, 2.446964740753174, 2.261369228363037, 2.0805463790893555, 3.3144097328186035, 2.490156650543213, 2.7540979385375977, 2.6217081546783447, 2.2415363788604736, 3.9709692001342773, 2.1833295822143555, 3.364652633666992, 3.364917278289795, 0.9285575151443481, 1.4700671434402466, 0.30080461502075195, 1.625252604484558, 1.9498045444488525, 1.6613413095474243, 2.300485849380493, 1.4262614250183105, 3.5436758995056152, 2.0489859580993652, 1.492047905921936, 2.0018362998962402, 2.0337586402893066, 1.9709182977676392, 1.1810249090194702, 1.626387357711792, 2.721320867538452, 3.2703657150268555, 1.5097219944000244, 2.6574301719665527, 8.824424743652344, 0.6420185565948486, 2.0196313858032227, 3.562835216522217, 2.0701818466186523, 2.7733500003814697, 0.16467440128326416, 2.0087244510650635, 2.419586420059204, 2.2427096366882324, 1.7052581310272217, 2.599790096282959, 4.080923557281494, 1.6566112041473389, 2.5643372535705566, 2.9603333473205566], "mean_td_error": 2.16109037399292, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04311752319336, "actor_loss": -6.067834854125977, "critic_loss": 0.1587708592414856, "alpha_loss": -0.15064722299575806, "alpha_value": 0.9851118922233582, "log_alpha_value": -0.015000046230852604, "target_entropy": -6.0, "policy_t": 0.012092710472643375, "mean_q": 2.043675184249878, "max_q": 3.806854486465454, "min_q": 1.9797561168670654}, "td_error": [1.755333662033081, 0.2845050096511841, 1.0349164009094238, 3.407724618911743, 0.018712997436523438, 0.20724523067474365, 0.15851473808288574, 1.244734764099121, 0.5024614334106445, 2.3494009971618652, 1.8078968524932861, 1.9067134857177734, 0.4939497113227844, 0.6468454599380493, 1.2644035816192627, 0.6058525443077087, 1.0052279233932495, 0.19993817806243896, 0.9191606044769287, 0.8881649374961853, 0.8097698092460632, 0.0872352123260498, 0.3457772731781006, 0.15945971012115479, 0.8291647434234619, 1.3118650913238525, 2.6224327087402344, 0.13835108280181885, 1.178558588027954, 0.3423941731452942, 0.5423195362091064, 1.4160257577896118, 2.5605666637420654, 1.0471863746643066, 0.3269878029823303, 2.1694836616516113, 0.4208752512931824, 2.1118619441986084, 0.6268819570541382, 2.086961269378662, 1.0110046863555908, 0.7085762023925781, 0.4515293836593628, 0.18571925163269043, 0.07313358783721924, 0.5849944949150085, 0.2395387887954712, 0.8603050708770752, 0.23871934413909912, 2.4397506713867188, 0.23364490270614624, 1.0688557624816895, 0.6232773661613464, 0.42122334241867065, 0.36111336946487427, 0.7379323244094849, 0.5068680047988892, 1.7124584913253784, 2.3043317794799805, 0.3438717722892761, 1.6601388454437256, 0.6668174266815186, 0.06717479228973389, 0.4135185480117798, 1.643047571182251, 0.6718465685844421, 0.3304234743118286, 0.394248366355896, 1.878948450088501, 0.11106210947036743, 3.1269192695617676, 1.8609240055084229, 0.7083398103713989, 0.9872158169746399, 1.4950674772262573, 0.3252655267715454, 0.649493932723999, 0.256807804107666, 0.1194995641708374, 0.7847155928611755, 1.2283380031585693, 1.780548095703125, 3.6105573177337646, 0.4289531707763672, 0.21730995178222656, 0.35800206661224365], "mean_td_error": 0.9618359804153442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08736801147461, "actor_loss": -5.90830659866333, "critic_loss": 0.30563753843307495, "alpha_loss": -0.15136979520320892, "alpha_value": 0.9851061701774597, "log_alpha_value": -0.015005877241492271, "target_entropy": -6.0, "policy_t": 0.002969232155010104, "mean_q": 2.173949956893921, "max_q": 4.951610565185547, "min_q": 1.83401620388031}, "td_error": [1.9080312252044678, 0.9813702702522278, 2.5855553150177, 0.1184125542640686, 1.621326208114624, 0.4541451334953308, 1.8762726783752441, 1.600846767425537, 0.2772256135940552, 0.7001651525497437, 1.5191854238510132, 1.5220744609832764, 0.6396686434745789, 2.629523992538452, 0.7338906526565552, 1.8016619682312012, 1.8503470420837402, 1.0909243822097778, 0.872185230255127, 1.4545601606369019, 1.5606131553649902, 1.402800440788269, 1.1227540969848633, 0.11347943544387817, 1.4959228038787842, 2.672398805618286, 1.2195638418197632, 2.8216543197631836, 0.6422934532165527, 0.5574461817741394, 1.5379810333251953, 2.0006661415100098, 1.373704195022583, 1.2574896812438965, 1.6389001607894897, 3.3571481704711914, 0.502859890460968, 0.5054070353507996, 1.1303589344024658, 2.5754992961883545, 1.3234943151474, 0.2662738561630249, 1.079737901687622, 0.7659215331077576, 0.38517290353775024, 1.5096557140350342, 0.8832731246948242, 0.7907899022102356, 2.495044231414795, 1.4983290433883667, 0.408280611038208, 0.5891562104225159, 0.7945246696472168, 2.379197597503662, 2.900787353515625, 0.19326996803283691, 1.387885332107544, 0.11701798439025879, 0.42384445667266846, 1.5425221920013428, 2.205090284347534, 0.6719503998756409, 0.4937044382095337, 1.1273572444915771, 3.6492834091186523, 0.35478466749191284, 0.44093722105026245, 0.5259461402893066, 1.9566166400909424, 0.5287737250328064, 0.9315468668937683, 1.5000971555709839, 0.11469042301177979, 0.3842906951904297, 1.1842436790466309, 1.5804543495178223, 2.150635004043579, 0.3860313892364502, 1.6883323192596436, 2.43581485748291, 0.7134659290313721, 0.1157265305519104, 0.6471739411354065, 1.1889162063598633, 0.3205203413963318, 0.5883482098579407], "mean_td_error": 1.2249443531036377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 666.7782756505668, "num_env_steps_trained_throughput_per_sec": 191.99642312259624, "timesteps_total": 46592, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 139776, "timers": {"training_iteration_time_ms": 1122.712, "sample_time_ms": 818.497, "load_time_ms": 0.313, "load_throughput": 823476.472, "learn_time_ms": 18.169, "learn_throughput": 14199.771, "synch_weights_time_ms": 10.621}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 13158, "num_agent_steps_sampled": 139776, "num_agent_steps_trained": 13158, "last_target_update_ts": 46592, "num_target_updates": 51}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-32", "timestamp": 1700369852, "time_this_iter_s": 1.3539021015167236, "time_total_s": 55.499186515808105, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b89a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.499186515808105, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 58.95, "ram_util_percent": 66.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060800552368164, "actor_loss": -6.559090614318848, "critic_loss": 0.6008701920509338, "alpha_loss": -0.15405058860778809, "alpha_value": 0.9848046898841858, "log_alpha_value": -0.015311961993575096, "target_entropy": -6.0, "policy_t": -0.001065183081664145, "mean_q": 2.4679160118103027, "max_q": 6.631112098693848, "min_q": 2.3848304748535156}, "td_error": [0.46839797496795654, 2.509065628051758, 2.0813112258911133, 1.152506709098816, 1.741529941558838, 2.5841879844665527, 2.9803364276885986, 0.3150545358657837, 0.16858208179473877, 2.578679323196411, 1.237289547920227, 3.3023457527160645, 0.27786850929260254, 2.0843400955200195, 4.340217590332031, 1.8029769659042358, 0.985468864440918, 2.1167593002319336, 2.325897693634033, 0.6215915679931641, 2.7924461364746094, 2.2355639934539795, 3.251534938812256, 0.6441501379013062, 3.1268057823181152, 1.758589506149292, 3.229149103164673, 2.4851486682891846, 2.408153533935547, 4.706239700317383, 1.49733567237854, 1.0413349866867065, 1.472293734550476, 2.909175157546997, 2.102588653564453, 2.6325597763061523, 0.17269372940063477, 1.5579289197921753, 0.9849636554718018, 1.4502003192901611, 3.0488169193267822, 1.0338228940963745, 0.23102760314941406, 1.2790340185165405, 1.3687182664871216, 3.4311230182647705, 1.8753174543380737, 1.1938363313674927, 1.908839464187622, 1.0816965103149414, 1.0649852752685547, 1.771294355392456, 2.995570659637451, 1.4910448789596558, 3.0384631156921387, 3.3711698055267334, 0.2128770351409912, 2.8260133266448975, 1.2415724992752075, 2.1743364334106445, 2.2127137184143066, 1.8212897777557373, 2.047557830810547, 1.7238850593566895, 0.22635149955749512, 1.9138768911361694, 1.6878489255905151, 0.17230355739593506, 2.100231170654297, 3.6256418228149414, 1.494277000427246, 2.6238279342651367, 1.6341142654418945, 1.057282567024231, 0.5258841514587402, 3.500638008117676, 3.145874261856079, 2.194337844848633, 2.8793869018554688, 1.5207996368408203, 1.548468828201294, 1.8909484148025513, 0.6423612833023071, 1.6641943454742432, 3.139944553375244, 0.2708336114883423], "mean_td_error": 1.8841593265533447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123701095581055, "actor_loss": -6.235805034637451, "critic_loss": 0.15216714143753052, "alpha_loss": -0.154891699552536, "alpha_value": 0.9848165512084961, "log_alpha_value": -0.015299907885491848, "target_entropy": -6.0, "policy_t": -0.019505035132169724, "mean_q": 2.2395918369293213, "max_q": 5.403236389160156, "min_q": 1.8672600984573364}, "td_error": [1.3653186559677124, 0.7338058948516846, 0.9582235813140869, 0.957996129989624, 0.7551848888397217, 0.4576073884963989, 0.8099075555801392, 0.2722313404083252, 1.9067615270614624, 2.67958402633667, 1.8665765523910522, 1.662837266921997, 0.7414563894271851, 1.1968326568603516, 0.40062737464904785, 0.9125109910964966, 0.3264274597167969, 0.5746059417724609, 0.21646356582641602, 0.10698091983795166, 3.1041297912597656, 0.998653769493103, 0.031226038932800293, 0.6383637189865112, 0.32818901538848877, 1.8023192882537842, 2.5128064155578613, 1.8380781412124634, 1.6902427673339844, 1.3391549587249756, 0.9019604921340942, 0.9214372634887695, 0.08662748336791992, 2.260169506072998, 0.7209222316741943, 1.4708995819091797, 0.15069544315338135, 0.16921532154083252, 0.37315833568573, 0.7888109683990479, 0.09452056884765625, 0.8839513063430786, 1.726902723312378, 0.14988887310028076, 0.816692590713501, 1.6133534908294678, 0.20397663116455078, 1.0180329084396362, 1.6269086599349976, 0.5741506814956665, 0.7837048768997192, 0.8211791515350342, 1.9767606258392334, 0.1363743543624878, 1.7564373016357422, 1.6319464445114136, 1.5163108110427856, 1.0393428802490234, 0.540097713470459, 0.5460598468780518, 3.4948389530181885, 0.22013461589813232, 1.810782551765442, 0.21587979793548584, 0.7922598123550415, 0.4796769618988037, 1.1688473224639893, 1.0894500017166138, 0.45020055770874023, 0.16414308547973633, 1.0598896741867065, 1.063093662261963, 0.45381176471710205, 0.16872990131378174, 1.0358860492706299, 0.11856091022491455, 0.24291062355041504, 0.16748762130737305, 1.0495796203613281, 0.31980764865875244, 0.05435347557067871, 1.2908886671066284, 1.9142684936523438, 0.5925213098526001, 0.6303502321243286, 0.8736636638641357], "mean_td_error": 0.946600079536438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115396499633789, "actor_loss": -5.98750114440918, "critic_loss": 0.2839452028274536, "alpha_loss": -0.15482383966445923, "alpha_value": 0.9848107695579529, "log_alpha_value": -0.015305760316550732, "target_entropy": -6.0, "policy_t": 0.03900892287492752, "mean_q": 2.2555794715881348, "max_q": 5.213212966918945, "min_q": 1.8791940212249756}, "td_error": [0.8830472230911255, 1.6100449562072754, 1.4066033363342285, 0.11874091625213623, 0.9803496599197388, 2.3460330963134766, 0.12002444267272949, 2.2601490020751953, 0.443556010723114, 1.572965383529663, 2.712550401687622, 0.760841965675354, 1.0271798372268677, 1.1580111980438232, 1.4948103427886963, 0.44513994455337524, 0.5358564853668213, 1.7836899757385254, 2.574789047241211, 2.5699539184570312, 0.5136246681213379, 0.21170026063919067, 0.24569928646087646, 0.7770736217498779, 0.607384443283081, 0.7337472438812256, 2.2534947395324707, 0.7544450759887695, 1.058505892753601, 0.4853477478027344, 0.5201886892318726, 0.7571459412574768, 0.217274010181427, 5.07709264755249, 1.5283935070037842, 0.31272274255752563, 0.24210822582244873, 1.0391089916229248, 1.0274065732955933, 0.17721116542816162, 0.12815558910369873, 0.22962480783462524, 1.5190761089324951, 1.8086481094360352, 1.0802209377288818, 0.27448248863220215, 0.30032962560653687, 0.9074550271034241, 1.9160678386688232, 1.609015703201294, 1.0459530353546143, 5.149205684661865, 1.0232224464416504, 0.46801769733428955, 1.1733063459396362, 0.2267289161682129, 0.2136014699935913, 1.23978853225708, 0.1779850721359253, 1.313749074935913, 0.47318577766418457, 1.0930297374725342, 0.5401871204376221, 1.0171229839324951, 0.6014010906219482, 0.21097874641418457, 2.052216053009033, 2.747729778289795, 2.6571385860443115, 0.5037193298339844, 0.9087778329849243, 5.120429039001465, 0.19157028198242188, 0.3144511580467224, 0.4605218768119812, 0.3983325958251953, 1.893054485321045, 0.12012499570846558, 0.12020498514175415, 0.6624081134796143, 1.522291898727417, 0.7998242974281311, 0.9058743119239807, 1.5263359546661377, 1.9411925077438354, 0.6258534789085388], "mean_td_error": 1.122751235961914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 889.8270337105096, "num_env_steps_trained_throughput_per_sec": 256.2225164032494, "timesteps_total": 47488, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 142464, "timers": {"training_iteration_time_ms": 1103.555, "sample_time_ms": 799.405, "load_time_ms": 0.314, "load_throughput": 821102.081, "learn_time_ms": 18.099, "learn_throughput": 14254.989, "synch_weights_time_ms": 10.792}, "counters": {"num_env_steps_sampled": 47488, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 142464, "num_agent_steps_trained": 13416, "last_target_update_ts": 47488, "num_target_updates": 52}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-33", "timestamp": 1700369853, "time_this_iter_s": 1.0143990516662598, "time_total_s": 56.513585567474365, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177ba3e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.513585567474365, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 66.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.165497779846191, "actor_loss": -6.738210201263428, "critic_loss": 0.7420216798782349, "alpha_loss": -0.15870419144630432, "alpha_value": 0.9845091700553894, "log_alpha_value": -0.015612044371664524, "target_entropy": -6.0, "policy_t": 0.013736019842326641, "mean_q": 2.865438222885132, "max_q": 13.307504653930664, "min_q": 2.4801504611968994}, "td_error": [2.8554911613464355, 1.9868392944335938, 2.3264875411987305, 0.7372797727584839, 0.2489994764328003, 2.2728323936462402, 2.3873276710510254, 0.6822998523712158, 2.9788331985473633, 2.352196216583252, 1.7827333211898804, 2.393892765045166, 7.414827823638916, 4.387584686279297, 0.6505396366119385, 3.148085117340088, 0.5829650163650513, 2.3220958709716797, 4.008312225341797, 3.5004501342773438, 1.3888649940490723, 0.2859593629837036, 1.1415197849273682, 2.005728244781494, 2.0487849712371826, 3.5718836784362793, 1.0049101114273071, 1.0026278495788574, 2.2716174125671387, 0.1839073896408081, 2.113851308822632, 0.5255753993988037, 4.293097019195557, 3.9729809761047363, 1.0026432275772095, 3.209394693374634, 2.1448655128479004, 3.0635671615600586, 2.647136926651001, 1.6346389055252075, 3.647339105606079, 2.9846503734588623, 1.2465366125106812, 0.7493758201599121, 2.186272144317627, 2.5866270065307617, 3.0188910961151123, 3.927699327468872, 0.9011913537979126, 0.575432300567627, 0.8386857509613037, 2.7581193447113037, 0.21294331550598145, 2.9448862075805664, 1.5606634616851807, 3.187448263168335, 1.1250771284103394, 4.742886066436768, 3.048760175704956, 1.2559764385223389, 3.251558780670166, 1.758164405822754, 3.2546627521514893, 8.593968391418457, 1.6506879329681396, 1.227635145187378, 3.1002354621887207, 1.8535265922546387, 2.156463623046875, 2.4550061225891113, 1.3799670934677124, 0.37304913997650146, 1.2117035388946533, 1.4863957166671753, 1.5330922603607178, 3.2386255264282227, 3.0203380584716797, 1.778491497039795, 1.8438780307769775, 0.7804282903671265, 1.8793829679489136, 2.4089508056640625, 3.103513717651367, 2.721076011657715, 2.421856641769409, 1.6998777389526367], "mean_td_error": 2.235065460205078, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109681129455566, "actor_loss": -6.257687568664551, "critic_loss": 0.1681371033191681, "alpha_loss": -0.1577095240354538, "alpha_value": 0.984521210193634, "log_alpha_value": -0.015599853359162807, "target_entropy": -6.0, "policy_t": 0.007519742473959923, "mean_q": 2.2696399688720703, "max_q": 5.300981521606445, "min_q": 2.1177592277526855}, "td_error": [1.28867769241333, 2.7577080726623535, 1.5110048055648804, 1.5178996324539185, 0.7422487735748291, 1.2584060430526733, 2.8679890632629395, 0.1662611961364746, 0.6936724185943604, 1.349021553993225, 1.066243052482605, 2.5131077766418457, 1.1529706716537476, 0.30412817001342773, 0.2261413335800171, 1.123247504234314, 0.3042041063308716, 1.1074397563934326, 0.4008446931838989, 0.1737879514694214, 1.161137580871582, 2.307645559310913, 2.4653992652893066, 2.437173843383789, 0.3122076988220215, 1.3266637325286865, 0.16443252563476562, 0.9058555364608765, 2.4380991458892822, 1.3323179483413696, 1.7290418148040771, 0.988144040107727, 1.3556294441223145, 0.5524541139602661, 1.7973172664642334, 0.3065774440765381, 0.06439566612243652, 0.7313003540039062, 1.7304112911224365, 2.0154519081115723, 1.7758482694625854, 1.3034695386886597, 1.7738629579544067, 0.7328656911849976, 0.14805328845977783, 0.08783316612243652, 0.12302422523498535, 0.46470844745635986, 1.4629888534545898, 1.8636198043823242, 0.6312863826751709, 0.033477187156677246, 0.4492262601852417, 0.17996108531951904, 1.278783917427063, 1.0520765781402588, 0.24713456630706787, 0.6887983083724976, 0.863562822341919, 0.9588066339492798, 1.4617582559585571, 0.36239445209503174, 0.9777731895446777, 0.7109918594360352, 0.11978471279144287, 0.13869452476501465, 2.1190333366394043, 1.9213491678237915, 1.3758184909820557, 0.4051094055175781, 1.1850563287734985, 0.1522350311279297, 1.2339332103729248, 0.2587592601776123, 0.6753394603729248, 0.31915271282196045, 0.6017372608184814, 0.3185114860534668, 1.284713625907898, 0.5001907348632812, 0.44388365745544434, 0.49136805534362793, 3.601426362991333, 1.8893201351165771, 0.032897353172302246, 0.9327853918075562], "mean_td_error": 1.0265122652053833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057364463806152, "actor_loss": -6.046113967895508, "critic_loss": 0.21561723947525024, "alpha_loss": -0.15695226192474365, "alpha_value": 0.9845154285430908, "log_alpha_value": -0.015605704858899117, "target_entropy": -6.0, "policy_t": -0.05679938569664955, "mean_q": 2.2002711296081543, "max_q": 4.207568168640137, "min_q": 2.069761037826538}, "td_error": [0.9200339913368225, 0.23638486862182617, 0.9087718725204468, 1.0812394618988037, 0.8447309732437134, 0.8266774415969849, 0.2900608777999878, 0.6423528790473938, 1.126692533493042, 0.44859588146209717, 0.12435781955718994, 0.7328972816467285, 0.303890585899353, 0.48001623153686523, 0.6575194597244263, 2.794811964035034, 1.2998192310333252, 0.7438122034072876, 0.6021447777748108, 0.1310352087020874, 1.170890212059021, 0.8951475620269775, 0.1226460337638855, 0.9546383619308472, 1.1155457496643066, 0.2871306538581848, 1.9398781061172485, 1.951074242591858, 0.17769843339920044, 0.1220552921295166, 0.4007307291030884, 1.8109281063079834, 1.4232803583145142, 0.4261205196380615, 0.2270815372467041, 0.4596347212791443, 0.9336268901824951, 0.12438452243804932, 0.3978298306465149, 1.692155122756958, 1.0500571727752686, 0.6511138081550598, 1.8849321603775024, 0.8150326609611511, 1.2768614292144775, 4.14461612701416, 1.7800159454345703, 0.9194515347480774, 1.8047170639038086, 0.9016331434249878, 0.8091320991516113, 0.12994366884231567, 1.6374253034591675, 1.5566120147705078, 1.9323173761367798, 0.29611337184906006, 0.364396870136261, 0.497522234916687, 0.41965770721435547, 0.4434082508087158, 1.0678569078445435, 0.838271975517273, 0.6265470385551453, 0.21652346849441528, 0.12334692478179932, 0.5952550172805786, 2.2796547412872314, 1.4585530757904053, 2.0736336708068848, 0.6024109721183777, 0.8815016746520996, 0.12425130605697632, 0.40758514404296875, 3.834620237350464, 0.44457709789276123, 1.2426023483276367, 0.12678450345993042, 1.5075962543487549, 0.12518978118896484, 1.1834162473678589, 1.5468319654464722, 0.9128812551498413, 0.8374195694923401, 1.432408332824707, 0.5160112977027893, 1.9316675662994385], "mean_td_error": 0.9544265270233154, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 877.575390969892, "num_env_steps_trained_throughput_per_sec": 252.69469963195553, "timesteps_total": 48384, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 145152, "timers": {"training_iteration_time_ms": 1106.179, "sample_time_ms": 802.133, "load_time_ms": 0.308, "load_throughput": 837497.432, "learn_time_ms": 17.895, "learn_throughput": 14417.103, "synch_weights_time_ms": 10.508}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 13674, "num_agent_steps_sampled": 145152, "num_agent_steps_trained": 13674, "last_target_update_ts": 48384, "num_target_updates": 53}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-34", "timestamp": 1700369854, "time_this_iter_s": 1.0308520793914795, "time_total_s": 57.544437646865845, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177ba700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 57.544437646865845, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 68.75, "ram_util_percent": 66.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015384674072266, "actor_loss": -6.828135013580322, "critic_loss": 0.6461402177810669, "alpha_loss": -0.16237382590770721, "alpha_value": 0.9839182496070862, "log_alpha_value": -0.01621243916451931, "target_entropy": -6.0, "policy_t": -0.002263737376779318, "mean_q": 3.070690393447876, "max_q": 12.328376770019531, "min_q": 2.675095558166504}, "td_error": [1.12776780128479, 2.015212059020996, 2.2963995933532715, 2.21693754196167, 8.301206588745117, 2.7809810638427734, 1.0416505336761475, 0.8307945728302002, 1.879399061203003, 1.7132834196090698, 2.479801654815674, 0.970165491104126, 1.628227710723877, 4.11625862121582, 3.1202292442321777, 1.358675479888916, 1.809245228767395, 2.3769137859344482, 2.2490429878234863, 2.894700527191162, 2.5690150260925293, 1.2634239196777344, 1.6135032176971436, 2.0232293605804443, 0.6011765003204346, 1.3296006917953491, 3.5230252742767334, 0.8678516149520874, 0.9031050205230713, 2.465017795562744, 3.324557065963745, 1.4652124643325806, 0.7952086925506592, 3.5725746154785156, 3.595561981201172, 1.1335737705230713, 0.8135956525802612, 0.4064488410949707, 0.7697380781173706, 1.2494299411773682, 1.2411855459213257, 0.9474434852600098, 1.501384973526001, 3.1673731803894043, 1.4650992155075073, 5.251283168792725, 0.7539221048355103, 1.8202004432678223, 0.8519272804260254, 1.7221910953521729, 2.143587589263916, 1.3296862840652466, 1.6669204235076904, 1.4896948337554932, 1.4966630935668945, 0.27806365489959717, 1.0130473375320435, 2.908358573913574, 3.1287527084350586, 0.9049555063247681, 1.2190226316452026, 0.5471525192260742, 3.8535828590393066, 1.2781137228012085, 1.8515757322311401, 1.3185068368911743, 1.2975640296936035, 1.9063471555709839, 1.8961920738220215, 1.9436390399932861, 2.674741268157959, 1.6962096691131592, 2.3249337673187256, 3.9372239112854004, 2.456216335296631, 3.1984360218048096, 1.0020172595977783, 1.6083459854125977, 2.8958661556243896, 2.645956039428711, 1.5462377071380615, 1.340665578842163, 2.347226858139038, 2.7719781398773193, 1.356865406036377, 2.6928889751434326], "mean_td_error": 1.9788488149642944, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05512809753418, "actor_loss": -6.400033473968506, "critic_loss": 0.14178620278835297, "alpha_loss": -0.16288995742797852, "alpha_value": 0.9839308261871338, "log_alpha_value": -0.016199691221117973, "target_entropy": -6.0, "policy_t": -0.045344069600105286, "mean_q": 2.478843927383423, "max_q": 5.057669162750244, "min_q": 2.2553606033325195}, "td_error": [1.7841110229492188, 2.711134672164917, 0.9222762584686279, 1.1228830814361572, 0.9083831310272217, 0.7558295726776123, 0.29019594192504883, 1.2426352500915527, 2.001758098602295, 0.03082418441772461, 0.4174978733062744, 0.05933809280395508, 1.423478603363037, 0.6001449823379517, 0.46727967262268066, 0.03286755084991455, 0.7161967754364014, 0.10157263278961182, 0.3177911043167114, 1.6200101375579834, 1.265834927558899, 0.5527985095977783, 1.0561121702194214, 0.13919472694396973, 0.9793264865875244, 0.7936580181121826, 0.5163702964782715, 0.5374395847320557, 0.17195427417755127, 0.10088062286376953, 1.0014992952346802, 1.5614408254623413, 0.9366865158081055, 0.07274043560028076, 0.9803590774536133, 0.6215252876281738, 1.3063199520111084, 1.3841924667358398, 0.8550002574920654, 1.1177576780319214, 0.6609609127044678, 1.212762713432312, 0.5272624492645264, 0.27178382873535156, 0.7017151117324829, 0.7498700618743896, 0.08078324794769287, 0.19554555416107178, 0.19148516654968262, 0.6746623516082764, 1.6208560466766357, 1.319669485092163, 0.22341585159301758, 0.4042971134185791, 2.293962001800537, 2.128661632537842, 0.7129718065261841, 2.564098358154297, 1.3487951755523682, 0.8989039659500122, 2.0767440795898438, 0.8562908172607422, 1.051442265510559, 0.47352099418640137, 0.11135649681091309, 1.6825203895568848, 1.140633463859558, 2.696218967437744, 0.6002000570297241, 2.286156177520752, 0.013016462326049805, 1.2760578393936157, 0.9001510143280029, 2.427966594696045, 1.019403338432312, 1.7217694520950317, 0.7209758758544922, 0.7450368404388428, 0.42680656909942627, 0.5783376693725586, 0.9020174741744995, 0.036101698875427246, 0.8774839639663696, 0.15752017498016357, 0.888363242149353, 0.4915872812271118], "mean_td_error": 0.9118306636810303, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049054145812988, "actor_loss": -6.1763410568237305, "critic_loss": 0.24675026535987854, "alpha_loss": -0.16284948587417603, "alpha_value": 0.9839251637458801, "log_alpha_value": -0.016205452382564545, "target_entropy": -6.0, "policy_t": -0.009509521536529064, "mean_q": 2.412060499191284, "max_q": 4.563713073730469, "min_q": 2.2940988540649414}, "td_error": [1.0125744342803955, 0.3904920816421509, 0.708405613899231, 1.306040644645691, 1.110824465751648, 0.4211796522140503, 1.6549324989318848, 1.7057002782821655, 0.5384448766708374, 1.0191864967346191, 0.9404054880142212, 1.065046787261963, 0.13270366191864014, 1.253116488456726, 0.4465768337249756, 1.2560298442840576, 0.535240650177002, 0.7664576768875122, 0.7592290639877319, 0.13368606567382812, 1.173297643661499, 0.2890399694442749, 0.7833175659179688, 0.7131940126419067, 0.9910553693771362, 1.8677982091903687, 2.5585432052612305, 1.055427074432373, 0.2367703914642334, 0.5392041206359863, 0.17086541652679443, 1.0309817790985107, 1.8211777210235596, 1.2349263429641724, 0.5526320934295654, 0.3507589101791382, 1.127422571182251, 0.594524621963501, 0.13051092624664307, 3.3937301635742188, 0.4165452718734741, 0.4675729274749756, 0.13448405265808105, 0.8519089221954346, 1.2114183902740479, 1.450915813446045, 1.1374601125717163, 1.3562490940093994, 3.911472797393799, 1.572648048400879, 1.065891146659851, 2.5059974193573, 2.018606662750244, 0.12802588939666748, 0.13176727294921875, 1.5720335245132446, 1.9737968444824219, 1.2482457160949707, 0.8152573108673096, 1.3374940156936646, 0.6032838821411133, 2.519843578338623, 1.1395645141601562, 0.8581886291503906, 2.288282871246338, 0.18807542324066162, 0.2633262872695923, 1.2102259397506714, 0.926750898361206, 0.38439130783081055, 1.672911286354065, 4.306640625, 0.5692627429962158, 0.7175711393356323, 0.1904062032699585, 0.13044321537017822, 0.12837493419647217, 0.12847256660461426, 0.9744486808776855, 0.7500896453857422, 0.66739821434021, 0.7065324783325195, 0.9787957668304443, 0.922244668006897, 2.2797117233276367, 0.5295305252075195], "mean_td_error": 1.0362094640731812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 893.3080237469317, "num_env_steps_trained_throughput_per_sec": 257.2248550521299, "timesteps_total": 50176, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 1084.727, "sample_time_ms": 783.326, "load_time_ms": 0.308, "load_throughput": 838081.19, "learn_time_ms": 17.809, "learn_throughput": 14487.301, "synch_weights_time_ms": 10.343}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 14190, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 14190, "last_target_update_ts": 50176, "num_target_updates": 55}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-36", "timestamp": 1700369856, "time_this_iter_s": 2.0155351161956787, "time_total_s": 59.55997276306152, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317553b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.55997276306152, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 70.26666666666667, "ram_util_percent": 66.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.169157028198242, "actor_loss": -7.1963090896606445, "critic_loss": 0.5876619815826416, "alpha_loss": -0.17096595466136932, "alpha_value": 0.9833283424377441, "log_alpha_value": -0.01681220531463623, "target_entropy": -6.0, "policy_t": 0.011271269991993904, "mean_q": 3.3307530879974365, "max_q": 11.286027908325195, "min_q": 2.8782196044921875}, "td_error": [1.0776643753051758, 2.440716028213501, 1.3628764152526855, 0.9429514408111572, 1.5563256740570068, 1.8312679529190063, 4.377612113952637, 2.6653904914855957, 2.54667329788208, 1.5836421251296997, 0.726900577545166, 2.168353796005249, 0.3917437791824341, 0.407320499420166, 5.382302761077881, 1.9778836965560913, 1.4481096267700195, 1.1274303197860718, 1.68362295627594, 2.931058883666992, 1.3723702430725098, 1.921955943107605, 2.0863800048828125, 2.0607504844665527, 2.8948211669921875, 0.45348262786865234, 2.8999078273773193, 1.533321499824524, 1.184086799621582, 1.2081185579299927, 0.6158545017242432, 2.206608772277832, 0.8406809568405151, 1.5366101264953613, 0.7957104444503784, 2.668459177017212, 4.08631706237793, 1.1570438146591187, 1.2602150440216064, 3.6918704509735107, 1.6167670488357544, 1.9812488555908203, 3.0864267349243164, 1.3601596355438232, 1.8514372110366821, 0.5861881971359253, 0.9435349702835083, 1.2279019355773926, 3.0406856536865234, 0.5662604570388794, 0.7214972972869873, 1.8278623819351196, 2.449110507965088, 3.149019718170166, 1.4239261150360107, 2.20979905128479, 0.8529213666915894, 1.943288803100586, 1.7853429317474365, 1.69003164768219, 0.7962617874145508, 1.5499788522720337, 1.2315791845321655, 3.112013578414917, 2.23431134223938, 0.642072319984436, 2.89109206199646, 0.7875008583068848, 0.6826039552688599, 5.2267327308654785, 0.21608054637908936, 0.20426154136657715, 2.228151798248291, 1.6165375709533691, 2.1245391368865967, 5.433773994445801, 2.007075309753418, 2.2061712741851807, 0.7727727890014648, 1.5205357074737549, 1.6269031763076782, 3.274284839630127, 1.663018822669983, 1.449555516242981, 3.6568310260772705, 3.2245030403137207], "mean_td_error": 1.8813600540161133, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113265037536621, "actor_loss": -6.525712966918945, "critic_loss": 0.12177078425884247, "alpha_loss": -0.1698959320783615, "alpha_value": 0.9833409786224365, "log_alpha_value": -0.016799315810203552, "target_entropy": -6.0, "policy_t": -0.0057184938341379166, "mean_q": 2.458406925201416, "max_q": 4.705626487731934, "min_q": 2.0411150455474854}, "td_error": [0.8785690069198608, 1.2165054082870483, 0.3950197696685791, 0.03523898124694824, 1.1975330114364624, 0.3740963935852051, 0.15266048908233643, 0.5184826850891113, 1.671950101852417, 0.15395092964172363, 0.6551247835159302, 0.32287025451660156, 1.1469817161560059, 0.5103411674499512, 3.203028917312622, 0.343633770942688, 1.2828961610794067, 1.8800239562988281, 1.0593582391738892, 0.5995144844055176, 0.35233378410339355, 0.8251105546951294, 0.4836540222167969, 0.279413104057312, 0.6719115972518921, 1.19882071018219, 1.3501927852630615, 0.05268895626068115, 1.350882649421692, 2.568338394165039, 0.40040159225463867, 0.5388026237487793, 0.9794076681137085, 0.37549543380737305, 0.18393051624298096, 1.3978315591812134, 0.6678458452224731, 0.21589624881744385, 0.31004512310028076, 0.1036384105682373, 0.3562049865722656, 1.104580044746399, 0.4150747060775757, 0.887086033821106, 0.6561185121536255, 1.1412166357040405, 0.41868042945861816, 0.6858927011489868, 2.975851058959961, 0.9541531801223755, 0.29886186122894287, 1.8846789598464966, 0.29459619522094727, 0.1277320384979248, 0.28019869327545166, 2.1774191856384277, 0.6548558473587036, 0.7192797660827637, 0.1620175838470459, 0.9106656312942505, 1.7162683010101318, 0.06944513320922852, 0.4792771339416504, 1.0100743770599365, 1.0292489528656006, 1.1840354204177856, 0.07445335388183594, 1.9060133695602417, 0.015915393829345703, 0.5170990228652954, 0.7347506284713745, 0.6281354427337646, 1.3096452951431274, 0.7332139015197754, 0.5506184101104736, 0.2717628479003906, 0.20645952224731445, 0.2872328758239746, 1.4208388328552246, 1.250899314880371, 0.9670487642288208, 0.7998995780944824, 2.446044683456421, 1.023057460784912, 0.24121570587158203, 0.8570469617843628], "mean_td_error": 0.8225498795509338, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150562286376953, "actor_loss": -6.398353576660156, "critic_loss": 0.1677696704864502, "alpha_loss": -0.17058132588863373, "alpha_value": 0.9833353161811829, "log_alpha_value": -0.01680511236190796, "target_entropy": -6.0, "policy_t": 0.025141971185803413, "mean_q": 2.4604780673980713, "max_q": 2.657134771347046, "min_q": 2.0764431953430176}, "td_error": [0.6023739576339722, 1.3496041297912598, 0.7528226375579834, 0.2702125310897827, 0.1355905532836914, 0.14129900932312012, 0.22428953647613525, 1.2305636405944824, 0.3931065797805786, 0.27271711826324463, 0.15020442008972168, 1.6073939800262451, 1.349972128868103, 1.6662474870681763, 0.13677000999450684, 0.22963404655456543, 0.8972899913787842, 0.8270330429077148, 2.0375547409057617, 1.3128986358642578, 0.2506577968597412, 0.8508255481719971, 1.8412671089172363, 0.678725004196167, 1.7301105260849, 1.5959464311599731, 0.13778412342071533, 0.33459043502807617, 0.9251344203948975, 0.8627192974090576, 0.6838047504425049, 0.25645244121551514, 0.29354047775268555, 1.9522539377212524, 0.8845416307449341, 1.4501159191131592, 0.9874330759048462, 0.41714978218078613, 0.7814873456954956, 0.5516865253448486, 1.221896767616272, 0.9789998531341553, 1.1752313375473022, 0.19831359386444092, 1.3086519241333008, 0.573369026184082, 0.13266503810882568, 1.0619826316833496, 0.13407933712005615, 1.0373263359069824, 0.14781975746154785, 0.17310309410095215, 1.080063819885254, 0.1354081630706787, 0.8045464754104614, 0.23840320110321045, 1.7212414741516113, 0.448000431060791, 0.3790782690048218, 1.2048972845077515, 0.4904900789260864, 0.3993943929672241, 1.1550655364990234, 0.3037431240081787, 0.9673352241516113, 0.5469388961791992, 1.3035759925842285, 0.1454181671142578, 1.5248349905014038, 1.4190276861190796, 0.8919899463653564, 1.3532629013061523, 0.15251219272613525, 0.6044348478317261, 0.1416773796081543, 0.23633670806884766, 3.2900094985961914, 1.4764654636383057, 0.4812246561050415, 0.5700392723083496, 0.29714882373809814, 0.4526069164276123, 0.14787209033966064, 0.7638440132141113, 1.2719781398773193, 1.1667084693908691], "mean_td_error": 0.7995676398277283, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 910.3548473638357, "num_env_steps_trained_throughput_per_sec": 262.1334270311045, "timesteps_total": 51968, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 155904, "timers": {"training_iteration_time_ms": 1053.149, "sample_time_ms": 755.203, "load_time_ms": 0.307, "load_throughput": 839186.066, "learn_time_ms": 17.846, "learn_throughput": 14457.147, "synch_weights_time_ms": 9.975}, "counters": {"num_env_steps_sampled": 51968, "num_env_steps_trained": 14706, "num_agent_steps_sampled": 155904, "num_agent_steps_trained": 14706, "last_target_update_ts": 51968, "num_target_updates": 57}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-38", "timestamp": 1700369858, "time_this_iter_s": 1.9763269424438477, "time_total_s": 61.53629970550537, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177bac00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.53629970550537, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 75.4, "ram_util_percent": 66.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08128547668457, "actor_loss": -7.303299903869629, "critic_loss": 0.6065939664840698, "alpha_loss": -0.17553973197937012, "alpha_value": 0.9827382564544678, "log_alpha_value": -0.01741243526339531, "target_entropy": -6.0, "policy_t": 0.02581273950636387, "mean_q": 3.558177947998047, "max_q": 13.537443161010742, "min_q": 3.0873284339904785}, "td_error": [2.457223892211914, 3.4229631423950195, 0.22179150581359863, 1.5512690544128418, 2.342670440673828, 1.6050220727920532, 2.0830302238464355, 1.661328673362732, 2.1629276275634766, 1.3459945917129517, 0.339603066444397, 0.5419472455978394, 1.0464040040969849, 1.2848155498504639, 2.1199076175689697, 1.7512012720108032, 0.9833495616912842, 2.420872688293457, 4.922902584075928, 0.33432650566101074, 1.5776374340057373, 0.8305997848510742, 0.9146410226821899, 0.22960948944091797, 0.22192120552062988, 2.5071916580200195, 2.935361385345459, 1.9896801710128784, 8.454952239990234, 1.8821251392364502, 0.8978952169418335, 1.8284794092178345, 0.2203536033630371, 0.48961663246154785, 1.5498347282409668, 1.884190559387207, 0.5197224617004395, 0.7349790334701538, 1.3742585182189941, 2.901393413543701, 0.2202244997024536, 1.317467212677002, 1.7395570278167725, 2.6879520416259766, 1.759766936302185, 4.702313423156738, 0.2387610673904419, 1.6678262948989868, 2.932429313659668, 0.47363805770874023, 1.2370526790618896, 2.8745241165161133, 1.9003052711486816, 9.075054168701172, 1.833864450454712, 2.2611374855041504, 1.3726551532745361, 2.3488383293151855, 0.4422495365142822, 2.750061511993408, 0.21890997886657715, 1.9747682809829712, 1.8113327026367188, 0.2384876012802124, 1.7173786163330078, 3.4707934856414795, 2.6331658363342285, 1.9707536697387695, 2.2518091201782227, 0.2967042922973633, 0.22600483894348145, 0.6592274904251099, 3.115213394165039, 1.1915199756622314, 0.9810483455657959, 2.260768175125122, 2.6580159664154053, 0.8885049819946289, 0.5283911228179932, 0.993870735168457, 0.7521321773529053, 3.326159715652466, 2.3007922172546387, 5.002490520477295, 3.1182732582092285, 2.43489933013916], "mean_td_error": 1.8535012006759644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034602165222168, "actor_loss": -6.615930557250977, "critic_loss": 0.12235086411237717, "alpha_loss": -0.17459194362163544, "alpha_value": 0.9827514886856079, "log_alpha_value": -0.01739898882806301, "target_entropy": -6.0, "policy_t": -0.049470629543066025, "mean_q": 2.5858914852142334, "max_q": 4.335444450378418, "min_q": 2.490447521209717}, "td_error": [0.6230940818786621, 0.33054935932159424, 0.2126176357269287, 0.8775659799575806, 0.43257462978363037, 1.2614893913269043, 1.264289379119873, 1.0332127809524536, 0.5444339513778687, 0.5804765224456787, 0.6837347745895386, 0.28823912143707275, 1.036660075187683, 2.0508954524993896, 0.4133579730987549, 0.1543651819229126, 1.5601154565811157, 1.0565013885498047, 0.9297510385513306, 0.2842984199523926, 0.14688360691070557, 0.276985764503479, 0.9992830753326416, 0.6182712316513062, 1.839827537536621, 1.6039912700653076, 1.9702702760696411, 0.2979041337966919, 0.1629657745361328, 1.9443559646606445, 0.2786771059036255, 0.4385378360748291, 0.0655817985534668, 0.2039254903793335, 0.6019213199615479, 0.969228982925415, 2.7407612800598145, 0.2187502384185791, 0.37267398834228516, 0.7999715805053711, 0.8376771211624146, 1.0440418720245361, 0.8900032043457031, 0.11913025379180908, 0.5836360454559326, 0.293956995010376, 0.9568018913269043, 0.36215436458587646, 0.22748851776123047, 1.3353760242462158, 1.1776204109191895, 0.8111875057220459, 0.9823013544082642, 2.6120786666870117, 1.6730916500091553, 0.17113268375396729, 0.4954707622528076, 1.1416165828704834, 0.5809934139251709, 0.17509424686431885, 0.3994041681289673, 0.9605584144592285, 1.5074193477630615, 0.9524166584014893, 1.4007625579833984, 0.47829747200012207, 1.5909900665283203, 1.1486940383911133, 2.5960986614227295, 1.2987308502197266, 0.745055079460144, 1.003951072692871, 0.7378982305526733, 0.7691174745559692, 0.2909107208251953, 0.5981860160827637, 1.1004372835159302, 0.6960623264312744, 0.21633625030517578, 0.11581766605377197, 1.0062822103500366, 1.6880418062210083, 1.4681527614593506, 0.7350355386734009, 0.018344879150390625, 0.789159893989563], "mean_td_error": 0.8482791781425476, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08564281463623, "actor_loss": -6.496529579162598, "critic_loss": 0.17406301200389862, "alpha_loss": -0.1755431890487671, "alpha_value": 0.982745349407196, "log_alpha_value": -0.017405254766345024, "target_entropy": -6.0, "policy_t": 0.027351055294275284, "mean_q": 2.6028034687042236, "max_q": 3.2058610916137695, "min_q": 2.2104897499084473}, "td_error": [0.6450042724609375, 1.4116671085357666, 0.1824268102645874, 2.9417495727539062, 0.4664461612701416, 0.47663259506225586, 0.4432058334350586, 0.8405803442001343, 0.6996519565582275, 0.8835098743438721, 1.6309711933135986, 0.15748095512390137, 1.5225437879562378, 0.46622753143310547, 0.14520859718322754, 0.401619553565979, 0.9933229684829712, 0.9209182262420654, 1.2195823192596436, 0.19724130630493164, 0.36019647121429443, 2.0379152297973633, 0.47229456901550293, 0.29229795932769775, 0.39176666736602783, 1.979688286781311, 0.5254981517791748, 0.1777646541595459, 0.316459059715271, 0.9761132001876831, 1.1287927627563477, 3.293628215789795, 0.13592183589935303, 0.8746490478515625, 0.2313929796218872, 0.13616108894348145, 0.4052591323852539, 0.2173323631286621, 1.231772541999817, 1.9687011241912842, 0.5805636644363403, 0.8303864002227783, 0.7843949794769287, 0.14019477367401123, 1.608856439590454, 1.2477202415466309, 0.9868912696838379, 0.13123655319213867, 0.13747406005859375, 0.13525009155273438, 0.12839889526367188, 1.059997320175171, 0.5648155212402344, 1.2480109930038452, 0.1500767469406128, 1.2941231727600098, 0.4573793411254883, 2.0385847091674805, 1.430310606956482, 0.42657721042633057, 0.9941831827163696, 0.1299450397491455, 0.6797952651977539, 0.7032307386398315, 0.12836766242980957, 0.5302045345306396, 0.13132810592651367, 0.4831322431564331, 0.15103530883789062, 0.5716608762741089, 0.525091290473938, 0.25114762783050537, 0.3062373399734497, 1.1884533166885376, 1.2355153560638428, 0.7824133634567261, 1.76410710811615, 1.2424895763397217, 0.3904682397842407, 2.2218542098999023, 0.6050357818603516, 0.6927454471588135, 0.806734561920166, 2.351627826690674, 2.191321611404419, 0.324507474899292], "mean_td_error": 0.8205055594444275, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 953.723125898375, "num_env_steps_trained_throughput_per_sec": 274.62116794841603, "timesteps_total": 53760, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 161280, "timers": {"training_iteration_time_ms": 1026.577, "sample_time_ms": 728.616, "load_time_ms": 0.309, "load_throughput": 834269.086, "learn_time_ms": 17.954, "learn_throughput": 14369.682, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 15222, "num_agent_steps_sampled": 161280, "num_agent_steps_trained": 15222, "last_target_update_ts": 53760, "num_target_updates": 59}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-40", "timestamp": 1700369860, "time_this_iter_s": 1.8872401714324951, "time_total_s": 63.423539876937866, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 63.423539876937866, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 69.36666666666667, "ram_util_percent": 65.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113283157348633, "actor_loss": -7.542290210723877, "critic_loss": 0.39886680245399475, "alpha_loss": -0.18216638267040253, "alpha_value": 0.9821486473083496, "log_alpha_value": -0.01801258698105812, "target_entropy": -6.0, "policy_t": -0.003042838303372264, "mean_q": 3.519090414047241, "max_q": 11.240407943725586, "min_q": 3.3005714416503906}, "td_error": [1.1047018766403198, 0.922676682472229, 2.6221017837524414, 2.091531276702881, 1.6287833452224731, 1.7553164958953857, 1.3963266611099243, 0.6203433275222778, 1.1440420150756836, 0.5951446294784546, 1.8927850723266602, 2.1130459308624268, 3.0617058277130127, 1.2054734230041504, 0.7231539487838745, 0.46960723400115967, 0.7618826627731323, 0.46073222160339355, 2.0872550010681152, 0.4023618698120117, 0.9988231658935547, 0.4783400297164917, 1.2905869483947754, 1.8944897651672363, 1.0434242486953735, 0.23040485382080078, 0.6003240346908569, 2.0140371322631836, 0.37532782554626465, 0.24732720851898193, 0.5000331401824951, 0.4119303226470947, 2.8456332683563232, 1.5111621618270874, 1.7640007734298706, 1.3887046575546265, 0.5760281085968018, 1.3320302963256836, 0.35385310649871826, 2.2597837448120117, 1.8552532196044922, 2.6409049034118652, 0.4362293481826782, 1.4623841047286987, 1.018127202987671, 1.0448863506317139, 2.537165641784668, 0.7857437133789062, 1.418707251548767, 1.364968180656433, 6.91346549987793, 4.072062969207764, 0.27251243591308594, 2.2215182781219482, 0.992838978767395, 0.9434473514556885, 2.240023136138916, 0.24210131168365479, 3.5244719982147217, 0.9193103313446045, 0.22970426082611084, 0.9696240425109863, 0.2321796417236328, 0.8027297258377075, 1.9330744743347168, 1.7622816562652588, 2.1864938735961914, 0.2703181505203247, 0.9570188522338867, 1.0670642852783203, 0.8690018653869629, 2.621241807937622, 1.231172800064087, 1.594059705734253, 3.4399333000183105, 0.9179155826568604, 0.5179318189620972, 2.8914217948913574, 0.5038518905639648, 2.4160170555114746, 0.61635422706604, 1.0086740255355835, 1.154957890510559, 0.7361305952072144, 0.2498873472213745, 1.912529706954956], "mean_td_error": 1.38573157787323, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076505661010742, "actor_loss": -6.722146511077881, "critic_loss": 0.13488507270812988, "alpha_loss": -0.18136006593704224, "alpha_value": 0.9821627140045166, "log_alpha_value": -0.017998309805989265, "target_entropy": -6.0, "policy_t": -0.03514425456523895, "mean_q": 2.6066739559173584, "max_q": 2.67856764793396, "min_q": 2.1474268436431885}, "td_error": [1.562572717666626, 1.1637964248657227, 1.3449896574020386, 0.13126957416534424, 0.22726774215698242, 0.6668459177017212, 2.4522743225097656, 0.17170274257659912, 0.38436758518218994, 0.9708818197250366, 0.3593573570251465, 0.831895112991333, 0.018490195274353027, 0.06888270378112793, 0.350862979888916, 0.0735635757446289, 1.5081322193145752, 0.13339722156524658, 0.7955207824707031, 1.3201111555099487, 0.019858598709106445, 0.42762327194213867, 1.5463608503341675, 1.0351512432098389, 2.3048973083496094, 0.2740488052368164, 0.4695730209350586, 0.9439687728881836, 1.8138935565948486, 0.49905073642730713, 0.5939779281616211, 0.3526127338409424, 1.8467609882354736, 1.0545834302902222, 0.8146417140960693, 1.0852038860321045, 1.5637338161468506, 1.015295386314392, 0.7001618146896362, 0.6918994188308716, 0.4861171245574951, 1.1958591938018799, 0.29662108421325684, 1.7361093759536743, 0.8529963493347168, 2.0940065383911133, 0.9617571830749512, 2.378495216369629, 0.9581362009048462, 0.23805606365203857, 0.5853608846664429, 0.20830190181732178, 0.506769061088562, 0.2721829414367676, 1.298465609550476, 0.9903557300567627, 0.2493988275527954, 1.8261281251907349, 0.6103496551513672, 0.2838350534439087, 1.6796977519989014, 0.36724376678466797, 1.0090913772583008, 0.08625972270965576, 0.5724804401397705, 0.2193751335144043, 0.3767634630203247, 2.520899772644043, 1.0928336381912231, 0.6874672174453735, 0.7324392795562744, 0.07983899116516113, 0.4808851480484009, 1.5312446355819702, 0.12361621856689453, 0.9640090465545654, 1.9444165229797363, 1.1646323204040527, 1.1317108869552612, 1.195454716682434, 1.5453225374221802, 1.4891942739486694, 1.8502485752105713, 0.5956605672836304, 0.23459362983703613, 0.8313729763031006], "mean_td_error": 0.885180652141571, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064301490783691, "actor_loss": -6.648385047912598, "critic_loss": 0.18530574440956116, "alpha_loss": -0.1812124103307724, "alpha_value": 0.9821556806564331, "log_alpha_value": -0.018005460500717163, "target_entropy": -6.0, "policy_t": -0.04254405200481415, "mean_q": 2.720625400543213, "max_q": 3.2328195571899414, "min_q": 2.0710926055908203}, "td_error": [0.2895549535751343, 0.5473568439483643, 1.1883151531219482, 1.4178698062896729, 2.273592948913574, 0.5794795751571655, 0.12305605411529541, 0.9741787910461426, 0.9813022613525391, 0.12715232372283936, 0.37895655632019043, 1.7480653524398804, 1.243671178817749, 1.243816614151001, 2.402631998062134, 0.6412792205810547, 1.7955284118652344, 1.6286849975585938, 1.407824993133545, 0.7224876880645752, 1.2008800506591797, 0.7573517560958862, 0.12549245357513428, 0.20128655433654785, 0.23164713382720947, 0.12312984466552734, 0.13133597373962402, 0.47466540336608887, 1.565621256828308, 0.3723660707473755, 0.46348607540130615, 0.2806349992752075, 0.37662696838378906, 0.6881228685379028, 1.1762700080871582, 0.5440562963485718, 1.0235651731491089, 0.8126451969146729, 0.4321542978286743, 2.004027843475342, 1.2375587224960327, 0.48085927963256836, 0.6579561233520508, 2.1283252239227295, 0.2740703821182251, 2.002073287963867, 1.0945210456848145, 0.3960237503051758, 0.8582282066345215, 1.9397640228271484, 0.13135087490081787, 1.2180848121643066, 2.4903006553649902, 0.12081360816955566, 0.12659144401550293, 0.3588590621948242, 0.12241411209106445, 1.46987783908844, 0.1210334300994873, 0.9765641689300537, 0.1967383623123169, 0.13019216060638428, 0.596045970916748, 1.000011920928955, 1.0505430698394775, 0.4477118253707886, 0.4076104164123535, 0.1316211223602295, 2.41866135597229, 0.7332478761672974, 0.677606463432312, 2.4084043502807617, 1.3189077377319336, 0.6180384159088135, 0.11971020698547363, 0.7017679214477539, 0.4938669204711914, 1.7048527002334595, 1.027339220046997, 0.722477912902832, 0.21047675609588623, 1.0873032808303833, 0.11949443817138672, 1.4415602684020996, 0.25895166397094727, 0.9030632972717285], "mean_td_error": 0.8585074543952942, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 955.2844990763235, "num_env_steps_trained_throughput_per_sec": 275.0707597786735, "timesteps_total": 55552, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 166656, "timers": {"training_iteration_time_ms": 975.709, "sample_time_ms": 703.325, "load_time_ms": 0.312, "load_throughput": 826116.827, "learn_time_ms": 18.0, "learn_throughput": 14333.67, "synch_weights_time_ms": 9.728}, "counters": {"num_env_steps_sampled": 55552, "num_env_steps_trained": 15738, "num_agent_steps_sampled": 166656, "num_agent_steps_trained": 15738, "last_target_update_ts": 55552, "num_target_updates": 61}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-41", "timestamp": 1700369861, "time_this_iter_s": 1.8850231170654297, "time_total_s": 65.3085629940033, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 65.3085629940033, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054121017456055, "actor_loss": -7.707103729248047, "critic_loss": 0.40889909863471985, "alpha_loss": -0.18713369965553284, "alpha_value": 0.9815595149993896, "log_alpha_value": -0.018612639978528023, "target_entropy": -6.0, "policy_t": 0.008556696586310863, "mean_q": 3.9197542667388916, "max_q": 13.36446475982666, "min_q": 3.5212998390197754}, "td_error": [0.8924853801727295, 0.2354642152786255, 0.6962015628814697, 1.0765135288238525, 0.23238921165466309, 1.467815637588501, 2.039933681488037, 3.3341000080108643, 7.801876544952393, 1.0629382133483887, 1.0684833526611328, 0.23539435863494873, 0.4629415273666382, 0.979607343673706, 0.844733715057373, 0.24718308448791504, 2.085099220275879, 3.747807502746582, 1.4811227321624756, 0.23227429389953613, 1.3301711082458496, 0.24034357070922852, 0.9477102756500244, 0.6164257526397705, 0.44716155529022217, 0.4666163921356201, 0.4887509346008301, 1.2553277015686035, 2.6015899181365967, 2.3335976600646973, 1.070651650428772, 0.4248363971710205, 0.2428605556488037, 1.0910879373550415, 0.35962867736816406, 2.688063859939575, 1.0320676565170288, 0.7189520597457886, 0.2567542791366577, 1.7766021490097046, 0.3897751569747925, 0.878219485282898, 1.13468599319458, 1.5282831192016602, 1.7746522426605225, 0.6526287794113159, 0.24272072315216064, 0.9853856563568115, 0.28000879287719727, 1.9837700128555298, 1.7814478874206543, 5.644157409667969, 0.8032428026199341, 0.28321290016174316, 0.2945091724395752, 0.23910903930664062, 1.344377040863037, 1.0216273069381714, 0.7882564067840576, 4.531787872314453, 1.6668946743011475, 1.316268801689148, 0.5579947233200073, 2.684541940689087, 2.6544365882873535, 0.9460321664810181, 1.1305903196334839, 1.4956495761871338, 0.6535302400588989, 0.47620415687561035, 1.3217118978500366, 0.35787177085876465, 0.7962696552276611, 0.41621947288513184, 0.6401830911636353, 1.464896559715271, 8.481720924377441, 1.4668066501617432, 2.587665557861328, 1.3480234146118164, 0.5443685054779053, 1.5374466180801392, 0.3091847896575928, 2.3796348571777344, 1.678139090538025, 0.9828038215637207], "mean_td_error": 1.3615175485610962, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.038793563842773, "actor_loss": -6.861939907073975, "critic_loss": 0.1295948326587677, "alpha_loss": -0.18669795989990234, "alpha_value": 0.9815742373466492, "log_alpha_value": -0.018597649410367012, "target_entropy": -6.0, "policy_t": -0.06406065076589584, "mean_q": 2.693345785140991, "max_q": 3.7181196212768555, "min_q": 2.143575668334961}, "td_error": [0.17855072021484375, 0.11950182914733887, 0.42473113536834717, 0.40369713306427, 0.16751599311828613, 0.6639714241027832, 1.5536123514175415, 1.1452678442001343, 1.1848602294921875, 1.2830531597137451, 1.133222222328186, 0.05456233024597168, 0.17839109897613525, 1.948474645614624, 1.8571958541870117, 1.3147313594818115, 0.8180992603302002, 2.3071043491363525, 1.2694017887115479, 0.17509615421295166, 0.7210003137588501, 0.8606269359588623, 0.9446735382080078, 1.1054472923278809, 1.392773151397705, 2.297614097595215, 0.41593050956726074, 0.37557554244995117, 1.1110411882400513, 1.19782555103302, 1.7622640132904053, 1.1091455221176147, 0.24934184551239014, 0.4097553491592407, 0.824937105178833, 1.2927266359329224, 0.3746767044067383, 0.6771949529647827, 2.9467926025390625, 1.7923524379730225, 0.7107818126678467, 0.23618030548095703, 1.2764967679977417, 0.02574622631072998, 0.9704549312591553, 0.3777649402618408, 0.17718374729156494, 0.29064464569091797, 0.1595306396484375, 1.502265214920044, 1.3236762285232544, 0.856662392616272, 0.393218994140625, 0.47885453701019287, 0.2440270185470581, 0.08307540416717529, 1.1482858657836914, 1.0161713361740112, 0.7074266672134399, 0.711611270904541, 0.1088399887084961, 0.4634636640548706, 0.06363916397094727, 0.04299116134643555, 0.39977359771728516, 1.3879520893096924, 1.6083221435546875, 0.4435988664627075, 0.5275856256484985, 0.9346921443939209, 0.015123486518859863, 0.8021200895309448, 0.10765993595123291, 0.3060256242752075, 1.6200135946273804, 1.2410093545913696, 0.7200815677642822, 1.8900082111358643, 0.9381530284881592, 1.2220284938812256, 0.3936041593551636, 0.09677481651306152, 1.434796690940857, 0.26991188526153564, 1.524931788444519, 1.3977437019348145], "mean_td_error": 0.845274806022644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080801963806152, "actor_loss": -6.755797863006592, "critic_loss": 0.1862746626138687, "alpha_loss": -0.18755890429019928, "alpha_value": 0.9815664291381836, "log_alpha_value": -0.018605554476380348, "target_entropy": -6.0, "policy_t": -0.009189835749566555, "mean_q": 2.799197196960449, "max_q": 3.2647693157196045, "min_q": 2.0583646297454834}, "td_error": [0.33081674575805664, 1.0765727758407593, 0.9198455810546875, 0.3630152940750122, 0.11372852325439453, 0.8351224660873413, 1.6723003387451172, 2.631174087524414, 0.16139709949493408, 0.24429810047149658, 0.7170661687850952, 1.7544511556625366, 1.730316162109375, 0.43502867221832275, 1.1219791173934937, 1.1737549304962158, 0.10817945003509521, 0.48672914505004883, 0.2761338949203491, 0.6350830793380737, 0.5539629459381104, 0.7498975992202759, 0.3891977071762085, 2.0039262771606445, 1.4681459665298462, 0.5497409105300903, 1.4971330165863037, 1.534252405166626, 1.619214653968811, 0.17857813835144043, 0.379022479057312, 0.21697509288787842, 1.7000508308410645, 0.6583131551742554, 0.1093665361404419, 0.2750321626663208, 0.7015664577484131, 0.10938537120819092, 0.7174310684204102, 0.10813271999359131, 0.836065411567688, 0.41810357570648193, 1.243767261505127, 1.537239670753479, 0.48694896697998047, 0.515162467956543, 2.3043243885040283, 0.7895834445953369, 0.6965045928955078, 0.506550669670105, 0.12630939483642578, 2.5970025062561035, 0.7124639749526978, 0.7686210870742798, 0.8721596002578735, 2.261455535888672, 0.7491108179092407, 0.10941386222839355, 0.1674365997314453, 0.5761681795120239, 0.5051896572113037, 0.29538118839263916, 0.7380181550979614, 0.7504856586456299, 0.1119300127029419, 0.11045718193054199, 0.576797366142273, 0.20840466022491455, 0.10931706428527832, 1.9010666608810425, 0.16952049732208252, 0.8257437944412231, 0.8639286756515503, 1.1914384365081787, 2.264291763305664, 1.194062352180481, 0.33474183082580566, 0.23243272304534912, 1.0851998329162598, 0.3339906930923462, 1.2066397666931152, 1.3829988241195679, 2.3429646492004395, 1.1217550039291382, 1.1582518815994263, 1.4697024822235107], "mean_td_error": 0.8495979309082031, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 929.721461554913, "num_env_steps_trained_throughput_per_sec": 267.70997442094597, "timesteps_total": 57344, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 965.663, "sample_time_ms": 693.825, "load_time_ms": 0.312, "load_throughput": 826747.981, "learn_time_ms": 18.056, "learn_throughput": 14289.21, "synch_weights_time_ms": 9.943}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 16254, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 16254, "last_target_update_ts": 57344, "num_target_updates": 63}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-43", "timestamp": 1700369863, "time_this_iter_s": 1.9367308616638184, "time_total_s": 67.24529385566711, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317741c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.24529385566711, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 63.56666666666667, "ram_util_percent": 65.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036613464355469, "actor_loss": -7.909823417663574, "critic_loss": 0.3489043712615967, "alpha_loss": -0.19282732903957367, "alpha_value": 0.9809709787368774, "log_alpha_value": -0.01921238750219345, "target_entropy": -6.0, "policy_t": -0.011094562709331512, "mean_q": 4.170055866241455, "max_q": 13.178173065185547, "min_q": 3.74057674407959}, "td_error": [0.5297013521194458, 2.824223518371582, 1.111260175704956, 0.7905292510986328, 0.5975427627563477, 0.7304003238677979, 0.2381150722503662, 0.4566556215286255, 0.9697036743164062, 1.4825193881988525, 0.23445415496826172, 0.498130202293396, 0.236253023147583, 1.8071553707122803, 0.8740978240966797, 0.3609839677810669, 0.9174644947052002, 0.5433506965637207, 0.8019509315490723, 0.26795876026153564, 0.6877294778823853, 1.086148738861084, 0.4410221576690674, 1.2799451351165771, 0.417971134185791, 0.24677693843841553, 1.3101909160614014, 0.3529074192047119, 1.974849820137024, 0.868202805519104, 1.1332229375839233, 1.392288327217102, 0.24921166896820068, 0.5689882040023804, 0.23730146884918213, 2.504673480987549, 1.2881611585617065, 0.5051465034484863, 0.6795566082000732, 2.1062211990356445, 1.0616471767425537, 0.23508810997009277, 0.6769903898239136, 5.677918910980225, 0.41300976276397705, 2.745011806488037, 3.731367588043213, 1.655832290649414, 0.8261089324951172, 0.9389452934265137, 0.7607729434967041, 1.871108889579773, 1.4461358785629272, 0.6112642288208008, 4.373533248901367, 3.004403591156006, 0.5735138654708862, 1.454962968826294, 1.3376986980438232, 1.7202460765838623, 0.7524576187133789, 0.6646735668182373, 0.4349602460861206, 2.377995729446411, 0.2319650650024414, 1.2830536365509033, 0.24826180934906006, 0.926607608795166, 0.3078310489654541, 2.2103097438812256, 7.223787784576416, 0.5656578540802002, 0.23421573638916016, 1.495241641998291, 0.773567795753479, 0.2380964756011963, 2.3077402114868164, 0.5923798084259033, 0.23146498203277588, 1.6693023443222046, 2.140103816986084, 3.70369291305542, 0.5936037302017212, 1.2294936180114746, 1.7185709476470947, 0.23571395874023438], "mean_td_error": 1.2222009897232056, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028118133544922, "actor_loss": -6.878267288208008, "critic_loss": 0.1437053382396698, "alpha_loss": -0.19250668585300446, "alpha_value": 0.9809864163398743, "log_alpha_value": -0.01919669099152088, "target_entropy": -6.0, "policy_t": -0.09112945199012756, "mean_q": 2.749444007873535, "max_q": 3.4338126182556152, "min_q": 2.1219282150268555}, "td_error": [0.7206480503082275, 0.28559303283691406, 0.051605820655822754, 0.4975864887237549, 0.771788477897644, 1.3542028665542603, 1.5327959060668945, 1.753998041152954, 0.0805809497833252, 1.5902001857757568, 2.4163331985473633, 0.5676966905593872, 2.8558349609375, 2.0521936416625977, 0.17753827571868896, 0.4867295026779175, 1.144949197769165, 0.6975384950637817, 2.058685302734375, 1.2967312335968018, 1.2652614116668701, 1.24952232837677, 0.688652515411377, 0.36578893661499023, 0.3888193368911743, 1.5956721305847168, 1.2869467735290527, 0.5437605381011963, 0.813376784324646, 1.8329739570617676, 0.42552781105041504, 1.615143060684204, 1.770315170288086, 0.47458863258361816, 1.7175655364990234, 0.4561513662338257, 1.0039620399475098, 2.1260509490966797, 0.8795878887176514, 0.508169412612915, 1.621978759765625, 0.49834632873535156, 0.4963151216506958, 1.2221779823303223, 1.1425023078918457, 0.014896035194396973, 0.3316373825073242, 0.9875655174255371, 0.7174255847930908, 1.474241852760315, 0.3607374429702759, 1.0359151363372803, 0.6372753381729126, 0.1200171709060669, 1.337951421737671, 0.9158028364181519, 3.123176097869873, 0.04086446762084961, 0.3336712121963501, 0.8556294441223145, 0.2653839588165283, 0.28359293937683105, 0.8041033744812012, 1.0717828273773193, 0.5981045961380005, 0.05936086177825928, 0.8598654270172119, 0.13568055629730225, 1.1959179639816284, 1.9282907247543335, 1.3453755378723145, 1.1693837642669678, 2.3252310752868652, 0.8707187175750732, 0.3034716844558716, 0.7136005163192749, 0.6845827102661133, 0.10361635684967041, 0.07878553867340088, 0.265993595123291, 0.13500022888183594, 0.016025543212890625, 0.035495877265930176, 1.395705223083496, 0.5931761264801025, 0.7327617406845093], "mean_td_error": 0.914421021938324, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132649421691895, "actor_loss": -6.904254913330078, "critic_loss": 0.22267863154411316, "alpha_loss": -0.19460351765155792, "alpha_value": 0.9809776544570923, "log_alpha_value": -0.019205590710043907, "target_entropy": -6.0, "policy_t": -0.0038491617888212204, "mean_q": 2.8795979022979736, "max_q": 2.9647622108459473, "min_q": 2.0861358642578125}, "td_error": [1.6400632858276367, 1.7465496063232422, 1.6945704221725464, 0.26934313774108887, 0.3945145606994629, 2.0679819583892822, 0.7877752780914307, 0.2928190231323242, 1.0214921236038208, 1.4392348527908325, 0.9837942123413086, 1.2851413488388062, 0.8421932458877563, 1.4195960760116577, 3.109104871749878, 0.32810044288635254, 0.8740828037261963, 0.13628029823303223, 1.4551594257354736, 0.8125040531158447, 1.4732749462127686, 0.8821492195129395, 0.2864069938659668, 0.6953383684158325, 1.817505121231079, 0.15770268440246582, 0.5682129859924316, 0.13617324829101562, 1.5327985286712646, 0.8233970403671265, 0.5856789350509644, 0.2791175842285156, 0.6051644086837769, 0.9308947324752808, 1.184793472290039, 0.9954783916473389, 1.5837576389312744, 0.6145238876342773, 2.304654359817505, 0.10175228118896484, 1.356006383895874, 0.9037734270095825, 0.5398530960083008, 0.7293177843093872, 1.694077491760254, 0.9205681085586548, 0.49208760261535645, 0.6230452060699463, 1.4666333198547363, 1.2009296417236328, 1.2471494674682617, 0.21358513832092285, 1.4434198141098022, 0.2577385902404785, 0.12531805038452148, 0.8943114280700684, 0.9536522626876831, 1.5501854419708252, 0.09903061389923096, 1.9700291156768799, 2.0134153366088867, 0.5660885572433472, 0.7737350463867188, 1.0626146793365479, 1.5406439304351807, 0.21049296855926514, 1.6465797424316406, 0.10011601448059082, 1.183426856994629, 0.7217909097671509, 3.6532297134399414, 1.5017783641815186, 1.5437241792678833, 0.8823385238647461, 0.1813875436782837, 1.589766263961792, 0.4220987558364868, 1.3511314392089844, 0.6227494478225708, 0.6900920867919922, 0.09420788288116455, 0.5709819793701172, 0.6088916063308716, 0.14549481868743896, 0.7847360372543335, 0.4058365821838379], "mean_td_error": 0.9733388423919678, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 948.0071005373836, "num_env_steps_trained_throughput_per_sec": 272.97525886009487, "timesteps_total": 59136, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 177408, "timers": {"training_iteration_time_ms": 954.088, "sample_time_ms": 681.609, "load_time_ms": 0.314, "load_throughput": 821413.718, "learn_time_ms": 18.06, "learn_throughput": 14286.041, "synch_weights_time_ms": 10.041}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 16770, "num_agent_steps_sampled": 177408, "num_agent_steps_trained": 16770, "last_target_update_ts": 59136, "num_target_updates": 65}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-45", "timestamp": 1700369865, "time_this_iter_s": 1.8983979225158691, "time_total_s": 69.14369177818298, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b82c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.14369177818298, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 73.45, "ram_util_percent": 65.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015926361083984, "actor_loss": -8.104674339294434, "critic_loss": 0.3287370800971985, "alpha_loss": -0.19843502342700958, "alpha_value": 0.980383038520813, "log_alpha_value": -0.019811952486634254, "target_entropy": -6.0, "policy_t": -0.017390165477991104, "mean_q": 4.263047695159912, "max_q": 10.784448623657227, "min_q": 3.954289436340332}, "td_error": [0.899901270866394, 1.4936587810516357, 0.8975908756256104, 0.2492663860321045, 0.7894614934921265, 0.310483455657959, 0.8405095338821411, 0.7946605682373047, 4.895632266998291, 0.8872127532958984, 0.2887876033782959, 1.711954116821289, 2.044572591781616, 0.3563566207885742, 0.4734683036804199, 0.7924063205718994, 5.624011993408203, 0.23321831226348877, 0.9709315299987793, 0.2345595359802246, 2.6187503337860107, 0.22420835494995117, 0.22480463981628418, 2.167780876159668, 1.4679839611053467, 0.5929021835327148, 0.2853701114654541, 5.085943222045898, 1.4394339323043823, 0.6419692039489746, 2.8496479988098145, 1.451099157333374, 1.9124400615692139, 0.6601088047027588, 1.8360239267349243, 0.2869598865509033, 0.4968475103378296, 1.0565876960754395, 1.684851884841919, 0.34945809841156006, 1.4438735246658325, 0.9280632734298706, 2.2877299785614014, 0.4206986427307129, 1.9269812107086182, 0.820644736289978, 2.3002049922943115, 1.3177714347839355, 1.1032711267471313, 0.7433840036392212, 0.22412502765655518, 1.639901876449585, 0.226607084274292, 0.2803933620452881, 4.1888251304626465, 0.22367572784423828, 0.7010891437530518, 0.42951130867004395, 1.506364107131958, 0.5725053548812866, 1.753849983215332, 0.24925684928894043, 1.3199667930603027, 0.24065041542053223, 2.705373764038086, 0.9619531631469727, 1.2695913314819336, 1.0451469421386719, 0.7960391044616699, 0.22466671466827393, 2.579767942428589, 1.3472778797149658, 0.6870536804199219, 0.3458751440048218, 0.6443278789520264, 0.46004247665405273, 0.23187589645385742, 0.4004558324813843, 1.719588279724121, 0.691347599029541, 0.38842713832855225, 0.5403259992599487, 0.35775959491729736, 0.22139620780944824, 1.4215483665466309, 0.46413159370422363], "mean_td_error": 1.1450597047805786, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.106755256652832, "actor_loss": -6.955533981323242, "critic_loss": 0.15035536885261536, "alpha_loss": -0.20006780326366425, "alpha_value": 0.9803991913795471, "log_alpha_value": -0.019795455038547516, "target_entropy": -6.0, "policy_t": -0.01670859009027481, "mean_q": 2.7930946350097656, "max_q": 3.196809768676758, "min_q": 2.0960192680358887}, "td_error": [0.8793351650238037, 2.0367748737335205, 0.8390661478042603, 0.4121561050415039, 0.760181188583374, 1.889595627784729, 1.0733332633972168, 0.6478643417358398, 0.28148937225341797, 0.5785878896713257, 1.085534691810608, 0.7986301183700562, 1.8350555896759033, 0.6125438213348389, 0.5463969707489014, 0.856006383895874, 1.1223434209823608, 2.5098209381103516, 0.8530635833740234, 0.06661832332611084, 0.5705728530883789, 0.4237624406814575, 0.6098146438598633, 1.2959632873535156, 1.6566798686981201, 0.35337865352630615, 1.8946630954742432, 0.46119415760040283, 0.4630260467529297, 1.4137247800827026, 0.40245258808135986, 0.6185708045959473, 0.2317284345626831, 1.525741696357727, 1.7622016668319702, 0.6571762561798096, 0.2804063558578491, 1.8328425884246826, 0.12226414680480957, 2.194286584854126, 2.2783877849578857, 1.4954367876052856, 1.4296512603759766, 0.44100069999694824, 1.113863468170166, 0.14635586738586426, 0.1794372797012329, 0.4882904291152954, 2.2210607528686523, 0.6328185796737671, 0.7919001579284668, 2.5841965675354004, 3.0898609161376953, 0.716566801071167, 0.4793970584869385, 0.690650463104248, 0.5089545249938965, 0.1425185203552246, 0.7866923809051514, 0.6990423202514648, 2.110844612121582, 0.8788131475448608, 1.472078561782837, 1.7049320936203003, 0.3712773323059082, 0.5122549533843994, 1.0636931657791138, 1.1871267557144165, 1.2434518337249756, 1.0368757247924805, 0.11562895774841309, 0.020629525184631348, 0.21989762783050537, 0.5688279867172241, 0.460604190826416, 0.6855452060699463, 0.924709677696228, 1.6333831548690796, 0.9698233604431152, 0.7404332160949707, 0.39347779750823975, 0.11397838592529297, 0.3466775417327881, 0.603172779083252, 1.5601776838302612, 2.5904221534729004], "mean_td_error": 0.9639496803283691, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027606964111328, "actor_loss": -6.919280529022217, "critic_loss": 0.19056862592697144, "alpha_loss": -0.19860590994358063, "alpha_value": 0.9803889393806458, "log_alpha_value": -0.0198059119284153, "target_entropy": -6.0, "policy_t": -0.036788202822208405, "mean_q": 2.9284119606018066, "max_q": 3.008577585220337, "min_q": 2.072816848754883}, "td_error": [1.102158546447754, 0.48976218700408936, 0.23734533786773682, 0.739525556564331, 2.1428117752075195, 1.0886071920394897, 1.5710351467132568, 0.5822784900665283, 0.9882949590682983, 1.1845180988311768, 0.06683051586151123, 1.3900984525680542, 0.07010817527770996, 2.1797759532928467, 0.6343550682067871, 0.7237374782562256, 0.5524190664291382, 0.5699176788330078, 0.9435349702835083, 1.393505334854126, 0.6584421396255493, 0.4082305431365967, 0.3579143285751343, 0.28837502002716064, 0.2255021333694458, 2.8243298530578613, 1.424731969833374, 0.22115135192871094, 0.3880056142807007, 0.12556707859039307, 1.6609548330307007, 1.7497963905334473, 1.6743147373199463, 2.727369785308838, 0.7913495302200317, 1.0461149215698242, 1.1510498523712158, 0.22559380531311035, 0.23740971088409424, 0.7211623191833496, 0.54143226146698, 1.5139319896697998, 0.8682774305343628, 0.187103271484375, 1.3704168796539307, 0.7140649557113647, 1.363925576210022, 1.2426681518554688, 0.7118414640426636, 0.6702495813369751, 0.2616112232208252, 0.5568645000457764, 1.4690568447113037, 1.0542320013046265, 1.252902626991272, 0.5165261030197144, 1.5698198080062866, 0.6474192142486572, 0.6803308725357056, 0.08013927936553955, 1.0841923952102661, 0.531591534614563, 1.6194286346435547, 0.41573286056518555, 0.06653439998626709, 0.9808163642883301, 0.6161961555480957, 0.4136854410171509, 0.1662900447845459, 0.93964684009552, 0.22516918182373047, 0.9630228281021118, 1.5613768100738525, 1.2136191129684448, 0.47388386726379395, 1.1569899320602417, 0.8382799625396729, 0.4496403932571411, 1.5108076333999634, 1.1486817598342896, 0.12513232231140137, 0.25183093547821045, 1.7179388999938965, 1.7175359725952148, 0.31314539909362793, 1.230414628982544], "mean_td_error": 0.8902602791786194, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 948.232066655119, "num_env_steps_trained_throughput_per_sec": 273.0400370502463, "timesteps_total": 60928, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 182784, "timers": {"training_iteration_time_ms": 946.223, "sample_time_ms": 672.025, "load_time_ms": 0.314, "load_throughput": 821476.074, "learn_time_ms": 18.16, "learn_throughput": 14207.34, "synch_weights_time_ms": 9.929}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 182784, "num_agent_steps_trained": 17286, "last_target_update_ts": 60928, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-47", "timestamp": 1700369867, "time_this_iter_s": 1.8981549739837646, "time_total_s": 71.04184675216675, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 71.04184675216675, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 71.10000000000001, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06730842590332, "actor_loss": -8.230677604675293, "critic_loss": 0.2568458914756775, "alpha_loss": -0.20246995985507965, "alpha_value": 0.9800892472267151, "log_alpha_value": -0.020111626014113426, "target_entropy": -6.0, "policy_t": -0.0015994481509551406, "mean_q": 4.387458801269531, "max_q": 12.604259490966797, "min_q": 4.057061195373535}, "td_error": [0.2225353717803955, 1.0751550197601318, 0.3831050395965576, 0.5909616947174072, 0.3414316177368164, 0.9542441368103027, 0.8184423446655273, 0.3823246955871582, 0.47844362258911133, 0.7337958812713623, 1.5286831855773926, 0.21903467178344727, 0.60524582862854, 0.2128911018371582, 0.7260046005249023, 0.21353387832641602, 1.087247610092163, 1.0477542877197266, 0.7569851875305176, 3.829817295074463, 7.977249622344971, 0.38367724418640137, 0.21649980545043945, 0.6204609870910645, 0.4397258758544922, 1.6394689083099365, 0.8984785079956055, 0.2690465450286865, 1.691103219985962, 0.2267003059387207, 1.409691333770752, 0.7115156650543213, 0.5057549476623535, 0.5944647789001465, 2.311490535736084, 0.4058992862701416, 1.074596643447876, 0.21613693237304688, 0.35565710067749023, 1.5615923404693604, 2.5815176963806152, 0.23168063163757324, 0.5469515323638916, 0.4873378276824951, 2.9169349670410156, 6.192257404327393, 0.27445435523986816, 0.5314545631408691, 0.29473447799682617, 1.9554526805877686, 0.7303962707519531, 1.3507335186004639, 1.7186028957366943, 0.2179563045501709, 0.22321105003356934, 0.6642732620239258, 2.2622013092041016, 0.9186697006225586, 1.2014505863189697, 0.6426191329956055, 0.72585129737854, 0.8598811626434326, 0.45959043502807617, 0.45592188835144043, 0.538536787033081, 0.21899795532226562, 1.4890305995941162, 1.0495812892913818, 2.342108964920044, 0.48358869552612305, 0.8643205165863037, 0.21621370315551758, 0.7801632881164551, 0.2316598892211914, 0.5203526020050049, 0.21896028518676758, 1.5235490798950195, 0.37230539321899414, 0.27208566665649414, 0.23322486877441406, 0.24260497093200684, 0.26694321632385254, 0.6573188304901123, 0.223968505859375, 0.613314151763916, 1.3042511940002441], "mean_td_error": 0.9630704522132874, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061245918273926, "actor_loss": -6.975055694580078, "critic_loss": 0.15819993615150452, "alpha_loss": -0.20218023657798767, "alpha_value": 0.9801055788993835, "log_alpha_value": -0.02009494975209236, "target_entropy": -6.0, "policy_t": -0.05429976060986519, "mean_q": 2.861605644226074, "max_q": 3.1158289909362793, "min_q": 2.8153274059295654}, "td_error": [0.21444940567016602, 2.3677961826324463, 0.3526766300201416, 1.786022663116455, 1.0913997888565063, 0.9935102462768555, 0.6056348085403442, 0.1400700807571411, 0.059116482734680176, 0.5265085697174072, 3.1995413303375244, 1.2953218221664429, 0.882165789604187, 0.38550877571105957, 2.6456003189086914, 0.44463086128234863, 1.0810364484786987, 0.4267164468765259, 1.1251273155212402, 0.3409610986709595, 2.056874990463257, 0.10831046104431152, 1.6439647674560547, 0.8639403581619263, 0.6419185400009155, 0.3272111415863037, 0.14404940605163574, 1.0064914226531982, 1.1533883810043335, 0.7290165424346924, 3.1711297035217285, 1.206500768661499, 2.047194004058838, 0.4344214200973511, 1.6089959144592285, 0.10851514339447021, 0.6822075843811035, 0.9922739267349243, 1.0493440628051758, 0.06203782558441162, 0.0067424774169921875, 2.4115958213806152, 0.6779251098632812, 0.29527032375335693, 0.14267778396606445, 0.09632003307342529, 3.4613168239593506, 0.7226552963256836, 0.3665693998336792, 1.1907203197479248, 0.4995638132095337, 0.9829615354537964, 0.814045786857605, 1.2676639556884766, 0.9679704904556274, 2.1012022495269775, 0.47363734245300293, 0.014699816703796387, 2.0757672786712646, 1.8053282499313354, 1.2779808044433594, 1.3534880876541138, 0.0335540771484375, 0.2878180742263794, 0.5786831378936768, 1.0834071636199951, 0.5435471534729004, 0.45894479751586914, 2.11403226852417, 1.0817406177520752, 0.6319112777709961, 0.28489768505096436, 0.17757892608642578, 1.2507836818695068, 1.2398227453231812, 0.2119694948196411, 0.33547019958496094, 2.450849771499634, 1.348069429397583, 1.2419496774673462, 0.21031486988067627, 0.5853368043899536, 0.5108968019485474, 1.35724937915802, 0.08219337463378906, 1.5140341520309448], "mean_td_error": 0.9607295393943787, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037820816040039, "actor_loss": -6.968621730804443, "critic_loss": 0.16922008991241455, "alpha_loss": -0.20181973278522491, "alpha_value": 0.980094850063324, "log_alpha_value": -0.020105930045247078, "target_entropy": -6.0, "policy_t": -0.08123604953289032, "mean_q": 2.9050135612487793, "max_q": 3.0108461380004883, "min_q": 2.1619722843170166}, "td_error": [0.5565577745437622, 0.7334665060043335, 1.9859905242919922, 0.6543067693710327, 0.3951537609100342, 0.1528395414352417, 0.054082274436950684, 0.34122753143310547, 0.054194092750549316, 1.3281205892562866, 0.3739287853240967, 1.4027390480041504, 1.0593949556350708, 0.8981540203094482, 0.05396127700805664, 1.139639139175415, 1.0242866277694702, 0.1522808074951172, 0.18497180938720703, 1.286994457244873, 0.17916882038116455, 0.320819616317749, 1.7073287963867188, 0.5278525352478027, 1.5208356380462646, 0.22528362274169922, 0.4175758361816406, 1.7797417640686035, 1.3036069869995117, 0.15491580963134766, 2.4717142581939697, 0.6974999904632568, 1.5640071630477905, 0.08276784420013428, 0.12954378128051758, 0.3455626964569092, 1.5605559349060059, 0.3747749328613281, 0.6107922792434692, 0.40470659732818604, 0.056987881660461426, 2.031345844268799, 2.244040012359619, 0.18265509605407715, 1.938888669013977, 0.34214329719543457, 0.7819259166717529, 0.6724319458007812, 0.14057183265686035, 1.1465868949890137, 0.8650972843170166, 0.6358835697174072, 0.3529857397079468, 1.2157607078552246, 0.5743305683135986, 0.9135042428970337, 0.6121158599853516, 1.1705920696258545, 0.194421648979187, 0.8858805894851685, 1.7755589485168457, 2.5045931339263916, 0.8317930698394775, 0.05833470821380615, 0.16934871673583984, 1.0842245817184448, 0.8397468328475952, 0.8685312271118164, 0.1584848165512085, 0.40921294689178467, 0.5723848342895508, 1.273599624633789, 0.5858068466186523, 2.0483555793762207, 0.18347406387329102, 1.400937557220459, 0.5080026388168335, 0.5511415004730225, 0.24808931350708008, 0.9968750476837158, 0.8061068058013916, 0.2007126808166504, 0.15158319473266602, 1.410964012145996, 0.9069494009017944, 1.0823173522949219], "mean_td_error": 0.799960732460022, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 695.8619466044271, "num_env_steps_trained_throughput_per_sec": 200.3709623035069, "timesteps_total": 61824, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 185472, "timers": {"training_iteration_time_ms": 984.532, "sample_time_ms": 679.277, "load_time_ms": 0.314, "load_throughput": 820977.492, "learn_time_ms": 18.114, "learn_throughput": 14243.431, "synch_weights_time_ms": 9.938}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 185472, "num_agent_steps_trained": 17544, "last_target_update_ts": 61824, "num_target_updates": 68}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-49", "timestamp": 1700369869, "time_this_iter_s": 1.2962920665740967, "time_total_s": 72.33813881874084, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.33813881874084, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 54.900000000000006, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084959030151367, "actor_loss": -8.434483528137207, "critic_loss": 0.22393256425857544, "alpha_loss": -0.20887090265750885, "alpha_value": 0.9795019030570984, "log_alpha_value": -0.020711129531264305, "target_entropy": -6.0, "policy_t": -0.005995599552989006, "mean_q": 4.519265651702881, "max_q": 10.195175170898438, "min_q": 3.936434268951416}, "td_error": [1.573024034500122, 1.241849660873413, 1.4715509414672852, 0.38209104537963867, 0.23559951782226562, 2.705355167388916, 0.24048852920532227, 1.0802743434906006, 0.23177409172058105, 1.9008007049560547, 0.42528867721557617, 3.420715808868408, 0.27245402336120605, 0.23737502098083496, 1.4149816036224365, 0.22793292999267578, 0.3359808921813965, 0.7633836269378662, 1.2540068626403809, 1.6209874153137207, 0.914339542388916, 0.3130040168762207, 0.2062389850616455, 0.2989950180053711, 1.2022597789764404, 1.099682331085205, 0.6656370162963867, 0.18738889694213867, 0.21674227714538574, 0.2307126522064209, 0.3927335739135742, 0.7825088500976562, 0.7246489524841309, 1.191901683807373, 0.3723139762878418, 0.9395196437835693, 0.49906349182128906, 0.43407273292541504, 0.9155473709106445, 0.8054413795471191, 0.582289457321167, 2.0941293239593506, 1.2096140384674072, 1.0135536193847656, 0.19633960723876953, 5.202093601226807, 0.7221195697784424, 2.391982316970825, 0.6959047317504883, 1.3455781936645508, 1.2121574878692627, 1.3362603187561035, 0.8940513134002686, 3.3891730308532715, 1.061448335647583, 0.19564008712768555, 0.19754719734191895, 2.511951446533203, 0.9977836608886719, 0.5194294452667236, 0.40607643127441406, 0.6425459384918213, 0.42520642280578613, 0.1957855224609375, 0.766247034072876, 0.21776103973388672, 1.2448959350585938, 0.7232661247253418, 0.36362600326538086, 0.7441296577453613, 0.25159740447998047, 0.22931957244873047, 0.32591724395751953, 0.9526174068450928, 0.25893712043762207, 0.7597836256027222, 0.4709286689758301, 0.6945197582244873, 0.3068516254425049, 0.681035041809082, 1.9540817737579346, 0.9540512561798096, 0.9660041332244873, 0.46160411834716797, 0.21388459205627441, 1.484224557876587], "mean_td_error": 0.9057279825210571, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042901992797852, "actor_loss": -6.997378826141357, "critic_loss": 0.13337725400924683, "alpha_loss": -0.20782625675201416, "alpha_value": 0.9795188307762146, "log_alpha_value": -0.02069384604692459, "target_entropy": -6.0, "policy_t": -0.06650778651237488, "mean_q": 2.85076642036438, "max_q": 2.9750852584838867, "min_q": 2.069776773452759}, "td_error": [0.958321213722229, 0.24151039123535156, 0.3790426254272461, 0.3987998962402344, 0.6416555643081665, 0.902301549911499, 1.5055917501449585, 1.408643126487732, 1.0561327934265137, 1.2834160327911377, 1.9510585069656372, 0.9911923408508301, 0.528600811958313, 0.034949660301208496, 0.29256200790405273, 1.1935797929763794, 1.892853021621704, 0.7813429832458496, 1.2750968933105469, 0.023427605628967285, 0.8072586059570312, 0.746200442314148, 1.3754286766052246, 1.7571682929992676, 0.2836705446243286, 0.3407745361328125, 0.39156055450439453, 1.4017348289489746, 1.3171203136444092, 0.7309197187423706, 0.10049843788146973, 1.2158780097961426, 0.16759657859802246, 0.13960564136505127, 0.356852650642395, 0.08408188819885254, 0.9433721303939819, 0.6092187166213989, 0.9014735221862793, 2.1849818229675293, 0.5744003057479858, 2.1407384872436523, 0.45604562759399414, 0.8486217260360718, 0.24470973014831543, 0.7236347198486328, 1.2315248250961304, 0.2283841371536255, 2.246312141418457, 0.31043314933776855, 0.32828855514526367, 0.8203635215759277, 0.17340326309204102, 1.0534796714782715, 2.818180799484253, 0.4520881175994873, 0.092193603515625, 0.4565223455429077, 1.3100579977035522, 0.40100717544555664, 2.2897400856018066, 0.23297905921936035, 0.5642139911651611, 0.08025062084197998, 1.0051820278167725, 0.04671192169189453, 2.5791549682617188, 0.22064208984375, 0.0022041797637939453, 1.0374537706375122, 1.2347685098648071, 0.9017635583877563, 0.11444079875946045, 2.9194750785827637, 0.5448120832443237, 0.8729766607284546, 1.7970426082611084, 2.5870046615600586, 0.14476561546325684, 1.153266191482544, 1.333292841911316, 0.26391422748565674, 1.1285613775253296, 0.49227476119995117, 0.4647942781448364, 0.47197699546813965], "mean_td_error": 0.8719711899757385, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072029113769531, "actor_loss": -6.986015796661377, "critic_loss": 0.22807393968105316, "alpha_loss": -0.20854830741882324, "alpha_value": 0.9795072078704834, "log_alpha_value": -0.02070569060742855, "target_entropy": -6.0, "policy_t": -0.0180125143378973, "mean_q": 2.9214627742767334, "max_q": 3.020766496658325, "min_q": 2.422307014465332}, "td_error": [0.31732332706451416, 1.325438141822815, 1.859364628791809, 0.6257882118225098, 1.7501825094223022, 2.7225394248962402, 0.6295065879821777, 0.45485031604766846, 0.5157959461212158, 0.3348468542098999, 1.70917546749115, 1.6302478313446045, 1.2701791524887085, 0.8674087524414062, 0.5504601001739502, 0.848731517791748, 0.775753378868103, 0.035652875900268555, 2.699129581451416, 0.3441145420074463, 2.286306142807007, 0.11833536624908447, 0.9599864482879639, 0.18662810325622559, 2.253913164138794, 1.0091791152954102, 0.9270695447921753, 1.5993659496307373, 1.0196106433868408, 1.0358216762542725, 1.10768461227417, 1.2476468086242676, 1.049678087234497, 0.214835524559021, 0.36730849742889404, 0.6675480604171753, 0.4680466651916504, 0.26012396812438965, 1.1797664165496826, 0.47092747688293457, 1.7719099521636963, 1.5552828311920166, 2.397747278213501, 1.0917302370071411, 1.0585839748382568, 0.8361515998840332, 0.07382261753082275, 0.9191586971282959, 0.3612020015716553, 0.866058349609375, 0.10193860530853271, 0.47581398487091064, 0.890723705291748, 0.4237957000732422, 0.7663774490356445, 0.41022348403930664, 0.3550175428390503, 0.9490619897842407, 1.2124080657958984, 1.3906956911087036, 0.4515707492828369, 2.2417526245117188, 1.5841107368469238, 0.47304534912109375, 1.2370010614395142, 0.2446657419204712, 0.44876623153686523, 1.05967116355896, 0.9727523326873779, 0.5683236122131348, 0.030943632125854492, 1.0095664262771606, 0.13943743705749512, 2.2551841735839844, 1.549424648284912, 2.041292190551758, 0.9371947050094604, 0.2489306926727295, 0.5484795570373535, 0.6718120574951172, 0.09767413139343262, 0.3669217824935913, 1.8078064918518066, 2.874886989593506, 1.619770884513855, 1.049099326133728], "mean_td_error": 0.9783029556274414, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 998.8435410726661, "num_env_steps_trained_throughput_per_sec": 287.61343035351325, "timesteps_total": 63616, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 190848, "timers": {"training_iteration_time_ms": 971.426, "sample_time_ms": 665.706, "load_time_ms": 0.313, "load_throughput": 825171.902, "learn_time_ms": 18.214, "learn_throughput": 14165.142, "synch_weights_time_ms": 9.856}, "counters": {"num_env_steps_sampled": 63616, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 190848, "num_agent_steps_trained": 18060, "last_target_update_ts": 63616, "num_target_updates": 70}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-50", "timestamp": 1700369870, "time_this_iter_s": 1.8037669658660889, "time_total_s": 74.14190578460693, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b8ae0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 74.14190578460693, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 69.15, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007305145263672, "actor_loss": -8.559640884399414, "critic_loss": 0.19928349554538727, "alpha_loss": -0.21326442062854767, "alpha_value": 0.9789146184921265, "log_alpha_value": -0.021310873329639435, "target_entropy": -6.0, "policy_t": -0.016056522727012634, "mean_q": 4.545835494995117, "max_q": 9.771451950073242, "min_q": 4.0165605545043945}, "td_error": [0.6434924602508545, 0.3607501983642578, 0.17933940887451172, 0.16979050636291504, 0.15528202056884766, 1.4708473682403564, 0.16507434844970703, 0.7472543716430664, 1.119165301322937, 0.8827347755432129, 0.7727892398834229, 0.49802732467651367, 0.15558600425720215, 0.8344495296478271, 0.4695918560028076, 1.2745134830474854, 0.4385223388671875, 0.8984150886535645, 0.9598605632781982, 0.4474143981933594, 0.47026920318603516, 0.6009852886199951, 3.0809218883514404, 0.5148229598999023, 2.092923164367676, 0.20238947868347168, 0.18707895278930664, 0.16469860076904297, 0.2743053436279297, 0.635744571685791, 2.732161045074463, 0.2104332447052002, 0.34619593620300293, 3.2361867427825928, 1.1940608024597168, 1.1935763359069824, 0.16150522232055664, 0.45324110984802246, 0.479205846786499, 0.8027846813201904, 0.5419468879699707, 0.3127284049987793, 0.29303741455078125, 0.44642019271850586, 0.45093512535095215, 1.1221933364868164, 0.735457181930542, 0.23087549209594727, 0.5407915115356445, 2.2732937335968018, 1.6561198234558105, 1.8867592811584473, 0.16524457931518555, 0.2221074104309082, 0.7177236080169678, 0.15252685546875, 1.7352385520935059, 1.1806402206420898, 2.020507574081421, 0.9272141456604004, 0.18751120567321777, 0.2928740978240967, 0.5745875835418701, 0.259260892868042, 5.143415451049805, 0.743929386138916, 0.4268171787261963, 0.6108071804046631, 0.18239855766296387, 0.7312912940979004, 0.6287870407104492, 0.3022732734680176, 0.6798810958862305, 1.4912798404693604, 0.16515302658081055, 0.4076881408691406, 1.4897394180297852, 1.5275652408599854, 0.8857936859130859, 0.7584173679351807, 0.8934252262115479, 0.45127129554748535, 0.15848779678344727, 0.9820213317871094, 0.19196343421936035, 0.7635588645935059], "mean_td_error": 0.81649249792099, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04941177368164, "actor_loss": -6.958472728729248, "critic_loss": 0.09019850194454193, "alpha_loss": -0.21397700905799866, "alpha_value": 0.9789326190948486, "log_alpha_value": -0.021292490884661674, "target_entropy": -6.0, "policy_t": -0.035993944853544235, "mean_q": 2.8381433486938477, "max_q": 2.985718011856079, "min_q": 2.0287039279937744}, "td_error": [1.464085340499878, 0.6140881776809692, 0.435094952583313, 1.5559096336364746, 1.1627143621444702, 1.1623036861419678, 0.008808255195617676, 0.4084564447402954, 0.5888453722000122, 0.7840728759765625, 1.4250060319900513, 2.7097487449645996, 0.34579920768737793, 0.8227460384368896, 0.19025468826293945, 1.021701455116272, 0.17318928241729736, 1.6921961307525635, 1.2339272499084473, 0.8756948709487915, 0.22974324226379395, 1.4785948991775513, 0.5371962785720825, 1.2507981061935425, 0.9837557077407837, 0.07895123958587646, 0.6416264772415161, 0.3053165674209595, 0.8149303197860718, 0.19815802574157715, 0.46935319900512695, 0.13494396209716797, 1.5981988906860352, 0.471240758895874, 0.8174235820770264, 0.18086695671081543, 0.7750259637832642, 0.669171929359436, 0.7232656478881836, 1.4867388010025024, 1.2824273109436035, 0.13497662544250488, 0.23024344444274902, 0.07766640186309814, 0.45310235023498535, 0.7744320631027222, 0.06393182277679443, 0.47658252716064453, 0.7890967130661011, 0.8770452737808228, 1.6152174472808838, 0.0037484169006347656, 1.0160963535308838, 0.6206831932067871, 1.006223201751709, 2.4102389812469482, 0.08165013790130615, 0.8952077627182007, 0.774983286857605, 0.4263021945953369, 0.2489868402481079, 1.1944589614868164, 0.17093229293823242, 0.664792537689209, 0.15442931652069092, 1.2414677143096924, 0.9069434404373169, 0.14444410800933838, 0.5830988883972168, 1.4740487337112427, 1.1697298288345337, 0.42510783672332764, 1.2383651733398438, 0.07970929145812988, 1.1226539611816406, 1.4291378259658813, 0.3387552499771118, 1.1591873168945312, 1.4474513530731201, 0.03179776668548584, 0.5395385026931763, 0.20302259922027588, 0.24515008926391602, 0.950750470161438, 0.3489278554916382, 1.7065142393112183], "mean_td_error": 0.7645255923271179, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089214324951172, "actor_loss": -7.008007526397705, "critic_loss": 0.2218799591064453, "alpha_loss": -0.21495486795902252, "alpha_value": 0.9789199233055115, "log_alpha_value": -0.02130541391670704, "target_entropy": -6.0, "policy_t": -0.06554944813251495, "mean_q": 2.8593318462371826, "max_q": 3.0034561157226562, "min_q": 2.037180185317993}, "td_error": [1.7823948860168457, 1.550392985343933, 2.044909954071045, 0.4069610834121704, 1.7349947690963745, 0.19564688205718994, 0.8003628253936768, 0.25627923011779785, 0.013257741928100586, 0.3913278579711914, 0.9682894945144653, 0.31741809844970703, 0.3878246545791626, 0.2218989133834839, 0.6999332904815674, 1.8264248371124268, 0.18013274669647217, 1.4264758825302124, 0.51088547706604, 1.3585009574890137, 0.2983189821243286, 0.2785215377807617, 0.2045140266418457, 1.0465682744979858, 1.7925615310668945, 0.631416916847229, 0.19065117835998535, 0.225702166557312, 0.14202260971069336, 0.715906023979187, 0.47545814514160156, 0.8716760873794556, 1.9230566024780273, 0.10047996044158936, 0.28188884258270264, 0.8071990013122559, 2.7174875736236572, 0.3224618434906006, 0.7872194051742554, 0.10297536849975586, 0.6691913604736328, 2.1989030838012695, 2.257948875427246, 2.7373533248901367, 1.4126819372177124, 0.15979492664337158, 0.19542992115020752, 0.5790574550628662, 0.5584136247634888, 0.4752417802810669, 0.11888301372528076, 0.16526436805725098, 2.4227752685546875, 0.2109764814376831, 2.102138042449951, 0.798839807510376, 1.0913093090057373, 1.079109787940979, 0.6690870523452759, 1.3574106693267822, 2.008845329284668, 0.21593773365020752, 1.758461594581604, 0.17500543594360352, 1.8272395133972168, 0.4619179964065552, 2.7005972862243652, 0.1768261194229126, 0.7280846834182739, 0.6171661615371704, 0.9708963632583618, 0.41535484790802, 2.2333436012268066, 1.2340190410614014, 2.052161931991577, 2.233656883239746, 1.9194761514663696, 0.6418704986572266, 0.35446393489837646, 0.052498817443847656, 0.9340523481369019, 0.5541521310806274, 1.954060673713684, 1.150061011314392, 1.4343740940093994, 0.73256516456604], "mean_td_error": 0.951015055179596, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 906.263325684069, "num_env_steps_trained_throughput_per_sec": 260.9552879759931, "timesteps_total": 65408, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 196224, "timers": {"training_iteration_time_ms": 980.235, "sample_time_ms": 676.039, "load_time_ms": 0.313, "load_throughput": 823978.095, "learn_time_ms": 18.333, "learn_throughput": 14073.088, "synch_weights_time_ms": 9.485}, "counters": {"num_env_steps_sampled": 65408, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 196224, "num_agent_steps_trained": 18576, "last_target_update_ts": 65408, "num_target_updates": 72}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-52", "timestamp": 1700369872, "time_this_iter_s": 1.9873371124267578, "time_total_s": 76.12924289703369, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743ec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 76.12924289703369, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 68.76666666666667, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060401916503906, "actor_loss": -8.781384468078613, "critic_loss": 0.2551186978816986, "alpha_loss": -0.22042670845985413, "alpha_value": 0.9783279895782471, "log_alpha_value": -0.021910326555371284, "target_entropy": -6.0, "policy_t": -0.03505878895521164, "mean_q": 4.817204475402832, "max_q": 11.043127059936523, "min_q": 4.086194038391113}, "td_error": [0.1791520118713379, 0.5562503337860107, 2.5130228996276855, 0.5926241874694824, 0.32036399841308594, 0.5175204277038574, 0.990656852722168, 0.2586326599121094, 0.49821901321411133, 0.9448773860931396, 1.2676811218261719, 0.3013124465942383, 1.448256015777588, 1.0111052989959717, 2.0202677249908447, 0.11886429786682129, 0.715752363204956, 0.8187732696533203, 0.3044924736022949, 1.1196136474609375, 0.6278715133666992, 1.1990365982055664, 2.8890397548675537, 1.5062758922576904, 0.16739392280578613, 0.9407517910003662, 0.5584561824798584, 0.12754559516906738, 0.8565249443054199, 0.5350303649902344, 0.40813207626342773, 1.042219638824463, 0.5795707702636719, 0.5087664127349854, 0.45798730850219727, 6.105435371398926, 1.859846830368042, 2.845736503601074, 0.35462331771850586, 0.935981035232544, 2.3332860469818115, 0.1255636215209961, 2.0397465229034424, 1.4194042682647705, 0.14382123947143555, 0.9482154846191406, 1.7069740295410156, 0.7254905700683594, 0.9019937515258789, 0.5412430763244629, 0.7037868499755859, 0.9777467250823975, 0.15408539772033691, 0.18461036682128906, 0.12920928001403809, 0.4102756977081299, 0.5974147319793701, 0.33823490142822266, 0.8851537704467773, 0.19324851036071777, 0.9617698192596436, 0.508056640625, 0.8015756607055664, 0.4578723907470703, 2.0656652450561523, 1.7072491645812988, 1.190744161605835, 1.0479722023010254, 1.2728776931762695, 1.0473062992095947, 2.396414279937744, 0.12100791931152344, 3.825383424758911, 0.683290958404541, 0.27401208877563477, 0.11937141418457031, 0.11954283714294434, 2.3436527252197266, 0.6293089389801025, 0.14009761810302734, 1.4428398609161377, 0.668853759765625, 0.6012165546417236, 0.20642781257629395, 1.3301599025726318, 1.5428466796875], "mean_td_error": 0.9763801693916321, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102167129516602, "actor_loss": -6.981509208679199, "critic_loss": 0.12839184701442719, "alpha_loss": -0.22114504873752594, "alpha_value": 0.9783470034599304, "log_alpha_value": -0.021890850737690926, "target_entropy": -6.0, "policy_t": -0.03135369345545769, "mean_q": 2.845958709716797, "max_q": 2.991082191467285, "min_q": 2.030592203140259}, "td_error": [0.19744610786437988, 0.07582736015319824, 0.7393696308135986, 0.2379535436630249, 0.2542232275009155, 1.3342485427856445, 2.2506906986236572, 0.7230801582336426, 0.03428459167480469, 0.06021225452423096, 2.1651415824890137, 0.2705751657485962, 0.36846923828125, 0.2912266254425049, 1.6563806533813477, 1.7308831214904785, 1.5308008193969727, 1.9524173736572266, 0.3159317970275879, 1.6896320581436157, 1.0796689987182617, 0.2289731502532959, 0.24428319931030273, 0.574462890625, 1.1630518436431885, 1.0380423069000244, 0.4655139446258545, 0.38282251358032227, 1.5710865259170532, 0.19495165348052979, 0.42716002464294434, 0.48259449005126953, 0.9947261810302734, 0.5845474004745483, 1.1635792255401611, 1.1668741703033447, 1.0840057134628296, 1.3044228553771973, 0.909227728843689, 0.32258903980255127, 1.1240472793579102, 2.081122398376465, 0.31892597675323486, 0.444044828414917, 1.3294230699539185, 0.6845685243606567, 0.5144869089126587, 0.4774090051651001, 2.125025749206543, 0.966865062713623, 1.9914623498916626, 0.02573871612548828, 0.23778676986694336, 2.0878217220306396, 0.7006313800811768, 1.1947556734085083, 1.9193052053451538, 1.7353289127349854, 0.6272519826889038, 1.2637051343917847, 0.07041049003601074, 0.1290888786315918, 0.19617056846618652, 0.6791784763336182, 0.6404564380645752, 0.0018160343170166016, 0.8197617530822754, 1.1121352910995483, 2.6432669162750244, 0.8062232732772827, 0.5140581130981445, 1.314734935760498, 0.4034764766693115, 0.8532325029373169, 1.9281842708587646, 1.0898587703704834, 1.301847219467163, 1.4394819736480713, 0.4573730230331421, 1.6810740232467651, 3.655471086502075, 0.8162633180618286, 1.0737441778182983, 1.427870750427246, 0.8021837472915649, 1.2616236209869385], "mean_td_error": 0.9561635255813599, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053498268127441, "actor_loss": -6.965583801269531, "critic_loss": 0.11337299644947052, "alpha_loss": -0.22022370994091034, "alpha_value": 0.9783329963684082, "log_alpha_value": -0.02190518192946911, "target_entropy": -6.0, "policy_t": -0.061939410865306854, "mean_q": 2.833228826522827, "max_q": 2.977710723876953, "min_q": 2.039107322692871}, "td_error": [0.46131181716918945, 1.6207568645477295, 0.05772995948791504, 0.7264609336853027, 0.11989498138427734, 1.8241009712219238, 0.03675556182861328, 1.2026337385177612, 0.7122349739074707, 2.7996582984924316, 0.7597595453262329, 2.6054797172546387, 1.5873761177062988, 0.3073235750198364, 0.5197006464004517, 1.7439543008804321, 0.7688730955123901, 0.2599024772644043, 0.7648680210113525, 0.7561048269271851, 0.7548494338989258, 2.843360424041748, 0.47542738914489746, 1.3953173160552979, 2.087810516357422, 0.017830610275268555, 0.3905125856399536, 0.763191819190979, 0.46514272689819336, 0.3943455219268799, 0.4143639802932739, 0.6541047096252441, 0.3616526126861572, 0.8927168846130371, 0.6033511161804199, 0.27893733978271484, 1.3324007987976074, 0.12178254127502441, 1.6000869274139404, 1.731618881225586, 1.1679694652557373, 0.5661226511001587, 1.0908704996109009, 1.7820748090744019, 0.255276083946228, 0.7480814456939697, 1.1549187898635864, 1.9800491333007812, 0.12165534496307373, 0.8518497943878174, 0.7175414562225342, 0.9023987054824829, 0.22107303142547607, 0.8944965600967407, 0.7310366630554199, 0.1156318187713623, 0.09230130910873413, 1.0377848148345947, 1.5835952758789062, 0.3804081678390503, 1.9419000148773193, 0.5774790048599243, 0.5415091514587402, 0.051684021949768066, 0.6787124872207642, 0.8300306797027588, 0.45095574855804443, 0.5416083335876465, 0.4354097843170166, 0.14450573921203613, 0.40638768672943115, 1.3321645259857178, 0.095816969871521, 0.6987396478652954, 0.055768489837646484, 0.7177550792694092, 0.162550687789917, 0.107940673828125, 1.0305180549621582, 0.21473538875579834, 1.3673123121261597, 0.18860626220703125, 0.618333101272583, 0.15431666374206543, 1.171610951423645, 1.8212461471557617], "mean_td_error": 0.8133304715156555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 969.0037331987043, "num_env_steps_trained_throughput_per_sec": 279.02116424694833, "timesteps_total": 67200, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 201600, "timers": {"training_iteration_time_ms": 974.393, "sample_time_ms": 669.665, "load_time_ms": 0.313, "load_throughput": 823225.89, "learn_time_ms": 18.339, "learn_throughput": 14068.386, "synch_weights_time_ms": 9.548}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 201600, "num_agent_steps_trained": 19092, "last_target_update_ts": 67200, "num_target_updates": 74}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-54", "timestamp": 1700369874, "time_this_iter_s": 1.8587887287139893, "time_total_s": 77.98803162574768, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.98803162574768, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 65.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066655158996582, "actor_loss": -8.901509284973145, "critic_loss": 0.22877761721611023, "alpha_loss": -0.22659750282764435, "alpha_value": 0.9777417182922363, "log_alpha_value": -0.022509712725877762, "target_entropy": -6.0, "policy_t": -0.04136626794934273, "mean_q": 4.749932765960693, "max_q": 4.861044883728027, "min_q": 4.1459856033325195}, "td_error": [0.6833374500274658, 0.702103853225708, 0.8630475997924805, 0.09808969497680664, 0.6518807411193848, 1.9699738025665283, 1.7035818099975586, 0.9205453395843506, 0.352508544921875, 0.08458685874938965, 0.7449429035186768, 0.3237614631652832, 0.25422048568725586, 2.5818750858306885, 1.043250322341919, 1.089141607284546, 1.4845352172851562, 0.07968902587890625, 2.6925301551818848, 0.6638734340667725, 0.8430571556091309, 1.1088171005249023, 0.8780660629272461, 0.8924107551574707, 0.305330753326416, 0.1960444450378418, 2.924731492996216, 0.851222038269043, 2.034923553466797, 2.3500654697418213, 0.5026781558990479, 0.7888004779815674, 0.1778244972229004, 2.1411831378936768, 2.907553195953369, 0.07534503936767578, 0.0686039924621582, 0.9313633441925049, 0.8492140769958496, 0.07866096496582031, 0.36234092712402344, 0.10003185272216797, 0.5648467540740967, 0.2424778938293457, 0.8218967914581299, 1.261206865310669, 0.8091883659362793, 1.1806902885437012, 0.2876858711242676, 0.47133636474609375, 0.4410996437072754, 1.6134274005889893, 1.1521689891815186, 1.4832513332366943, 3.1074087619781494, 1.1156628131866455, 0.4625086784362793, 0.9994955062866211, 0.38178181648254395, 0.5229806900024414, 0.5932059288024902, 0.43665075302124023, 0.19124317169189453, 0.07711529731750488, 1.2016897201538086, 0.10082626342773438, 0.10953402519226074, 1.4301230907440186, 0.0712423324584961, 0.35627198219299316, 1.2030813694000244, 1.2792103290557861, 0.29472994804382324, 1.3273227214813232, 0.9509828090667725, 2.3080945014953613, 0.6657736301422119, 0.7714040279388428, 0.1202857494354248, 0.7801928520202637, 0.2386636734008789, 0.0713357925415039, 1.6758465766906738, 1.294555902481079, 1.4437987804412842, 0.9273533821105957], "mean_td_error": 0.8976209163665771, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.91645336151123, "actor_loss": -6.860902786254883, "critic_loss": 0.11285103857517242, "alpha_loss": -0.22301577031612396, "alpha_value": 0.9777615070343018, "log_alpha_value": -0.02248946949839592, "target_entropy": -6.0, "policy_t": -0.09152936935424805, "mean_q": 2.84332537651062, "max_q": 2.973507881164551, "min_q": 1.9748501777648926}, "td_error": [1.721144199371338, 0.12219810485839844, 1.05825674533844, 1.0511512756347656, 0.7914209365844727, 1.1630851030349731, 0.2995558977127075, 1.1534268856048584, 0.5025773048400879, 1.086675763130188, 0.46822965145111084, 0.48601293563842773, 0.5984981060028076, 0.8178975582122803, 1.915106177330017, 2.0239288806915283, 0.10171246528625488, 2.7668662071228027, 1.8950077295303345, 1.943719506263733, 1.1782608032226562, 1.0343049764633179, 0.8464574813842773, 0.6089524030685425, 1.5358145236968994, 0.4338454008102417, 0.5785915851593018, 2.4064345359802246, 0.9528788328170776, 1.0591601133346558, 2.6037497520446777, 0.7520674467086792, 0.20525050163269043, 1.1165918111801147, 0.553493857383728, 0.3830132484436035, 0.26040124893188477, 0.5212658643722534, 0.4303489923477173, 0.5216169357299805, 0.19282960891723633, 0.825738787651062, 2.1605286598205566, 1.4555745124816895, 0.040621280670166016, 0.5763248205184937, 0.961685061454773, 1.4082527160644531, 0.191414475440979, 0.8670341968536377, 0.3734421730041504, 0.2925029993057251, 1.1049851179122925, 1.2961974143981934, 1.1951334476470947, 1.0815892219543457, 0.210127592086792, 0.7183409929275513, 1.240004062652588, 0.7626433372497559, 2.0744059085845947, 0.24331092834472656, 0.14942896366119385, 0.7871497869491577, 0.97698974609375, 0.0121077299118042, 0.1452549695968628, 2.0175211429595947, 0.5505475997924805, 0.9317730665206909, 0.212446928024292, 0.09495770931243896, 0.2668321132659912, 0.826781153678894, 0.9763344526290894, 0.04896140098571777, 0.7902207374572754, 2.0450844764709473, 1.2176839113235474, 0.7019029855728149, 0.7166168689727783, 0.2019035816192627, 1.217483401298523, 1.0185019969940186, 1.3672816753387451, 2.874783515930176], "mean_td_error": 0.9229093194007874, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033622741699219, "actor_loss": -6.949512481689453, "critic_loss": 0.12444807589054108, "alpha_loss": -0.2258043885231018, "alpha_value": 0.9777465462684631, "log_alpha_value": -0.022504772990942, "target_entropy": -6.0, "policy_t": -0.10564935952425003, "mean_q": 2.8127665519714355, "max_q": 3.1012730598449707, "min_q": 2.1094422340393066}, "td_error": [0.6945395469665527, 1.0093977451324463, 1.0869635343551636, 1.8092628717422485, 0.14579784870147705, 0.8205963373184204, 0.6690266132354736, 0.27664995193481445, 0.2626943588256836, 0.18316900730133057, 0.7364884614944458, 1.9275243282318115, 1.5026251077651978, 1.409346103668213, 1.0867533683776855, 1.2914273738861084, 0.4013493061065674, 1.5735363960266113, 0.48116254806518555, 1.0467537641525269, 0.8655673265457153, 0.5453908443450928, 1.1207408905029297, 1.1068936586380005, 0.6472200155258179, 0.5156582593917847, 0.614490270614624, 0.5243663787841797, 0.17208707332611084, 0.14551937580108643, 0.7363075017929077, 1.2179338932037354, 0.895910382270813, 0.7853226661682129, 0.5291702747344971, 1.415177822113037, 0.9922763109207153, 0.8491325378417969, 0.24509143829345703, 0.966960072517395, 0.15628385543823242, 1.6098026037216187, 0.5666176080703735, 0.2623405456542969, 0.10326647758483887, 2.1378777027130127, 0.8813722133636475, 1.0752452611923218, 1.2696807384490967, 0.7209138870239258, 1.2933075428009033, 1.8048406839370728, 2.8641185760498047, 2.4058990478515625, 1.2637250423431396, 2.826101541519165, 3.012946605682373, 0.43131399154663086, 0.06883955001831055, 0.034807443618774414, 2.3986237049102783, 0.5613170862197876, 0.20601963996887207, 0.33954739570617676, 0.27410924434661865, 0.6281183958053589, 1.581760287284851, 0.4089493751525879, 0.2093660831451416, 0.7093709707260132, 1.2277655601501465, 0.8972498178482056, 0.48311948776245117, 0.2714196443557739, 0.5952131748199463, 0.22706115245819092, 0.3827322721481323, 0.08503687381744385, 0.4926278591156006, 1.1952764987945557, 0.9640331268310547, 0.4933117628097534, 0.2554941177368164, 0.9245699644088745, 0.8926339149475098, 0.298877477645874], "mean_td_error": 0.8732463717460632, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 908.173712404373, "num_env_steps_trained_throughput_per_sec": 261.5053770092949, "timesteps_total": 68992, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 206976, "timers": {"training_iteration_time_ms": 981.437, "sample_time_ms": 678.261, "load_time_ms": 0.313, "load_throughput": 824543.151, "learn_time_ms": 18.446, "learn_throughput": 13987.085, "synch_weights_time_ms": 9.758}, "counters": {"num_env_steps_sampled": 68992, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 206976, "num_agent_steps_trained": 19608, "last_target_update_ts": 68992, "num_target_updates": 76}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-56", "timestamp": 1700369876, "time_this_iter_s": 1.982428789138794, "time_total_s": 79.97046041488647, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.97046041488647, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 66.36666666666667, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.15234375, "actor_loss": -8.902480125427246, "critic_loss": 0.24374035000801086, "alpha_loss": -0.23156856000423431, "alpha_value": 0.9774488210678101, "log_alpha_value": -0.02280936948955059, "target_entropy": -6.0, "policy_t": 0.0040420652367174625, "mean_q": 4.986345291137695, "max_q": 10.100227355957031, "min_q": 4.126211643218994}, "td_error": [0.13585710525512695, 2.535867929458618, 0.9809110164642334, 0.5760669708251953, 1.9020352363586426, 1.228057861328125, 0.4886131286621094, 0.757664680480957, 1.2129197120666504, 0.8192822933197021, 1.1812427043914795, 0.8181214332580566, 1.236332654953003, 0.4358501434326172, 0.07810139656066895, 1.4460244178771973, 2.3041880130767822, 0.9037683010101318, 0.5369668006896973, 1.480398178100586, 0.46755218505859375, 0.8927669525146484, 0.8679542541503906, 1.4884254932403564, 0.6977217197418213, 0.25058984756469727, 0.4479660987854004, 0.07231473922729492, 0.058595895767211914, 0.6260273456573486, 0.22370147705078125, 0.8385930061340332, 0.5756320953369141, 3.763760566711426, 2.4338181018829346, 0.9122169017791748, 1.6542270183563232, 0.9868259429931641, 0.8427386283874512, 0.15717411041259766, 0.1791081428527832, 0.32592248916625977, 0.5022225379943848, 0.11370325088500977, 1.193800687789917, 0.8201885223388672, 0.6707355976104736, 1.3031604290008545, 1.0639984607696533, 1.001199722290039, 0.8079700469970703, 1.874709129333496, 0.6231653690338135, 1.2513771057128906, 0.47159719467163086, 2.1846227645874023, 1.2840862274169922, 0.06014537811279297, 0.05577278137207031, 1.1439805030822754, 0.38779139518737793, 1.3434889316558838, 2.0509350299835205, 0.326479434967041, 0.7383859157562256, 0.28650450706481934, 1.251466989517212, 0.9246578216552734, 1.6890840530395508, 1.2876811027526855, 1.3712544441223145, 0.4213290214538574, 4.394532203674316, 1.831191062927246, 0.4885439872741699, 1.382838249206543, 1.353376865386963, 0.7583041191101074, 0.8502874374389648, 0.7130105495452881, 0.8874268531799316, 0.5812342166900635, 0.7994883060455322, 1.5887973308563232, 2.2592966556549072, 0.9604663848876953], "mean_td_error": 1.0136765241622925, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027633666992188, "actor_loss": -6.908228874206543, "critic_loss": 0.1342286318540573, "alpha_loss": -0.22851453721523285, "alpha_value": 0.9774692058563232, "log_alpha_value": -0.022788479924201965, "target_entropy": -6.0, "policy_t": -0.04171616956591606, "mean_q": 2.8171989917755127, "max_q": 2.973511219024658, "min_q": 2.0153748989105225}, "td_error": [0.8781136274337769, 0.4292769432067871, 0.5488628149032593, 0.03512978553771973, 1.2037220001220703, 0.338961124420166, 0.6307229995727539, 1.6986442804336548, 0.609514594078064, 0.05914449691772461, 0.43728840351104736, 3.23360538482666, 1.7566070556640625, 0.029430389404296875, 1.7386916875839233, 0.2033594846725464, 3.1557416915893555, 1.6363261938095093, 0.6855826377868652, 0.007141828536987305, 0.4382263422012329, 0.760712742805481, 0.9117342233657837, 1.2244141101837158, 0.14009809494018555, 1.5595520734786987, 0.2619354724884033, 1.3324511051177979, 1.2151851654052734, 1.7133064270019531, 1.1408522129058838, 2.600837230682373, 0.9835413694381714, 0.8051453828811646, 0.5044890642166138, 0.914176344871521, 0.451371431350708, 0.5051602125167847, 1.6074347496032715, 2.4907429218292236, 0.37437963485717773, 1.162654995918274, 1.298349142074585, 1.180953025817871, 0.5999710559844971, 0.002934694290161133, 1.6563899517059326, 0.6673465967178345, 0.784083366394043, 0.6905151605606079, 2.210686206817627, 1.9393037557601929, 1.0875024795532227, 0.47129762172698975, 1.401719093322754, 0.6715943813323975, 0.8142220973968506, 2.043311595916748, 0.2296745777130127, 0.8105636835098267, 2.723614454269409, 1.0069431066513062, 1.929309606552124, 0.30731630325317383, 0.2915412187576294, 0.4509153366088867, 1.8808625936508179, 1.3598761558532715, 0.41502058506011963, 0.5565547943115234, 5.034662246704102, 0.8375972509384155, 0.1867741346359253, 0.3152449131011963, 0.8653205633163452, 0.4472463130950928, 0.4616926908493042, 0.2182474136352539, 1.5848151445388794, 1.817171573638916, 1.2345448732376099, 0.5252586603164673, 0.4279601573944092, 0.5730069875717163, 0.42158234119415283, 0.6086646318435669], "mean_td_error": 1.0169353485107422, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084898948669434, "actor_loss": -6.927944660186768, "critic_loss": 0.11442864686250687, "alpha_loss": -0.22998040914535522, "alpha_value": 0.9774536490440369, "log_alpha_value": -0.02280443347990513, "target_entropy": -6.0, "policy_t": -0.05027453601360321, "mean_q": 2.7906553745269775, "max_q": 3.0653083324432373, "min_q": 2.0876598358154297}, "td_error": [1.0304912328720093, 0.2672765254974365, 0.03670060634613037, 0.1583108901977539, 1.2999080419540405, 1.363779067993164, 2.5304155349731445, 0.7701822519302368, 0.13856148719787598, 0.6578494310379028, 0.7263489961624146, 1.86265230178833, 0.03559243679046631, 0.22951090335845947, 1.3356422185897827, 0.45551419258117676, 0.919758677482605, 0.041947245597839355, 0.8334122896194458, 0.8746615648269653, 0.7171941995620728, 0.5364009141921997, 0.6213186979293823, 0.3905632495880127, 1.2304164171218872, 1.3023226261138916, 1.1422070264816284, 1.55848228931427, 1.5960783958435059, 1.2062783241271973, 1.4096320867538452, 0.13693642616271973, 1.1143890619277954, 0.7772228717803955, 0.2856016159057617, 0.797614336013794, 0.7575505971908569, 0.8204530477523804, 2.700941324234009, 0.07047379016876221, 0.18224352598190308, 0.10933876037597656, 1.0368293523788452, 0.16992151737213135, 1.0288325548171997, 0.7509578466415405, 0.6362338066101074, 0.8754050731658936, 0.9692519903182983, 0.5809946060180664, 0.7652822732925415, 0.3193662166595459, 0.9188355207443237, 0.7386163473129272, 0.646685004234314, 1.065384864807129, 2.2221710681915283, 0.12809991836547852, 1.0736422538757324, 0.08822739124298096, 1.2256438732147217, 3.50691819190979, 1.435869812965393, 1.848737359046936, 0.08610081672668457, 1.2703965902328491, 0.20929193496704102, 0.4652087688446045, 0.3764519691467285, 0.9247498512268066, 1.5654280185699463, 0.5544182062149048, 1.005467176437378, 0.7683666944503784, 0.03641033172607422, 0.5360865592956543, 1.147221565246582, 0.1486729383468628, 0.7629948854446411, 1.2696162462234497, 0.17809438705444336, 1.3191341161727905, 0.24845600128173828, 0.03268313407897949, 0.25653839111328125, 0.33084869384765625], "mean_td_error": 0.8204270005226135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 792.6123973801015, "num_env_steps_trained_throughput_per_sec": 228.22990906703814, "timesteps_total": 69888, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 209664, "timers": {"training_iteration_time_ms": 1001.173, "sample_time_ms": 698.886, "load_time_ms": 0.313, "load_throughput": 823915.359, "learn_time_ms": 18.44, "learn_throughput": 13991.064, "synch_weights_time_ms": 9.837}, "counters": {"num_env_steps_sampled": 69888, "num_env_steps_trained": 19866, "num_agent_steps_sampled": 209664, "num_agent_steps_trained": 19866, "last_target_update_ts": 69888, "num_target_updates": 77}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-57", "timestamp": 1700369877, "time_this_iter_s": 1.138974905014038, "time_total_s": 81.10943531990051, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b94e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 81.10943531990051, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 80.5, "ram_util_percent": 66.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072049140930176, "actor_loss": -8.885394096374512, "critic_loss": 0.21603159606456757, "alpha_loss": -0.23275738954544067, "alpha_value": 0.9771557450294495, "log_alpha_value": -0.023109236732125282, "target_entropy": -6.0, "policy_t": 0.014878520742058754, "mean_q": 4.839485168457031, "max_q": 5.423016548156738, "min_q": 4.119565010070801}, "td_error": [0.5295212268829346, 3.798574686050415, 1.5732927322387695, 0.32817673683166504, 0.8187565803527832, 1.6292784214019775, 0.08048629760742188, 0.7312805652618408, 0.2773854732513428, 0.7092204093933105, 2.0174522399902344, 1.280848741531372, 1.1228132247924805, 2.25008487701416, 0.9011235237121582, 0.4076683521270752, 0.8311617374420166, 0.29199862480163574, 0.200606107711792, 1.0327696800231934, 0.1892833709716797, 1.3531203269958496, 0.20143532752990723, 0.6445610523223877, 2.215561628341675, 0.7948026657104492, 0.4043591022491455, 0.13588428497314453, 0.3717801570892334, 1.596898078918457, 1.7069203853607178, 0.3029351234436035, 0.863839864730835, 0.43204164505004883, 0.050537824630737305, 0.9480266571044922, 1.3368122577667236, 1.0282104015350342, 1.2176704406738281, 0.5860695838928223, 1.842561960220337, 0.6449325084686279, 0.5535092353820801, 1.3744761943817139, 0.450131893157959, 1.0050004720687866, 0.49112868309020996, 2.032602548599243, 0.37390756607055664, 0.5455307960510254, 0.2925281524658203, 0.37198805809020996, 0.5377094745635986, 0.6807458400726318, 0.07470417022705078, 1.5939741134643555, 1.5881247520446777, 0.03092336654663086, 1.1303973197937012, 0.1007380485534668, 0.7772684097290039, 0.5579190254211426, 0.2022402286529541, 0.810584306716919, 0.6704957485198975, 0.23096013069152832, 0.5956220626831055, 0.4964118003845215, 0.22530627250671387, 1.5866425037384033, 0.22063946723937988, 0.1170501708984375, 2.368429660797119, 2.120448589324951, 1.436457872390747, 0.7699862718582153, 1.2900655269622803, 1.6155614852905273, 1.4822285175323486, 0.2679929733276367, 0.4796900749206543, 0.43438148498535156, 1.7777013778686523, 1.476794719696045, 0.6812243461608887, 0.46568942070007324], "mean_td_error": 0.8844960331916809, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.984403610229492, "actor_loss": -6.882716655731201, "critic_loss": 0.09156960248947144, "alpha_loss": -0.23051437735557556, "alpha_value": 0.9771770238876343, "log_alpha_value": -0.02308744564652443, "target_entropy": -6.0, "policy_t": -0.08115717023611069, "mean_q": 2.8369758129119873, "max_q": 2.962250232696533, "min_q": 1.9752204418182373}, "td_error": [0.24474167823791504, 0.3510345220565796, 0.16324174404144287, 0.5504646301269531, 0.4222555160522461, 1.2264152765274048, 1.5350689888000488, 1.2927813529968262, 0.2565650939941406, 1.6938449144363403, 0.9633588790893555, 1.1550230979919434, 0.7877150774002075, 1.0600900650024414, 0.7716529369354248, 0.18811511993408203, 0.22953248023986816, 0.4785640239715576, 0.10555732250213623, 1.0576574802398682, 1.4143716096878052, 0.836222767829895, 1.4563301801681519, 1.6234222650527954, 1.5466816425323486, 0.3836483955383301, 0.10977017879486084, 2.6922130584716797, 0.481939435005188, 0.7846949100494385, 0.9215877056121826, 0.7231775522232056, 0.8007856607437134, 0.2055426836013794, 0.13692015409469604, 0.4585258960723877, 1.861580491065979, 0.7458698749542236, 1.3218029737472534, 1.2156685590744019, 0.03267788887023926, 0.37959718704223633, 0.27776026725769043, 0.5090872049331665, 0.4950382709503174, 0.4281005859375, 0.03851652145385742, 2.0770535469055176, 0.4914466142654419, 1.358194351196289, 0.7278487682342529, 0.34450650215148926, 1.0173860788345337, 1.4145349264144897, 0.2847750186920166, 0.8097290992736816, 1.4686003923416138, 0.22308409214019775, 0.49765801429748535, 0.07804703712463379, 0.0773383378982544, 1.3718935251235962, 0.4422276020050049, 0.6891306638717651, 0.7331463098526001, 0.5531045198440552, 0.7204660177230835, 1.2758674621582031, 1.4116342067718506, 0.8361239433288574, 2.0951504707336426, 0.09167659282684326, 1.0994651317596436, 0.8350179195404053, 1.169539213180542, 0.8497614860534668, 0.4150484800338745, 0.4257352352142334, 0.10843276977539062, 0.47524797916412354, 2.178823471069336, 1.4276989698410034, 0.003649473190307617, 0.2660166025161743, 1.2064452171325684, 0.634050726890564], "mean_td_error": 0.7976833581924438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11475658416748, "actor_loss": -6.939173698425293, "critic_loss": 0.12910893559455872, "alpha_loss": -0.23369239270687103, "alpha_value": 0.9771607518196106, "log_alpha_value": -0.0231041070073843, "target_entropy": -6.0, "policy_t": -0.047555018216371536, "mean_q": 2.769315481185913, "max_q": 2.893946409225464, "min_q": 2.096928119659424}, "td_error": [1.123069405555725, 0.22882652282714844, 2.2954940795898438, 1.3749665021896362, 1.4992109537124634, 0.907275915145874, 0.9451686143875122, 0.3276749849319458, 0.594502329826355, 0.9360800981521606, 0.04860997200012207, 0.20350241661071777, 1.7688008546829224, 0.11878836154937744, 0.6896666884422302, 0.661379337310791, 0.4319559335708618, 0.2732948064804077, 0.12156963348388672, 1.7470998764038086, 0.26574063301086426, 0.5716944932937622, 0.30618298053741455, 0.34702014923095703, 1.6880232095718384, 1.921270489692688, 0.5500220060348511, 0.39458465576171875, 0.15324068069458008, 1.7260488271713257, 0.9609163999557495, 1.15614914894104, 0.3418203592300415, 0.39545738697052, 0.5322349071502686, 0.8508599996566772, 0.794440507888794, 0.6749823093414307, 0.5446871519088745, 0.7370094060897827, 1.7080674171447754, 1.035722255706787, 1.4788389205932617, 0.07075238227844238, 3.7475123405456543, 0.42469239234924316, 2.641627311706543, 0.18309485912322998, 0.8575278520584106, 1.4398510456085205, 3.369751453399658, 0.6703211069107056, 0.1142423152923584, 1.3519842624664307, 0.06916344165802002, 1.5227304697036743, 0.9083212614059448, 0.46372854709625244, 0.9715102910995483, 1.4853143692016602, 0.15174686908721924, 1.0642509460449219, 0.16098344326019287, 0.44527316093444824, 1.614877700805664, 0.6691892147064209, 0.038512349128723145, 1.4276055097579956, 1.3421905040740967, 0.8361001014709473, 0.7780954837799072, 0.12826812267303467, 0.3059779405593872, 1.5060694217681885, 0.5954426527023315, 0.9156507253646851, 1.454408049583435, 1.787969946861267, 0.06180012226104736, 1.6081291437149048, 0.24844574928283691, 0.6819406747817993, 0.5688626766204834, 0.34640777111053467, 1.8160065412521362, 0.09375834465026855], "mean_td_error": 0.8880469799041748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 877.0967358274792, "num_env_steps_trained_throughput_per_sec": 252.55687259318037, "timesteps_total": 70784, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 212352, "timers": {"training_iteration_time_ms": 974.568, "sample_time_ms": 704.268, "load_time_ms": 0.314, "load_throughput": 820790.68, "learn_time_ms": 18.466, "learn_throughput": 13971.338, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 70784, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 212352, "num_agent_steps_trained": 20124, "last_target_update_ts": 70784, "num_target_updates": 78}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "fedad_00000", "date": "2023-11-18_20-57-58", "timestamp": 1700369878, "time_this_iter_s": 1.0308499336242676, "time_total_s": 82.14028525352478, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317721440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 82.14028525352478, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 68.3, "ram_util_percent": 66.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073443412780762, "actor_loss": -8.997551918029785, "critic_loss": 0.23317834734916687, "alpha_loss": -0.2358100861310959, "alpha_value": 0.9768627882003784, "log_alpha_value": -0.023409085348248482, "target_entropy": -6.0, "policy_t": -0.05814407020807266, "mean_q": 4.938803672790527, "max_q": 9.386211395263672, "min_q": 4.104730129241943}, "td_error": [0.8206977844238281, 0.49125146865844727, 0.638190507888794, 1.35988450050354, 1.1130452156066895, 0.7368543148040771, 0.14231586456298828, 1.420361042022705, 2.5469930171966553, 1.782651662826538, 0.719165563583374, 1.0964033603668213, 1.9254815578460693, 0.04243016242980957, 0.1420884132385254, 0.8695297241210938, 1.0647168159484863, 2.351912498474121, 1.6302440166473389, 3.3978660106658936, 0.28133225440979004, 0.8204092979431152, 0.7710027694702148, 1.7818210124969482, 0.9398479461669922, 0.6228773593902588, 0.020644187927246094, 0.5572373867034912, 0.34398531913757324, 1.2764778137207031, 0.756493091583252, 0.9223008155822754, 0.5102906227111816, 0.14661264419555664, 1.61714506149292, 0.7276418209075928, 0.38074350357055664, 1.5785882472991943, 0.464907169342041, 0.5469458103179932, 0.3077077865600586, 1.9609730243682861, 1.3517026901245117, 0.3672144412994385, 0.08050870895385742, 1.1159460544586182, 1.7993252277374268, 1.9228429794311523, 1.613898515701294, 0.6619853973388672, 0.6912946701049805, 0.250946044921875, 1.7822442054748535, 0.43554091453552246, 0.0870058536529541, 0.27384185791015625, 0.5356886386871338, 1.321707010269165, 1.539161205291748, 0.8992724418640137, 0.20735645294189453, 0.43260812759399414, 0.12554025650024414, 0.978550910949707, 0.06747031211853027, 1.2833571434020996, 1.456892967224121, 1.7247414588928223, 0.14281606674194336, 1.36643648147583, 0.019566774368286133, 1.7007744312286377, 0.5021395683288574, 0.5779054164886475, 0.19814085960388184, 0.261322021484375, 0.3928196430206299, 0.854527473449707, 1.4726574420928955, 0.4990100860595703, 2.228665590286255, 1.0731618404388428, 2.1992380619049072, 0.5964090824127197, 0.03785061836242676, 1.2792245149612427], "mean_td_error": 0.9306671619415283, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.012842178344727, "actor_loss": -6.90977144241333, "critic_loss": 0.09452970325946808, "alpha_loss": -0.23416297137737274, "alpha_value": 0.9768850803375244, "log_alpha_value": -0.023386262357234955, "target_entropy": -6.0, "policy_t": -0.09991434961557388, "mean_q": 2.8045876026153564, "max_q": 2.948376178741455, "min_q": 1.9779906272888184}, "td_error": [0.3227158784866333, 0.6473792791366577, 0.30956315994262695, 0.6953915357589722, 0.320145845413208, 0.8044852018356323, 1.7649497985839844, 0.37336552143096924, 0.2739189863204956, 2.045166492462158, 1.3025108575820923, 0.9230525493621826, 0.12175178527832031, 0.1354454755783081, 0.2570720911026001, 0.4650081396102905, 0.8539707660675049, 1.501778483390808, 0.913011908531189, 1.4880014657974243, 2.318121910095215, 0.1615508794784546, 0.8906111717224121, 1.7398592233657837, 1.1631821393966675, 0.47049713134765625, 0.04222381114959717, 0.16759157180786133, 1.3056509494781494, 0.47051918506622314, 0.7330248355865479, 1.7067394256591797, 1.4453792572021484, 0.10096085071563721, 1.0303572416305542, 1.4019137620925903, 1.6788818836212158, 0.9451010227203369, 1.3171172142028809, 0.10463201999664307, 0.3817558288574219, 0.8885042667388916, 0.08881664276123047, 0.49560344219207764, 1.9084757566452026, 0.21827661991119385, 1.195372462272644, 0.29341185092926025, 0.9999984502792358, 0.34004390239715576, 0.12712347507476807, 0.3178948163986206, 0.42316174507141113, 0.9943127632141113, 0.6754212379455566, 0.5142539739608765, 0.2670975923538208, 0.26084160804748535, 0.5585681200027466, 0.5068142414093018, 0.6463253498077393, 0.5231300592422485, 1.8599998950958252, 1.7873674631118774, 0.35565829277038574, 0.42256367206573486, 2.2673897743225098, 0.20180583000183105, 1.1712042093276978, 0.5968140363693237, 1.8297089338302612, 0.6546051502227783, 0.35295164585113525, 1.0069559812545776, 0.8043007850646973, 0.849333643913269, 0.8382797241210938, 1.2269816398620605, 1.9410285949707031, 0.6881131529808044, 0.05283975601196289, 1.288582444190979, 0.919044017791748, 0.18841338157653809, 0.5091648101806641, 0.4826393127441406], "mean_td_error": 0.8096924424171448, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059006690979004, "actor_loss": -6.8652024269104, "critic_loss": 0.12059450149536133, "alpha_loss": -0.2354196459054947, "alpha_value": 0.9768678545951843, "log_alpha_value": -0.023403868079185486, "target_entropy": -6.0, "policy_t": -0.04899052157998085, "mean_q": 2.7297704219818115, "max_q": 2.8742525577545166, "min_q": 1.9890022277832031}, "td_error": [0.4955906867980957, 1.6223865747451782, 0.7686412334442139, 0.8429422378540039, 1.4103659391403198, 1.0396181344985962, 0.867220401763916, 1.1968693733215332, 0.6087424755096436, 1.8686203956604004, 0.1748892068862915, 0.29411184787750244, 0.5075562000274658, 1.2359611988067627, 2.2405433654785156, 0.07834446430206299, 0.4847598075866699, 0.46338653564453125, 0.14020323753356934, 0.7765944004058838, 0.903800368309021, 1.0159399509429932, 2.0039262771606445, 0.2474050521850586, 0.08326554298400879, 1.088468074798584, 0.31708741188049316, 0.27986347675323486, 1.319601058959961, 0.9756615161895752, 0.04571866989135742, 1.9101701974868774, 0.11222386360168457, 1.341222882270813, 1.6038106679916382, 0.05646097660064697, 0.36083555221557617, 1.023771047592163, 1.789907693862915, 0.1414555311203003, 0.19805908203125, 0.584640622138977, 0.561923623085022, 1.302155613899231, 2.0137996673583984, 1.4422513246536255, 1.240934133529663, 0.6184976100921631, 0.19058525562286377, 1.0352210998535156, 1.203231930732727, 2.0800604820251465, 0.2892395257949829, 0.9735146760940552, 1.4738991260528564, 0.5956196784973145, 0.8491908311843872, 0.03551292419433594, 0.22051715850830078, 1.698730230331421, 0.8461110591888428, 0.5042792558670044, 0.7408677339553833, 4.150256156921387, 1.0284619331359863, 0.9529831409454346, 1.4718918800354004, 0.1990654468536377, 1.1311286687850952, 0.16052007675170898, 0.7881259918212891, 0.2746701240539551, 0.7044088840484619, 0.1782214641571045, 0.7989509105682373, 0.6064542531967163, 0.5930929183959961, 0.518675684928894, 0.5022335052490234, 0.3436112403869629, 0.2808150053024292, 0.6051241159439087, 0.23453259468078613, 1.1768172979354858, 0.9740091562271118, 0.5215860605239868], "mean_td_error": 0.8445630669593811, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 774.0257749327534, "num_env_steps_trained_throughput_per_sec": 222.87795751411872, "timesteps_total": 71680, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 1007.81, "sample_time_ms": 734.679, "load_time_ms": 0.316, "load_throughput": 816640.58, "learn_time_ms": 18.613, "learn_throughput": 13860.992, "synch_weights_time_ms": 10.173}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 20382, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 20382, "last_target_update_ts": 71680, "num_target_updates": 79}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-00", "timestamp": 1700369880, "time_this_iter_s": 1.1685459613800049, "time_total_s": 83.30883121490479, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b9f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.30883121490479, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 76.8, "ram_util_percent": 67.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.99741268157959, "actor_loss": -8.967273712158203, "critic_loss": 0.19604572653770447, "alpha_loss": -0.2370278537273407, "alpha_value": 0.9765699505805969, "log_alpha_value": -0.023708920925855637, "target_entropy": -6.0, "policy_t": -0.10554288327693939, "mean_q": 5.055716514587402, "max_q": 9.045174598693848, "min_q": 4.588173866271973}, "td_error": [0.8205428123474121, 0.20661401748657227, 0.7832112312316895, 0.612717866897583, 0.35238146781921387, 1.4013404846191406, 0.27091455459594727, 0.7146987915039062, 0.6384975910186768, 1.056769847869873, 0.8032946586608887, 0.9296815395355225, 0.9448869228363037, 0.36734724044799805, 0.29166722297668457, 0.6643352508544922, 0.28573083877563477, 0.7003908157348633, 0.09305071830749512, 0.07201385498046875, 0.25290727615356445, 0.015027761459350586, 0.3100929260253906, 0.3661673069000244, 1.6896367073059082, 0.1940925121307373, 1.8131585121154785, 0.5925271511077881, 2.072291851043701, 0.7249293327331543, 0.5740242004394531, 0.14554309844970703, 1.119239091873169, 0.23167991638183594, 0.43172168731689453, 1.2589867115020752, 0.6208682060241699, 1.7085466384887695, 0.47817182540893555, 1.2871119976043701, 1.8364582061767578, 1.1112244129180908, 1.3069560527801514, 0.016242504119873047, 0.331484317779541, 2.2017011642456055, 0.6380276679992676, 0.8433511257171631, 3.107328176498413, 1.5206294059753418, 1.430708885192871, 1.214937686920166, 0.19315791130065918, 0.7076847553253174, 0.019249439239501953, 0.22437715530395508, 0.359311580657959, 0.07769584655761719, 0.17085766792297363, 1.1683871746063232, 1.5409257411956787, 1.6226608753204346, 0.7131876945495605, 1.2438437938690186, 1.936872959136963, 0.8448090553283691, 0.17041492462158203, 1.5092124938964844, 0.08461713790893555, 0.3632023334503174, 0.8486254215240479, 0.8821241855621338, 0.03610563278198242, 1.625800371170044, 4.276304244995117, 1.1071667671203613, 0.4347233772277832, 4.07092809677124, 0.7329263687133789, 0.5454716682434082, 0.847350001335144, 0.32286715507507324, 2.1472229957580566, 0.03888440132141113, 0.6108295917510986, 1.9564645290374756], "mean_td_error": 0.894071102142334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100842475891113, "actor_loss": -6.8993048667907715, "critic_loss": 0.09892979264259338, "alpha_loss": -0.2392386794090271, "alpha_value": 0.9765932559967041, "log_alpha_value": -0.023685021325945854, "target_entropy": -6.0, "policy_t": -0.04916933923959732, "mean_q": 2.820725202560425, "max_q": 2.9365663528442383, "min_q": 2.0203022956848145}, "td_error": [0.32616615295410156, 0.4020857810974121, 0.8308026790618896, 1.7363229990005493, 0.4176623821258545, 0.09293651580810547, 0.3393288850784302, 0.4830397367477417, 1.2910856008529663, 1.601251244544983, 0.43517518043518066, 1.2677255868911743, 2.150066375732422, 0.677665114402771, 0.2890160083770752, 0.01745760440826416, 1.0637074708938599, 0.1711653470993042, 1.3796019554138184, 0.17313790321350098, 0.5801173448562622, 0.36113667488098145, 1.5476360321044922, 0.9540528059005737, 0.15163445472717285, 1.7235578298568726, 1.4998676776885986, 0.7544127702713013, 1.4111332893371582, 0.5050896406173706, 0.593071460723877, 1.0084487199783325, 0.6532572507858276, 0.022244572639465332, 0.6481229066848755, 0.04439878463745117, 0.7704720497131348, 0.750251293182373, 0.17148613929748535, 0.929039716720581, 0.6156005859375, 0.43553948402404785, 1.8736392259597778, 0.2945288419723511, 0.7101877927780151, 1.8874565362930298, 0.04055213928222656, 1.3232277631759644, 0.14654982089996338, 1.7950694561004639, 1.3399677276611328, 1.7030677795410156, 0.7265843152999878, 0.49112462997436523, 0.8697763681411743, 0.4436502456665039, 1.268783688545227, 1.8923664093017578, 0.5105717182159424, 1.0940988063812256, 0.5738345384597778, 0.5312856435775757, 1.723289966583252, 1.1360499858856201, 0.8167366981506348, 0.796454668045044, 1.0112851858139038, 0.13900268077850342, 1.3244705200195312, 1.1842498779296875, 2.289393424987793, 0.3521296977996826, 0.05876505374908447, 0.20898401737213135, 1.136739730834961, 1.331536054611206, 0.2852226495742798, 0.736979603767395, 0.6174671649932861, 1.2868226766586304, 0.9805715084075928, 0.532091498374939, 1.3560465574264526, 0.13173556327819824, 1.7368515729904175, 0.07135820388793945], "mean_td_error": 0.8376341462135315, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035856246948242, "actor_loss": -6.826162815093994, "critic_loss": 0.12660835683345795, "alpha_loss": -0.23788557946681976, "alpha_value": 0.9765751361846924, "log_alpha_value": -0.02370356395840645, "target_entropy": -6.0, "policy_t": -0.06209545582532883, "mean_q": 2.6928870677948, "max_q": 2.849332809448242, "min_q": 1.936998724937439}, "td_error": [0.47426366806030273, 0.05686342716217041, 0.27722597122192383, 0.6178299188613892, 0.8287152051925659, 1.8062562942504883, 0.6913232803344727, 1.5587859153747559, 2.7939870357513428, 0.47786474227905273, 0.13152599334716797, 0.13063526153564453, 0.15027546882629395, 0.11167037487030029, 1.4571125507354736, 0.14085865020751953, 0.9327859878540039, 0.6065822839736938, 0.9270150661468506, 0.7994610071182251, 1.788111686706543, 0.07421112060546875, 0.08310329914093018, 0.4551973342895508, 1.3169445991516113, 0.22273707389831543, 0.26194727420806885, 0.474997878074646, 2.5511326789855957, 0.8325165510177612, 0.2872617244720459, 0.9596396684646606, 0.7283823490142822, 1.069954514503479, 1.1870131492614746, 0.953690767288208, 0.9588133096694946, 0.5102561712265015, 0.13284778594970703, 1.1624315977096558, 0.10258495807647705, 0.9474598169326782, 0.9159834384918213, 0.8365633487701416, 0.8264871835708618, 0.26293134689331055, 0.6042081117630005, 1.5651464462280273, 0.9069639444351196, 0.7555205821990967, 2.7584004402160645, 1.2386233806610107, 0.5413568019866943, 0.3085535764694214, 3.1052377223968506, 1.1396701335906982, 0.6381866931915283, 0.24524521827697754, 1.3723089694976807, 1.7095656394958496, 1.0344730615615845, 0.8892362117767334, 0.17900371551513672, 0.19490587711334229, 0.1846233606338501, 0.05175888538360596, 0.6318848133087158, 0.13454318046569824, 0.35286033153533936, 0.9163124561309814, 0.4945487976074219, 0.5081208944320679, 0.8916870355606079, 1.266524314880371, 0.23260831832885742, 1.0209746360778809, 2.06658935546875, 3.363908290863037, 0.48890113830566406, 0.8665145635604858, 0.6942912340164185, 0.12090623378753662, 0.4530874490737915, 4.0689473152160645, 1.2190593481063843, 0.608232855796814], "mean_td_error": 0.8685781955718994, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}}, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 641.6169945265908, "num_env_steps_trained_throughput_per_sec": 184.75132208466567, "timesteps_total": 72576, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 217728, "timers": {"training_iteration_time_ms": 1050.566, "sample_time_ms": 776.557, "load_time_ms": 0.316, "load_throughput": 816086.299, "learn_time_ms": 18.706, "learn_throughput": 13792.393, "synch_weights_time_ms": 10.189}, "counters": {"num_env_steps_sampled": 72576, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 217728, "num_agent_steps_trained": 20640, "last_target_update_ts": 72576, "num_target_updates": 80}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-01", "timestamp": 1700369881, "time_this_iter_s": 1.4064059257507324, "time_total_s": 84.71523714065552, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177bb100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 84.71523714065552, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 74.69999999999999, "ram_util_percent": 67.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.988630294799805, "actor_loss": -8.876266479492188, "critic_loss": 0.16172295808792114, "alpha_loss": -0.23981252312660217, "alpha_value": 0.9762773513793945, "log_alpha_value": -0.024008547887206078, "target_entropy": -6.0, "policy_t": -0.06369566172361374, "mean_q": 5.02479362487793, "max_q": 8.627613067626953, "min_q": 4.85169792175293}, "td_error": [0.23146295547485352, 1.3379886150360107, 1.4733490943908691, 0.7686748504638672, 0.5452375411987305, 0.012233734130859375, 0.40398478507995605, 1.2697563171386719, 0.6300995349884033, 0.1313495635986328, 0.3217790126800537, 0.23562979698181152, 1.0956311225891113, 0.6284604072570801, 0.04706096649169922, 3.6843466758728027, 0.44070935249328613, 0.1340324878692627, 0.19257116317749023, 1.964721441268921, 1.2745118141174316, 2.285130023956299, 2.8191261291503906, 1.7063202857971191, 2.551571846008301, 1.174394130706787, 1.7093331813812256, 0.7566871643066406, 0.9278111457824707, 1.8069097995758057, 0.7849135398864746, 1.9225342273712158, 0.05247998237609863, 0.11195659637451172, 1.414994239807129, 0.5262680053710938, 0.056540727615356445, 0.37174391746520996, 0.33836865425109863, 1.4649579524993896, 0.7381880283355713, 0.8920867443084717, 0.7101728916168213, 0.4575810432434082, 1.3926081657409668, 1.2116217613220215, 1.6259574890136719, 0.9548959732055664, 0.5391750335693359, 0.6908321380615234, 0.9472661018371582, 0.671215295791626, 0.2483513355255127, 0.44621729850769043, 1.531249761581421, 1.476325511932373, 0.30896496772766113, 0.19264912605285645, 0.8638696670532227, 0.6260309219360352, 0.7823524475097656, 0.5644063949584961, 1.0373249053955078, 1.1551826000213623, 0.06397414207458496, 0.7895302772521973, 1.5062525272369385, 0.7093796730041504, 0.9831490516662598, 0.4545431137084961, 1.5606133937835693, 0.5208244323730469, 0.17404532432556152, 1.454942226409912, 0.7483463287353516, 1.094010591506958, 0.7845828533172607, 0.6157913208007812, 0.38086581230163574, 0.3691112995147705, 0.25872039794921875, 0.96358323097229, 0.1680772304534912, 0.19320178031921387, 0.14524412155151367, 0.28283166885375977], "mean_td_error": 0.8592067360877991, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.930209159851074, "actor_loss": -6.822265625, "critic_loss": 0.08451740443706512, "alpha_loss": -0.2381657063961029, "alpha_value": 0.976301372051239, "log_alpha_value": -0.02398395724594593, "target_entropy": -6.0, "policy_t": -0.10458992421627045, "mean_q": 2.7987520694732666, "max_q": 2.922184467315674, "min_q": 2.008699893951416}, "td_error": [0.17965435981750488, 1.0162034034729004, 0.6843843460083008, 0.18307769298553467, 0.5305440425872803, 1.2629361152648926, 0.5468764305114746, 0.12677514553070068, 0.4637356996536255, 0.606559157371521, 0.6279506683349609, 0.19094300270080566, 0.8410887718200684, 0.4598422050476074, 0.7091461420059204, 0.44491517543792725, 1.0851750373840332, 0.38334572315216064, 0.8617712259292603, 0.05494213104248047, 0.5297822952270508, 0.06235027313232422, 0.09884417057037354, 1.267848014831543, 1.7835264205932617, 0.9177567958831787, 0.4940425157546997, 0.5546157360076904, 0.8065706491470337, 1.5031416416168213, 1.2582077980041504, 0.1788010597229004, 1.1026201248168945, 1.0416828393936157, 0.6285606622695923, 0.3393975496292114, 1.3146556615829468, 1.204546332359314, 0.9809585809707642, 0.01794600486755371, 0.14569556713104248, 1.5334300994873047, 0.6720187664031982, 0.6847150325775146, 0.2551618814468384, 0.6559779644012451, 0.49958503246307373, 0.015610814094543457, 0.1996145248413086, 0.09232330322265625, 0.029484272003173828, 0.40530264377593994, 2.200312376022339, 0.40081655979156494, 1.520614743232727, 1.875224232673645, 0.4471675157546997, 1.2667601108551025, 0.2402946949005127, 1.8738718032836914, 0.4866964817047119, 1.4386351108551025, 0.9680588245391846, 2.2564594745635986, 0.12833356857299805, 0.40048420429229736, 0.3336927890777588, 2.311549663543701, 1.048387050628662, 0.02998960018157959, 1.3582359552383423, 0.007130622863769531, 0.041913509368896484, 1.0536619424819946, 0.6891946792602539, 2.3264057636260986, 0.5966629981994629, 0.04846692085266113, 0.9332642555236816, 0.9834924936294556, 1.7860913276672363, 0.6206833124160767, 0.13631784915924072, 0.4917689561843872, 1.1662166118621826, 0.34856438636779785], "mean_td_error": 0.748256504535675, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.9732027053833, "actor_loss": -6.752720832824707, "critic_loss": 0.15024390816688538, "alpha_loss": -0.23938818275928497, "alpha_value": 0.9762826561927795, "log_alpha_value": -0.02400314249098301, "target_entropy": -6.0, "policy_t": -0.05108850449323654, "mean_q": 2.6892669200897217, "max_q": 2.8271195888519287, "min_q": 1.9835007190704346}, "td_error": [0.3547859191894531, 0.3579598665237427, 0.2046598196029663, 0.23440766334533691, 1.2990391254425049, 0.46642637252807617, 3.005138874053955, 0.732649564743042, 0.6330394744873047, 0.34702491760253906, 1.3355062007904053, 0.40995585918426514, 0.56862473487854, 0.10932290554046631, 0.989364743232727, 2.349640369415283, 0.6627508401870728, 0.4853886365890503, 0.7501081228256226, 1.1145331859588623, 2.3468546867370605, 0.8566728830337524, 0.6994496583938599, 0.539419412612915, 0.8644596338272095, 1.0774385929107666, 1.099663257598877, 0.05486464500427246, 0.8244107961654663, 0.28872740268707275, 0.1219172477722168, 0.1461855173110962, 1.8942854404449463, 0.054398298263549805, 0.47303736209869385, 1.811130404472351, 2.2777538299560547, 0.952582836151123, 1.2858229875564575, 0.4922841787338257, 0.38922667503356934, 0.5495697259902954, 0.7570905685424805, 2.2279982566833496, 1.1881991624832153, 0.9052274227142334, 0.8682622909545898, 0.4467124938964844, 0.6557670831680298, 0.2481633424758911, 3.8810458183288574, 0.6518733501434326, 1.0312825441360474, 1.083840250968933, 0.5516359806060791, 0.25004398822784424, 1.8260862827301025, 0.10753917694091797, 0.3438291549682617, 1.007400393486023, 0.9848634004592896, 2.876009464263916, 0.8992922306060791, 0.3987247943878174, 1.0658234357833862, 0.8095271587371826, 0.05926060676574707, 1.2249420881271362, 2.111985206604004, 2.136714458465576, 0.15430080890655518, 1.2729897499084473, 0.41564619541168213, 0.2869563698768616, 1.253560185432434, 1.3301633596420288, 3.8606252670288086, 0.9328386783599854, 2.081024408340454, 0.44680798053741455, 0.7047778367996216, 1.4557218551635742, 0.28667140007019043, 1.0282217264175415, 1.2189151048660278, 1.581079363822937], "mean_td_error": 0.9816269874572754, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 795.8212586401462, "num_env_steps_trained_throughput_per_sec": 229.15388920664924, "timesteps_total": 73472, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 220416, "timers": {"training_iteration_time_ms": 1067.727, "sample_time_ms": 792.047, "load_time_ms": 0.315, "load_throughput": 818184.207, "learn_time_ms": 18.668, "learn_throughput": 13820.771, "synch_weights_time_ms": 10.165}, "counters": {"num_env_steps_sampled": 73472, "num_env_steps_trained": 20898, "num_agent_steps_sampled": 220416, "num_agent_steps_trained": 20898, "last_target_update_ts": 73472, "num_target_updates": 81}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-02", "timestamp": 1700369882, "time_this_iter_s": 1.1347582340240479, "time_total_s": 85.84999537467957, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177bb740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.84999537467957, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 79.15, "ram_util_percent": 67.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084317207336426, "actor_loss": -8.982317924499512, "critic_loss": 0.1533297300338745, "alpha_loss": -0.24512925744056702, "alpha_value": 0.9759851098060608, "log_alpha_value": -0.024307966232299805, "target_entropy": -6.0, "policy_t": -0.0903363972902298, "mean_q": 4.918249607086182, "max_q": 8.221857070922852, "min_q": 4.07209587097168}, "td_error": [0.3324105739593506, 0.8179428577423096, 0.3633842468261719, 0.8997988700866699, 0.5824441909790039, 2.390960931777954, 1.71201753616333, 0.26937150955200195, 1.0978693962097168, 0.23733091354370117, 0.8270196914672852, 0.6480040550231934, 0.8716781139373779, 2.2833571434020996, 0.016248703002929688, 1.5581088066101074, 1.0061964988708496, 0.382037878036499, 0.17754340171813965, 0.8083252906799316, 0.7281262874603271, 0.5411925315856934, 0.1111443042755127, 1.0313329696655273, 1.3051798343658447, 0.41824769973754883, 0.33850979804992676, 0.9746417999267578, 0.2047874927520752, 1.5694522857666016, 0.40839195251464844, 1.2507147789001465, 0.4735255241394043, 0.6745729446411133, 0.024814128875732422, 0.6586532592773438, 1.5773844718933105, 0.24744725227355957, 1.3563663959503174, 0.08080554008483887, 1.7634553909301758, 0.5331339836120605, 1.7471814155578613, 2.4712295532226562, 1.6578972339630127, 1.3890774250030518, 2.7398037910461426, 0.4050605297088623, 1.4384026527404785, 0.8217566013336182, 0.859112024307251, 1.2983331680297852, 1.0931639671325684, 0.23125767707824707, 0.7139458656311035, 0.7578251361846924, 1.5276999473571777, 0.01796865463256836, 0.20960330963134766, 0.21450448036193848, 1.8019671440124512, 1.089569330215454, 1.880744457244873, 0.2863798141479492, 0.7112002372741699, 0.15648126602172852, 0.4072847366333008, 0.7679915428161621, 0.5381014347076416, 1.2023940086364746, 0.9241876602172852, 0.33625316619873047, 0.7980427742004395, 1.1608967781066895, 0.9609806537628174, 0.17716169357299805, 0.2973306179046631, 1.5422642230987549, 0.03621792793273926, 1.141502857208252, 0.9426155090332031, 0.23568248748779297, 0.051891326904296875, 1.2868602275848389, 0.4772496223449707, 0.07454657554626465], "mean_td_error": 0.842250645160675, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027338027954102, "actor_loss": -6.807136058807373, "critic_loss": 0.08900897949934006, "alpha_loss": -0.24348995089530945, "alpha_value": 0.9760098457336426, "log_alpha_value": -0.024282610043883324, "target_entropy": -6.0, "policy_t": -0.0623752698302269, "mean_q": 2.7692391872406006, "max_q": 2.906730890274048, "min_q": 2.0321311950683594}, "td_error": [0.8947696685791016, 1.0849995613098145, 1.8282305002212524, 0.01828181743621826, 1.4640861749649048, 0.9152309894561768, 1.7484233379364014, 0.06240200996398926, 0.16481900215148926, 0.5097161531448364, 1.2816946506500244, 0.5442441701889038, 0.045098304748535156, 2.135814666748047, 0.5015161037445068, 2.009319543838501, 0.668380856513977, 1.1131006479263306, 1.5329005718231201, 0.8992955684661865, 1.5174630880355835, 0.5596697330474854, 0.31075799465179443, 1.1903843879699707, 0.7093890905380249, 0.22079086303710938, 0.8408880233764648, 1.1940277814865112, 0.19886207580566406, 0.7929239273071289, 0.6105133295059204, 0.029584288597106934, 0.3939617872238159, 1.523914098739624, 0.04014098644256592, 1.0298596620559692, 0.5801064968109131, 1.5907562971115112, 0.05649924278259277, 1.3760501146316528, 0.42123496532440186, 1.1261870861053467, 0.14325380325317383, 0.0882565975189209, 1.0811660289764404, 0.656876802444458, 0.40303337574005127, 0.177742600440979, 1.2056541442871094, 0.9553108215332031, 0.24144816398620605, 2.2557921409606934, 0.3358759880065918, 0.5704231262207031, 0.7463910579681396, 1.6241540908813477, 0.14510536193847656, 1.9324396848678589, 1.2695401906967163, 0.3184511661529541, 1.489383339881897, 0.4870774745941162, 0.14597737789154053, 0.14370012283325195, 0.0434110164642334, 0.2686753273010254, 0.5945074558258057, 0.45629096031188965, 0.3134424686431885, 0.807822585105896, 0.19329702854156494, 0.2869163751602173, 0.20399296283721924, 0.9720931053161621, 0.21568357944488525, 0.039836764335632324, 1.3030792474746704, 1.3879166841506958, 0.02001321315765381, 1.5864715576171875, 0.599410891532898, 0.8258844614028931, 1.3059139251708984, 0.7934349775314331, 1.0475256443023682, 0.47028040885925293], "mean_td_error": 0.7661541104316711, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086629867553711, "actor_loss": -6.816798210144043, "critic_loss": 0.11470141261816025, "alpha_loss": -0.24512982368469238, "alpha_value": 0.9759904742240906, "log_alpha_value": -0.02430245466530323, "target_entropy": -6.0, "policy_t": -0.08101782947778702, "mean_q": 2.666564702987671, "max_q": 2.8020401000976562, "min_q": 1.8947173357009888}, "td_error": [1.4872384071350098, 0.18537700176239014, 0.45699071884155273, 0.8831638097763062, 1.2426477670669556, 1.1547105312347412, 0.452434778213501, 0.07823920249938965, 0.5079580545425415, 0.049739837646484375, 0.33444201946258545, 1.538968563079834, 0.8002147674560547, 0.5558433532714844, 0.5838521718978882, 0.6618977785110474, 0.33851635456085205, 0.6901546716690063, 0.23514223098754883, 0.7102479934692383, 0.6594440937042236, 0.5382083654403687, 0.07438766956329346, 0.4379599094390869, 1.7009732723236084, 0.7441748380661011, 1.7140686511993408, 0.6408841609954834, 0.3313107490539551, 0.08877944946289062, 0.9661746025085449, 0.3384530544281006, 1.0254944562911987, 0.3450826406478882, 2.277769088745117, 0.178178071975708, 1.9235284328460693, 1.9144972562789917, 0.7791452407836914, 0.6849315166473389, 1.386304497718811, 0.22277450561523438, 0.3051900863647461, 0.08201718330383301, 0.8727158308029175, 2.031679153442383, 1.1023993492126465, 1.7335560321807861, 0.5082577466964722, 0.969743013381958, 1.9242349863052368, 0.6683638095855713, 0.4219566583633423, 0.6811929941177368, 0.6202148199081421, 0.2022247314453125, 0.4803812503814697, 0.35103917121887207, 0.8015847206115723, 0.9932008981704712, 0.6158236265182495, 1.0593678951263428, 0.831368088722229, 0.5239423513412476, 3.74575138092041, 0.8625378608703613, 1.355282187461853, 0.9950001239776611, 0.5917031764984131, 0.6495881080627441, 0.6963726282119751, 0.41831815242767334, 0.861011266708374, 2.1084086894989014, 0.14619076251983643, 0.9379146099090576, 0.2267916202545166, 0.4249376058578491, 2.255204677581787, 1.047776222229004, 0.9867376089096069, 1.6059192419052124, 0.8814953565597534, 0.12862831354141235, 0.6952621936798096, 0.9951300621032715], "mean_td_error": 0.8408920764923096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 876.5932476060498, "num_env_steps_trained_throughput_per_sec": 252.41189495799202, "timesteps_total": 74368, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 223104, "timers": {"training_iteration_time_ms": 1067.634, "sample_time_ms": 790.091, "load_time_ms": 0.314, "load_throughput": 822350.051, "learn_time_ms": 18.628, "learn_throughput": 13850.153, "synch_weights_time_ms": 10.208}, "counters": {"num_env_steps_sampled": 74368, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 223104, "num_agent_steps_trained": 21156, "last_target_update_ts": 74368, "num_target_updates": 82}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-03", "timestamp": 1700369883, "time_this_iter_s": 1.0323820114135742, "time_total_s": 86.88237738609314, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742b60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 86.88237738609314, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 64.95, "ram_util_percent": 66.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13666820526123, "actor_loss": -8.948813438415527, "critic_loss": 0.17891159653663635, "alpha_loss": -0.24943755567073822, "alpha_value": 0.975692868232727, "log_alpha_value": -0.024607447907328606, "target_entropy": -6.0, "policy_t": -0.06337088346481323, "mean_q": 4.9415082931518555, "max_q": 7.8181352615356445, "min_q": 3.927729606628418}, "td_error": [0.7973153591156006, 0.9830148220062256, 0.4211552143096924, 0.1586599349975586, 0.2152554988861084, 2.1013247966766357, 1.1446311473846436, 0.7250776290893555, 0.6385293006896973, 0.6744742393493652, 0.14495515823364258, 1.1874587535858154, 0.7183306217193604, 0.9103002548217773, 1.4799630641937256, 0.16538405418395996, 1.0601980686187744, 0.09342765808105469, 0.8360843658447266, 0.5004050731658936, 1.1765661239624023, 1.4368658065795898, 0.5643448829650879, 0.03997325897216797, 0.6410717964172363, 0.951399564743042, 2.429450273513794, 1.7560584545135498, 0.6645557880401611, 0.09314489364624023, 0.3038613796234131, 1.6299643516540527, 1.7866215705871582, 0.3406553268432617, 0.5571365356445312, 0.06364107131958008, 1.3820650577545166, 0.4615907669067383, 1.8949239253997803, 1.270646572113037, 2.4583852291107178, 1.934347152709961, 0.5803930759429932, 0.595888614654541, 2.1134936809539795, 0.8201870918273926, 0.5710451602935791, 0.6978223323822021, 1.8354835510253906, 0.955984354019165, 0.6720619201660156, 1.7592430114746094, 0.8222196102142334, 0.3157508373260498, 1.0876567363739014, 0.09311079978942871, 0.5017659664154053, 0.7434060573577881, 0.6383295059204102, 2.4029014110565186, 0.5559549331665039, 0.838939905166626, 0.34632277488708496, 2.2999401092529297, 0.6388330459594727, 1.397406816482544, 1.2680628299713135, 2.530843496322632, 1.5523557662963867, 0.5256433486938477, 0.8292850255966187, 0.7178745269775391, 0.72550368309021, 1.7364696264266968, 0.6634824275970459, 0.2183070182800293, 0.07053446769714355, 0.0381009578704834, 0.23596596717834473, 0.8168361186981201, 1.3826472759246826, 0.8489482402801514, 0.6603960990905762, 0.39129638671875, 0.9244623184204102, 2.6209559440612793], "mean_td_error": 0.939945638179779, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047025680541992, "actor_loss": -6.835170269012451, "critic_loss": 0.11767102032899857, "alpha_loss": -0.2469685971736908, "alpha_value": 0.9757183790206909, "log_alpha_value": -0.024581264704465866, "target_entropy": -6.0, "policy_t": -0.06239406019449234, "mean_q": 2.78830885887146, "max_q": 2.8924429416656494, "min_q": 2.048524856567383}, "td_error": [2.146249771118164, 0.16183924674987793, 1.133217692375183, 1.8242285251617432, 0.3450460433959961, 0.143548846244812, 0.9071857929229736, 2.3867759704589844, 1.8891770839691162, 0.1457836627960205, 1.177903652191162, 0.6111812591552734, 0.5169534683227539, 2.4512062072753906, 0.08528685569763184, 0.3419044017791748, 1.4104217290878296, 0.9014923572540283, 1.071744680404663, 1.0997772216796875, 0.7058249711990356, 0.7319345474243164, 0.8342841863632202, 3.3878118991851807, 0.7228152751922607, 1.2241216897964478, 0.044777631759643555, 0.48459768295288086, 0.481433629989624, 1.506819725036621, 0.01900613307952881, 2.0529603958129883, 0.07578623294830322, 1.1183809041976929, 1.7931233644485474, 2.2305054664611816, 1.4992775917053223, 0.6319267749786377, 0.7024180889129639, 0.006473064422607422, 0.08584928512573242, 0.29574131965637207, 0.38445329666137695, 0.39422667026519775, 0.5862901210784912, 0.7815660238265991, 1.3293203115463257, 0.41769886016845703, 0.9827289581298828, 0.8270508050918579, 2.0413246154785156, 0.08857786655426025, 2.1461563110351562, 0.03385794162750244, 1.2390636205673218, 0.722983717918396, 0.29895853996276855, 0.5470902919769287, 0.9569300413131714, 0.48787736892700195, 1.8120825290679932, 0.006469845771789551, 1.5747430324554443, 0.3214752674102783, 1.0731606483459473, 1.0346081256866455, 1.2026020288467407, 0.4866626262664795, 0.2871403694152832, 0.6555609703063965, 0.8513658046722412, 0.6027058362960815, 0.5210638046264648, 1.8312222957611084, 0.9416383504867554, 0.24074947834014893, 0.008226752281188965, 1.58558189868927, 0.23139500617980957, 0.5605690479278564, 0.3259388208389282, 0.8181837797164917, 2.507596492767334, 0.8709222078323364, 0.6543200016021729, 2.3028512001037598], "mean_td_error": 0.9181602597236633, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.020398139953613, "actor_loss": -6.7369818687438965, "critic_loss": 0.12498447299003601, "alpha_loss": -0.2465200573205948, "alpha_value": 0.9756983518600464, "log_alpha_value": -0.024601824581623077, "target_entropy": -6.0, "policy_t": -0.06179356947541237, "mean_q": 2.623492956161499, "max_q": 2.77799654006958, "min_q": 1.8587312698364258}, "td_error": [1.629250168800354, 1.2263659238815308, 0.18430781364440918, 0.1978139877319336, 0.5446968078613281, 0.6984031200408936, 2.3981618881225586, 1.990446925163269, 0.7315807342529297, 0.056649208068847656, 1.079720139503479, 0.894260048866272, 0.3440589904785156, 0.7159827947616577, 0.5652502179145813, 0.5371310710906982, 0.6110812425613403, 0.15368545055389404, 1.28318452835083, 0.15955257415771484, 0.7056622505187988, 0.7073591947555542, 0.4510895013809204, 0.4638129472732544, 1.011267066001892, 0.9891481399536133, 1.369198203086853, 1.099998950958252, 0.44229423999786377, 1.370643138885498, 0.41142213344573975, 0.7210243940353394, 1.0173317193984985, 0.4234740734100342, 0.8029526472091675, 0.3043937683105469, 1.1104236841201782, 1.129795789718628, 0.99711012840271, 0.3744535446166992, 0.3849937915802002, 0.6219272613525391, 1.588965654373169, 3.2471930980682373, 1.0576997995376587, 0.7692960500717163, 2.322577476501465, 0.44163942337036133, 0.35164928436279297, 0.9351061582565308, 0.7139377593994141, 0.7801274061203003, 0.8449300527572632, 0.175246000289917, 0.3914320468902588, 1.5503121614456177, 0.9322936534881592, 1.1291074752807617, 0.49365293979644775, 1.6715954542160034, 0.8649858236312866, 0.35354065895080566, 0.5217139720916748, 1.0912927389144897, 1.382758617401123, 0.20815551280975342, 1.787705898284912, 0.8216197490692139, 0.6137762069702148, 1.532644510269165, 0.07001352310180664, 1.294482707977295, 1.8660845756530762, 0.026599466800689697, 1.5779780149459839, 0.30013883113861084, 1.8494096994400024, 1.692258596420288, 1.2835050821304321, 0.06134462356567383, 0.20606780052185059, 0.7837671041488647, 0.3528648614883423, 0.9857264757156372, 1.941286325454712, 0.48513805866241455], "mean_td_error": 0.8867788314819336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 817.9657908403241, "num_env_steps_trained_throughput_per_sec": 235.53032816607544, "timesteps_total": 75264, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 225792, "timers": {"training_iteration_time_ms": 1086.644, "sample_time_ms": 809.782, "load_time_ms": 0.314, "load_throughput": 822912.876, "learn_time_ms": 18.728, "learn_throughput": 13776.502, "synch_weights_time_ms": 10.188}, "counters": {"num_env_steps_sampled": 75264, "num_env_steps_trained": 21414, "num_agent_steps_sampled": 225792, "num_agent_steps_trained": 21414, "last_target_update_ts": 75264, "num_target_updates": 83}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-04", "timestamp": 1700369884, "time_this_iter_s": 1.1038331985473633, "time_total_s": 87.9862105846405, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317741c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 87.9862105846405, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 88.3, "ram_util_percent": 67.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01428508758545, "actor_loss": -8.871479988098145, "critic_loss": 0.18976084887981415, "alpha_loss": -0.25242605805397034, "alpha_value": 0.9751084446907043, "log_alpha_value": -0.02520660124719143, "target_entropy": -6.0, "policy_t": -0.07594769448041916, "mean_q": 4.958293914794922, "max_q": 7.080044269561768, "min_q": 3.6444201469421387}, "td_error": [0.6534080505371094, 0.4951000213623047, 0.6716699600219727, 0.7727963924407959, 0.05250740051269531, 0.8920416831970215, 2.4759979248046875, 0.7005493640899658, 1.2839117050170898, 0.9466784000396729, 0.538337230682373, 0.1424722671508789, 0.5320308208465576, 0.5927891731262207, 0.6116805076599121, 2.266268253326416, 2.2856040000915527, 1.0167841911315918, 2.0094804763793945, 0.5616195201873779, 0.5477781295776367, 1.977719783782959, 1.610093593597412, 0.4681425094604492, 2.1923649311065674, 1.5845980644226074, 0.26244592666625977, 0.044472694396972656, 1.2699651718139648, 2.5972838401794434, 2.2561075687408447, 1.513047695159912, 1.479163408279419, 2.893887758255005, 0.43987035751342773, 1.1858916282653809, 2.2664990425109863, 1.0397322177886963, 0.2553880214691162, 0.3387482166290283, 0.3479471206665039, 0.6239702701568604, 0.8355669975280762, 0.3269345760345459, 0.9627804756164551, 0.42629289627075195, 0.8187224864959717, 0.26596689224243164, 0.05446767807006836, 0.24123120307922363, 0.04471850395202637, 1.682584524154663, 1.006638765335083, 1.0907909870147705, 1.1920273303985596, 0.5860953330993652, 1.853318691253662, 0.0954444408416748, 0.42380785942077637, 0.8568277359008789, 0.04653310775756836, 1.167870283126831, 1.3622407913208008, 1.0403964519500732, 1.3208575248718262, 0.3838376998901367, 1.0233240127563477, 0.5170285701751709, 0.2579927444458008, 0.24132394790649414, 2.4757039546966553, 2.191833972930908, 0.19672298431396484, 0.7571766376495361, 1.211564302444458, 0.7133984565734863, 0.6476171016693115, 0.13496828079223633, 1.724949598312378, 0.1672964096069336, 1.7454299926757812, 0.5234649181365967, 0.6444778442382812, 1.0677034854888916, 0.8095717430114746, 0.7950115203857422], "mean_td_error": 0.9608064889907837, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041648864746094, "actor_loss": -6.834146022796631, "critic_loss": 0.09544730186462402, "alpha_loss": -0.25283461809158325, "alpha_value": 0.9751357436180115, "log_alpha_value": -0.02517859824001789, "target_entropy": -6.0, "policy_t": -0.07838360220193863, "mean_q": 2.726182699203491, "max_q": 2.8610599040985107, "min_q": 2.036801338195801}, "td_error": [0.3946174383163452, 0.4532480239868164, 0.7348817586898804, 1.1503314971923828, 1.7746334075927734, 0.9258279800415039, 0.882648229598999, 1.3481625318527222, 0.6956840753555298, 0.9939457178115845, 0.1488860845565796, 1.3930299282073975, 0.8780436515808105, 0.659142017364502, 2.721588611602783, 1.6307231187820435, 0.12941813468933105, 1.321684718132019, 2.7691421508789062, 0.41660571098327637, 0.06014895439147949, 0.28219711780548096, 0.8500436544418335, 0.2641866207122803, 1.5602469444274902, 0.2980024814605713, 1.4890496730804443, 1.6036347150802612, 1.0006341934204102, 0.5347920656204224, 0.615241289138794, 1.843477487564087, 0.845573902130127, 0.7100057601928711, 1.302703619003296, 1.4540472030639648, 0.656578779220581, 2.3009603023529053, 0.02166152000427246, 2.6617989540100098, 0.013372540473937988, 0.5975723266601562, 0.2110973596572876, 0.95607590675354, 2.7686374187469482, 0.5688004493713379, 0.3978945016860962, 0.3183678388595581, 0.1625361442565918, 1.4698083400726318, 0.019988536834716797, 0.6885337829589844, 0.27254176139831543, 0.521701455116272, 0.18370568752288818, 0.6507232189178467, 0.5095334053039551, 0.04567873477935791, 0.1820007562637329, 2.1376497745513916, 1.977652668952942, 0.027045726776123047, 0.046356797218322754, 0.32967686653137207, 1.0283223390579224, 0.6522444486618042, 1.0195603370666504, 1.0362647771835327, 0.16068434715270996, 0.6976038217544556, 0.35173511505126953, 2.3550939559936523, 0.712294340133667, 0.20269525051116943, 0.8139663934707642, 0.6797769069671631, 0.8388283252716064, 0.5465432405471802, 0.615738034248352, 0.9336576461791992, 1.0134389400482178, 0.4584759473800659, 0.3780677318572998, 1.165434718132019, 0.5399988889694214, 0.273687481880188], "mean_td_error": 0.8524220585823059, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056251525878906, "actor_loss": -6.705909729003906, "critic_loss": 0.1136787086725235, "alpha_loss": -0.25341933965682983, "alpha_value": 0.9751147031784058, "log_alpha_value": -0.02520018070936203, "target_entropy": -6.0, "policy_t": -0.059214260429143906, "mean_q": 2.603134870529175, "max_q": 2.766667604446411, "min_q": 1.8606882095336914}, "td_error": [0.8795766830444336, 0.8105931282043457, 0.5456864833831787, 1.175721526145935, 2.952727794647217, 0.3295999765396118, 0.18894100189208984, 0.3037768602371216, 0.05120575428009033, 0.30506229400634766, 0.9602584838867188, 0.47798144817352295, 0.9972295761108398, 1.4878140687942505, 0.9788709878921509, 0.8074177503585815, 0.6130807399749756, 0.077262282371521, 0.19568336009979248, 0.26037168502807617, 0.7978475093841553, 0.12877631187438965, 0.7945089340209961, 1.1430113315582275, 2.0286028385162354, 0.5756317377090454, 0.10436534881591797, 0.3436770439147949, 2.9422364234924316, 0.9593790769577026, 0.6701327562332153, 1.7958717346191406, 0.34565043449401855, 0.48748791217803955, 0.6120754480361938, 0.10190153121948242, 0.8486884832382202, 1.854351282119751, 1.0723049640655518, 0.4778919219970703, 0.37087368965148926, 0.9496750831604004, 0.6489605903625488, 1.0252125263214111, 0.13288545608520508, 0.30892622470855713, 0.11918389797210693, 1.7615599632263184, 0.21823441982269287, 0.7552995681762695, 0.09704887866973877, 0.5653910636901855, 0.3817024230957031, 0.7080944776535034, 1.2204025983810425, 0.25698792934417725, 0.3348972797393799, 0.16272008419036865, 0.052471280097961426, 2.6884536743164062, 1.0361491441726685, 1.639965295791626, 0.9719868898391724, 0.4588867425918579, 0.9290788173675537, 1.561415433883667, 0.05307424068450928, 1.5705251693725586, 0.9719613790512085, 0.2655717134475708, 1.0093568563461304, 0.8811900615692139, 0.955764889717102, 1.7659934759140015, 0.17801105976104736, 1.2190815210342407, 1.3878257274627686, 0.8017451763153076, 0.6570338010787964, 0.3935127258300781, 0.056253790855407715, 0.7233341932296753, 0.855034351348877, 0.9041273593902588, 1.9819533824920654, 1.3283939361572266], "mean_td_error": 0.8116216659545898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 888.6927586758534, "num_env_steps_trained_throughput_per_sec": 255.89590595800243, "timesteps_total": 77056, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 231168, "timers": {"training_iteration_time_ms": 1099.035, "sample_time_ms": 821.142, "load_time_ms": 0.312, "load_throughput": 825801.612, "learn_time_ms": 18.873, "learn_throughput": 13670.392, "synch_weights_time_ms": 10.512}, "counters": {"num_env_steps_sampled": 77056, "num_env_steps_trained": 21930, "num_agent_steps_sampled": 231168, "num_agent_steps_trained": 21930, "last_target_update_ts": 77056, "num_target_updates": 85}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-06", "timestamp": 1700369886, "time_this_iter_s": 2.025513172149658, "time_total_s": 90.01172375679016, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 90.01172375679016, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 70.9, "ram_util_percent": 67.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.060903549194336, "actor_loss": -8.77902889251709, "critic_loss": 0.16842159628868103, "alpha_loss": -0.25661295652389526, "alpha_value": 0.9748165607452393, "log_alpha_value": -0.025505954399704933, "target_entropy": -6.0, "policy_t": -0.04486637935042381, "mean_q": 4.811116695404053, "max_q": 6.730474472045898, "min_q": 3.5046892166137695}, "td_error": [1.0364501476287842, 1.9893131256103516, 0.15979814529418945, 1.9330425262451172, 0.33808422088623047, 1.635025978088379, 1.6381702423095703, 1.731172800064087, 0.454622745513916, 0.4267148971557617, 0.6338133811950684, 0.566408634185791, 0.9929728507995605, 1.003711223602295, 0.33486437797546387, 2.3651418685913086, 0.7407979965209961, 0.34976720809936523, 0.14773857593536377, 1.1167888641357422, 1.0068423748016357, 0.9509601593017578, 0.19813084602355957, 0.062111854553222656, 0.5093705654144287, 0.12799787521362305, 0.10142779350280762, 1.9238674640655518, 0.35546159744262695, 0.4249587059020996, 2.1411309242248535, 0.1518568992614746, 0.38410115242004395, 0.14359831809997559, 0.8714275360107422, 0.08444523811340332, 0.15097379684448242, 1.04298734664917, 1.2147996425628662, 1.3702670335769653, 1.2343847751617432, 1.3657786846160889, 3.1513853073120117, 0.19570612907409668, 0.3464827537536621, 0.31735730171203613, 1.794630765914917, 0.5215644836425781, 0.19819951057434082, 0.9431807994842529, 1.604166030883789, 0.18210554122924805, 0.5010383129119873, 1.8682756423950195, 0.3661057949066162, 0.8902733325958252, 2.1864190101623535, 0.27120327949523926, 0.3861699104309082, 1.642542839050293, 1.0119171142578125, 1.4369139671325684, 1.1290349960327148, 0.9043636322021484, 0.6488950252532959, 0.3104817867279053, 1.853996992111206, 0.1922149658203125, 0.6782057285308838, 1.2270944118499756, 0.2805969715118408, 0.7724306583404541, 1.314403772354126, 0.6731657981872559, 1.1107163429260254, 1.4739601612091064, 0.2087256908416748, 2.2348275184631348, 1.308570384979248, 0.6387920379638672, 0.17469358444213867, 0.2468411922454834, 0.63460373878479, 1.2268197536468506, 0.6247143745422363, 0.058244943618774414], "mean_td_error": 0.8738757371902466, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030102729797363, "actor_loss": -6.78764009475708, "critic_loss": 0.10791200399398804, "alpha_loss": -0.25553959608078003, "alpha_value": 0.9748445153236389, "log_alpha_value": -0.025477269664406776, "target_entropy": -6.0, "policy_t": -0.07140368223190308, "mean_q": 2.7272212505340576, "max_q": 2.8465726375579834, "min_q": 2.052507162094116}, "td_error": [1.689049482345581, 1.6040799617767334, 0.9024022817611694, 0.14005136489868164, 0.17028677463531494, 0.6027426719665527, 0.5671522617340088, 1.1058690547943115, 0.2823408842086792, 0.6172002553939819, 0.8316857814788818, 0.1454014778137207, 1.966596245765686, 1.5633939504623413, 0.7140097618103027, 0.3420138359069824, 0.13150370121002197, 1.7447209358215332, 0.8056374788284302, 0.43770575523376465, 0.24393606185913086, 0.7842522859573364, 1.4296083450317383, 0.4830453395843506, 0.49212825298309326, 0.568781852722168, 0.5105520486831665, 1.9762006998062134, 1.4611878395080566, 1.8522779941558838, 1.803762435913086, 2.0792462825775146, 1.6452686786651611, 2.5556671619415283, 0.33908092975616455, 0.5138775110244751, 0.29051053524017334, 1.5519509315490723, 1.909460425376892, 0.6418759822845459, 1.2317917346954346, 0.09655046463012695, 0.507148027420044, 1.2961032390594482, 1.0854121446609497, 0.6829487085342407, 0.3886626958847046, 0.41224515438079834, 0.6412746906280518, 0.9008992910385132, 0.20333659648895264, 0.253761887550354, 0.8873745203018188, 0.589815616607666, 2.290134906768799, 0.22198057174682617, 1.6837893724441528, 0.5749751329421997, 0.879309892654419, 0.6169900894165039, 0.9246866703033447, 0.9639678001403809, 0.49246370792388916, 0.1656656265258789, 1.9769049882888794, 0.39137494564056396, 0.9244498014450073, 0.20123887062072754, 0.4404585361480713, 0.6139638423919678, 0.07067716121673584, 0.5611555576324463, 1.32437002658844, 1.578682541847229, 0.35820114612579346, 0.5537053346633911, 1.360878586769104, 1.2502622604370117, 0.26765894889831543, 0.5904182195663452, 0.9292887449264526, 0.05192685127258301, 2.417534351348877, 2.3420000076293945, 0.22748851776123047, 1.0168956518173218], "mean_td_error": 0.8946202993392944, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018014907836914, "actor_loss": -6.660512447357178, "critic_loss": 0.12559907138347626, "alpha_loss": -0.25545230507850647, "alpha_value": 0.9748230576515198, "log_alpha_value": -0.025499291718006134, "target_entropy": -6.0, "policy_t": -0.05294311046600342, "mean_q": 2.5884761810302734, "max_q": 2.717660427093506, "min_q": 1.9310884475708008}, "td_error": [0.33083653450012207, 1.0844271183013916, 1.2056971788406372, 0.2392411231994629, 0.7121810913085938, 1.2478551864624023, 1.3913757801055908, 1.2728936672210693, 2.062178373336792, 0.8797446489334106, 0.6215436458587646, 0.3788248300552368, 2.467036724090576, 2.1748464107513428, 0.39368951320648193, 0.7173075675964355, 1.1616121530532837, 1.0571398735046387, 1.4979445934295654, 0.7517330646514893, 1.188679575920105, 0.1917872428894043, 0.3004329204559326, 0.4474755525588989, 0.42032909393310547, 1.2307301759719849, 0.3096967935562134, 0.8920559883117676, 0.05379676818847656, 0.928714394569397, 0.7855405807495117, 1.204262614250183, 0.11896789073944092, 0.7509193420410156, 0.12747156620025635, 2.5260682106018066, 0.32800161838531494, 0.06328248977661133, 0.22478318214416504, 2.032390594482422, 0.40193259716033936, 0.8003966808319092, 0.981482982635498, 1.1733800172805786, 0.5966053009033203, 1.1243280172348022, 0.04769444465637207, 1.188960313796997, 1.0192413330078125, 0.10865485668182373, 1.7663999795913696, 0.20729470252990723, 0.19993019104003906, 0.6048060059547424, 1.4190782308578491, 0.7727051973342896, 1.3161042928695679, 0.43910181522369385, 0.6523458957672119, 0.7942436933517456, 0.4336785078048706, 1.3338773250579834, 1.502947211265564, 0.6917973756790161, 0.9811067581176758, 0.22583556175231934, 1.2650095224380493, 1.162915587425232, 0.5651026964187622, 0.3272581100463867, 0.5255148410797119, 2.0132555961608887, 0.6042687892913818, 2.1211752891540527, 2.192249298095703, 0.8608824014663696, 0.39836204051971436, 0.28877902030944824, 2.6553211212158203, 1.4061592817306519, 0.33381712436676025, 0.2019113302230835, 1.5004158020019531, 0.42293083667755127, 0.9674110412597656, 0.7495936155319214], "mean_td_error": 0.8967413902282715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 881.716968135125, "num_env_steps_trained_throughput_per_sec": 253.88725198533731, "timesteps_total": 77952, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 233856, "timers": {"training_iteration_time_ms": 1098.192, "sample_time_ms": 819.608, "load_time_ms": 0.31, "load_throughput": 831896.089, "learn_time_ms": 18.778, "learn_throughput": 13739.332, "synch_weights_time_ms": 10.529}, "counters": {"num_env_steps_sampled": 77952, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 233856, "num_agent_steps_trained": 22188, "last_target_update_ts": 77952, "num_target_updates": 86}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-07", "timestamp": 1700369887, "time_this_iter_s": 1.026355266571045, "time_total_s": 91.0380790233612, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177bab60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 91.0380790233612, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 64.35, "ram_util_percent": 67.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037960052490234, "actor_loss": -8.795888900756836, "critic_loss": 0.17483708262443542, "alpha_loss": -0.2620353102684021, "alpha_value": 0.9742333292961121, "log_alpha_value": -0.026104439049959183, "target_entropy": -6.0, "policy_t": -0.061952389776706696, "mean_q": 4.795047760009766, "max_q": 5.002155303955078, "min_q": 3.2880964279174805}, "td_error": [2.8543405532836914, 0.9304330348968506, 1.3466815948486328, 0.5921895503997803, 1.4477818012237549, 0.5401432514190674, 0.17956233024597168, 0.715069055557251, 1.425722360610962, 0.37338685989379883, 0.4829692840576172, 0.46836042404174805, 1.1357231140136719, 1.423776626586914, 0.825629472732544, 0.8740425109863281, 1.5592238903045654, 0.31219005584716797, 1.2897922992706299, 2.045292615890503, 1.8295283317565918, 0.7650003433227539, 0.8156025409698486, 0.43280792236328125, 0.04280352592468262, 1.1266226768493652, 1.2991719245910645, 0.8064754009246826, 0.5945460796356201, 2.259678363800049, 1.8344805240631104, 0.4426267147064209, 1.0799064636230469, 1.8746190071105957, 0.7654983997344971, 2.0686709880828857, 0.05752968788146973, 1.1962730884552002, 0.24564719200134277, 0.8378510475158691, 1.997218132019043, 0.600792646408081, 0.12212371826171875, 0.8509702682495117, 0.1681807041168213, 0.9920964241027832, 0.05819845199584961, 0.28762221336364746, 0.18528223037719727, 0.05769467353820801, 1.3684816360473633, 1.318294644355774, 0.22734999656677246, 0.7776861190795898, 0.6241087913513184, 0.32154273986816406, 2.140141010284424, 1.464087724685669, 0.11864042282104492, 1.3980188369750977, 0.6321673393249512, 0.9429960250854492, 0.7287919521331787, 0.4653007984161377, 1.6122865676879883, 0.4453308582305908, 1.5880753993988037, 0.3600020408630371, 0.5217249393463135, 0.8076901435852051, 1.0311779975891113, 0.7405862808227539, 0.2226250171661377, 1.7208449840545654, 0.19389653205871582, 0.26674389839172363, 0.371185302734375, 1.0178687572479248, 0.35027408599853516, 0.6330983638763428, 1.633530855178833, 0.26519179344177246, 0.11941289901733398, 0.1694636344909668, 1.041318655014038, 2.458847761154175], "mean_td_error": 0.890890896320343, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.006048202514648, "actor_loss": -6.737360000610352, "critic_loss": 0.099770188331604, "alpha_loss": -0.260905921459198, "alpha_value": 0.9742621779441833, "log_alpha_value": -0.02607482112944126, "target_entropy": -6.0, "policy_t": -0.0306035578250885, "mean_q": 2.727818727493286, "max_q": 2.8231232166290283, "min_q": 2.1604278087615967}, "td_error": [1.0333576202392578, 0.5618588924407959, 0.1902456283569336, 1.2665503025054932, 0.8965438604354858, 0.9496068954467773, 1.182853102684021, 0.30068933963775635, 0.5441906452178955, 0.7359731197357178, 1.6197065114974976, 0.7942094802856445, 0.6373723745346069, 0.2293381690979004, 0.8413395881652832, 1.4735087156295776, 0.11434292793273926, 1.7368767261505127, 0.05847275257110596, 0.7569470405578613, 0.6394529342651367, 0.5977634191513062, 2.032257080078125, 1.5052344799041748, 0.07010507583618164, 0.2019360065460205, 0.24274778366088867, 1.6269789934158325, 1.4484412670135498, 1.374064564704895, 0.05745410919189453, 1.3459599018096924, 1.0416494607925415, 1.4285184144973755, 0.2488694190979004, 0.645429253578186, 1.0947918891906738, 0.8695019483566284, 1.8538711071014404, 0.47349095344543457, 0.5983095169067383, 1.9273632764816284, 0.2577228546142578, 0.8300015926361084, 0.5019770860671997, 2.306325912475586, 0.5187002420425415, 1.5152491331100464, 2.2222108840942383, 1.1429455280303955, 0.53279709815979, 0.011252284049987793, 0.3429752588272095, 0.7918287515640259, 1.2676918506622314, 0.6184433698654175, 0.9478230476379395, 0.5707681179046631, 1.6770968437194824, 1.3270821571350098, 0.49407458305358887, 0.23834705352783203, 0.006590843200683594, 0.11202943325042725, 0.765236496925354, 1.1329412460327148, 0.11016130447387695, 0.8755452632904053, 1.192740797996521, 0.49357080459594727, 1.4220664501190186, 0.8360418081283569, 0.0963360071182251, 1.107795238494873, 0.8073197603225708, 0.8988803625106812, 0.8661365509033203, 0.554069995880127, 0.5988723039627075, 1.9598124027252197, 1.507439374923706, 0.16703259944915771, 0.6892510652542114, 0.5085331201553345, 0.8670518398284912, 0.4368464946746826], "mean_td_error": 0.8532068133354187, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.951056480407715, "actor_loss": -6.629207134246826, "critic_loss": 0.1469932198524475, "alpha_loss": -0.25969570875167847, "alpha_value": 0.9742403030395508, "log_alpha_value": -0.02609729953110218, "target_entropy": -6.0, "policy_t": -0.10176889598369598, "mean_q": 2.579709053039551, "max_q": 2.7285332679748535, "min_q": 1.9742944240570068}, "td_error": [1.466252088546753, 0.6187926530838013, 0.2430187463760376, 0.16777098178863525, 2.0085413455963135, 1.2680647373199463, 0.14263546466827393, 1.9668747186660767, 0.6235681772232056, 3.8545994758605957, 0.45150089263916016, 0.534287691116333, 0.2273465394973755, 1.066593050956726, 0.9612849950790405, 0.2023484706878662, 0.674915075302124, 0.35892271995544434, 0.15155702829360962, 1.6088374853134155, 0.3397209644317627, 1.1061488389968872, 0.9076679944992065, 0.6075091361999512, 0.06539320945739746, 1.3101328611373901, 3.0797982215881348, 1.1928439140319824, 0.14066743850708008, 1.2960931062698364, 0.8196144104003906, 1.613008737564087, 1.0646976232528687, 0.18674218654632568, 1.5180754661560059, 0.4061708450317383, 0.8905681371688843, 0.6377445459365845, 0.13813424110412598, 0.6368774175643921, 1.0641541481018066, 0.33633124828338623, 0.27207350730895996, 0.05477714538574219, 1.6853082180023193, 1.0226749181747437, 0.5227347612380981, 3.0014543533325195, 0.12953805923461914, 0.3946038484573364, 2.264549493789673, 0.4474806785583496, 0.6968381404876709, 0.29502880573272705, 2.328472137451172, 1.2292832136154175, 0.6661884784698486, 1.3324497938156128, 1.0843168497085571, 0.3103365898132324, 0.15852975845336914, 0.04545736312866211, 0.652768611907959, 0.18689846992492676, 0.1204460859298706, 1.7545843124389648, 0.09794795513153076, 0.0635901689529419, 1.8509554862976074, 1.7760511636734009, 0.765520453453064, 1.848878264427185, 2.8353769779205322, 1.945897102355957, 1.0044481754302979, 1.6779831647872925, 0.7671902179718018, 0.04752063751220703, 0.9161520004272461, 0.07383465766906738, 0.9389586448669434, 0.828711986541748, 1.7277239561080933, 0.12492692470550537, 0.9076457023620605, 2.8395323753356934], "mean_td_error": 0.9494354724884033, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 918.930069087929, "num_env_steps_trained_throughput_per_sec": 264.6026315007653, "timesteps_total": 79744, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 239232, "timers": {"training_iteration_time_ms": 1078.003, "sample_time_ms": 796.759, "load_time_ms": 0.309, "load_throughput": 835751.029, "learn_time_ms": 18.609, "learn_throughput": 13864.544, "synch_weights_time_ms": 10.754}, "counters": {"num_env_steps_sampled": 79744, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 239232, "num_agent_steps_trained": 22704, "last_target_update_ts": 79744, "num_target_updates": 88}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-09", "timestamp": 1700369889, "time_this_iter_s": 1.957556962966919, "time_total_s": 92.99563598632812, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317741c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 92.99563598632812, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 76.6, "ram_util_percent": 66.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05346965789795, "actor_loss": -8.833319664001465, "critic_loss": 0.15445056557655334, "alpha_loss": -0.2684536874294281, "alpha_value": 0.9736507534980774, "log_alpha_value": -0.02670259214937687, "target_entropy": -6.0, "policy_t": -0.09559819847345352, "mean_q": 4.748539447784424, "max_q": 4.969789981842041, "min_q": 3.039224624633789}, "td_error": [0.415219783782959, 1.9597094058990479, 1.4873371124267578, 0.4078483581542969, 0.46901512145996094, 0.47715044021606445, 0.05144095420837402, 1.6548817157745361, 0.10073971748352051, 0.3054232597351074, 0.9298601150512695, 1.0042493343353271, 0.8434231281280518, 2.400024652481079, 1.2840616703033447, 0.05932474136352539, 0.37189507484436035, 0.9718194007873535, 0.14223003387451172, 0.07209300994873047, 1.6552844047546387, 0.43448638916015625, 0.29924821853637695, 2.701870918273926, 1.8754805326461792, 0.29607152938842773, 0.11274600028991699, 0.6300873756408691, 1.8139848709106445, 1.2890489101409912, 0.2776937484741211, 0.735356330871582, 1.3730740547180176, 2.0737481117248535, 0.08357715606689453, 0.9767963886260986, 0.03312849998474121, 1.1722009181976318, 0.26952075958251953, 0.3081996440887451, 0.5799379348754883, 2.1407079696655273, 1.4739840030670166, 0.041883230209350586, 1.9788365364074707, 0.05690288543701172, 1.287273645401001, 0.6446194648742676, 1.0155067443847656, 1.3394098281860352, 1.1014373302459717, 0.7690157890319824, 0.8164384365081787, 0.3216383457183838, 0.0641021728515625, 0.05727529525756836, 0.2826993465423584, 0.1088094711303711, 0.7681803703308105, 0.04324936866760254, 0.3454926013946533, 0.45848703384399414, 1.107024908065796, 0.24120688438415527, 0.6484506130218506, 1.3691902160644531, 0.7493207454681396, 0.18972492218017578, 1.348498821258545, 0.7957470417022705, 1.0690419673919678, 0.3469088077545166, 1.1634342670440674, 0.16698455810546875, 0.8846373558044434, 0.15040302276611328, 2.095065116882324, 0.4684586524963379, 1.1274878978729248, 1.0372462272644043, 1.4355225563049316, 0.3445005416870117, 0.15170025825500488, 1.1049799919128418, 0.9498541355133057, 0.5827343463897705], "mean_td_error": 0.8028297424316406, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092177391052246, "actor_loss": -6.787759304046631, "critic_loss": 0.09995917975902557, "alpha_loss": -0.26918259263038635, "alpha_value": 0.9736801385879517, "log_alpha_value": -0.026672402396798134, "target_entropy": -6.0, "policy_t": -0.03488413989543915, "mean_q": 2.7008676528930664, "max_q": 3.0495986938476562, "min_q": 2.2173244953155518}, "td_error": [0.347880482673645, 1.059991717338562, 0.8139594793319702, 1.0987931489944458, 0.6588617563247681, 1.3876233100891113, 0.03845858573913574, 2.1551060676574707, 0.9877357482910156, 1.4320179224014282, 1.021073579788208, 0.7308197021484375, 0.38701677322387695, 1.5536890029907227, 2.3042654991149902, 0.9254747629165649, 0.4914846420288086, 1.0681407451629639, 0.5197170972824097, 0.9794424772262573, 0.17980587482452393, 0.9042019844055176, 0.2287440299987793, 0.3572380542755127, 0.8347750902175903, 0.8795508146286011, 0.7894375324249268, 0.3688313961029053, 0.10763311386108398, 0.39885878562927246, 1.4865022897720337, 0.7320331335067749, 1.5529730319976807, 0.030743956565856934, 2.4426350593566895, 0.5836066007614136, 0.9321435689926147, 1.395981788635254, 0.47404658794403076, 1.4438902139663696, 1.1664310693740845, 0.9014836549758911, 0.3667408227920532, 0.5241894721984863, 1.3716561794281006, 0.551807165145874, 1.1194483041763306, 0.950252890586853, 0.37225937843322754, 0.6265902519226074, 0.45468926429748535, 0.9846982955932617, 0.692893385887146, 1.2694973945617676, 1.0632058382034302, 0.10244691371917725, 0.9673413038253784, 0.009443998336791992, 0.27846240997314453, 0.01753401756286621, 0.8379936218261719, 2.36063814163208, 0.5516059398651123, 0.5589303970336914, 0.9087159633636475, 0.7707294225692749, 0.3990147113800049, 0.798961877822876, 0.7777847051620483, 1.9193928241729736, 0.8172346353530884, 0.4563755989074707, 1.5972598791122437, 1.1795881986618042, 1.084796667098999, 0.6717429161071777, 0.07283663749694824, 0.10044872760772705, 2.744309902191162, 2.6159958839416504, 0.5299069881439209, 1.3528205156326294, 0.5909639596939087, 0.0599513053894043, 0.5417994260787964, 0.8907239437103271], "mean_td_error": 0.8728695511817932, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.042524337768555, "actor_loss": -6.620964527130127, "critic_loss": 0.13580304384231567, "alpha_loss": -0.2680823802947998, "alpha_value": 0.9736584424972534, "log_alpha_value": -0.02669471874833107, "target_entropy": -6.0, "policy_t": -0.04327734187245369, "mean_q": 2.6007649898529053, "max_q": 3.2733120918273926, "min_q": 2.5411229133605957}, "td_error": [0.40460193157196045, 0.5813180208206177, 0.2646162509918213, 2.012680768966675, 2.4990224838256836, 0.9082738161087036, 2.4400851726531982, 1.4074054956436157, 1.4723711013793945, 0.6677780151367188, 0.1642777919769287, 1.3779748678207397, 0.34609460830688477, 0.7138576507568359, 0.7815780639648438, 1.2603797912597656, 1.51039719581604, 1.069204568862915, 1.3698420524597168, 1.2589502334594727, 0.6799581050872803, 0.2707008123397827, 0.2954610586166382, 1.1491730213165283, 0.2295694351196289, 0.4230661392211914, 0.15412092208862305, 1.1819177865982056, 0.34336328506469727, 0.04126548767089844, 1.425781488418579, 1.6492379903793335, 2.087770700454712, 1.4118309020996094, 0.09738123416900635, 2.3497021198272705, 0.4918689727783203, 0.21710944175720215, 0.25129544734954834, 0.8621203899383545, 2.691419839859009, 0.425356388092041, 0.7760816812515259, 0.27003753185272217, 0.3110165596008301, 1.6591408252716064, 0.21719896793365479, 0.8715293407440186, 0.10883808135986328, 0.5683268308639526, 0.6833090782165527, 1.067291021347046, 1.8670854568481445, 1.0230615139007568, 2.6409149169921875, 1.1449337005615234, 0.9189813137054443, 1.7480800151824951, 1.2392624616622925, 0.5894644260406494, 0.7414031028747559, 0.6878408193588257, 0.6814800500869751, 0.4274808168411255, 0.7545576095581055, 0.040845632553100586, 0.19384098052978516, 2.5906267166137695, 1.493842363357544, 0.2592731714248657, 1.0578503608703613, 0.2277967929840088, 0.3083590269088745, 0.29816246032714844, 1.6018990278244019, 0.5402565002441406, 2.1430633068084717, 0.5364797115325928, 0.7018353939056396, 0.7260763645172119, 1.578870177268982, 0.5274773836135864, 1.0100959539413452, 0.2600846290588379, 0.26812124252319336, 1.2823883295059204], "mean_td_error": 0.9288924336433411, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}}, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 750.9210703887526, "num_env_steps_trained_throughput_per_sec": 216.22504035747562, "timesteps_total": 81536, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 244608, "timers": {"training_iteration_time_ms": 1061.239, "sample_time_ms": 746.111, "load_time_ms": 0.305, "load_throughput": 846207.72, "learn_time_ms": 18.278, "learn_throughput": 14115.586, "synch_weights_time_ms": 10.84}, "counters": {"num_env_steps_sampled": 81536, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 244608, "num_agent_steps_trained": 23220, "last_target_update_ts": 81536, "num_target_updates": 90}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-12", "timestamp": 1700369892, "time_this_iter_s": 2.396533966064453, "time_total_s": 95.39216995239258, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b89a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 95.39216995239258, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 66.5, "ram_util_percent": 67.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010212898254395, "actor_loss": -8.714709281921387, "critic_loss": 0.18707966804504395, "alpha_loss": -0.2702925503253937, "alpha_value": 0.9733595848083496, "log_alpha_value": -0.027001677080988884, "target_entropy": -6.0, "policy_t": -0.055148039013147354, "mean_q": 4.70283842086792, "max_q": 5.185329437255859, "min_q": 2.96574330329895}, "td_error": [1.695683240890503, 0.5736773014068604, 1.0612907409667969, 2.164034366607666, 0.04157304763793945, 0.9963018894195557, 0.281343936920166, 0.23294997215270996, 1.6080116033554077, 0.40407586097717285, 0.8338923454284668, 0.27350950241088867, 0.7241573333740234, 1.439713954925537, 0.4587712287902832, 1.8318123817443848, 1.1962664127349854, 1.2034640312194824, 1.0678601264953613, 1.7569730281829834, 0.9821896553039551, 1.6779861450195312, 0.39188051223754883, 1.009472370147705, 0.1582775115966797, 0.8566322326660156, 1.8919882774353027, 1.5513856410980225, 1.9227583408355713, 1.5103764533996582, 1.0277578830718994, 1.2078115940093994, 2.6723837852478027, 0.228776216506958, 0.9371428489685059, 0.7418863773345947, 0.10696673393249512, 0.5379457473754883, 0.4360489845275879, 0.6009604930877686, 0.5052900314331055, 0.24208927154541016, 0.47314882278442383, 0.405148983001709, 0.5671730041503906, 0.7874693870544434, 0.6842787265777588, 0.735156774520874, 1.1188759803771973, 1.1766407489776611, 1.4810338020324707, 0.36297607421875, 0.9438872337341309, 0.1593031883239746, 1.6241517066955566, 1.2785511016845703, 1.723630666732788, 0.15023016929626465, 0.42606592178344727, 0.42179346084594727, 0.42124342918395996, 0.7047054767608643, 0.5873277187347412, 0.05095410346984863, 2.0505082607269287, 1.626075029373169, 0.14857149124145508, 0.326671838760376, 2.3631205558776855, 0.9621720314025879, 0.9166915416717529, 0.832444429397583, 0.6321053504943848, 1.8822379112243652, 1.1219758987426758, 0.8642458915710449, 0.6626877784729004, 0.49016237258911133, 0.9601106643676758, 0.7082831859588623, 0.4940056800842285, 0.10947346687316895, 4.058639049530029, 0.5945937633514404, 0.32984232902526855, 2.203822612762451], "mean_td_error": 0.9495994448661804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091522216796875, "actor_loss": -6.767897605895996, "critic_loss": 0.09083159267902374, "alpha_loss": -0.27218204736709595, "alpha_value": 0.9733891487121582, "log_alpha_value": -0.026971356943249702, "target_entropy": -6.0, "policy_t": -0.0575098916888237, "mean_q": 2.7236328125, "max_q": 3.1239585876464844, "min_q": 2.659024715423584}, "td_error": [1.3120181560516357, 0.939558744430542, 0.09300410747528076, 0.7545802593231201, 0.015656232833862305, 0.7932125329971313, 0.6613341569900513, 0.9806766510009766, 0.8311495780944824, 0.15041053295135498, 0.05406689643859863, 0.56969153881073, 0.5518050193786621, 1.1829679012298584, 0.4307088851928711, 1.1666815280914307, 1.4320987462997437, 1.0978351831436157, 0.09030568599700928, 0.46690261363983154, 2.2858664989471436, 0.8432583808898926, 0.04065227508544922, 1.5528005361557007, 0.6892449855804443, 0.03012239933013916, 0.9434798955917358, 0.8973062038421631, 0.3246464729309082, 1.3676077127456665, 1.2978565692901611, 1.1535437107086182, 0.0703437328338623, 0.007688641548156738, 0.2900291681289673, 0.30609214305877686, 0.9325474500656128, 0.5611909627914429, 0.6874631643295288, 0.6818697452545166, 0.13373947143554688, 0.1007680892944336, 0.6164406538009644, 0.7892407178878784, 1.0414389371871948, 0.22086143493652344, 0.6821455955505371, 0.33284664154052734, 0.634873628616333, 0.9609540700912476, 0.1485358476638794, 0.24800682067871094, 0.12516510486602783, 1.96150541305542, 1.855316400527954, 0.9929462671279907, 1.0175697803497314, 0.24877381324768066, 0.16779518127441406, 0.8542613983154297, 0.23453795909881592, 0.4734013080596924, 0.8676674365997314, 0.6268950700759888, 0.6820052862167358, 1.2442374229431152, 0.5019873380661011, 1.5508782863616943, 1.3397490978240967, 1.3096221685409546, 1.4077335596084595, 0.4908604621887207, 0.7006224393844604, 1.6034278869628906, 1.0361233949661255, 0.8771841526031494, 0.8420947790145874, 1.569718599319458, 1.9630016088485718, 0.855366587638855, 1.7464783191680908, 0.8560019731521606, 0.2997015714645386, 0.3230721950531006, 0.8414649963378906, 2.1858057975769043], "mean_td_error": 0.7918733358383179, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072953224182129, "actor_loss": -6.629439353942871, "critic_loss": 0.14126935601234436, "alpha_loss": -0.27190351486206055, "alpha_value": 0.9733676314353943, "log_alpha_value": -0.02699342370033264, "target_entropy": -6.0, "policy_t": -0.03500986099243164, "mean_q": 2.5779266357421875, "max_q": 2.9168238639831543, "min_q": 2.280374526977539}, "td_error": [1.9582535028457642, 1.1925920248031616, 0.22258126735687256, 2.0071234703063965, 0.8893961906433105, 1.2139793634414673, 0.34402143955230713, 1.3318147659301758, 0.6793004274368286, 0.11419975757598877, 0.3261079788208008, 2.904538631439209, 0.1363217830657959, 0.08001303672790527, 0.4419442415237427, 2.236449718475342, 0.14041638374328613, 2.013289451599121, 1.1541640758514404, 1.3256558179855347, 1.5044037103652954, 1.5635713338851929, 1.165922999382019, 0.06048119068145752, 0.509331226348877, 0.452986478805542, 0.1408909559249878, 1.0667212009429932, 0.5273915529251099, 0.18740642070770264, 1.3248833417892456, 2.3270864486694336, 2.0461153984069824, 0.2578866481781006, 0.12370920181274414, 2.2367491722106934, 2.058295726776123, 0.7336932420730591, 1.2816225290298462, 0.6272996664047241, 1.3957120180130005, 0.7281029224395752, 0.347500205039978, 1.3829219341278076, 0.46345198154449463, 0.03619837760925293, 0.2874084711074829, 0.5373014211654663, 0.9192843437194824, 0.3713937997817993, 1.3868619203567505, 0.32511746883392334, 0.4309723377227783, 0.20410048961639404, 0.5394715070724487, 0.6986606121063232, 0.12721121311187744, 0.5656578540802002, 0.725373387336731, 0.7590179443359375, 1.8859750032424927, 0.8803229331970215, 1.2241325378417969, 0.7615418434143066, 0.6238266229629517, 1.4129670858383179, 1.0359928607940674, 2.3819079399108887, 0.8763395547866821, 1.5516910552978516, 0.05949568748474121, 0.40856802463531494, 0.2958441972732544, 0.10148966312408447, 1.9790682792663574, 0.22799253463745117, 0.49702203273773193, 0.6067036390304565, 1.5146273374557495, 0.4088653326034546, 1.3453603982925415, 1.1598610877990723, 0.6493207216262817, 3.0436136722564697, 1.8460546731948853, 0.045038819313049316], "mean_td_error": 0.9298134446144104, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "last_target_update_ts": 82432, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 867.107004212906, "num_env_steps_trained_throughput_per_sec": 249.68036505237694, "timesteps_total": 82432, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 247296, "timers": {"training_iteration_time_ms": 1051.983, "sample_time_ms": 737.365, "load_time_ms": 0.306, "load_throughput": 842583.845, "learn_time_ms": 18.252, "learn_throughput": 14135.315, "synch_weights_time_ms": 10.951}, "counters": {"num_env_steps_sampled": 82432, "num_env_steps_trained": 23478, "num_agent_steps_sampled": 247296, "num_agent_steps_trained": 23478, "last_target_update_ts": 82432, "num_target_updates": 91}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-13", "timestamp": 1700369893, "time_this_iter_s": 1.0408620834350586, "time_total_s": 96.43303203582764, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177ba2a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.43303203582764, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 71.9, "ram_util_percent": 67.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.996265411376953, "actor_loss": -8.62320327758789, "critic_loss": 0.19976995885372162, "alpha_loss": -0.2758949100971222, "alpha_value": 0.9727776050567627, "log_alpha_value": -0.027599800378084183, "target_entropy": -6.0, "policy_t": -0.05033041909337044, "mean_q": 4.7383856773376465, "max_q": 4.915562629699707, "min_q": 4.196730613708496}, "td_error": [0.4645247459411621, 2.6401052474975586, 1.4066336154937744, 0.9327583312988281, 0.5076816082000732, 0.6787455081939697, 0.43004751205444336, 0.35463428497314453, 1.4109594821929932, 0.3727712631225586, 0.4440796375274658, 0.455686092376709, 1.6877436637878418, 0.0674891471862793, 2.4753360748291016, 0.7123775482177734, 0.7943251132965088, 0.199690580368042, 0.9013791084289551, 1.0223915576934814, 1.6961917877197266, 1.681375503540039, 0.2250356674194336, 1.3433585166931152, 2.5181849002838135, 0.25952959060668945, 1.4262878894805908, 1.119337797164917, 0.6580305099487305, 0.7050116062164307, 2.1669063568115234, 0.08583307266235352, 1.2740111351013184, 0.5904531478881836, 2.610529661178589, 1.165879487991333, 2.608342409133911, 0.7975301742553711, 0.3356797695159912, 0.07736420631408691, 1.176628828048706, 0.5060358047485352, 1.3742649555206299, 2.073481321334839, 1.237898588180542, 1.476482629776001, 1.0018606185913086, 1.2016799449920654, 1.6691913604736328, 1.8826520442962646, 0.9221982955932617, 1.0071237087249756, 0.37386322021484375, 0.047319889068603516, 1.111227035522461, 1.952423334121704, 1.3555572032928467, 1.1124296188354492, 0.839970588684082, 1.068563461303711, 0.5511479377746582, 1.0103216171264648, 0.1469113826751709, 0.8714196681976318, 0.24493837356567383, 1.0710585117340088, 1.4546825885772705, 0.6670331954956055, 1.5495710372924805, 1.5120084285736084, 1.4883646965026855, 0.6546881198883057, 1.8029537200927734, 0.43971776962280273, 0.6241745948791504, 0.1911482810974121, 0.4555220603942871, 0.7237582206726074, 1.714869737625122, 1.4536714553833008, 0.2584228515625, 0.3580055236816406, 0.7340285778045654, 0.7191109657287598, 0.4916074275970459, 0.546236515045166], "mean_td_error": 1.0050053596496582, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.997302055358887, "actor_loss": -6.705909729003906, "critic_loss": 0.08599543571472168, "alpha_loss": -0.27562233805656433, "alpha_value": 0.9728069305419922, "log_alpha_value": -0.027569672092795372, "target_entropy": -6.0, "policy_t": -0.06194917857646942, "mean_q": 2.6930296421051025, "max_q": 2.909593105316162, "min_q": 2.1860811710357666}, "td_error": [0.45556652545928955, 1.1669477224349976, 0.23347699642181396, 0.6419658660888672, 0.5740152597427368, 0.08123946189880371, 1.6631276607513428, 1.4089877605438232, 0.6182111501693726, 0.31090331077575684, 0.28602540493011475, 0.6687979698181152, 0.6033296585083008, 0.6780582666397095, 0.9270839691162109, 0.9202797412872314, 0.27819180488586426, 0.640362024307251, 0.4734247922897339, 1.2951366901397705, 0.34006261825561523, 2.2577342987060547, 0.02811574935913086, 1.9301668405532837, 0.6112295389175415, 0.692520260810852, 0.09395432472229004, 1.2540837526321411, 1.6220449209213257, 1.2394729852676392, 1.4438626766204834, 0.1533147096633911, 0.3384096622467041, 1.189948320388794, 2.3923749923706055, 0.5389803647994995, 0.05698978900909424, 1.0918482542037964, 0.05424332618713379, 0.635141134262085, 0.31567060947418213, 0.3818739652633667, 0.8116681575775146, 1.575041651725769, 1.2338534593582153, 0.1961679458618164, 1.448997974395752, 0.9908467531204224, 0.9098882675170898, 0.8428196907043457, 0.5455055236816406, 1.0376142263412476, 1.5558395385742188, 0.2698822021484375, 1.32064950466156, 0.5477190017700195, 0.7460938692092896, 0.9817583560943604, 1.4867228269577026, 0.5818474292755127, 0.7573381662368774, 1.032365322113037, 0.16782057285308838, 0.23415303230285645, 0.38854682445526123, 0.04494905471801758, 1.7638909816741943, 0.0949333906173706, 1.526187777519226, 0.6639308929443359, 0.6905920505523682, 0.2165665626525879, 0.433457612991333, 0.6048321723937988, 1.9640458822250366, 0.4271031618118286, 0.47853565216064453, 0.46347737312316895, 0.0036083459854125977, 0.05429232120513916, 0.5151219367980957, 0.7157655954360962, 1.546592116355896, 0.4081850051879883, 0.9298264980316162, 0.3611871004104614], "mean_td_error": 0.7692720293998718, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034143447875977, "actor_loss": -6.6464362144470215, "critic_loss": 0.15361839532852173, "alpha_loss": -0.276852011680603, "alpha_value": 0.9727861881256104, "log_alpha_value": -0.02759099379181862, "target_entropy": -6.0, "policy_t": -0.09404794871807098, "mean_q": 2.5581209659576416, "max_q": 2.976759433746338, "min_q": 2.0467193126678467}, "td_error": [0.7407039403915405, 1.8677887916564941, 1.1229817867279053, 1.6089979410171509, 1.3668659925460815, 0.6447101831436157, 2.1501612663269043, 1.7291646003723145, 2.686811923980713, 1.0661667585372925, 0.03962123394012451, 1.428485631942749, 2.279895067214966, 0.048454880714416504, 1.2873866558074951, 1.5585262775421143, 3.0505764484405518, 1.9627392292022705, 0.31425023078918457, 1.4787827730178833, 0.56415855884552, 0.6086255311965942, 0.12339985370635986, 0.1641603708267212, 1.385059118270874, 1.2212809324264526, 0.2858867645263672, 0.7334302663803101, 0.2084212303161621, 1.1412445306777954, 0.11814475059509277, 1.6321393251419067, 0.46487748622894287, 0.574711799621582, 0.5586501359939575, 0.6962685585021973, 1.5323435068130493, 1.0447388887405396, 2.049515724182129, 2.8080859184265137, 1.304034948348999, 1.0203971862792969, 0.9297490119934082, 0.3888486623764038, 0.6532117128372192, 1.9798305034637451, 0.8969053030014038, 0.9479508399963379, 1.4642984867095947, 0.46147263050079346, 0.0673828125, 1.6655020713806152, 0.4979332685470581, 0.6115579605102539, 0.5664429664611816, 2.6372954845428467, 0.680975079536438, 0.9754786491394043, 0.7479795217514038, 1.192931056022644, 1.1139459609985352, 2.063122272491455, 0.5927551984786987, 0.35746586322784424, 0.1004631519317627, 0.6002347469329834, 0.16687047481536865, 1.5074855089187622, 0.3736623525619507, 0.6534051895141602, 2.516484260559082, 1.0801007747650146, 0.4805253744125366, 1.1766769886016846, 0.8913347721099854, 1.7256286144256592, 0.17648100852966309, 0.24439716339111328, 0.13030457496643066, 0.07047295570373535, 1.3567478656768799, 0.36819136142730713, 0.26568782329559326, 0.6778998374938965, 0.4582650661468506, 0.2606571912765503], "mean_td_error": 0.9935774803161621, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 84224, "num_env_steps_trained": 23994, "num_agent_steps_sampled": 252672, "num_agent_steps_trained": 23994, "last_target_update_ts": 84224, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252672, "num_agent_steps_trained": 23994, "num_env_steps_sampled": 84224, "num_env_steps_trained": 23994, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 914.5065128933472, "num_env_steps_trained_throughput_per_sec": 263.3288842929504, "timesteps_total": 84224, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 252672, "timers": {"training_iteration_time_ms": 1036.181, "sample_time_ms": 721.936, "load_time_ms": 0.307, "load_throughput": 841339.163, "learn_time_ms": 18.153, "learn_throughput": 14212.284, "synch_weights_time_ms": 10.901}, "counters": {"num_env_steps_sampled": 84224, "num_env_steps_trained": 23994, "num_agent_steps_sampled": 252672, "num_agent_steps_trained": 23994, "last_target_update_ts": 84224, "num_target_updates": 93}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-15", "timestamp": 1700369895, "time_this_iter_s": 1.9681298732757568, "time_total_s": 98.4011619091034, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177439c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 98.4011619091034, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 70.60000000000001, "ram_util_percent": 66.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095096588134766, "actor_loss": -8.632891654968262, "critic_loss": 0.18502312898635864, "alpha_loss": -0.28465622663497925, "alpha_value": 0.9721963405609131, "log_alpha_value": -0.028197474777698517, "target_entropy": -6.0, "policy_t": -0.03283216804265976, "mean_q": 4.664981365203857, "max_q": 5.094964504241943, "min_q": 2.902256727218628}, "td_error": [1.095583438873291, 0.7199301719665527, 0.7641429901123047, 0.7046241760253906, 1.2550480365753174, 0.23257923126220703, 0.5144946575164795, 0.3812901973724365, 1.3966357707977295, 0.48451948165893555, 0.10943746566772461, 0.23429107666015625, 0.594306468963623, 0.14653253555297852, 0.47405362129211426, 0.5544524192810059, 3.0588111877441406, 0.27414464950561523, 0.5338060855865479, 2.6984126567840576, 0.26846814155578613, 0.08616852760314941, 0.820789098739624, 0.05009889602661133, 2.1148934364318848, 0.13057374954223633, 1.2191054821014404, 0.9723198413848877, 2.427504301071167, 0.06924772262573242, 0.5777397155761719, 0.7618863582611084, 0.20991826057434082, 1.6371548175811768, 0.7779321670532227, 1.516355037689209, 2.1454548835754395, 0.21532440185546875, 0.6679596900939941, 0.8533778190612793, 1.0545339584350586, 0.2585453987121582, 0.16866683959960938, 0.7123498916625977, 1.0786497592926025, 0.49411892890930176, 0.9823727607727051, 0.10947155952453613, 0.6075136661529541, 1.5061547756195068, 1.908076286315918, 0.10790824890136719, 1.4324820041656494, 1.7377557754516602, 2.844442844390869, 0.9349507093429565, 1.4868698120117188, 1.412083625793457, 1.6517765522003174, 1.0991215705871582, 2.192253828048706, 0.5264458656311035, 1.4627761840820312, 0.03518319129943848, 0.48865199089050293, 1.3746962547302246, 0.3630363941192627, 1.3820793628692627, 0.8544111251831055, 0.543602466583252, 0.2450873851776123, 0.3629920482635498, 1.791508674621582, 1.2809641361236572, 0.9431796073913574, 0.6938114166259766, 1.5440738201141357, 1.9580280780792236, 0.24758124351501465, 0.24198484420776367, 0.7634792327880859, 0.9692161083221436, 0.9200682640075684, 0.9662590026855469, 1.2134582996368408, 1.5808038711547852], "mean_td_error": 0.9335214495658875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09486198425293, "actor_loss": -6.735206127166748, "critic_loss": 0.10942539572715759, "alpha_loss": -0.2843521535396576, "alpha_value": 0.97222501039505, "log_alpha_value": -0.028168005868792534, "target_entropy": -6.0, "policy_t": -0.058134082704782486, "mean_q": 2.6901581287384033, "max_q": 2.844996929168701, "min_q": 2.51865291595459}, "td_error": [0.4930400848388672, 1.944943904876709, 2.1389894485473633, 0.3713047504425049, 0.5774147510528564, 0.2317643165588379, 0.4800550937652588, 0.5464166402816772, 0.3647480010986328, 2.905121326446533, 0.6862930059432983, 0.218092679977417, 0.22037231922149658, 1.039934754371643, 0.15183818340301514, 0.17226147651672363, 0.08180093765258789, 0.029058456420898438, 0.2745574712753296, 0.5882835388183594, 0.345072865486145, 0.7805719375610352, 0.6375129222869873, 0.9644533395767212, 3.060678005218506, 3.051250696182251, 0.3590965270996094, 2.4723474979400635, 1.2193503379821777, 0.5457861423492432, 0.3857065439224243, 0.4075368642807007, 0.5226283073425293, 1.8430893421173096, 1.0652644634246826, 0.48407280445098877, 2.1757736206054688, 3.0573930740356445, 0.7452328205108643, 1.4933284521102905, 1.663190484046936, 0.24613022804260254, 0.5461877584457397, 1.2289406061172485, 0.8626784086227417, 0.3540158271789551, 0.6862740516662598, 0.45307183265686035, 0.3726506233215332, 0.004377126693725586, 1.3581640720367432, 0.029145479202270508, 0.5489017963409424, 1.0874109268188477, 0.023923039436340332, 0.46608901023864746, 1.683721661567688, 1.0087504386901855, 0.7092225551605225, 1.6514017581939697, 0.013142704963684082, 1.4047389030456543, 0.3853590488433838, 0.1477954387664795, 0.059855103492736816, 1.27305006980896, 0.46148431301116943, 1.0355732440948486, 1.9439074993133545, 1.1354775428771973, 0.8064696788787842, 0.25520992279052734, 2.6394600868225098, 0.6607235670089722, 0.829325795173645, 1.0305452346801758, 0.3664586544036865, 0.3890873193740845, 0.34316253662109375, 2.228853702545166, 0.6211553812026978, 0.4445013999938965, 0.8962095975875854, 0.6674747467041016, 0.5065932273864746, 0.9821549654006958], "mean_td_error": 0.8795866966247559, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.014942169189453, "actor_loss": -6.579466342926025, "critic_loss": 0.12623563408851624, "alpha_loss": -0.28230464458465576, "alpha_value": 0.9722052216529846, "log_alpha_value": -0.028188349679112434, "target_entropy": -6.0, "policy_t": -0.07403197884559631, "mean_q": 2.573016881942749, "max_q": 3.3221566677093506, "min_q": 2.1313974857330322}, "td_error": [2.0466980934143066, 2.3706746101379395, 0.572284460067749, 0.6277366876602173, 0.8809237480163574, 0.1131899356842041, 0.053406715393066406, 1.513702154159546, 1.5709656476974487, 0.37124311923980713, 0.059674978256225586, 0.9993655681610107, 1.234701156616211, 0.4314134120941162, 2.2900772094726562, 0.8953537940979004, 0.5744338035583496, 0.9695913791656494, 1.0805621147155762, 1.7528266906738281, 1.1874269247055054, 1.4217259883880615, 0.5690248012542725, 0.66737961769104, 1.1709246635437012, 0.04595506191253662, 0.5297868251800537, 0.2028510570526123, 0.894287109375, 0.28919410705566406, 1.9054622650146484, 0.027342557907104492, 0.6868646144866943, 0.8858029842376709, 0.5311707258224487, 1.15967857837677, 0.42991602420806885, 1.2237237691879272, 0.19446969032287598, 0.02501213550567627, 1.7582544088363647, 0.3220047950744629, 0.05983233451843262, 1.1199119091033936, 0.8780006170272827, 1.703847050666809, 0.918510913848877, 0.737281084060669, 3.099299430847168, 0.2921781539916992, 0.958418607711792, 0.9184740781784058, 0.18080353736877441, 0.07248115539550781, 2.2631044387817383, 1.7708642482757568, 0.7690731287002563, 1.423806071281433, 0.5294326543807983, 1.3120222091674805, 0.9991946220397949, 0.6251710653305054, 0.45660340785980225, 0.4075016975402832, 0.2520430088043213, 0.636935830116272, 1.608170509338379, 0.29698920249938965, 0.7008644342422485, 0.0793306827545166, 1.1840381622314453, 1.679601788520813, 1.4138379096984863, 0.6292083263397217, 0.35595226287841797, 0.6210645437240601, 1.127842664718628, 1.928105115890503, 0.38742899894714355, 0.6365036964416504, 0.675154447555542, 2.2063589096069336, 0.4458726644515991, 0.054950714111328125, 0.8893425464630127, 0.5829042196273804], "mean_td_error": 0.8886674642562866, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "last_target_update_ts": 86016, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 944.9856405093236, "num_env_steps_trained_throughput_per_sec": 272.10524023594365, "timesteps_total": 86016, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 258048, "timers": {"training_iteration_time_ms": 1024.169, "sample_time_ms": 711.078, "load_time_ms": 0.308, "load_throughput": 836979.219, "learn_time_ms": 17.981, "learn_throughput": 14348.723, "synch_weights_time_ms": 10.588}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 24510, "num_agent_steps_sampled": 258048, "num_agent_steps_trained": 24510, "last_target_update_ts": 86016, "num_target_updates": 95}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-17", "timestamp": 1700369897, "time_this_iter_s": 1.9047892093658447, "time_total_s": 100.30595111846924, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 100.30595111846924, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 67.13333333333334, "ram_util_percent": 66.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.998590469360352, "actor_loss": -8.580789566040039, "critic_loss": 0.18340010941028595, "alpha_loss": -0.2879124879837036, "alpha_value": 0.9716153144836426, "log_alpha_value": -0.028795303776860237, "target_entropy": -6.0, "policy_t": -0.056163351982831955, "mean_q": 4.615211486816406, "max_q": 4.846437454223633, "min_q": 3.1715142726898193}, "td_error": [1.3225467205047607, 1.5030245780944824, 1.8341383934020996, 2.1499876976013184, 0.8302361965179443, 0.08334207534790039, 0.4046146869659424, 0.5174810886383057, 0.4288458824157715, 0.8718900680541992, 0.11010050773620605, 1.1852786540985107, 2.6797220706939697, 0.417264461517334, 1.0730180740356445, 0.6563663482666016, 1.8925328254699707, 1.04921555519104, 0.4567737579345703, 2.719592332839966, 0.8835697174072266, 2.1824049949645996, 3.62140154838562, 0.9392986297607422, 0.33463191986083984, 1.182197093963623, 0.6834948062896729, 0.7367043495178223, 1.2470848560333252, 0.18983030319213867, 1.7576684951782227, 0.5590288639068604, 1.6491992473602295, 0.6404633522033691, 0.9992117881774902, 0.6245031356811523, 1.579270362854004, 0.19809293746948242, 0.28259825706481934, 2.627331018447876, 0.3974626064300537, 0.8734238147735596, 0.22587990760803223, 2.15977144241333, 0.364001989364624, 1.3215796947479248, 1.0930731296539307, 0.33787012100219727, 0.31798219680786133, 1.1212584972381592, 0.47383880615234375, 0.5725464820861816, 1.5363311767578125, 0.5914969444274902, 0.04906415939331055, 0.32568788528442383, 0.10678291320800781, 1.1286087036132812, 0.5129845142364502, 0.5652000904083252, 0.13282537460327148, 0.4959712028503418, 1.431710958480835, 0.3635225296020508, 0.8896374702453613, 2.594027519226074, 0.5887398719787598, 0.7062258720397949, 0.41953444480895996, 0.7855262756347656, 0.9754915237426758, 0.15957045555114746, 0.5246412754058838, 2.3474137783050537, 1.2960827350616455, 0.12688469886779785, 0.15028905868530273, 0.15068602561950684, 0.016683578491210938, 0.41739845275878906, 3.789581298828125, 0.7481942176818848, 1.0474944114685059, 1.0397145748138428, 0.7330949306488037, 0.32970404624938965], "mean_td_error": 0.9469704031944275, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05276107788086, "actor_loss": -6.687061309814453, "critic_loss": 0.09472484886646271, "alpha_loss": -0.28918468952178955, "alpha_value": 0.9716431498527527, "log_alpha_value": -0.02876669354736805, "target_entropy": -6.0, "policy_t": -0.01858205534517765, "mean_q": 2.6780683994293213, "max_q": 3.813066244125366, "min_q": 2.1976675987243652}, "td_error": [0.40657734870910645, 0.13141143321990967, 0.49402475357055664, 0.29845428466796875, 0.2573891878128052, 1.157196283340454, 0.1191260814666748, 1.0251938104629517, 0.23307979106903076, 1.766553521156311, 0.8937400579452515, 0.3334333896636963, 0.0017964839935302734, 1.789872407913208, 0.5029844045639038, 0.10925459861755371, 0.3531208038330078, 1.9412434101104736, 1.8538252115249634, 0.3437917232513428, 0.325018048286438, 0.9595364332199097, 0.06143486499786377, 0.7171614170074463, 0.07008779048919678, 2.2717275619506836, 0.8232579231262207, 0.6068881750106812, 0.17103993892669678, 0.613184928894043, 0.4948563575744629, 1.102729320526123, 1.1192243099212646, 0.40877532958984375, 1.8080942630767822, 2.0517215728759766, 1.2914884090423584, 1.097873330116272, 2.0600929260253906, 0.45851802825927734, 0.5089356899261475, 0.577831506729126, 0.9413944482803345, 0.9012541770935059, 1.738050103187561, 0.44157874584198, 0.557414174079895, 0.4605981111526489, 1.343512773513794, 0.556206464767456, 1.452799916267395, 0.07826566696166992, 0.6855847835540771, 0.940078616142273, 1.341282606124878, 1.071002721786499, 0.8221348524093628, 2.757533550262451, 0.22448468208312988, 0.4536534547805786, 1.7484636306762695, 0.5248008966445923, 1.0959315299987793, 1.4820141792297363, 0.5115715265274048, 0.7680650949478149, 0.8860660791397095, 0.8378946781158447, 1.731852650642395, 0.38058996200561523, 0.6829028129577637, 1.1291186809539795, 0.5266004800796509, 0.48486101627349854, 0.12604570388793945, 0.9621948003768921, 0.32267045974731445, 1.1461962461471558, 0.40321385860443115, 0.5413908958435059, 0.1251049041748047, 0.6986097097396851, 0.7850552797317505, 1.071114420890808, 0.7000364065170288, 1.1637836694717407], "mean_td_error": 0.8280758261680603, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065437316894531, "actor_loss": -6.623546600341797, "critic_loss": 0.11417974531650543, "alpha_loss": -0.2897399961948395, "alpha_value": 0.9716247320175171, "log_alpha_value": -0.02878563292324543, "target_entropy": -6.0, "policy_t": -0.06320994347333908, "mean_q": 2.57914137840271, "max_q": 3.277863025665283, "min_q": 2.1358203887939453}, "td_error": [0.15147364139556885, 1.9834399223327637, 0.10820603370666504, 1.2985646724700928, 0.7150542736053467, 0.25590193271636963, 2.0844013690948486, 0.042711496353149414, 0.9985758066177368, 0.1485368013381958, 0.935613751411438, 0.3623408079147339, 0.7358098030090332, 1.8334760665893555, 0.9579976797103882, 0.44367527961730957, 0.9653818607330322, 0.638938307762146, 1.4378572702407837, 1.424884557723999, 0.4167633056640625, 0.5474306344985962, 1.2135751247406006, 1.3431496620178223, 0.9384883642196655, 0.021892547607421875, 1.2137928009033203, 1.0855339765548706, 0.2769390344619751, 1.2578561305999756, 1.2965623140335083, 1.2154793739318848, 0.7154475450515747, 0.28750360012054443, 0.4714634418487549, 0.17987990379333496, 0.1105813980102539, 0.5407871007919312, 0.8349684476852417, 2.281728982925415, 0.2669386863708496, 1.1545017957687378, 1.0400501489639282, 1.1529009342193604, 1.3906463384628296, 0.3472328186035156, 0.8758541345596313, 0.7075753211975098, 0.6917634010314941, 0.10498833656311035, 0.227891206741333, 1.3308709859848022, 1.4569623470306396, 0.16357052326202393, 0.7692123651504517, 1.1651965379714966, 0.7120743989944458, 0.5871998071670532, 0.02502155303955078, 0.3254498243331909, 1.3618375062942505, 0.44518518447875977, 0.8119398355484009, 1.7463595867156982, 0.6933184862136841, 1.5433844327926636, 0.5631042718887329, 0.4752027988433838, 0.5660711526870728, 1.2687053680419922, 0.25567948818206787, 0.21476149559020996, 0.9461081027984619, 1.4132728576660156, 0.7995132207870483, 1.7809064388275146, 0.2648434638977051, 0.7164056301116943, 0.15373563766479492, 0.8473193645477295, 1.025610089302063, 0.5811169147491455, 0.026888012886047363, 0.09296643733978271, 0.855076789855957, 2.739712715148926], "mean_td_error": 0.819274365901947, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}, "num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "last_target_update_ts": 87808, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 928.226993349071, "num_env_steps_trained_throughput_per_sec": 267.2796476384602, "timesteps_total": 87808, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 263424, "timers": {"training_iteration_time_ms": 1016.725, "sample_time_ms": 705.654, "load_time_ms": 0.311, "load_throughput": 830045.587, "learn_time_ms": 17.942, "learn_throughput": 14379.324, "synch_weights_time_ms": 10.335}, "counters": {"num_env_steps_sampled": 87808, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 263424, "num_agent_steps_trained": 25026, "last_target_update_ts": 87808, "num_target_updates": 97}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-19", "timestamp": 1700369899, "time_this_iter_s": 1.9396030902862549, "time_total_s": 102.2455542087555, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.2455542087555, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 65.86666666666666, "ram_util_percent": 66.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.052495002746582, "actor_loss": -8.630797386169434, "critic_loss": 0.16679182648658752, "alpha_loss": -0.2954738736152649, "alpha_value": 0.9710347056388855, "log_alpha_value": -0.029393088072538376, "target_entropy": -6.0, "policy_t": -0.05417148768901825, "mean_q": 4.59340238571167, "max_q": 4.89804744720459, "min_q": 3.1700057983398438}, "td_error": [2.7420976161956787, 0.6947231292724609, 0.3478891849517822, 0.7813267707824707, 0.2324233055114746, 1.4432508945465088, 0.4555668830871582, 1.156989574432373, 0.12633609771728516, 1.8558130264282227, 0.07481169700622559, 0.37549686431884766, 1.0246763229370117, 0.6693799495697021, 0.14517974853515625, 0.49901890754699707, 1.5379767417907715, 0.25963878631591797, 0.18109536170959473, 0.3944096565246582, 1.939234972000122, 0.3610818386077881, 0.025172948837280273, 2.721360683441162, 0.7037265300750732, 0.16756176948547363, 1.0889196395874023, 0.582230806350708, 0.6489298343658447, 0.20070695877075195, 0.11465764045715332, 1.3951306343078613, 0.6649837493896484, 1.3539459705352783, 1.2069873809814453, 1.4806525707244873, 1.779306411743164, 1.0901453495025635, 0.3081362247467041, 0.5899817943572998, 1.357964277267456, 1.0405552387237549, 0.5352466106414795, 0.9832906723022461, 1.0846073627471924, 0.11763668060302734, 0.6045057773590088, 1.376450777053833, 0.22572660446166992, 0.7820179462432861, 0.9025363922119141, 0.846534252166748, 1.5776572227478027, 0.8142518997192383, 0.9413497447967529, 0.8838796615600586, 0.16317987442016602, 0.029482364654541016, 0.49225497245788574, 0.3648066520690918, 0.83847975730896, 2.7610392570495605, 0.17500519752502441, 2.010390281677246, 1.7953364849090576, 1.6764934062957764, 0.879688024520874, 0.5140109062194824, 1.7579879760742188, 0.25779223442077637, 0.3555107116699219, 0.5943169593811035, 0.865687370300293, 0.9065778255462646, 0.3898286819458008, 0.8223617076873779, 1.0287556648254395, 0.007359027862548828, 2.2988104820251465, 1.1706185340881348, 1.1162164211273193, 0.5777432918548584, 1.38063383102417, 0.13482213020324707, 1.8007292747497559, 0.6173090934753418], "mean_td_error": 0.8753302097320557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056537628173828, "actor_loss": -6.664888381958008, "critic_loss": 0.08536180853843689, "alpha_loss": -0.2953137755393982, "alpha_value": 0.971061646938324, "log_alpha_value": -0.029365351423621178, "target_entropy": -6.0, "policy_t": -0.018208926543593407, "mean_q": 2.6555912494659424, "max_q": 2.7341268062591553, "min_q": 2.358205795288086}, "td_error": [0.4684758186340332, 0.45782470703125, 0.32843923568725586, 1.4798805713653564, 0.34034883975982666, 1.0298372507095337, 1.0348906517028809, 0.42866218090057373, 2.484610080718994, 0.12966549396514893, 0.7354233264923096, 0.2652437686920166, 0.646286129951477, 0.8740745782852173, 1.743291974067688, 0.3358801603317261, 0.4948081970214844, 0.9594910144805908, 0.628778338432312, 1.614441990852356, 0.5854731798171997, 0.29231977462768555, 0.023507356643676758, 0.1731506586074829, 1.2662831544876099, 1.6268566846847534, 2.117633819580078, 1.1653778553009033, 0.9723227024078369, 0.5713040828704834, 1.719021201133728, 1.4910964965820312, 0.6029177904129028, 0.4536391496658325, 0.4356088638305664, 0.47811174392700195, 0.6008756160736084, 0.3634912967681885, 0.21781706809997559, 0.4746706485748291, 0.2369215488433838, 1.6651718616485596, 0.1324021816253662, 0.9232661724090576, 0.6675204038619995, 0.09824907779693604, 1.2849918603897095, 1.3633506298065186, 0.09327173233032227, 0.12369203567504883, 1.2285761833190918, 1.034203052520752, 0.28315019607543945, 0.44410204887390137, 0.11164355278015137, 0.18369293212890625, 0.514354944229126, 1.5370471477508545, 0.3807178735733032, 1.795854926109314, 0.22516632080078125, 0.41223084926605225, 0.4294508695602417, 0.13423359394073486, 0.16791272163391113, 0.1933460235595703, 0.309242844581604, 1.6093333959579468, 1.8236825466156006, 0.2964106798171997, 1.1333593130111694, 0.6882913112640381, 0.46604597568511963, 0.01792168617248535, 0.6251249313354492, 0.47624433040618896, 0.6377573013305664, 1.231665849685669, 0.49061834812164307, 2.0532002449035645, 0.030431389808654785, 0.5326718091964722, 1.5080143213272095, 0.32881486415863037, 2.111757755279541, 0.48913419246673584], "mean_td_error": 0.7515822052955627, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078455924987793, "actor_loss": -6.613564968109131, "critic_loss": 0.1330605298280716, "alpha_loss": -0.29613685607910156, "alpha_value": 0.9710443019866943, "log_alpha_value": -0.029383158311247826, "target_entropy": -6.0, "policy_t": -0.05848687142133713, "mean_q": 2.5767486095428467, "max_q": 2.7691738605499268, "min_q": 2.1083357334136963}, "td_error": [0.9632785320281982, 1.0124831199645996, 2.6558644771575928, 0.5213799476623535, 0.12286698818206787, 1.0279464721679688, 0.04720866680145264, 2.0013248920440674, 0.5623068809509277, 0.21046721935272217, 0.08761239051818848, 0.3755323886871338, 1.0114476680755615, 0.69040846824646, 0.2734048366546631, 0.4334745407104492, 1.0897635221481323, 0.08958172798156738, 1.6477370262145996, 1.0412592887878418, 1.0450259447097778, 0.43800437450408936, 1.9693124294281006, 3.9214723110198975, 1.8428455591201782, 1.0087860822677612, 1.236457109451294, 0.2866668701171875, 1.008470058441162, 0.4546499252319336, 2.341564655303955, 0.7418285608291626, 0.4454392194747925, 0.3660041093826294, 1.307220697402954, 0.634235143661499, 0.6422981023788452, 2.050252676010132, 1.500198483467102, 1.136377215385437, 0.7762619256973267, 0.1591092348098755, 0.20711922645568848, 0.5319982767105103, 0.5453329086303711, 1.4630628824234009, 0.14192116260528564, 1.3695532083511353, 1.647361159324646, 1.2743780612945557, 2.262895107269287, 0.015070199966430664, 0.723786473274231, 0.968994140625, 1.779374122619629, 0.5013324022293091, 1.4586399793624878, 0.6218858957290649, 0.5646698474884033, 0.27005481719970703, 0.24425101280212402, 0.5487037897109985, 0.8436131477355957, 1.2185819149017334, 0.23323988914489746, 0.23817181587219238, 0.5473012924194336, 0.2831301689147949, 1.4283807277679443, 1.1687054634094238, 1.1847678422927856, 0.18416345119476318, 0.3832613229751587, 1.312499761581421, 1.0209228992462158, 0.9598226547241211, 1.886871576309204, 0.15752935409545898, 1.5948580503463745, 0.18440306186676025, 0.37501752376556396, 0.004420638084411621, 0.41150081157684326, 0.45625436305999756, 2.2643446922302246, 0.8036843538284302], "mean_td_error": 0.9007402658462524, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "last_target_update_ts": 89600, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 950.7523625577619, "num_env_steps_trained_throughput_per_sec": 273.7657472543555, "timesteps_total": 89600, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 268800, "timers": {"training_iteration_time_ms": 1013.527, "sample_time_ms": 703.626, "load_time_ms": 0.315, "load_throughput": 819982.141, "learn_time_ms": 17.97, "learn_throughput": 14356.87, "synch_weights_time_ms": 9.878}, "counters": {"num_env_steps_sampled": 89600, "num_env_steps_trained": 25542, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 25542, "last_target_update_ts": 89600, "num_target_updates": 99}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-21", "timestamp": 1700369901, "time_this_iter_s": 1.8934881687164307, "time_total_s": 104.13904237747192, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 104.13904237747192, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 73.2, "ram_util_percent": 66.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.024811744689941, "actor_loss": -8.567911148071289, "critic_loss": 0.1645992249250412, "alpha_loss": -0.30065253376960754, "alpha_value": 0.9704544544219971, "log_alpha_value": -0.02999083884060383, "target_entropy": -6.0, "policy_t": -0.07713071256875992, "mean_q": 4.589910984039307, "max_q": 4.793915748596191, "min_q": 2.8335723876953125}, "td_error": [0.05701637268066406, 0.6759450435638428, 0.10118389129638672, 0.39940404891967773, 1.5379674434661865, 0.09180593490600586, 0.8758416175842285, 0.1889934539794922, 1.3869595527648926, 0.260479211807251, 1.3815360069274902, 0.08208680152893066, 0.3328280448913574, 3.4872727394104004, 1.2873985767364502, 0.6960806846618652, 0.15934991836547852, 0.2771942615509033, 1.328615427017212, 1.2070796489715576, 1.5440902709960938, 0.010275840759277344, 2.1698122024536133, 1.130620002746582, 0.0633690357208252, 1.880009412765503, 1.177825927734375, 0.46419763565063477, 0.9395256042480469, 0.2856411933898926, 1.7658295631408691, 0.8929603099822998, 0.9971809387207031, 1.4850387573242188, 0.44564366340637207, 1.8353416919708252, 0.24141216278076172, 1.7174880504608154, 1.2372524738311768, 1.5341393947601318, 1.7695353031158447, 0.47474050521850586, 0.20344829559326172, 0.17236638069152832, 0.7521471977233887, 2.5942187309265137, 0.41843509674072266, 0.3738272190093994, 0.2563323974609375, 0.4623146057128906, 0.7012395858764648, 0.4801342487335205, 0.24435710906982422, 1.0829458236694336, 1.0955615043640137, 0.1540966033935547, 1.104844093322754, 1.1643598079681396, 0.3682708740234375, 0.937408447265625, 0.8689773082733154, 1.9295804500579834, 1.2871971130371094, 1.3810510635375977, 1.951371669769287, 0.2352614402770996, 0.8571949005126953, 0.7154359817504883, 0.10975074768066406, 0.9812653064727783, 0.8800764083862305, 1.561418056488037, 1.2798588275909424, 0.5701127052307129, 1.3825078010559082, 1.828439474105835, 1.9830236434936523, 0.668734073638916, 0.5977146625518799, 2.8063161373138428, 1.7324447631835938, 0.29978108406066895, 0.5208616256713867, 0.5689969062805176, 0.16800713539123535, 0.3573758602142334], "mean_td_error": 0.9298375844955444, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06488037109375, "actor_loss": -6.670914649963379, "critic_loss": 0.1047595664858818, "alpha_loss": -0.3015836775302887, "alpha_value": 0.9704805016517639, "log_alpha_value": -0.029963959008455276, "target_entropy": -6.0, "policy_t": -0.028505777940154076, "mean_q": 2.6449191570281982, "max_q": 2.724186897277832, "min_q": 2.204646587371826}, "td_error": [0.4183371067047119, 0.427060604095459, 1.280735731124878, 1.1935769319534302, 1.3130161762237549, 0.2367246150970459, 0.4117337465286255, 0.7976381778717041, 1.1052168607711792, 0.2721623182296753, 0.9068925380706787, 1.0378481149673462, 0.3422873020172119, 0.4017634391784668, 1.7142915725708008, 0.320080041885376, 0.3271596431732178, 1.836374044418335, 2.2204060554504395, 0.020764589309692383, 1.4301121234893799, 0.009453296661376953, 0.2754199504852295, 0.6495507955551147, 0.6504417657852173, 1.053348422050476, 0.33459532260894775, 0.8844887018203735, 1.8484686613082886, 0.09514009952545166, 0.8461918830871582, 0.20652556419372559, 1.867307424545288, 0.662674069404602, 0.7056190967559814, 0.3330042362213135, 2.1352944374084473, 1.5919512510299683, 0.2056589126586914, 1.0040476322174072, 1.1157654523849487, 0.08464717864990234, 0.4407927989959717, 0.6386446952819824, 1.1378657817840576, 0.5260293483734131, 1.2488089799880981, 1.2653532028198242, 0.5867904424667358, 1.4796189069747925, 0.8356040716171265, 0.5209935903549194, 1.3390495777130127, 1.0782185792922974, 0.5012162923812866, 0.3191821575164795, 0.9035549163818359, 0.06387603282928467, 0.39124369621276855, 1.0040230751037598, 1.8601677417755127, 0.4720231294631958, 1.1408520936965942, 0.6763725280761719, 2.4398436546325684, 1.0916975736618042, 0.6153844594955444, 0.7796802520751953, 1.7488148212432861, 1.0049662590026855, 0.9425234794616699, 0.32595765590667725, 0.1658841371536255, 0.7391928434371948, 0.3097836971282959, 0.15584862232208252, 1.6908652782440186, 0.10811746120452881, 0.04224753379821777, 1.8049715757369995, 2.159038782119751, 1.406020164489746, 0.00814056396484375, 1.3868709802627563, 1.0157140493392944, 2.0171942710876465], "mean_td_error": 0.8716606497764587, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05030345916748, "actor_loss": -6.612332344055176, "critic_loss": 0.12184317409992218, "alpha_loss": -0.3013177514076233, "alpha_value": 0.9704639911651611, "log_alpha_value": -0.029980959370732307, "target_entropy": -6.0, "policy_t": -0.029837142676115036, "mean_q": 2.585700035095215, "max_q": 2.8039565086364746, "min_q": 2.0608816146850586}, "td_error": [0.8133702278137207, 0.26813411712646484, 0.4053497314453125, 0.8363784551620483, 0.3075222969055176, 2.0236682891845703, 0.18386614322662354, 0.41212010383605957, 1.6918911933898926, 1.0201447010040283, 1.0600907802581787, 0.45581650733947754, 0.9813817739486694, 0.03597426414489746, 0.18039309978485107, 1.237549901008606, 0.5140814781188965, 0.9791091680526733, 0.7632815837860107, 1.376962661743164, 0.4301908016204834, 0.7044957876205444, 0.6216031312942505, 0.46045875549316406, 0.7565557956695557, 1.8454855680465698, 1.3715226650238037, 0.638534426689148, 1.3343935012817383, 2.0139119625091553, 0.7304258346557617, 0.5043597221374512, 0.06056630611419678, 1.4154261350631714, 0.6108670234680176, 0.3460080623626709, 0.679131269454956, 0.8130266666412354, 1.19437837600708, 0.22261357307434082, 1.2534066438674927, 0.7177448272705078, 1.3500810861587524, 1.2489713430404663, 0.02507460117340088, 0.027984619140625, 1.6922023296356201, 0.05743825435638428, 1.3811217546463013, 1.7260318994522095, 0.7977529764175415, 0.967856764793396, 0.21358788013458252, 0.37842559814453125, 0.40317416191101074, 0.2711230516433716, 1.2862948179244995, 0.7696378231048584, 1.0953929424285889, 1.5084565877914429, 1.3294731378555298, 0.6489635705947876, 1.178724765777588, 1.444387435913086, 1.2606101036071777, 1.1805542707443237, 0.7564338445663452, 1.225021481513977, 1.210126519203186, 1.2632118463516235, 0.719711422920227, 1.309685230255127, 0.9147013425827026, 1.5209319591522217, 1.2612217664718628, 0.12647831439971924, 0.6923508644104004, 0.4098163843154907, 0.47263121604919434, 2.0813651084899902, 1.3286163806915283, 0.6093263626098633, 0.7187292575836182, 0.30019211769104004, 1.3592599630355835, 1.116471767425537], "mean_td_error": 0.8826953172683716, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "last_target_update_ts": 91392, "num_target_updates": 101}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 955.7817038368387, "num_env_steps_trained_throughput_per_sec": 275.21392811373255, "timesteps_total": 91392, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 274176, "timers": {"training_iteration_time_ms": 954.596, "sample_time_ms": 682.898, "load_time_ms": 0.315, "load_throughput": 817936.834, "learn_time_ms": 18.005, "learn_throughput": 14329.665, "synch_weights_time_ms": 9.716}, "counters": {"num_env_steps_sampled": 91392, "num_env_steps_trained": 26058, "num_agent_steps_sampled": 274176, "num_agent_steps_trained": 26058, "last_target_update_ts": 91392, "num_target_updates": 101}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-23", "timestamp": 1700369903, "time_this_iter_s": 1.8830957412719727, "time_total_s": 106.0221381187439, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 106.0221381187439, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 70.76666666666667, "ram_util_percent": 66.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.971375465393066, "actor_loss": -8.517668724060059, "critic_loss": 0.20972907543182373, "alpha_loss": -0.30500563979148865, "alpha_value": 0.9698749780654907, "log_alpha_value": -0.030588123947381973, "target_entropy": -6.0, "policy_t": -0.08089228719472885, "mean_q": 4.493683338165283, "max_q": 4.76973819732666, "min_q": 2.88236665725708}, "td_error": [0.683983325958252, 1.5379929542541504, 2.553130626678467, 1.1220791339874268, 0.9912700653076172, 1.9192023277282715, 0.6793897151947021, 2.5182995796203613, 1.9772512912750244, 0.01363229751586914, 1.025066614151001, 1.4902148246765137, 1.6794296503067017, 1.9535744190216064, 0.789417028427124, 0.8582351207733154, 2.4658684730529785, 1.7304251194000244, 0.5899753570556641, 0.7666234970092773, 0.7525076866149902, 2.511776924133301, 0.323397159576416, 0.293194055557251, 0.12082338333129883, 1.317542552947998, 0.4470396041870117, 0.8842041492462158, 2.2771575450897217, 0.16652965545654297, 0.35302042961120605, 0.9496846199035645, 1.1675431728363037, 0.16306519508361816, 1.5867469310760498, 0.5021147727966309, 2.824331760406494, 0.8335304260253906, 1.1852011680603027, 0.4923222064971924, 1.120739459991455, 0.7952418327331543, 0.3247978687286377, 0.7498149871826172, 0.1741623878479004, 0.11606001853942871, 0.0970306396484375, 1.835078239440918, 1.053025484085083, 1.4128739833831787, 0.7008850574493408, 1.831458330154419, 0.338245153427124, 1.7269713878631592, 1.2792038917541504, 1.0325212478637695, 1.8333847522735596, 0.7850103378295898, 1.0869207382202148, 0.45415639877319336, 1.923408031463623, 0.08130860328674316, 1.3004150390625, 0.319549560546875, 0.2775084972381592, 0.6651337146759033, 1.7049124240875244, 0.4014134407043457, 1.5532619953155518, 1.214189052581787, 0.7881066799163818, 0.46418046951293945, 0.09724736213684082, 1.1720120906829834, 0.9579305648803711, 1.7914018630981445, 1.044301152229309, 1.9182816743850708, 0.680549144744873, 3.063497304916382, 1.7939321994781494, 2.2442777156829834, 0.34526586532592773, 1.5333311557769775, 1.914902925491333, 0.22307634353637695], "mean_td_error": 1.1013693809509277, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121465682983398, "actor_loss": -6.680761337280273, "critic_loss": 0.09161096811294556, "alpha_loss": -0.30934008955955505, "alpha_value": 0.9698995351791382, "log_alpha_value": -0.03056277707219124, "target_entropy": -6.0, "policy_t": -0.028872529044747353, "mean_q": 2.6395761966705322, "max_q": 2.951016426086426, "min_q": 2.181959629058838}, "td_error": [1.0080301761627197, 0.5203592777252197, 0.3740760087966919, 0.46367061138153076, 0.8977856636047363, 1.7666566371917725, 0.48639822006225586, 0.28948450088500977, 0.5985321998596191, 1.23658287525177, 0.4256763458251953, 0.7956137657165527, 0.7149703502655029, 1.22769033908844, 0.6578972339630127, 0.8378260135650635, 0.7449193000793457, 0.9314477443695068, 0.5317897796630859, 0.5128463506698608, 0.006275773048400879, 0.8506721258163452, 0.058972835540771484, 1.326607346534729, 0.8705908060073853, 0.32585835456848145, 0.8114345073699951, 0.5418230295181274, 1.169062614440918, 1.9141685962677002, 0.6393578052520752, 1.6658114194869995, 0.450215220451355, 0.4912623167037964, 0.5028713941574097, 0.25947022438049316, 0.2959812879562378, 0.054671287536621094, 1.985689640045166, 0.5385029315948486, 0.6653640270233154, 2.0684709548950195, 0.6243432760238647, 0.6863192319869995, 0.5070217847824097, 0.7275708913803101, 0.05883800983428955, 1.472055435180664, 0.12980055809020996, 0.7609424591064453, 0.4201093912124634, 1.3295295238494873, 1.1779913902282715, 0.837486982345581, 0.9614549875259399, 0.6738282442092896, 0.7968822717666626, 0.3555006980895996, 0.6995365619659424, 0.2960320711135864, 3.2436723709106445, 1.3861637115478516, 0.5794960260391235, 0.08373391628265381, 0.37174487113952637, 0.3608126640319824, 1.1560485363006592, 1.042966365814209, 0.8088827133178711, 1.9674246311187744, 2.088838577270508, 0.7887914180755615, 1.206510305404663, 0.5670287609100342, 0.43743109703063965, 0.3018624782562256, 0.8698184490203857, 0.5050216913223267, 1.3819842338562012, 0.2637054920196533, 0.4658464193344116, 0.8277187347412109, 2.2811269760131836, 0.4130361080169678, 1.886533498764038, 0.12486648559570312], "mean_td_error": 0.8190894722938538, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034478187561035, "actor_loss": -6.605895519256592, "critic_loss": 0.11723218858242035, "alpha_loss": -0.3068457841873169, "alpha_value": 0.9698836803436279, "log_alpha_value": -0.03057914599776268, "target_entropy": -6.0, "policy_t": -0.04274996742606163, "mean_q": 2.600688934326172, "max_q": 2.699960708618164, "min_q": 2.0381569862365723}, "td_error": [1.3814820051193237, 1.0156170129776, 0.23421728610992432, 0.21052467823028564, 1.9528247117996216, 0.6281777620315552, 1.518322229385376, 1.472717523574829, 1.4106602668762207, 0.05396568775177002, 0.2654534578323364, 0.46822571754455566, 0.02284550666809082, 1.8589588403701782, 0.8870978355407715, 0.12926137447357178, 0.20199072360992432, 1.8402842283248901, 0.38648855686187744, 1.486109733581543, 1.112891674041748, 0.5133218765258789, 1.1126049757003784, 0.2277536392211914, 0.8896576166152954, 1.6760516166687012, 0.05908370018005371, 0.06770849227905273, 1.806571364402771, 0.380969762802124, 1.3562517166137695, 3.1083431243896484, 0.9126834869384766, 1.079045057296753, 0.2520616054534912, 2.1715445518493652, 2.4181175231933594, 0.03483116626739502, 0.5941264629364014, 1.0504734516143799, 0.9313720464706421, 1.0878198146820068, 0.42473113536834717, 0.6628667116165161, 0.37344133853912354, 0.3888416290283203, 0.18788063526153564, 0.07883787155151367, 0.34594953060150146, 1.054829478263855, 1.5015791654586792, 0.6131737232208252, 1.08327054977417, 1.225942850112915, 0.5593382120132446, 0.7158218622207642, 0.1557321548461914, 0.7130974531173706, 2.058619499206543, 0.8267130851745605, 0.5772309303283691, 1.3857471942901611, 1.5364488363265991, 0.555126428604126, 0.4415401220321655, 0.9998579025268555, 0.19453740119934082, 0.7742310762405396, 0.5599626302719116, 0.5885568857192993, 1.2858269214630127, 0.14561784267425537, 0.6947505474090576, 0.5003421306610107, 0.23244845867156982, 0.3650444746017456, 0.7589727640151978, 0.3495347499847412, 0.985337495803833, 0.23123180866241455, 0.6008673906326294, 1.7365117073059082, 0.8215194940567017, 0.5272300243377686, 1.3507367372512817, 0.3458981513977051], "mean_td_error": 0.8347011208534241, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 26574, "num_agent_steps_sampled": 279552, "num_agent_steps_trained": 26574, "last_target_update_ts": 93184, "num_target_updates": 103}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279552, "num_agent_steps_trained": 26574, "num_env_steps_sampled": 93184, "num_env_steps_trained": 26574, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 926.6374646093607, "num_env_steps_trained_throughput_per_sec": 266.82194851474895, "timesteps_total": 93184, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 279552, "timers": {"training_iteration_time_ms": 952.031, "sample_time_ms": 680.121, "load_time_ms": 0.315, "load_throughput": 818679.401, "learn_time_ms": 18.082, "learn_throughput": 14268.654, "synch_weights_time_ms": 9.546}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 26574, "num_agent_steps_sampled": 279552, "num_agent_steps_trained": 26574, "last_target_update_ts": 93184, "num_target_updates": 103}, "done": false, "episodes_total": 0, "training_iteration": 68, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-25", "timestamp": 1700369905, "time_this_iter_s": 1.9425311088562012, "time_total_s": 107.9646692276001, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.9646692276001, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 69.86666666666667, "ram_util_percent": 66.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.008249282836914, "actor_loss": -8.568509101867676, "critic_loss": 0.15402792394161224, "alpha_loss": -0.3121070861816406, "alpha_value": 0.9692962765693665, "log_alpha_value": -0.031184980645775795, "target_entropy": -6.0, "policy_t": -0.07744652032852173, "mean_q": 4.583785533905029, "max_q": 5.046341896057129, "min_q": 3.220471143722534}, "td_error": [2.370619297027588, 2.530513048171997, 0.37326598167419434, 0.07364797592163086, 0.5475945472717285, 1.9842228889465332, 0.32555723190307617, 1.6279816627502441, 0.07214236259460449, 1.2491142749786377, 0.15687990188598633, 0.11909818649291992, 0.1654667854309082, 1.960695743560791, 0.10178685188293457, 0.14977502822875977, 2.13970685005188, 1.7226696014404297, 0.6547038555145264, 0.8719608783721924, 0.9611949920654297, 0.46367716789245605, 3.345912456512451, 0.12428879737854004, 0.47101545333862305, 0.7781281471252441, 0.8419456481933594, 1.825944423675537, 0.0859231948852539, 0.3703179359436035, 0.4279909133911133, 1.5224199295043945, 0.014791727066040039, 2.386354923248291, 0.7801635265350342, 0.8313994407653809, 0.3325495719909668, 0.19520235061645508, 0.918281078338623, 1.425858736038208, 0.8799769878387451, 2.443115234375, 0.9781975746154785, 0.6552577018737793, 1.0722293853759766, 0.9098937511444092, 1.9854564666748047, 0.23213982582092285, 0.01685190200805664, 0.33451199531555176, 1.1843523979187012, 0.5587911605834961, 2.0725820064544678, 0.47564220428466797, 0.5840752124786377, 1.453721046447754, 2.500415086746216, 0.02519965171813965, 0.5939943790435791, 0.3401165008544922, 0.5376713275909424, 1.1139976978302002, 0.5385951995849609, 0.27124977111816406, 0.554265022277832, 1.6429519653320312, 0.15352296829223633, 0.24014067649841309, 1.8361155986785889, 1.1281614303588867, 0.8516178131103516, 0.8473641872406006, 1.1452441215515137, 0.9959594011306763, 1.3515822887420654, 0.6764113903045654, 0.6996345520019531, 0.9114837646484375, 0.8686752319335938, 0.8277437686920166, 1.0521361827850342, 0.1490163803100586, 0.14403939247131348, 1.2396721839904785, 0.1399538516998291, 0.47919631004333496], "mean_td_error": 0.895275354385376, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080425262451172, "actor_loss": -6.637612819671631, "critic_loss": 0.10339412093162537, "alpha_loss": -0.3141288757324219, "alpha_value": 0.9693182706832886, "log_alpha_value": -0.031162265688180923, "target_entropy": -6.0, "policy_t": -0.03716004639863968, "mean_q": 2.6171953678131104, "max_q": 2.687760829925537, "min_q": 2.177391529083252}, "td_error": [1.1533067226409912, 1.0659611225128174, 0.2892824411392212, 0.5327966213226318, 0.7153199911117554, 1.0569614171981812, 1.1144288778305054, 0.5969150066375732, 0.5946779251098633, 2.047551393508911, 0.5865167379379272, 1.105462908744812, 1.2276248931884766, 1.460321068763733, 1.1196966171264648, 2.229170322418213, 0.3540472984313965, 1.3952794075012207, 0.450215220451355, 0.18302786350250244, 0.7094016075134277, 1.177981972694397, 0.5375652313232422, 0.6529957056045532, 1.2292242050170898, 0.2763233184814453, 0.49720609188079834, 0.8212080001831055, 0.6506985425949097, 0.8270509243011475, 0.5102280378341675, 1.0409924983978271, 1.8589980602264404, 0.17752432823181152, 1.724603533744812, 0.3418452739715576, 0.7663408517837524, 0.452404260635376, 1.0635647773742676, 0.7149127721786499, 1.0543526411056519, 0.2990952730178833, 2.4028377532958984, 1.6927931308746338, 2.571845054626465, 0.7706426382064819, 3.033756732940674, 0.3703867197036743, 0.5261571407318115, 1.9817591905593872, 0.5595136880874634, 0.5383481979370117, 0.6265342235565186, 0.047704458236694336, 0.13762545585632324, 1.0003843307495117, 0.9472286701202393, 0.5000438690185547, 0.15585625171661377, 0.0252230167388916, 1.0789272785186768, 2.9172232151031494, 0.10447359085083008, 1.6305559873580933, 1.674225926399231, 0.2811223268508911, 0.33060526847839355, 0.5645277500152588, 1.5855387449264526, 0.12851440906524658, 0.44887447357177734, 0.25563788414001465, 1.1352105140686035, 0.42858195304870605, 1.089653730392456, 0.8679656982421875, 0.6075167655944824, 0.020720601081848145, 1.6197831630706787, 0.25870466232299805, 0.4549604654312134, 0.0737687349319458, 0.19086754322052002, 0.6546214818954468, 0.48227620124816895, 1.4941399097442627], "mean_td_error": 0.8712875247001648, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097184181213379, "actor_loss": -6.663045406341553, "critic_loss": 0.15174245834350586, "alpha_loss": -0.31480473279953003, "alpha_value": 0.969303548336029, "log_alpha_value": -0.03117748163640499, "target_entropy": -6.0, "policy_t": -0.03673529624938965, "mean_q": 2.634207010269165, "max_q": 2.9597580432891846, "min_q": 2.019841432571411}, "td_error": [0.6914234161376953, 1.1096558570861816, 0.9211956262588501, 1.9021599292755127, 0.06694269180297852, 1.3700718879699707, 0.5145899057388306, 0.5980087518692017, 0.09366309642791748, 1.2311418056488037, 0.24943757057189941, 0.7064347267150879, 1.136810302734375, 0.7873163223266602, 0.14290452003479004, 0.14574217796325684, 1.0779818296432495, 0.3429452180862427, 2.786430835723877, 1.3620132207870483, 1.8247265815734863, 0.5217937231063843, 1.2758729457855225, 1.31680166721344, 0.13245201110839844, 0.7329658269882202, 0.3876763582229614, 0.6957805156707764, 0.8074779510498047, 0.30988264083862305, 1.2356995344161987, 0.7508754730224609, 0.6362249851226807, 0.9453541040420532, 1.4874216318130493, 0.3680201768875122, 1.3695484399795532, 0.8460923433303833, 1.1749460697174072, 0.5718176364898682, 1.8606289625167847, 0.846855640411377, 0.919044017791748, 1.116894245147705, 1.637359857559204, 2.3087029457092285, 0.9147471189498901, 0.1680459976196289, 0.2967808246612549, 0.15506398677825928, 0.8853296041488647, 0.866508960723877, 0.7348854541778564, 0.4411919116973877, 0.0852813720703125, 2.2196671962738037, 0.159842848777771, 0.09771418571472168, 1.9815219640731812, 0.10907816886901855, 0.15860342979431152, 1.8718541860580444, 0.2835965156555176, 0.6106958389282227, 1.0467932224273682, 0.3488304615020752, 3.12996768951416, 1.2930126190185547, 0.6428558826446533, 0.7683671712875366, 0.05409073829650879, 0.45049500465393066, 1.441347360610962, 1.3482834100723267, 0.7238614559173584, 0.835810661315918, 3.5552849769592285, 0.6332008838653564, 1.789210319519043, 1.3697291612625122, 1.5268137454986572, 2.4477696418762207, 2.4348673820495605, 1.2119325399398804, 2.045571804046631, 0.48027729988098145], "mean_td_error": 0.987634539604187, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}}, "num_env_steps_sampled": 94976, "num_env_steps_trained": 27090, "num_agent_steps_sampled": 284928, "num_agent_steps_trained": 27090, "last_target_update_ts": 94976, "num_target_updates": 105}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284928, "num_agent_steps_trained": 27090, "num_env_steps_sampled": 94976, "num_env_steps_trained": 27090, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 850.0618832798609, "num_env_steps_trained_throughput_per_sec": 244.7722833551385, "timesteps_total": 94976, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 284928, "timers": {"training_iteration_time_ms": 973.208, "sample_time_ms": 700.707, "load_time_ms": 0.316, "load_throughput": 815840.193, "learn_time_ms": 18.058, "learn_throughput": 14286.946, "synch_weights_time_ms": 9.672}, "counters": {"num_env_steps_sampled": 94976, "num_env_steps_trained": 27090, "num_agent_steps_sampled": 284928, "num_agent_steps_trained": 27090, "last_target_update_ts": 94976, "num_target_updates": 105}, "done": false, "episodes_total": 0, "training_iteration": 69, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-27", "timestamp": 1700369907, "time_this_iter_s": 2.1172988414764404, "time_total_s": 110.08196806907654, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317742ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 110.08196806907654, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 69.93333333333334, "ram_util_percent": 66.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.948766708374023, "actor_loss": -8.505754470825195, "critic_loss": 0.16267380118370056, "alpha_loss": -0.313221275806427, "alpha_value": 0.9690070152282715, "log_alpha_value": -0.03148343414068222, "target_entropy": -6.0, "policy_t": -0.09562559425830841, "mean_q": 4.565429210662842, "max_q": 4.751619338989258, "min_q": 2.9327409267425537}, "td_error": [1.5665943622589111, 0.10138249397277832, 0.8115811347961426, 0.39321041107177734, 1.3516860008239746, 2.1652371883392334, 0.4448201656341553, 1.4705357551574707, 0.40497827529907227, 2.356935501098633, 0.30320262908935547, 1.7806174755096436, 1.0216114521026611, 1.2444806098937988, 0.5336122512817383, 0.233900785446167, 0.1740260124206543, 1.3908836841583252, 0.14772343635559082, 2.2362565994262695, 1.4731428623199463, 2.240767240524292, 0.30912113189697266, 0.2686421871185303, 0.45985960960388184, 0.44493865966796875, 1.8270177841186523, 0.07570433616638184, 0.9204909801483154, 0.6473894119262695, 0.3825044631958008, 1.2019774913787842, 0.19130682945251465, 1.6344740390777588, 0.19419026374816895, 0.2434842586517334, 0.7049622535705566, 0.3649022579193115, 1.9319894313812256, 1.4563071727752686, 0.8171610832214355, 0.8282437324523926, 2.6828501224517822, 1.3855476379394531, 2.02441668510437, 0.5571882724761963, 1.17439603805542, 1.4495644569396973, 0.38628602027893066, 0.6694221496582031, 0.8979132175445557, 0.06514477729797363, 0.4237697124481201, 0.9234797954559326, 0.7511637210845947, 0.619964599609375, 0.23488330841064453, 1.323409080505371, 0.31310462951660156, 0.4161357879638672, 0.5440740585327148, 1.2610111236572266, 0.700991153717041, 0.47705674171447754, 1.482971429824829, 0.8374371528625488, 0.8270721435546875, 1.7476863861083984, 0.5230224132537842, 0.10390996932983398, 2.2446258068084717, 0.8707191944122314, 0.10341763496398926, 1.3163557052612305, 0.057126522064208984, 1.0717604160308838, 2.414886951446533, 2.1116433143615723, 0.27810144424438477, 1.371366262435913, 0.5824761390686035, 1.1904239654541016, 1.4471828937530518, 0.5217685699462891, 0.20847105979919434, 0.9860732555389404], "mean_td_error": 0.9340945482254028, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108437538146973, "actor_loss": -6.649957656860352, "critic_loss": 0.10639087855815887, "alpha_loss": -0.31803274154663086, "alpha_value": 0.9690276980400085, "log_alpha_value": -0.03146210312843323, "target_entropy": -6.0, "policy_t": -0.023427005857229233, "mean_q": 2.649794340133667, "max_q": 3.5349531173706055, "min_q": 2.557055950164795}, "td_error": [0.12470221519470215, 0.382157564163208, 1.3551321029663086, 0.16162848472595215, 1.9179596900939941, 1.3386305570602417, 1.0314748287200928, 1.1934919357299805, 0.4481329917907715, 0.06766736507415771, 0.44533824920654297, 1.0289195775985718, 0.41520702838897705, 0.44738686084747314, 0.908835768699646, 0.2466902732849121, 1.4780232906341553, 0.24473190307617188, 0.3951544761657715, 2.60644793510437, 1.0482243299484253, 0.6628806591033936, 0.8669828176498413, 0.5621861219406128, 1.9643738269805908, 0.8298236131668091, 0.5989307165145874, 2.8765456676483154, 1.474873661994934, 0.4512519836425781, 0.1949557065963745, 1.7772889137268066, 0.9331151247024536, 0.27845048904418945, 0.8405821323394775, 1.4418659210205078, 0.932217001914978, 0.186964750289917, 0.16428232192993164, 0.25485920906066895, 2.1390838623046875, 0.3461717367172241, 0.14325463771820068, 1.3573689460754395, 0.033461809158325195, 1.4755194187164307, 0.0627061128616333, 0.19593679904937744, 0.5968567132949829, 0.613818883895874, 0.29484009742736816, 2.2224464416503906, 2.123471736907959, 0.7781554460525513, 0.46456921100616455, 0.4177500009536743, 0.3131434917449951, 0.746272087097168, 1.602520227432251, 0.2253783941268921, 0.003233671188354492, 1.5972936153411865, 1.9369666576385498, 2.0286850929260254, 0.32808446884155273, 0.08880329132080078, 0.7390050888061523, 0.48088550567626953, 0.6290940046310425, 0.6388977766036987, 1.1064789295196533, 1.2404377460479736, 0.3623548746109009, 1.1474617719650269, 0.4508543014526367, 1.4432132244110107, 0.22970926761627197, 0.684019923210144, 0.2086029052734375, 1.058565616607666, 0.9025036096572876, 0.8151265382766724, 0.7730158567428589, 1.3687535524368286, 0.825668215751648, 3.2857308387756348], "mean_td_error": 0.8733086585998535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027216911315918, "actor_loss": -6.608944892883301, "critic_loss": 0.12098580598831177, "alpha_loss": -0.31562456488609314, "alpha_value": 0.9690134525299072, "log_alpha_value": -0.031476788222789764, "target_entropy": -6.0, "policy_t": -0.043962739408016205, "mean_q": 2.6443803310394287, "max_q": 2.954723358154297, "min_q": 2.0514228343963623}, "td_error": [0.6864780187606812, 1.2220033407211304, 0.5951004028320312, 0.21739816665649414, 1.7997419834136963, 0.444327712059021, 0.08431708812713623, 1.7562350034713745, 1.188210368156433, 1.9154995679855347, 1.5272817611694336, 1.4791043996810913, 0.30559980869293213, 0.9177981615066528, 0.30768823623657227, 0.17662501335144043, 1.3650957345962524, 1.550703525543213, 0.9709446430206299, 0.7217050790786743, 0.05395829677581787, 0.8536282777786255, 1.5973970890045166, 1.7376080751419067, 0.34503138065338135, 2.951202630996704, 1.5149585008621216, 1.7672158479690552, 0.45550715923309326, 0.23135042190551758, 0.43553245067596436, 0.030094027519226074, 0.9762299060821533, 0.8068220615386963, 0.37377846240997314, 0.8233364820480347, 0.3640025854110718, 0.33348870277404785, 0.30938923358917236, 1.8622372150421143, 0.11185109615325928, 0.20232689380645752, 0.20347130298614502, 0.6645586490631104, 1.0885072946548462, 0.1906147003173828, 0.7246538400650024, 0.6152311563491821, 0.5762879848480225, 0.613864541053772, 0.6429396867752075, 0.6484960317611694, 0.8271834850311279, 0.13252520561218262, 2.5875277519226074, 0.6036467552185059, 0.6215721368789673, 1.3108620643615723, 1.8838682174682617, 1.3891990184783936, 0.15682804584503174, 0.9118272066116333, 1.2892683744430542, 1.240533471107483, 0.412875771522522, 0.7557897567749023, 2.637828826904297, 0.015119791030883789, 1.1413289308547974, 0.4285895824432373, 0.2324204444885254, 0.363486647605896, 2.6310548782348633, 0.9970352649688721, 0.6625314950942993, 0.47997164726257324, 1.8524833917617798, 0.32508575916290283, 0.9722769260406494, 0.4748181104660034, 0.552491307258606, 1.2359431982040405, 0.18819928169250488, 0.5982002019882202, 0.23564302921295166, 0.16995787620544434], "mean_td_error": 0.8564580678939819, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}}, "num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "last_target_update_ts": 95872, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 785.0386877531257, "num_env_steps_trained_throughput_per_sec": 226.04908642891343, "timesteps_total": 95872, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 287616, "timers": {"training_iteration_time_ms": 988.5, "sample_time_ms": 714.678, "load_time_ms": 0.316, "load_throughput": 815471.313, "learn_time_ms": 18.066, "learn_throughput": 14280.705, "synch_weights_time_ms": 9.727}, "counters": {"num_env_steps_sampled": 95872, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 287616, "num_agent_steps_trained": 27348, "last_target_update_ts": 95872, "num_target_updates": 106}, "done": false, "episodes_total": 0, "training_iteration": 70, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-28", "timestamp": 1700369908, "time_this_iter_s": 1.1494789123535156, "time_total_s": 111.23144698143005, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177ba7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 111.23144698143005, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 65.35, "ram_util_percent": 67.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14869499206543, "actor_loss": -8.597845077514648, "critic_loss": 0.14817719161510468, "alpha_loss": -0.32254302501678467, "alpha_value": 0.9687179923057556, "log_alpha_value": -0.031781721860170364, "target_entropy": -6.0, "policy_t": -0.04770014435052872, "mean_q": 4.562397003173828, "max_q": 4.750465393066406, "min_q": 2.9658565521240234}, "td_error": [1.0095925331115723, 0.07061433792114258, 0.6633164882659912, 0.8471076488494873, 0.9688928127288818, 0.9337904453277588, 0.6673898696899414, 3.352900266647339, 0.734424352645874, 1.229379415512085, 0.3130664825439453, 0.14705920219421387, 0.19118022918701172, 1.7456719875335693, 0.6696221828460693, 0.5494065284729004, 0.990656852722168, 0.6279892921447754, 1.5209767818450928, 0.5921192169189453, 0.4519968032836914, 1.0443263053894043, 1.2267189025878906, 0.7491452693939209, 0.974327564239502, 0.3301553726196289, 0.6153554916381836, 1.8476862907409668, 0.11548376083374023, 2.0713188648223877, 0.9472806453704834, 0.37657880783081055, 0.05568575859069824, 1.7551865577697754, 0.6838476657867432, 0.5476713180541992, 0.6430263519287109, 0.25583434104919434, 0.4811370372772217, 0.8011116981506348, 1.0571818351745605, 0.35527992248535156, 2.726170063018799, 1.1148195266723633, 0.07420611381530762, 1.4399230480194092, 0.31932663917541504, 0.7638053894042969, 0.40736985206604004, 2.0564815998077393, 0.3921651840209961, 0.693326473236084, 0.5820460319519043, 1.578122854232788, 2.199592351913452, 1.527881145477295, 1.2594435214996338, 0.2630035877227783, 0.735443115234375, 2.1318533420562744, 1.8841185569763184, 1.0290141105651855, 0.8361828327178955, 0.4866676330566406, 1.447920799255371, 0.061396121978759766, 0.802668571472168, 0.31299781799316406, 0.6744933128356934, 0.4285728931427002, 1.6109156608581543, 0.8283176422119141, 0.207672119140625, 1.4054508209228516, 2.09861421585083, 0.26738739013671875, 0.35909414291381836, 1.009143590927124, 0.7104990482330322, 0.49585485458374023, 1.0559792518615723, 0.4862179756164551, 0.3260068893432617, 0.3080878257751465, 0.02014470100402832, 1.6397786140441895], "mean_td_error": 0.8868566155433655, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043970108032227, "actor_loss": -6.635772228240967, "critic_loss": 0.10590121150016785, "alpha_loss": -0.31901711225509644, "alpha_value": 0.9687370657920837, "log_alpha_value": -0.03176204860210419, "target_entropy": -6.0, "policy_t": -0.07767120748758316, "mean_q": 2.6096999645233154, "max_q": 3.264194965362549, "min_q": 2.5484471321105957}, "td_error": [1.102530598640442, 1.452917218208313, 3.0753068923950195, 0.44110631942749023, 0.5964998006820679, 0.8964487314224243, 0.32136523723602295, 2.6187520027160645, 0.025439023971557617, 1.070165991783142, 0.9328060150146484, 0.18053185939788818, 0.028311491012573242, 0.8775659799575806, 1.1291935443878174, 0.8248114585876465, 1.9327454566955566, 1.2943406105041504, 1.5683637857437134, 0.3850078582763672, 1.203895092010498, 0.34937024116516113, 1.03462815284729, 0.1774899959564209, 0.9830738306045532, 0.005792737007141113, 0.949737548828125, 0.22862744331359863, 1.526275873184204, 1.0124908685684204, 1.6691550016403198, 0.27399301528930664, 1.018741488456726, 0.551061749458313, 1.0315295457839966, 0.471232533454895, 1.9797158241271973, 0.3021343946456909, 0.9571559429168701, 2.612504482269287, 2.747744560241699, 0.23427021503448486, 0.32613492012023926, 1.702171802520752, 0.05596911907196045, 0.24704933166503906, 0.5210214853286743, 0.26450788974761963, 0.396653413772583, 0.3699852228164673, 0.5965769290924072, 0.5086750984191895, 1.1929293870925903, 0.1855999231338501, 0.7238477468490601, 1.5594087839126587, 0.31614506244659424, 0.5140507221221924, 1.1892961263656616, 1.955709457397461, 0.23135864734649658, 0.33973240852355957, 0.7502274513244629, 1.558669924736023, 0.5197439193725586, 0.6465915441513062, 0.16180050373077393, 0.3224618434906006, 1.2925169467926025, 1.4763637781143188, 0.3553100824356079, 0.40062594413757324, 1.349023461341858, 0.6888597011566162, 0.0378117561340332, 0.8522230386734009, 1.2951627969741821, 0.18681633472442627, 1.0228261947631836, 1.5021686553955078, 0.3094339370727539, 1.0269153118133545, 0.3210393190383911, 0.9388811588287354, 0.9415429830551147, 1.0111949443817139], "mean_td_error": 0.8632543087005615, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036672592163086, "actor_loss": -6.615975856781006, "critic_loss": 0.10401567816734314, "alpha_loss": -0.31892549991607666, "alpha_value": 0.9687235355377197, "log_alpha_value": -0.03177602216601372, "target_entropy": -6.0, "policy_t": -0.0428057461977005, "mean_q": 2.639571189880371, "max_q": 2.7296571731567383, "min_q": 2.0501904487609863}, "td_error": [0.9164646863937378, 0.15008461475372314, 1.4588783979415894, 0.7958431243896484, 0.5699408054351807, 0.8187700510025024, 0.6260416507720947, 0.9849646091461182, 0.06084418296813965, 0.35938072204589844, 0.42088794708251953, 0.8411276340484619, 1.1225961446762085, 0.9735318422317505, 0.9082236289978027, 0.1848917007446289, 0.8126384019851685, 0.575057864189148, 0.7834384441375732, 0.09595394134521484, 1.638592004776001, 1.0760912895202637, 0.44250810146331787, 1.1612063646316528, 2.7267284393310547, 0.20145821571350098, 0.9157617092132568, 1.7634872198104858, 1.0028644800186157, 0.25571370124816895, 1.7369927167892456, 0.907288670539856, 1.4534584283828735, 1.123408317565918, 0.42968153953552246, 1.0997040271759033, 0.17425739765167236, 1.0606497526168823, 0.6254254579544067, 0.7076516151428223, 0.046384334564208984, 0.8179843425750732, 2.3679778575897217, 0.3680155277252197, 0.6119091510772705, 0.499780535697937, 2.193805694580078, 2.3251380920410156, 0.18061113357543945, 0.6824855804443359, 0.46386969089508057, 0.6226502656936646, 1.5393755435943604, 0.03502166271209717, 0.6041843891143799, 0.8791496753692627, 0.8844196796417236, 0.2393941879272461, 0.4906299114227295, 0.46504509449005127, 0.8607943058013916, 1.712257742881775, 0.9454643726348877, 0.5237271785736084, 1.3550090789794922, 0.03285086154937744, 0.07468807697296143, 0.10260009765625, 0.062366485595703125, 1.8516712188720703, 0.017927050590515137, 0.12496936321258545, 0.4513050317764282, 0.04237198829650879, 0.8497216701507568, 0.4331928491592407, 0.018525004386901855, 0.548872709274292, 0.9851855039596558, 0.7080533504486084, 1.17958402633667, 0.43981361389160156, 0.4178696870803833, 0.2908223867416382, 0.23336148262023926, 2.092039108276367], "mean_td_error": 0.7748298645019531, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 96768, "num_env_steps_trained": 27606, "num_agent_steps_sampled": 290304, "num_agent_steps_trained": 27606, "last_target_update_ts": 96768, "num_target_updates": 107}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290304, "num_agent_steps_trained": 27606, "num_env_steps_sampled": 96768, "num_env_steps_trained": 27606, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 859.6729446954873, "num_env_steps_trained_throughput_per_sec": 247.5397541645488, "timesteps_total": 96768, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 290304, "timers": {"training_iteration_time_ms": 998.51, "sample_time_ms": 724.254, "load_time_ms": 0.316, "load_throughput": 815963.227, "learn_time_ms": 18.158, "learn_throughput": 14208.422, "synch_weights_time_ms": 9.727}, "counters": {"num_env_steps_sampled": 96768, "num_env_steps_trained": 27606, "num_agent_steps_sampled": 290304, "num_agent_steps_trained": 27606, "last_target_update_ts": 96768, "num_target_updates": 107}, "done": false, "episodes_total": 0, "training_iteration": 71, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-29", "timestamp": 1700369909, "time_this_iter_s": 1.05287504196167, "time_total_s": 112.28432202339172, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x317743920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 112.28432202339172, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 89.3, "ram_util_percent": 67.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.96725082397461, "actor_loss": -8.538772583007812, "critic_loss": 0.12512898445129395, "alpha_loss": -0.31975340843200684, "alpha_value": 0.9684287309646606, "log_alpha_value": -0.03208040073513985, "target_entropy": -6.0, "policy_t": -0.09505011886358261, "mean_q": 4.6091389656066895, "max_q": 5.131155490875244, "min_q": 3.3612191677093506}, "td_error": [1.7835536003112793, 0.3766143321990967, 0.9757838249206543, 0.5671558380126953, 1.2999045848846436, 0.9329309463500977, 2.0107927322387695, 0.5323586463928223, 0.5306403636932373, 0.9087121486663818, 1.305701732635498, 1.4183242321014404, 0.9961533546447754, 0.28095054626464844, 0.5807878971099854, 0.6145961284637451, 1.1003851890563965, 0.5421857833862305, 0.4271714687347412, 1.4726862907409668, 0.4823603630065918, 0.2834584712982178, 1.3760433197021484, 0.8124997615814209, 0.3575258255004883, 0.16228270530700684, 1.0893256664276123, 0.9191036224365234, 0.6572372913360596, 0.5114731788635254, 0.6942894458770752, 1.4396390914916992, 1.414806604385376, 0.3755645751953125, 0.46107983589172363, 0.40613293647766113, 0.6962952613830566, 0.5117390155792236, 0.9185988903045654, 0.1974029541015625, 0.36168456077575684, 0.35184264183044434, 0.6060731410980225, 0.7490241527557373, 1.3445782661437988, 0.7765774726867676, 1.345902442932129, 0.028218984603881836, 0.4405698776245117, 1.0938942432403564, 0.9390823841094971, 0.7119166851043701, 0.1481003761291504, 0.6171157360076904, 0.8811492919921875, 0.5171148777008057, 0.4608278274536133, 0.4356560707092285, 1.463740587234497, 2.5750396251678467, 1.7034924030303955, 0.6195461750030518, 1.206895351409912, 1.759181022644043, 1.1908378601074219, 0.8981187343597412, 0.44800305366516113, 1.153902292251587, 0.8352595567703247, 0.8739001750946045, 1.9291343688964844, 0.09442758560180664, 0.2991971969604492, 0.12296819686889648, 0.023804426193237305, 0.5893056392669678, 0.5174839496612549, 0.9313931465148926, 0.8342301845550537, 0.988579273223877, 0.6249926090240479, 0.1656665802001953, 0.7843003273010254, 2.507044792175293, 0.06176304817199707, 1.001413345336914], "mean_td_error": 0.8190372586250305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081330299377441, "actor_loss": -6.6231489181518555, "critic_loss": 0.0945812463760376, "alpha_loss": -0.32322680950164795, "alpha_value": 0.9684466123580933, "log_alpha_value": -0.03206191956996918, "target_entropy": -6.0, "policy_t": -0.028943125158548355, "mean_q": 2.594959259033203, "max_q": 3.1841859817504883, "min_q": 2.121885299682617}, "td_error": [1.1598652601242065, 1.0469107627868652, 0.08879745006561279, 0.7938706874847412, 0.2391059398651123, 1.253969669342041, 0.8697136640548706, 0.6331233978271484, 1.1403241157531738, 0.6112216711044312, 1.6211528778076172, 1.5922772884368896, 0.015245795249938965, 1.253830909729004, 0.8101993799209595, 0.6984721422195435, 0.21941351890563965, 0.5061969757080078, 0.9415656328201294, 0.7134000062942505, 0.1380101442337036, 0.23957693576812744, 1.4742093086242676, 0.4376680850982666, 1.5146499872207642, 0.8069313764572144, 0.7034850120544434, 1.130713939666748, 1.6284043788909912, 1.6249428987503052, 0.010721564292907715, 0.8456737995147705, 0.09920346736907959, 1.156231164932251, 0.04550588130950928, 1.0796793699264526, 1.7679226398468018, 0.0986628532409668, 0.6508573293685913, 0.062061429023742676, 2.0722453594207764, 1.7406270503997803, 0.7984075546264648, 0.491399884223938, 1.6055116653442383, 0.6330296993255615, 0.5645471811294556, 0.005315661430358887, 0.8926029205322266, 0.6087963581085205, 0.7844555377960205, 1.0995959043502808, 0.4861893653869629, 1.260589599609375, 0.3251529932022095, 0.12192070484161377, 1.659245252609253, 1.551209807395935, 1.137995958328247, 1.551895022392273, 0.9597328901290894, 2.8003642559051514, 0.6485739946365356, 0.01798093318939209, 0.4161801338195801, 0.035781025886535645, 0.2639017105102539, 1.7311882972717285, 0.8616708517074585, 0.5259418487548828, 0.8708339929580688, 1.6117252111434937, 0.5358415842056274, 0.16878783702850342, 1.0890578031539917, 0.2685511112213135, 0.19709312915802002, 0.708649754524231, 0.06676673889160156, 0.6284137964248657, 0.02952718734741211, 1.0039701461791992, 0.23279333114624023, 0.45343446731567383, 2.543954610824585, 0.352561354637146], "mean_td_error": 0.8155555725097656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00919246673584, "actor_loss": -6.636070251464844, "critic_loss": 0.09984392672777176, "alpha_loss": -0.3210470378398895, "alpha_value": 0.9684337377548218, "log_alpha_value": -0.032075222581624985, "target_entropy": -6.0, "policy_t": -0.08574677258729935, "mean_q": 2.6296465396881104, "max_q": 2.7455339431762695, "min_q": 2.0244200229644775}, "td_error": [0.5779708623886108, 1.0763657093048096, 1.2155730724334717, 0.08234786987304688, 0.5873435735702515, 0.4922759532928467, 0.616357684135437, 0.907978892326355, 0.015819549560546875, 1.1313836574554443, 0.612281322479248, 2.49631667137146, 0.8662192821502686, 0.7717888355255127, 0.6687132120132446, 0.5790960788726807, 0.020169496536254883, 0.025607705116271973, 0.6198444366455078, 0.5952446460723877, 0.5746099948883057, 2.386932849884033, 1.1838940382003784, 3.313300132751465, 0.04378008842468262, 0.32721686363220215, 1.7297707796096802, 1.5004918575286865, 0.13196277618408203, 0.6937745809555054, 0.25580453872680664, 0.6569199562072754, 0.7660588026046753, 0.8115330934524536, 0.237601637840271, 0.131522536277771, 0.23212850093841553, 1.1209750175476074, 0.08381283283233643, 1.1453222036361694, 0.5517380237579346, 0.5361278057098389, 0.8091480731964111, 0.32544970512390137, 0.06441247463226318, 0.27511143684387207, 0.7235662937164307, 1.6979479789733887, 0.8801871538162231, 0.3261016607284546, 0.8535226583480835, 0.8639087677001953, 1.1344894170761108, 1.0033533573150635, 0.23815059661865234, 0.5073038339614868, 0.23321759700775146, 0.7224125862121582, 0.9715662002563477, 0.04489302635192871, 0.7161707878112793, 1.833917498588562, 0.8980894088745117, 1.5997532606124878, 1.010179042816162, 0.05960977077484131, 0.7666809558868408, 2.075660467147827, 2.0638256072998047, 1.453230381011963, 0.4136878252029419, 0.23955178260803223, 0.5177657604217529, 0.775596022605896, 0.3386237621307373, 0.3986642360687256, 0.6134564876556396, 1.0849369764328003, 0.6077907085418701, 0.7342314720153809, 0.40002596378326416, 0.3407381772994995, 0.9966778755187988, 0.08523201942443848, 0.47507596015930176, 0.2743830680847168], "mean_td_error": 0.7537473440170288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 108.0, "diff_num_grad_updates_vs_sampler_policy": 107.0}}, "num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "last_target_update_ts": 97664, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 877.8082507654932, "num_env_steps_trained_throughput_per_sec": 252.76175077845673, "timesteps_total": 97664, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 292992, "timers": {"training_iteration_time_ms": 1007.913, "sample_time_ms": 733.751, "load_time_ms": 0.316, "load_throughput": 815532.77, "learn_time_ms": 18.112, "learn_throughput": 14244.35, "synch_weights_time_ms": 9.63}, "counters": {"num_env_steps_sampled": 97664, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 292992, "num_agent_steps_trained": 27864, "last_target_update_ts": 97664, "num_target_updates": 108}, "done": false, "episodes_total": 0, "training_iteration": 72, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-30", "timestamp": 1700369910, "time_this_iter_s": 1.0293941497802734, "time_total_s": 113.313716173172, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177b9260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 113.313716173172, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 65.80000000000001, "ram_util_percent": 67.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.983694076538086, "actor_loss": -8.546823501586914, "critic_loss": 0.14506667852401733, "alpha_loss": -0.32624220848083496, "alpha_value": 0.9678506255149841, "log_alpha_value": -0.03267750144004822, "target_entropy": -6.0, "policy_t": -0.08090537786483765, "mean_q": 4.61469841003418, "max_q": 4.8162970542907715, "min_q": 4.104193687438965}, "td_error": [0.9442148208618164, 1.1235177516937256, 2.127716541290283, 1.9427475929260254, 1.2700867652893066, 0.5523777008056641, 1.5735015869140625, 0.3739442825317383, 1.821662425994873, 0.901602029800415, 0.009108543395996094, 0.8992359638214111, 0.753664493560791, 0.10506963729858398, 1.328899621963501, 1.5626335144042969, 0.651496410369873, 0.8511414527893066, 0.027694225311279297, 0.7767705917358398, 0.01792287826538086, 0.14406490325927734, 0.20042657852172852, 0.5490221977233887, 0.5030834674835205, 0.06335806846618652, 0.6157073974609375, 0.060233116149902344, 1.2918798923492432, 0.08437037467956543, 0.820324182510376, 1.4469921588897705, 0.15853357315063477, 2.253183126449585, 0.48505210876464844, 0.7898311614990234, 1.9916133880615234, 2.5449554920196533, 0.6156425476074219, 2.119741201400757, 0.2798311710357666, 0.7325911521911621, 0.8051879405975342, 0.03221940994262695, 0.8964660167694092, 0.8561146259307861, 1.622612476348877, 2.161623954772949, 0.868941068649292, 0.40861034393310547, 0.5528061389923096, 1.1771345138549805, 0.174605131149292, 0.42647552490234375, 0.11238908767700195, 0.27042436599731445, 0.648643970489502, 0.44561266899108887, 0.74941086769104, 0.8616209030151367, 0.35818958282470703, 1.0994148254394531, 0.7127699851989746, 1.2880184650421143, 0.5618801116943359, 1.006631851196289, 1.0461561679840088, 0.6893172264099121, 0.24306488037109375, 0.4864993095397949, 2.4307568073272705, 0.03708791732788086, 0.6288180351257324, 0.18194222450256348, 2.1686010360717773, 0.9096131324768066, 1.22916841506958, 2.213742733001709, 0.016330718994140625, 1.3390605449676514, 0.47301745414733887, 0.8371536731719971, 0.6181714534759521, 0.32467198371887207, 0.34623050689697266, 1.6209309101104736], "mean_td_error": 0.8523673415184021, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057967185974121, "actor_loss": -6.617579460144043, "critic_loss": 0.10624959319829941, "alpha_loss": -0.32851070165634155, "alpha_value": 0.9678658843040466, "log_alpha_value": -0.032661739736795425, "target_entropy": -6.0, "policy_t": -0.05972089618444443, "mean_q": 2.5774807929992676, "max_q": 2.6698241233825684, "min_q": 2.090873956680298}, "td_error": [0.005669951438903809, 1.0389304161071777, 0.27206480503082275, 0.34082508087158203, 1.1615530252456665, 0.5689382553100586, 0.117728590965271, 0.31874799728393555, 0.6281042098999023, 0.043254971504211426, 1.9581447839736938, 1.4384242296218872, 0.3502023220062256, 1.0713399648666382, 0.15328967571258545, 1.0392982959747314, 1.1216540336608887, 1.3574775457382202, 1.163602590560913, 0.664291262626648, 0.48681533336639404, 0.7189459800720215, 1.079911470413208, 0.157478928565979, 1.3560863733291626, 1.1181049346923828, 2.164620876312256, 1.3781285285949707, 0.2856330871582031, 2.1998066902160645, 0.03527939319610596, 0.36530113220214844, 0.9261711835861206, 1.430653691291809, 0.2892587184906006, 0.4133026599884033, 0.7707216739654541, 1.1098438501358032, 0.9002567529678345, 1.1473828554153442, 0.8310059309005737, 1.4000591039657593, 1.2837882041931152, 1.7336632013320923, 0.6449582576751709, 0.6714203357696533, 0.23861229419708252, 0.4460792541503906, 2.313246965408325, 0.13282155990600586, 0.8858902454376221, 1.5754821300506592, 1.106600046157837, 1.2541325092315674, 1.2728948593139648, 0.6776484251022339, 1.0515375137329102, 0.3253021240234375, 1.1312310695648193, 0.8805102109909058, 1.4652186632156372, 0.5828101634979248, 0.3506910800933838, 0.8425683975219727, 0.37108075618743896, 0.6828901767730713, 0.46465039253234863, 0.42342209815979004, 0.11021614074707031, 0.8483413457870483, 0.88829505443573, 0.866830587387085, 2.0508928298950195, 2.0603652000427246, 1.5920374393463135, 0.5491276979446411, 1.8253618478775024, 0.036275625228881836, 2.170029401779175, 1.6942110061645508, 0.6948220729827881, 0.35447537899017334, 0.7886021137237549, 0.08256709575653076, 0.5345059633255005, 0.9511911869049072], "mean_td_error": 0.8870419263839722, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025373458862305, "actor_loss": -6.627954006195068, "critic_loss": 0.11218389123678207, "alpha_loss": -0.3275637626647949, "alpha_value": 0.9678545594215393, "log_alpha_value": -0.03267347067594528, "target_entropy": -6.0, "policy_t": -0.06060444936156273, "mean_q": 2.6411683559417725, "max_q": 2.742859363555908, "min_q": 2.0323472023010254}, "td_error": [0.09222447872161865, 0.7064410448074341, 1.6968979835510254, 1.5002273321151733, 0.9190654754638672, 0.8501192331314087, 1.668684959411621, 1.0711727142333984, 0.6810616254806519, 0.38727355003356934, 0.25489091873168945, 0.9774091243743896, 1.3436565399169922, 0.5368595123291016, 0.7091614007949829, 0.20218133926391602, 0.6409132480621338, 2.470820903778076, 1.0783411264419556, 1.4546706676483154, 0.06046497821807861, 0.35420680046081543, 0.7856284379959106, 0.5747313499450684, 0.5035156011581421, 1.5037438869476318, 1.2785863876342773, 0.40564215183258057, 0.4586195945739746, 0.12786436080932617, 0.6154602766036987, 2.006507635116577, 0.495341420173645, 1.9183919429779053, 0.13357627391815186, 1.5115047693252563, 0.9998722076416016, 0.05191671848297119, 1.8211448192596436, 0.20287632942199707, 1.8679853677749634, 1.64794921875, 0.5812833309173584, 0.15592849254608154, 1.3002279996871948, 0.1500493288040161, 0.5988173484802246, 2.0660057067871094, 0.808351993560791, 0.45672619342803955, 0.1536710262298584, 1.7451492547988892, 1.0437921285629272, 0.6592769622802734, 0.249822735786438, 0.3685256242752075, 0.13461148738861084, 0.23008644580841064, 0.3133469820022583, 0.5443836450576782, 1.4936320781707764, 0.663118839263916, 2.107245445251465, 0.3500964641571045, 1.1457533836364746, 0.3552283048629761, 1.080307960510254, 0.8015446662902832, 0.7148905992507935, 2.2211618423461914, 0.025542378425598145, 1.2648203372955322, 1.3041138648986816, 0.13102102279663086, 0.6262714862823486, 0.6472630500793457, 0.499719500541687, 0.511441707611084, 0.623171329498291, 0.5158092975616455, 0.11796975135803223, 0.46632468700408936, 0.4782952070236206, 1.1161060333251953, 0.19980311393737793, 0.5750900506973267], "mean_td_error": 0.8158535361289978, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 110.0, "diff_num_grad_updates_vs_sampler_policy": 109.0}}, "num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "last_target_update_ts": 99456, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_env_steps_sampled_this_iter": 1792, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 935.7399635872531, "num_env_steps_trained_throughput_per_sec": 269.44298058650816, "timesteps_total": 99456, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 298368, "timers": {"training_iteration_time_ms": 1010.914, "sample_time_ms": 736.288, "load_time_ms": 0.315, "load_throughput": 818307.949, "learn_time_ms": 18.148, "learn_throughput": 14216.485, "synch_weights_time_ms": 9.635}, "counters": {"num_env_steps_sampled": 99456, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 298368, "num_agent_steps_trained": 28380, "last_target_update_ts": 99456, "num_target_updates": 110}, "done": false, "episodes_total": 0, "training_iteration": 73, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-32", "timestamp": 1700369912, "time_this_iter_s": 1.924489974975586, "time_total_s": 115.23820614814758, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177bb6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 115.23820614814758, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 75.19999999999999, "ram_util_percent": 66.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.044893264770508, "actor_loss": -8.569153785705566, "critic_loss": 0.1821283996105194, "alpha_loss": -0.3312402367591858, "alpha_value": 0.9675617814064026, "log_alpha_value": -0.03297598287463188, "target_entropy": -6.0, "policy_t": -0.05468792840838432, "mean_q": 4.556830406188965, "max_q": 4.766894340515137, "min_q": 2.9355790615081787}, "td_error": [0.6855688095092773, 1.5290677547454834, 0.09825873374938965, 1.9291045665740967, 0.8542194366455078, 0.10497832298278809, 1.0086443424224854, 0.6552891731262207, 0.28318047523498535, 1.1849892139434814, 0.6294002532958984, 0.020615339279174805, 0.4018411636352539, 2.2287778854370117, 0.7589406967163086, 0.1906719207763672, 0.057596683502197266, 0.33708786964416504, 4.047280311584473, 0.9564571380615234, 2.2289488315582275, 0.761528730392456, 1.3396942615509033, 1.008059024810791, 0.6142065525054932, 0.8210902214050293, 0.7479226589202881, 0.5137431621551514, 0.3829619884490967, 0.9774510860443115, 2.748677968978882, 0.13386750221252441, 1.5714075565338135, 0.24290966987609863, 0.6609928607940674, 0.6896944046020508, 2.0461034774780273, 1.1593682765960693, 0.10524940490722656, 1.0442681312561035, 1.3674588203430176, 0.871201753616333, 1.3289170265197754, 0.8752799034118652, 1.7775554656982422, 1.6609609127044678, 1.3192942142486572, 0.7196059226989746, 1.0262165069580078, 0.38623619079589844, 0.3723714351654053, 0.7362244129180908, 0.6337535381317139, 2.875575542449951, 1.7250087261199951, 1.2773571014404297, 0.8348109722137451, 0.4424879550933838, 0.29070067405700684, 0.624849796295166, 1.2339556217193604, 0.05682730674743652, 1.0249714851379395, 2.5681769847869873, 1.0688210725784302, 1.419456958770752, 1.6442222595214844, 0.3731355667114258, 0.482684850692749, 1.1620185375213623, 2.7190890312194824, 0.19257402420043945, 1.046220302581787, 0.16879606246948242, 0.05701494216918945, 1.1213922500610352, 1.6963305473327637, 1.3599109649658203, 1.722761631011963, 0.7643373012542725, 0.9036965370178223, 1.383293628692627, 1.6156935691833496, 0.08009672164916992, 0.9779212474822998, 1.031998634338379], "mean_td_error": 1.009085774421692, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034232139587402, "actor_loss": -6.595767498016357, "critic_loss": 0.08463740348815918, "alpha_loss": -0.33074459433555603, "alpha_value": 0.9675756692886353, "log_alpha_value": -0.03296162188053131, "target_entropy": -6.0, "policy_t": -0.060455553233623505, "mean_q": 2.6119279861450195, "max_q": 3.132523536682129, "min_q": 2.1014914512634277}, "td_error": [1.8495516777038574, 0.45717382431030273, 1.1100759506225586, 0.2603968381881714, 2.344738483428955, 1.4836698770523071, 1.6613495349884033, 1.8581888675689697, 0.2773628234863281, 0.9069759845733643, 0.07410502433776855, 0.5307875871658325, 1.739380121231079, 0.13890862464904785, 0.28679966926574707, 0.02667820453643799, 0.15470516681671143, 0.4281167984008789, 0.8947309255599976, 1.178492546081543, 1.1683924198150635, 1.7030155658721924, 1.1193825006484985, 0.41728389263153076, 0.19847583770751953, 0.3659474849700928, 0.392541766166687, 0.4616663455963135, 0.5338752269744873, 1.5308796167373657, 1.035109519958496, 1.2777037620544434, 0.7509541511535645, 1.15690279006958, 0.9967535734176636, 0.3277428150177002, 0.19545221328735352, 0.8126047849655151, 0.8428777456283569, 1.8603330850601196, 0.2331075668334961, 0.7422188520431519, 0.0682065486907959, 1.1011810302734375, 0.2645246982574463, 0.3280930519104004, 1.6666734218597412, 1.5558156967163086, 0.4209296703338623, 0.40694212913513184, 0.9397002458572388, 0.3772999048233032, 0.8810977935791016, 0.8401962518692017, 0.35703039169311523, 1.2357430458068848, 2.2547924518585205, 0.05478084087371826, 0.8486480712890625, 1.2924821376800537, 0.690070629119873, 0.03685474395751953, 0.27706825733184814, 0.07528853416442871, 0.567823052406311, 1.4082578420639038, 0.21818292140960693, 0.321494460105896, 0.14711272716522217, 1.3040499687194824, 0.24058032035827637, 0.40935397148132324, 1.3295115232467651, 0.08839356899261475, 0.4103419780731201, 1.2593200206756592, 0.6814078092575073, 0.2801469564437866, 0.6584455966949463, 0.4586104154586792, 0.8234413862228394, 0.038343191146850586, 0.7922744750976562, 1.0571234226226807, 0.44039952754974365, 0.44824910163879395], "mean_td_error": 0.7574616074562073, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.128885269165039, "actor_loss": -6.677657604217529, "critic_loss": 0.1440071016550064, "alpha_loss": -0.3339754045009613, "alpha_value": 0.96756511926651, "log_alpha_value": -0.03297257050871849, "target_entropy": -6.0, "policy_t": -0.03035307303071022, "mean_q": 2.6403563022613525, "max_q": 2.7449917793273926, "min_q": 2.00105619430542}, "td_error": [1.44511079788208, 1.6479113101959229, 0.633310079574585, 0.7339924573898315, 0.15863394737243652, 0.7656915187835693, 1.4641166925430298, 0.9171726703643799, 1.779868721961975, 2.343346118927002, 0.7930880784988403, 1.1305770874023438, 0.08594977855682373, 0.04460799694061279, 1.0193722248077393, 0.6304144859313965, 0.15269255638122559, 0.7819417715072632, 3.211453437805176, 1.617956519126892, 3.046665668487549, 0.4401249885559082, 1.2128580808639526, 0.514922022819519, 0.08266580104827881, 1.3244491815567017, 1.0854402780532837, 0.29884982109069824, 0.3626772165298462, 0.5588241815567017, 0.13623952865600586, 0.4684584140777588, 2.0412204265594482, 0.6717668771743774, 0.5680137872695923, 0.4123356342315674, 1.1339980363845825, 1.0327317714691162, 1.028156042098999, 1.3065810203552246, 1.7620837688446045, 1.0662147998809814, 0.875518798828125, 0.04852938652038574, 1.1278364658355713, 0.5725185871124268, 0.6233925819396973, 1.526620626449585, 0.03979980945587158, 1.3147473335266113, 1.7564834356307983, 0.9198061227798462, 0.312475323677063, 1.3856143951416016, 0.23692727088928223, 1.9229075908660889, 1.990543007850647, 0.6893936395645142, 1.9161816835403442, 0.49582457542419434, 0.2720603942871094, 1.4794909954071045, 0.5979123115539551, 0.0700453519821167, 0.8669880628585815, 0.7165404558181763, 2.644806385040283, 0.29442906379699707, 1.1523700952529907, 0.7409483194351196, 0.935600996017456, 0.6299730539321899, 0.3617948293685913, 0.21786272525787354, 1.294418454170227, 0.36924028396606445, 1.4546737670898438, 1.431849479675293, 1.9561381340026855, 0.10126543045043945, 0.1389479637145996, 0.9780648946762085, 0.06479156017303467, 2.185703754425049, 0.1590510606765747, 0.634821891784668], "mean_td_error": 0.9467139840126038, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 28638, "num_agent_steps_sampled": 301056, "num_agent_steps_trained": 28638, "last_target_update_ts": 100352, "num_target_updates": 111}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301056, "num_agent_steps_trained": 28638, "num_env_steps_sampled": 100352, "num_env_steps_trained": 28638, "num_env_steps_sampled_this_iter": 896, "num_env_steps_trained_this_iter": 258, "num_env_steps_sampled_throughput_per_sec": 847.0673320114494, "num_env_steps_trained_throughput_per_sec": 243.91001301222536, "timesteps_total": 100352, "num_steps_trained_this_iter": 258, "agent_timesteps_total": 301056, "timers": {"training_iteration_time_ms": 1021.89, "sample_time_ms": 746.141, "load_time_ms": 0.315, "load_throughput": 820106.428, "learn_time_ms": 18.17, "learn_throughput": 14199.51, "synch_weights_time_ms": 9.582}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 28638, "num_agent_steps_sampled": 301056, "num_agent_steps_trained": 28638, "last_target_update_ts": 100352, "num_target_updates": 111}, "done": true, "episodes_total": 0, "training_iteration": 74, "trial_id": "fedad_00000", "date": "2023-11-18_20-58-33", "timestamp": 1700369913, "time_this_iter_s": 1.067305088043213, "time_total_s": 116.3055112361908, "pid": 6061, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.0, "epsilon_timesteps": 100000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x3177ba7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 116.3055112361908, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 73.3, "ram_util_percent": 67.4}}
