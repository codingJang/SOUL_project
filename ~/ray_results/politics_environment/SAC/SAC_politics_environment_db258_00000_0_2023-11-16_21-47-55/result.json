{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 357, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1071, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1071, "num_agent_steps_trained": 0, "num_env_steps_sampled": 357, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 357, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 355.23058192311817, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 357, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1071, "timers": {"training_iteration_time_ms": 11.474, "sample_time_ms": 9.891}, "counters": {"num_env_steps_sampled": 357, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1071, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "db258_00000", "date": "2023-11-16_21-48-05", "timestamp": 1700200085, "time_this_iter_s": 1.0070106983184814, "time_total_s": 1.0070106983184814, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 1.0070106983184814, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.45, "ram_util_percent": 60.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 861, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2583, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2583, "num_agent_steps_trained": 0, "num_env_steps_sampled": 861, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 504, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 503.3415272331409, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 861, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2583, "timers": {"training_iteration_time_ms": 13.417, "sample_time_ms": 11.504}, "counters": {"num_env_steps_sampled": 861, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2583, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "db258_00000", "date": "2023-11-16_21-48-06", "timestamp": 1700200086, "time_this_iter_s": 1.003899097442627, "time_total_s": 2.0109097957611084, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb67a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 2.0109097957611084, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 61.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1379, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4137, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4137, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1379, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 518, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 512.1152527718909, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1379, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4137, "timers": {"training_iteration_time_ms": 13.916, "sample_time_ms": 11.868}, "counters": {"num_env_steps_sampled": 1379, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4137, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "db258_00000", "date": "2023-11-16_21-48-07", "timestamp": 1700200087, "time_this_iter_s": 1.0141539573669434, "time_total_s": 3.0250637531280518, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 3.0250637531280518, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 58.55, "ram_util_percent": 61.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08220100402832, "actor_loss": -4.162145614624023, "critic_loss": 4.260990142822266, "alpha_loss": -0.018146349117159843, "alpha_value": 0.9982017874717712, "log_alpha_value": -0.0017998401308432221, "target_entropy": -6.0, "policy_t": 0.0266707856208086, "mean_q": 0.08917103707790375, "max_q": 0.12848828732967377, "min_q": 0.06773364543914795}, "td_error": [5.565889358520508, 4.189298152923584, 4.6038360595703125, 4.0058488845825195, 5.0646514892578125, 4.29541015625, 5.6071367263793945, 5.384001731872559, 4.841579437255859, 3.0456347465515137, 4.080215930938721, 7.186178684234619, 5.834092140197754, 4.628133773803711, 4.965169906616211, 6.6201887130737305, 5.175739288330078, 6.365789413452148, 5.731153964996338, 6.91423225402832, 5.668575286865234, 6.072989463806152, 6.040666580200195, 4.590933799743652, 8.065159797668457, 7.082633972167969, 6.223207950592041, 5.112797737121582, 6.14780855178833, 5.03878116607666, 6.351363182067871, 6.779974937438965, 4.2487382888793945, 4.4532623291015625, 6.771296501159668, 5.419221878051758, 6.211224555969238, 5.141984939575195, 6.549990653991699, 5.388099670410156, 6.55723237991333, 4.889562606811523, 5.18746280670166, 6.630358695983887, 4.874467849731445, 6.653459548950195, 4.888399124145508, 3.1026053428649902, 4.462035179138184, 5.000326156616211, 2.181922435760498, 6.399509429931641, 5.628727912902832, 4.938158988952637, 5.617993354797363, 7.128391265869141, 4.482694625854492, 5.92117977142334, 4.851513385772705, 3.1802802085876465, 5.582062244415283, 6.872891426086426, 6.268949031829834, 4.446808338165283, 6.108493328094482, 5.8170061111450195, 4.425053119659424, 6.278072357177734, 4.601194381713867, 8.145252227783203, 6.044236660003662, 5.563873291015625, 4.668095111846924, 5.075170516967773, 6.073131561279297, 7.454747200012207, 4.999161720275879, 5.463233470916748, 5.488766193389893, 5.5457892417907715, 6.710500717163086, 4.9606523513793945, 6.093952178955078, 6.369216442108154, 5.158308506011963, 7.011598587036133], "mean_td_error": 5.526341915130615, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.048574447631836, "actor_loss": -4.131207466125488, "critic_loss": 1.6105955839157104, "alpha_loss": -0.018090873956680298, "alpha_value": 0.9982012510299683, "log_alpha_value": -0.0018003423465415835, "target_entropy": -6.0, "policy_t": -0.029490157961845398, "mean_q": 0.0971926674246788, "max_q": 0.11871545761823654, "min_q": 0.07988762855529785}, "td_error": [4.774851322174072, 3.738800287246704, 2.691708564758301, 3.1275272369384766, 3.951899528503418, 3.318352222442627, 3.499447822570801, 3.3142142295837402, 4.22184944152832, 3.3503670692443848, 3.1500329971313477, 1.5379966497421265, 3.5040557384490967, 3.5559887886047363, 2.7788877487182617, 3.4702160358428955, 3.4933786392211914, 4.497608184814453, 4.703606605529785, 4.065667152404785, 2.226248264312744, 3.4820940494537354, 3.9317636489868164, 3.4294772148132324, 2.5074944496154785, 5.509438514709473, 4.413016319274902, 3.5932459831237793, 2.0453553199768066, 4.502093315124512, 2.8032758235931396, 2.9790236949920654, 4.386675834655762, 2.12353253364563, 2.288515090942383, 3.86506724357605, 2.971919536590576, 4.268468856811523, 0.5313283205032349, 4.1830291748046875, 2.799973964691162, 1.8493679761886597, 4.773462772369385, 3.9950485229492188, 3.159965991973877, 4.9467363357543945, 3.999925136566162, 4.244457721710205, 4.138117790222168, 3.937133550643921, 3.108187675476074, 4.887468338012695, 1.345359444618225, 3.840327262878418, 3.7538373470306396, 4.105482578277588, 3.3391432762145996, 4.622774124145508, 2.9572620391845703, 3.777845621109009, 3.4309229850769043, 3.7826924324035645, 3.924020290374756, 4.905820846557617, 5.198468208312988, 3.5684728622436523, 4.593291282653809, 3.454271078109741, 4.33221435546875, 2.490570306777954, 4.626642227172852, 3.655611038208008, 5.6017255783081055, 3.692564010620117, 4.296660900115967, 3.1331727504730225, 2.790320873260498, 4.880241394042969, 4.321714878082275, 3.2324600219726562, 3.0843417644500732, 3.6322836875915527, 3.6479010581970215, 4.253762722015381, 3.3512144088745117, 3.5983920097351074], "mean_td_error": 3.6261532306671143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062908172607422, "actor_loss": -4.151312828063965, "critic_loss": 1.2652521133422852, "alpha_loss": -0.01811247132718563, "alpha_value": 0.9982016682624817, "log_alpha_value": -0.0017999241827055812, "target_entropy": -6.0, "policy_t": -0.007081044837832451, "mean_q": 0.10161470621824265, "max_q": 0.12843668460845947, "min_q": 0.07268975675106049}, "td_error": [2.6233389377593994, 3.8287434577941895, 2.8340957164764404, 5.920848846435547, 4.692442893981934, 4.163671493530273, 4.24623966217041, 4.160488128662109, 3.6396758556365967, 6.2058610916137695, 4.108475685119629, 3.222334623336792, 3.1359164714813232, 3.739342451095581, 4.359382629394531, 4.65472936630249, 3.6241023540496826, 4.065090656280518, 3.996781349182129, 4.941610336303711, 2.857421636581421, 3.404627799987793, 3.3748271465301514, 4.352975845336914, 2.3435823917388916, 5.599575042724609, 2.7647705078125, 3.8890738487243652, 3.387728691101074, 4.3207011222839355, 4.002976417541504, 4.745257377624512, 2.532198905944824, 3.9664535522460938, 2.27748966217041, 2.586979866027832, 3.5809519290924072, 3.249476194381714, 4.720354080200195, 3.918560028076172, 4.651154518127441, 3.971388339996338, 5.149160861968994, 3.6759352684020996, 4.289811134338379, 2.502638578414917, 2.434722661972046, 2.656780242919922, 5.186665058135986, 3.724412202835083, 3.290276050567627, 2.6757278442382812, 4.40140438079834, 5.097945690155029, 3.2332844734191895, 3.293689727783203, 4.9061431884765625, 4.175999641418457, 2.05348539352417, 2.7308731079101562, 3.576735019683838, 4.802942276000977, 5.349173545837402, 2.1543619632720947, 1.1331532001495361, 4.147910118103027, 4.640417098999023, 4.716714859008789, 3.9890239238739014, 5.162334442138672, 4.745366096496582, 3.0286707878112793, 4.7179718017578125, 3.7030279636383057, 3.403575897216797, 1.6877613067626953, 2.6165952682495117, 3.197568655014038, 3.5409841537475586, 5.164041519165039, 3.1414682865142822, 4.060736656188965, 2.651108980178833, 3.394768476486206, 2.8019700050354004, 2.9011924266815186], "mean_td_error": 3.750816583633423, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 1547, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 4641, "num_agent_steps_trained": 1806, "last_target_update_ts": 1547, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4641, "num_agent_steps_trained": 1806, "num_env_steps_sampled": 1547, "num_env_steps_trained": 1806, "num_env_steps_sampled_this_iter": 168, "num_env_steps_trained_this_iter": 1806, "num_env_steps_sampled_throughput_per_sec": 164.1790621349243, "num_env_steps_trained_throughput_per_sec": 1764.924917950436, "timesteps_total": 1547, "num_steps_trained_this_iter": 1806, "agent_timesteps_total": 4641, "timers": {"training_iteration_time_ms": 83.481, "sample_time_ms": 14.239, "load_time_ms": 0.328, "load_throughput": 787658.628, "learn_time_ms": 24.578, "learn_throughput": 10497.08, "synch_weights_time_ms": 13.928}, "counters": {"num_env_steps_sampled": 1547, "num_env_steps_trained": 1806, "num_agent_steps_sampled": 4641, "num_agent_steps_trained": 1806, "last_target_update_ts": 1547, "num_target_updates": 7}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "db258_00000", "date": "2023-11-16_21-48-08", "timestamp": 1700200088, "time_this_iter_s": 1.031515121459961, "time_total_s": 4.056578874588013, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 4.056578874588013, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.5, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1300687789917, "actor_loss": -4.701357364654541, "critic_loss": 3.4424097537994385, "alpha_loss": -0.06384136527776718, "alpha_value": 0.9937176704406738, "log_alpha_value": -0.006302164401859045, "target_entropy": -6.0, "policy_t": 0.014068263582885265, "mean_q": 0.6213129758834839, "max_q": 0.8299538493156433, "min_q": 0.5018696784973145}, "td_error": [4.695003986358643, 5.8778886795043945, 3.9044227600097656, 2.6926255226135254, 4.314826011657715, 4.9704790115356445, 5.676113128662109, 3.8640785217285156, 4.091483116149902, 5.394655704498291, 4.462090015411377, 6.037265777587891, 4.08287239074707, 4.097597122192383, 5.648783206939697, 5.632576942443848, 3.7022488117218018, 5.874536514282227, 3.5199484825134277, 5.301743507385254, 5.8173065185546875, 6.24169921875, 4.471891403198242, 5.3357110023498535, 6.329036712646484, 4.11260986328125, 6.32107400894165, 5.0783538818359375, 4.116329193115234, 3.778736114501953, 5.9482197761535645, 6.123563766479492, 6.344485282897949, 4.343961238861084, 5.804765701293945, 3.051676034927368, 4.336363792419434, 6.574248313903809, 5.0312371253967285, 5.293194770812988, 6.106104850769043, 5.3633551597595215, 5.11094856262207, 3.819608211517334, 7.400599479675293, 8.082155227661133, 5.249237060546875, 6.080209732055664, 5.923565864562988, 5.509032726287842, 5.705896377563477, 5.045485973358154, 5.862890243530273, 3.958322048187256, 4.944048881530762, 5.818469047546387, 5.428483009338379, 5.534269332885742, 3.422588348388672, 6.008943557739258, 4.7012786865234375, 6.33603572845459, 3.8635945320129395, 7.255208492279053, 5.567989826202393, 5.078076362609863, 5.179157257080078, 4.866746425628662, 3.9944229125976562, 7.094632148742676, 4.628574371337891, 4.088668346405029, 5.0345458984375, 3.7371034622192383, 3.775885581970215, 4.724750518798828, 5.603085517883301, 5.002244472503662, 5.096946716308594, 4.01463508605957, 3.2991299629211426, 6.274014949798584, 5.43741512298584, 5.048395156860352, 6.4387664794921875, 6.668220520019531], "mean_td_error": 5.133481979370117, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056922912597656, "actor_loss": -4.6180315017700195, "critic_loss": 1.3402202129364014, "alpha_loss": -0.06339294463396072, "alpha_value": 0.9937164187431335, "log_alpha_value": -0.006303412839770317, "target_entropy": -6.0, "policy_t": 0.008155783638358116, "mean_q": 0.6235743761062622, "max_q": 0.749159038066864, "min_q": 0.5127366781234741}, "td_error": [2.757444143295288, 1.7227752208709717, 4.312618732452393, 3.242398262023926, 3.5723533630371094, 3.816446542739868, 1.8978956937789917, 2.3262434005737305, 3.773325204849243, 6.214330673217773, 3.702361583709717, 3.126891613006592, 2.5720276832580566, 2.260556221008301, 2.179698944091797, 4.28794527053833, 3.060939311981201, 4.87720251083374, 2.2708382606506348, 3.0882632732391357, 4.439429759979248, 1.8229776620864868, 4.176832675933838, 4.121223449707031, 5.526537895202637, 2.3214709758758545, 1.1089394092559814, 2.586127281188965, 0.7257646918296814, 2.0136401653289795, 2.6385412216186523, 4.507015228271484, 1.3148853778839111, 2.601351737976074, 2.774458646774292, 4.88201904296875, 3.993541717529297, 2.6739721298217773, 4.930778503417969, 2.662475109100342, 4.650274276733398, 0.7723041772842407, 3.10099720954895, 3.7672677040100098, 2.9685401916503906, 2.952235698699951, 5.464442253112793, 4.2119245529174805, 2.377692699432373, 3.104191780090332, 2.811403274536133, 3.7745237350463867, 4.536344528198242, 2.364250659942627, 3.7711238861083984, 2.9265756607055664, 1.8538272380828857, 3.142254590988159, 4.224260330200195, 2.6070876121520996, 3.712679147720337, 3.2236833572387695, 2.46376895904541, 2.7443604469299316, 1.6802246570587158, 3.986417531967163, 2.1732492446899414, 3.082313060760498, 3.3173913955688477, 2.924245834350586, 5.264195442199707, 2.666597366333008, 1.475813627243042, 5.635650634765625, 2.4456064701080322, 3.7462077140808105, 2.8241055011749268, 3.197704792022705, 1.8948204517364502, 3.5419187545776367, 3.5166454315185547, 4.118377685546875, 2.3058743476867676, 2.913046360015869, 4.2378621101379395, 4.653692722320557], "mean_td_error": 3.2094478607177734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084831237792969, "actor_loss": -4.633062362670898, "critic_loss": 0.9830740690231323, "alpha_loss": -0.06356693059206009, "alpha_value": 0.9937165975570679, "log_alpha_value": -0.006303220987319946, "target_entropy": -6.0, "policy_t": -0.021952452138066292, "mean_q": 0.6016489267349243, "max_q": 0.7601675391197205, "min_q": 0.4824329614639282}, "td_error": [5.062782287597656, 2.854045867919922, 2.8999528884887695, 2.6621527671813965, 4.184700012207031, 3.856255531311035, 4.085078239440918, 1.2565712928771973, 4.094714164733887, 4.553611755371094, 3.5246009826660156, 3.1808199882507324, 2.301947593688965, 2.4043850898742676, 3.8430004119873047, 4.70235538482666, 2.734070301055908, 4.528388977050781, 3.2351725101470947, 3.8181838989257812, 2.9097423553466797, 2.1869912147521973, 2.4009225368499756, 3.723132371902466, 3.309389591217041, 3.0053505897521973, 4.337952136993408, 3.4057774543762207, 3.9987287521362305, 4.132652759552002, 4.4165449142456055, 2.274110794067383, 3.55765962600708, 2.0218610763549805, 4.341524124145508, 3.849419116973877, 1.8822572231292725, 2.005868673324585, 2.2911453247070312, 3.135213851928711, 3.1201589107513428, 2.6022119522094727, 1.8651269674301147, 4.40346097946167, 5.462002754211426, 4.112394332885742, 1.4486490488052368, 4.977847099304199, 4.619243621826172, 3.500781536102295, 4.124548435211182, 2.781676769256592, 3.439438819885254, 5.05244255065918, 1.4836890697479248, 3.911010265350342, 3.903289794921875, 4.213947296142578, 3.2109084129333496, 3.8842275142669678, 2.247647762298584, 1.541977882385254, 3.372689723968506, 3.551975727081299, 1.714379072189331, 3.6039023399353027, 2.685281753540039, 4.367256164550781, 2.8524274826049805, 3.7989256381988525, 2.491408348083496, 2.1084177494049072, 2.815800189971924, 2.839083194732666, 2.729010581970215, 2.659301996231079, 2.124283790588379, 2.477609395980835, 4.708080291748047, 2.907477378845215, 4.7603607177734375, 3.4753241539001465, 1.0339787006378174, 5.333600997924805, 4.3378705978393555, 3.062819719314575], "mean_td_error": 3.310314178466797, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 1652, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 4956, "num_agent_steps_trained": 5676, "last_target_update_ts": 1652, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4956, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 1652, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.95035078984223, "num_env_steps_trained_throughput_per_sec": 2504.4557862541856, "timesteps_total": 1652, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 4956, "timers": {"training_iteration_time_ms": 102.006, "sample_time_ms": 14.985, "load_time_ms": 0.312, "load_throughput": 827949.833, "learn_time_ms": 17.835, "learn_throughput": 14465.824, "synch_weights_time_ms": 10.724}, "counters": {"num_env_steps_sampled": 1652, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 4956, "num_agent_steps_trained": 5676, "last_target_update_ts": 1652, "num_target_updates": 22}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "db258_00000", "date": "2023-11-16_21-48-10", "timestamp": 1700200090, "time_this_iter_s": 1.5534873008728027, "time_total_s": 5.610066175460815, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 5.610066175460815, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.366666666666664, "ram_util_percent": 61.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075486183166504, "actor_loss": -6.063729763031006, "critic_loss": 1.9244825839996338, "alpha_loss": -0.10887272655963898, "alpha_value": 0.9892524480819702, "log_alpha_value": -0.010805703699588776, "target_entropy": -6.0, "policy_t": 0.02045445702970028, "mean_q": 2.031054973602295, "max_q": 2.5193235874176025, "min_q": 1.6339240074157715}, "td_error": [4.940311908721924, 2.2193264961242676, 3.595414161682129, 2.3361644744873047, 3.468963861465454, 3.8406476974487305, 3.1582794189453125, 2.266331434249878, 3.6592202186584473, 3.675496816635132, 3.562411308288574, 3.0838427543640137, 2.6525399684906006, 5.14202880859375, 3.38531494140625, 2.3504838943481445, 5.044125080108643, 4.361983299255371, 3.425276279449463, 1.6550544500350952, 4.350491523742676, 6.066216468811035, 4.522766590118408, 4.168537139892578, 4.301635265350342, 3.8123016357421875, 2.2029571533203125, 2.4075231552124023, 4.300719261169434, 2.8152987957000732, 2.684752941131592, 3.9894349575042725, 3.004840850830078, 2.5268516540527344, 1.1069908142089844, 3.660531520843506, 4.7465620040893555, 4.569246768951416, 4.361054420471191, 3.1423912048339844, 4.10489559173584, 5.362674713134766, 3.174121379852295, 3.2835235595703125, 1.5093146562576294, 2.8194375038146973, 2.8498127460479736, 4.752139091491699, 5.282273292541504, 4.8690714836120605, 5.052746772766113, 4.355532169342041, 4.189234256744385, 4.064053535461426, 4.762812614440918, 1.7182183265686035, 1.9519566297531128, 3.1767404079437256, 2.269695281982422, 2.7860240936279297, 6.271388053894043, 3.2747225761413574, 3.338526487350464, 2.863626718521118, 4.0870747566223145, 4.2701849937438965, 1.681787133216858, 3.479085922241211, 4.849442005157471, 3.8814282417297363, 2.69732403755188, 2.8758087158203125, 3.8111960887908936, 1.1845589876174927, 3.888627529144287, 2.44051456451416, 4.349513053894043, 2.440741539001465, 2.4323678016662598, 1.8949143886566162, 3.3452038764953613, 4.523336410522461, 2.788557767868042, 3.5571181774139404, 4.64931583404541, 3.1197876930236816], "mean_td_error": 3.4987761974334717, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071033477783203, "actor_loss": -6.025012493133545, "critic_loss": 0.37925922870635986, "alpha_loss": -0.10883007198572159, "alpha_value": 0.9892519116401672, "log_alpha_value": -0.010806246660649776, "target_entropy": -6.0, "policy_t": -0.07441684603691101, "mean_q": 2.0435941219329834, "max_q": 2.5635998249053955, "min_q": 1.7089321613311768}, "td_error": [3.9609217643737793, 1.449792504310608, 1.5192601680755615, 1.7793748378753662, 0.15987420082092285, 2.4041712284088135, 1.7215673923492432, 0.2870251536369324, 0.05336594581604004, 3.2127063274383545, 0.8631497621536255, 2.842017889022827, 1.8873404264450073, 0.8606621623039246, 3.259875774383545, 0.579732358455658, 3.3859729766845703, 2.1585464477539062, 0.829128623008728, 2.0760107040405273, 1.6267967224121094, 0.550484299659729, 1.0114336013793945, 1.3383206129074097, 0.8957341909408569, 1.092454433441162, 2.6189990043640137, 1.3146274089813232, 2.066560983657837, 2.0083794593811035, 1.0804120302200317, 1.3863794803619385, 1.25114905834198, 2.8116040229797363, 1.6546982526779175, 2.4543604850769043, 0.29513657093048096, 2.395193576812744, 1.4847296476364136, 1.359851360321045, 1.0107587575912476, 0.9736776351928711, 2.2582318782806396, 0.30734264850616455, 0.6250653266906738, 0.5945334434509277, 0.7678515911102295, 3.826718807220459, 2.2017858028411865, 3.4210190773010254, 3.3226711750030518, 1.6227941513061523, 1.6098943948745728, 0.942595362663269, 1.5873229503631592, 1.384635329246521, 1.0791537761688232, 1.774693489074707, 1.2778815031051636, 2.869757890701294, 2.271836757659912, 2.5006494522094727, 2.9471449851989746, 2.5116915702819824, 1.5439198017120361, 2.732926368713379, 0.8236732482910156, 0.22670495510101318, 1.2954578399658203, 2.567152500152588, 1.158679485321045, 0.712674081325531, 2.2733898162841797, 0.9527633190155029, 2.745455741882324, 1.0712342262268066, 0.9121308326721191, 0.7519936561584473, 2.3535706996917725, 2.0451314449310303, 1.5584968328475952, 2.2544703483581543, 0.49907803535461426, 0.6057320833206177, 2.8998665809631348, 0.9725213050842285], "mean_td_error": 1.6585410833358765, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.041584014892578, "actor_loss": -5.986239433288574, "critic_loss": 0.4303809106349945, "alpha_loss": -0.10851908475160599, "alpha_value": 0.9892511963844299, "log_alpha_value": -0.010806969366967678, "target_entropy": -6.0, "policy_t": 0.05842950567603111, "mean_q": 1.9652034044265747, "max_q": 2.4281373023986816, "min_q": 1.5976243019104004}, "td_error": [0.3418952226638794, 1.0139126777648926, 1.7577651739120483, 1.8093318939208984, 2.4413371086120605, 2.5480871200561523, 1.891289472579956, 2.626086473464966, 2.50129771232605, 0.2932770252227783, 1.337104082107544, 0.7791157960891724, 2.0735373497009277, 1.6658304929733276, 0.8655917644500732, 1.3126511573791504, 1.8277945518493652, 1.6402860879898071, 1.5229768753051758, 1.1078739166259766, 3.376124620437622, 0.284065306186676, 0.7369951009750366, 0.8791571855545044, 1.589289903640747, 1.917399287223816, 2.5124783515930176, 1.4654687643051147, 2.0177693367004395, 1.9551855325698853, 1.0690438747406006, 2.454648733139038, 0.5952699184417725, 4.003259181976318, 1.5860645771026611, 4.9016523361206055, 2.787858247756958, 3.1967711448669434, 2.374337673187256, 0.45065033435821533, 1.4934439659118652, 1.5433545112609863, 2.271311044692993, 0.4955707788467407, 1.971874713897705, 2.018247127532959, 1.7570024728775024, 2.535064220428467, 2.0965118408203125, 0.8460191488265991, 0.9993278980255127, 1.5649534463882446, 0.2412869930267334, 1.4739727973937988, 1.7262277603149414, 2.7326159477233887, 0.3368089199066162, 1.8599861860275269, 1.8279958963394165, 0.06347155570983887, 3.118941307067871, 0.22905617952346802, 0.0841989517211914, 0.22117102146148682, 0.5081050395965576, 0.8451669812202454, 1.6911827325820923, 3.422152042388916, 1.8791970014572144, 3.507647752761841, 0.5244541168212891, 2.4579925537109375, 3.0446527004241943, 2.256356716156006, 1.0128867626190186, 3.2096753120422363, 1.6890969276428223, 2.8503506183624268, 1.4897347688674927, 2.6922998428344727, 2.9211976528167725, 2.084813117980957, 1.1405538320541382, 2.3885257244110107, 1.812443494796753, 1.3058584928512573], "mean_td_error": 1.7413172721862793, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 1757, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 5271, "num_agent_steps_trained": 9546, "last_target_update_ts": 1757, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5271, "num_agent_steps_trained": 9546, "num_env_steps_sampled": 1757, "num_env_steps_trained": 9546, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.11750124935676, "num_env_steps_trained_throughput_per_sec": 2510.6164746191494, "timesteps_total": 1757, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 5271, "timers": {"training_iteration_time_ms": 103.104, "sample_time_ms": 15.923, "load_time_ms": 0.312, "load_throughput": 827823.158, "learn_time_ms": 18.158, "learn_throughput": 14208.291, "synch_weights_time_ms": 10.725}, "counters": {"num_env_steps_sampled": 1757, "num_env_steps_trained": 9546, "num_agent_steps_sampled": 5271, "num_agent_steps_trained": 9546, "last_target_update_ts": 1757, "num_target_updates": 37}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "db258_00000", "date": "2023-11-16_21-48-12", "timestamp": 1700200092, "time_this_iter_s": 1.5506160259246826, "time_total_s": 7.160682201385498, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 7.160682201385498, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 61.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068115234375, "actor_loss": -8.796040534973145, "critic_loss": 0.31712815165519714, "alpha_loss": -0.15411785244941711, "alpha_value": 0.9848090410232544, "log_alpha_value": -0.015307517722249031, "target_entropy": -6.0, "policy_t": 0.02814447320997715, "mean_q": 4.858797550201416, "max_q": 5.854667663574219, "min_q": 4.00980806350708}, "td_error": [0.4364585876464844, 0.3723592758178711, 0.7930927276611328, 0.46336841583251953, 0.7466585636138916, 0.7017896175384521, 0.5916750431060791, 0.8926775455474854, 1.1068003177642822, 0.8976006507873535, 3.0510706901550293, 3.319169044494629, 0.7752504348754883, 0.7167685031890869, 0.61191725730896, 1.9347522258758545, 0.9986348152160645, 0.7319991588592529, 0.9119482040405273, 2.6937193870544434, 0.34479761123657227, 1.212465763092041, 0.5641884803771973, 0.8929290771484375, 0.797274112701416, 1.538468599319458, 0.32972002029418945, 0.3234374523162842, 1.9684908390045166, 0.4177889823913574, 0.44733619689941406, 1.5044927597045898, 0.35515332221984863, 0.7237119674682617, 0.4026498794555664, 0.4130687713623047, 1.008117437362671, 0.9234013557434082, 1.5431032180786133, 2.0704567432403564, 0.6561212539672852, 0.46218276023864746, 0.792426586151123, 1.640141487121582, 2.196556329727173, 0.5320992469787598, 0.500227689743042, 1.1237895488739014, 0.3666961193084717, 0.7002203464508057, 0.592109203338623, 1.5669829845428467, 0.5608294010162354, 0.8501477241516113, 1.6739184856414795, 1.9439504146575928, 2.0839366912841797, 0.5077712535858154, 0.23397254943847656, 0.6502952575683594, 1.8691775798797607, 0.7573175430297852, 1.2887582778930664, 3.8341329097747803, 0.8835880756378174, 0.2993483543395996, 2.379385471343994, 0.2798290252685547, 1.0558247566223145, 0.5600895881652832, 2.5721309185028076, 2.850301742553711, 3.887014150619507, 0.7053587436676025, 0.9367978572845459, 0.6550545692443848, 0.6870627403259277, 0.33452868461608887, 0.779395580291748, 0.5545811653137207, 0.49582648277282715, 1.0157749652862549, 2.253244400024414, 0.9448537826538086, 0.6445457935333252, 1.1970937252044678], "mean_td_error": 1.0916762351989746, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111931800842285, "actor_loss": -8.074018478393555, "critic_loss": 0.21821613609790802, "alpha_loss": -0.15480855107307434, "alpha_value": 0.9848070740699768, "log_alpha_value": -0.015309493988752365, "target_entropy": -6.0, "policy_t": 0.046127062290906906, "mean_q": 4.191678047180176, "max_q": 5.120711326599121, "min_q": 3.6772117614746094}, "td_error": [0.945775032043457, 0.623288631439209, 0.3954124450683594, 0.5185918807983398, 1.6877408027648926, 0.009091854095458984, 0.6502859592437744, 0.7080748081207275, 1.4894745349884033, 1.2476985454559326, 0.8424110412597656, 0.991809606552124, 0.5318140983581543, 0.31561279296875, 2.1668670177459717, 0.5521649122238159, 0.3973742723464966, 0.6593935489654541, 0.43291687965393066, 1.9817523956298828, 0.19901323318481445, 0.7853426933288574, 1.7370505332946777, 1.9672759771347046, 0.11127257347106934, 0.4130443334579468, 0.6711978912353516, 0.19034719467163086, 0.9881962537765503, 0.6398680210113525, 0.38262033462524414, 3.8722732067108154, 1.821648359298706, 1.8880343437194824, 1.1538009643554688, 0.45772433280944824, 0.5503556728363037, 1.316819190979004, 0.8724651336669922, 0.5511219501495361, 0.47789549827575684, 0.6491498947143555, 0.6036803722381592, 1.4603159427642822, 3.173914909362793, 0.3099253177642822, 0.6768114566802979, 2.7883524894714355, 1.4508247375488281, 1.446681261062622, 0.14402222633361816, 0.5447087287902832, 0.09998035430908203, 0.26664745807647705, 1.0500352382659912, 1.978586196899414, 0.7975528240203857, 0.470669150352478, 0.40778017044067383, 0.6051912307739258, 2.6804566383361816, 2.272158145904541, 0.9998955726623535, 0.6039695739746094, 1.4330496788024902, 1.1745154857635498, 0.12987112998962402, 0.17676687240600586, 0.7449028491973877, 2.091890811920166, 0.6209256649017334, 2.3059804439544678, 1.4932115077972412, 1.1735100746154785, 0.48148632049560547, 0.3764679431915283, 1.046706199645996, 2.0650806427001953, 0.40006983280181885, 0.43915534019470215, 0.3398780822753906, 0.2982919216156006, 0.259838342666626, 0.30518102645874023, 0.981844425201416, 0.2664682865142822], "mean_td_error": 0.956759512424469, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036120414733887, "actor_loss": -8.171459197998047, "critic_loss": 0.2741991877555847, "alpha_loss": -0.15358644723892212, "alpha_value": 0.9848131537437439, "log_alpha_value": -0.015303365886211395, "target_entropy": -6.0, "policy_t": 0.04148752614855766, "mean_q": 4.251278400421143, "max_q": 5.438727378845215, "min_q": 3.4831581115722656}, "td_error": [2.357043504714966, 0.986957311630249, 0.7301254272460938, 1.3655407428741455, 0.7371078729629517, 0.20673608779907227, 0.49167966842651367, 0.32993078231811523, 0.11717844009399414, 1.3663485050201416, 0.55322265625, 0.5083670616149902, 0.48468828201293945, 0.5386309623718262, 2.108258008956909, 1.226863980293274, 1.2379438877105713, 0.6464934349060059, 1.1503465175628662, 0.14179039001464844, 0.2320554256439209, 0.2657442092895508, 0.40465831756591797, 0.1326427459716797, 1.341292381286621, 1.7233853340148926, 0.16656494140625, 1.0036633014678955, 3.3844988346099854, 2.227285146713257, 2.274907350540161, 0.5025790929794312, 0.5267291069030762, 0.3614528179168701, 0.36466288566589355, 1.1282250881195068, 0.9598565101623535, 0.7906436920166016, 1.9906907081604004, 0.24362993240356445, 0.5886380672454834, 0.614248514175415, 0.2126626968383789, 2.3445093631744385, 1.585270881652832, 2.381068468093872, 1.7078728675842285, 1.3926810026168823, 1.3727006912231445, 0.5648198127746582, 2.8784408569335938, 1.2591769695281982, 1.5912256240844727, 0.7590410709381104, 0.5071802139282227, 0.6196248531341553, 1.9226322174072266, 1.176854133605957, 0.5292297601699829, 0.2342432737350464, 1.7032067775726318, 1.331505537033081, 1.7101624011993408, 0.856886625289917, 1.6545524597167969, 0.5368883609771729, 0.4173612594604492, 1.8274463415145874, 1.8526785373687744, 0.4909036159515381, 1.018880844116211, 1.386108636856079, 1.2527611255645752, 1.7344655990600586, 4.042626857757568, 1.7749311923980713, 1.402440071105957, 2.0392556190490723, 0.7903347015380859, 0.6729114055633545, 0.42940640449523926, 1.3986501693725586, 2.975771427154541, 0.5622053146362305, 0.8954720497131348, 2.1365272998809814], "mean_td_error": 1.1447312831878662, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 1862, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 5586, "num_agent_steps_trained": 13416, "last_target_update_ts": 1862, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5586, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 1862, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 63.09815761060182, "num_env_steps_trained_throughput_per_sec": 2325.617809076467, "timesteps_total": 1862, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 5586, "timers": {"training_iteration_time_ms": 115.557, "sample_time_ms": 16.061, "load_time_ms": 0.315, "load_throughput": 818122.35, "learn_time_ms": 17.816, "learn_throughput": 14481.311, "synch_weights_time_ms": 10.155}, "counters": {"num_env_steps_sampled": 1862, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 5586, "num_agent_steps_trained": 13416, "last_target_update_ts": 1862, "num_target_updates": 52}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "db258_00000", "date": "2023-11-16_21-48-13", "timestamp": 1700200093, "time_this_iter_s": 1.6725399494171143, "time_total_s": 8.833222150802612, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 8.833222150802612, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.5, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074638366699219, "actor_loss": -10.263532638549805, "critic_loss": 0.3567403554916382, "alpha_loss": -0.1994822770357132, "alpha_value": 0.9803943037986755, "log_alpha_value": -0.019800441339612007, "target_entropy": -6.0, "policy_t": -0.0028091261629015207, "mean_q": 6.5525407791137695, "max_q": 8.156903266906738, "min_q": 5.269489765167236}, "td_error": [0.6594514846801758, 1.7944276332855225, 0.9983124732971191, 2.231288194656372, 0.8984360694885254, 4.001880645751953, 2.3560245037078857, 0.551079511642456, 1.4707281589508057, 0.43962836265563965, 0.9401984214782715, 1.3752045631408691, 0.7955098152160645, 0.273207426071167, 1.525545358657837, 0.9315879344940186, 2.943131685256958, 1.9961819648742676, 2.6738367080688477, 0.5009102821350098, 0.14995074272155762, 0.1473245620727539, 0.30842018127441406, 0.329836368560791, 0.6210966110229492, 0.48203587532043457, 0.39171504974365234, 1.2764101028442383, 3.3280091285705566, 1.2304773330688477, 3.6270272731781006, 3.239624500274658, 0.5787556171417236, 0.6977519989013672, 0.9022960662841797, 0.15814566612243652, 1.573352336883545, 1.3232669830322266, 1.6737909317016602, 1.619447946548462, 0.461775541305542, 3.1127989292144775, 0.010781288146972656, 0.18239355087280273, 0.8008480072021484, 0.6482555866241455, 2.27126407623291, 0.4100358486175537, 1.6393547058105469, 1.5897207260131836, 1.2057995796203613, 0.35082030296325684, 0.4625530242919922, 2.1565093994140625, 1.442307472229004, 2.443824052810669, 3.2679286003112793, 0.5110273361206055, 0.4616875648498535, 0.7974488735198975, 3.8784804344177246, 1.01800537109375, 1.2653007507324219, 3.449162006378174, 0.5199217796325684, 1.7127277851104736, 0.7605733871459961, 0.3327476978302002, 1.633199691772461, 0.5717461109161377, 1.6659350395202637, 1.0838472843170166, 2.836216926574707, 0.13946533203125, 1.1804828643798828, 0.20554232597351074, 1.9064288139343262, 2.28171968460083, 1.7542409896850586, 2.4966909885406494, 0.8112039566040039, 1.6093699932098389, 2.495433807373047, 2.0072011947631836, 0.15186810493469238, 1.7219746112823486], "mean_td_error": 1.3573482036590576, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077263832092285, "actor_loss": -7.628311634063721, "critic_loss": 0.19330108165740967, "alpha_loss": -0.19961363077163696, "alpha_value": 0.9803865551948547, "log_alpha_value": -0.019808320328593254, "target_entropy": -6.0, "policy_t": -0.0045492625795304775, "mean_q": 3.786176919937134, "max_q": 4.6274800300598145, "min_q": 3.2236695289611816}, "td_error": [0.5331205129623413, 0.5519998073577881, 1.0340466499328613, 0.5088584423065186, 0.8030574321746826, 0.6117241382598877, 0.09624910354614258, 2.034635543823242, 0.5369771718978882, 0.08214092254638672, 0.8061944246292114, 1.2965147495269775, 0.8238074779510498, 2.2777347564697266, 1.3923442363739014, 0.7493911981582642, 1.6299128532409668, 0.08798503875732422, 0.9725558757781982, 2.00482177734375, 0.4137890338897705, 0.5598617792129517, 0.32994329929351807, 0.8213992118835449, 0.2547953128814697, 0.045673489570617676, 0.9880934953689575, 1.0528095960617065, 2.2426671981811523, 0.6711506843566895, 0.365980863571167, 2.4164140224456787, 0.9003392457962036, 2.643558979034424, 1.2537753582000732, 0.7174636125564575, 0.7074575424194336, 0.5006217956542969, 0.3491569757461548, 0.6335558891296387, 0.8986790180206299, 2.48753023147583, 1.5565929412841797, 0.938501238822937, 1.0303375720977783, 0.7913564443588257, 1.5424306392669678, 0.9310150146484375, 0.6322813034057617, 0.8952846527099609, 1.2155189514160156, 1.997987985610962, 0.5375838279724121, 1.9550292491912842, 0.5343552827835083, 0.6373835802078247, 2.3324553966522217, 0.3810933828353882, 1.0037566423416138, 1.0171900987625122, 0.7130873203277588, 1.50660240650177, 0.09428274631500244, 0.18616175651550293, 1.3667627573013306, 1.4333842992782593, 1.0962146520614624, 0.08664488792419434, 1.3439081907272339, 0.5822169780731201, 1.7038534879684448, 0.21797072887420654, 1.0533857345581055, 0.77237868309021, 0.030733942985534668, 1.5408260822296143, 1.2882823944091797, 1.1710729598999023, 0.07261049747467041, 0.2867426872253418, 0.17205345630645752, 0.45490849018096924, 1.4140394926071167, 0.990036129951477, 0.732245922088623, 0.21687376499176025], "mean_td_error": 0.936583936214447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030372619628906, "actor_loss": -7.541172981262207, "critic_loss": 0.1456444263458252, "alpha_loss": -0.1986035406589508, "alpha_value": 0.9803945422172546, "log_alpha_value": -0.01980021595954895, "target_entropy": -6.0, "policy_t": -0.01592436619102955, "mean_q": 3.698824405670166, "max_q": 4.699653625488281, "min_q": 3.0731101036071777}, "td_error": [1.55976402759552, 0.08343696594238281, 0.3000246286392212, 0.5005378723144531, 0.8538813591003418, 0.10376012325286865, 1.2119030952453613, 0.5414009094238281, 0.7614861726760864, 0.8818652629852295, 1.7914152145385742, 0.2282780408859253, 1.0277949571609497, 0.12964093685150146, 0.2671043872833252, 0.6679332256317139, 0.17225921154022217, 0.06826937198638916, 0.4765441417694092, 1.0144318342208862, 2.263448715209961, 0.25743532180786133, 0.6856000423431396, 2.444779634475708, 0.6100955009460449, 0.6335382461547852, 0.48990392684936523, 1.2088730335235596, 1.4599498510360718, 0.1033024787902832, 1.455488920211792, 0.4929084777832031, 1.8389439582824707, 0.41870176792144775, 0.4118809700012207, 2.264406442642212, 0.10599875450134277, 1.8362939357757568, 1.481269359588623, 0.23830735683441162, 0.16962897777557373, 0.44456934928894043, 1.2631313800811768, 1.3255244493484497, 1.009467363357544, 1.4003181457519531, 0.6102306842803955, 1.231318473815918, 1.222411870956421, 0.35441291332244873, 1.7713971138000488, 1.2492533922195435, 1.5124573707580566, 0.611664891242981, 0.7628875970840454, 1.127773404121399, 0.7590823173522949, 2.2251524925231934, 0.057478904724121094, 0.24222636222839355, 0.19693529605865479, 0.7507158517837524, 0.2899758815765381, 1.5373880863189697, 1.087723970413208, 1.348124623298645, 0.1958373785018921, 1.2557077407836914, 0.6542997360229492, 0.7309169769287109, 0.6332277059555054, 1.3326432704925537, 1.128954291343689, 1.4147963523864746, 0.3962463140487671, 0.6490824222564697, 1.1267427206039429, 2.0334014892578125, 0.3865865468978882, 2.1725234985351562, 0.6166832447052002, 2.7743473052978516, 0.6483112573623657, 0.4565114974975586, 0.5234578847885132, 0.9012770652770996], "mean_td_error": 0.9062287211418152, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 1967, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 5901, "num_agent_steps_trained": 17286, "last_target_update_ts": 1967, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5901, "num_agent_steps_trained": 17286, "num_env_steps_sampled": 1967, "num_env_steps_trained": 17286, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.1478262887914, "num_env_steps_trained_throughput_per_sec": 2511.7341689297405, "timesteps_total": 1967, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 5901, "timers": {"training_iteration_time_ms": 103.148, "sample_time_ms": 16.194, "load_time_ms": 0.313, "load_throughput": 823100.656, "learn_time_ms": 18.117, "learn_throughput": 14240.713, "synch_weights_time_ms": 10.133}, "counters": {"num_env_steps_sampled": 1967, "num_env_steps_trained": 17286, "num_agent_steps_sampled": 5901, "num_agent_steps_trained": 17286, "last_target_update_ts": 1967, "num_target_updates": 67}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "db258_00000", "date": "2023-11-16_21-48-15", "timestamp": 1700200095, "time_this_iter_s": 1.549734115600586, "time_total_s": 10.382956266403198, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb67a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 10.382956266403198, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.233333333333334, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058691024780273, "actor_loss": -9.33197021484375, "critic_loss": 0.18174231052398682, "alpha_loss": -0.24422530829906464, "alpha_value": 0.9760123491287231, "log_alpha_value": -0.02428003028035164, "target_entropy": -6.0, "policy_t": -0.02400089241564274, "mean_q": 5.518800258636475, "max_q": 6.745875835418701, "min_q": 4.560102462768555}, "td_error": [1.9215185642242432, 2.3491811752319336, 0.9208602905273438, 0.8923969268798828, 1.3018083572387695, 1.118905782699585, 0.0931396484375, 0.2999277114868164, 0.1823568344116211, 0.650355339050293, 1.402899980545044, 0.2608003616333008, 0.8295469284057617, 1.815516710281372, 0.2419726848602295, 0.7069923877716064, 1.2171173095703125, 0.16159772872924805, 1.4196381568908691, 0.9259183406829834, 1.416252851486206, 1.3836867809295654, 1.2565762996673584, 1.2424037456512451, 2.054837703704834, 0.37207841873168945, 1.9901800155639648, 0.4390578269958496, 0.2940945625305176, 2.6525261402130127, 0.07261371612548828, 0.21538448333740234, 0.02590489387512207, 2.4765207767486572, 0.6218018531799316, 0.12312126159667969, 1.5016465187072754, 0.09333300590515137, 1.9417879581451416, 2.411309003829956, 0.3352622985839844, 1.0004243850708008, 2.1345181465148926, 0.09622621536254883, 0.7793779373168945, 1.5396184921264648, 0.6851427555084229, 0.13974928855895996, 1.8010830879211426, 0.8737897872924805, 0.1008157730102539, 0.1739485263824463, 0.8988051414489746, 0.08299875259399414, 0.5098097324371338, 1.4489290714263916, 0.5154180526733398, 1.3052995204925537, 0.9345283508300781, 1.6155765056610107, 2.4613776206970215, 1.2515368461608887, 0.25961852073669434, 2.3845736980438232, 0.3041355609893799, 1.3174097537994385, 1.264726161956787, 1.067403793334961, 1.97245454788208, 1.1397931575775146, 2.3171443939208984, 0.698441743850708, 0.37444519996643066, 0.1571674346923828, 0.5366239547729492, 0.768502950668335, 0.17711830139160156, 0.32932353019714355, 0.48073792457580566, 0.40630197525024414, 1.864377737045288, 0.21246051788330078, 1.8164796829223633, 0.7860803604125977, 0.46067357063293457, 0.16083455085754395], "mean_td_error": 0.9678910970687866, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058110237121582, "actor_loss": -7.2791008949279785, "critic_loss": 0.21258246898651123, "alpha_loss": -0.24449434876441956, "alpha_value": 0.9759848713874817, "log_alpha_value": -0.024308180436491966, "target_entropy": -6.0, "policy_t": -0.002287384122610092, "mean_q": 3.3982696533203125, "max_q": 4.092148780822754, "min_q": 2.856956958770752}, "td_error": [1.0917032957077026, 0.678424596786499, 0.48993122577667236, 1.3180515766143799, 2.028841733932495, 0.17448759078979492, 1.8127145767211914, 0.5868736505508423, 0.4584733247756958, 1.2222368717193604, 0.8516973257064819, 0.5221168994903564, 1.3747729063034058, 2.3922581672668457, 2.9931392669677734, 1.6484577655792236, 2.447479248046875, 0.8000445365905762, 0.271165132522583, 0.5989973545074463, 0.8704879283905029, 2.169083595275879, 0.3202347755432129, 1.6700369119644165, 0.01699197292327881, 2.086216926574707, 1.2380878925323486, 0.3846832513809204, 1.0069116353988647, 1.0333731174468994, 0.53800368309021, 1.9178946018218994, 0.8823425769805908, 0.6182460784912109, 0.19406986236572266, 0.11970722675323486, 0.03684830665588379, 1.8423634767532349, 1.3710706233978271, 0.6285326480865479, 1.0093445777893066, 0.7437756061553955, 2.05719256401062, 0.4785621166229248, 0.057970285415649414, 0.5220420360565186, 1.9165329933166504, 0.2146390676498413, 0.9079645872116089, 2.0364279747009277, 0.5415698289871216, 1.0803232192993164, 0.24111437797546387, 0.7040886878967285, 0.24303972721099854, 1.1600912809371948, 5.4871602058410645, 0.39646804332733154, 1.2922954559326172, 1.7984964847564697, 2.1064677238464355, 1.3248752355575562, 2.16332745552063, 0.32015812397003174, 0.21750235557556152, 0.009275674819946289, 1.691740870475769, 0.664523720741272, 1.0557056665420532, 0.15390968322753906, 0.5419775247573853, 0.40466809272766113, 0.6185537576675415, 0.22454142570495605, 0.22477614879608154, 0.49701929092407227, 0.46728992462158203, 0.132848858833313, 0.5159709453582764, 1.107397437095642, 0.5226939916610718, 0.3294926881790161, 1.1031633615493774, 0.4127620458602905, 1.0039955377578735, 1.0168932676315308], "mean_td_error": 0.9817172884941101, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.188493728637695, "actor_loss": -7.394988536834717, "critic_loss": 0.17738620936870575, "alpha_loss": -0.24753697216510773, "alpha_value": 0.9759970307350159, "log_alpha_value": -0.024295736104249954, "target_entropy": -6.0, "policy_t": 0.00249963765963912, "mean_q": 3.4304208755493164, "max_q": 3.943423271179199, "min_q": 2.9559264183044434}, "td_error": [2.015847682952881, 0.8273181915283203, 0.3613283634185791, 1.3643120527267456, 1.748835802078247, 1.4499399662017822, 0.1117713451385498, 2.185561180114746, 1.8999488353729248, 1.9446935653686523, 0.07894659042358398, 1.0311310291290283, 0.03768646717071533, 1.1776396036148071, 1.3019274473190308, 0.5539454221725464, 2.8294601440429688, 0.14602446556091309, 1.786238670349121, 0.9601861238479614, 2.2544498443603516, 2.097838878631592, 0.30067968368530273, 0.32605433464050293, 1.725843906402588, 1.4103424549102783, 0.041556477546691895, 0.8670269250869751, 2.4788427352905273, 0.037284255027770996, 1.472891926765442, 0.5112910270690918, 1.894527554512024, 1.8039411306381226, 1.102683186531067, 0.17708516120910645, 0.1267392635345459, 0.18418598175048828, 0.7681119441986084, 0.5627944469451904, 0.8948765993118286, 1.1470736265182495, 0.14113843441009521, 1.9258949756622314, 0.4355579614639282, 2.8103232383728027, 1.1313560009002686, 0.4510997533798218, 1.6701651811599731, 2.0142321586608887, 1.3935649394989014, 0.31471705436706543, 0.7443124055862427, 2.833070755004883, 0.17938899993896484, 1.2622673511505127, 1.3785589933395386, 0.10417866706848145, 1.0358691215515137, 1.1625945568084717, 1.6402301788330078, 0.8423199653625488, 1.8144900798797607, 0.43839454650878906, 0.4373481273651123, 0.2518179416656494, 0.5564066171646118, 0.7677953243255615, 0.48643946647644043, 0.4642423391342163, 0.06847798824310303, 0.3033161163330078, 1.3384302854537964, 0.5116317272186279, 1.682692289352417, 0.2742570638656616, 0.5322829484939575, 1.3257696628570557, 0.5918066501617432, 0.3988971710205078, 0.5369054079055786, 0.3942244052886963, 0.9963383674621582, 1.9080199003219604, 0.6903679370880127, 0.028457999229431152], "mean_td_error": 1.003122329711914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 2072, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 6216, "num_agent_steps_trained": 21156, "last_target_update_ts": 2072, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6216, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 2072, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.82524231333696, "num_env_steps_trained_throughput_per_sec": 2536.7017881201336, "timesteps_total": 2072, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 6216, "timers": {"training_iteration_time_ms": 102.444, "sample_time_ms": 16.534, "load_time_ms": 0.315, "load_throughput": 819795.782, "learn_time_ms": 17.642, "learn_throughput": 14623.819, "synch_weights_time_ms": 9.682}, "counters": {"num_env_steps_sampled": 2072, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 6216, "num_agent_steps_trained": 21156, "last_target_update_ts": 2072, "num_target_updates": 82}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "db258_00000", "date": "2023-11-16_21-48-16", "timestamp": 1700200096, "time_this_iter_s": 1.5357329845428467, "time_total_s": 11.918689250946045, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 11.918689250946045, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.15, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08612060546875, "actor_loss": -9.387560844421387, "critic_loss": 0.2136634886264801, "alpha_loss": -0.29009535908699036, "alpha_value": 0.9716478586196899, "log_alpha_value": -0.028761835768818855, "target_entropy": -6.0, "policy_t": -0.023607876151800156, "mean_q": 5.396676063537598, "max_q": 6.2261857986450195, "min_q": 4.455496788024902}, "td_error": [1.5664730072021484, 0.5235629081726074, 0.5340738296508789, 1.8688347339630127, 1.6883630752563477, 0.555966854095459, 0.26424646377563477, 1.0869674682617188, 0.34661245346069336, 2.316957473754883, 3.193462371826172, 1.4559547901153564, 0.9982151985168457, 0.5387110710144043, 1.6713640689849854, 0.5256457328796387, 0.4029552936553955, 0.8707036972045898, 0.16251277923583984, 2.0342342853546143, 0.5158088207244873, 0.8510079383850098, 0.9017508029937744, 0.10406136512756348, 0.4527153968811035, 1.1821439266204834, 1.6604928970336914, 0.2458040714263916, 0.2604503631591797, 2.035430669784546, 0.9813196659088135, 1.4453072547912598, 0.2217578887939453, 1.5886359214782715, 1.5258691310882568, 2.7466673851013184, 2.3343148231506348, 1.8369462490081787, 0.14400434494018555, 0.6579971313476562, 1.1484041213989258, 0.6900918483734131, 3.0800118446350098, 0.40427350997924805, 1.4930806159973145, 1.9067821502685547, 1.15187668800354, 1.0586316585540771, 1.984786033630371, 0.8770730495452881, 0.9711015224456787, 0.5783214569091797, 0.365001916885376, 0.8064086437225342, 0.6874678134918213, 1.0716829299926758, 0.7708644866943359, 0.7969541549682617, 1.1979598999023438, 0.12012195587158203, 2.0021026134490967, 1.1931333541870117, 0.625523567199707, 1.121711015701294, 1.1968715190887451, 1.2130208015441895, 0.21492362022399902, 1.112807273864746, 0.13469433784484863, 1.33305025100708, 0.16164207458496094, 1.8794305324554443, 1.345555305480957, 0.9673929214477539, 0.9908998012542725, 0.4317917823791504, 0.4840877056121826, 2.4390811920166016, 1.9767851829528809, 1.0857231616973877, 3.3317315578460693, 0.19002962112426758, 1.8963675498962402, 0.688582181930542, 0.4585721492767334, 0.9489507675170898], "mean_td_error": 1.103298306465149, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132170677185059, "actor_loss": -7.901534080505371, "critic_loss": 0.2155894786119461, "alpha_loss": -0.29184645414352417, "alpha_value": 0.971606969833374, "log_alpha_value": -0.028803937137126923, "target_entropy": -6.0, "policy_t": 0.011082307435572147, "mean_q": 3.996141195297241, "max_q": 4.5492143630981445, "min_q": 3.407557487487793}, "td_error": [1.9097161293029785, 1.079801321029663, 1.6208477020263672, 0.6326005458831787, 3.3372433185577393, 2.0645573139190674, 1.9730805158615112, 1.3858718872070312, 0.0919194221496582, 1.5848231315612793, 1.1950174570083618, 0.38410019874572754, 1.0120844841003418, 1.832305669784546, 2.9442262649536133, 1.4804853200912476, 2.0527687072753906, 0.6152483224868774, 0.5881357192993164, 0.06640064716339111, 0.6673860549926758, 1.2502617835998535, 1.5854138135910034, 1.1401104927062988, 0.9762874841690063, 1.1177846193313599, 1.748897910118103, 1.0530586242675781, 0.37910735607147217, 0.16356027126312256, 1.5334813594818115, 0.8293979167938232, 1.5702462196350098, 0.12211036682128906, 1.153449296951294, 0.7574572563171387, 0.9988961219787598, 0.47188615798950195, 1.181517243385315, 1.1062536239624023, 2.222768545150757, 0.4778153896331787, 0.6169862747192383, 1.2943964004516602, 2.617609977722168, 1.936280369758606, 0.09095001220703125, 0.7854125499725342, 2.733551025390625, 1.0152631998062134, 1.093587875366211, 0.7162368297576904, 1.1054342985153198, 0.3935185670852661, 0.4095942974090576, 0.9036769866943359, 0.12424564361572266, 0.07039904594421387, 1.0066012144088745, 1.206362009048462, 0.9651443958282471, 0.29505205154418945, 1.9422245025634766, 1.5949859619140625, 1.6473197937011719, 1.0826992988586426, 0.22091221809387207, 1.252915620803833, 1.254270076751709, 1.0385470390319824, 0.7420239448547363, 0.9573098421096802, 0.9052754640579224, 0.4708433151245117, 0.9260001182556152, 0.3721761703491211, 0.8161261081695557, 1.0850061178207397, 1.7364709377288818, 1.456040859222412, 0.10832786560058594, 1.0797230005264282, 1.2013680934906006, 2.223055839538574, 0.3690207004547119, 1.4983900785446167], "mean_td_error": 1.1130200624465942, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069751739501953, "actor_loss": -7.812996864318848, "critic_loss": 0.17126113176345825, "alpha_loss": -0.2899647057056427, "alpha_value": 0.9716150164604187, "log_alpha_value": -0.028795616701245308, "target_entropy": -6.0, "policy_t": -0.02807670086622238, "mean_q": 3.944011926651001, "max_q": 4.538612365722656, "min_q": 3.284987449645996}, "td_error": [0.6956655979156494, 0.6004290580749512, 0.7827222347259521, 0.01609349250793457, 0.43512487411499023, 1.5386626720428467, 0.8685047626495361, 0.36368846893310547, 0.7322406768798828, 0.8191254138946533, 0.6647281646728516, 0.5301721096038818, 0.15800905227661133, 0.2584819793701172, 0.539206862449646, 1.6407777070999146, 0.7652947902679443, 2.1073520183563232, 0.3184046745300293, 2.0663626194000244, 1.166008472442627, 1.5324513912200928, 0.36111128330230713, 1.7503361701965332, 0.08924627304077148, 0.5157341957092285, 1.695260763168335, 0.3001062870025635, 2.9904606342315674, 2.8605542182922363, 0.7444555759429932, 1.0993260145187378, 0.7513082027435303, 0.46089601516723633, 1.882351279258728, 0.87723708152771, 0.6945552825927734, 1.9614665508270264, 1.996583342552185, 0.3050419092178345, 0.6393349170684814, 1.501243233680725, 1.7292616367340088, 1.4191805124282837, 0.7571556568145752, 0.17157840728759766, 1.4669160842895508, 0.27136945724487305, 0.262654185295105, 0.1186525821685791, 0.8144857883453369, 1.2366011142730713, 0.31518983840942383, 1.5332878828048706, 1.1034295558929443, 1.2645678520202637, 2.0400333404541016, 1.0440045595169067, 1.6836817264556885, 0.08159530162811279, 0.8644685745239258, 0.6323235034942627, 0.03269004821777344, 1.9284309148788452, 0.31979846954345703, 0.25067150592803955, 0.6236546039581299, 1.774176836013794, 0.2250978946685791, 0.24474704265594482, 3.4240758419036865, 0.6817638874053955, 1.5529940128326416, 0.8007024526596069, 1.5049307346343994, 0.43585801124572754, 2.1624531745910645, 0.09388041496276855, 1.220348834991455, 0.5236490964889526, 1.3204606771469116, 0.5726892948150635, 1.07659912109375, 1.1943249702453613, 1.2094905376434326, 1.4117927551269531], "mean_td_error": 0.9938585758209229, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}, "num_env_steps_sampled": 2177, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 6531, "num_agent_steps_trained": 25026, "last_target_update_ts": 2177, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6531, "num_agent_steps_trained": 25026, "num_env_steps_sampled": 2177, "num_env_steps_trained": 25026, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.88255444453077, "num_env_steps_trained_throughput_per_sec": 2501.957006669848, "timesteps_total": 2177, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 6531, "timers": {"training_iteration_time_ms": 103.026, "sample_time_ms": 16.208, "load_time_ms": 0.31, "load_throughput": 831512.55, "learn_time_ms": 17.936, "learn_throughput": 14384.103, "synch_weights_time_ms": 9.996}, "counters": {"num_env_steps_sampled": 2177, "num_env_steps_trained": 25026, "num_agent_steps_sampled": 6531, "num_agent_steps_trained": 25026, "last_target_update_ts": 2177, "num_target_updates": 97}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "db258_00000", "date": "2023-11-16_21-48-18", "timestamp": 1700200098, "time_this_iter_s": 1.5557551383972168, "time_total_s": 13.474444389343262, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 13.474444389343262, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.650000000000006, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032170295715332, "actor_loss": -9.883110046386719, "critic_loss": 0.19515742361545563, "alpha_loss": -0.3335581123828888, "alpha_value": 0.9672978520393372, "log_alpha_value": -0.03324884548783302, "target_entropy": -6.0, "policy_t": -0.00905237253755331, "mean_q": 6.035760879516602, "max_q": 7.096881866455078, "min_q": 4.744348049163818}, "td_error": [1.7000012397766113, 1.7957043647766113, 3.117489814758301, 1.3189589977264404, 1.873969554901123, 1.04872465133667, 2.3576457500457764, 2.4034934043884277, 1.4018511772155762, 1.106884479522705, 0.6558151245117188, 0.4124565124511719, 1.7578365802764893, 0.8796508312225342, 1.1734647750854492, 1.071399211883545, 1.2977054119110107, 2.228869676589966, 0.012679338455200195, 2.4801928997039795, 1.319847583770752, 1.9000232219696045, 0.6450695991516113, 0.8212969303131104, 1.5687282085418701, 1.2208127975463867, 0.5255141258239746, 0.5560934543609619, 1.9354779720306396, 1.0919525623321533, 1.268322467803955, 1.4942355155944824, 2.048588991165161, 2.030402421951294, 2.3917527198791504, 1.487170696258545, 1.1617271900177002, 1.1559350490570068, 1.3851618766784668, 1.1767807006835938, 1.8157286643981934, 1.5861918926239014, 0.5906953811645508, 0.14710164070129395, 0.9102625846862793, 2.5431149005889893, 0.8732771873474121, 1.3092117309570312, 3.5094196796417236, 1.606764793395996, 0.1846306324005127, 1.9602437019348145, 1.9366796016693115, 1.5932743549346924, 0.7007861137390137, 0.4310488700866699, 0.8045220375061035, 1.895263671875, 0.3256971836090088, 0.47861576080322266, 0.5640833377838135, 2.5619308948516846, 3.3776743412017822, 0.19867753982543945, 0.43608760833740234, 1.5335540771484375, 1.5131065845489502, 1.4182095527648926, 1.119351863861084, 0.5814528465270996, 2.3598437309265137, 0.3312537670135498, 1.936067819595337, 1.901007890701294, 0.9699468612670898, 0.15001273155212402, 0.3866868019104004, 0.8830132484436035, 1.2161633968353271, 1.3893675804138184, 1.4616491794586182, 1.0220375061035156, 0.31363797187805176, 1.1654574871063232, 0.7775342464447021, 1.383545160293579], "mean_td_error": 1.3189949989318848, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111760139465332, "actor_loss": -7.71291971206665, "critic_loss": 0.16801026463508606, "alpha_loss": -0.3367713987827301, "alpha_value": 0.9672436118125916, "log_alpha_value": -0.03330491855740547, "target_entropy": -6.0, "policy_t": -0.004542957525700331, "mean_q": 3.7611141204833984, "max_q": 4.289569854736328, "min_q": 3.2172319889068604}, "td_error": [0.05595982074737549, 1.139225721359253, 0.7307652235031128, 2.3700828552246094, 1.5164837837219238, 1.5191447734832764, 0.5778881311416626, 2.2416329383850098, 1.324245810508728, 0.6240957975387573, 0.20242834091186523, 0.033547401428222656, 1.9884207248687744, 0.745234489440918, 0.9923921823501587, 1.5835165977478027, 1.9668855667114258, 1.2848756313323975, 0.9512733221054077, 0.6964927911758423, 0.44129157066345215, 0.9015905857086182, 0.6267555952072144, 0.09399712085723877, 0.6820893287658691, 2.351834297180176, 0.4283970594406128, 0.9571154117584229, 0.31100142002105713, 0.551593542098999, 0.5723340511322021, 0.2305445671081543, 1.0996205806732178, 0.22874116897583008, 1.4327017068862915, 2.2643165588378906, 0.0345073938369751, 2.0722951889038086, 0.46122753620147705, 0.6903682947158813, 0.12100613117218018, 1.871626615524292, 1.0362777709960938, 1.0505410432815552, 0.5263700485229492, 0.11419808864593506, 1.1940281391143799, 0.3864126205444336, 0.12783050537109375, 0.30663061141967773, 0.715203046798706, 0.9367927312850952, 1.1003806591033936, 1.0528404712677002, 0.05186128616333008, 0.5706263780593872, 0.8143776655197144, 0.27109503746032715, 0.9177480936050415, 0.4212857484817505, 0.058997273445129395, 0.8668662309646606, 0.7234117984771729, 2.116960287094116, 0.37729787826538086, 0.14820730686187744, 1.4260048866271973, 0.11919260025024414, 0.6059122085571289, 0.7697325944900513, 0.8261557817459106, 0.16153943538665771, 1.5242948532104492, 0.4722719192504883, 3.079575300216675, 0.41911208629608154, 1.8173372745513916, 0.04681229591369629, 1.2102802991867065, 2.0328845977783203, 0.8203014135360718, 2.6767947673797607, 1.4941695928573608, 1.631547212600708, 0.4068019390106201, 1.1742430925369263], "mean_td_error": 0.9252413511276245, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055044174194336, "actor_loss": -7.70510721206665, "critic_loss": 0.21959733963012695, "alpha_loss": -0.3347510099411011, "alpha_value": 0.9672562479972839, "log_alpha_value": -0.03329185023903847, "target_entropy": -6.0, "policy_t": 0.032930951565504074, "mean_q": 3.8621346950531006, "max_q": 4.4536356925964355, "min_q": 3.403153419494629}, "td_error": [2.3879830837249756, 0.6582553386688232, 2.086233139038086, 0.3942002058029175, 2.2862014770507812, 1.7921900749206543, 1.3043673038482666, 0.6943504810333252, 1.6385986804962158, 3.848323345184326, 0.93662428855896, 0.8222827911376953, 0.7872389554977417, 0.780437707901001, 0.5299010276794434, 0.9791128635406494, 0.3569493293762207, 2.3124804496765137, 2.154202461242676, 1.8875118494033813, 1.8372423648834229, 0.3075449466705322, 0.554375171661377, 2.157935619354248, 0.7624086141586304, 0.9301912784576416, 1.8306019306182861, 0.4420149326324463, 0.7608647346496582, 1.800075888633728, 1.2112514972686768, 0.37943458557128906, 2.2151901721954346, 0.2434384822845459, 1.8145263195037842, 1.4318898916244507, 0.6222043037414551, 0.4903125762939453, 2.0580849647521973, 1.9561505317687988, 0.02407848834991455, 0.38922858238220215, 0.36835527420043945, 1.0274772644042969, 1.2903003692626953, 0.6815812587738037, 0.9401473999023438, 1.2305070161819458, 1.3426417112350464, 1.5571608543395996, 0.848962664604187, 1.8196690082550049, 0.6790471076965332, 0.9551303386688232, 0.2776792049407959, 3.2113778591156006, 0.4039040803909302, 0.057872653007507324, 2.1034350395202637, 2.705684185028076, 0.7009351253509521, 0.9054393768310547, 0.6286795139312744, 0.5017025470733643, 1.1334123611450195, 1.2577203512191772, 0.18840742111206055, 3.0426697731018066, 0.8150538206100464, 0.6038209199905396, 3.2264528274536133, 0.09630227088928223, 2.2272300720214844, 0.5156004428863525, 0.021742820739746094, 0.6000968217849731, 1.9189000129699707, 1.0344750881195068, 1.1640297174453735, 1.4043829441070557, 1.7433686256408691, 0.6095700263977051, 3.283914089202881, 0.9215469360351562, 0.4824415445327759, 0.9207727909088135], "mean_td_error": 1.2128615379333496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 112.0, "diff_num_grad_updates_vs_sampler_policy": 111.0}}, "num_env_steps_sampled": 2282, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 6846, "num_agent_steps_trained": 28896, "last_target_update_ts": 2282, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6846, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 2282, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.94921626129174, "num_env_steps_trained_throughput_per_sec": 2467.556827916181, "timesteps_total": 2282, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 6846, "timers": {"training_iteration_time_ms": 104.345, "sample_time_ms": 16.763, "load_time_ms": 0.309, "load_throughput": 833819.103, "learn_time_ms": 18.437, "learn_throughput": 13993.669, "synch_weights_time_ms": 10.726}, "counters": {"num_env_steps_sampled": 2282, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 6846, "num_agent_steps_trained": 28896, "last_target_update_ts": 2282, "num_target_updates": 112}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "db258_00000", "date": "2023-11-16_21-48-20", "timestamp": 1700200100, "time_this_iter_s": 1.5773780345916748, "time_total_s": 15.051822423934937, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 15.051822423934937, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.95, "ram_util_percent": 61.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.992425918579102, "actor_loss": -9.807491302490234, "critic_loss": 0.1428767293691635, "alpha_loss": -0.37711867690086365, "alpha_value": 0.9629628658294678, "log_alpha_value": -0.037740446627140045, "target_entropy": -6.0, "policy_t": 0.027701281011104584, "mean_q": 5.964889049530029, "max_q": 6.778728485107422, "min_q": 5.238872051239014}, "td_error": [1.5960121154785156, 0.37345433235168457, 0.9314000606536865, 0.731494665145874, 1.0763938426971436, 2.543250560760498, 0.934816837310791, 0.04172205924987793, 0.5846242904663086, 1.920799970626831, 0.13292169570922852, 0.4071354866027832, 0.9300568103790283, 0.32597804069519043, 0.6803936958312988, 0.2801992893218994, 1.6978013515472412, 0.8148283958435059, 1.9053535461425781, 0.7928061485290527, 3.0784342288970947, 0.7296679019927979, 0.19711613655090332, 1.0310864448547363, 0.6387925148010254, 0.8621525764465332, 0.9787709712982178, 2.6047394275665283, 0.15004825592041016, 1.3754007816314697, 1.688148021697998, 0.3898346424102783, 0.9172399044036865, 2.3483328819274902, 1.1872684955596924, 1.5508942604064941, 1.221472978591919, 1.3179903030395508, 0.18724989891052246, 0.5246987342834473, 0.4141199588775635, 1.4833555221557617, 1.1950299739837646, 1.4370064735412598, 0.15523958206176758, 0.8174200057983398, 0.3898437023162842, 0.1963801383972168, 1.0209314823150635, 1.0030558109283447, 1.9978914260864258, 0.7139558792114258, 1.4842042922973633, 0.021928787231445312, 0.7202591896057129, 0.17102789878845215, 0.4630279541015625, 0.28696417808532715, 1.6221168041229248, 0.8150219917297363, 0.5388021469116211, 0.19762706756591797, 1.9884183406829834, 0.03334379196166992, 0.30928802490234375, 1.3007991313934326, 0.4310123920440674, 0.9150097370147705, 1.93513822555542, 0.3662385940551758, 1.1782989501953125, 2.7611594200134277, 1.0925185680389404, 0.4748563766479492, 1.343240737915039, 1.964379072189331, 0.5442585945129395, 0.998464822769165, 0.08071565628051758, 0.9263172149658203, 1.6445872783660889, 0.7007958889007568, 0.45918917655944824, 1.730471134185791, 1.278585433959961, 1.949434518814087], "mean_td_error": 0.9910757541656494, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087630271911621, "actor_loss": -7.6560492515563965, "critic_loss": 0.20568513870239258, "alpha_loss": -0.38134196400642395, "alpha_value": 0.9629026651382446, "log_alpha_value": -0.03780292719602585, "target_entropy": -6.0, "policy_t": 0.06886857748031616, "mean_q": 3.7617897987365723, "max_q": 4.613476753234863, "min_q": 3.2400431632995605}, "td_error": [2.0188798904418945, 1.0632014274597168, 1.5391361713409424, 1.7874906063079834, 0.9049587249755859, 2.1871607303619385, 0.11557316780090332, 0.5960230827331543, 1.6286509037017822, 0.06751847267150879, 0.7000670433044434, 1.7057833671569824, 2.055291175842285, 0.029768824577331543, 0.16925442218780518, 1.3761001825332642, 2.12715482711792, 1.3730077743530273, 0.5375354290008545, 0.19796645641326904, 1.3917944431304932, 1.7674615383148193, 0.6447354555130005, 0.9314358234405518, 2.8858304023742676, 0.7663469314575195, 0.4949824810028076, 0.06732726097106934, 1.737220048904419, 0.961939811706543, 2.701622247695923, 1.8837897777557373, 2.7569010257720947, 1.0553126335144043, 0.335721492767334, 1.5953067541122437, 2.4578607082366943, 0.2894735336303711, 1.3531994819641113, 0.11760079860687256, 0.06846404075622559, 2.049880027770996, 1.4647235870361328, 0.37765026092529297, 0.45696401596069336, 1.7897855043411255, 0.30382001399993896, 0.6940983533859253, 0.9012056589126587, 0.6207935810089111, 0.0871196985244751, 1.4286470413208008, 1.3114347457885742, 2.0884432792663574, 2.115687847137451, 0.8291780948638916, 0.7524799108505249, 0.7168465852737427, 0.700690507888794, 1.0124468803405762, 2.7429449558258057, 1.4724498987197876, 2.014087200164795, 0.4871741533279419, 0.6781295537948608, 1.4543306827545166, 0.7954064607620239, 1.7676854133605957, 0.5895649194717407, 1.2041716575622559, 2.282768726348877, 0.7306010723114014, 1.9277279376983643, 1.240845799446106, 0.48273301124572754, 1.085046410560608, 0.6391098499298096, 0.43346667289733887, 0.7134246826171875, 1.1279993057250977, 0.8192822933197021, 0.7805715799331665, 0.3066791296005249, 1.3600332736968994, 0.21881675720214844, 0.3910740613937378], "mean_td_error": 1.1150333881378174, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115743637084961, "actor_loss": -7.71235990524292, "critic_loss": 0.17094063758850098, "alpha_loss": -0.38229912519454956, "alpha_value": 0.9629127383232117, "log_alpha_value": -0.03779248520731926, "target_entropy": -6.0, "policy_t": 0.00212330324575305, "mean_q": 3.808303117752075, "max_q": 4.306220531463623, "min_q": 3.2917776107788086}, "td_error": [0.5962984561920166, 0.6180611848831177, 0.7647745609283447, 0.8056399822235107, 0.40206456184387207, 1.7843854427337646, 1.084228277206421, 2.6692259311676025, 2.0568199157714844, 1.3033640384674072, 1.3812947273254395, 1.127305030822754, 0.6267541646957397, 0.5920195579528809, 2.459853410720825, 0.926480770111084, 2.2540435791015625, 1.398949384689331, 1.497884750366211, 1.1053681373596191, 0.3599541187286377, 2.818424940109253, 1.2109631299972534, 1.249293327331543, 1.7609113454818726, 1.1409580707550049, 0.8044509887695312, 0.34254908561706543, 0.12045919895172119, 0.7930855751037598, 1.3680216073989868, 0.6229259967803955, 0.6179530620574951, 0.7900434732437134, 1.9675358533859253, 0.9154309034347534, 1.3133677244186401, 0.992774248123169, 0.8502250909805298, 0.19858872890472412, 0.9173457622528076, 0.794474720954895, 0.4568290710449219, 1.9155495166778564, 0.9081261157989502, 2.022890329360962, 0.14037644863128662, 2.0273680686950684, 2.1723289489746094, 1.7163939476013184, 0.6349546909332275, 0.2642143964767456, 2.1117968559265137, 1.163958191871643, 0.06628251075744629, 1.1805393695831299, 0.4373946189880371, 0.6734757423400879, 0.5225635766983032, 0.4469975233078003, 0.47744059562683105, 1.1426448822021484, 0.10376334190368652, 0.8895025253295898, 0.6641852855682373, 0.9565736055374146, 0.46435797214508057, 1.62100088596344, 1.0809495449066162, 1.4028913974761963, 0.1939547061920166, 0.552133321762085, 1.199143886566162, 0.5757648944854736, 0.9550685882568359, 0.09512221813201904, 0.9510600566864014, 0.2607448101043701, 0.759574294090271, 2.2816925048828125, 1.0094083547592163, 1.0291152000427246, 0.03879570960998535, 0.5916260480880737, 0.6048182249069214, 1.1030406951904297], "mean_td_error": 1.0147786140441895, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}}, "num_env_steps_sampled": 2387, "num_env_steps_trained": 32766, "num_agent_steps_sampled": 7161, "num_agent_steps_trained": 32766, "last_target_update_ts": 2387, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7161, "num_agent_steps_trained": 32766, "num_env_steps_sampled": 2387, "num_env_steps_trained": 32766, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.61951811670471, "num_env_steps_trained_throughput_per_sec": 2529.119382015688, "timesteps_total": 2387, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 7161, "timers": {"training_iteration_time_ms": 101.712, "sample_time_ms": 15.044, "load_time_ms": 0.309, "load_throughput": 834269.086, "learn_time_ms": 17.953, "learn_throughput": 14370.655, "synch_weights_time_ms": 10.346}, "counters": {"num_env_steps_sampled": 2387, "num_env_steps_trained": 32766, "num_agent_steps_sampled": 7161, "num_agent_steps_trained": 32766, "last_target_update_ts": 2387, "num_target_updates": 127}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "db258_00000", "date": "2023-11-16_21-48-21", "timestamp": 1700200101, "time_this_iter_s": 1.5378360748291016, "time_total_s": 16.589658498764038, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6340>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 16.589658498764038, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 33.666666666666664, "ram_util_percent": 61.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.04248046875, "actor_loss": -9.774656295776367, "critic_loss": 0.15189793705940247, "alpha_loss": -0.4240906834602356, "alpha_value": 0.9586495757102966, "log_alpha_value": -0.04222967103123665, "target_entropy": -6.0, "policy_t": -0.010700404644012451, "mean_q": 6.023286819458008, "max_q": 6.7173542976379395, "min_q": 5.100855827331543}, "td_error": [0.2929084300994873, 0.764188289642334, 0.5327761173248291, 0.7211594581604004, 1.03487229347229, 1.1856040954589844, 1.8574094772338867, 0.6014094352722168, 0.08609461784362793, 0.10524272918701172, 0.3755786418914795, 0.5424814224243164, 1.8516497611999512, 0.2888827323913574, 2.29343581199646, 0.9797232151031494, 1.1457710266113281, 1.3275625705718994, 0.07719540596008301, 1.0862784385681152, 2.0539093017578125, 1.1929397583007812, 1.9190943241119385, 0.7323353290557861, 1.0467143058776855, 0.41420531272888184, 0.7487936019897461, 1.7329087257385254, 0.6626348495483398, 1.0454587936401367, 1.1605329513549805, 1.6440000534057617, 0.6661098003387451, 1.5302844047546387, 0.37921977043151855, 0.9365601539611816, 1.745471477508545, 0.8327305316925049, 1.8924903869628906, 1.6280062198638916, 2.760835647583008, 1.4175302982330322, 0.08447885513305664, 1.7479054927825928, 0.9305081367492676, 1.4569275379180908, 0.12203717231750488, 0.23841333389282227, 1.0944149494171143, 2.101677894592285, 0.1209707260131836, 0.6965112686157227, 0.35602545738220215, 0.3846282958984375, 1.3637051582336426, 1.4557600021362305, 1.3711824417114258, 0.7884039878845215, 2.3157424926757812, 2.2934741973876953, 1.4205946922302246, 0.2295217514038086, 3.262207269668579, 0.07222843170166016, 0.5152561664581299, 0.44113659858703613, 0.05935335159301758, 0.456500768661499, 1.95289945602417, 0.14815139770507812, 0.6822710037231445, 2.7606277465820312, 0.5853991508483887, 1.2211885452270508, 1.918166160583496, 0.14420485496520996, 0.03361797332763672, 1.8316502571105957, 0.25261712074279785, 0.4962191581726074, 1.127168893814087, 2.0473427772521973, 2.6893811225891113, 1.6678152084350586, 0.30496764183044434, 0.4070568084716797], "mean_td_error": 1.0574802160263062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 142.0, "diff_num_grad_updates_vs_sampler_policy": 141.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11793041229248, "actor_loss": -7.9056878089904785, "critic_loss": 0.156082883477211, "alpha_loss": -0.4280267655849457, "alpha_value": 0.9585785269737244, "log_alpha_value": -0.04230378195643425, "target_entropy": -6.0, "policy_t": 0.04069113731384277, "mean_q": 4.02799654006958, "max_q": 4.664425849914551, "min_q": 3.468120813369751}, "td_error": [0.26208019256591797, 1.2879629135131836, 0.20474767684936523, 0.6561696529388428, 1.7174782752990723, 0.6239264011383057, 1.2659423351287842, 0.2796630859375, 1.5431716442108154, 0.4397413730621338, 0.317293643951416, 0.5502638816833496, 1.102939248085022, 1.7219936847686768, 1.5475541353225708, 1.1691310405731201, 0.8608732223510742, 2.4840545654296875, 1.016228199005127, 1.8628957271575928, 2.195716381072998, 0.9380543231964111, 0.809701681137085, 0.9204380512237549, 1.2125434875488281, 0.9278041124343872, 0.4425685405731201, 1.0662341117858887, 1.3635759353637695, 0.03491067886352539, 0.22870361804962158, 1.4465651512145996, 0.28980815410614014, 0.6543409824371338, 0.25563907623291016, 1.8903796672821045, 1.5619951486587524, 1.7435888051986694, 0.091866135597229, 0.7863597869873047, 1.6588599681854248, 1.847339391708374, 0.04810905456542969, 1.0663199424743652, 1.7732689380645752, 1.4716949462890625, 2.040043354034424, 1.6503623723983765, 0.07607269287109375, 1.6637811660766602, 1.0774891376495361, 0.4345879554748535, 1.6541848182678223, 1.857820987701416, 0.6454565525054932, 1.0998821258544922, 0.8354144096374512, 0.15966033935546875, 0.7997788190841675, 1.7229995727539062, 1.148073434829712, 0.05979013442993164, 2.0907952785491943, 0.7198197841644287, 0.8032994270324707, 0.5389463901519775, 0.9184278249740601, 1.780998945236206, 0.4397449493408203, 1.8053561449050903, 0.22414922714233398, 0.7558085918426514, 1.4101924896240234, 1.2392597198486328, 1.4318046569824219, 0.5490338802337646, 2.5170798301696777, 1.7815353870391846, 1.5327345132827759, 1.0991630554199219, 0.5411787033081055, 0.4459705352783203, 1.1775518655776978, 0.9945721626281738, 1.8709644079208374, 0.7419320344924927], "mean_td_error": 1.0694907903671265, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 142.0, "diff_num_grad_updates_vs_sampler_policy": 141.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074150085449219, "actor_loss": -7.77040433883667, "critic_loss": 0.18162308633327484, "alpha_loss": -0.4260539710521698, "alpha_value": 0.958590030670166, "log_alpha_value": -0.042291801422834396, "target_entropy": -6.0, "policy_t": -0.014096418395638466, "mean_q": 3.9572701454162598, "max_q": 4.374237060546875, "min_q": 3.269103527069092}, "td_error": [0.4970283508300781, 0.8807517290115356, 1.206463098526001, 0.7063291072845459, 0.7036045789718628, 0.4829447269439697, 0.7102071046829224, 3.013824224472046, 1.1185998916625977, 0.7322869300842285, 1.8953497409820557, 0.824425458908081, 1.545301914215088, 0.83359694480896, 1.377659559249878, 3.630772113800049, 0.9786522388458252, 2.382628917694092, 0.1145857572555542, 1.6734870672225952, 0.8384854793548584, 0.1410684585571289, 0.5701202154159546, 1.060295581817627, 0.4738050699234009, 0.2443603277206421, 1.7156178951263428, 1.6439363956451416, 0.8246090412139893, 1.0641748905181885, 0.15752661228179932, 0.06187248229980469, 1.6042133569717407, 2.299619674682617, 2.77388858795166, 1.390608787536621, 0.12136960029602051, 0.4116482734680176, 1.3445234298706055, 0.8443405628204346, 3.0538711547851562, 0.8551729917526245, 0.9586167335510254, 0.682969331741333, 0.9069852828979492, 0.7270071506500244, 1.7214319705963135, 0.7905114889144897, 0.013970375061035156, 1.4709250926971436, 0.11490249633789062, 2.062497615814209, 0.5361752510070801, 1.3476343154907227, 1.671203374862671, 0.8972570896148682, 0.08203816413879395, 2.0137906074523926, 1.0710127353668213, 1.018444538116455, 1.2858150005340576, 0.43463802337646484, 0.3801037073135376, 1.0211029052734375, 0.2525935173034668, 0.6076233386993408, 0.9519469738006592, 0.7608311176300049, 0.9075112342834473, 1.2839782238006592, 2.2132365703582764, 0.2968791723251343, 0.8243900537490845, 1.6817121505737305, 0.5046734809875488, 1.895582675933838, 1.4837453365325928, 1.1212797164916992, 1.2084784507751465, 0.11574482917785645, 0.29949259757995605, 0.06675004959106445, 0.7418551445007324, 1.4154236316680908, 0.43851780891418457, 0.05857288837432861], "mean_td_error": 1.03655207157135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 142.0, "diff_num_grad_updates_vs_sampler_policy": 141.0}}, "num_env_steps_sampled": 2492, "num_env_steps_trained": 36636, "num_agent_steps_sampled": 7476, "num_agent_steps_trained": 36636, "last_target_update_ts": 2492, "num_target_updates": 142}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7476, "num_agent_steps_trained": 36636, "num_env_steps_sampled": 2492, "num_env_steps_trained": 36636, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.41393606307476, "num_env_steps_trained_throughput_per_sec": 2521.5422148961843, "timesteps_total": 2492, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 7476, "timers": {"training_iteration_time_ms": 103.066, "sample_time_ms": 15.737, "load_time_ms": 0.317, "load_throughput": 814550.57, "learn_time_ms": 18.14, "learn_throughput": 14222.539, "synch_weights_time_ms": 10.052}, "counters": {"num_env_steps_sampled": 2492, "num_env_steps_trained": 36636, "num_agent_steps_sampled": 7476, "num_agent_steps_trained": 36636, "last_target_update_ts": 2492, "num_target_updates": 142}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "db258_00000", "date": "2023-11-16_21-48-23", "timestamp": 1700200103, "time_this_iter_s": 1.5445208549499512, "time_total_s": 18.13417935371399, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 18.13417935371399, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.65, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.010851860046387, "actor_loss": -9.882365226745605, "critic_loss": 0.18567955493927002, "alpha_loss": -0.46769315004348755, "alpha_value": 0.9543558955192566, "log_alpha_value": -0.046718619763851166, "target_entropy": -6.0, "policy_t": -0.018735503777861595, "mean_q": 6.129462718963623, "max_q": 6.914052963256836, "min_q": 4.9307451248168945}, "td_error": [1.806936502456665, 0.9757933616638184, 2.3165831565856934, 0.5496857166290283, 0.9010331630706787, 2.1961758136749268, 2.5471279621124268, 0.6578841209411621, 2.064530611038208, 0.5490353107452393, 0.8026747703552246, 1.35316801071167, 3.5277414321899414, 1.1557989120483398, 2.246964693069458, 2.805814743041992, 0.1952972412109375, 1.9805243015289307, 1.525841236114502, 0.9141807556152344, 1.266408920288086, 2.2827842235565186, 0.30816197395324707, 2.4275312423706055, 0.44562339782714844, 0.6908862590789795, 1.6830108165740967, 0.4858682155609131, 0.6555261611938477, 0.5724821090698242, 1.4663712978363037, 2.0830068588256836, 1.3019628524780273, 1.5391511917114258, 0.18996524810791016, 0.9665887355804443, 2.4831483364105225, 0.1347975730895996, 1.5829520225524902, 1.2656080722808838, 0.12091565132141113, 0.6783266067504883, 0.035243988037109375, 1.084233283996582, 0.9067425727844238, 1.5170316696166992, 0.9034075736999512, 1.1007037162780762, 1.826768398284912, 0.23797893524169922, 1.8156757354736328, 2.2855067253112793, 2.48517107963562, 0.6372270584106445, 1.6495649814605713, 1.396378993988037, 0.7079510688781738, 0.03358936309814453, 2.6657803058624268, 1.0308897495269775, 0.11060953140258789, 1.4808859825134277, 1.376096248626709, 1.6879491806030273, 0.7408661842346191, 0.9629135131835938, 1.7292826175689697, 0.2552485466003418, 1.824347972869873, 1.4452524185180664, 1.6011910438537598, 1.0902442932128906, 2.296903610229492, 0.9850616455078125, 0.7947149276733398, 0.5056931972503662, 1.0166561603546143, 1.9150524139404297, 2.3976471424102783, 1.1295976638793945, 0.9545688629150391, 1.3646519184112549, 1.5948541164398193, 0.1917119026184082, 0.9496560096740723, 0.23842811584472656], "mean_td_error": 1.2635324001312256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 156.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02407169342041, "actor_loss": -7.819054126739502, "critic_loss": 0.15339696407318115, "alpha_loss": -0.4691753089427948, "alpha_value": 0.9542735815048218, "log_alpha_value": -0.04680486395955086, "target_entropy": -6.0, "policy_t": -0.011712531559169292, "mean_q": 4.007083415985107, "max_q": 4.894071578979492, "min_q": 3.603792190551758}, "td_error": [1.3264210224151611, 1.5198838710784912, 1.0269386768341064, 0.8537881374359131, 2.186788320541382, 1.110241413116455, 0.6618235111236572, 2.106048345565796, 0.39505839347839355, 0.29700660705566406, 1.734053134918213, 0.09288525581359863, 0.2571449279785156, 1.501301884651184, 1.5685796737670898, 0.6184386014938354, 1.2201104164123535, 1.2388842105865479, 0.20020568370819092, 1.1997358798980713, 1.783752679824829, 1.0948141813278198, 1.551307201385498, 0.6692728996276855, 0.32320427894592285, 0.8263323307037354, 1.9843461513519287, 0.3495931625366211, 0.7239570617675781, 1.0079731941223145, 1.1737834215164185, 0.7343295812606812, 0.5136493444442749, 1.2479431629180908, 1.6544064283370972, 0.867068886756897, 1.0466959476470947, 0.5105276107788086, 0.3195815086364746, 2.6797406673431396, 1.6459306478500366, 0.903458833694458, 0.43471860885620117, 0.632936954498291, 2.525128126144409, 0.592759370803833, 0.7470779418945312, 0.6523182392120361, 0.17795681953430176, 1.9080504179000854, 0.6248103380203247, 0.9700188636779785, 0.2560708522796631, 1.2530667781829834, 0.5831941366195679, 1.8360774517059326, 1.0983519554138184, 0.1586775779724121, 0.061182260513305664, 1.9138039350509644, 1.1045422554016113, 0.7616212368011475, 1.2010717391967773, 0.8642711639404297, 1.369179129600525, 1.7293872833251953, 1.757049560546875, 1.4773261547088623, 0.9786667823791504, 1.3936614990234375, 1.2999627590179443, 0.5293776988983154, 1.0091700553894043, 0.28488290309906006, 0.5539697408676147, 2.1929173469543457, 0.9217789173126221, 0.9650881290435791, 1.1303340196609497, 0.12310361862182617, 1.16812264919281, 1.8545546531677246, 1.2763841152191162, 1.2888832092285156, 0.14942455291748047, 0.7905393838882446], "mean_td_error": 1.0387033224105835, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 156.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063716888427734, "actor_loss": -7.744200229644775, "critic_loss": 0.19284680485725403, "alpha_loss": -0.47091275453567505, "alpha_value": 0.9542847871780396, "log_alpha_value": -0.046793125569820404, "target_entropy": -6.0, "policy_t": -0.009936511516571045, "mean_q": 3.914496421813965, "max_q": 4.425714492797852, "min_q": 3.3835134506225586}, "td_error": [0.33814775943756104, 0.13100266456604004, 0.189642071723938, 1.5881750583648682, 0.1344054937362671, 1.444936990737915, 0.7035903930664062, 1.2816014289855957, 1.2135335206985474, 1.4295644760131836, 0.5876543521881104, 1.1328520774841309, 0.5308289527893066, 0.34314441680908203, 1.604543685913086, 1.979705572128296, 0.5005556344985962, 1.7555619478225708, 0.43777143955230713, 0.6103031635284424, 1.7400846481323242, 1.9331920146942139, 0.10025286674499512, 1.1511563062667847, 1.8945951461791992, 1.24886155128479, 2.062190294265747, 0.46885907649993896, 0.10291838645935059, 0.40315723419189453, 0.06287336349487305, 0.6946046352386475, 0.8999596834182739, 1.2864899635314941, 1.5859999656677246, 0.7799263000488281, 1.6778247356414795, 1.2327213287353516, 0.7875828742980957, 0.007936358451843262, 1.8694627285003662, 1.2449802160263062, 0.764826774597168, 1.1985228061676025, 2.0340352058410645, 0.7423373460769653, 2.579848051071167, 1.5676519870758057, 1.6038644313812256, 1.1933480501174927, 1.4518089294433594, 0.014307379722595215, 0.267181396484375, 0.8811919689178467, 0.8949241638183594, 0.7244462966918945, 1.6485135555267334, 0.9510254859924316, 0.0758969783782959, 2.186997890472412, 3.0206174850463867, 1.7287241220474243, 2.0926339626312256, 1.005802035331726, 1.5144970417022705, 0.5988800525665283, 2.5076019763946533, 1.5759369134902954, 0.06281161308288574, 1.8336743116378784, 1.642824411392212, 0.9616658687591553, 0.8603663444519043, 1.1353787183761597, 0.8182423114776611, 0.5678284168243408, 1.5739949941635132, 1.2402782440185547, 0.5133839845657349, 0.5277969837188721, 0.8333960771560669, 0.999808669090271, 1.8243215084075928, 0.7148212194442749, 1.271852731704712, 0.32716071605682373], "mean_td_error": 1.0896300077438354, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 156.0}}, "num_env_steps_sampled": 2597, "num_env_steps_trained": 40506, "num_agent_steps_sampled": 7791, "num_agent_steps_trained": 40506, "last_target_update_ts": 2597, "num_target_updates": 157}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7791, "num_agent_steps_trained": 40506, "num_env_steps_sampled": 2597, "num_env_steps_trained": 40506, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.54510992539448, "num_env_steps_trained_throughput_per_sec": 2526.376908678825, "timesteps_total": 2597, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 7791, "timers": {"training_iteration_time_ms": 102.604, "sample_time_ms": 15.371, "load_time_ms": 0.307, "load_throughput": 841731.823, "learn_time_ms": 17.956, "learn_throughput": 14368.556, "synch_weights_time_ms": 10.788}, "counters": {"num_env_steps_sampled": 2597, "num_env_steps_trained": 40506, "num_agent_steps_sampled": 7791, "num_agent_steps_trained": 40506, "last_target_update_ts": 2597, "num_target_updates": 157}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "db258_00000", "date": "2023-11-16_21-48-24", "timestamp": 1700200104, "time_this_iter_s": 1.5406720638275146, "time_total_s": 19.674851417541504, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 19.674851417541504, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.700000000000003, "ram_util_percent": 61.349999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078591346740723, "actor_loss": -10.268841743469238, "critic_loss": 0.18328139185905457, "alpha_loss": -0.5161234140396118, "alpha_value": 0.9500792622566223, "log_alpha_value": -0.05120987817645073, "target_entropy": -6.0, "policy_t": 0.008930138312280178, "mean_q": 6.388024806976318, "max_q": 7.3279900550842285, "min_q": 5.433419704437256}, "td_error": [2.7676806449890137, 2.3915035724639893, 1.7528951168060303, 1.0756447315216064, 1.2555136680603027, 0.8989338874816895, 0.5260920524597168, 0.44635009765625, 0.2807776927947998, 2.367838144302368, 0.42321085929870605, 0.13665556907653809, 1.5129802227020264, 1.0412497520446777, 1.1661829948425293, 1.521461009979248, 1.97994065284729, 0.9220783710479736, 0.5201549530029297, 0.5478010177612305, 2.1563520431518555, 2.915705680847168, 1.469487190246582, 0.914376974105835, 0.7414934635162354, 1.1365737915039062, 1.4156572818756104, 1.0523536205291748, 0.730637788772583, 2.191159725189209, 2.068415880203247, 1.021352767944336, 1.114212989807129, 0.8509767055511475, 0.7710976600646973, 1.0651299953460693, 2.494791269302368, 1.2362825870513916, 0.3820672035217285, 0.3239140510559082, 2.443647861480713, 3.6696054935455322, 0.6227738857269287, 0.16525793075561523, 0.1436939239501953, 2.2551820278167725, 1.3852803707122803, 0.66013503074646, 0.1474456787109375, 0.3052377700805664, 1.6858201026916504, 0.22691631317138672, 1.0186536312103271, 0.9618358612060547, 2.9591329097747803, 3.5352771282196045, 0.3653910160064697, 1.7929282188415527, 0.7335267066955566, 0.8955788612365723, 2.6514017581939697, 0.2954421043395996, 0.8417181968688965, 0.691826581954956, 1.037794589996338, 1.9436414241790771, 1.6206977367401123, 0.8330814838409424, 1.5342936515808105, 1.8030734062194824, 2.47452974319458, 0.31520915031433105, 0.16774630546569824, 2.115483522415161, 0.648648738861084, 1.9218716621398926, 0.5009136199951172, 2.014765977859497, 0.41623973846435547, 1.2490253448486328, 1.7174415588378906, 1.5839207172393799, 0.5370068550109863, 1.1852052211761475, 0.9588723182678223, 1.1206414699554443], "mean_td_error": 1.2527999877929688, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 172.0, "diff_num_grad_updates_vs_sampler_policy": 171.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06577205657959, "actor_loss": -7.866526126861572, "critic_loss": 0.15533697605133057, "alpha_loss": -0.516391396522522, "alpha_value": 0.9499920010566711, "log_alpha_value": -0.05130171775817871, "target_entropy": -6.0, "policy_t": -0.05399991571903229, "mean_q": 4.048466682434082, "max_q": 4.586937427520752, "min_q": 3.5480709075927734}, "td_error": [0.9228136539459229, 1.8972094058990479, 2.080984115600586, 0.46535611152648926, 2.1218698024749756, 1.080596685409546, 0.2108747959136963, 0.9533989429473877, 1.5140653848648071, 1.0909898281097412, 1.5550706386566162, 0.685033917427063, 0.05393624305725098, 0.8194665908813477, 1.6743429899215698, 0.09671688079833984, 0.8254432678222656, 1.9006774425506592, 2.118831157684326, 0.399600625038147, 1.2501330375671387, 0.9208040237426758, 1.3715088367462158, 0.7161576747894287, 2.0524392127990723, 0.2967042922973633, 0.9640226364135742, 0.9796044826507568, 0.43434810638427734, 0.811232328414917, 1.316756248474121, 1.893747329711914, 1.0637136697769165, 0.16565358638763428, 0.8721718788146973, 0.563643217086792, 0.3130507469177246, 0.8888375759124756, 0.2842600345611572, 1.1749811172485352, 0.8924733400344849, 0.8876149654388428, 1.4304068088531494, 0.5630683898925781, 0.20888996124267578, 2.499206066131592, 0.9259610176086426, 0.35027945041656494, 0.7125370502471924, 1.082733392715454, 0.2930312156677246, 2.1074600219726562, 0.48103976249694824, 0.3522348403930664, 1.3992466926574707, 0.5705211162567139, 0.2897961139678955, 1.0961756706237793, 0.24339056015014648, 2.0184671878814697, 1.29331374168396, 0.19513964653015137, 2.638169288635254, 0.7310984134674072, 0.8856518268585205, 0.09497857093811035, 2.4102320671081543, 1.656684160232544, 0.5498552322387695, 0.9995355606079102, 1.5311800241470337, 0.9869046211242676, 1.1701991558074951, 0.6518778800964355, 1.6360111236572266, 0.42485153675079346, 2.809791088104248, 1.3437860012054443, 1.0559766292572021, 0.03422379493713379, 0.6068603992462158, 1.7780072689056396, 1.2297520637512207, 1.6107869148254395, 0.6797471046447754, 0.19261693954467773], "mean_td_error": 1.0279396772384644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 172.0, "diff_num_grad_updates_vs_sampler_policy": 171.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057657241821289, "actor_loss": -7.904499053955078, "critic_loss": 0.17952629923820496, "alpha_loss": -0.5159091949462891, "alpha_value": 0.9499981999397278, "log_alpha_value": -0.05129516124725342, "target_entropy": -6.0, "policy_t": 0.02962423674762249, "mean_q": 4.071045398712158, "max_q": 4.572961807250977, "min_q": 3.6691460609436035}, "td_error": [0.6980220079421997, 1.5748000144958496, 0.8777556419372559, 0.24336552619934082, 0.10619664192199707, 1.20597505569458, 0.6283829212188721, 0.2526545524597168, 0.23825883865356445, 0.8755638599395752, 0.7667653560638428, 1.9414010047912598, 0.420363187789917, 0.44823789596557617, 1.677571415901184, 0.44087934494018555, 0.9391351938247681, 0.3657217025756836, 0.1698622703552246, 0.40222740173339844, 0.4330286979675293, 0.013167738914489746, 1.590811848640442, 1.7618467807769775, 1.253184199333191, 1.7456274032592773, 1.524472951889038, 1.0131359100341797, 2.744719982147217, 0.37934350967407227, 0.367153525352478, 2.762763261795044, 0.8473050594329834, 1.5337769985198975, 0.7977657318115234, 0.3919239044189453, 1.4099955558776855, 2.26080584526062, 1.7575647830963135, 1.4077703952789307, 0.49277591705322266, 0.20587873458862305, 1.541884422302246, 1.106126070022583, 0.5049550533294678, 2.0736794471740723, 0.46164965629577637, 0.6174170970916748, 1.2732362747192383, 0.28465282917022705, 0.8502449989318848, 0.06374430656433105, 0.28062546253204346, 3.063052177429199, 0.7141067981719971, 1.6286356449127197, 1.4943530559539795, 1.0534207820892334, 0.5078916549682617, 2.1497044563293457, 1.1397781372070312, 0.21948671340942383, 0.23769032955169678, 0.3900390863418579, 0.5507804155349731, 1.642047643661499, 1.1077327728271484, 1.690553903579712, 2.567701816558838, 0.5679312944412231, 0.6762619018554688, 2.9447176456451416, 0.5094256401062012, 0.97991943359375, 2.2039623260498047, 0.06771993637084961, 0.3813096284866333, 0.24114608764648438, 1.4001530408859253, 0.9724199771881104, 1.8890115022659302, 1.3244059085845947, 1.8693052530288696, 0.20518088340759277, 2.128915309906006, 1.5316981077194214], "mean_td_error": 1.0474027395248413, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 172.0, "diff_num_grad_updates_vs_sampler_policy": 171.0}}, "num_env_steps_sampled": 2702, "num_env_steps_trained": 44376, "num_agent_steps_sampled": 8106, "num_agent_steps_trained": 44376, "last_target_update_ts": 2702, "num_target_updates": 172}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8106, "num_agent_steps_trained": 44376, "num_env_steps_sampled": 2702, "num_env_steps_trained": 44376, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.43667630432371, "num_env_steps_trained_throughput_per_sec": 2522.3803552165023, "timesteps_total": 2702, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 8106, "timers": {"training_iteration_time_ms": 102.802, "sample_time_ms": 16.662, "load_time_ms": 0.311, "load_throughput": 829091.658, "learn_time_ms": 18.044, "learn_throughput": 14298.065, "synch_weights_time_ms": 9.548}, "counters": {"num_env_steps_sampled": 2702, "num_env_steps_trained": 44376, "num_agent_steps_sampled": 8106, "num_agent_steps_trained": 44376, "last_target_update_ts": 2702, "num_target_updates": 172}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "db258_00000", "date": "2023-11-16_21-48-26", "timestamp": 1700200106, "time_this_iter_s": 1.544564962387085, "time_total_s": 21.21941637992859, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb71a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 21.21941637992859, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.9, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050789833068848, "actor_loss": -10.310176849365234, "critic_loss": 0.17374351620674133, "alpha_loss": -0.5599227547645569, "alpha_value": 0.9458140134811401, "log_alpha_value": -0.05570933595299721, "target_entropy": -6.0, "policy_t": -0.0015286585548892617, "mean_q": 6.535531044006348, "max_q": 7.730584144592285, "min_q": 5.340366363525391}, "td_error": [0.5058708190917969, 1.0157389640808105, 0.49169325828552246, 0.5280845165252686, 2.633049249649048, 1.04093337059021, 0.8777029514312744, 1.2016606330871582, 0.9469218254089355, 0.9507007598876953, 2.0279364585876465, 1.4085767269134521, 0.1270008087158203, 2.0070114135742188, 0.5476515293121338, 1.6824712753295898, 2.8096065521240234, 0.29861974716186523, 0.6187911033630371, 1.0548732280731201, 0.5132498741149902, 0.9838409423828125, 1.7178616523742676, 2.7629549503326416, 0.9044630527496338, 1.43503737449646, 1.7749273777008057, 0.6104841232299805, 0.3744163513183594, 1.3752870559692383, 0.11437582969665527, 1.0594093799591064, 0.45978736877441406, 0.23077964782714844, 1.0702731609344482, 2.359862804412842, 0.7665877342224121, 0.3247854709625244, 3.2016069889068604, 0.6375999450683594, 0.9988536834716797, 1.4965198040008545, 2.3029723167419434, 0.5718908309936523, 2.8057916164398193, 0.36278629302978516, 1.3775672912597656, 0.7722177505493164, 1.2880346775054932, 2.176309823989868, 0.8723533153533936, 3.500714063644409, 0.15192437171936035, 0.39494824409484863, 1.4999830722808838, 0.5593373775482178, 1.4865260124206543, 2.1929054260253906, 1.242384672164917, 2.3452391624450684, 1.741112470626831, 1.7925679683685303, 0.07488250732421875, 1.525831699371338, 1.8920707702636719, 0.767871618270874, 0.08512449264526367, 0.2953498363494873, 0.35443711280822754, 0.9466016292572021, 0.1909928321838379, 1.3639769554138184, 2.3084981441497803, 2.7248101234436035, 0.44970083236694336, 2.236527442932129, 1.9158878326416016, 1.4179096221923828, 0.4302403926849365, 1.249161958694458, 2.0924556255340576, 0.9342319965362549, 0.640887975692749, 1.1782786846160889, 0.868218183517456, 0.41350293159484863], "mean_td_error": 1.2063125371932983, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109381675720215, "actor_loss": -8.083732604980469, "critic_loss": 0.17068828642368317, "alpha_loss": -0.5641261339187622, "alpha_value": 0.9457261562347412, "log_alpha_value": -0.05580223724246025, "target_entropy": -6.0, "policy_t": -0.008427023887634277, "mean_q": 4.234827041625977, "max_q": 4.963074684143066, "min_q": 3.7013838291168213}, "td_error": [1.3118722438812256, 0.6426527500152588, 0.9245235919952393, 0.7209651470184326, 0.845961332321167, 0.503669261932373, 2.1105048656463623, 1.6647909879684448, 0.680774450302124, 0.6746108531951904, 3.1561975479125977, 1.2547342777252197, 1.0225075483322144, 0.03952622413635254, 1.004467487335205, 0.6378569602966309, 1.293832778930664, 0.12186837196350098, 0.8487107753753662, 1.9872243404388428, 0.9734423160552979, 2.350433588027954, 1.4625170230865479, 1.617497444152832, 1.1481213569641113, 2.09165096282959, 0.3012430667877197, 0.11124157905578613, 0.6447935104370117, 0.34353208541870117, 1.1548932790756226, 1.106783390045166, 0.6880745887756348, 1.387082576751709, 1.1937825679779053, 0.3965737819671631, 1.3401479721069336, 0.6212183237075806, 1.1409025192260742, 1.9629123210906982, 0.9852051734924316, 2.8081023693084717, 0.042229652404785156, 1.241478443145752, 1.3047131299972534, 1.4440209865570068, 1.3682923316955566, 0.7168960571289062, 2.0087873935699463, 0.09338569641113281, 2.292142152786255, 0.729296088218689, 0.6647157669067383, 2.3288278579711914, 1.79826021194458, 0.33013200759887695, 0.24273157119750977, 0.08784294128417969, 3.833270311355591, 0.7757022380828857, 0.46251964569091797, 0.34288978576660156, 0.07615351676940918, 1.1317956447601318, 2.328087091445923, 0.3286142349243164, 0.5610992908477783, 0.09764575958251953, 1.1497015953063965, 0.03493690490722656, 0.9141623973846436, 0.3845634460449219, 2.9759485721588135, 0.6731511354446411, 0.731940507888794, 2.091325521469116, 2.2781693935394287, 1.1945388317108154, 0.5766582489013672, 2.061654806137085, 1.7991502285003662, 1.760272741317749, 0.9323912858963013, 0.6327993869781494, 0.8388292789459229, 0.9031941890716553], "mean_td_error": 1.1144455671310425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.027066230773926, "actor_loss": -8.012975692749023, "critic_loss": 0.16253861784934998, "alpha_loss": -0.5594828128814697, "alpha_value": 0.9457308650016785, "log_alpha_value": -0.05579725280404091, "target_entropy": -6.0, "policy_t": -0.0021200254559516907, "mean_q": 4.202415943145752, "max_q": 4.850454330444336, "min_q": 3.716519355773926}, "td_error": [0.4793081283569336, 0.1662912368774414, 2.5740294456481934, 0.8668258190155029, 0.5604772567749023, 2.818402051925659, 0.2812023162841797, 0.5042502880096436, 2.104567527770996, 0.4691333770751953, 0.5985927581787109, 1.1566808223724365, 1.7887442111968994, 0.672736644744873, 1.6315395832061768, 1.0050358772277832, 0.8051578998565674, 0.5487709045410156, 0.7741959095001221, 1.4275596141815186, 0.7412405014038086, 1.0467853546142578, 0.8344531059265137, 2.137038230895996, 1.2434046268463135, 0.3071761131286621, 0.7751369476318359, 1.2352914810180664, 0.4127957820892334, 1.0973286628723145, 1.152409315109253, 0.31429553031921387, 2.722468852996826, 0.09047079086303711, 0.5931272506713867, 0.17690348625183105, 1.5177743434906006, 1.393489122390747, 0.23523378372192383, 0.021200895309448242, 1.0783400535583496, 1.5433509349822998, 1.0287672281265259, 1.112483263015747, 1.009779453277588, 0.33839714527130127, 0.45562744140625, 0.7785115242004395, 1.3308732509613037, 1.8444747924804688, 1.5478484630584717, 1.3497333526611328, 1.5861811637878418, 1.3435266017913818, 1.0632269382476807, 1.2638907432556152, 0.70949387550354, 1.710514783859253, 0.9411993026733398, 0.01821732521057129, 0.9694700241088867, 1.847118854522705, 2.065624952316284, 0.3290961980819702, 1.4892268180847168, 0.23351192474365234, 0.3955000638961792, 1.287419319152832, 0.654665470123291, 0.39818859100341797, 0.7301287651062012, 2.291787624359131, 1.7232730388641357, 0.372589111328125, 2.224111795425415, 0.812431812286377, 1.6218843460083008, 0.4218277931213379, 1.9044885635375977, 0.17324447631835938, 0.8388323783874512, 0.1684722900390625, 0.30052483081817627, 1.0979876518249512, 0.5383524894714355, 1.8851206302642822], "mean_td_error": 1.0245447158813477, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}}, "num_env_steps_sampled": 2807, "num_env_steps_trained": 48246, "num_agent_steps_sampled": 8421, "num_agent_steps_trained": 48246, "last_target_update_ts": 2807, "num_target_updates": 187}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8421, "num_agent_steps_trained": 48246, "num_env_steps_sampled": 2807, "num_env_steps_trained": 48246, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.59742552056092, "num_env_steps_trained_throughput_per_sec": 2528.3051120435307, "timesteps_total": 2807, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 8421, "timers": {"training_iteration_time_ms": 102.812, "sample_time_ms": 15.916, "load_time_ms": 0.31, "load_throughput": 832792.39, "learn_time_ms": 17.99, "learn_throughput": 14341.23, "synch_weights_time_ms": 10.072}, "counters": {"num_env_steps_sampled": 2807, "num_env_steps_trained": 48246, "num_agent_steps_sampled": 8421, "num_agent_steps_trained": 48246, "last_target_update_ts": 2807, "num_target_updates": 187}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "db258_00000", "date": "2023-11-16_21-48-28", "timestamp": 1700200108, "time_this_iter_s": 1.5394198894500732, "time_total_s": 22.758836269378662, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 22.758836269378662, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.36666666666667, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0196533203125, "actor_loss": -10.311774253845215, "critic_loss": 0.13525110483169556, "alpha_loss": -0.6032769083976746, "alpha_value": 0.9415674209594727, "log_alpha_value": -0.060209356248378754, "target_entropy": -6.0, "policy_t": 0.007141580805182457, "mean_q": 6.614288806915283, "max_q": 7.532922744750977, "min_q": 5.746454238891602}, "td_error": [0.6207575798034668, 1.4424829483032227, 0.09528708457946777, 0.07240629196166992, 0.9824087619781494, 1.0644869804382324, 1.2153606414794922, 0.9165351390838623, 1.7720260620117188, 0.6871705055236816, 0.7158246040344238, 0.1010887622833252, 1.4017350673675537, 0.7381875514984131, 1.1630539894104004, 0.09835410118103027, 1.178600549697876, 2.3558578491210938, 0.7409756183624268, 0.7710771560668945, 0.5459060668945312, 2.596076011657715, 1.0063517093658447, 0.9942049980163574, 1.653108835220337, 0.9747574329376221, 1.2551193237304688, 0.37270689010620117, 0.7160286903381348, 1.3183002471923828, 1.0614936351776123, 0.2794151306152344, 1.144705057144165, 0.745638370513916, 0.9590244293212891, 0.9837238788604736, 0.756828784942627, 1.0307250022888184, 1.0282433032989502, 0.7183487415313721, 0.494565486907959, 0.13320255279541016, 0.941450834274292, 0.3532719612121582, 1.577580451965332, 1.432544469833374, 1.0516400337219238, 0.5830230712890625, 0.1390244960784912, 1.508610725402832, 2.154881477355957, 1.8301527500152588, 0.2007002830505371, 1.0128569602966309, 1.3170006275177002, 0.0637354850769043, 1.5788869857788086, 1.2278308868408203, 0.5030906200408936, 1.0279793739318848, 0.4359126091003418, 0.7579095363616943, 1.7411174774169922, 0.2743377685546875, 0.19305205345153809, 1.754136085510254, 2.717127561569214, 2.6366987228393555, 0.9224839210510254, 0.4212930202484131, 0.21181559562683105, 1.0395994186401367, 1.714942455291748, 1.587158203125, 1.6716997623443604, 0.46087121963500977, 1.6986632347106934, 0.7800498008728027, 0.8445396423339844, 0.6537983417510986, 0.6301701068878174, 1.6587133407592773, 1.3639256954193115, 1.5711915493011475, 0.38647031784057617, 0.432326078414917], "mean_td_error": 0.9996094703674316, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 202.0, "diff_num_grad_updates_vs_sampler_policy": 201.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0398530960083, "actor_loss": -7.994049549102783, "critic_loss": 0.13298764824867249, "alpha_loss": -0.6054180264472961, "alpha_value": 0.9414806365966797, "log_alpha_value": -0.06030147895216942, "target_entropy": -6.0, "policy_t": 0.026121029630303383, "mean_q": 4.1818060874938965, "max_q": 4.744401931762695, "min_q": 3.733415126800537}, "td_error": [0.6852374076843262, 1.0009386539459229, 0.058676958084106445, 1.1883635520935059, 0.9470460414886475, 2.8443498611450195, 0.3865838050842285, 0.2534472942352295, 1.3829116821289062, 0.7359397411346436, 0.09699678421020508, 1.4899471998214722, 2.2214038372039795, 0.14497196674346924, 0.7604231834411621, 1.0557513236999512, 1.8293671607971191, 0.5647678375244141, 1.981001377105713, 0.7135558128356934, 0.5960383415222168, 0.9388666152954102, 0.7666921615600586, 1.2448182106018066, 1.8015499114990234, 1.1656463146209717, 0.33706140518188477, 1.6820926666259766, 0.7668623924255371, 0.8928818702697754, 1.46586275100708, 0.49204039573669434, 1.1390047073364258, 0.35932493209838867, 1.0962097644805908, 1.297663927078247, 1.372666835784912, 1.3105461597442627, 0.03178572654724121, 0.9160745143890381, 0.5187010765075684, 1.5780141353607178, 1.1188631057739258, 0.4393582344055176, 2.107081174850464, 0.994086503982544, 1.2128875255584717, 1.8262230157852173, 0.40799570083618164, 0.1450967788696289, 1.3857501745224, 1.0088512897491455, 0.9036939144134521, 1.7425332069396973, 0.19047951698303223, 1.202589511871338, 0.5243716239929199, 1.7633874416351318, 1.8009006977081299, 2.279428482055664, 1.621633529663086, 1.5121221542358398, 0.5763778686523438, 0.7402712106704712, 1.0523555278778076, 1.7957258224487305, 1.4585740566253662, 1.7051875591278076, 2.131636142730713, 0.8559963703155518, 1.020667314529419, 1.5634015798568726, 0.9896557331085205, 1.462007999420166, 1.337824821472168, 1.0267298221588135, 1.7719075679779053, 0.785555362701416, 1.5163519382476807, 0.73175048828125, 0.1833970546722412, 0.9322183132171631, 0.4087870121002197, 0.13418936729431152, 0.962174654006958, 2.2034857273101807], "mean_td_error": 1.0889028310775757, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 202.0, "diff_num_grad_updates_vs_sampler_policy": 201.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091794967651367, "actor_loss": -8.166168212890625, "critic_loss": 0.1786903440952301, "alpha_loss": -0.6085193753242493, "alpha_value": 0.9414834976196289, "log_alpha_value": -0.060298435389995575, "target_entropy": -6.0, "policy_t": 0.02587905339896679, "mean_q": 4.363354682922363, "max_q": 4.912539958953857, "min_q": 3.969326972961426}, "td_error": [2.0233163833618164, 1.8215093612670898, 0.46938490867614746, 0.4109153747558594, 1.6400351524353027, 1.1057941913604736, 0.6238272190093994, 0.14696145057678223, 1.3310012817382812, 2.593996047973633, 1.0385866165161133, 0.25852108001708984, 1.7926609516143799, 2.1227822303771973, 0.10652804374694824, 0.8658890724182129, 0.27785754203796387, 1.1255569458007812, 2.396954298019409, 0.6468238830566406, 3.06037974357605, 1.7422301769256592, 0.6027793884277344, 0.5202381610870361, 1.0157084465026855, 1.8712224960327148, 0.8067631721496582, 2.1083877086639404, 1.6120738983154297, 1.422450304031372, 0.5957622528076172, 1.082970380783081, 1.743440866470337, 2.32576847076416, 1.7265799045562744, 1.2248778343200684, 0.6630203723907471, 0.12317395210266113, 0.9898569583892822, 0.6986508369445801, 1.4504199028015137, 0.6059038639068604, 1.2480974197387695, 0.7700867652893066, 0.04125237464904785, 1.9804363250732422, 2.152655601501465, 0.17725205421447754, 0.8474535942077637, 2.0761351585388184, 1.9478950500488281, 2.300358772277832, 0.8841404914855957, 0.15643763542175293, 1.1501398086547852, 0.8306968212127686, 1.4336364269256592, 0.3316185474395752, 1.8537449836730957, 0.19132471084594727, 1.0947165489196777, 0.02393937110900879, 0.695976734161377, 1.3017055988311768, 1.0332492589950562, 0.5494818687438965, 1.8529415130615234, 1.0077896118164062, 1.2624843120574951, 1.8001906871795654, 1.3058185577392578, 1.4685449600219727, 0.7545785903930664, 0.9475524425506592, 0.13602399826049805, 0.7864198684692383, 0.9768843650817871, 0.10907173156738281, 0.06217646598815918, 0.6023716926574707, 0.8017902374267578, 1.512389898300171, 0.5130038261413574, 1.4436376094818115, 1.1059722900390625, 0.041669607162475586], "mean_td_error": 1.0971547365188599, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 202.0, "diff_num_grad_updates_vs_sampler_policy": 201.0}}, "num_env_steps_sampled": 2912, "num_env_steps_trained": 52116, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 52116, "last_target_update_ts": 2912, "num_target_updates": 202}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 52116, "num_env_steps_sampled": 2912, "num_env_steps_trained": 52116, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.22709173839208, "num_env_steps_trained_throughput_per_sec": 2514.6556669293077, "timesteps_total": 2912, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 102.665, "sample_time_ms": 15.722, "load_time_ms": 0.313, "load_throughput": 825423.67, "learn_time_ms": 17.902, "learn_throughput": 14411.688, "synch_weights_time_ms": 9.835}, "counters": {"num_env_steps_sampled": 2912, "num_env_steps_trained": 52116, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 52116, "last_target_update_ts": 2912, "num_target_updates": 202}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "db258_00000", "date": "2023-11-16_21-48-29", "timestamp": 1700200109, "time_this_iter_s": 1.5467767715454102, "time_total_s": 24.305613040924072, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 24.305613040924072, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.6, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.018392562866211, "actor_loss": -10.647356986999512, "critic_loss": 0.18112576007843018, "alpha_loss": -0.648293673992157, "alpha_value": 0.9373389482498169, "log_alpha_value": -0.0647103488445282, "target_entropy": -6.0, "policy_t": 0.0006577949970960617, "mean_q": 6.935654163360596, "max_q": 8.10214614868164, "min_q": 6.051896095275879}, "td_error": [2.0744988918304443, 0.7575356960296631, 2.078601598739624, 0.398012638092041, 0.34423017501831055, 1.1427757740020752, 0.4757273197174072, 0.07244729995727539, 1.392310380935669, 0.10009002685546875, 1.0865564346313477, 1.1198840141296387, 2.8591396808624268, 1.0617311000823975, 2.3467800617218018, 1.7067420482635498, 0.9546403884887695, 0.2926492691040039, 1.5571410655975342, 3.12697696685791, 1.7885022163391113, 0.4237709045410156, 0.2902040481567383, 0.9256319999694824, 0.9832229614257812, 1.540534496307373, 2.6581761837005615, 0.390627384185791, 1.1971487998962402, 0.2734255790710449, 1.0851614475250244, 1.9699883460998535, 0.7313084602355957, 1.8165867328643799, 2.340623140335083, 0.19940614700317383, 0.30807971954345703, 0.14691829681396484, 1.3744421005249023, 0.6756980419158936, 1.1619420051574707, 1.362426519393921, 0.5198421478271484, 0.5747528076171875, 2.104433059692383, 1.7780311107635498, 0.5745248794555664, 2.897772789001465, 2.6450932025909424, 2.4785428047180176, 1.4248509407043457, 1.4904401302337646, 1.4958391189575195, 1.3403944969177246, 1.7827775478363037, 0.6319003105163574, 1.0749669075012207, 0.7294554710388184, 0.8331890106201172, 1.9753971099853516, 1.0952227115631104, 1.897752046585083, 1.766012191772461, 0.5685789585113525, 2.8980867862701416, 0.8404858112335205, 1.0314421653747559, 1.1229028701782227, 1.8600573539733887, 0.4404020309448242, 0.4266543388366699, 1.4490480422973633, 0.4399566650390625, 1.4747331142425537, 1.4422025680541992, 0.2871894836425781, 0.16941118240356445, 1.549966812133789, 0.9042329788208008, 0.6115493774414062, 0.15123367309570312, 1.7407877445220947, 1.827134609222412, 1.1819405555725098, 0.2128891944885254, 3.220181941986084], "mean_td_error": 1.227378487586975, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 217.0, "diff_num_grad_updates_vs_sampler_policy": 216.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149229049682617, "actor_loss": -8.10415267944336, "critic_loss": 0.14076736569404602, "alpha_loss": -0.6577057838439941, "alpha_value": 0.937251627445221, "log_alpha_value": -0.06480351835489273, "target_entropy": -6.0, "policy_t": -0.007017225492745638, "mean_q": 4.268243789672852, "max_q": 4.806976795196533, "min_q": 3.764199733734131}, "td_error": [0.5656366348266602, 2.031416654586792, 1.0606064796447754, 1.5602211952209473, 1.7172377109527588, 0.16882967948913574, 0.08922815322875977, 2.1515450477600098, 0.7373044490814209, 0.5495764017105103, 0.7328319549560547, 1.1403167247772217, 0.5921645164489746, 0.9196205139160156, 0.8432037830352783, 1.4620835781097412, 2.029733419418335, 1.5054364204406738, 2.687303066253662, 0.07304668426513672, 0.7737147808074951, 0.2632467746734619, 0.5434699058532715, 0.21500110626220703, 0.670966386795044, 3.3189220428466797, 1.8988597393035889, 2.360363483428955, 1.1826026439666748, 1.7788970470428467, 1.6094326972961426, 0.8428096771240234, 1.139746904373169, 1.6924571990966797, 0.710690975189209, 0.028363704681396484, 0.3446357250213623, 0.1684798002243042, 1.600407600402832, 1.1940126419067383, 0.7173829078674316, 0.7009973526000977, 0.919327974319458, 1.2386977672576904, 0.3920630216598511, 1.5217113494873047, 1.7467386722564697, 1.2264423370361328, 0.4561491012573242, 0.5959625244140625, 1.915529727935791, 0.07372641563415527, 0.4648439884185791, 0.4534883499145508, 1.1538357734680176, 1.2283196449279785, 1.8297617435455322, 1.8192930221557617, 0.7472836971282959, 0.7071802616119385, 0.08063888549804688, 1.5583360195159912, 0.5114932060241699, 1.2423126697540283, 1.3953349590301514, 0.04300689697265625, 0.5556764602661133, 0.3909115791320801, 2.470475673675537, 0.5432760715484619, 1.5746266841888428, 2.1304938793182373, 2.2833120822906494, 0.15428829193115234, 2.152005672454834, 0.8356807231903076, 2.2744028568267822, 1.233461856842041, 0.8232905864715576, 1.1336679458618164, 1.2207319736480713, 1.422914743423462, 2.8194260597229004, 1.0441300868988037, 1.2593944072723389, 1.2202119827270508], "mean_td_error": 1.1306588649749756, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 217.0, "diff_num_grad_updates_vs_sampler_policy": 216.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.029614448547363, "actor_loss": -8.222840309143066, "critic_loss": 0.16266050934791565, "alpha_loss": -0.6499326825141907, "alpha_value": 0.9372535943984985, "log_alpha_value": -0.06480135768651962, "target_entropy": -6.0, "policy_t": 0.03538891673088074, "mean_q": 4.5082902908325195, "max_q": 5.009069919586182, "min_q": 3.9136292934417725}, "td_error": [0.6700949668884277, 1.3086960315704346, 1.4360203742980957, 1.4762022495269775, 2.1187973022460938, 0.2561526298522949, 0.7692389488220215, 1.2055184841156006, 3.3073906898498535, 0.4508676528930664, 1.628420114517212, 0.947211742401123, 1.8863201141357422, 1.4663307666778564, 1.8636367321014404, 0.8582344055175781, 0.9319641590118408, 1.699052095413208, 0.555133581161499, 0.9112377166748047, 1.37786865234375, 0.5566971302032471, 1.7065250873565674, 2.389214038848877, 0.6854953765869141, 1.2183771133422852, 0.8962552547454834, 1.2255947589874268, 0.20093297958374023, 0.31744384765625, 0.1325836181640625, 1.1240057945251465, 1.1605579853057861, 0.3443634510040283, 0.2764561176300049, 0.2516770362854004, 0.7510523796081543, 0.6200041770935059, 1.4737279415130615, 0.2145094871520996, 0.4797697067260742, 1.2474489212036133, 0.07975101470947266, 0.8408551216125488, 0.6862657070159912, 1.5587189197540283, 1.106257677078247, 1.3003904819488525, 0.705449104309082, 0.07597923278808594, 0.5863585472106934, 1.1822738647460938, 2.119922161102295, 0.19730329513549805, 1.1968884468078613, 0.7294414043426514, 0.8601505756378174, 0.4765028953552246, 1.2402994632720947, 0.20189714431762695, 0.3243541717529297, 0.9165489673614502, 0.8669033050537109, 0.8284273147583008, 0.9511592388153076, 0.8115396499633789, 0.847466230392456, 1.819103479385376, 1.9885810613632202, 1.6175603866577148, 0.0824425220489502, 3.2803640365600586, 1.2528281211853027, 1.0293426513671875, 0.10216927528381348, 0.18153691291809082, 1.5029962062835693, 1.5413897037506104, 0.5419387817382812, 2.5677645206451416, 1.557760238647461, 2.039011001586914, 1.4649419784545898, 0.13908815383911133, 0.4166984558105469, 2.0294535160064697], "mean_td_error": 1.0493390560150146, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 217.0, "diff_num_grad_updates_vs_sampler_policy": 216.0}}, "num_env_steps_sampled": 3017, "num_env_steps_trained": 55986, "num_agent_steps_sampled": 9051, "num_agent_steps_trained": 55986, "last_target_update_ts": 3017, "num_target_updates": 217}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9051, "num_agent_steps_trained": 55986, "num_env_steps_sampled": 3017, "num_env_steps_trained": 55986, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.8864679305662, "num_env_steps_trained_throughput_per_sec": 2502.1012465837257, "timesteps_total": 3017, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 9051, "timers": {"training_iteration_time_ms": 103.956, "sample_time_ms": 16.738, "load_time_ms": 0.309, "load_throughput": 834011.894, "learn_time_ms": 17.862, "learn_throughput": 14444.082, "synch_weights_time_ms": 10.358}, "counters": {"num_env_steps_sampled": 3017, "num_env_steps_trained": 55986, "num_agent_steps_sampled": 9051, "num_agent_steps_trained": 55986, "last_target_update_ts": 3017, "num_target_updates": 217}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "db258_00000", "date": "2023-11-16_21-48-31", "timestamp": 1700200111, "time_this_iter_s": 1.5581018924713135, "time_total_s": 25.863714933395386, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0605e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 25.863714933395386, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.599999999999998, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05331039428711, "actor_loss": -10.725608825683594, "critic_loss": 0.1366158425807953, "alpha_loss": -0.6958078145980835, "alpha_value": 0.9331290125846863, "log_alpha_value": -0.06921181827783585, "target_entropy": -6.0, "policy_t": 0.004755138885229826, "mean_q": 6.99934196472168, "max_q": 8.071650505065918, "min_q": 6.048386096954346}, "td_error": [1.4064292907714844, 1.8695652484893799, 1.0111162662506104, 1.8902926445007324, 1.7810592651367188, 2.3090174198150635, 0.8251476287841797, 0.40319323539733887, 0.6408858299255371, 0.301685094833374, 1.0824575424194336, 0.6260099411010742, 0.2481861114501953, 1.0099544525146484, 0.6940770149230957, 0.051056623458862305, 0.6264209747314453, 0.7603554725646973, 1.2844269275665283, 1.5443971157073975, 1.201247215270996, 0.41001248359680176, 1.2392663955688477, 0.706718921661377, 2.1530086994171143, 2.417335033416748, 2.124274730682373, 0.5095224380493164, 0.048110246658325195, 1.7624282836914062, 0.4548959732055664, 0.07312583923339844, 1.8183507919311523, 0.6345841884613037, 2.089733839035034, 1.4914181232452393, 0.3813769817352295, 1.3948640823364258, 0.07818913459777832, 1.5433120727539062, 0.2055678367614746, 0.6087965965270996, 0.35596442222595215, 0.9944181442260742, 1.5176117420196533, 1.7185935974121094, 1.3792572021484375, 0.6343541145324707, 0.6685805320739746, 1.1936826705932617, 1.2800593376159668, 1.7498395442962646, 0.589484453201294, 1.6657781600952148, 0.5455718040466309, 1.442880630493164, 0.4800760746002197, 0.5063774585723877, 0.6026289463043213, 1.4728524684906006, 0.8951809406280518, 2.757723569869995, 1.6257894039154053, 0.6700096130371094, 0.3874971866607666, 1.3802838325500488, 0.2176811695098877, 0.8232908248901367, 1.1096067428588867, 0.1427292823791504, 0.23323440551757812, 1.7951242923736572, 1.1473829746246338, 0.47159433364868164, 2.0510759353637695, 0.22525310516357422, 0.6793045997619629, 1.8382956981658936, 0.33635902404785156, 1.0062947273254395, 1.3372139930725098, 1.4819560050964355, 1.023139476776123, 2.9852075576782227, 1.40596342086792, 1.1519560813903809], "mean_td_error": 1.06615149974823, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 232.0, "diff_num_grad_updates_vs_sampler_policy": 231.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07887077331543, "actor_loss": -8.336058616638184, "critic_loss": 0.11212515830993652, "alpha_loss": -0.6985700130462646, "alpha_value": 0.9330370426177979, "log_alpha_value": -0.06931034475564957, "target_entropy": -6.0, "policy_t": -0.0356856994330883, "mean_q": 4.563854694366455, "max_q": 5.247626304626465, "min_q": 4.053752422332764}, "td_error": [0.5715689659118652, 1.632662296295166, 0.17868423461914062, 0.2496471405029297, 0.3093695640563965, 0.5563950538635254, 2.5746707916259766, 1.7697582244873047, 0.10558867454528809, 0.22361326217651367, 1.4277865886688232, 0.22261548042297363, 0.495699405670166, 1.3471643924713135, 1.3890843391418457, 2.3046951293945312, 1.0559144020080566, 0.24494647979736328, 1.2589716911315918, 0.41347455978393555, 0.5780506134033203, 1.307124137878418, 1.037735939025879, 1.4233648777008057, 2.8949851989746094, 0.8906283378601074, 0.7751326560974121, 0.10080957412719727, 2.7278919219970703, 0.9246354103088379, 0.40326786041259766, 0.8234586715698242, 0.9937145709991455, 1.7122211456298828, 2.0861313343048096, 0.5954480171203613, 1.012366771697998, 0.7111244201660156, 1.326643466949463, 0.3335709571838379, 0.7779603004455566, 1.674753189086914, 0.11985945701599121, 0.09500861167907715, 1.1289215087890625, 1.0238511562347412, 0.4720160961151123, 1.884840726852417, 0.048592567443847656, 0.9519205093383789, 1.6733310222625732, 0.24501657485961914, 0.1676163673400879, 0.10781192779541016, 0.39955806732177734, 0.04267477989196777, 1.4148213863372803, 0.2723839282989502, 0.44455909729003906, 1.4768927097320557, 0.7531709671020508, 1.5782606601715088, 0.6039278507232666, 0.6528363227844238, 0.6388235092163086, 0.16981029510498047, 0.6016790866851807, 0.6304337978363037, 0.20324039459228516, 0.19855737686157227, 2.4960317611694336, 0.04804563522338867, 0.27139711380004883, 1.1722934246063232, 2.490203619003296, 2.669229507446289, 0.14220571517944336, 0.25026416778564453, 1.6156988143920898, 0.05552482604980469, 0.6728076934814453, 2.838679552078247, 0.9380161762237549, 0.9693775177001953, 0.6513116359710693, 0.11644458770751953], "mean_td_error": 0.9167589545249939, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 232.0, "diff_num_grad_updates_vs_sampler_policy": 231.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072823524475098, "actor_loss": -8.248397827148438, "critic_loss": 0.183277428150177, "alpha_loss": -0.6981117725372314, "alpha_value": 0.9330406785011292, "log_alpha_value": -0.06930646300315857, "target_entropy": -6.0, "policy_t": -0.01189467404037714, "mean_q": 4.556318283081055, "max_q": 5.112339973449707, "min_q": 4.062259674072266}, "td_error": [0.9186840057373047, 0.16419482231140137, 1.4551095962524414, 1.1267998218536377, 1.9181866645812988, 0.5227324962615967, 2.436391830444336, 0.9266440868377686, 0.7757136821746826, 1.6485373973846436, 0.6262655258178711, 0.8910579681396484, 0.47716593742370605, 1.7503788471221924, 2.2638299465179443, 0.5078873634338379, 0.5500924587249756, 1.4505465030670166, 1.465942621231079, 1.023468017578125, 0.1127316951751709, 1.177095651626587, 1.1158640384674072, 0.8736193180084229, 1.2756295204162598, 1.402014970779419, 2.3580856323242188, 0.5066208839416504, 1.4931221008300781, 0.7739839553833008, 1.6361947059631348, 2.1471786499023438, 0.9959015846252441, 0.9509003162384033, 2.1979188919067383, 1.0738422870635986, 1.2718420028686523, 1.282212734222412, 0.6153595447540283, 0.6337859630584717, 0.3391902446746826, 0.8202431201934814, 3.3095591068267822, 2.152327537536621, 0.47998476028442383, 0.6131007671356201, 0.7221729755401611, 1.7473933696746826, 0.2572147846221924, 2.3917248249053955, 2.0379693508148193, 1.2769808769226074, 0.5501887798309326, 1.9258644580841064, 0.8369417190551758, 0.8786706924438477, 1.4346258640289307, 0.8306715488433838, 2.4572062492370605, 1.6285929679870605, 1.3672418594360352, 1.079052209854126, 0.9091122150421143, 1.7572522163391113, 1.2838077545166016, 0.1254727840423584, 1.3641929626464844, 0.5298006534576416, 0.10242462158203125, 0.010115861892700195, 1.1953318119049072, 2.3031563758850098, 2.4206018447875977, 1.0345728397369385, 0.8330552577972412, 1.1486010551452637, 0.4079933166503906, 0.6860392093658447, 0.5407648086547852, 1.0043025016784668, 0.8253300189971924, 1.2408256530761719, 0.2829732894897461, 0.28011584281921387, 0.8113312721252441, 0.4088408946990967], "mean_td_error": 1.1329822540283203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 232.0, "diff_num_grad_updates_vs_sampler_policy": 231.0}}, "num_env_steps_sampled": 3122, "num_env_steps_trained": 59856, "num_agent_steps_sampled": 9366, "num_agent_steps_trained": 59856, "last_target_update_ts": 3122, "num_target_updates": 232}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9366, "num_agent_steps_trained": 59856, "num_env_steps_sampled": 3122, "num_env_steps_trained": 59856, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 60.660744694170766, "num_env_steps_trained_throughput_per_sec": 2235.7817330137227, "timesteps_total": 3122, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 9366, "timers": {"training_iteration_time_ms": 107.428, "sample_time_ms": 16.33, "load_time_ms": 0.311, "load_throughput": 828964.633, "learn_time_ms": 18.833, "learn_throughput": 13699.328, "synch_weights_time_ms": 12.637}, "counters": {"num_env_steps_sampled": 3122, "num_env_steps_trained": 59856, "num_agent_steps_sampled": 9366, "num_agent_steps_trained": 59856, "last_target_update_ts": 3122, "num_target_updates": 232}, "done": false, "episodes_total": 0, "training_iteration": 19, "trial_id": "db258_00000", "date": "2023-11-16_21-48-33", "timestamp": 1700200113, "time_this_iter_s": 1.7394580841064453, "time_total_s": 27.60317301750183, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0602c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 27.60317301750183, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.86666666666667, "ram_util_percent": 60.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114423751831055, "actor_loss": -10.794651985168457, "critic_loss": 0.15884339809417725, "alpha_loss": -0.7455669045448303, "alpha_value": 0.9289380311965942, "log_alpha_value": -0.07371322810649872, "target_entropy": -6.0, "policy_t": -0.03781508281826973, "mean_q": 7.133023262023926, "max_q": 8.050971984863281, "min_q": 6.13582706451416}, "td_error": [1.6971116065979004, 1.4025843143463135, 0.9350988864898682, 0.574918270111084, 0.786210298538208, 3.026607036590576, 1.6505024433135986, 0.09513235092163086, 2.012570858001709, 0.6043558120727539, 1.6642603874206543, 3.2457950115203857, 2.5659327507019043, 1.9561147689819336, 0.7043657302856445, 0.05902504920959473, 0.10095953941345215, 0.6676137447357178, 0.4963095188140869, 0.7936525344848633, 1.9617650508880615, 0.17647027969360352, 1.0822646617889404, 2.5253171920776367, 2.4956603050231934, 0.3778681755065918, 1.6586132049560547, 0.3463776111602783, 1.5118517875671387, 0.6584115028381348, 1.3193116188049316, 2.0375332832336426, 0.8901207447052002, 1.3162078857421875, 1.2476236820220947, 0.5215969085693359, 1.1357309818267822, 1.596668004989624, 0.2538425922393799, 2.532764196395874, 0.8952093124389648, 1.203141450881958, 0.42821836471557617, 0.6612963676452637, 2.2248497009277344, 1.1459307670593262, 0.7545294761657715, 1.35960054397583, 0.21651268005371094, 0.6676590442657471, 0.21535968780517578, 1.5516629219055176, 1.0000531673431396, 0.35752367973327637, 0.6481730937957764, 2.3341310024261475, 1.353729248046875, 1.2871496677398682, 0.14222264289855957, 1.587231159210205, 1.2822561264038086, 2.908931255340576, 1.4733200073242188, 0.9663715362548828, 2.6127712726593018, 1.7742094993591309, 0.6188876628875732, 0.6470849514007568, 2.2895431518554688, 0.9813745021820068, 0.9011416435241699, 0.5858995914459229, 1.4565403461456299, 1.6476860046386719, 1.413358449935913, 1.9386136531829834, 0.6332182884216309, 0.4318544864654541, 0.29682183265686035, 1.2802338600158691, 2.1936113834381104, 0.5465402603149414, 0.7671360969543457, 0.6031162738800049, 0.3802516460418701, 0.6027731895446777], "mean_td_error": 1.1854981184005737, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 246.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069422721862793, "actor_loss": -8.23843765258789, "critic_loss": 0.14252719283103943, "alpha_loss": -0.7432465553283691, "alpha_value": 0.9288460612297058, "log_alpha_value": -0.07381223142147064, "target_entropy": -6.0, "policy_t": -0.0036587945651263, "mean_q": 4.547273635864258, "max_q": 5.110593795776367, "min_q": 4.002044200897217}, "td_error": [1.3908421993255615, 1.4599316120147705, 0.1441946029663086, 1.0879905223846436, 0.5702664852142334, 0.24390435218811035, 1.4282019138336182, 0.7209420204162598, 0.22144699096679688, 2.046208143234253, 1.2010118961334229, 1.4358835220336914, 0.5029129981994629, 2.1715335845947266, 1.8770201206207275, 0.9463369846343994, 0.603360652923584, 1.4856233596801758, 1.0735588073730469, 2.3408780097961426, 1.1711409091949463, 2.1405060291290283, 0.2691631317138672, 0.6933603286743164, 1.345442771911621, 2.7759594917297363, 1.5182244777679443, 2.5240581035614014, 1.0605864524841309, 1.1046714782714844, 2.045663833618164, 1.8452115058898926, 2.0076982975006104, 1.1919958591461182, 1.301964282989502, 0.25664258003234863, 0.1542208194732666, 0.9378366470336914, 1.9227731227874756, 0.30387258529663086, 1.3123607635498047, 1.7131927013397217, 1.2220940589904785, 1.7537496089935303, 0.4326319694519043, 0.89512038230896, 0.6204397678375244, 1.124849796295166, 2.0071845054626465, 1.5991168022155762, 0.030872106552124023, 0.7942862510681152, 1.3842017650604248, 0.2538280487060547, 0.9885284900665283, 1.8672118186950684, 0.9708960056304932, 1.55299711227417, 0.9599225521087646, 1.6172699928283691, 1.7404627799987793, 1.1241588592529297, 1.0166621208190918, 0.17580223083496094, 0.8405411243438721, 0.821723461151123, 0.7779607772827148, 0.8133523464202881, 0.90358567237854, 1.3325953483581543, 0.6673791408538818, 0.5769240856170654, 0.2945072650909424, 1.9524593353271484, 1.8547735214233398, 1.8948025703430176, 0.4713716506958008, 0.23804044723510742, 1.7530088424682617, 0.22222018241882324, 0.4936392307281494, 1.2475016117095947, 0.6923177242279053, 0.07359552383422852, 0.09769105911254883, 1.7035212516784668], "mean_td_error": 1.120981216430664, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 246.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08279037475586, "actor_loss": -8.429368019104004, "critic_loss": 0.1852569878101349, "alpha_loss": -0.7442225813865662, "alpha_value": 0.928847074508667, "log_alpha_value": -0.07381117343902588, "target_entropy": -6.0, "policy_t": 0.03159263730049133, "mean_q": 4.694013595581055, "max_q": 5.105072498321533, "min_q": 4.122355937957764}, "td_error": [1.562197208404541, 1.0809884071350098, 0.5507311820983887, 1.4885358810424805, 0.9921383857727051, 0.39793848991394043, 0.3083176612854004, 1.4714000225067139, 0.7733111381530762, 1.4756298065185547, 0.6972551345825195, 1.587785005569458, 3.3419859409332275, 0.1847543716430664, 1.5944695472717285, 0.07193350791931152, 0.9807455539703369, 1.5314984321594238, 2.1265642642974854, 0.5123953819274902, 1.8084657192230225, 0.2405858039855957, 1.1244874000549316, 1.3745615482330322, 1.0491218566894531, 1.0182585716247559, 0.8189527988433838, 1.2717132568359375, 1.4015655517578125, 0.7438721656799316, 1.7561523914337158, 1.1234097480773926, 1.5714895725250244, 2.191115140914917, 0.701277494430542, 2.2515368461608887, 1.493419885635376, 2.9932711124420166, 0.3507657051086426, 0.8455848693847656, 0.6233930587768555, 0.5797061920166016, 1.3612964153289795, 2.020261526107788, 2.546156883239746, 1.1058738231658936, 1.1331663131713867, 1.0662591457366943, 2.0163636207580566, 0.5284857749938965, 0.18358993530273438, 1.0855910778045654, 1.6060221195220947, 0.4511075019836426, 0.28638529777526855, 0.8592658042907715, 1.6876568794250488, 2.950716972351074, 0.18356895446777344, 0.9430570602416992, 0.905092716217041, 0.37659645080566406, 0.7867131233215332, 0.5936126708984375, 0.7382988929748535, 1.2981417179107666, 1.660794734954834, 1.3881139755249023, 2.174752950668335, 1.4124696254730225, 1.6415791511535645, 0.30396461486816406, 1.1302855014801025, 1.5073175430297852, 0.8001315593719482, 1.408301591873169, 2.528914451599121, 0.310744047164917, 0.48485517501831055, 1.0295350551605225, 0.12024593353271484, 1.3996679782867432, 1.0776433944702148, 0.5025410652160645, 1.0856964588165283, 0.2708892822265625], "mean_td_error": 1.1513372659683228, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 246.0}}, "num_env_steps_sampled": 3227, "num_env_steps_trained": 63726, "num_agent_steps_sampled": 9681, "num_agent_steps_trained": 63726, "last_target_update_ts": 3227, "num_target_updates": 247}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9681, "num_agent_steps_trained": 63726, "num_env_steps_sampled": 3227, "num_env_steps_trained": 63726, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 64.07698050331055, "num_env_steps_trained_throughput_per_sec": 2361.6944242648747, "timesteps_total": 3227, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 9681, "timers": {"training_iteration_time_ms": 112.16, "sample_time_ms": 18.57, "load_time_ms": 0.344, "load_throughput": 749813.215, "learn_time_ms": 20.865, "learn_throughput": 12365.453, "synch_weights_time_ms": 11.972}, "counters": {"num_env_steps_sampled": 3227, "num_env_steps_trained": 63726, "num_agent_steps_sampled": 9681, "num_agent_steps_trained": 63726, "last_target_update_ts": 3227, "num_target_updates": 247}, "done": false, "episodes_total": 0, "training_iteration": 20, "trial_id": "db258_00000", "date": "2023-11-16_21-48-34", "timestamp": 1700200114, "time_this_iter_s": 1.6518340110778809, "time_total_s": 29.255007028579712, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 29.255007028579712, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 38.1, "ram_util_percent": 62.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095988273620605, "actor_loss": -11.088720321655273, "critic_loss": 0.15370634198188782, "alpha_loss": -0.7896843552589417, "alpha_value": 0.9247631430625916, "log_alpha_value": -0.07821764796972275, "target_entropy": -6.0, "policy_t": -0.01846194826066494, "mean_q": 7.343778610229492, "max_q": 8.398813247680664, "min_q": 6.429183006286621}, "td_error": [1.2831053733825684, 2.7350893020629883, 1.895507574081421, 1.6323316097259521, 3.1757726669311523, 0.1819469928741455, 0.4367954730987549, 0.8039944171905518, 0.11377835273742676, 1.631913185119629, 1.1235578060150146, 0.15575218200683594, 0.44196414947509766, 2.5041089057922363, 0.20105504989624023, 1.6047453880310059, 0.6872701644897461, 0.6009430885314941, 0.3189072608947754, 1.3262410163879395, 0.672029972076416, 1.2148213386535645, 1.9266183376312256, 0.4597151279449463, 0.5155863761901855, 0.07808041572570801, 1.2565112113952637, 1.019773006439209, 1.4176902770996094, 1.8293709754943848, 0.2806053161621094, 0.49108219146728516, 1.9680721759796143, 1.6239066123962402, 0.6167011260986328, 0.5645997524261475, 0.16506195068359375, 1.5822863578796387, 1.0906171798706055, 2.657167911529541, 1.3690006732940674, 1.1429433822631836, 2.36376690864563, 0.7582216262817383, 1.4730708599090576, 1.117901086807251, 1.7456402778625488, 0.33395838737487793, 0.5167179107666016, 1.0833067893981934, 1.1321706771850586, 1.2375004291534424, 0.8814880847930908, 0.8306624889373779, 1.0547075271606445, 0.25358033180236816, 0.438723087310791, 0.9950704574584961, 0.25072288513183594, 0.27782273292541504, 1.5998809337615967, 1.286452293395996, 1.030346393585205, 1.9614825248718262, 1.9276747703552246, 0.23385381698608398, 0.49237537384033203, 2.352036476135254, 0.6738781929016113, 0.2806713581085205, 1.6255173683166504, 0.9583613872528076, 3.3570027351379395, 1.5747759342193604, 1.6134324073791504, 0.45433878898620605, 0.5185048580169678, 0.38687753677368164, 1.4262545108795166, 1.661937952041626, 2.5150907039642334, 0.37308645248413086, 0.34069132804870605, 2.0762434005737305, 2.565849542617798, 0.5704860687255859], "mean_td_error": 1.132548451423645, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 262.0, "diff_num_grad_updates_vs_sampler_policy": 261.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075603485107422, "actor_loss": -8.498126029968262, "critic_loss": 0.14494509994983673, "alpha_loss": -0.7890207171440125, "alpha_value": 0.9246777296066284, "log_alpha_value": -0.07831001281738281, "target_entropy": -6.0, "policy_t": -0.012411431409418583, "mean_q": 4.765878200531006, "max_q": 5.395817756652832, "min_q": 4.215261459350586}, "td_error": [0.39304327964782715, 0.5904538631439209, 2.6479012966156006, 0.17309141159057617, 1.3091588020324707, 1.5038769245147705, 0.1111290454864502, 0.3647639751434326, 2.150942325592041, 1.551215648651123, 0.7360415458679199, 0.9586653709411621, 0.3549671173095703, 1.1266369819641113, 1.0779504776000977, 0.2788732051849365, 1.043210506439209, 0.56410813331604, 1.3178796768188477, 2.1082139015197754, 1.050614356994629, 0.7659387588500977, 4.830982685089111, 0.858144998550415, 0.2886974811553955, 0.15586137771606445, 1.859384298324585, 1.236229419708252, 2.4375579357147217, 1.2942190170288086, 2.5078585147857666, 0.7868103981018066, 0.7764904499053955, 1.6321477890014648, 0.28271913528442383, 1.735579490661621, 2.180858850479126, 0.35331010818481445, 0.036337852478027344, 1.2562642097473145, 1.8622546195983887, 0.41935229301452637, 1.410693883895874, 0.07786035537719727, 1.2147769927978516, 0.8319230079650879, 1.3745622634887695, 0.31476759910583496, 0.2625236511230469, 2.865985155105591, 0.9542136192321777, 0.4701838493347168, 0.5706753730773926, 1.0376667976379395, 1.6275827884674072, 1.349733829498291, 1.6031994819641113, 1.0735464096069336, 1.6264011859893799, 0.5219283103942871, 1.7258696556091309, 1.181335687637329, 1.8138306140899658, 1.04571533203125, 1.1506438255310059, 0.8799970149993896, 1.6958644390106201, 0.8641180992126465, 0.48473525047302246, 1.019698143005371, 1.4232680797576904, 0.7756061553955078, 2.6282236576080322, 1.8954503536224365, 0.7301747798919678, 0.7830710411071777, 1.4663918018341064, 1.2713687419891357, 1.1128976345062256, 1.8163423538208008, 0.6363251209259033, 0.3948190212249756, 0.5625784397125244, 1.3781414031982422, 0.6086440086364746, 0.8294980525970459], "mean_td_error": 1.1434019804000854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 262.0, "diff_num_grad_updates_vs_sampler_policy": 261.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.152017593383789, "actor_loss": -8.372483253479004, "critic_loss": 0.1882341504096985, "alpha_loss": -0.795049786567688, "alpha_value": 0.9246736168861389, "log_alpha_value": -0.07831446081399918, "target_entropy": -6.0, "policy_t": 0.024700777605175972, "mean_q": 4.598726272583008, "max_q": 5.2641754150390625, "min_q": 4.23842716217041}, "td_error": [1.3308026790618896, 0.8147242069244385, 2.2622861862182617, 1.742316722869873, 1.732774019241333, 1.3716723918914795, 0.5880391597747803, 1.0725996494293213, 2.6348886489868164, 1.419926404953003, 0.8929662704467773, 0.5145518779754639, 1.1400375366210938, 0.17090153694152832, 1.5607800483703613, 0.15806245803833008, 1.7187244892120361, 1.2609825134277344, 1.6512582302093506, 0.7463653087615967, 0.050719499588012695, 1.238548755645752, 0.8950920104980469, 0.839592695236206, 2.1640751361846924, 0.4500572681427002, 0.9225878715515137, 2.3711204528808594, 1.3521473407745361, 1.6623685359954834, 1.7636797428131104, 1.7312710285186768, 1.8041648864746094, 1.6659433841705322, 1.2347774505615234, 2.0057592391967773, 0.8839747905731201, 0.6119754314422607, 1.0739319324493408, 0.29495859146118164, 0.9557335376739502, 1.4801456928253174, 2.0410537719726562, 1.0728893280029297, 0.6429696083068848, 0.3030261993408203, 1.2594618797302246, 1.2542786598205566, 1.4470200538635254, 2.146184206008911, 0.5240974426269531, 1.5973172187805176, 1.9352662563323975, 0.48352885246276855, 1.841820478439331, 0.5063679218292236, 2.168339729309082, 0.6787490844726562, 1.6250123977661133, 1.054293155670166, 2.063917398452759, 1.4897549152374268, 1.416794776916504, 0.183671236038208, 0.45870494842529297, 0.0627145767211914, 0.17576026916503906, 0.9681098461151123, 1.6261186599731445, 1.9413859844207764, 0.10903024673461914, 0.5905656814575195, 2.05308198928833, 1.7327492237091064, 0.5000066757202148, 0.16899394989013672, 0.18633151054382324, 0.691394567489624, 0.9269649982452393, 0.13954973220825195, 0.9705345630645752, 1.86332106590271, 1.3262836933135986, 1.175266981124878, 0.40990734100341797, 1.0155727863311768], "mean_td_error": 1.1519237756729126, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 262.0, "diff_num_grad_updates_vs_sampler_policy": 261.0}}, "num_env_steps_sampled": 3332, "num_env_steps_trained": 67596, "num_agent_steps_sampled": 9996, "num_agent_steps_trained": 67596, "last_target_update_ts": 3332, "num_target_updates": 262}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9996, "num_agent_steps_trained": 67596, "num_env_steps_sampled": 3332, "num_env_steps_trained": 67596, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.60216991464252, "num_env_steps_trained_throughput_per_sec": 2454.7656911396816, "timesteps_total": 3332, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 9996, "timers": {"training_iteration_time_ms": 105.409, "sample_time_ms": 15.82, "load_time_ms": 0.314, "load_throughput": 822412.549, "learn_time_ms": 18.553, "learn_throughput": 13905.843, "synch_weights_time_ms": 10.677}, "counters": {"num_env_steps_sampled": 3332, "num_env_steps_trained": 67596, "num_agent_steps_sampled": 9996, "num_agent_steps_trained": 67596, "last_target_update_ts": 3332, "num_target_updates": 262}, "done": false, "episodes_total": 0, "training_iteration": 21, "trial_id": "db258_00000", "date": "2023-11-16_21-48-36", "timestamp": 1700200116, "time_this_iter_s": 1.5841631889343262, "time_total_s": 30.839170217514038, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 30.839170217514038, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 40.45, "ram_util_percent": 62.650000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099949836730957, "actor_loss": -11.236455917358398, "critic_loss": 0.14298933744430542, "alpha_loss": -0.8354067206382751, "alpha_value": 0.92061448097229, "log_alpha_value": -0.08271394670009613, "target_entropy": -6.0, "policy_t": 0.008622361347079277, "mean_q": 7.511874198913574, "max_q": 8.511013984680176, "min_q": 6.5383620262146}, "td_error": [0.4683551788330078, 0.407376766204834, 1.5330450534820557, 0.4262681007385254, 0.6087291240692139, 0.09420347213745117, 1.3947186470031738, 2.282114028930664, 0.5940642356872559, 1.3681533336639404, 1.2208597660064697, 0.6927950382232666, 0.2867732048034668, 1.1768836975097656, 0.19518470764160156, 0.9294345378875732, 0.9537622928619385, 0.5123631954193115, 1.0511727333068848, 2.2495222091674805, 1.2933685779571533, 0.0766606330871582, 1.6694188117980957, 1.825671911239624, 0.5988731384277344, 1.8240420818328857, 0.7274081707000732, 1.2483437061309814, 1.296736240386963, 0.867131233215332, 0.5148305892944336, 0.6493799686431885, 2.114511013031006, 0.5804181098937988, 0.07430219650268555, 0.7950007915496826, 0.2486891746520996, 0.15453267097473145, 2.399195671081543, 1.5864202976226807, 0.8364486694335938, 2.1947007179260254, 0.41423583030700684, 0.3449406623840332, 1.0950350761413574, 0.8487606048583984, 0.5350217819213867, 2.5692734718322754, 0.22410893440246582, 1.4066133499145508, 1.9692065715789795, 1.3149628639221191, 1.091346025466919, 1.8582148551940918, 1.260361909866333, 0.23836517333984375, 1.2184271812438965, 1.3204505443572998, 0.1123194694519043, 1.8186054229736328, 1.0454072952270508, 1.7311859130859375, 1.9343647956848145, 0.9966912269592285, 1.1411800384521484, 0.42389392852783203, 0.5977334976196289, 0.3184680938720703, 1.1556792259216309, 1.41391921043396, 0.3467414379119873, 0.9968104362487793, 0.8178815841674805, 1.4246892929077148, 1.7735896110534668, 0.546760082244873, 2.0577423572540283, 2.1214256286621094, 2.122401237487793, 1.3410322666168213, 1.8748893737792969, 2.4706218242645264, 0.8386626243591309, 1.6375722885131836, 0.21017146110534668, 1.4365942478179932], "mean_td_error": 1.098118782043457, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 277.0, "diff_num_grad_updates_vs_sampler_policy": 276.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.068246841430664, "actor_loss": -8.529170989990234, "critic_loss": 0.14850881695747375, "alpha_loss": -0.8337763547897339, "alpha_value": 0.9205237627029419, "log_alpha_value": -0.08281246572732925, "target_entropy": -6.0, "policy_t": 0.007794336881488562, "mean_q": 4.8404436111450195, "max_q": 5.334410667419434, "min_q": 4.397438049316406}, "td_error": [0.1101064682006836, 0.37130308151245117, 2.48002552986145, 0.9769167900085449, 1.9940247535705566, 1.5835754871368408, 1.7151799201965332, 0.6099545955657959, 1.8007221221923828, 0.3320643901824951, 0.715080976486206, 1.893345594406128, 1.6662836074829102, 1.1646311283111572, 0.023815155029296875, 1.045382022857666, 0.3457002639770508, 0.7772843837738037, 1.9241251945495605, 0.423581600189209, 1.0659494400024414, 2.541078567504883, 1.0925800800323486, 1.7634267807006836, 1.2985501289367676, 1.831465244293213, 1.0182185173034668, 0.7767210006713867, 2.524219512939453, 2.0655622482299805, 0.9343428611755371, 1.4177322387695312, 0.7793488502502441, 1.336332082748413, 1.4488787651062012, 2.9533491134643555, 2.333801746368408, 0.9417397975921631, 1.1828632354736328, 1.0037333965301514, 1.5899341106414795, 1.6684584617614746, 0.4746439456939697, 0.8262827396392822, 1.1459097862243652, 0.18549799919128418, 0.7992210388183594, 2.399778127670288, 1.8663759231567383, 1.27396821975708, 2.868717670440674, 0.8701508045196533, 1.347822904586792, 1.0845961570739746, 1.8038489818572998, 0.7021880149841309, 3.1977322101593018, 0.3252570629119873, 2.5413818359375, 0.6740274429321289, 0.2962610721588135, 0.34825825691223145, 2.055692672729492, 0.8691647052764893, 0.10642647743225098, 1.0601389408111572, 0.11326885223388672, 2.255119562149048, 0.37671971321105957, 0.4975097179412842, 0.7161469459533691, 1.1941087245941162, 0.5509250164031982, 0.4388444423675537, 1.1922168731689453, 0.2603893280029297, 0.6759977340698242, 1.0368404388427734, 0.6235241889953613, 0.33957791328430176, 0.8439309597015381, 1.5969114303588867, 1.1123545169830322, 0.6629846096038818, 0.15198349952697754, 2.09175705909729], "mean_td_error": 1.1787887811660767, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 277.0, "diff_num_grad_updates_vs_sampler_policy": 276.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.043365478515625, "actor_loss": -8.887166023254395, "critic_loss": 0.1661825180053711, "alpha_loss": -0.8317858576774597, "alpha_value": 0.9205173254013062, "log_alpha_value": -0.08281943202018738, "target_entropy": -6.0, "policy_t": -0.007426378317177296, "mean_q": 5.167350769042969, "max_q": 5.671797275543213, "min_q": 4.684823989868164}, "td_error": [0.7387712001800537, 0.10605883598327637, 2.612095832824707, 0.35666489601135254, 0.50337815284729, 1.3693785667419434, 1.3063135147094727, 1.6343348026275635, 1.5947813987731934, 0.2145376205444336, 0.45961856842041016, 0.17316079139709473, 1.0727314949035645, 0.9493503570556641, 0.42971086502075195, 0.9653346538543701, 1.2545475959777832, 0.26322340965270996, 0.28276920318603516, 1.341599464416504, 1.4705915451049805, 0.296353816986084, 0.5835165977478027, 0.778925895690918, 0.10937929153442383, 0.6863653659820557, 1.3131766319274902, 0.6683292388916016, 2.6688485145568848, 1.9986662864685059, 3.385753870010376, 1.8445515632629395, 0.7004811763763428, 1.5522630214691162, 0.17819690704345703, 0.8981115818023682, 0.09806990623474121, 2.70759916305542, 0.8218212127685547, 1.0834321975708008, 2.089632749557495, 1.4692399501800537, 0.44473719596862793, 1.5820202827453613, 2.080967426300049, 0.6491315364837646, 0.2751612663269043, 0.39520835876464844, 0.12704706192016602, 1.252387285232544, 0.3670616149902344, 1.3051412105560303, 0.49211859703063965, 0.569373607635498, 0.011383295059204102, 0.5576741695404053, 0.42302894592285156, 0.23896074295043945, 0.5216624736785889, 2.8944363594055176, 0.48949217796325684, 0.7064735889434814, 1.7517037391662598, 2.9515435695648193, 1.62180757522583, 1.6024386882781982, 1.459054946899414, 0.8806543350219727, 1.5220849514007568, 0.43562912940979004, 0.559119462966919, 1.485344409942627, 1.0533292293548584, 0.792323112487793, 0.34282541275024414, 1.1789846420288086, 0.1847827434539795, 0.21578478813171387, 1.986405611038208, 0.549607515335083, 2.317356586456299, 0.8683772087097168, 1.6859211921691895, 1.6225032806396484, 0.9596631526947021, 1.402646780014038], "mean_td_error": 1.0447096824645996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 277.0, "diff_num_grad_updates_vs_sampler_policy": 276.0}}, "num_env_steps_sampled": 3437, "num_env_steps_trained": 71466, "num_agent_steps_sampled": 10311, "num_agent_steps_trained": 71466, "last_target_update_ts": 3437, "num_target_updates": 277}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10311, "num_agent_steps_trained": 71466, "num_env_steps_sampled": 3437, "num_env_steps_trained": 71466, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.38583131857615, "num_env_steps_trained_throughput_per_sec": 2483.6492114560924, "timesteps_total": 3437, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 10311, "timers": {"training_iteration_time_ms": 104.45, "sample_time_ms": 16.125, "load_time_ms": 0.314, "load_throughput": 821413.718, "learn_time_ms": 18.119, "learn_throughput": 14239.233, "synch_weights_time_ms": 11.552}, "counters": {"num_env_steps_sampled": 3437, "num_env_steps_trained": 71466, "num_agent_steps_sampled": 10311, "num_agent_steps_trained": 71466, "last_target_update_ts": 3437, "num_target_updates": 277}, "done": false, "episodes_total": 0, "training_iteration": 22, "trial_id": "db258_00000", "date": "2023-11-16_21-48-38", "timestamp": 1700200118, "time_this_iter_s": 1.5664088726043701, "time_total_s": 32.40557909011841, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7c40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 32.40557909011841, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 37.166666666666664, "ram_util_percent": 61.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12624740600586, "actor_loss": -11.499252319335938, "critic_loss": 0.13692238926887512, "alpha_loss": -0.8831696510314941, "alpha_value": 0.916479229927063, "log_alpha_value": -0.08721589297056198, "target_entropy": -6.0, "policy_t": -0.02199111320078373, "mean_q": 7.747311115264893, "max_q": 8.694313049316406, "min_q": 6.7032470703125}, "td_error": [0.4958000183105469, 0.09595489501953125, 1.7589433193206787, 0.2972531318664551, 1.4359350204467773, 1.22005033493042, 2.572789192199707, 2.1914281845092773, 0.5884449481964111, 0.2783653736114502, 1.8186066150665283, 3.397304058074951, 1.5468087196350098, 0.9591264724731445, 0.16262030601501465, 0.2211465835571289, 0.13547372817993164, 1.4338982105255127, 1.236067771911621, 1.0773725509643555, 1.5466270446777344, 0.3998379707336426, 0.6695103645324707, 0.08944129943847656, 1.5208477973937988, 1.8016672134399414, 0.6324527263641357, 0.4948880672454834, 0.7554242610931396, 1.7466864585876465, 1.1706690788269043, 0.7865943908691406, 0.6254243850708008, 1.8506965637207031, 1.1506998538970947, 0.08626127243041992, 2.3775064945220947, 0.25968337059020996, 1.1170704364776611, 0.5129566192626953, 1.7926058769226074, 1.084205150604248, 3.420722723007202, 0.9391145706176758, 1.539961814880371, 1.134373664855957, 0.2892782688140869, 1.5142431259155273, 0.4667820930480957, 2.118562698364258, 0.22853708267211914, 2.381898880004883, 1.6933231353759766, 1.2955598831176758, 0.7410750389099121, 1.416743278503418, 0.2837257385253906, 0.6525952816009521, 0.07465410232543945, 1.086564064025879, 0.0792853832244873, 2.7815818786621094, 1.8707060813903809, 1.6168837547302246, 1.69303297996521, 0.23012709617614746, 1.4510655403137207, 0.38170433044433594, 1.3071296215057373, 0.6926548480987549, 0.39580273628234863, 2.066861629486084, 0.7907447814941406, 1.0978765487670898, 1.1243503093719482, 0.9505131244659424, 0.35430383682250977, 0.26763248443603516, 0.5142529010772705, 0.6694438457489014, 0.11551761627197266, 1.125629186630249, 0.4548799991607666, 0.12214279174804688, 1.0069856643676758, 0.14966821670532227], "mean_td_error": 1.0463213920593262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 292.0, "diff_num_grad_updates_vs_sampler_policy": 291.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05388355255127, "actor_loss": -8.684678077697754, "critic_loss": 0.14527341723442078, "alpha_loss": -0.8778603076934814, "alpha_value": 0.9163879156112671, "log_alpha_value": -0.08731554448604584, "target_entropy": -6.0, "policy_t": 6.933140684850514e-05, "mean_q": 4.97382926940918, "max_q": 5.85394287109375, "min_q": 4.477403163909912}, "td_error": [1.3632829189300537, 2.1663002967834473, 2.102935314178467, 0.3688533306121826, 0.31549620628356934, 1.6519453525543213, 0.50950026512146, 1.7490322589874268, 1.4936563968658447, 0.2298569679260254, 0.2856121063232422, 0.8318712711334229, 1.3757104873657227, 0.6657986640930176, 3.0998523235321045, 0.9256851673126221, 0.10157036781311035, 0.6095073223114014, 2.1614980697631836, 2.063476085662842, 0.7057390213012695, 2.043081760406494, 0.610541820526123, 0.09777545928955078, 0.9574213027954102, 2.1230382919311523, 0.2404162883758545, 0.5087988376617432, 2.3022704124450684, 0.7133631706237793, 0.3616352081298828, 1.6122798919677734, 1.0262420177459717, 2.3860905170440674, 0.9831516742706299, 0.22439312934875488, 0.6999571323394775, 0.5473203659057617, 1.020613193511963, 1.069742202758789, 1.5571331977844238, 1.0369493961334229, 1.3221354484558105, 4.841596603393555, 1.755640983581543, 1.0952019691467285, 0.5332841873168945, 1.467470407485962, 0.5352981090545654, 0.7643263339996338, 0.2705981731414795, 0.5595560073852539, 0.392625093460083, 0.38852453231811523, 0.5708889961242676, 2.2388148307800293, 0.9616682529449463, 0.10577750205993652, 0.6658763885498047, 0.31374263763427734, 2.933781862258911, 1.835606575012207, 0.2169637680053711, 1.3068339824676514, 0.47323155403137207, 0.5054745674133301, 1.5721895694732666, 0.7184643745422363, 1.1501152515411377, 1.5920679569244385, 0.706061601638794, 2.047070026397705, 1.377406120300293, 1.4411063194274902, 2.118340492248535, 2.886014461517334, 2.341635227203369, 0.17974209785461426, 2.666938304901123, 0.19288372993469238, 1.066903829574585, 2.086550712585449, 0.9321792125701904, 0.7272210121154785, 1.2783432006835938, 0.33825182914733887], "mean_td_error": 1.1671372652053833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 292.0, "diff_num_grad_updates_vs_sampler_policy": 291.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14539909362793, "actor_loss": -8.562090873718262, "critic_loss": 0.17989224195480347, "alpha_loss": -0.8859031796455383, "alpha_value": 0.9163832068443298, "log_alpha_value": -0.08732068538665771, "target_entropy": -6.0, "policy_t": -0.003109150566160679, "mean_q": 4.843186378479004, "max_q": 5.3601274490356445, "min_q": 4.413468360900879}, "td_error": [2.108168363571167, 0.6219334602355957, 0.5477924346923828, 1.714658260345459, 3.040289878845215, 1.1624302864074707, 1.0052909851074219, 1.1926798820495605, 0.636106014251709, 1.1988580226898193, 2.2623727321624756, 0.8389818668365479, 1.636061429977417, 1.1561365127563477, 1.205472707748413, 0.37509965896606445, 0.05168008804321289, 3.36747145652771, 1.010589838027954, 1.1075444221496582, 1.0527608394622803, 0.7942156791687012, 0.3196380138397217, 1.232532024383545, 1.8282160758972168, 2.4054160118103027, 0.7705953121185303, 2.7869911193847656, 1.8794739246368408, 0.9228184223175049, 1.326300859451294, 0.22209572792053223, 0.07766366004943848, 0.9023785591125488, 1.8456900119781494, 1.147324800491333, 1.0217032432556152, 1.7743992805480957, 0.34169530868530273, 1.4905052185058594, 1.3874154090881348, 1.313929557800293, 0.44255828857421875, 0.8470780849456787, 1.3159658908843994, 0.9998505115509033, 0.9240427017211914, 1.686173915863037, 0.4244208335876465, 0.7523682117462158, 2.8104841709136963, 3.1803364753723145, 1.382979393005371, 1.0954318046569824, 1.329838514328003, 0.06701111793518066, 0.02579021453857422, 0.03140664100646973, 0.8066556453704834, 0.3086729049682617, 0.8883085250854492, 0.22748517990112305, 2.943664312362671, 1.0661017894744873, 0.7123885154724121, 1.3192167282104492, 1.9755849838256836, 1.9580273628234863, 1.1444077491760254, 3.573791027069092, 2.337395668029785, 1.1337993144989014, 0.39832043647766113, 0.8589882850646973, 0.8902249336242676, 0.04081296920776367, 1.459965467453003, 0.6311850547790527, 1.1585376262664795, 3.1987287998199463, 0.7967550754547119, 2.2684872150421143, 1.1275126934051514, 0.06081700325012207, 0.35680603981018066, 1.0440387725830078], "mean_td_error": 1.2219277620315552, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 292.0, "diff_num_grad_updates_vs_sampler_policy": 291.0}}, "num_env_steps_sampled": 3542, "num_env_steps_trained": 75336, "num_agent_steps_sampled": 10626, "num_agent_steps_trained": 75336, "last_target_update_ts": 3542, "num_target_updates": 292}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10626, "num_agent_steps_trained": 75336, "num_env_steps_sampled": 3542, "num_env_steps_trained": 75336, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.0052693044793, "num_env_steps_trained_throughput_per_sec": 2506.4799257936656, "timesteps_total": 3542, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 10626, "timers": {"training_iteration_time_ms": 103.559, "sample_time_ms": 16.206, "load_time_ms": 0.306, "load_throughput": 843569.093, "learn_time_ms": 18.079, "learn_throughput": 14270.479, "synch_weights_time_ms": 9.864}, "counters": {"num_env_steps_sampled": 3542, "num_env_steps_trained": 75336, "num_agent_steps_sampled": 10626, "num_agent_steps_trained": 75336, "last_target_update_ts": 3542, "num_target_updates": 292}, "done": false, "episodes_total": 0, "training_iteration": 23, "trial_id": "db258_00000", "date": "2023-11-16_21-48-39", "timestamp": 1700200119, "time_this_iter_s": 1.554028034210205, "time_total_s": 33.95960712432861, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb71a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 33.95960712432861, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.95, "ram_util_percent": 61.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086251258850098, "actor_loss": -11.564088821411133, "critic_loss": 0.1015191376209259, "alpha_loss": -0.9250860810279846, "alpha_value": 0.912362813949585, "log_alpha_value": -0.09171753376722336, "target_entropy": -6.0, "policy_t": 0.0028414365369826555, "mean_q": 7.958218574523926, "max_q": 9.210498809814453, "min_q": 6.943352222442627}, "td_error": [1.0548591613769531, 0.941084623336792, 0.9456753730773926, 1.366870403289795, 1.244079828262329, 0.4230527877807617, 1.5055036544799805, 0.41718101501464844, 2.7856502532958984, 2.3945255279541016, 2.0904507637023926, 2.0576634407043457, 2.087890625, 1.562178611755371, 0.3318362236022949, 0.21018314361572266, 0.07888460159301758, 0.08963871002197266, 0.5756950378417969, 1.8657984733581543, 2.7813775539398193, 0.274782657623291, 1.0089874267578125, 0.5536155700683594, 0.48772764205932617, 1.3130226135253906, 1.0538325309753418, 1.0558147430419922, 1.8145408630371094, 0.5407874584197998, 0.2406020164489746, 0.030479907989501953, 0.7325153350830078, 1.2346439361572266, 2.356904983520508, 0.9174695014953613, 0.3422856330871582, 2.480541229248047, 0.520439624786377, 1.581143856048584, 1.4633855819702148, 0.7227377891540527, 1.3198301792144775, 0.02456068992614746, 0.4691643714904785, 0.22885560989379883, 1.7389402389526367, 1.7071919441223145, 2.182839870452881, 1.4235267639160156, 1.280236005783081, 1.505284309387207, 1.0630674362182617, 2.009100914001465, 0.48470640182495117, 1.6922593116760254, 1.3337135314941406, 0.41125035285949707, 2.099156379699707, 2.762655258178711, 1.2254903316497803, 0.6641485691070557, 2.0103392601013184, 2.45156192779541, 0.9076471328735352, 1.0011632442474365, 0.9048326015472412, 0.0730142593383789, 1.204946517944336, 1.3824539184570312, 0.7905561923980713, 0.5795965194702148, 0.7415661811828613, 0.18055462837219238, 2.1138687133789062, 0.8937201499938965, 0.5721461772918701, 0.24081707000732422, 0.4106147289276123, 0.7991724014282227, 1.2650294303894043, 1.257655143737793, 0.44658613204956055, 0.7570919990539551, 0.12830638885498047, 0.7649788856506348], "mean_td_error": 1.1051225662231445, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 306.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118070602416992, "actor_loss": -8.709489822387695, "critic_loss": 0.12707531452178955, "alpha_loss": -0.9289731979370117, "alpha_value": 0.912275493144989, "log_alpha_value": -0.09181328117847443, "target_entropy": -6.0, "policy_t": 0.04218633100390434, "mean_q": 5.077218532562256, "max_q": 5.87263822555542, "min_q": 4.507237911224365}, "td_error": [1.8023407459259033, 0.7068731784820557, 0.10588550567626953, 1.807887077331543, 1.3646214008331299, 2.1950104236602783, 1.0351474285125732, 1.2683789730072021, 0.13920021057128906, 0.04981851577758789, 2.2094662189483643, 1.6442909240722656, 0.5767607688903809, 0.557368278503418, 0.10576438903808594, 0.34710264205932617, 0.4918479919433594, 0.5408446788787842, 0.7909414768218994, 0.7506015300750732, 1.564882755279541, 0.5495696067810059, 0.640019416809082, 0.7363240718841553, 0.6613516807556152, 0.365048885345459, 0.8238270282745361, 0.7116155624389648, 1.4930641651153564, 1.0676772594451904, 1.1205151081085205, 1.245100498199463, 0.0736079216003418, 0.33142590522766113, 0.24946236610412598, 1.3047444820404053, 1.5068438053131104, 0.4348106384277344, 0.11147403717041016, 2.3984570503234863, 0.9086806774139404, 0.08314251899719238, 0.09764671325683594, 1.7320530414581299, 1.7950549125671387, 0.14946317672729492, 0.28365468978881836, 0.5870013236999512, 1.7663352489471436, 0.3738057613372803, 1.457517147064209, 2.2499024868011475, 2.072645902633667, 1.0183756351470947, 0.781853199005127, 0.2616724967956543, 1.076296091079712, 0.7242143154144287, 0.18813085556030273, 1.0036849975585938, 1.8785088062286377, 2.2304787635803223, 1.2355897426605225, 0.37461304664611816, 1.7187139987945557, 0.09464597702026367, 0.2921285629272461, 0.7992658615112305, 2.5005996227264404, 1.7864453792572021, 0.8465192317962646, 1.5364949703216553, 1.491823673248291, 2.60498046875, 1.434828758239746, 0.7648181915283203, 0.5326564311981201, 0.018916845321655273, 2.3171803951263428, 1.3992784023284912, 2.2701408863067627, 0.8615362644195557, 1.1195850372314453, 2.4246740341186523, 1.4316380023956299, 1.4945104122161865], "mean_td_error": 1.0459498167037964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 306.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113923072814941, "actor_loss": -9.009321212768555, "critic_loss": 0.13279753923416138, "alpha_loss": -0.9286766052246094, "alpha_value": 0.9122678637504578, "log_alpha_value": -0.0918215960264206, "target_entropy": -6.0, "policy_t": 0.010073143057525158, "mean_q": 5.279572010040283, "max_q": 5.86710262298584, "min_q": 4.738592147827148}, "td_error": [0.9815549850463867, 1.4916388988494873, 0.2944517135620117, 0.09235358238220215, 1.8945226669311523, 0.5410959720611572, 0.5219998359680176, 1.2172679901123047, 0.616323709487915, 0.0039103031158447266, 1.4064526557922363, 0.5392131805419922, 1.172217607498169, 0.5083248615264893, 1.3371531963348389, 0.4059417247772217, 2.164395332336426, 1.4037234783172607, 0.7164630889892578, 0.5948429107666016, 0.8595201969146729, 0.05875730514526367, 0.8509666919708252, 0.5187721252441406, 2.1772265434265137, 0.6656804084777832, 0.5527260303497314, 0.9823296070098877, 1.1770014762878418, 0.6875090599060059, 0.2668418884277344, 1.86079740524292, 0.8134427070617676, 0.44419169425964355, 0.8192629814147949, 0.9166183471679688, 0.4631693363189697, 0.6310791969299316, 1.8805525302886963, 0.048526763916015625, 1.6221179962158203, 0.9033825397491455, 1.1627600193023682, 0.8042263984680176, 2.138756513595581, 0.07487869262695312, 0.24977421760559082, 2.848778486251831, 0.590909481048584, 1.7679710388183594, 0.8790450096130371, 0.9477407932281494, 1.2720646858215332, 0.885185718536377, 1.885162353515625, 2.346673011779785, 1.7545852661132812, 1.6510753631591797, 0.11162471771240234, 0.5320212841033936, 0.0565645694732666, 0.9054207801818848, 1.3308062553405762, 0.9631242752075195, 1.022371768951416, 1.9695940017700195, 2.8705499172210693, 0.5579099655151367, 1.1455755233764648, 0.9128122329711914, 0.4994075298309326, 0.4239034652709961, 1.0384094715118408, 0.5652439594268799, 1.1100869178771973, 0.6900489330291748, 0.9085798263549805, 0.6841385364532471, 0.6986298561096191, 1.1334338188171387, 0.9848244190216064, 0.36893653869628906, 1.0060136318206787, 0.11810159683227539, 1.1437900066375732, 1.101759910583496], "mean_td_error": 0.9676464796066284, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 306.0}}, "num_env_steps_sampled": 3647, "num_env_steps_trained": 79206, "num_agent_steps_sampled": 10941, "num_agent_steps_trained": 79206, "last_target_update_ts": 3647, "num_target_updates": 307}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10941, "num_agent_steps_trained": 79206, "num_env_steps_sampled": 3647, "num_env_steps_trained": 79206, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.17871963165965, "num_env_steps_trained_throughput_per_sec": 2476.015666424027, "timesteps_total": 3647, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 10941, "timers": {"training_iteration_time_ms": 104.768, "sample_time_ms": 15.823, "load_time_ms": 0.308, "load_throughput": 836332.353, "learn_time_ms": 18.206, "learn_throughput": 14171.449, "synch_weights_time_ms": 10.421}, "counters": {"num_env_steps_sampled": 3647, "num_env_steps_trained": 79206, "num_agent_steps_sampled": 10941, "num_agent_steps_trained": 79206, "last_target_update_ts": 3647, "num_target_updates": 307}, "done": false, "episodes_total": 0, "training_iteration": 24, "trial_id": "db258_00000", "date": "2023-11-16_21-48-41", "timestamp": 1700200121, "time_this_iter_s": 1.5715360641479492, "time_total_s": 35.53114318847656, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 35.53114318847656, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.900000000000006, "ram_util_percent": 61.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067705154418945, "actor_loss": -11.938467025756836, "critic_loss": 0.11966539919376373, "alpha_loss": -0.9686207175254822, "alpha_value": 0.9082726240158081, "log_alpha_value": -0.09621067345142365, "target_entropy": -6.0, "policy_t": -0.04374266415834427, "mean_q": 8.294626235961914, "max_q": 9.120017051696777, "min_q": 7.250962257385254}, "td_error": [0.5160307884216309, 0.6574420928955078, 0.4962310791015625, 0.9796280860900879, 0.926203727722168, 1.1795611381530762, 0.13224411010742188, 3.243692398071289, 1.2761998176574707, 1.3289566040039062, 2.892793655395508, 0.5343599319458008, 0.9840202331542969, 0.5895504951477051, 1.2410340309143066, 0.9860987663269043, 1.1606011390686035, 1.3504955768585205, 1.3535246849060059, 1.0615653991699219, 0.3687877655029297, 0.39351654052734375, 1.7417011260986328, 1.9243359565734863, 0.671119213104248, 0.9545612335205078, 2.293023109436035, 0.7138938903808594, 0.10919904708862305, 1.5419135093688965, 1.523287296295166, 0.3211097717285156, 0.4526495933532715, 1.0671348571777344, 1.8915042877197266, 1.5041704177856445, 1.1832821369171143, 1.416306972503662, 1.9993572235107422, 3.128650665283203, 0.09348154067993164, 0.3793802261352539, 1.2402405738830566, 2.1115312576293945, 1.4234275817871094, 1.4566116333007812, 0.3549478054046631, 0.9802298545837402, 1.7160406112670898, 0.8569436073303223, 2.0397701263427734, 3.0191550254821777, 4.219032287597656, 0.38788843154907227, 0.8971586227416992, 1.8550300598144531, 0.18747854232788086, 0.19646549224853516, 1.7262532711029053, 0.6712422370910645, 1.2375268936157227, 0.8344802856445312, 1.564650535583496, 2.20707368850708, 1.6691398620605469, 0.9639816284179688, 1.2828235626220703, 0.18506717681884766, 1.1908841133117676, 2.025484085083008, 0.816370964050293, 2.65177059173584, 0.7557954788208008, 0.9814188480377197, 1.9813027381896973, 1.7851672172546387, 0.4838275909423828, 1.1136016845703125, 2.918759346008301, 0.24091720581054688, 3.3628597259521484, 0.7776918411254883, 2.364952564239502, 0.8178524971008301, 0.5598349571228027, 1.203573226928711], "mean_td_error": 1.2776612043380737, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 322.0, "diff_num_grad_updates_vs_sampler_policy": 321.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.998005867004395, "actor_loss": -8.79892349243164, "critic_loss": 0.12321220338344574, "alpha_loss": -0.9629201889038086, "alpha_value": 0.9081813097000122, "log_alpha_value": -0.09631121903657913, "target_entropy": -6.0, "policy_t": 0.00518472446128726, "mean_q": 5.176880359649658, "max_q": 5.735204219818115, "min_q": 4.783814430236816}, "td_error": [0.26172304153442383, 0.28553104400634766, 1.3945212364196777, 0.367983341217041, 1.3971750736236572, 1.3220994472503662, 0.7700753211975098, 0.8524060249328613, 1.6796002388000488, 0.47614336013793945, 0.8387994766235352, 0.3225672245025635, 2.8040354251861572, 0.44425225257873535, 0.7437872886657715, 2.2869741916656494, 1.9867362976074219, 0.06496095657348633, 0.7682332992553711, 0.17530322074890137, 1.0223419666290283, 1.288562536239624, 2.211282253265381, 0.15387535095214844, 2.077409505844116, 2.4018139839172363, 0.8888320922851562, 1.0611913204193115, 1.6189799308776855, 1.9390983581542969, 2.6723930835723877, 2.017825126647949, 1.2418792247772217, 0.18924260139465332, 0.3049125671386719, 0.8393476009368896, 0.8099722862243652, 1.40647554397583, 1.0846154689788818, 0.7890186309814453, 0.2039051055908203, 0.07331442832946777, 1.4147534370422363, 1.064164161682129, 1.50262451171875, 1.3406951427459717, 0.4119744300842285, 1.1571033000946045, 0.85028076171875, 1.7319812774658203, 1.0950605869293213, 0.7793238162994385, 0.2090291976928711, 2.486072301864624, 0.21645021438598633, 0.2136828899383545, 0.24509906768798828, 1.0663645267486572, 0.20638585090637207, 0.7288625240325928, 0.985255241394043, 0.7952675819396973, 0.9499673843383789, 2.205749988555908, 0.04377031326293945, 0.13540339469909668, 0.617556095123291, 1.6024665832519531, 1.3055667877197266, 1.341644525527954, 0.216888427734375, 0.23335862159729004, 0.43920350074768066, 1.5589666366577148, 1.4208669662475586, 0.5261540412902832, 0.04310321807861328, 1.3008477687835693, 1.348552942276001, 1.513288974761963, 0.6942248344421387, 1.253600835800171, 2.2273175716400146, 1.0022437572479248, 1.2038283348083496, 0.6219747066497803], "mean_td_error": 1.0214672088623047, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 322.0, "diff_num_grad_updates_vs_sampler_policy": 321.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.033977508544922, "actor_loss": -8.81844425201416, "critic_loss": 0.16861197352409363, "alpha_loss": -0.9665071368217468, "alpha_value": 0.908170223236084, "log_alpha_value": -0.09632343053817749, "target_entropy": -6.0, "policy_t": 0.04720459505915642, "mean_q": 5.175994396209717, "max_q": 5.576785564422607, "min_q": 4.706628322601318}, "td_error": [0.7261269092559814, 3.4560155868530273, 1.2844252586364746, 2.083218574523926, 1.1999831199645996, 0.056215524673461914, 1.191037654876709, 1.6613366603851318, 1.3629662990570068, 1.8603997230529785, 1.0113186836242676, 1.0728230476379395, 0.40530848503112793, 2.240295171737671, 1.0143389701843262, 1.5137965679168701, 1.0489730834960938, 0.6114516258239746, 0.9112563133239746, 2.412625789642334, 0.0948324203491211, 2.9223334789276123, 0.42701292037963867, 0.517343282699585, 1.4210593700408936, 0.978870153427124, 0.06262755393981934, 3.1258738040924072, 0.8048157691955566, 0.8194220066070557, 2.264751672744751, 1.6019151210784912, 1.663569450378418, 0.08114862442016602, 1.521672248840332, 0.9096665382385254, 1.9193527698516846, 0.8249239921569824, 1.7746069431304932, 0.9166183471679688, 0.6489138603210449, 1.5027737617492676, 1.168281078338623, 0.7073566913604736, 1.1971135139465332, 1.110670566558838, 0.22206425666809082, 0.05631589889526367, 1.4424495697021484, 1.20402193069458, 1.0243682861328125, 0.03477978706359863, 1.5403292179107666, 2.0635874271392822, 0.25014352798461914, 0.5301103591918945, 0.7467126846313477, 1.0397095680236816, 0.8257741928100586, 0.9100918769836426, 0.36215710639953613, 1.9844648838043213, 1.6154966354370117, 0.08103609085083008, 1.3694791793823242, 1.6090648174285889, 1.7339355945587158, 1.1835439205169678, 0.48280858993530273, 1.041856050491333, 0.8704993724822998, 2.0321099758148193, 0.6405751705169678, 0.6204502582550049, 1.777693748474121, 0.2088618278503418, 1.5267963409423828, 0.9657764434814453, 0.47934985160827637, 0.18294596672058105, 2.0290732383728027, 1.3056726455688477, 1.2253186702728271, 0.6090397834777832, 1.7337861061096191, 1.4044158458709717], "mean_td_error": 1.1520709991455078, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 322.0, "diff_num_grad_updates_vs_sampler_policy": 321.0}}, "num_env_steps_sampled": 3752, "num_env_steps_trained": 83076, "num_agent_steps_sampled": 11256, "num_agent_steps_trained": 83076, "last_target_update_ts": 3752, "num_target_updates": 322}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11256, "num_agent_steps_trained": 83076, "num_env_steps_sampled": 3752, "num_env_steps_trained": 83076, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.89743646668461, "num_env_steps_trained_throughput_per_sec": 2502.5055154863758, "timesteps_total": 3752, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 11256, "timers": {"training_iteration_time_ms": 103.798, "sample_time_ms": 15.679, "load_time_ms": 0.314, "load_throughput": 821787.995, "learn_time_ms": 18.61, "learn_throughput": 13863.638, "synch_weights_time_ms": 10.357}, "counters": {"num_env_steps_sampled": 3752, "num_env_steps_trained": 83076, "num_agent_steps_sampled": 11256, "num_agent_steps_trained": 83076, "last_target_update_ts": 3752, "num_target_updates": 322}, "done": false, "episodes_total": 0, "training_iteration": 25, "trial_id": "db258_00000", "date": "2023-11-16_21-48-42", "timestamp": 1700200122, "time_this_iter_s": 1.5553860664367676, "time_total_s": 37.08652925491333, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 37.08652925491333, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 37.400000000000006, "ram_util_percent": 61.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00894546508789, "actor_loss": -12.0040864944458, "critic_loss": 0.10102851688861847, "alpha_loss": -1.0080139636993408, "alpha_value": 0.9041939973831177, "log_alpha_value": -0.10071130841970444, "target_entropy": -6.0, "policy_t": -0.011490852572023869, "mean_q": 8.419088363647461, "max_q": 9.370038986206055, "min_q": 7.4689202308654785}, "td_error": [0.8210005760192871, 0.5138473510742188, 2.676481246948242, 0.35135746002197266, 1.1197748184204102, 0.2098236083984375, 0.4547100067138672, 1.0642848014831543, 0.27732014656066895, 2.8577706813812256, 2.384119987487793, 1.1665878295898438, 0.21836233139038086, 1.6286892890930176, 2.172867774963379, 1.5348773002624512, 0.11458826065063477, 1.0326104164123535, 1.257674217224121, 0.38780784606933594, 0.5552511215209961, 0.9595041275024414, 0.5964932441711426, 0.11933040618896484, 1.1475892066955566, 1.058483600616455, 1.9813742637634277, 0.5323953628540039, 0.6253490447998047, 0.7009248733520508, 0.43609142303466797, 0.25516414642333984, 1.0564689636230469, 1.6368391513824463, 0.736452579498291, 0.7649044990539551, 1.5681509971618652, 1.2906246185302734, 0.3042941093444824, 1.3078336715698242, 1.3844480514526367, 0.8998613357543945, 0.0882558822631836, 2.2339816093444824, 1.6112332344055176, 0.6007199287414551, 1.1202635765075684, 0.22362852096557617, 1.4763774871826172, 0.9552035331726074, 1.862898349761963, 0.15001535415649414, 0.17938828468322754, 1.5465402603149414, 2.0588767528533936, 1.7935476303100586, 0.640167236328125, 0.2891669273376465, 0.24354076385498047, 1.0818614959716797, 1.1110029220581055, 1.7686777114868164, 1.0523033142089844, 2.085430145263672, 1.8057169914245605, 1.5085954666137695, 0.8822355270385742, 0.7696866989135742, 0.8377761840820312, 0.5924692153930664, 0.8051052093505859, 0.6984546184539795, 1.222151756286621, 0.7681021690368652, 0.19338274002075195, 1.989159107208252, 2.509277820587158, 3.300685405731201, 2.6544766426086426, 0.9390640258789062, 0.21033620834350586, 1.714829444885254, 2.4945836067199707, 1.6087982654571533, 0.770782470703125, 1.6171963214874268], "mean_td_error": 1.118934154510498, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 337.0, "diff_num_grad_updates_vs_sampler_policy": 336.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115860939025879, "actor_loss": -9.017121315002441, "critic_loss": 0.1466929018497467, "alpha_loss": -1.0197510719299316, "alpha_value": 0.904107391834259, "log_alpha_value": -0.10080715268850327, "target_entropy": -6.0, "policy_t": -0.03483672812581062, "mean_q": 5.375694274902344, "max_q": 5.8445234298706055, "min_q": 4.948075294494629}, "td_error": [0.980388879776001, 0.2860531806945801, 1.4097235202789307, 0.5104713439941406, 0.8577823638916016, 1.1223468780517578, 0.488783597946167, 0.9057846069335938, 0.6101346015930176, 1.1425254344940186, 2.845623731613159, 1.3296420574188232, 0.6899824142456055, 0.8380882740020752, 1.0316221714019775, 1.4477894306182861, 0.27812790870666504, 1.0569860935211182, 1.0544121265411377, 2.5570521354675293, 0.05488467216491699, 1.1799747943878174, 3.50602388381958, 0.61212158203125, 1.5016324520111084, 2.6370718479156494, 1.6430675983428955, 0.055490970611572266, 0.28075242042541504, 1.1686155796051025, 1.164743185043335, 0.4310302734375, 0.011443614959716797, 1.905886173248291, 1.3085722923278809, 1.1404614448547363, 1.5279059410095215, 0.7147455215454102, 1.8236961364746094, 1.230581283569336, 0.9040117263793945, 2.4488260746002197, 1.6925194263458252, 0.0958704948425293, 0.4035520553588867, 1.119227647781372, 2.0002355575561523, 1.042057991027832, 0.07407712936401367, 1.2372848987579346, 2.2936439514160156, 1.4033591747283936, 1.4045372009277344, 0.3066277503967285, 1.051626205444336, 2.0532238483428955, 0.05480527877807617, 0.4374089241027832, 1.823824405670166, 0.8451659679412842, 0.827110767364502, 0.5341815948486328, 1.8441851139068604, 1.798490047454834, 1.6390209197998047, 1.2198259830474854, 2.072296619415283, 0.7761626243591309, 0.938270092010498, 0.5113327503204346, 0.4980282783508301, 2.0012619495391846, 0.20995664596557617, 1.0218870639801025, 2.1976277828216553, 0.3378126621246338, 0.9610395431518555, 1.083939552307129, 1.339423418045044, 0.35849547386169434, 1.163184642791748, 1.1148078441619873, 2.4836297035217285, 0.575526237487793, 1.7112505435943604, 0.528087854385376], "mean_td_error": 1.1369853019714355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 337.0, "diff_num_grad_updates_vs_sampler_policy": 336.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078435897827148, "actor_loss": -9.090799331665039, "critic_loss": 0.1822395622730255, "alpha_loss": -1.0161588191986084, "alpha_value": 0.9040911793708801, "log_alpha_value": -0.10082504898309708, "target_entropy": -6.0, "policy_t": -0.010588109493255615, "mean_q": 5.437190532684326, "max_q": 5.915493965148926, "min_q": 5.039634704589844}, "td_error": [1.6023459434509277, 0.05630302429199219, 0.9261677265167236, 0.3810703754425049, 1.175816297531128, 2.940075635910034, 0.46745896339416504, 1.7445249557495117, 1.6951441764831543, 0.44544506072998047, 0.28629064559936523, 0.976996898651123, 1.0726613998413086, 2.9169890880584717, 1.0694944858551025, 0.43731069564819336, 1.9917988777160645, 0.5086705684661865, 0.4871983528137207, 0.6297910213470459, 0.2155904769897461, 1.3237438201904297, 2.146730899810791, 0.9895811080932617, 0.2585873603820801, 0.8582019805908203, 2.2317311763763428, 0.9777538776397705, 3.382209062576294, 1.3117177486419678, 1.821911334991455, 1.2850439548492432, 1.9612927436828613, 1.4446403980255127, 0.5693855285644531, 0.9902527332305908, 0.3841824531555176, 0.7279095649719238, 0.24477458000183105, 2.52862286567688, 0.14132213592529297, 0.2574737071990967, 2.928497552871704, 0.2302253246307373, 1.4554002285003662, 1.8399293422698975, 1.201850175857544, 0.21632099151611328, 0.6503372192382812, 0.7235374450683594, 1.1422410011291504, 1.250347375869751, 0.20021677017211914, 0.4922068119049072, 0.17510533332824707, 3.210624933242798, 0.7787494659423828, 1.3685507774353027, 0.8905277252197266, 0.1628565788269043, 1.1863601207733154, 0.807398796081543, 0.2610476016998291, 1.934638261795044, 2.271693706512451, 1.927821159362793, 0.7901632785797119, 1.8126823902130127, 1.5911436080932617, 1.6365115642547607, 1.5607273578643799, 3.531355142593384, 2.0273821353912354, 0.9151136875152588, 1.298851490020752, 1.487891674041748, 2.812213659286499, 1.9294452667236328, 1.179558277130127, 1.973823070526123, 0.9410078525543213, 1.3251745700836182, 1.0388119220733643, 0.8919873237609863, 1.0164783000946045, 1.6024377346038818], "mean_td_error": 1.238761067390442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 337.0, "diff_num_grad_updates_vs_sampler_policy": 336.0}}, "num_env_steps_sampled": 3857, "num_env_steps_trained": 86946, "num_agent_steps_sampled": 11571, "num_agent_steps_trained": 86946, "last_target_update_ts": 3857, "num_target_updates": 337}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11571, "num_agent_steps_trained": 86946, "num_env_steps_sampled": 3857, "num_env_steps_trained": 86946, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.79143725840555, "num_env_steps_trained_throughput_per_sec": 2498.59868752409, "timesteps_total": 3857, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 11571, "timers": {"training_iteration_time_ms": 103.427, "sample_time_ms": 15.499, "load_time_ms": 0.308, "load_throughput": 838340.899, "learn_time_ms": 18.138, "learn_throughput": 14223.923, "synch_weights_time_ms": 10.456}, "counters": {"num_env_steps_sampled": 3857, "num_env_steps_trained": 86946, "num_agent_steps_sampled": 11571, "num_agent_steps_trained": 86946, "last_target_update_ts": 3857, "num_target_updates": 337}, "done": false, "episodes_total": 0, "training_iteration": 26, "trial_id": "db258_00000", "date": "2023-11-16_21-48-44", "timestamp": 1700200124, "time_this_iter_s": 1.5590457916259766, "time_total_s": 38.64557504653931, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb71a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 38.64557504653931, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.166666666666664, "ram_util_percent": 61.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.935165405273438, "actor_loss": -12.308378219604492, "critic_loss": 0.09670309722423553, "alpha_loss": -1.0452536344528198, "alpha_value": 0.9001377820968628, "log_alpha_value": -0.10520745813846588, "target_entropy": -6.0, "policy_t": -0.0018312478205189109, "mean_q": 8.746125221252441, "max_q": 10.049087524414062, "min_q": 7.777585983276367}, "td_error": [0.0778203010559082, 0.660092830657959, 0.6700859069824219, 2.2863388061523438, 1.8774256706237793, 1.3582797050476074, 1.0209074020385742, 0.9826998710632324, 0.5148897171020508, 1.027085304260254, 0.15488624572753906, 1.033581256866455, 0.731318473815918, 1.3639841079711914, 2.5890069007873535, 0.46340417861938477, 0.8792858123779297, 1.2698450088500977, 0.7070350646972656, 3.376112937927246, 0.34455347061157227, 0.37755870819091797, 1.3771462440490723, 1.1826648712158203, 0.8424530029296875, 1.4450268745422363, 2.543226718902588, 0.864130973815918, 1.739494800567627, 0.03523731231689453, 0.7713813781738281, 1.2142248153686523, 0.25393009185791016, 0.8561406135559082, 2.1391067504882812, 0.7539634704589844, 0.6746683120727539, 0.7989420890808105, 0.9741630554199219, 0.7381620407104492, 2.287642478942871, 1.042806625366211, 1.3493809700012207, 1.5920486450195312, 2.4609789848327637, 0.49089765548706055, 0.17000532150268555, 1.5540823936462402, 1.4616293907165527, 0.22088146209716797, 0.9701042175292969, 1.104600429534912, 0.660099983215332, 1.9819831848144531, 1.4086027145385742, 0.4411449432373047, 0.6214609146118164, 0.4282207489013672, 1.1813316345214844, 0.7816929817199707, 0.6139955520629883, 0.9580268859863281, 0.16530656814575195, 0.11824893951416016, 0.46427011489868164, 0.9347190856933594, 2.743635654449463, 2.529561996459961, 1.8392524719238281, 0.8106775283813477, 0.5657305717468262, 0.193756103515625, 0.5979804992675781, 1.7258529663085938, 1.7706971168518066, 0.31533145904541016, 0.25380849838256836, 2.4890971183776855, 2.068387031555176, 1.0898513793945312, 0.031491756439208984, 0.1496601104736328, 0.4373598098754883, 0.7995262145996094, 1.7281074523925781, 1.9289779663085938], "mean_td_error": 1.0756182670593262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 352.0, "diff_num_grad_updates_vs_sampler_policy": 351.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13340950012207, "actor_loss": -9.180268287658691, "critic_loss": 0.13736706972122192, "alpha_loss": -1.067168951034546, "alpha_value": 0.9000437259674072, "log_alpha_value": -0.10531193017959595, "target_entropy": -6.0, "policy_t": -0.006604066584259272, "mean_q": 5.523599147796631, "max_q": 6.152204990386963, "min_q": 4.976297855377197}, "td_error": [0.26387977600097656, 2.6086902618408203, 0.025094985961914062, 1.479288101196289, 1.8054113388061523, 0.2260420322418213, 0.9885449409484863, 1.8770527839660645, 0.4769163131713867, 1.1458685398101807, 0.3295612335205078, 1.207737922668457, 0.32706189155578613, 0.32376527786254883, 1.1896395683288574, 2.2211408615112305, 1.8595964908599854, 1.5529499053955078, 2.4314382076263428, 0.08063864707946777, 0.5822098255157471, 0.06234335899353027, 0.6633307933807373, 3.201127767562866, 1.3644766807556152, 1.0181732177734375, 0.019573688507080078, 1.6203315258026123, 0.22919511795043945, 1.5818290710449219, 2.3536489009857178, 0.1988072395324707, 0.9118905067443848, 0.8892757892608643, 0.15145158767700195, 0.8791847229003906, 0.28092217445373535, 2.058788537979126, 3.100942611694336, 1.5634841918945312, 2.1955418586730957, 0.5531697273254395, 0.8306310176849365, 1.4213082790374756, 1.5948326587677002, 0.0290372371673584, 0.35288119316101074, 1.0717549324035645, 3.260824680328369, 0.1320052146911621, 2.116356134414673, 0.9723577499389648, 0.6860098838806152, 0.32776355743408203, 1.134284496307373, 0.9961397647857666, 0.8142304420471191, 1.1245718002319336, 1.99006986618042, 0.30182313919067383, 1.9206666946411133, 1.0529417991638184, 0.8861038684844971, 0.5560636520385742, 1.1514396667480469, 0.2253427505493164, 1.2721495628356934, 0.5827608108520508, 1.0809345245361328, 0.30814123153686523, 0.640927791595459, 2.748814105987549, 1.3606250286102295, 0.9936566352844238, 1.3945109844207764, 0.410797119140625, 0.4622199535369873, 0.48709535598754883, 1.9070353507995605, 1.1915202140808105, 1.9787437915802002, 1.0705387592315674, 2.6427462100982666, 0.3576071262359619, 0.11944413185119629, 1.4508984088897705], "mean_td_error": 1.1082630157470703, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 352.0, "diff_num_grad_updates_vs_sampler_policy": 351.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100513458251953, "actor_loss": -9.1563138961792, "critic_loss": 0.1760510504245758, "alpha_loss": -1.0637985467910767, "alpha_value": 0.9000353813171387, "log_alpha_value": -0.1053212359547615, "target_entropy": -6.0, "policy_t": -0.007701306603848934, "mean_q": 5.497713565826416, "max_q": 5.924637317657471, "min_q": 5.165126800537109}, "td_error": [1.1215407848358154, 0.5806422233581543, 2.0763747692108154, 0.04929828643798828, 1.1343994140625, 0.7006196975708008, 2.303105354309082, 0.4789571762084961, 1.3938252925872803, 0.769169807434082, 0.03149008750915527, 0.1311202049255371, 2.3342792987823486, 3.33072566986084, 2.0472493171691895, 1.2473034858703613, 1.6117312908172607, 1.8238952159881592, 1.0408010482788086, 2.039639949798584, 0.8280971050262451, 1.333892583847046, 0.5732326507568359, 0.024740219116210938, 0.5006892681121826, 1.9916300773620605, 0.6596055030822754, 0.16599130630493164, 0.6608071327209473, 0.7984733581542969, 1.152669906616211, 2.8817732334136963, 0.49836182594299316, 1.1597857475280762, 0.5867276191711426, 1.4526655673980713, 0.2322847843170166, 1.4649982452392578, 1.1583607196807861, 2.606214761734009, 0.14451050758361816, 0.4400146007537842, 1.9439585208892822, 1.1530470848083496, 0.014687538146972656, 1.311582088470459, 0.5262563228607178, 0.6836638450622559, 0.07223653793334961, 0.9099304676055908, 0.9282879829406738, 0.40146446228027344, 1.4951868057250977, 1.2508618831634521, 2.5890021324157715, 2.265547275543213, 1.6714870929718018, 1.9803078174591064, 0.5495367050170898, 2.4040422439575195, 1.1324543952941895, 0.3233637809753418, 1.1752150058746338, 0.6551346778869629, 1.053168773651123, 1.8084208965301514, 1.436305046081543, 2.855457305908203, 2.669574737548828, 1.4079341888427734, 0.334209680557251, 1.2826311588287354, 1.1794171333312988, 2.5075509548187256, 0.9730141162872314, 1.5675714015960693, 1.5454308986663818, 0.14649057388305664, 0.2211148738861084, 1.5527827739715576, 0.11689496040344238, 0.8677706718444824, 2.234135866165161, 1.167372226715088, 0.9601869583129883, 0.4809987545013428], "mean_td_error": 1.1786904335021973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 352.0, "diff_num_grad_updates_vs_sampler_policy": 351.0}}, "num_env_steps_sampled": 3962, "num_env_steps_trained": 90816, "num_agent_steps_sampled": 11886, "num_agent_steps_trained": 90816, "last_target_update_ts": 3962, "num_target_updates": 352}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11886, "num_agent_steps_trained": 90816, "num_env_steps_sampled": 3962, "num_env_steps_trained": 90816, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 56.08730835327922, "num_env_steps_trained_throughput_per_sec": 2067.217936449434, "timesteps_total": 3962, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 11886, "timers": {"training_iteration_time_ms": 125.832, "sample_time_ms": 22.223, "load_time_ms": 0.362, "load_throughput": 713288.796, "learn_time_ms": 22.166, "learn_throughput": 11639.704, "synch_weights_time_ms": 12.507}, "counters": {"num_env_steps_sampled": 3962, "num_env_steps_trained": 90816, "num_agent_steps_sampled": 11886, "num_agent_steps_trained": 90816, "last_target_update_ts": 3962, "num_target_updates": 352}, "done": false, "episodes_total": 0, "training_iteration": 27, "trial_id": "db258_00000", "date": "2023-11-16_21-48-46", "timestamp": 1700200126, "time_this_iter_s": 1.8813188076019287, "time_total_s": 40.526893854141235, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 40.526893854141235, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 49.9, "ram_util_percent": 62.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.022099494934082, "actor_loss": -12.368885040283203, "critic_loss": 0.10649818181991577, "alpha_loss": -1.0993973016738892, "alpha_value": 0.8961053490638733, "log_alpha_value": -0.10969729721546173, "target_entropy": -6.0, "policy_t": -0.00936946552246809, "mean_q": 8.794429779052734, "max_q": 9.901224136352539, "min_q": 7.809473514556885}, "td_error": [0.422548770904541, 0.6490826606750488, 1.2504806518554688, 0.30930233001708984, 0.6957306861877441, 2.9665966033935547, 0.41527843475341797, 0.8821020126342773, 0.7257552146911621, 1.350771427154541, 1.220069408416748, 0.41317129135131836, 0.20062637329101562, 2.6260733604431152, 1.5848360061645508, 1.6211771965026855, 0.8454074859619141, 0.9988164901733398, 1.1035494804382324, 0.978813648223877, 0.4861459732055664, 0.5246219635009766, 1.9922308921813965, 2.2202072143554688, 0.8961944580078125, 2.035229206085205, 1.6006560325622559, 0.8762249946594238, 0.3561248779296875, 1.2066764831542969, 0.8182897567749023, 1.7306599617004395, 0.9006390571594238, 0.8652465343475342, 1.2726449966430664, 0.04025840759277344, 2.2609972953796387, 0.09275293350219727, 1.5256986618041992, 0.8403539657592773, 0.6857028007507324, 0.7402505874633789, 0.8819360733032227, 0.6943421363830566, 0.7081117630004883, 0.33541345596313477, 1.5459842681884766, 0.1628894805908203, 1.0691328048706055, 1.0292620658874512, 0.8280301094055176, 0.5180044174194336, 0.5733828544616699, 1.6236910820007324, 0.5819988250732422, 0.0759434700012207, 2.1404848098754883, 0.5243206024169922, 2.0383567810058594, 1.1429500579833984, 0.38088464736938477, 0.35587453842163086, 1.765364646911621, 1.773531436920166, 1.6264114379882812, 1.9415292739868164, 1.9095087051391602, 1.0609893798828125, 0.09328365325927734, 1.6610589027404785, 1.3371586799621582, 2.6654133796691895, 1.323136806488037, 1.4609556198120117, 1.2675175666809082, 2.200932502746582, 1.4919180870056152, 0.7841415405273438, 1.3782320022583008, 1.582329273223877, 0.8115549087524414, 2.455883502960205, 2.1618103981018066, 1.406461238861084, 1.9693970680236816, 0.5681400299072266], "mean_td_error": 1.1527401208877563, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 366.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076821327209473, "actor_loss": -9.23733901977539, "critic_loss": 0.1414731740951538, "alpha_loss": -1.1065497398376465, "alpha_value": 0.8960031270980835, "log_alpha_value": -0.10981138795614243, "target_entropy": -6.0, "policy_t": -0.01732645556330681, "mean_q": 5.658050060272217, "max_q": 6.278222560882568, "min_q": 5.151305675506592}, "td_error": [0.2777695655822754, 1.5855367183685303, 1.2573497295379639, 1.219390630722046, 0.21802806854248047, 0.49111318588256836, 0.19493389129638672, 1.644350528717041, 1.7810790538787842, 1.2400810718536377, 1.3388776779174805, 0.6688816547393799, 1.7142994403839111, 0.8964447975158691, 0.10866665840148926, 0.6160674095153809, 1.7919209003448486, 0.9493067264556885, 2.8073253631591797, 0.8150339126586914, 1.164020299911499, 0.9921185970306396, 0.9877059459686279, 1.0127067565917969, 2.045041561126709, 0.8521552085876465, 0.7156074047088623, 0.4654197692871094, 0.5895071029663086, 0.3655099868774414, 1.1805419921875, 1.0454487800598145, 1.3707635402679443, 0.7443039417266846, 1.5868186950683594, 1.3811750411987305, 2.3288185596466064, 1.4527711868286133, 0.5983612537384033, 1.1681838035583496, 1.5594046115875244, 1.2406620979309082, 0.4862549304962158, 0.29226064682006836, 0.6758110523223877, 0.5724189281463623, 1.555741310119629, 0.7334263324737549, 1.7087454795837402, 0.8841700553894043, 2.4604053497314453, 1.7764568328857422, 2.1182637214660645, 0.40494680404663086, 2.3365707397460938, 0.21514606475830078, 1.0280630588531494, 0.8083827495574951, 1.2693729400634766, 1.252082109451294, 0.5336205959320068, 1.9215970039367676, 1.8596117496490479, 1.7673726081848145, 1.988086462020874, 0.9641127586364746, 1.1248044967651367, 2.412869453430176, 1.5142822265625, 0.5507888793945312, 1.7154662609100342, 0.781745433807373, 0.49115419387817383, 0.7946562767028809, 0.7277600765228271, 1.0278477668762207, 0.4464266300201416, 1.0535576343536377, 0.9076216220855713, 0.9043245315551758, 1.533844232559204, 1.5380630493164062, 0.9693410396575928, 0.847930908203125, 1.3223686218261719, 0.7898013591766357], "mean_td_error": 1.134082317352295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 366.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110453605651855, "actor_loss": -9.283037185668945, "critic_loss": 0.16981416940689087, "alpha_loss": -1.1103801727294922, "alpha_value": 0.8959909677505493, "log_alpha_value": -0.10982494056224823, "target_entropy": -6.0, "policy_t": 0.008745414204895496, "mean_q": 5.668038368225098, "max_q": 6.233208656311035, "min_q": 5.373147010803223}, "td_error": [0.07921957969665527, 0.6853973865509033, 0.9343605041503906, 0.922935962677002, 0.37921643257141113, 0.46284985542297363, 0.6103577613830566, 1.9233248233795166, 1.6713688373565674, 0.26170969009399414, 1.343813419342041, 1.1751792430877686, 0.6806056499481201, 1.1972341537475586, 0.0856475830078125, 1.4783556461334229, 0.9497785568237305, 0.5614888668060303, 1.6204566955566406, 0.16116595268249512, 1.1495399475097656, 1.5472354888916016, 0.10680437088012695, 0.8613951206207275, 0.7353570461273193, 0.5188205242156982, 1.7599704265594482, 3.5704691410064697, 1.085228443145752, 1.3208556175231934, 0.9722974300384521, 1.6468143463134766, 2.045196056365967, 1.5304656028747559, 2.606627941131592, 1.074993371963501, 2.718104124069214, 2.5302681922912598, 1.721564531326294, 1.0714385509490967, 2.5824506282806396, 2.0226738452911377, 1.4293429851531982, 0.6217906475067139, 0.5202045440673828, 1.7282536029815674, 2.2911171913146973, 1.4984111785888672, 0.3082730770111084, 0.506056547164917, 1.0072777271270752, 1.135960578918457, 2.9511289596557617, 0.0599210262298584, 1.1711320877075195, 1.3248224258422852, 1.6077957153320312, 0.7348833084106445, 1.3020195960998535, 0.8011643886566162, 1.8750674724578857, 1.4195830821990967, 0.5274097919464111, 0.8144855499267578, 2.864370584487915, 1.5792763233184814, 0.6404263973236084, 2.0484743118286133, 1.235548973083496, 1.3630976676940918, 0.4395763874053955, 1.6512928009033203, 0.7430651187896729, 0.02995777130126953, 0.7070460319519043, 1.015495777130127, 0.31891369819641113, 0.056025028228759766, 1.1140141487121582, 0.5223054885864258, 0.9878482818603516, 1.6654744148254395, 1.8563730716705322, 1.1114552021026611, 0.6391081809997559, 0.528012752532959], "mean_td_error": 1.1757709980010986, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 366.0}}, "num_env_steps_sampled": 4067, "num_env_steps_trained": 94686, "num_agent_steps_sampled": 12201, "num_agent_steps_trained": 94686, "last_target_update_ts": 4067, "num_target_updates": 367}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12201, "num_agent_steps_trained": 94686, "num_env_steps_sampled": 4067, "num_env_steps_trained": 94686, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 62.80249343635521, "num_env_steps_trained_throughput_per_sec": 2314.720472368521, "timesteps_total": 4067, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 12201, "timers": {"training_iteration_time_ms": 115.725, "sample_time_ms": 19.726, "load_time_ms": 0.324, "load_throughput": 795450.185, "learn_time_ms": 20.327, "learn_throughput": 12692.555, "synch_weights_time_ms": 12.26}, "counters": {"num_env_steps_sampled": 4067, "num_env_steps_trained": 94686, "num_agent_steps_sampled": 12201, "num_agent_steps_trained": 94686, "last_target_update_ts": 4067, "num_target_updates": 367}, "done": false, "episodes_total": 0, "training_iteration": 28, "trial_id": "db258_00000", "date": "2023-11-16_21-48-48", "timestamp": 1700200128, "time_this_iter_s": 1.6851439476013184, "time_total_s": 42.212037801742554, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060cc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 42.212037801742554, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 40.5, "ram_util_percent": 62.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.029624938964844, "actor_loss": -12.789993286132812, "critic_loss": 0.0983877182006836, "alpha_loss": -1.1453126668930054, "alpha_value": 0.8920857906341553, "log_alpha_value": -0.11419297754764557, "target_entropy": -6.0, "policy_t": -0.01658019796013832, "mean_q": 9.26457405090332, "max_q": 10.130345344543457, "min_q": 8.306568145751953}, "td_error": [1.7133631706237793, 1.5045843124389648, 1.9156103134155273, 1.7180404663085938, 1.0008649826049805, 1.5762505531311035, 0.48348522186279297, 1.3827934265136719, 0.3755369186401367, 0.928980827331543, 1.1205053329467773, 1.0970239639282227, 1.5567684173583984, 0.5202670097351074, 2.427338123321533, 2.6261181831359863, 0.3046865463256836, 0.5449323654174805, 0.2062673568725586, 1.3902788162231445, 1.3047375679016113, 2.744739055633545, 0.6969137191772461, 0.37628793716430664, 1.0971808433532715, 0.791750431060791, 0.7449274063110352, 0.19409751892089844, 1.3210821151733398, 0.8431134223937988, 0.32860660552978516, 0.100616455078125, 1.257554054260254, 0.9398937225341797, 0.14134502410888672, 0.8025302886962891, 0.6357054710388184, 1.9491844177246094, 1.4594101905822754, 1.3403840065002441, 1.5068321228027344, 0.9182248115539551, 0.3546619415283203, 0.8935890197753906, 0.6221151351928711, 1.7035813331604004, 1.0076704025268555, 1.1667442321777344, 3.105281352996826, 0.9841675758361816, 1.5731258392333984, 3.3833413124084473, 0.25545167922973633, 0.5060043334960938, 0.7129197120666504, 2.571531295776367, 0.0743718147277832, 0.4806814193725586, 1.2277603149414062, 0.5581874847412109, 1.1170568466186523, 1.174572467803955, 2.0447750091552734, 0.7494239807128906, 0.5185976028442383, 0.7373714447021484, 0.7566547393798828, 1.6242399215698242, 0.7784833908081055, 0.9298033714294434, 1.4786977767944336, 0.4301609992980957, 1.4634203910827637, 2.4442057609558105, 1.7967486381530762, 0.689849853515625, 0.9588284492492676, 0.6517024040222168, 1.168332576751709, 1.072662353515625, 1.074244499206543, 0.7383017539978027, 0.11033153533935547, 1.1915860176086426, 1.9966754913330078, 0.7288546562194824], "mean_td_error": 1.1104137897491455, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 382.0, "diff_num_grad_updates_vs_sampler_policy": 381.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.142026901245117, "actor_loss": -9.591413497924805, "critic_loss": 0.14360958337783813, "alpha_loss": -1.1593883037567139, "alpha_value": 0.8919767141342163, "log_alpha_value": -0.11431524902582169, "target_entropy": -6.0, "policy_t": 0.00984887219965458, "mean_q": 6.004085063934326, "max_q": 6.521412372589111, "min_q": 5.618617057800293}, "td_error": [0.9494459629058838, 1.9931700229644775, 1.8197987079620361, 2.12026047706604, 0.15928101539611816, 2.13722562789917, 2.0548553466796875, 1.156054973602295, 0.1390697956085205, 0.3633706569671631, 1.234544038772583, 0.10488247871398926, 0.05769157409667969, 1.8003277778625488, 1.6685774326324463, 1.1838102340698242, 0.6003038883209229, 0.7605278491973877, 1.1977648735046387, 1.4986166954040527, 0.9011325836181641, 1.452303409576416, 0.9223287105560303, 1.3712689876556396, 0.999464750289917, 0.9651997089385986, 1.8348426818847656, 1.0548100471496582, 0.5595893859863281, 1.5118708610534668, 2.9508137702941895, 1.612248420715332, 1.0346424579620361, 1.0066652297973633, 0.9350333213806152, 1.131950855255127, 1.8903088569641113, 0.6072876453399658, 1.7200326919555664, 1.4796202182769775, 0.6685285568237305, 0.4924192428588867, 0.2705237865447998, 1.4947826862335205, 2.1246120929718018, 0.27434825897216797, 0.10531425476074219, 0.8524835109710693, 2.1803925037384033, 0.17385601997375488, 1.4052085876464844, 1.3958649635314941, 1.6746845245361328, 0.3954939842224121, 0.45319557189941406, 0.9030678272247314, 1.9416236877441406, 2.220165729522705, 2.0539071559906006, 0.416881799697876, 0.12259268760681152, 0.9860284328460693, 0.3054513931274414, 0.5319118499755859, 2.6656711101531982, 1.9137060642242432, 1.146897315979004, 0.9152407646179199, 0.22531747817993164, 0.2819175720214844, 0.045495033264160156, 0.6666319370269775, 1.9894039630889893, 0.19355392456054688, 0.6146705150604248, 0.9156928062438965, 1.4647488594055176, 2.7477822303771973, 0.3100926876068115, 2.206953525543213, 2.626173496246338, 0.4519481658935547, 1.7965772151947021, 0.08930826187133789, 1.2056457996368408, 1.2953236103057861], "mean_td_error": 1.14131498336792, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 382.0, "diff_num_grad_updates_vs_sampler_policy": 381.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14904499053955, "actor_loss": -9.609732627868652, "critic_loss": 0.16020417213439941, "alpha_loss": -1.1603409051895142, "alpha_value": 0.8919634819030762, "log_alpha_value": -0.11433005332946777, "target_entropy": -6.0, "policy_t": 0.015420638956129551, "mean_q": 5.964174270629883, "max_q": 6.444674968719482, "min_q": 5.647524356842041}, "td_error": [0.9025731086730957, 0.5801711082458496, 0.563164472579956, 0.4167206287384033, 2.318708658218384, 1.1568543910980225, 0.46223974227905273, 1.2470898628234863, 1.2330360412597656, 1.480499267578125, 0.6031811237335205, 0.5390305519104004, 0.9623894691467285, 1.2992057800292969, 0.4394958019256592, 0.6789407730102539, 1.7368197441101074, 0.37395668029785156, 3.076616048812866, 1.218369483947754, 2.232654094696045, 0.7390198707580566, 0.22078490257263184, 2.685206890106201, 0.2716400623321533, 1.4609129428863525, 1.925140619277954, 1.184312105178833, 0.7000603675842285, 0.024732351303100586, 1.5859785079956055, 1.1381924152374268, 1.896141529083252, 1.5411913394927979, 0.2755000591278076, 1.352132797241211, 1.7933135032653809, 1.757669448852539, 0.18187427520751953, 1.434518814086914, 0.8729517459869385, 0.13000273704528809, 1.8268930912017822, 2.224027633666992, 0.6883847713470459, 1.3532016277313232, 1.3097224235534668, 1.0271923542022705, 0.5782685279846191, 0.1892681121826172, 2.389962673187256, 0.29849696159362793, 1.4080047607421875, 1.2161376476287842, 0.9321370124816895, 1.8446850776672363, 0.04246830940246582, 1.284874439239502, 0.3264448642730713, 0.5156424045562744, 0.29441380500793457, 1.9371333122253418, 0.5755002498626709, 0.1108546257019043, 0.3820040225982666, 0.36251091957092285, 0.67303466796875, 2.5165276527404785, 0.8958010673522949, 0.9105520248413086, 1.3289082050323486, 0.6283071041107178, 0.2745661735534668, 0.9166452884674072, 0.7452700138092041, 0.8665509223937988, 0.8867638111114502, 0.3161330223083496, 3.0772314071655273, 0.6768760681152344, 1.0218746662139893, 3.085516929626465, 0.6657693386077881, 1.0943870544433594, 2.5759549140930176, 1.6636226177215576], "mean_td_error": 1.100366473197937, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 382.0, "diff_num_grad_updates_vs_sampler_policy": 381.0}}, "num_env_steps_sampled": 4172, "num_env_steps_trained": 98556, "num_agent_steps_sampled": 12516, "num_agent_steps_trained": 98556, "last_target_update_ts": 4172, "num_target_updates": 382}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12516, "num_agent_steps_trained": 98556, "num_env_steps_sampled": 4172, "num_env_steps_trained": 98556, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 61.437720084606234, "num_env_steps_trained_throughput_per_sec": 2264.418825975487, "timesteps_total": 4172, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 12516, "timers": {"training_iteration_time_ms": 103.994, "sample_time_ms": 16.532, "load_time_ms": 0.313, "load_throughput": 825486.637, "learn_time_ms": 18.059, "learn_throughput": 14286.38, "synch_weights_time_ms": 10.2}, "counters": {"num_env_steps_sampled": 4172, "num_env_steps_trained": 98556, "num_agent_steps_sampled": 12516, "num_agent_steps_trained": 98556, "last_target_update_ts": 4172, "num_target_updates": 382}, "done": false, "episodes_total": 0, "training_iteration": 29, "trial_id": "db258_00000", "date": "2023-11-16_21-48-49", "timestamp": 1700200129, "time_this_iter_s": 1.7171730995178223, "time_total_s": 43.929210901260376, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 43.929210901260376, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 45.400000000000006, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089219093322754, "actor_loss": -12.833792686462402, "critic_loss": 0.10776165127754211, "alpha_loss": -1.1974900960922241, "alpha_value": 0.8880829811096191, "log_alpha_value": -0.11869006603956223, "target_entropy": -6.0, "policy_t": -0.03558763116598129, "mean_q": 9.237668991088867, "max_q": 10.329617500305176, "min_q": 8.419463157653809}, "td_error": [1.4144768714904785, 1.155322551727295, 0.4644031524658203, 1.1040854454040527, 1.5122451782226562, 0.8577108383178711, 1.342432975769043, 0.42730045318603516, 1.719308853149414, 0.509028434753418, 1.8499197959899902, 1.3295764923095703, 1.512629508972168, 0.40810346603393555, 0.7310171127319336, 1.2537779808044434, 0.7106742858886719, 1.0596981048583984, 0.6207594871520996, 1.213895320892334, 1.912792682647705, 1.3197474479675293, 2.3719358444213867, 0.5976352691650391, 0.19696617126464844, 1.5636310577392578, 0.7695918083190918, 0.39924144744873047, 1.01930570602417, 1.6368179321289062, 0.4055972099304199, 0.39542675018310547, 2.0035324096679688, 1.4260063171386719, 1.8597068786621094, 0.32335853576660156, 0.3337821960449219, 1.4107227325439453, 0.7373900413513184, 0.22681617736816406, 1.091883659362793, 0.9300918579101562, 1.5590782165527344, 1.5503153800964355, 0.48534250259399414, 1.4781684875488281, 2.78566312789917, 1.7119712829589844, 1.7674121856689453, 1.3934540748596191, 1.6751103401184082, 1.9049010276794434, 1.6199960708618164, 0.6738872528076172, 0.22166872024536133, 1.4722881317138672, 0.24660587310791016, 1.124995231628418, 1.514235496520996, 0.09158086776733398, 1.190112590789795, 1.9711875915527344, 1.5979690551757812, 1.3231287002563477, 0.37644100189208984, 1.3601946830749512, 1.631901741027832, 1.7562541961669922, 0.899411678314209, 1.6923885345458984, 1.0262336730957031, 1.2256035804748535, 0.3972601890563965, 0.0944356918334961, 2.915358066558838, 0.09379339218139648, 0.70928955078125, 2.3279848098754883, 1.2005982398986816, 2.188365936279297, 0.8655180931091309, 0.7418808937072754, 1.4986529350280762, 1.0263519287109375, 0.7190895080566406, 1.780280590057373], "mean_td_error": 1.162961721420288, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 397.0, "diff_num_grad_updates_vs_sampler_policy": 396.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050569534301758, "actor_loss": -9.276801109313965, "critic_loss": 0.12200357764959335, "alpha_loss": -1.1942505836486816, "alpha_value": 0.8879638910293579, "log_alpha_value": -0.11882416903972626, "target_entropy": -6.0, "policy_t": -0.029715420678257942, "mean_q": 5.7235565185546875, "max_q": 6.172050476074219, "min_q": 5.19887113571167}, "td_error": [0.5379989147186279, 1.6224188804626465, 0.5936613082885742, 0.24568533897399902, 0.9261579513549805, 1.6204867362976074, 1.0290908813476562, 0.9353127479553223, 1.093144416809082, 0.09432077407836914, 0.49150943756103516, 1.3212196826934814, 1.549304485321045, 0.09558701515197754, 0.2645249366760254, 2.0088326930999756, 0.6011996269226074, 0.7310330867767334, 0.6286909580230713, 1.1080529689788818, 0.8259444236755371, 0.25214076042175293, 2.003690481185913, 1.118046760559082, 1.1191308498382568, 1.3183908462524414, 0.8065297603607178, 1.616487741470337, 1.4285998344421387, 1.693720817565918, 1.2122457027435303, 1.0981111526489258, 1.2925102710723877, 0.7935128211975098, 1.4239346981048584, 1.0652284622192383, 0.6203951835632324, 0.9149391651153564, 1.595287561416626, 1.1776678562164307, 1.514173984527588, 0.09238815307617188, 0.9731800556182861, 0.8290207386016846, 0.4998290538787842, 1.4432106018066406, 0.0956277847290039, 0.6306500434875488, 0.8645589351654053, 2.2179672718048096, 0.16423535346984863, 1.8041489124298096, 0.6650059223175049, 2.3192787170410156, 0.9592609405517578, 1.7825398445129395, 1.2629685401916504, 0.2995631694793701, 0.009872913360595703, 0.18601036071777344, 1.2649204730987549, 0.4396951198577881, 1.2480311393737793, 1.2100555896759033, 0.7286486625671387, 2.044841766357422, 0.44830322265625, 0.59912109375, 1.778193712234497, 0.7724885940551758, 1.4246172904968262, 1.0900278091430664, 0.5420551300048828, 0.8649158477783203, 0.8668015003204346, 0.7957494258880615, 1.6553969383239746, 0.448822021484375, 1.6025781631469727, 0.5459048748016357, 0.5529208183288574, 0.4781978130340576, 2.5636181831359863, 0.9334859848022461, 1.121887445449829, 1.5603036880493164], "mean_td_error": 1.0124398469924927, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 397.0, "diff_num_grad_updates_vs_sampler_policy": 396.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.147345542907715, "actor_loss": -9.53480339050293, "critic_loss": 0.15286538004875183, "alpha_loss": -1.2058688402175903, "alpha_value": 0.887953519821167, "log_alpha_value": -0.11883588135242462, "target_entropy": -6.0, "policy_t": 0.02371140383183956, "mean_q": 5.880984783172607, "max_q": 6.342418670654297, "min_q": 5.480547904968262}, "td_error": [0.8683052062988281, 1.538151502609253, 1.4049656391143799, 1.0625219345092773, 0.057984352111816406, 0.7574422359466553, 1.6543726921081543, 1.8725638389587402, 0.8610057830810547, 0.35967159271240234, 0.5356040000915527, 0.799910306930542, 1.0511727333068848, 0.4574892520904541, 0.043776512145996094, 1.5431220531463623, 0.8425862789154053, 0.9641842842102051, 0.7086925506591797, 1.1596980094909668, 0.5373060703277588, 2.0336661338806152, 0.7329344749450684, 1.0102338790893555, 1.8184876441955566, 0.7369740009307861, 1.3677024841308594, 0.46123576164245605, 2.5123202800750732, 1.5453824996948242, 1.3456709384918213, 1.2561960220336914, 1.0762996673583984, 1.5770845413208008, 0.25029850006103516, 0.821157693862915, 2.3462114334106445, 1.707763433456421, 1.0692262649536133, 1.360750436782837, 0.7955656051635742, 0.6349775791168213, 0.47345423698425293, 0.6099610328674316, 2.7782046794891357, 0.4312262535095215, 1.8153045177459717, 1.1830940246582031, 1.7788467407226562, 0.6246654987335205, 0.8825473785400391, 1.2276322841644287, 0.9231297969818115, 0.8698294162750244, 1.333116054534912, 1.1576154232025146, 2.4942476749420166, 1.5548498630523682, 1.0723373889923096, 0.7204720973968506, 0.933826208114624, 0.6885888576507568, 1.3824212551116943, 0.6318771839141846, 1.8685383796691895, 0.7855496406555176, 1.1072139739990234, 0.5750796794891357, 0.7007260322570801, 0.9046754837036133, 1.452589511871338, 0.5483431816101074, 0.707111120223999, 1.1117143630981445, 0.9061357975006104, 1.0966126918792725, 1.3342509269714355, 0.5714230537414551, 1.7225894927978516, 1.5908470153808594, 2.1586239337921143, 1.9098865985870361, 0.7086639404296875, 0.4118986129760742, 0.24091625213623047, 0.7065138816833496], "mean_td_error": 1.095672369003296, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 397.0, "diff_num_grad_updates_vs_sampler_policy": 396.0}}, "num_env_steps_sampled": 4277, "num_env_steps_trained": 102426, "num_agent_steps_sampled": 12831, "num_agent_steps_trained": 102426, "last_target_update_ts": 4277, "num_target_updates": 397}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12831, "num_agent_steps_trained": 102426, "num_env_steps_sampled": 4277, "num_env_steps_trained": 102426, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.06267487927968, "num_env_steps_trained_throughput_per_sec": 2508.5957312648798, "timesteps_total": 4277, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 12831, "timers": {"training_iteration_time_ms": 102.947, "sample_time_ms": 15.372, "load_time_ms": 0.315, "load_throughput": 819299.237, "learn_time_ms": 17.739, "learn_throughput": 14544.197, "synch_weights_time_ms": 10.204}, "counters": {"num_env_steps_sampled": 4277, "num_env_steps_trained": 102426, "num_agent_steps_sampled": 12831, "num_agent_steps_trained": 102426, "last_target_update_ts": 4277, "num_target_updates": 397}, "done": false, "episodes_total": 0, "training_iteration": 30, "trial_id": "db258_00000", "date": "2023-11-16_21-48-51", "timestamp": 1700200131, "time_this_iter_s": 1.5547840595245361, "time_total_s": 45.48399496078491, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 45.48399496078491, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 31.433333333333326, "ram_util_percent": 62.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.032979011535645, "actor_loss": -13.216880798339844, "critic_loss": 0.10725672543048859, "alpha_loss": -1.235930323600769, "alpha_value": 0.8840985298156738, "log_alpha_value": -0.12318677455186844, "target_entropy": -6.0, "policy_t": -0.02456594444811344, "mean_q": 9.700959205627441, "max_q": 10.785670280456543, "min_q": 8.680376052856445}, "td_error": [0.17638587951660156, 1.1456565856933594, 1.3293190002441406, 2.33402156829834, 1.4448637962341309, 2.259312152862549, 0.011569976806640625, 1.5430231094360352, 1.0970187187194824, 1.1338481903076172, 0.9545211791992188, 1.4094977378845215, 2.645150661468506, 1.2386865615844727, 0.558568000793457, 2.528533935546875, 1.3491392135620117, 0.15945959091186523, 2.0570321083068848, 1.5994572639465332, 0.22974491119384766, 0.4761319160461426, 0.8270635604858398, 2.1491503715515137, 0.3491353988647461, 0.9669284820556641, 1.274247646331787, 0.7690296173095703, 1.6125035285949707, 0.48822021484375, 0.951167106628418, 0.7437596321105957, 2.560601234436035, 1.6796531677246094, 0.7202720642089844, 0.42955780029296875, 0.7126941680908203, 3.1713080406188965, 1.9864206314086914, 0.6263408660888672, 0.6317777633666992, 1.5066299438476562, 1.3247404098510742, 0.3584861755371094, 0.5718140602111816, 0.010033130645751953, 1.0400261878967285, 0.9892473220825195, 0.8932991027832031, 3.3351149559020996, 1.430851936340332, 0.7921600341796875, 0.5451564788818359, 0.9013051986694336, 1.6879830360412598, 0.7103886604309082, 1.0704984664916992, 0.9010024070739746, 0.5725312232971191, 1.0087151527404785, 1.0420551300048828, 0.30344247817993164, 2.054086685180664, 1.5931587219238281, 0.759467601776123, 0.9324512481689453, 1.1845464706420898, 0.9862298965454102, 2.2992348670959473, 1.8594770431518555, 1.100719928741455, 1.1560492515563965, 0.09326601028442383, 1.7943644523620605, 1.1855711936950684, 1.074075698852539, 1.265848159790039, 0.06547117233276367, 0.7195887565612793, 0.17955398559570312, 1.4009032249450684, 1.3195195198059082, 0.18586206436157227, 3.1547255516052246, 1.0550060272216797, 1.3894462585449219], "mean_td_error": 1.164359211921692, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 412.0, "diff_num_grad_updates_vs_sampler_policy": 411.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065746307373047, "actor_loss": -9.73483657836914, "critic_loss": 0.15631234645843506, "alpha_loss": -1.2413853406906128, "alpha_value": 0.8839739561080933, "log_alpha_value": -0.12332769483327866, "target_entropy": -6.0, "policy_t": -0.03297468647360802, "mean_q": 6.203332901000977, "max_q": 6.832200527191162, "min_q": 5.633244514465332}, "td_error": [1.35528564453125, 1.3089966773986816, 1.9454820156097412, 2.213411808013916, 0.7948355674743652, 0.7830688953399658, 1.9606881141662598, 0.3301570415496826, 0.5473418235778809, 1.7880859375, 1.8873140811920166, 0.09261107444763184, 2.020383358001709, 1.1236083507537842, 1.1712241172790527, 0.10897374153137207, 1.519902229309082, 0.7243225574493408, 1.7132530212402344, 0.8528432846069336, 1.0815649032592773, 1.213456153869629, 1.4538617134094238, 0.530543327331543, 0.584500789642334, 0.6033003330230713, 0.2971363067626953, 0.9904494285583496, 0.8588557243347168, 0.967801570892334, 1.549349308013916, 1.7555887699127197, 1.3326566219329834, 2.8305578231811523, 0.9733388423919678, 2.8245816230773926, 0.08452510833740234, 1.9240736961364746, 1.5520431995391846, 2.462411880493164, 1.6768670082092285, 1.6277592182159424, 0.025414466857910156, 2.103205919265747, 1.2461247444152832, 2.0995993614196777, 0.056617021560668945, 0.4658496379852295, 1.2889273166656494, 1.4116013050079346, 1.1311819553375244, 1.2978758811950684, 1.586564064025879, 1.3087520599365234, 1.6037623882293701, 0.9659059047698975, 3.077641725540161, 0.9989597797393799, 1.7723023891448975, 1.9296746253967285, 0.4469184875488281, 1.6633198261260986, 1.2138922214508057, 1.9536023139953613, 1.0254206657409668, 0.8939547538757324, 0.5897674560546875, 1.2034003734588623, 0.910376787185669, 0.1269826889038086, 1.5621140003204346, 0.4544961452484131, 0.38255906105041504, 0.33388853073120117, 0.4045252799987793, 0.42952895164489746, 1.5095510482788086, 1.3370823860168457, 1.5296332836151123, 1.0499131679534912, 1.997481346130371, 1.124114751815796, 0.833066463470459, 2.1287717819213867, 2.3714542388916016, 0.8630552291870117], "mean_td_error": 1.2340214252471924, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 412.0, "diff_num_grad_updates_vs_sampler_policy": 411.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.996820449829102, "actor_loss": -9.622249603271484, "critic_loss": 0.13565289974212646, "alpha_loss": -1.2330397367477417, "alpha_value": 0.8839602470397949, "log_alpha_value": -0.12334319204092026, "target_entropy": -6.0, "policy_t": -0.019734542816877365, "mean_q": 6.094874858856201, "max_q": 6.415217399597168, "min_q": 5.688259601593018}, "td_error": [0.9183580875396729, 1.0322043895721436, 0.8818721771240234, 2.0781147480010986, 1.426750898361206, 1.1129918098449707, 0.5144376754760742, 0.18682003021240234, 0.09719562530517578, 0.5015285015106201, 1.0184128284454346, 0.466480016708374, 1.3705086708068848, 1.8364169597625732, 0.5004386901855469, 1.0213966369628906, 1.6263372898101807, 2.0761423110961914, 0.45065927505493164, 0.17345666885375977, 1.5523200035095215, 0.4600672721862793, 1.5605194568634033, 0.06016111373901367, 0.23472070693969727, 1.0521516799926758, 3.0055973529815674, 1.2592155933380127, 1.3557124137878418, 1.022782325744629, 0.6201651096343994, 1.358198642730713, 2.2523183822631836, 0.9555540084838867, 1.1515617370605469, 0.3554801940917969, 1.062171459197998, 0.5566787719726562, 2.0295798778533936, 1.407599925994873, 1.3173084259033203, 0.06369566917419434, 0.6974647045135498, 0.87471604347229, 1.6938066482543945, 0.8062272071838379, 1.061403751373291, 1.2528584003448486, 0.12305450439453125, 0.8482823371887207, 1.2784569263458252, 1.9155685901641846, 1.3993122577667236, 0.5415389537811279, 0.418595552444458, 1.2935903072357178, 1.9952831268310547, 0.1408863067626953, 0.9701681137084961, 2.0830881595611572, 1.4310486316680908, 0.7886941432952881, 1.0931262969970703, 1.0137012004852295, 0.506035566329956, 1.8719937801361084, 1.1707444190979004, 0.6555085182189941, 0.35236382484436035, 0.10135388374328613, 0.24564743041992188, 1.8534889221191406, 0.5870769023895264, 1.2310223579406738, 0.29719090461730957, 0.8221969604492188, 0.7106673717498779, 0.6341590881347656, 1.2351975440979004, 0.49835991859436035, 0.4575352668762207, 1.0412631034851074, 0.8054392337799072, 0.10434722900390625, 0.40033626556396484, 0.703333854675293], "mean_td_error": 0.976630449295044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 412.0, "diff_num_grad_updates_vs_sampler_policy": 411.0}}, "num_env_steps_sampled": 4382, "num_env_steps_trained": 106296, "num_agent_steps_sampled": 13146, "num_agent_steps_trained": 106296, "last_target_update_ts": 4382, "num_target_updates": 412}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13146, "num_agent_steps_trained": 106296, "num_env_steps_sampled": 4382, "num_env_steps_trained": 106296, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.5753994089173, "num_env_steps_trained_throughput_per_sec": 2490.636149642952, "timesteps_total": 4382, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 13146, "timers": {"training_iteration_time_ms": 103.962, "sample_time_ms": 15.808, "load_time_ms": 0.317, "load_throughput": 813754.273, "learn_time_ms": 18.318, "learn_throughput": 14084.701, "synch_weights_time_ms": 9.66}, "counters": {"num_env_steps_sampled": 4382, "num_env_steps_trained": 106296, "num_agent_steps_sampled": 13146, "num_agent_steps_trained": 106296, "last_target_update_ts": 4382, "num_target_updates": 412}, "done": false, "episodes_total": 0, "training_iteration": 31, "trial_id": "db258_00000", "date": "2023-11-16_21-48-53", "timestamp": 1700200133, "time_this_iter_s": 1.563673973083496, "time_total_s": 47.04766893386841, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0614e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 47.04766893386841, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 33.5, "ram_util_percent": 62.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118999481201172, "actor_loss": -13.383609771728516, "critic_loss": 0.10119796544313431, "alpha_loss": -1.2919687032699585, "alpha_value": 0.8801372051239014, "log_alpha_value": -0.12767750024795532, "target_entropy": -6.0, "policy_t": 0.03037000447511673, "mean_q": 9.93404769897461, "max_q": 11.139825820922852, "min_q": 8.878726959228516}, "td_error": [0.058768272399902344, 1.883732795715332, 0.8920111656188965, 1.2820549011230469, 1.322495460510254, 0.8153953552246094, 2.766629219055176, 0.7176823616027832, 1.6925387382507324, 0.4237833023071289, 0.6095175743103027, 0.40834712982177734, 0.16945743560791016, 1.3095126152038574, 1.8604378700256348, 2.283163547515869, 0.9040098190307617, 1.8599486351013184, 0.2360692024230957, 0.18630266189575195, 1.309889793395996, 1.24107027053833, 0.037188053131103516, 0.46956348419189453, 0.5026178359985352, 0.9439220428466797, 0.03914499282836914, 0.5973186492919922, 1.3732209205627441, 1.2577786445617676, 1.2559137344360352, 1.1682257652282715, 1.0429096221923828, 0.4548625946044922, 0.15414762496948242, 0.7436890602111816, 0.8553590774536133, 1.2584376335144043, 0.3752298355102539, 1.9581007957458496, 1.0590486526489258, 1.1893272399902344, 0.7348346710205078, 1.3420333862304688, 1.5470342636108398, 2.0301437377929688, 1.1333208084106445, 1.491842269897461, 0.9314417839050293, 3.396516799926758, 0.5423259735107422, 1.6627850532531738, 2.1915030479431152, 1.778519630432129, 1.8236804008483887, 1.7485294342041016, 0.8439712524414062, 0.35980653762817383, 1.6764717102050781, 1.0956950187683105, 1.6277761459350586, 1.5250420570373535, 1.1894092559814453, 1.2612061500549316, 0.5851235389709473, 1.0860071182250977, 1.3664264678955078, 0.10728263854980469, 0.7259492874145508, 0.4549126625061035, 0.19592571258544922, 1.4029979705810547, 2.399521827697754, 1.8887457847595215, 0.9158258438110352, 0.6349058151245117, 1.2843985557556152, 0.4453392028808594, 1.5880722999572754, 2.2174034118652344, 1.124478816986084, 1.4823150634765625, 1.1651315689086914, 0.49500179290771484, 1.5459775924682617, 0.6045050621032715], "mean_td_error": 1.123476266860962, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 427.0, "diff_num_grad_updates_vs_sampler_policy": 426.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.020453453063965, "actor_loss": -9.561868667602539, "critic_loss": 0.13952317833900452, "alpha_loss": -1.280900478363037, "alpha_value": 0.8800042271614075, "log_alpha_value": -0.12782858312129974, "target_entropy": -6.0, "policy_t": 0.012309669516980648, "mean_q": 5.978224754333496, "max_q": 6.528002738952637, "min_q": 5.572962284088135}, "td_error": [0.5779268741607666, 0.6877121925354004, 2.2223479747772217, 1.1260554790496826, 0.5609230995178223, 0.2756171226501465, 1.4860846996307373, 2.0110297203063965, 0.12237882614135742, 1.0259928703308105, 0.7825655937194824, 1.3121204376220703, 2.520866632461548, 1.5246696472167969, 0.7713069915771484, 1.9592890739440918, 0.030719995498657227, 0.6037118434906006, 1.3969533443450928, 1.497129201889038, 0.8910307884216309, 1.3438999652862549, 0.3904690742492676, 0.6925559043884277, 1.7577593326568604, 0.6664807796478271, 1.844801425933838, 0.22010326385498047, 0.3437027931213379, 0.8939061164855957, 1.5547640323638916, 1.4208426475524902, 1.089794635772705, 1.2935867309570312, 0.620858907699585, 2.0531814098358154, 0.5991930961608887, 0.8344764709472656, 2.448080062866211, 0.47972941398620605, 1.0142498016357422, 1.5233843326568604, 1.310793161392212, 2.1570541858673096, 2.089672327041626, 1.1440787315368652, 2.7823028564453125, 0.6430339813232422, 0.5549354553222656, 1.9406516551971436, 0.504075288772583, 0.8832516670227051, 2.327737808227539, 0.6773560047149658, 0.05848956108093262, 1.5808966159820557, 1.9234426021575928, 1.0220129489898682, 1.8990662097930908, 0.7791261672973633, 1.3356373310089111, 0.5501527786254883, 0.6614079475402832, 1.7111830711364746, 1.5578656196594238, 0.3816225528717041, 1.090451717376709, 1.762911319732666, 1.0153224468231201, 0.6172618865966797, 1.2898015975952148, 2.3574655055999756, 1.5974845886230469, 0.443941593170166, 0.9151241779327393, 1.445612907409668, 0.12766051292419434, 0.16113924980163574, 1.6748158931732178, 1.2097954750061035, 0.40093493461608887, 0.2223811149597168, 0.45917558670043945, 0.3803863525390625, 1.2478101253509521, 1.3681743144989014], "mean_td_error": 1.1248342990875244, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 427.0, "diff_num_grad_updates_vs_sampler_policy": 426.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057113647460938, "actor_loss": -9.886720657348633, "critic_loss": 0.12969660758972168, "alpha_loss": -1.2857625484466553, "alpha_value": 0.8799887895584106, "log_alpha_value": -0.12784609198570251, "target_entropy": -6.0, "policy_t": -0.02727304771542549, "mean_q": 6.362000942230225, "max_q": 6.735964298248291, "min_q": 6.031723976135254}, "td_error": [0.8637022972106934, 0.5737671852111816, 1.1643218994140625, 0.0912468433380127, 0.36469030380249023, 1.0509562492370605, 0.35837244987487793, 0.9663217067718506, 0.6971297264099121, 1.209275245666504, 0.4987754821777344, 0.6946709156036377, 1.9018335342407227, 1.1681787967681885, 2.2871315479278564, 0.9931201934814453, 1.14646577835083, 1.3233473300933838, 0.7065231800079346, 0.08951377868652344, 0.48897743225097656, 1.0528056621551514, 0.7197742462158203, 0.6756963729858398, 0.6962854862213135, 0.052094221115112305, 0.5375432968139648, 1.401850938796997, 1.146925449371338, 1.0193052291870117, 1.2179489135742188, 0.6537079811096191, 1.28849458694458, 1.1678454875946045, 0.48632073402404785, 0.24269652366638184, 1.1348421573638916, 0.30338311195373535, 1.5297064781188965, 1.352233648300171, 1.3861255645751953, 0.5671303272247314, 1.6986076831817627, 1.532822608947754, 1.8364014625549316, 2.2859857082366943, 1.0707545280456543, 1.5142607688903809, 1.5617341995239258, 0.3950777053833008, 0.900179386138916, 0.01987934112548828, 0.7497684955596924, 0.38172245025634766, 2.4939613342285156, 0.8041305541992188, 1.4873907566070557, 0.12467241287231445, 2.0249221324920654, 1.235095500946045, 1.3562307357788086, 0.10870146751403809, 0.520824670791626, 0.842362642288208, 2.1901397705078125, 0.5808312892913818, 0.7013754844665527, 0.879885196685791, 1.6855039596557617, 0.9470148086547852, 1.800919771194458, 0.3459641933441162, 0.4182562828063965, 0.5689785480499268, 0.9588768482208252, 1.7078971862792969, 0.44818544387817383, 0.6591296195983887, 1.0853726863861084, 1.5050702095031738, 0.16158199310302734, 2.1787467002868652, 0.8574230670928955, 0.5433363914489746, 0.1985337734222412, 0.9250116348266602], "mean_td_error": 0.9716809391975403, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 427.0, "diff_num_grad_updates_vs_sampler_policy": 426.0}}, "num_env_steps_sampled": 4487, "num_env_steps_trained": 110166, "num_agent_steps_sampled": 13461, "num_agent_steps_trained": 110166, "last_target_update_ts": 4487, "num_target_updates": 427}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13461, "num_agent_steps_trained": 110166, "num_env_steps_sampled": 4487, "num_env_steps_trained": 110166, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 61.752830465942985, "num_env_steps_trained_throughput_per_sec": 2276.0328943161844, "timesteps_total": 4487, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 13461, "timers": {"training_iteration_time_ms": 117.743, "sample_time_ms": 16.341, "load_time_ms": 0.302, "load_throughput": 854223.581, "learn_time_ms": 17.814, "learn_throughput": 14483.113, "synch_weights_time_ms": 10.203}, "counters": {"num_env_steps_sampled": 4487, "num_env_steps_trained": 110166, "num_agent_steps_sampled": 13461, "num_agent_steps_trained": 110166, "last_target_update_ts": 4487, "num_target_updates": 427}, "done": false, "episodes_total": 0, "training_iteration": 32, "trial_id": "db258_00000", "date": "2023-11-16_21-48-54", "timestamp": 1700200134, "time_this_iter_s": 1.708920955657959, "time_total_s": 48.75658988952637, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 48.75658988952637, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.65, "ram_util_percent": 62.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05495548248291, "actor_loss": -13.423255920410156, "critic_loss": 0.09216583520174026, "alpha_loss": -1.329026460647583, "alpha_value": 0.8761865496635437, "log_alpha_value": -0.1321762651205063, "target_entropy": -6.0, "policy_t": -0.010827138088643551, "mean_q": 9.983920097351074, "max_q": 10.892192840576172, "min_q": 8.958988189697266}, "td_error": [1.2303662300109863, 0.465484619140625, 1.3890113830566406, 1.8001518249511719, 1.617447853088379, 1.0701093673706055, 0.25781774520874023, 1.625260829925537, 0.11038017272949219, 0.634638786315918, 1.3223628997802734, 0.02941417694091797, 0.9642729759216309, 0.6056594848632812, 1.721205711364746, 0.0726633071899414, 1.7607812881469727, 1.693331241607666, 0.9813847541809082, 0.508641242980957, 0.936549186706543, 0.8965020179748535, 1.1133809089660645, 1.0899667739868164, 1.0357351303100586, 0.7321000099182129, 1.9563260078430176, 0.775205135345459, 1.4569053649902344, 1.4291081428527832, 1.5545578002929688, 0.8965291976928711, 0.06929302215576172, 0.6120891571044922, 2.129927158355713, 1.0509223937988281, 1.0055665969848633, 0.05236053466796875, 1.636545181274414, 0.5761947631835938, 1.0362820625305176, 0.5645952224731445, 0.4295930862426758, 0.8964676856994629, 1.7229762077331543, 0.26578807830810547, 0.4470481872558594, 1.3386907577514648, 1.0402212142944336, 0.6417140960693359, 0.1521158218383789, 0.060997962951660156, 1.30232572555542, 0.571354866027832, 0.17629432678222656, 1.1231694221496582, 1.8659429550170898, 1.2375593185424805, 1.040550708770752, 0.24492406845092773, 0.5271749496459961, 0.18465089797973633, 1.750565528869629, 1.5582408905029297, 1.1164941787719727, 1.0173187255859375, 1.069870948791504, 1.5258121490478516, 0.23218011856079102, 1.8439559936523438, 1.6661815643310547, 0.9960141181945801, 1.6478114128112793, 0.038089752197265625, 0.5439395904541016, 0.8395228385925293, 0.716529369354248, 1.146547794342041, 0.4481773376464844, 2.0178966522216797, 1.0259814262390137, 0.8990077972412109, 0.6580328941345215, 0.7818508148193359, 3.952646255493164, 1.997765064239502], "mean_td_error": 1.0142676830291748, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 442.0, "diff_num_grad_updates_vs_sampler_policy": 441.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095037460327148, "actor_loss": -10.052861213684082, "critic_loss": 0.15016400814056396, "alpha_loss": -1.3358269929885864, "alpha_value": 0.8760561347007751, "log_alpha_value": -0.13232511281967163, "target_entropy": -6.0, "policy_t": 0.04162630811333656, "mean_q": 6.549313068389893, "max_q": 7.146062850952148, "min_q": 6.014521598815918}, "td_error": [0.4478929042816162, 1.5706336498260498, 0.8352193832397461, 1.1476423740386963, 0.09137701988220215, 0.5443198680877686, 0.8789730072021484, 0.9222474098205566, 3.4442152976989746, 2.287432909011841, 1.031726360321045, 1.2549841403961182, 2.6986069679260254, 0.09543514251708984, 2.5996766090393066, 0.4503755569458008, 0.18801379203796387, 1.500657081604004, 0.358090877532959, 2.12953519821167, 1.222801685333252, 0.07923340797424316, 0.8654646873474121, 1.7946152687072754, 2.058973789215088, 0.3893132209777832, 1.1660466194152832, 2.328939437866211, 1.69419264793396, 1.4708397388458252, 0.5703239440917969, 1.8320891857147217, 2.244709014892578, 0.9139604568481445, 0.6767005920410156, 1.266855001449585, 0.24394941329956055, 0.13237476348876953, 0.049323320388793945, 0.9481947422027588, 0.10311746597290039, 1.9760594367980957, 1.5286660194396973, 1.031151533126831, 0.2479114532470703, 1.0283827781677246, 2.6022844314575195, 0.5480453968048096, 0.9010744094848633, 0.8198909759521484, 2.211188554763794, 2.6578264236450195, 0.18030023574829102, 0.03838634490966797, 1.772719383239746, 1.3031606674194336, 0.8499007225036621, 0.46471381187438965, 2.2654716968536377, 0.9829962253570557, 1.2893733978271484, 1.3859684467315674, 1.8021178245544434, 0.11812067031860352, 1.3621015548706055, 2.820094347000122, 0.553093671798706, 0.7962007522583008, 0.43682169914245605, 0.9656891822814941, 2.3835620880126953, 1.9348185062408447, 1.0102338790893555, 0.6919012069702148, 1.0394794940948486, 3.5328354835510254, 0.5302536487579346, 1.0710458755493164, 0.2545750141143799, 1.6192309856414795, 1.5785737037658691, 1.5017948150634766, 1.535649299621582, 0.7772724628448486, 0.7057716846466064, 1.257401943206787], "mean_td_error": 1.1964324712753296, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 442.0, "diff_num_grad_updates_vs_sampler_policy": 441.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108978271484375, "actor_loss": -9.77530574798584, "critic_loss": 0.15258514881134033, "alpha_loss": -1.3379188776016235, "alpha_value": 0.8760347366333008, "log_alpha_value": -0.13234956562519073, "target_entropy": -6.0, "policy_t": -0.054696474224328995, "mean_q": 6.233161926269531, "max_q": 6.541914939880371, "min_q": 5.9687957763671875}, "td_error": [0.6460473537445068, 0.43168044090270996, 0.5302910804748535, 0.7765443325042725, 0.09499478340148926, 1.1252427101135254, 1.2279353141784668, 0.7962868213653564, 1.3000099658966064, 1.532043218612671, 0.1429131031036377, 0.2636251449584961, 1.1204314231872559, 0.9474833011627197, 0.1595172882080078, 1.9950644969940186, 1.3506827354431152, 2.3974626064300537, 1.6366310119628906, 0.04882526397705078, 1.054025650024414, 0.7926168441772461, 1.4178907871246338, 1.6673731803894043, 1.2582321166992188, 0.8329386711120605, 1.3801958560943604, 0.5475606918334961, 1.1422479152679443, 1.4607553482055664, 0.9887745380401611, 1.9686131477355957, 1.5521297454833984, 0.4861006736755371, 1.5443453788757324, 0.9616787433624268, 0.9041585922241211, 0.4203643798828125, 1.1809189319610596, 1.0015685558319092, 3.198528289794922, 1.0915369987487793, 0.643336296081543, 1.9452013969421387, 1.2526147365570068, 0.7437024116516113, 0.42463183403015137, 3.1524016857147217, 0.13737201690673828, 1.0943102836608887, 1.4298779964447021, 1.256943702697754, 0.8045041561126709, 0.8000452518463135, 1.22530198097229, 0.6316604614257812, 0.03503751754760742, 1.2003846168518066, 1.0847954750061035, 0.22192859649658203, 0.8218460083007812, 0.29989147186279297, 1.4709665775299072, 0.4565455913543701, 0.08266711235046387, 1.5422232151031494, 0.8484928607940674, 2.85386323928833, 3.1107394695281982, 0.2351078987121582, 1.0576517581939697, 1.58085036277771, 0.8942482471466064, 2.5621767044067383, 0.0737922191619873, 1.4512624740600586, 0.0861825942993164, 3.186558961868286, 0.9146814346313477, 1.5448262691497803, 0.8060293197631836, 0.26291847229003906, 1.4165587425231934, 0.9686563014984131, 0.15811562538146973, 0.7077651023864746], "mean_td_error": 1.0797085762023926, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 442.0, "diff_num_grad_updates_vs_sampler_policy": 441.0}}, "num_env_steps_sampled": 4592, "num_env_steps_trained": 114036, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 114036, "last_target_update_ts": 4592, "num_target_updates": 442}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 114036, "num_env_steps_sampled": 4592, "num_env_steps_trained": 114036, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.3803980199674, "num_env_steps_trained_throughput_per_sec": 2483.448955593084, "timesteps_total": 4592, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 104.158, "sample_time_ms": 15.09, "load_time_ms": 0.313, "load_throughput": 824543.151, "learn_time_ms": 17.907, "learn_throughput": 14407.505, "synch_weights_time_ms": 10.381}, "counters": {"num_env_steps_sampled": 4592, "num_env_steps_trained": 114036, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 114036, "last_target_update_ts": 4592, "num_target_updates": 442}, "done": false, "episodes_total": 0, "training_iteration": 33, "trial_id": "db258_00000", "date": "2023-11-16_21-48-56", "timestamp": 1700200136, "time_this_iter_s": 1.566831111907959, "time_total_s": 50.323421001434326, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 50.323421001434326, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 62.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114641189575195, "actor_loss": -13.772016525268555, "critic_loss": 0.09487821906805038, "alpha_loss": -1.382391333580017, "alpha_value": 0.8722560405731201, "log_alpha_value": -0.13667230308055878, "target_entropy": -6.0, "policy_t": 0.018358729779720306, "mean_q": 10.34731388092041, "max_q": 11.23951530456543, "min_q": 9.346760749816895}, "td_error": [2.278022289276123, 0.9947395324707031, 0.37270212173461914, 0.5383472442626953, 1.1307334899902344, 1.4384117126464844, 0.32859086990356445, 1.1962642669677734, 1.247899055480957, 1.3744349479675293, 2.2852516174316406, 0.6093497276306152, 1.5376510620117188, 1.433152675628662, 2.0636520385742188, 0.2401885986328125, 0.13990068435668945, 0.051601409912109375, 0.9665265083312988, 0.1674513816833496, 0.6370177268981934, 2.1121749877929688, 1.5154991149902344, 1.246169090270996, 2.6475629806518555, 0.7047338485717773, 0.9935870170593262, 1.8181157112121582, 0.15561580657958984, 1.0904288291931152, 0.7420005798339844, 1.4880385398864746, 1.5591206550598145, 1.1198735237121582, 1.3351759910583496, 0.022669315338134766, 0.4339280128479004, 0.10467910766601562, 0.483151912689209, 1.511763095855713, 0.42139673233032227, 0.6605768203735352, 1.4394659996032715, 1.3671636581420898, 1.3395442962646484, 1.1921281814575195, 1.3252744674682617, 0.674079418182373, 0.07807064056396484, 0.9165182113647461, 0.35678863525390625, 2.8087921142578125, 0.21167612075805664, 1.6944103240966797, 0.19390249252319336, 0.9541873931884766, 1.2558965682983398, 0.9102001190185547, 0.947044849395752, 1.1206154823303223, 2.8312387466430664, 0.8373780250549316, 0.7707061767578125, 1.6226606369018555, 0.3432774543762207, 0.525761604309082, 1.2228479385375977, 2.107964515686035, 1.5859041213989258, 0.7954792976379395, 0.9802398681640625, 0.6006736755371094, 2.9373369216918945, 2.0516796112060547, 1.35882568359375, 0.6059293746948242, 1.3230209350585938, 0.6713247299194336, 1.7025632858276367, 0.1565852165222168, 0.7729668617248535, 0.8585281372070312, 0.7535996437072754, 0.35062646865844727, 0.7638931274414062, 0.6356024742126465], "mean_td_error": 1.0598899126052856, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 457.0, "diff_num_grad_updates_vs_sampler_policy": 456.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081737518310547, "actor_loss": -10.007833480834961, "critic_loss": 0.14974269270896912, "alpha_loss": -1.3794453144073486, "alpha_value": 0.8721218705177307, "log_alpha_value": -0.13682611286640167, "target_entropy": -6.0, "policy_t": 0.018093690276145935, "mean_q": 6.434607982635498, "max_q": 7.021248817443848, "min_q": 6.018705368041992}, "td_error": [1.3197407722473145, 1.9364542961120605, 0.48189210891723633, 1.633728265762329, 0.8138625621795654, 1.7794318199157715, 0.9216675758361816, 1.5019245147705078, 1.8363771438598633, 1.0588138103485107, 0.7785077095031738, 0.9533638954162598, 1.2125153541564941, 0.8804917335510254, 1.38875150680542, 1.9487638473510742, 0.656867504119873, 0.5231437683105469, 2.540349006652832, 0.03717851638793945, 0.8056526184082031, 1.230886459350586, 0.7143478393554688, 0.3874070644378662, 1.3881783485412598, 1.0230467319488525, 1.3407845497131348, 1.024055004119873, 0.5357911586761475, 0.12551331520080566, 0.6340467929840088, 0.9215893745422363, 1.6310112476348877, 0.7547473907470703, 1.1540141105651855, 0.6541786193847656, 1.0518054962158203, 0.20253372192382812, 1.6204969882965088, 1.0480422973632812, 1.091660976409912, 1.4572899341583252, 0.5643265247344971, 0.7871527671813965, 1.374124526977539, 0.16561079025268555, 1.198976993560791, 2.1955206394195557, 0.561173677444458, 0.9209995269775391, 1.2432482242584229, 1.4628586769104004, 1.1893024444580078, 0.35804009437561035, 1.8447840213775635, 1.1151492595672607, 1.299081802368164, 1.301011085510254, 0.8719594478607178, 0.8962321281433105, 1.6264536380767822, 1.2545249462127686, 2.1692605018615723, 0.17202305793762207, 2.3097832202911377, 1.4503824710845947, 0.9855713844299316, 1.7923619747161865, 1.2905778884887695, 2.206453561782837, 0.30861997604370117, 0.6244156360626221, 1.5405614376068115, 1.8612775802612305, 2.2365827560424805, 3.2531521320343018, 1.3336148262023926, 1.0012474060058594, 1.5647294521331787, 1.2433605194091797, 0.6145546436309814, 1.59340238571167, 1.5032591819763184, 1.2973253726959229, 2.1709890365600586, 1.5269091129302979], "mean_td_error": 1.2009518146514893, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 457.0, "diff_num_grad_updates_vs_sampler_policy": 456.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10169506072998, "actor_loss": -10.066356658935547, "critic_loss": 0.1519094705581665, "alpha_loss": -1.3824536800384521, "alpha_value": 0.8720978498458862, "log_alpha_value": -0.13685362040996552, "target_entropy": -6.0, "policy_t": 0.04729136452078819, "mean_q": 6.527420520782471, "max_q": 6.94218635559082, "min_q": 6.197378158569336}, "td_error": [0.19815587997436523, 1.090622901916504, 0.8476440906524658, 1.479053258895874, 0.13136506080627441, 0.6935715675354004, 1.0499706268310547, 1.900984764099121, 0.9080874919891357, 1.505350112915039, 1.171128749847412, 1.977149486541748, 1.8179457187652588, 0.9746308326721191, 0.7311813831329346, 1.8254969120025635, 0.9455840587615967, 0.4863286018371582, 0.5694231986999512, 0.23635339736938477, 0.4939706325531006, 1.1538009643554688, 0.8136968612670898, 1.5530827045440674, 1.5504159927368164, 0.4047729969024658, 1.3334219455718994, 1.5467185974121094, 1.3346319198608398, 0.45186614990234375, 0.08041834831237793, 0.9373538494110107, 0.9752750396728516, 1.7691154479980469, 0.8871583938598633, 0.3174631595611572, 0.5207939147949219, 1.073361873626709, 1.2353603839874268, 1.9877324104309082, 0.3541436195373535, 2.3231406211853027, 1.9539692401885986, 0.6868913173675537, 0.5100352764129639, 0.6452288627624512, 2.2984142303466797, 0.9914140701293945, 1.9990997314453125, 0.2230362892150879, 0.09163713455200195, 0.9567687511444092, 2.484905958175659, 0.10708236694335938, 1.9087269306182861, 0.45442676544189453, 0.8830375671386719, 0.5207138061523438, 0.8218376636505127, 1.0059497356414795, 1.8586523532867432, 0.5458805561065674, 1.620732307434082, 0.023900508880615234, 1.7820141315460205, 0.7944672107696533, 1.3679718971252441, 1.5691580772399902, 1.3982625007629395, 0.5028786659240723, 2.406277894973755, 0.9489257335662842, 0.22484683990478516, 1.8006584644317627, 0.3263864517211914, 0.5475342273712158, 1.0495209693908691, 1.41225004196167, 0.2001333236694336, 0.8409054279327393, 1.5298163890838623, 1.2525146007537842, 1.3842501640319824, 1.3047478199005127, 0.6917614936828613, 2.013261079788208], "mean_td_error": 1.064867377281189, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 457.0, "diff_num_grad_updates_vs_sampler_policy": 456.0}}, "num_env_steps_sampled": 4697, "num_env_steps_trained": 117906, "num_agent_steps_sampled": 14091, "num_agent_steps_trained": 117906, "last_target_update_ts": 4697, "num_target_updates": 457}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14091, "num_agent_steps_trained": 117906, "num_env_steps_sampled": 4697, "num_env_steps_trained": 117906, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.12425782979564, "num_env_steps_trained_throughput_per_sec": 2474.0083600124676, "timesteps_total": 4697, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 14091, "timers": {"training_iteration_time_ms": 104.449, "sample_time_ms": 15.8, "load_time_ms": 0.316, "load_throughput": 817504.293, "learn_time_ms": 18.284, "learn_throughput": 14110.726, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 4697, "num_env_steps_trained": 117906, "num_agent_steps_sampled": 14091, "num_agent_steps_trained": 117906, "last_target_update_ts": 4697, "num_target_updates": 457}, "done": false, "episodes_total": 0, "training_iteration": 34, "trial_id": "db258_00000", "date": "2023-11-16_21-48-58", "timestamp": 1700200138, "time_this_iter_s": 1.572840929031372, "time_total_s": 51.8962619304657, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0623e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 51.8962619304657, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.25, "ram_util_percent": 62.349999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114901542663574, "actor_loss": -14.12643051147461, "critic_loss": 0.11214400827884674, "alpha_loss": -1.427941083908081, "alpha_value": 0.8683398962020874, "log_alpha_value": -0.14117202162742615, "target_entropy": -6.0, "policy_t": -0.04012685269117355, "mean_q": 10.566568374633789, "max_q": 11.49465560913086, "min_q": 9.56265926361084}, "td_error": [0.7448997497558594, 1.01324462890625, 0.9804158210754395, 0.3822598457336426, 0.48752689361572266, 1.728743553161621, 1.3178439140319824, 1.331284523010254, 0.5361456871032715, 0.11565113067626953, 2.8105201721191406, 1.026440143585205, 1.2504663467407227, 2.7466039657592773, 1.4398550987243652, 0.19590425491333008, 1.9051556587219238, 0.8338899612426758, 0.6512584686279297, 0.21066904067993164, 0.7768278121948242, 1.2925972938537598, 0.5391292572021484, 0.7135214805603027, 2.0589427947998047, 2.1046791076660156, 1.2733125686645508, 0.4944295883178711, 1.9271769523620605, 1.1388254165649414, 1.0657734870910645, 1.4076132774353027, 0.9983019828796387, 1.5235953330993652, 1.0579595565795898, 1.7611503601074219, 0.7355828285217285, 1.7187504768371582, 1.2299737930297852, 0.5605740547180176, 2.2318997383117676, 1.8387842178344727, 0.9896149635314941, 0.1617279052734375, 2.505528450012207, 3.173400402069092, 0.45508241653442383, 1.9058036804199219, 0.5415129661560059, 0.22719669342041016, 0.6978726387023926, 2.246001720428467, 0.9242916107177734, 1.0153179168701172, 1.3509416580200195, 2.159806251525879, 1.0533323287963867, 2.591031074523926, 0.8391647338867188, 1.7142248153686523, 1.2165861129760742, 0.8749179840087891, 1.3238768577575684, 2.2764549255371094, 0.6632871627807617, 1.6376953125, 1.0396747589111328, 2.013728618621826, 0.6151213645935059, 1.6825175285339355, 1.4903650283813477, 0.5189223289489746, 0.24520349502563477, 0.9712491035461426, 2.010868549346924, 0.09518098831176758, 0.17364501953125, 1.236128807067871, 2.275541305541992, 1.0075583457946777, 1.5364885330200195, 0.46741247177124023, 1.375542163848877, 1.3677892684936523, 1.0383710861206055, 1.4282965660095215], "mean_td_error": 1.2243309020996094, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 472.0, "diff_num_grad_updates_vs_sampler_policy": 471.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00026798248291, "actor_loss": -10.084521293640137, "critic_loss": 0.15495768189430237, "alpha_loss": -1.4132965803146362, "alpha_value": 0.8682063221931458, "log_alpha_value": -0.14132587611675262, "target_entropy": -6.0, "policy_t": -0.005867544561624527, "mean_q": 6.605022430419922, "max_q": 7.068639755249023, "min_q": 6.184757232666016}, "td_error": [1.6650052070617676, 1.007840633392334, 1.4011731147766113, 1.5598957538604736, 1.4526877403259277, 1.1164841651916504, 0.8192214965820312, 1.367450475692749, 0.15452980995178223, 1.5469882488250732, 1.024414300918579, 0.45101141929626465, 0.7259852886199951, 0.49716901779174805, 2.2741291522979736, 1.3920209407806396, 0.8286805152893066, 1.810014247894287, 1.3529746532440186, 0.015446901321411133, 0.6277365684509277, 2.324376344680786, 1.3060667514801025, 0.6137595176696777, 0.5171658992767334, 0.5044560432434082, 0.7620055675506592, 1.7046630382537842, 0.3926558494567871, 0.6309475898742676, 1.2232728004455566, 2.067396402359009, 1.187432050704956, 1.6566765308380127, 0.30428409576416016, 1.697676420211792, 1.4189934730529785, 3.273508310317993, 1.3600866794586182, 3.7643816471099854, 1.3086016178131104, 0.622394323348999, 1.1797494888305664, 0.46249866485595703, 2.315758466720581, 1.4095659255981445, 0.7857820987701416, 1.4962193965911865, 1.2139208316802979, 0.973132848739624, 1.1150791645050049, 1.7803151607513428, 2.1975841522216797, 0.7413961887359619, 0.05602097511291504, 1.812776803970337, 0.06757760047912598, 1.5972061157226562, 0.1323404312133789, 1.3674471378326416, 1.5812087059020996, 2.334174871444702, 0.6132175922393799, 1.1129965782165527, 1.3987376689910889, 2.7058091163635254, 1.7177762985229492, 0.5803225040435791, 1.5005805492401123, 0.9389150142669678, 0.49734044075012207, 1.5350871086120605, 2.4396724700927734, 1.4319956302642822, 1.4001336097717285, 0.3804323673248291, 0.5038094520568848, 1.9443209171295166, 0.9503011703491211, 1.2361388206481934, 1.4372541904449463, 1.278749704360962, 0.4270052909851074, 1.6444804668426514, 1.4297997951507568, 0.9536252021789551], "mean_td_error": 1.2373247146606445, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 472.0, "diff_num_grad_updates_vs_sampler_policy": 471.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087479591369629, "actor_loss": -10.097822189331055, "critic_loss": 0.14175012707710266, "alpha_loss": -1.4259161949157715, "alpha_value": 0.868181049823761, "log_alpha_value": -0.14135503768920898, "target_entropy": -6.0, "policy_t": -0.01794077642261982, "mean_q": 6.58726692199707, "max_q": 6.951483249664307, "min_q": 6.301758766174316}, "td_error": [1.0997533798217773, 0.9035558700561523, 1.2503128051757812, 0.9023990631103516, 0.3427443504333496, 1.1515395641326904, 0.30179524421691895, 0.35607075691223145, 0.46979331970214844, 0.3066117763519287, 0.4366023540496826, 0.7405688762664795, 0.852893590927124, 0.0027713775634765625, 2.882904052734375, 0.3439624309539795, 1.0604963302612305, 0.6565780639648438, 1.1204679012298584, 1.235724687576294, 2.3100526332855225, 0.37343311309814453, 1.6310851573944092, 2.685105085372925, 0.592073917388916, 1.3775241374969482, 0.4744229316711426, 0.05638909339904785, 1.4001197814941406, 3.5758230686187744, 0.998133659362793, 0.8399529457092285, 0.22349786758422852, 0.4269371032714844, 0.8130097389221191, 1.0970191955566406, 0.9312982559204102, 0.12863397598266602, 0.819770336151123, 1.425339698791504, 0.6067349910736084, 0.47713732719421387, 0.8326930999755859, 1.0538160800933838, 0.8019838333129883, 0.20233798027038574, 3.0007998943328857, 0.655296802520752, 1.912299633026123, 0.9372127056121826, 3.4618160724639893, 1.7642183303833008, 0.06828594207763672, 1.2501897811889648, 1.1473023891448975, 1.6283514499664307, 0.3196594715118408, 0.832909345626831, 1.0016412734985352, 0.07275986671447754, 2.5401806831359863, 1.511962652206421, 1.8997321128845215, 1.76289701461792, 0.2515690326690674, 0.056269168853759766, 1.4067931175231934, 0.4004802703857422, 0.8655905723571777, 1.5213115215301514, 1.9716846942901611, 1.3016648292541504, 1.1078646183013916, 0.1780226230621338, 0.2844982147216797, 0.4541511535644531, 0.49471259117126465, 0.21653127670288086, 1.5021941661834717, 1.74582839012146, 1.4195308685302734, 0.5766735076904297, 0.6185014247894287, 0.444258451461792, 0.44586801528930664, 1.4258067607879639], "mean_td_error": 1.0119673013687134, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 472.0, "diff_num_grad_updates_vs_sampler_policy": 471.0}}, "num_env_steps_sampled": 4802, "num_env_steps_trained": 121776, "num_agent_steps_sampled": 14406, "num_agent_steps_trained": 121776, "last_target_update_ts": 4802, "num_target_updates": 472}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14406, "num_agent_steps_trained": 121776, "num_env_steps_sampled": 4802, "num_env_steps_trained": 121776, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.94797096579195, "num_env_steps_trained_throughput_per_sec": 2504.3680727391893, "timesteps_total": 4802, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 14406, "timers": {"training_iteration_time_ms": 102.992, "sample_time_ms": 14.855, "load_time_ms": 0.307, "load_throughput": 841404.581, "learn_time_ms": 17.794, "learn_throughput": 14499.084, "synch_weights_time_ms": 9.954}, "counters": {"num_env_steps_sampled": 4802, "num_env_steps_trained": 121776, "num_agent_steps_sampled": 14406, "num_agent_steps_trained": 121776, "last_target_update_ts": 4802, "num_target_updates": 472}, "done": false, "episodes_total": 0, "training_iteration": 35, "trial_id": "db258_00000", "date": "2023-11-16_21-48-59", "timestamp": 1700200139, "time_this_iter_s": 1.5543370246887207, "time_total_s": 53.45059895515442, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 53.45059895515442, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 31.55, "ram_util_percent": 62.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.965224266052246, "actor_loss": -14.319193840026855, "critic_loss": 0.10630358755588531, "alpha_loss": -1.4516723155975342, "alpha_value": 0.8644396066665649, "log_alpha_value": -0.14567381143569946, "target_entropy": -6.0, "policy_t": 0.05227430909872055, "mean_q": 10.848248481750488, "max_q": 11.727975845336914, "min_q": 10.127696990966797}, "td_error": [1.4749274253845215, 0.13852882385253906, 1.0122385025024414, 1.7014093399047852, 1.0372190475463867, 1.5386838912963867, 1.30031156539917, 1.3447694778442383, 0.9341926574707031, 1.4236984252929688, 1.0704150199890137, 0.6448516845703125, 1.0842700004577637, 0.9838962554931641, 1.1721906661987305, 1.8468637466430664, 1.3067855834960938, 0.6374201774597168, 0.13109159469604492, 0.6196222305297852, 2.3374805450439453, 0.31104135513305664, 1.7706570625305176, 0.748650074005127, 0.24306249618530273, 0.32532691955566406, 0.8421931266784668, 0.6242446899414062, 0.18883419036865234, 3.3192830085754395, 0.1928548812866211, 2.0027174949645996, 1.5790224075317383, 1.695559024810791, 0.11455869674682617, 1.1340694427490234, 1.4475297927856445, 0.09623050689697266, 1.2511844635009766, 1.3076801300048828, 2.000697135925293, 1.6681547164916992, 1.4573688507080078, 0.854651927947998, 1.1778364181518555, 1.7934155464172363, 1.0907354354858398, 0.4592442512512207, 0.7324771881103516, 1.2255182266235352, 0.4826674461364746, 2.073394775390625, 1.178598403930664, 0.29290771484375, 0.35238122940063477, 0.8065457344055176, 0.5359354019165039, 1.5426092147827148, 0.7678518295288086, 1.751016616821289, 1.0905890464782715, 1.0604629516601562, 2.0578298568725586, 2.1569223403930664, 0.6015138626098633, 1.9051594734191895, 2.7825169563293457, 1.6772050857543945, 1.384066104888916, 1.579599380493164, 0.6322107315063477, 0.06957626342773438, 1.5062522888183594, 1.0416336059570312, 2.504638195037842, 0.9060478210449219, 0.3268141746520996, 1.1382861137390137, 2.5740389823913574, 0.998436450958252, 0.8065571784973145, 1.2185449600219727, 0.07046890258789062, 1.4394745826721191, 1.865537166595459, 0.4518299102783203], "mean_td_error": 1.1514626741409302, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 487.0, "diff_num_grad_updates_vs_sampler_policy": 486.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.152692794799805, "actor_loss": -10.196635246276855, "critic_loss": 0.13487470149993896, "alpha_loss": -1.4805420637130737, "alpha_value": 0.8643067479133606, "log_alpha_value": -0.145827516913414, "target_entropy": -6.0, "policy_t": -0.03192372992634773, "mean_q": 6.659721851348877, "max_q": 7.098275661468506, "min_q": 6.200148105621338}, "td_error": [0.1500389575958252, 0.3276073932647705, 3.747166872024536, 0.9614076614379883, 0.5956020355224609, 0.7675731182098389, 1.880561351776123, 1.7405738830566406, 1.7688405513763428, 1.1625111103057861, 0.5834717750549316, 0.8713595867156982, 1.6853041648864746, 0.8430261611938477, 2.0299596786499023, 0.731689453125, 0.9656684398651123, 1.0754213333129883, 0.5868167877197266, 1.7023277282714844, 1.186798095703125, 0.3470735549926758, 1.8117547035217285, 1.5949654579162598, 1.0683197975158691, 0.8013155460357666, 0.8596293926239014, 2.200685501098633, 0.4428982734680176, 0.4033336639404297, 1.3736629486083984, 1.0409266948699951, 2.075411558151245, 0.800156831741333, 1.317751407623291, 0.36557435989379883, 1.6066248416900635, 1.2137444019317627, 0.2394089698791504, 1.4395637512207031, 0.419952392578125, 0.7386624813079834, 0.9611983299255371, 2.784167766571045, 1.5973577499389648, 0.4160618782043457, 0.6075434684753418, 1.0121161937713623, 1.5930910110473633, 1.6993622779846191, 1.0319128036499023, 1.1246006488800049, 0.9609332084655762, 0.09036493301391602, 1.6088626384735107, 0.8332345485687256, 0.09177970886230469, 1.199228286743164, 1.788076400756836, 1.8040547370910645, 2.6997780799865723, 0.33295536041259766, 1.816256046295166, 1.0914525985717773, 0.019429445266723633, 1.3550994396209717, 1.6907072067260742, 2.0251224040985107, 0.327739953994751, 1.3105645179748535, 1.1652429103851318, 0.6371922492980957, 0.23347091674804688, 1.2881646156311035, 0.35665321350097656, 1.3569886684417725, 0.23632264137268066, 0.726776123046875, 1.554377555847168, 1.0411641597747803, 0.4933135509490967, 0.9530246257781982, 0.10274958610534668, 0.7854089736938477, 1.0575768947601318, 0.8452818393707275], "mean_td_error": 1.0957199335098267, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 487.0, "diff_num_grad_updates_vs_sampler_policy": 486.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14888858795166, "actor_loss": -10.311328887939453, "critic_loss": 0.13476493954658508, "alpha_loss": -1.480303168296814, "alpha_value": 0.8642798662185669, "log_alpha_value": -0.14585864543914795, "target_entropy": -6.0, "policy_t": -0.01883021369576454, "mean_q": 6.776666641235352, "max_q": 7.1554107666015625, "min_q": 6.56336784362793}, "td_error": [0.8977339267730713, 2.6245720386505127, 1.2906124591827393, 1.5244944095611572, 0.27854347229003906, 0.7533450126647949, 0.3964250087738037, 0.33506131172180176, 0.22850561141967773, 1.9844989776611328, 1.0895411968231201, 0.16737699508666992, 0.33620762825012207, 0.38283538818359375, 0.8026173114776611, 0.0961751937866211, 1.3324236869812012, 2.652803897857666, 0.6447663307189941, 0.3679494857788086, 0.7183346748352051, 1.1720285415649414, 1.866896152496338, 0.030291080474853516, 0.7022433280944824, 0.8774042129516602, 0.7482452392578125, 0.30077648162841797, 1.1308722496032715, 1.336244821548462, 1.0987582206726074, 1.823544979095459, 0.19177579879760742, 1.7096257209777832, 0.7904715538024902, 0.9698176383972168, 1.6086699962615967, 1.4978916645050049, 1.2696340084075928, 0.7418539524078369, 0.9643294811248779, 0.059877872467041016, 1.16410493850708, 0.3232760429382324, 0.6749999523162842, 0.23265576362609863, 0.26221799850463867, 2.0282039642333984, 0.4174685478210449, 0.17564797401428223, 2.195894479751587, 1.3670916557312012, 0.5369241237640381, 0.5585076808929443, 0.36045145988464355, 1.7536020278930664, 1.2090423107147217, 0.8256230354309082, 0.10860514640808105, 0.7171335220336914, 1.670577049255371, 0.7746963500976562, 0.11806392669677734, 1.535573959350586, 1.0304102897644043, 2.2435407638549805, 0.6081576347351074, 0.31624341011047363, 1.0341260433197021, 0.7918350696563721, 0.8129644393920898, 1.1400022506713867, 0.7384886741638184, 0.7637920379638672, 1.497112512588501, 0.9153873920440674, 2.2148115634918213, 2.1983394622802734, 1.8151180744171143, 0.05234670639038086, 1.0823087692260742, 1.8488962650299072, 1.4100542068481445, 2.2904279232025146, 1.5848684310913086, 1.1342391967773438], "mean_td_error": 1.0038361549377441, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 487.0, "diff_num_grad_updates_vs_sampler_policy": 486.0}}, "num_env_steps_sampled": 4907, "num_env_steps_trained": 125646, "num_agent_steps_sampled": 14721, "num_agent_steps_trained": 125646, "last_target_update_ts": 4907, "num_target_updates": 487}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14721, "num_agent_steps_trained": 125646, "num_env_steps_sampled": 4907, "num_env_steps_trained": 125646, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.27220347278252, "num_env_steps_trained_throughput_per_sec": 2479.461213711127, "timesteps_total": 4907, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 14721, "timers": {"training_iteration_time_ms": 104.116, "sample_time_ms": 15.877, "load_time_ms": 0.31, "load_throughput": 831768.203, "learn_time_ms": 17.78, "learn_throughput": 14510.633, "synch_weights_time_ms": 10.151}, "counters": {"num_env_steps_sampled": 4907, "num_env_steps_trained": 125646, "num_agent_steps_sampled": 14721, "num_agent_steps_trained": 125646, "last_target_update_ts": 4907, "num_target_updates": 487}, "done": false, "episodes_total": 0, "training_iteration": 36, "trial_id": "db258_00000", "date": "2023-11-16_21-49-01", "timestamp": 1700200141, "time_this_iter_s": 1.569725751876831, "time_total_s": 55.02032470703125, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 55.02032470703125, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 31.066666666666666, "ram_util_percent": 62.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.954195022583008, "actor_loss": -14.42073917388916, "critic_loss": 0.08527883887290955, "alpha_loss": -1.4948796033859253, "alpha_value": 0.8605566620826721, "log_alpha_value": -0.15017582476139069, "target_entropy": -6.0, "policy_t": -0.04300475865602493, "mean_q": 11.020606994628906, "max_q": 12.073089599609375, "min_q": 9.943939208984375}, "td_error": [0.6588468551635742, 1.3451356887817383, 1.4970436096191406, 0.43835878372192383, 0.3222818374633789, 1.1552019119262695, 0.5088362693786621, 2.047840118408203, 0.8955459594726562, 1.7908477783203125, 1.3579845428466797, 0.17325115203857422, 0.3155655860900879, 1.2784419059753418, 0.25985193252563477, 1.2345657348632812, 0.15263748168945312, 0.3715839385986328, 0.994837760925293, 2.08144474029541, 1.3397421836853027, 0.13866901397705078, 1.0944666862487793, 1.2577600479125977, 1.5922226905822754, 2.1158676147460938, 1.3686809539794922, 0.49033117294311523, 0.985292911529541, 1.6239166259765625, 0.7788324356079102, 0.6901283264160156, 0.8734664916992188, 0.8506102561950684, 1.3456048965454102, 1.483508586883545, 0.9318456649780273, 1.2893056869506836, 1.1293106079101562, 0.35370731353759766, 0.7027606964111328, 1.8289189338684082, 0.9325366020202637, 0.11026144027709961, 0.4713273048400879, 0.06283807754516602, 0.9080653190612793, 0.5494036674499512, 0.8355083465576172, 0.6164388656616211, 0.23645782470703125, 3.012166976928711, 0.47469329833984375, 0.9304804801940918, 0.12931537628173828, 0.7813205718994141, 0.7048377990722656, 2.9833178520202637, 1.464940071105957, 0.7883090972900391, 1.381096363067627, 1.298417091369629, 2.5979909896850586, 0.31911516189575195, 0.8124370574951172, 0.04504680633544922, 1.1883587837219238, 1.3311066627502441, 0.22913599014282227, 0.09322357177734375, 0.9196453094482422, 1.320345401763916, 0.9312543869018555, 0.48296594619750977, 1.5651826858520508, 1.4826874732971191, 0.5789370536804199, 2.0165762901306152, 0.48932981491088867, 0.5368480682373047, 1.462836742401123, 0.024410724639892578, 1.8811712265014648, 1.7439751625061035, 0.5937705039978027, 0.10794305801391602], "mean_td_error": 0.9833846688270569, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 502.0, "diff_num_grad_updates_vs_sampler_policy": 501.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073775291442871, "actor_loss": -10.330718040466309, "critic_loss": 0.11466039717197418, "alpha_loss": -1.514405369758606, "alpha_value": 0.8604227304458618, "log_alpha_value": -0.15033145248889923, "target_entropy": -6.0, "policy_t": 0.01761282980442047, "mean_q": 6.864203929901123, "max_q": 7.3445820808410645, "min_q": 6.439967155456543}, "td_error": [1.3936796188354492, 1.979740858078003, 0.8649027347564697, 0.3263370990753174, 2.127689838409424, 2.2140488624572754, 1.4902265071868896, 1.0277397632598877, 0.3441171646118164, 0.7952868938446045, 2.4047353267669678, 1.3041460514068604, 2.0872507095336914, 1.0942163467407227, 1.3279476165771484, 1.7815964221954346, 0.5131802558898926, 0.4059782028198242, 0.32837438583374023, 0.6054534912109375, 0.7284369468688965, 1.1192858219146729, 2.0985145568847656, 1.7070646286010742, 1.8027825355529785, 0.04616403579711914, 0.8343210220336914, 0.49103784561157227, 0.27333998680114746, 2.6144304275512695, 0.7880129814147949, 2.4910659790039062, 1.2258639335632324, 0.8474283218383789, 1.501554012298584, 0.8035573959350586, 0.670881986618042, 0.8849067687988281, 1.2295043468475342, 0.889629602432251, 1.5064458847045898, 1.805145263671875, 0.5258877277374268, 1.0312561988830566, 2.693264961242676, 2.022285223007202, 0.7561650276184082, 0.20102357864379883, 0.28264832496643066, 0.6544547080993652, 1.4712355136871338, 0.508061408996582, 1.7480778694152832, 0.39725422859191895, 1.2561976909637451, 0.9522719383239746, 0.3198421001434326, 1.4032323360443115, 0.9985017776489258, 1.0206894874572754, 0.7601664066314697, 1.1519684791564941, 0.5075974464416504, 1.358893871307373, 1.2258048057556152, 1.6258518695831299, 0.20702385902404785, 1.1594619750976562, 0.5646364688873291, 1.4692468643188477, 1.1049926280975342, 0.6593184471130371, 0.6591839790344238, 1.8438565731048584, 0.8136920928955078, 1.654444694519043, 1.8708398342132568, 1.243861198425293, 0.7357988357543945, 1.4560494422912598, 1.1702001094818115, 1.4250140190124512, 1.7483694553375244, 1.0940532684326172, 0.15584444999694824, 3.007601499557495], "mean_td_error": 1.1592110395431519, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 502.0, "diff_num_grad_updates_vs_sampler_policy": 501.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.079545974731445, "actor_loss": -10.489333152770996, "critic_loss": 0.13693338632583618, "alpha_loss": -1.5156170129776, "alpha_value": 0.8603933453559875, "log_alpha_value": -0.15036560595035553, "target_entropy": -6.0, "policy_t": 0.06681887060403824, "mean_q": 7.034445285797119, "max_q": 7.3453688621521, "min_q": 6.797722339630127}, "td_error": [0.5780525207519531, 0.704864501953125, 1.4724349975585938, 2.1263327598571777, 0.5719213485717773, 0.8993191719055176, 1.4920148849487305, 1.626493215560913, 0.5161151885986328, 1.2859394550323486, 1.8701133728027344, 0.5094549655914307, 0.7603580951690674, 0.2788522243499756, 2.17919659614563, 0.3606877326965332, 0.22572541236877441, 2.2781546115875244, 0.4284806251525879, 1.483811378479004, 0.6458611488342285, 1.4474022388458252, 0.5909793376922607, 1.312180757522583, 0.7073945999145508, 0.8859148025512695, 0.35490870475769043, 1.4555025100708008, 0.044135093688964844, 2.179276466369629, 1.2012779712677002, 0.4872415065765381, 1.8747599124908447, 0.6040387153625488, 1.4750888347625732, 0.9103093147277832, 1.466268539428711, 0.5462038516998291, 0.6087753772735596, 1.5805835723876953, 0.66684889793396, 0.5334746837615967, 1.3826954364776611, 0.34079933166503906, 0.8881497383117676, 0.7689311504364014, 1.258208990097046, 0.25792813301086426, 0.7968845367431641, 1.6571540832519531, 1.178246259689331, 0.9447784423828125, 0.6281342506408691, 1.7138805389404297, 0.2586679458618164, 0.8256258964538574, 0.6225929260253906, 1.1594724655151367, 0.321852445602417, 0.1341545581817627, 2.133441925048828, 2.2208564281463623, 2.471595287322998, 0.5710132122039795, 0.740628719329834, 1.5092737674713135, 0.2610468864440918, 1.101222276687622, 0.6366367340087891, 1.4141850471496582, 0.10602593421936035, 0.7140700817108154, 0.10463261604309082, 0.26786351203918457, 2.3124728202819824, 0.6152112483978271, 0.9840753078460693, 1.7222867012023926, 2.0494155883789062, 3.3419137001037598, 0.5703544616699219, 1.784390926361084, 0.6650047302246094, 0.4923117160797119, 0.9601988792419434, 1.1905503273010254], "mean_td_error": 1.038437008857727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 502.0, "diff_num_grad_updates_vs_sampler_policy": 501.0}}, "num_env_steps_sampled": 5012, "num_env_steps_trained": 129516, "num_agent_steps_sampled": 15036, "num_agent_steps_trained": 129516, "last_target_update_ts": 5012, "num_target_updates": 502}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15036, "num_agent_steps_trained": 129516, "num_env_steps_sampled": 5012, "num_env_steps_trained": 129516, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.8626362923767, "num_env_steps_trained_throughput_per_sec": 2464.365737633313, "timesteps_total": 5012, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 15036, "timers": {"training_iteration_time_ms": 104.295, "sample_time_ms": 14.853, "load_time_ms": 0.311, "load_throughput": 829854.626, "learn_time_ms": 17.728, "learn_throughput": 14552.979, "synch_weights_time_ms": 11.099}, "counters": {"num_env_steps_sampled": 5012, "num_env_steps_trained": 129516, "num_agent_steps_sampled": 15036, "num_agent_steps_trained": 129516, "last_target_update_ts": 5012, "num_target_updates": 502}, "done": false, "episodes_total": 0, "training_iteration": 37, "trial_id": "db258_00000", "date": "2023-11-16_21-49-02", "timestamp": 1700200142, "time_this_iter_s": 1.5796520709991455, "time_total_s": 56.599976778030396, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0623e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 56.599976778030396, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 62.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.92162799835205, "actor_loss": -14.587159156799316, "critic_loss": 0.08872821182012558, "alpha_loss": -1.534625768661499, "alpha_value": 0.8566937446594238, "log_alpha_value": -0.15467476844787598, "target_entropy": -6.0, "policy_t": -0.011884418316185474, "mean_q": 11.227049827575684, "max_q": 11.993948936462402, "min_q": 10.302328109741211}, "td_error": [1.5194664001464844, 0.2261061668395996, 0.7159581184387207, 0.6190180778503418, 2.1618661880493164, 1.6532235145568848, 0.11885976791381836, 1.9559497833251953, 1.3985695838928223, 0.2539205551147461, 1.4010915756225586, 0.7210617065429688, 0.6470880508422852, 0.7919163703918457, 0.28325414657592773, 0.7568621635437012, 1.3554282188415527, 0.025380611419677734, 0.537877082824707, 0.5677757263183594, 0.8363308906555176, 1.9275970458984375, 0.8265671730041504, 1.0028457641601562, 0.09121227264404297, 1.684643268585205, 1.3146867752075195, 2.098723888397217, 0.9378781318664551, 1.9438810348510742, 0.34494686126708984, 0.33615636825561523, 0.35068702697753906, 1.4206652641296387, 0.6767282485961914, 0.6468601226806641, 1.2004914283752441, 0.5119132995605469, 0.09493446350097656, 1.0940184593200684, 1.4098973274230957, 0.0822596549987793, 1.2883501052856445, 2.0398001670837402, 2.329845905303955, 0.5558199882507324, 1.5423617362976074, 1.1019210815429688, 0.9789652824401855, 1.3858838081359863, 0.1047658920288086, 0.5457205772399902, 1.1091351509094238, 2.2221927642822266, 0.7066745758056641, 0.754725456237793, 1.086775779724121, 0.17028570175170898, 0.9633183479309082, 0.22236251831054688, 0.5853376388549805, 1.9905247688293457, 0.2656679153442383, 0.9042949676513672, 2.0609664916992188, 0.760159969329834, 1.4642748832702637, 2.046815872192383, 0.9207243919372559, 1.9563298225402832, 1.9819536209106445, 0.084014892578125, 1.9175381660461426, 0.14186763763427734, 0.6603918075561523, 0.678504467010498, 0.34077024459838867, 0.6192417144775391, 1.3200244903564453, 0.23677873611450195, 1.565847396850586, 0.6619138717651367, 0.8281965255737305, 0.8906917572021484, 1.1968317031860352, 2.3472204208374023], "mean_td_error": 1.0009347200393677, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 517.0, "diff_num_grad_updates_vs_sampler_policy": 516.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107982635498047, "actor_loss": -10.384140014648438, "critic_loss": 0.1063455194234848, "alpha_loss": -1.565068244934082, "alpha_value": 0.8565565943717957, "log_alpha_value": -0.15483488142490387, "target_entropy": -6.0, "policy_t": 0.007576533127576113, "mean_q": 6.914891242980957, "max_q": 7.3326921463012695, "min_q": 6.573873996734619}, "td_error": [0.7645375728607178, 0.8178904056549072, 1.6161460876464844, 0.6208288669586182, 1.026947259902954, 0.32808423042297363, 1.6379117965698242, 1.944502592086792, 2.0388331413269043, 1.5525603294372559, 0.5096783638000488, 1.4197638034820557, 1.083787202835083, 1.6161060333251953, 0.6366231441497803, 1.9607701301574707, 0.256131649017334, 0.41591548919677734, 1.1683323383331299, 2.4137940406799316, 0.01776862144470215, 1.2607219219207764, 1.1556243896484375, 2.4539995193481445, 0.7648658752441406, 1.701836109161377, 0.050110578536987305, 1.7990026473999023, 0.3764076232910156, 0.5381448268890381, 0.6399080753326416, 1.5307934284210205, 1.0009803771972656, 1.3760783672332764, 1.1334903240203857, 1.745370864868164, 0.8571934700012207, 0.8643362522125244, 0.8885855674743652, 0.6313884258270264, 0.8576045036315918, 2.9672341346740723, 1.7970106601715088, 0.33841371536254883, 0.4284834861755371, 0.6935877799987793, 1.4125337600708008, 0.5825862884521484, 0.41827893257141113, 0.06341028213500977, 1.6693251132965088, 1.148369312286377, 1.0519280433654785, 0.46340298652648926, 1.5283215045928955, 1.3616321086883545, 0.47491025924682617, 1.2423934936523438, 0.5692453384399414, 0.9523715972900391, 1.743786096572876, 0.4475855827331543, 0.9551215171813965, 0.8228838443756104, 1.943274974822998, 1.0320329666137695, 1.4836986064910889, 2.2887682914733887, 1.6914255619049072, 0.31047892570495605, 0.5109443664550781, 1.533106803894043, 0.04352235794067383, 1.0177993774414062, 0.7722482681274414, 2.7642922401428223, 1.6774091720581055, 1.460923671722412, 0.053591012954711914, 0.23328351974487305, 0.4123067855834961, 1.0518105030059814, 0.6388523578643799, 1.2072432041168213, 1.6013453006744385, 1.377516269683838], "mean_td_error": 1.089674949645996, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 517.0, "diff_num_grad_updates_vs_sampler_policy": 516.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109026908874512, "actor_loss": -10.260278701782227, "critic_loss": 0.1724858582019806, "alpha_loss": -1.5655717849731445, "alpha_value": 0.8565276861190796, "log_alpha_value": -0.15486866235733032, "target_entropy": -6.0, "policy_t": 0.0278993621468544, "mean_q": 6.787193775177002, "max_q": 7.2381086349487305, "min_q": 6.5706562995910645}, "td_error": [0.8898305892944336, 3.132347583770752, 0.749321460723877, 1.1525547504425049, 0.5811543464660645, 0.8722043037414551, 1.4659531116485596, 1.0938262939453125, 1.5196127891540527, 0.522446870803833, 2.400608777999878, 2.0955312252044678, 1.3337769508361816, 1.7353687286376953, 1.4225692749023438, 0.1986839771270752, 0.28265976905822754, 1.058699131011963, 0.952643632888794, 1.7795987129211426, 0.6472687721252441, 0.7874298095703125, 2.039141893386841, 0.42035508155822754, 0.9520947933197021, 0.4735267162322998, 0.9886643886566162, 1.5199213027954102, 1.8668200969696045, 0.5739960670471191, 0.2581477165222168, 0.023350954055786133, 1.1780705451965332, 0.9114351272583008, 1.7351136207580566, 1.330583095550537, 1.1862387657165527, 0.9375722408294678, 1.8652997016906738, 0.5542097091674805, 1.41705322265625, 2.0667710304260254, 0.5971863269805908, 2.0749826431274414, 1.395247220993042, 2.9534919261932373, 1.5693931579589844, 0.6738834381103516, 0.985842227935791, 1.1288514137268066, 0.41826868057250977, 1.2239460945129395, 0.6202237606048584, 1.099963665008545, 2.3890533447265625, 0.3881509304046631, 1.3232026100158691, 2.191405773162842, 1.4600462913513184, 1.8005790710449219, 0.7634153366088867, 3.3697354793548584, 1.0840706825256348, 0.26037096977233887, 1.9048001766204834, 1.268829107284546, 0.7500028610229492, 1.056380271911621, 0.5085012912750244, 2.6503183841705322, 2.2109968662261963, 1.604966640472412, 0.17974495887756348, 1.5156927108764648, 0.6395809650421143, 0.7844336032867432, 0.6522066593170166, 1.4973363876342773, 0.3315720558166504, 0.8764262199401855, 0.1268777847290039, 0.8846006393432617, 2.0342471599578857, 2.9503118991851807, 1.8008167743682861, 0.7424614429473877], "mean_td_error": 1.2292426824569702, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 517.0, "diff_num_grad_updates_vs_sampler_policy": 516.0}}, "num_env_steps_sampled": 5117, "num_env_steps_trained": 133386, "num_agent_steps_sampled": 15351, "num_agent_steps_trained": 133386, "last_target_update_ts": 5117, "num_target_updates": 517}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15351, "num_agent_steps_trained": 133386, "num_env_steps_sampled": 5117, "num_env_steps_trained": 133386, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.1768239137468, "num_env_steps_trained_throughput_per_sec": 2475.945795678096, "timesteps_total": 5117, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 15351, "timers": {"training_iteration_time_ms": 104.789, "sample_time_ms": 15.398, "load_time_ms": 0.308, "load_throughput": 838535.786, "learn_time_ms": 18.338, "learn_throughput": 14069.118, "synch_weights_time_ms": 10.258}, "counters": {"num_env_steps_sampled": 5117, "num_env_steps_trained": 133386, "num_agent_steps_sampled": 15351, "num_agent_steps_trained": 133386, "last_target_update_ts": 5117, "num_target_updates": 517}, "done": false, "episodes_total": 0, "training_iteration": 38, "trial_id": "db258_00000", "date": "2023-11-16_21-49-04", "timestamp": 1700200144, "time_this_iter_s": 1.570622205734253, "time_total_s": 58.17059898376465, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 58.17059898376465, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 62.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088899612426758, "actor_loss": -14.917579650878906, "critic_loss": 0.09146818518638611, "alpha_loss": -1.6058814525604248, "alpha_value": 0.8528487086296082, "log_alpha_value": -0.15917308628559113, "target_entropy": -6.0, "policy_t": 0.009580210782587528, "mean_q": 11.481110572814941, "max_q": 12.258228302001953, "min_q": 10.701319694519043}, "td_error": [1.497201919555664, 2.0815486907958984, 0.06725168228149414, 1.3465161323547363, 1.6458840370178223, 0.32352542877197266, 0.5461149215698242, 1.6086797714233398, 0.6739883422851562, 0.17064714431762695, 1.016953945159912, 0.8233089447021484, 1.2743263244628906, 1.5599193572998047, 0.13886690139770508, 3.0181045532226562, 0.1589674949645996, 0.24005365371704102, 1.486640453338623, 1.2461891174316406, 0.9823079109191895, 1.0407719612121582, 1.379049301147461, 0.25943660736083984, 1.2768311500549316, 1.658247947692871, 0.3356781005859375, 0.25439453125, 1.4962553977966309, 0.4421730041503906, 1.257983684539795, 1.9358038902282715, 2.209486484527588, 1.209911823272705, 1.5008859634399414, 1.476747989654541, 0.7511372566223145, 0.17418479919433594, 1.6809577941894531, 1.1078424453735352, 0.6479167938232422, 0.8023476600646973, 1.3561043739318848, 0.6996726989746094, 0.7554311752319336, 1.4974517822265625, 1.032421588897705, 0.4906597137451172, 2.1198806762695312, 1.0556812286376953, 1.1334233283996582, 0.0989069938659668, 0.05153656005859375, 0.9836115837097168, 1.0464091300964355, 0.1363964080810547, 0.7396783828735352, 0.5475845336914062, 0.35945892333984375, 1.3410115242004395, 0.049246788024902344, 0.11514568328857422, 1.7010011672973633, 0.5746583938598633, 2.931629180908203, 0.5936770439147949, 1.8238139152526855, 0.5821013450622559, 2.6365060806274414, 0.171142578125, 1.3957633972167969, 0.9211459159851074, 0.38907814025878906, 1.917435646057129, 0.8398385047912598, 0.4247856140136719, 0.9974961280822754, 0.22135448455810547, 2.1257858276367188, 2.3571887016296387, 0.0848994255065918, 0.7017569541931152, 1.0362615585327148, 0.16811895370483398, 2.2205543518066406, 1.6783161163330078], "mean_td_error": 1.033826231956482, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 532.0, "diff_num_grad_updates_vs_sampler_policy": 531.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097755432128906, "actor_loss": -10.748409271240234, "critic_loss": 0.12730449438095093, "alpha_loss": -1.6089200973510742, "alpha_value": 0.8527112007141113, "log_alpha_value": -0.15933439135551453, "target_entropy": -6.0, "policy_t": -0.019840100780129433, "mean_q": 7.301202297210693, "max_q": 7.857466697692871, "min_q": 6.963644504547119}, "td_error": [1.988945484161377, 0.15775847434997559, 0.992760181427002, 0.3282952308654785, 2.7810094356536865, 2.0739309787750244, 1.0418858528137207, 0.47547364234924316, 1.5609369277954102, 3.498645305633545, 0.9610116481781006, 1.9356458187103271, 1.545747995376587, 1.3954007625579834, 0.5565352439880371, 2.123563289642334, 0.6838922500610352, 1.0125091075897217, 0.39466238021850586, 1.1710078716278076, 2.160940170288086, 1.5780296325683594, 0.5831985473632812, 0.26234865188598633, 1.635094404220581, 0.6147787570953369, 0.7523062229156494, 1.190464735031128, 0.6743664741516113, 0.8472299575805664, 1.1722524166107178, 2.4855899810791016, 0.7200181484222412, 0.36579036712646484, 0.40091800689697266, 1.0560266971588135, 0.25041723251342773, 2.131366491317749, 1.9247713088989258, 0.5412757396697998, 1.8616247177124023, 2.5574800968170166, 0.6929247379302979, 0.8534061908721924, 1.1117253303527832, 0.21161890029907227, 1.4965412616729736, 0.9338505268096924, 0.1718742847442627, 2.5119667053222656, 1.0895299911499023, 0.4063849449157715, 0.2401747703552246, 1.1491773128509521, 0.8770732879638672, 0.8286523818969727, 1.5383663177490234, 1.1505427360534668, 1.9056601524353027, 1.707810640335083, 0.9790439605712891, 1.2957353591918945, 1.4135065078735352, 0.01759052276611328, 1.5579180717468262, 1.9817776679992676, 0.4948716163635254, 1.215181589126587, 0.42470669746398926, 1.2837247848510742, 1.6443049907684326, 1.2805426120758057, 2.286322593688965, 0.9655883312225342, 1.2367703914642334, 2.3222293853759766, 1.815762996673584, 1.8412706851959229, 0.640192985534668, 1.3883159160614014, 1.8942720890045166, 2.454648733139038, 1.9151759147644043, 2.178133487701416, 0.4318277835845947, 1.1935224533081055], "mean_td_error": 1.2497224807739258, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 532.0, "diff_num_grad_updates_vs_sampler_policy": 531.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069342613220215, "actor_loss": -10.653552055358887, "critic_loss": 0.171474426984787, "alpha_loss": -1.6047784090042114, "alpha_value": 0.8526785373687744, "log_alpha_value": -0.15937268733978271, "target_entropy": -6.0, "policy_t": 0.024746611714363098, "mean_q": 7.228673934936523, "max_q": 7.668091773986816, "min_q": 7.012485980987549}, "td_error": [0.40106916427612305, 1.5080351829528809, 0.7549841403961182, 1.8236234188079834, 1.9812111854553223, 1.8835864067077637, 0.8735356330871582, 1.8379039764404297, 0.91156005859375, 1.0483582019805908, 0.9584231376647949, 0.8175032138824463, 1.560828447341919, 0.9258954524993896, 0.12116360664367676, 0.945805549621582, 2.2046122550964355, 1.4324731826782227, 0.9124763011932373, 1.0064990520477295, 2.77121639251709, 0.07344770431518555, 1.5559258460998535, 0.17066693305969238, 1.5635285377502441, 0.6369938850402832, 1.1082024574279785, 1.7901451587677002, 2.0695862770080566, 1.6321017742156982, 0.11220407485961914, 1.3457653522491455, 0.719477653503418, 1.794909954071045, 1.085658073425293, 1.758528709411621, 0.33029890060424805, 0.723106861114502, 0.7293682098388672, 0.5864217281341553, 3.148764133453369, 1.1592271327972412, 2.4606661796569824, 2.707848310470581, 0.8054594993591309, 1.1506807804107666, 1.0979068279266357, 2.064894437789917, 0.9664764404296875, 1.1882281303405762, 0.48878955841064453, 1.874952793121338, 0.4772307872772217, 0.9903609752655029, 1.3974032402038574, 1.1981594562530518, 0.9566333293914795, 1.6541485786437988, 0.6177711486816406, 1.4078752994537354, 0.8713734149932861, 0.7126786708831787, 1.8920230865478516, 0.4697413444519043, 0.9430131912231445, 0.5547118186950684, 0.6929788589477539, 0.18147039413452148, 1.5406088829040527, 0.7780125141143799, 1.1853437423706055, 2.415375232696533, 0.14776611328125, 2.5459988117218018, 0.06443095207214355, 1.4017016887664795, 1.0603344440460205, 2.3870792388916016, 2.2677671909332275, 1.0260136127471924, 1.1304247379302979, 0.7675497531890869, 0.07994771003723145, 2.851017713546753, 2.163090467453003, 0.290630578994751], "mean_td_error": 1.217461109161377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 532.0, "diff_num_grad_updates_vs_sampler_policy": 531.0}}, "num_env_steps_sampled": 5222, "num_env_steps_trained": 137256, "num_agent_steps_sampled": 15666, "num_agent_steps_trained": 137256, "last_target_update_ts": 5222, "num_target_updates": 532}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15666, "num_agent_steps_trained": 137256, "num_env_steps_sampled": 5222, "num_env_steps_trained": 137256, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.16875037843265, "num_env_steps_trained_throughput_per_sec": 2475.64822823366, "timesteps_total": 5222, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 15666, "timers": {"training_iteration_time_ms": 104.452, "sample_time_ms": 15.672, "load_time_ms": 0.32, "load_throughput": 807439.511, "learn_time_ms": 17.872, "learn_throughput": 14436.182, "synch_weights_time_ms": 10.395}, "counters": {"num_env_steps_sampled": 5222, "num_env_steps_trained": 137256, "num_agent_steps_sampled": 15666, "num_agent_steps_trained": 137256, "last_target_update_ts": 5222, "num_target_updates": 532}, "done": false, "episodes_total": 0, "training_iteration": 39, "trial_id": "db258_00000", "date": "2023-11-16_21-49-06", "timestamp": 1700200146, "time_this_iter_s": 1.573173999786377, "time_total_s": 59.743772983551025, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 59.743772983551025, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.25, "ram_util_percent": 62.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.979296684265137, "actor_loss": -15.09988021850586, "critic_loss": 0.10599452257156372, "alpha_loss": -1.6333279609680176, "alpha_value": 0.8490207195281982, "log_alpha_value": -0.16367165744304657, "target_entropy": -6.0, "policy_t": -0.08329799771308899, "mean_q": 11.715760231018066, "max_q": 12.50357437133789, "min_q": 10.874204635620117}, "td_error": [0.7969088554382324, 0.07999515533447266, 0.11042070388793945, 0.9187579154968262, 0.8124775886535645, 1.8654565811157227, 0.8784389495849609, 1.7693891525268555, 0.8354911804199219, 1.0654239654541016, 0.5448293685913086, 1.323972225189209, 1.5093803405761719, 0.6356978416442871, 1.6277055740356445, 3.037031650543213, 1.4683451652526855, 0.03572654724121094, 1.424093246459961, 0.1158299446105957, 2.0550031661987305, 1.6440486907958984, 0.8969850540161133, 1.5094852447509766, 0.8386044502258301, 1.0290913581848145, 1.1086149215698242, 2.6782031059265137, 2.5220232009887695, 0.7566213607788086, 0.31194400787353516, 1.0127272605895996, 1.7414989471435547, 0.510589599609375, 0.5848774909973145, 0.909308910369873, 1.8062968254089355, 0.4250040054321289, 0.7327604293823242, 0.9742031097412109, 2.416914463043213, 0.14122819900512695, 0.8494977951049805, 2.0765910148620605, 1.5572261810302734, 0.41138505935668945, 0.8448987007141113, 1.2407407760620117, 1.9956436157226562, 0.8502435684204102, 2.0390682220458984, 1.2659306526184082, 0.48840808868408203, 1.025937557220459, 1.3377771377563477, 2.1444506645202637, 3.1878857612609863, 0.6970691680908203, 0.7769546508789062, 1.9086008071899414, 0.610114574432373, 1.161879539489746, 0.19961833953857422, 1.521768569946289, 2.220402717590332, 0.7854595184326172, 0.7760019302368164, 0.4923133850097656, 2.920928955078125, 2.3174190521240234, 0.6375732421875, 1.6845335960388184, 0.3713221549987793, 0.920966625213623, 0.5222711563110352, 0.40800905227661133, 1.1543288230895996, 1.2287840843200684, 1.6028966903686523, 2.7139506340026855, 1.3314948081970215, 0.46568965911865234, 0.7483310699462891, 1.534388542175293, 0.18863391876220703, 0.48143720626831055], "mean_td_error": 1.1762818098068237, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 547.0, "diff_num_grad_updates_vs_sampler_policy": 546.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06074333190918, "actor_loss": -10.552775382995605, "critic_loss": 0.12620952725410461, "alpha_loss": -1.6482900381088257, "alpha_value": 0.8488830924034119, "log_alpha_value": -0.1638338267803192, "target_entropy": -6.0, "policy_t": 0.0031610976438969374, "mean_q": 7.1511335372924805, "max_q": 7.654862880706787, "min_q": 6.818726539611816}, "td_error": [1.3907651901245117, 1.1083080768585205, 1.7501542568206787, 1.0290448665618896, 1.0931596755981445, 0.4111452102661133, 0.5342233180999756, 2.3526461124420166, 0.9040942192077637, 1.9150516986846924, 0.6326274871826172, 1.8764798641204834, 1.806067943572998, 1.1143138408660889, 0.9304673671722412, 1.246737003326416, 0.1792459487915039, 1.303893804550171, 1.581911325454712, 0.8967797756195068, 0.05631542205810547, 2.409903049468994, 0.547513484954834, 0.0968637466430664, 0.7553727626800537, 0.6439502239227295, 0.9893395900726318, 0.758389949798584, 2.9990944862365723, 1.2746357917785645, 0.9528839588165283, 2.080293893814087, 1.517637014389038, 0.727665901184082, 2.772202491760254, 1.1800673007965088, 1.3124172687530518, 0.7313222885131836, 0.07084941864013672, 0.9850001335144043, 1.9940013885498047, 0.6992180347442627, 0.6573715209960938, 0.9880867004394531, 1.3089115619659424, 0.8384675979614258, 0.4199483394622803, 1.4117858409881592, 1.818427562713623, 0.4672276973724365, 1.298661470413208, 1.6628026962280273, 0.9118950366973877, 1.77439546585083, 2.380554437637329, 1.953251838684082, 0.9612846374511719, 0.9759840965270996, 1.0642237663269043, 0.8854272365570068, 1.376570224761963, 1.6856753826141357, 0.9740369319915771, 1.2559089660644531, 0.26113224029541016, 1.6882421970367432, 1.3774468898773193, 1.263805627822876, 1.3222930431365967, 1.8000009059906006, 0.33757853507995605, 1.257460117340088, 1.8759045600891113, 0.7569160461425781, 1.799783706665039, 1.9585645198822021, 2.2851037979125977, 0.04079389572143555, 1.7241334915161133, 0.5999445915222168, 2.226506471633911, 1.4688997268676758, 2.2381179332733154, 0.12436246871948242, 1.1190524101257324, 1.5537455081939697], "mean_td_error": 1.2297992706298828, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 547.0, "diff_num_grad_updates_vs_sampler_policy": 546.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.172250747680664, "actor_loss": -10.897506713867188, "critic_loss": 0.15124155580997467, "alpha_loss": -1.6669673919677734, "alpha_value": 0.8488489985466003, "log_alpha_value": -0.16387398540973663, "target_entropy": -6.0, "policy_t": 0.029443388804793358, "mean_q": 7.386432647705078, "max_q": 7.805219650268555, "min_q": 7.133586406707764}, "td_error": [1.5115966796875, 0.9257762432098389, 1.2361257076263428, 1.4958171844482422, 1.3754265308380127, 0.7877166271209717, 0.7481198310852051, 0.2973144054412842, 1.3283684253692627, 0.5100710391998291, 1.0441174507141113, 1.8812966346740723, 0.3039073944091797, 1.319148063659668, 0.3147573471069336, 0.22613072395324707, 1.5088610649108887, 0.5789527893066406, 1.577148675918579, 0.49373793601989746, 1.3360600471496582, 0.6211438179016113, 1.2843546867370605, 0.7099170684814453, 1.203115463256836, 1.108426570892334, 0.4896202087402344, 0.5168664455413818, 0.5727694034576416, 0.9820010662078857, 0.7071633338928223, 1.2375688552856445, 1.7242817878723145, 1.6324794292449951, 0.66267991065979, 1.151789665222168, 1.0587677955627441, 0.5903964042663574, 1.2509584426879883, 1.0350165367126465, 1.338548183441162, 1.7424249649047852, 0.716930627822876, 1.0509331226348877, 2.1743669509887695, 0.7227270603179932, 0.3686084747314453, 0.40760064125061035, 1.0581345558166504, 1.9420077800750732, 1.4301362037658691, 0.2836177349090576, 0.7880825996398926, 1.0449514389038086, 1.5239715576171875, 1.926800012588501, 1.3853354454040527, 0.4444108009338379, 0.7724106311798096, 0.17165279388427734, 2.7194995880126953, 0.6092183589935303, 1.188565731048584, 2.4966843128204346, 0.4481947422027588, 1.835972785949707, 1.044018268585205, 1.8888516426086426, 2.0062484741210938, 1.3128979206085205, 0.9810953140258789, 0.5339455604553223, 1.9505443572998047, 1.9875638484954834, 1.7760460376739502, 0.5704038143157959, 0.733273983001709, 1.7179076671600342, 1.7293224334716797, 1.0106351375579834, 2.861598014831543, 1.0525565147399902, 0.7360351085662842, 0.05286455154418945, 1.6417937278747559, 0.621279239654541], "mean_td_error": 1.1179120540618896, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 547.0, "diff_num_grad_updates_vs_sampler_policy": 546.0}}, "num_env_steps_sampled": 5327, "num_env_steps_trained": 141126, "num_agent_steps_sampled": 15981, "num_agent_steps_trained": 141126, "last_target_update_ts": 5327, "num_target_updates": 547}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15981, "num_agent_steps_trained": 141126, "num_env_steps_sampled": 5327, "num_env_steps_trained": 141126, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.37874861502392, "num_env_steps_trained_throughput_per_sec": 2483.388163239453, "timesteps_total": 5327, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 15981, "timers": {"training_iteration_time_ms": 104.273, "sample_time_ms": 15.75, "load_time_ms": 0.317, "load_throughput": 813570.733, "learn_time_ms": 18.123, "learn_throughput": 14236.236, "synch_weights_time_ms": 10.075}, "counters": {"num_env_steps_sampled": 5327, "num_env_steps_trained": 141126, "num_agent_steps_sampled": 15981, "num_agent_steps_trained": 141126, "last_target_update_ts": 5327, "num_target_updates": 547}, "done": false, "episodes_total": 0, "training_iteration": 40, "trial_id": "db258_00000", "date": "2023-11-16_21-49-07", "timestamp": 1700200147, "time_this_iter_s": 1.5691378116607666, "time_total_s": 61.31291079521179, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 61.31291079521179, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.833333333333332, "ram_util_percent": 62.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00263786315918, "actor_loss": -15.339494705200195, "critic_loss": 0.09383827447891235, "alpha_loss": -1.6821620464324951, "alpha_value": 0.8452085852622986, "log_alpha_value": -0.16817185282707214, "target_entropy": -6.0, "policy_t": -0.010975375771522522, "mean_q": 11.971783638000488, "max_q": 12.815105438232422, "min_q": 11.064494132995605}, "td_error": [1.4688568115234375, 0.583228588104248, 1.1228351593017578, 1.9352397918701172, 1.906569480895996, 0.7061042785644531, 0.18341922760009766, 1.1471891403198242, 2.5923357009887695, 0.565342903137207, 2.5542664527893066, 0.20575618743896484, 0.7356138229370117, 0.18235063552856445, 0.626307487487793, 1.652252197265625, 1.0289173126220703, 2.417172908782959, 0.6797046661376953, 1.6656122207641602, 0.3279447555541992, 2.0804595947265625, 1.9672942161560059, 1.9906964302062988, 0.9104909896850586, 0.6914997100830078, 0.49874305725097656, 0.548891544342041, 0.9469137191772461, 1.182023048400879, 1.947312355041504, 0.433072566986084, 2.506175994873047, 0.4337644577026367, 1.8051109313964844, 0.9166502952575684, 1.034135341644287, 1.0728793144226074, 0.10425043106079102, 0.6749262809753418, 0.39951467514038086, 0.5136475563049316, 0.09275627136230469, 1.4215912818908691, 1.441941261291504, 0.26990699768066406, 1.0138063430786133, 0.5563669204711914, 0.9260439872741699, 1.3808937072753906, 0.44548463821411133, 0.5663185119628906, 0.7674751281738281, 1.196953296661377, 0.5072669982910156, 2.259280204772949, 1.253507137298584, 1.2459135055541992, 1.9139056205749512, 0.4392108917236328, 0.16396236419677734, 0.974524974822998, 0.6393508911132812, 2.825934410095215, 1.2616620063781738, 1.477931022644043, 0.8946094512939453, 0.652125358581543, 0.6392087936401367, 0.25914907455444336, 0.1086130142211914, 1.4045462608337402, 0.30759191513061523, 1.1177139282226562, 0.18566322326660156, 2.0921831130981445, 1.561140537261963, 2.0983080863952637, 1.3254814147949219, 0.744964599609375, 2.220451831817627, 0.09395122528076172, 1.5035834312438965, 1.1324357986450195, 1.3902382850646973, 0.9720873832702637], "mean_td_error": 1.0778082609176636, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 562.0, "diff_num_grad_updates_vs_sampler_policy": 561.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12736988067627, "actor_loss": -11.06840991973877, "critic_loss": 0.11352407187223434, "alpha_loss": -1.7048015594482422, "alpha_value": 0.8450698256492615, "log_alpha_value": -0.16833604872226715, "target_entropy": -6.0, "policy_t": 0.009707075543701649, "mean_q": 7.6651291847229, "max_q": 8.029457092285156, "min_q": 7.380088806152344}, "td_error": [1.0033252239227295, 1.8637855052947998, 2.1011788845062256, 1.3338649272918701, 1.737844705581665, 1.5472311973571777, 0.04485607147216797, 0.7936840057373047, 1.470689296722412, 1.1931233406066895, 0.6724600791931152, 1.7432749271392822, 0.9414300918579102, 1.4094281196594238, 2.1461973190307617, 0.8935911655426025, 1.0994338989257812, 1.1086616516113281, 2.6432409286499023, 0.2544372081756592, 1.4847831726074219, 1.26942777633667, 0.10085391998291016, 3.0108137130737305, 1.646310567855835, 0.9315385818481445, 0.7562000751495361, 1.4290246963500977, 2.5612552165985107, 0.14123749732971191, 0.7476761341094971, 0.7657406330108643, 1.0344188213348389, 0.9498653411865234, 2.0051817893981934, 0.5853979587554932, 0.9994263648986816, 2.334120750427246, 1.876452922821045, 1.6530191898345947, 0.6659083366394043, 2.3554530143737793, 0.23712515830993652, 0.770845890045166, 1.8372225761413574, 0.8307051658630371, 0.313143253326416, 0.19265341758728027, 0.8847396373748779, 0.26790666580200195, 0.5568010807037354, 1.6456184387207031, 0.22497773170471191, 2.21767520904541, 2.142212390899658, 1.332237720489502, 0.2886624336242676, 0.1470801830291748, 1.979393720626831, 0.2962660789489746, 1.8683052062988281, 0.9684939384460449, 2.1558356285095215, 0.8034346103668213, 1.4461100101470947, 0.3362770080566406, 0.40273451805114746, 1.1079461574554443, 1.1276438236236572, 0.6623497009277344, 2.3088550567626953, 0.8046314716339111, 1.688584566116333, 1.4165892601013184, 1.0889372825622559, 0.8044195175170898, 0.16895008087158203, 0.21952199935913086, 0.11937952041625977, 0.949371337890625, 0.22021961212158203, 0.13031816482543945, 2.4918248653411865, 0.44057202339172363, 0.1436147689819336, 0.4826507568359375], "mean_td_error": 1.1142868995666504, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 562.0, "diff_num_grad_updates_vs_sampler_policy": 561.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09945011138916, "actor_loss": -11.12502384185791, "critic_loss": 0.169852614402771, "alpha_loss": -1.7005391120910645, "alpha_value": 0.8450331687927246, "log_alpha_value": -0.16837938129901886, "target_entropy": -6.0, "policy_t": 0.006733851041644812, "mean_q": 7.68356466293335, "max_q": 7.985991477966309, "min_q": 7.450429916381836}, "td_error": [1.7168469429016113, 1.0392060279846191, 0.27480602264404297, 1.7055373191833496, 0.9120726585388184, 0.8792886734008789, 1.0964016914367676, 1.4139821529388428, 1.1714673042297363, 0.6671254634857178, 1.5059165954589844, 2.302186965942383, 1.503183364868164, 1.326183557510376, 0.60904860496521, 1.971909999847412, 0.48987603187561035, 1.1856403350830078, 1.1417267322540283, 0.12418317794799805, 0.9047317504882812, 0.3622403144836426, 0.7077693939208984, 1.8997912406921387, 2.551896095275879, 0.8722541332244873, 1.3776402473449707, 1.0812456607818604, 2.3745276927948, 0.4146721363067627, 0.8049638271331787, 0.5356025695800781, 0.8700318336486816, 0.8193397521972656, 1.0157241821289062, 0.33619117736816406, 2.615936040878296, 2.3485193252563477, 1.5885190963745117, 0.971224308013916, 1.9430224895477295, 2.1648507118225098, 0.11223053932189941, 2.6989023685455322, 1.9620039463043213, 0.9556057453155518, 0.01066136360168457, 1.907975673675537, 0.5072338581085205, 1.6807985305786133, 1.3622016906738281, 1.0797450542449951, 0.8607654571533203, 2.248943328857422, 2.0722930431365967, 0.7458901405334473, 0.18300247192382812, 2.463003158569336, 2.095425605773926, 0.38201332092285156, 0.7194356918334961, 0.34148454666137695, 0.8659937381744385, 0.3494441509246826, 1.5337145328521729, 2.3670105934143066, 2.1233069896698, 0.4766998291015625, 0.720341682434082, 2.6664175987243652, 1.3346054553985596, 0.6778564453125, 0.37481045722961426, 1.1525061130523682, 0.5658652782440186, 2.1581764221191406, 0.10545516014099121, 0.7780108451843262, 1.1086578369140625, 0.9697251319885254, 1.4968867301940918, 1.1882565021514893, 0.47705912590026855, 1.1797099113464355, 1.0516283512115479, 1.9140548706054688], "mean_td_error": 1.204919695854187, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 562.0, "diff_num_grad_updates_vs_sampler_policy": 561.0}}, "num_env_steps_sampled": 5432, "num_env_steps_trained": 144996, "num_agent_steps_sampled": 16296, "num_agent_steps_trained": 144996, "last_target_update_ts": 5432, "num_target_updates": 562}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16296, "num_agent_steps_trained": 144996, "num_env_steps_sampled": 5432, "num_env_steps_trained": 144996, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.75046216720845, "num_env_steps_trained_throughput_per_sec": 2497.088462734255, "timesteps_total": 5432, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 16296, "timers": {"training_iteration_time_ms": 103.328, "sample_time_ms": 15.547, "load_time_ms": 0.31, "load_throughput": 832600.163, "learn_time_ms": 17.979, "learn_throughput": 14350.093, "synch_weights_time_ms": 9.767}, "counters": {"num_env_steps_sampled": 5432, "num_env_steps_trained": 144996, "num_agent_steps_sampled": 16296, "num_agent_steps_trained": 144996, "last_target_update_ts": 5432, "num_target_updates": 562}, "done": false, "episodes_total": 0, "training_iteration": 41, "trial_id": "db258_00000", "date": "2023-11-16_21-49-09", "timestamp": 1700200149, "time_this_iter_s": 1.5593006610870361, "time_total_s": 62.87221145629883, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb77e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 62.87221145629883, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.4, "ram_util_percent": 62.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.034771919250488, "actor_loss": -15.462004661560059, "critic_loss": 0.10054472833871841, "alpha_loss": -1.732804775238037, "alpha_value": 0.8414068222045898, "log_alpha_value": -0.17268002033233643, "target_entropy": -6.0, "policy_t": -0.02355276606976986, "mean_q": 12.055102348327637, "max_q": 12.792816162109375, "min_q": 11.287252426147461}, "td_error": [1.8467016220092773, 0.662050724029541, 0.6553945541381836, 0.22568368911743164, 0.7156243324279785, 0.42821216583251953, 0.7264871597290039, 0.49366331100463867, 1.6312403678894043, 1.127976417541504, 0.9156832695007324, 1.7334957122802734, 1.4963207244873047, 0.8383698463439941, 0.6363749504089355, 0.12557220458984375, 0.1028127670288086, 0.9768428802490234, 2.221247673034668, 1.7003960609436035, 1.5462298393249512, 1.5357232093811035, 0.6490669250488281, 1.1948637962341309, 2.592944622039795, 1.1722726821899414, 0.8478012084960938, 0.20199155807495117, 0.5081400871276855, 1.183286190032959, 1.0604205131530762, 1.6748847961425781, 2.7236223220825195, 1.389430046081543, 1.385575771331787, 2.171492576599121, 1.094594955444336, 0.8043122291564941, 0.07112789154052734, 0.5762042999267578, 0.9962906837463379, 0.5534672737121582, 0.7207903861999512, 0.7272672653198242, 0.9659080505371094, 0.7195072174072266, 1.4125666618347168, 1.2268257141113281, 1.073927879333496, 1.2647581100463867, 3.097768783569336, 1.3377671241760254, 1.2042007446289062, 1.4985570907592773, 1.2352499961853027, 1.1163334846496582, 2.0368871688842773, 0.7880911827087402, 0.5386190414428711, 1.748377799987793, 0.4204373359680176, 1.2896099090576172, 1.8008174896240234, 0.6494202613830566, 0.46887779235839844, 1.550058364868164, 0.8374309539794922, 1.2315988540649414, 0.5733966827392578, 1.5316243171691895, 2.13137149810791, 0.5471363067626953, 0.8170499801635742, 1.448282241821289, 1.7786035537719727, 3.2896957397460938, 0.9490909576416016, 0.5736789703369141, 1.805626392364502, 0.666435718536377, 1.108487606048584, 0.10386419296264648, 0.5839648246765137, 1.767129898071289, 0.766627311706543, 0.9404916763305664], "mean_td_error": 1.1341640949249268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 577.0, "diff_num_grad_updates_vs_sampler_policy": 576.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.040120124816895, "actor_loss": -10.987940788269043, "critic_loss": 0.11844131350517273, "alpha_loss": -1.7353315353393555, "alpha_value": 0.8412724733352661, "log_alpha_value": -0.1728397160768509, "target_entropy": -6.0, "policy_t": 0.025810711085796356, "mean_q": 7.635377407073975, "max_q": 8.161689758300781, "min_q": 7.275574684143066}, "td_error": [0.9846522808074951, 2.653660297393799, 1.240654706954956, 0.6932380199432373, 1.3186910152435303, 1.357130527496338, 1.4501447677612305, 1.1345758438110352, 0.5973999500274658, 0.5878596305847168, 2.8369970321655273, 1.2132668495178223, 2.0795960426330566, 0.5207734107971191, 0.37789416313171387, 1.8168487548828125, 0.612856388092041, 0.5724577903747559, 2.800002336502075, 0.13914704322814941, 0.06288957595825195, 0.44658899307250977, 2.334437847137451, 0.2576167583465576, 1.658362627029419, 1.3141188621520996, 0.5233135223388672, 1.0962872505187988, 0.35889482498168945, 2.4525699615478516, 0.38220787048339844, 1.5090839862823486, 1.0811529159545898, 1.5007047653198242, 0.5505280494689941, 2.3713576793670654, 0.8738598823547363, 0.0166471004486084, 0.9800739288330078, 1.3521296977996826, 0.39545392990112305, 0.737156867980957, 1.395890712738037, 1.5868215560913086, 0.9101235866546631, 0.9860904216766357, 0.6304507255554199, 0.037584543228149414, 1.4781293869018555, 0.965134859085083, 1.7529034614562988, 2.7348580360412598, 0.15610623359680176, 0.49744558334350586, 0.04899191856384277, 0.18901753425598145, 0.8392837047576904, 2.2645435333251953, 1.923292636871338, 2.314899206161499, 0.9689145088195801, 1.738598346710205, 0.8894319534301758, 1.7011840343475342, 1.2571866512298584, 1.788808822631836, 1.1967391967773438, 3.422865867614746, 1.4298748970031738, 1.0095505714416504, 1.7243692874908447, 0.8364384174346924, 0.6435196399688721, 0.02879047393798828, 0.7058877944946289, 0.960078239440918, 0.2658367156982422, 1.12646484375, 1.609743595123291, 2.218606472015381, 0.673001766204834, 0.5589513778686523, 2.0256552696228027, 1.86661696434021, 0.293745756149292, 2.2499783039093018], "mean_td_error": 1.1761126518249512, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 577.0, "diff_num_grad_updates_vs_sampler_policy": 576.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084667205810547, "actor_loss": -11.034566879272461, "critic_loss": 0.1398167759180069, "alpha_loss": -1.7435015439987183, "alpha_value": 0.8412331938743591, "log_alpha_value": -0.17288640141487122, "target_entropy": -6.0, "policy_t": 0.024931110441684723, "mean_q": 7.674365520477295, "max_q": 7.997868537902832, "min_q": 7.416266918182373}, "td_error": [1.048332691192627, 1.7812871932983398, 1.024036169052124, 0.44271373748779297, 0.8740816116333008, 0.2485971450805664, 1.0205440521240234, 0.10407900810241699, 1.5180552005767822, 1.4020264148712158, 0.2524454593658447, 0.9848551750183105, 1.5097548961639404, 1.2342016696929932, 0.5012433528900146, 1.7697687149047852, 0.4878079891204834, 0.1354377269744873, 2.296873092651367, 1.5186405181884766, 1.8599488735198975, 0.27704381942749023, 0.9505794048309326, 1.2623376846313477, 1.0076022148132324, 1.0488061904907227, 0.6531095504760742, 1.233048439025879, 0.6235275268554688, 1.4236602783203125, 0.2040565013885498, 1.593735694885254, 1.8209121227264404, 0.2783074378967285, 0.12406635284423828, 1.776667594909668, 2.512237071990967, 0.6588113307952881, 0.0420989990234375, 2.0028066635131836, 1.82975172996521, 0.29464054107666016, 0.16003751754760742, 0.895953893661499, 0.1195991039276123, 0.15066909790039062, 0.09627342224121094, 0.24861717224121094, 1.6363465785980225, 1.2958643436431885, 0.5945949554443359, 1.0529656410217285, 2.092714786529541, 0.6629045009613037, 0.6974477767944336, 2.2874369621276855, 0.5201570987701416, 1.0528137683868408, 0.12059664726257324, 0.5864455699920654, 2.3502728939056396, 1.7939567565917969, 1.4821507930755615, 0.3681666851043701, 1.0435974597930908, 1.1370158195495605, 0.9567506313323975, 1.2307734489440918, 1.2422771453857422, 0.7803912162780762, 1.4476985931396484, 1.6466913223266602, 1.0632271766662598, 0.9453582763671875, 1.969724178314209, 1.1265802383422852, 1.7351038455963135, 0.6816658973693848, 1.24489426612854, 1.9514148235321045, 0.5456421375274658, 1.4714200496673584, 0.7155234813690186, 0.6967685222625732, 0.7068991661071777, 1.6854383945465088], "mean_td_error": 1.0456206798553467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 577.0, "diff_num_grad_updates_vs_sampler_policy": 576.0}}, "num_env_steps_sampled": 5537, "num_env_steps_trained": 148866, "num_agent_steps_sampled": 16611, "num_agent_steps_trained": 148866, "last_target_update_ts": 5537, "num_target_updates": 577}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16611, "num_agent_steps_trained": 148866, "num_env_steps_sampled": 5537, "num_env_steps_trained": 148866, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.32594850596361, "num_env_steps_trained_throughput_per_sec": 2481.4421020769446, "timesteps_total": 5537, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 16611, "timers": {"training_iteration_time_ms": 104.564, "sample_time_ms": 16.248, "load_time_ms": 0.317, "load_throughput": 814673.215, "learn_time_ms": 18.187, "learn_throughput": 14185.568, "synch_weights_time_ms": 9.557}, "counters": {"num_env_steps_sampled": 5537, "num_env_steps_trained": 148866, "num_agent_steps_sampled": 16611, "num_agent_steps_trained": 148866, "last_target_update_ts": 5537, "num_target_updates": 577}, "done": false, "episodes_total": 0, "training_iteration": 42, "trial_id": "db258_00000", "date": "2023-11-16_21-49-10", "timestamp": 1700200150, "time_this_iter_s": 1.5683259963989258, "time_total_s": 64.44053745269775, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 64.44053745269775, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.700000000000003, "ram_util_percent": 62.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.967090606689453, "actor_loss": -15.769288063049316, "critic_loss": 0.10029730200767517, "alpha_loss": -1.7660577297210693, "alpha_value": 0.8376215696334839, "log_alpha_value": -0.17718888819217682, "target_entropy": -6.0, "policy_t": 0.028481291607022285, "mean_q": 12.474849700927734, "max_q": 13.301898002624512, "min_q": 11.640029907226562}, "td_error": [1.5270466804504395, 2.857667922973633, 2.02944278717041, 0.5729484558105469, 0.7127513885498047, 0.6894922256469727, 0.45604896545410156, 0.5185770988464355, 1.6732687950134277, 0.2600588798522949, 0.5851345062255859, 0.6347708702087402, 0.2680354118347168, 1.7557854652404785, 1.1029748916625977, 2.8245887756347656, 0.34920406341552734, 0.49442291259765625, 0.5902233123779297, 0.8403325080871582, 0.206024169921875, 1.7087740898132324, 0.6283020973205566, 0.1569690704345703, 1.3629212379455566, 1.2481627464294434, 0.2983207702636719, 2.0115609169006348, 2.0975875854492188, 0.3925437927246094, 1.736320972442627, 0.591865062713623, 0.48755836486816406, 1.8875541687011719, 0.2589845657348633, 1.2703194618225098, 2.8656835556030273, 2.669149398803711, 0.9722447395324707, 1.1687021255493164, 1.401296615600586, 1.0481157302856445, 1.2900943756103516, 1.7015433311462402, 1.4582428932189941, 0.05214357376098633, 0.6002607345581055, 0.39237403869628906, 1.849313735961914, 0.6745791435241699, 1.0055880546569824, 0.14091110229492188, 0.48813819885253906, 2.0834946632385254, 1.6226239204406738, 1.8959527015686035, 1.2723393440246582, 0.9281630516052246, 0.4768047332763672, 0.9096612930297852, 1.8009796142578125, 0.7532553672790527, 0.7967319488525391, 0.694972038269043, 1.1271324157714844, 1.9367690086364746, 0.557225227355957, 1.4477357864379883, 0.7157363891601562, 1.18617582321167, 0.1054220199584961, 1.2066240310668945, 1.3327832221984863, 0.25609302520751953, 1.2603540420532227, 0.1706676483154297, 1.440812587738037, 1.7358388900756836, 1.3450117111206055, 0.7421913146972656, 1.017467975616455, 2.018237590789795, 0.9347052574157715, 2.7401299476623535, 1.572382926940918, 1.6098856925964355], "mean_td_error": 1.1227824687957764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 592.0, "diff_num_grad_updates_vs_sampler_policy": 591.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122947692871094, "actor_loss": -11.066837310791016, "critic_loss": 0.10677814483642578, "alpha_loss": -1.7952557802200317, "alpha_value": 0.8374906778335571, "log_alpha_value": -0.1773451566696167, "target_entropy": -6.0, "policy_t": -0.03060050681233406, "mean_q": 7.631229877471924, "max_q": 8.096136093139648, "min_q": 7.276179790496826}, "td_error": [0.8672428131103516, 1.6614179611206055, 0.9977931976318359, 1.9386579990386963, 0.9722199440002441, 0.12832260131835938, 2.310953378677368, 0.3471221923828125, 0.6815674304962158, 1.6691992282867432, 1.445737600326538, 1.2730381488800049, 0.9451558589935303, 0.08712911605834961, 1.2549500465393066, 0.45087480545043945, 1.2030470371246338, 0.7097687721252441, 1.4824166297912598, 1.1126680374145508, 0.551830530166626, 1.9363067150115967, 1.0740811824798584, 0.1628398895263672, 1.0415558815002441, 1.1143665313720703, 0.7969183921813965, 1.1805171966552734, 1.6294856071472168, 1.2987093925476074, 1.4707095623016357, 0.39685750007629395, 1.2109332084655762, 0.9706566333770752, 2.14622163772583, 1.487792730331421, 0.42597198486328125, 0.2865285873413086, 0.6689286231994629, 1.293576955795288, 3.1526732444763184, 1.2509348392486572, 0.6660337448120117, 0.8056843280792236, 1.303382158279419, 2.8772101402282715, 0.051465749740600586, 0.7077820301055908, 0.5943965911865234, 0.38088130950927734, 0.5911476612091064, 0.6868996620178223, 2.1766912937164307, 1.2948946952819824, 0.6780333518981934, 0.6085715293884277, 0.4117119312286377, 0.88667893409729, 1.4810163974761963, 0.5979845523834229, 1.276155948638916, 0.899770975112915, 0.9931595325469971, 1.9099326133728027, 1.0822334289550781, 1.8836658000946045, 0.9563698768615723, 0.1385345458984375, 0.19332623481750488, 0.3329014778137207, 1.01450514793396, 2.431549072265625, 3.1525797843933105, 1.3217196464538574, 1.4490418434143066, 1.4342167377471924, 0.43984413146972656, 0.793921709060669, 0.07197952270507812, 0.7927465438842773, 1.0218815803527832, 1.1822786331176758, 0.26540708541870117, 2.832723617553711, 2.0308220386505127, 1.1106390953063965], "mean_td_error": 1.1034890413284302, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 592.0, "diff_num_grad_updates_vs_sampler_policy": 591.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.089095115661621, "actor_loss": -11.217060089111328, "critic_loss": 0.14855331182479858, "alpha_loss": -1.7896993160247803, "alpha_value": 0.8374535441398621, "log_alpha_value": -0.1773894876241684, "target_entropy": -6.0, "policy_t": 0.024697931483387947, "mean_q": 7.836820602416992, "max_q": 8.172375679016113, "min_q": 7.503471851348877}, "td_error": [1.179002285003662, 0.9474062919616699, 1.291478157043457, 0.7254509925842285, 1.4907546043395996, 1.0979602336883545, 0.5575757026672363, 0.5607683658599854, 1.3158698081970215, 0.9589920043945312, 1.3707711696624756, 0.4184732437133789, 1.0766892433166504, 2.5965304374694824, 0.6037201881408691, 1.4018080234527588, 1.907607078552246, 1.399165391921997, 1.5347535610198975, 1.0423073768615723, 1.6137714385986328, 0.49692392349243164, 0.5350737571716309, 0.9237611293792725, 1.4101483821868896, 0.6256406307220459, 1.4387543201446533, 0.6876442432403564, 0.18219614028930664, 1.0955333709716797, 0.11018586158752441, 1.4457879066467285, 2.9442858695983887, 1.0504217147827148, 1.3263015747070312, 1.363957405090332, 1.190009355545044, 1.1466197967529297, 0.29587721824645996, 1.4525997638702393, 0.9733672142028809, 1.123100757598877, 0.9674539566040039, 3.3183231353759766, 0.07952117919921875, 0.49776601791381836, 1.0420725345611572, 0.8879354000091553, 0.06358051300048828, 2.0572032928466797, 1.1528301239013672, 0.77093505859375, 0.6838200092315674, 1.1197521686553955, 2.1893980503082275, 0.5017435550689697, 1.1872138977050781, 2.0570335388183594, 1.7005658149719238, 1.0496506690979004, 1.1527435779571533, 0.5420114994049072, 0.553657054901123, 1.2060317993164062, 1.7808048725128174, 0.5437133312225342, 0.4626469612121582, 1.299030065536499, 0.9300751686096191, 1.624612808227539, 0.19378423690795898, 1.3676166534423828, 0.7054400444030762, 0.9625999927520752, 0.5614194869995117, 0.7329485416412354, 0.446643590927124, 0.8639001846313477, 1.1687276363372803, 1.5648729801177979, 1.6333117485046387, 1.2138652801513672, 0.7300004959106445, 0.6670548915863037, 2.3113596439361572, 2.0169835090637207], "mean_td_error": 1.1101361513137817, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 592.0, "diff_num_grad_updates_vs_sampler_policy": 591.0}}, "num_env_steps_sampled": 5642, "num_env_steps_trained": 152736, "num_agent_steps_sampled": 16926, "num_agent_steps_trained": 152736, "last_target_update_ts": 5642, "num_target_updates": 592}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16926, "num_agent_steps_trained": 152736, "num_env_steps_sampled": 5642, "num_env_steps_trained": 152736, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.97107452217928, "num_env_steps_trained_throughput_per_sec": 2468.362460960322, "timesteps_total": 5642, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 16926, "timers": {"training_iteration_time_ms": 105.023, "sample_time_ms": 16.87, "load_time_ms": 0.315, "load_throughput": 819795.782, "learn_time_ms": 18.162, "learn_throughput": 14205.102, "synch_weights_time_ms": 10.064}, "counters": {"num_env_steps_sampled": 5642, "num_env_steps_trained": 152736, "num_agent_steps_sampled": 16926, "num_agent_steps_trained": 152736, "last_target_update_ts": 5642, "num_target_updates": 592}, "done": false, "episodes_total": 0, "training_iteration": 43, "trial_id": "db258_00000", "date": "2023-11-16_21-49-12", "timestamp": 1700200152, "time_this_iter_s": 1.5754499435424805, "time_total_s": 66.01598739624023, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 66.01598739624023, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.53333333333333, "ram_util_percent": 62.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092059135437012, "actor_loss": -16.006357192993164, "critic_loss": 0.08595162630081177, "alpha_loss": -1.833640694618225, "alpha_value": 0.8338586091995239, "log_alpha_value": -0.18169145286083221, "target_entropy": -6.0, "policy_t": 0.014987604692578316, "mean_q": 12.730003356933594, "max_q": 13.543743133544922, "min_q": 12.037120819091797}, "td_error": [0.3436470031738281, 0.5154523849487305, 0.25620317459106445, 0.4396343231201172, 0.9210686683654785, 1.1880488395690918, 0.20091009140014648, 1.3053522109985352, 2.0126776695251465, 0.9092922210693359, 0.4150867462158203, 0.8011236190795898, 2.301290988922119, 0.35071754455566406, 0.32163572311401367, 0.21236753463745117, 0.7418756484985352, 0.6422863006591797, 0.5985536575317383, 0.6130185127258301, 0.21549558639526367, 0.0819101333618164, 1.2941436767578125, 0.6564517021179199, 0.1949000358581543, 0.1207733154296875, 1.0226540565490723, 0.6157722473144531, 0.6838665008544922, 2.2332348823547363, 0.11808347702026367, 0.5848708152770996, 0.49506521224975586, 2.7826528549194336, 3.5678839683532715, 1.2959380149841309, 0.5779566764831543, 0.6228609085083008, 0.7821760177612305, 1.8481855392456055, 0.4188876152038574, 0.6017141342163086, 0.8189921379089355, 0.14246559143066406, 1.0361080169677734, 1.3045053482055664, 1.311483383178711, 1.1553969383239746, 1.079455852508545, 2.034132957458496, 0.6187729835510254, 0.6224260330200195, 1.2545981407165527, 1.2844209671020508, 1.8186125755310059, 2.2353100776672363, 0.12506341934204102, 0.23385047912597656, 1.8329520225524902, 1.9823722839355469, 0.7122964859008789, 0.19382286071777344, 1.5466890335083008, 1.5424494743347168, 1.574951171875, 1.6621060371398926, 0.4228944778442383, 1.0801115036010742, 0.8285360336303711, 0.9913382530212402, 1.0812606811523438, 1.5262985229492188, 1.3891234397888184, 1.2389349937438965, 0.20382308959960938, 0.5758705139160156, 1.1044626235961914, 1.029482364654541, 0.7995643615722656, 1.612602710723877, 0.0022139549255371094, 0.42812395095825195, 1.48079252243042, 2.1585512161254883, 2.2139477729797363, 0.6760497093200684], "mean_td_error": 0.9868945479393005, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 606.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.156387329101562, "actor_loss": -11.378787994384766, "critic_loss": 0.10002439469099045, "alpha_loss": -1.8469250202178955, "alpha_value": 0.8337275385856628, "log_alpha_value": -0.18184861540794373, "target_entropy": -6.0, "policy_t": -0.012603779323399067, "mean_q": 7.962319374084473, "max_q": 8.44072151184082, "min_q": 7.684013366699219}, "td_error": [0.5770735740661621, 0.5695254802703857, 1.5671823024749756, 1.7048964500427246, 0.15560340881347656, 0.6128020286560059, 1.7095894813537598, 0.1275019645690918, 0.22349214553833008, 0.49536585807800293, 1.2838740348815918, 0.717094898223877, 0.6709184646606445, 0.3068122863769531, 1.6675491333007812, 0.18238472938537598, 0.8062384128570557, 1.528106927871704, 1.572706699371338, 1.3231935501098633, 1.2261412143707275, 0.894207239151001, 1.7683749198913574, 1.029686450958252, 0.7798676490783691, 1.9323701858520508, 0.7188611030578613, 0.5137686729431152, 1.1542015075683594, 1.5191278457641602, 1.4884767532348633, 0.524683952331543, 1.061917781829834, 0.6320719718933105, 1.4591920375823975, 1.7295622825622559, 2.2005226612091064, 1.52998685836792, 0.9219334125518799, 0.808800458908081, 2.560990333557129, 1.732468605041504, 2.3833069801330566, 1.931473731994629, 0.8764681816101074, 1.7239441871643066, 0.4001905918121338, 0.21216654777526855, 0.3155994415283203, 1.4275331497192383, 0.3174903392791748, 0.9172773361206055, 0.6731419563293457, 1.0925054550170898, 0.33838987350463867, 3.016070604324341, 0.5607166290283203, 0.9484174251556396, 1.092876672744751, 0.31859254837036133, 0.4897918701171875, 0.03279829025268555, 0.057576656341552734, 1.6603903770446777, 1.2283935546875, 0.9167084693908691, 1.1273212432861328, 0.19415569305419922, 1.4772319793701172, 1.9624552726745605, 1.1484246253967285, 0.3775625228881836, 1.7831768989562988, 0.636345386505127, 0.777740478515625, 2.526113986968994, 0.737342119216919, 0.19498920440673828, 2.4283413887023926, 0.20863127708435059, 0.9410185813903809, 0.7931733131408691, 0.9234488010406494, 0.4346339702606201, 0.8790550231933594, 0.45873498916625977], "mean_td_error": 1.034079670906067, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 606.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0316162109375, "actor_loss": -11.4534330368042, "critic_loss": 0.17154985666275024, "alpha_loss": -1.8246922492980957, "alpha_value": 0.8336895704269409, "log_alpha_value": -0.18189415335655212, "target_entropy": -6.0, "policy_t": 0.06687434762716293, "mean_q": 8.160371780395508, "max_q": 8.439096450805664, "min_q": 7.880181312561035}, "td_error": [0.45703887939453125, 2.484502077102661, 0.2068037986755371, 3.5483906269073486, 1.010124683380127, 1.7572407722473145, 1.4536285400390625, 2.2522740364074707, 1.5079145431518555, 0.3424406051635742, 1.0691766738891602, 1.5242538452148438, 1.1231751441955566, 0.7717142105102539, 1.8806815147399902, 1.5663466453552246, 0.7937102317810059, 0.90952467918396, 0.38817548751831055, 1.5403056144714355, 0.8561694622039795, 1.3094940185546875, 0.11593389511108398, 0.7473917007446289, 0.9882593154907227, 2.169830799102783, 1.8719549179077148, 0.5516571998596191, 0.09619617462158203, 0.9464855194091797, 2.0895438194274902, 2.125842571258545, 1.7145404815673828, 1.0507721900939941, 2.0773439407348633, 1.196176528930664, 0.6806273460388184, 0.6672487258911133, 1.7767577171325684, 2.8648576736450195, 0.36629629135131836, 0.4928245544433594, 0.865626335144043, 1.547048568725586, 1.1494905948638916, 0.43283939361572266, 0.7287158966064453, 1.1130661964416504, 0.5661454200744629, 1.8615422248840332, 1.0942401885986328, 0.23843002319335938, 1.0193109512329102, 1.2241313457489014, 0.8100156784057617, 1.0324945449829102, 0.5385913848876953, 0.7558135986328125, 0.621727466583252, 2.4469122886657715, 0.18477678298950195, 0.9597969055175781, 1.487356185913086, 2.2619428634643555, 3.81510066986084, 0.9359071254730225, 1.6632156372070312, 1.8289732933044434, 0.2556014060974121, 0.7797889709472656, 1.4804906845092773, 2.124762535095215, 1.5405731201171875, 0.8503332138061523, 1.0834324359893799, 1.580399513244629, 0.6404438018798828, 2.5219883918762207, 1.9174251556396484, 1.5272393226623535, 0.6857140064239502, 0.06028270721435547, 1.6062369346618652, 0.6446290016174316, 0.508265495300293, 1.0270133018493652], "mean_td_error": 1.2251331806182861, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 606.0}}, "num_env_steps_sampled": 5747, "num_env_steps_trained": 156606, "num_agent_steps_sampled": 17241, "num_agent_steps_trained": 156606, "last_target_update_ts": 5747, "num_target_updates": 607}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17241, "num_agent_steps_trained": 156606, "num_env_steps_sampled": 5747, "num_env_steps_trained": 156606, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.38194441044422, "num_env_steps_trained_throughput_per_sec": 2483.505951127801, "timesteps_total": 5747, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 17241, "timers": {"training_iteration_time_ms": 104.161, "sample_time_ms": 15.444, "load_time_ms": 0.313, "load_throughput": 823664.509, "learn_time_ms": 18.18, "learn_throughput": 14191.633, "synch_weights_time_ms": 11.134}, "counters": {"num_env_steps_sampled": 5747, "num_env_steps_trained": 156606, "num_agent_steps_sampled": 17241, "num_agent_steps_trained": 156606, "last_target_update_ts": 5747, "num_target_updates": 607}, "done": false, "episodes_total": 0, "training_iteration": 44, "trial_id": "db258_00000", "date": "2023-11-16_21-49-14", "timestamp": 1700200154, "time_this_iter_s": 1.5660409927368164, "time_total_s": 67.58202838897705, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb77e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 67.58202838897705, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 62.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064867973327637, "actor_loss": -16.34834861755371, "critic_loss": 0.10594461858272552, "alpha_loss": -1.874069094657898, "alpha_value": 0.8301083445549011, "log_alpha_value": -0.18619903922080994, "target_entropy": -6.0, "policy_t": -0.06848376989364624, "mean_q": 13.039597511291504, "max_q": 13.829425811767578, "min_q": 12.382400512695312}, "td_error": [0.7473597526550293, 1.96732759475708, 0.7030620574951172, 1.5086822509765625, 1.6892690658569336, 0.8029160499572754, 1.1732048988342285, 2.4402971267700195, 0.43018150329589844, 0.2891416549682617, 0.10883283615112305, 0.9453229904174805, 0.9645190238952637, 1.0585589408874512, 1.7059173583984375, 1.2791070938110352, 0.5749855041503906, 1.410604476928711, 1.7994227409362793, 2.1328024864196777, 2.286151885986328, 1.4946379661560059, 1.5024638175964355, 1.1465225219726562, 0.26015615463256836, 1.060777187347412, 1.4556670188903809, 1.7181367874145508, 1.9751253128051758, 0.41306018829345703, 1.3617548942565918, 0.8021101951599121, 0.569371223449707, 0.9860091209411621, 0.589409351348877, 0.19737911224365234, 1.0840167999267578, 0.8460297584533691, 1.0016670227050781, 0.8208847045898438, 1.7383813858032227, 0.500636100769043, 1.2012100219726562, 1.4611682891845703, 0.23820829391479492, 2.0187888145446777, 1.7577829360961914, 1.5813021659851074, 1.9616618156433105, 1.265176773071289, 0.4758896827697754, 1.276801586151123, 2.780038833618164, 1.8332715034484863, 0.5966811180114746, 0.6572132110595703, 0.5156598091125488, 0.4189424514770508, 2.219249725341797, 1.1539487838745117, 1.4850654602050781, 1.7835578918457031, 0.9257988929748535, 0.5512046813964844, 1.0200176239013672, 0.1640329360961914, 2.226104736328125, 0.5229983329772949, 1.0298633575439453, 0.2508273124694824, 0.6203441619873047, 1.6272106170654297, 1.714350700378418, 0.6107902526855469, 1.8317608833312988, 0.12499618530273438, 1.4657025337219238, 1.4723219871520996, 0.09242773056030273, 1.3165645599365234, 1.5206303596496582, 0.7258696556091309, 2.0264077186584473, 3.2380871772766113, 0.7721805572509766, 0.07531070709228516], "mean_td_error": 1.1645267009735107, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 622.0, "diff_num_grad_updates_vs_sampler_policy": 621.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094249725341797, "actor_loss": -11.281048774719238, "critic_loss": 0.10324810445308685, "alpha_loss": -1.8811326026916504, "alpha_value": 0.8299773335456848, "log_alpha_value": -0.18635685741901398, "target_entropy": -6.0, "policy_t": -0.00556734437122941, "mean_q": 7.951629161834717, "max_q": 8.471101760864258, "min_q": 7.594540596008301}, "td_error": [0.7732348442077637, 0.6179563999176025, 1.3243460655212402, 0.3880753517150879, 1.745988368988037, 0.7839903831481934, 0.42281341552734375, 1.808152198791504, 0.5565240383148193, 1.6304707527160645, 1.5456147193908691, 0.5971806049346924, 0.5121281147003174, 1.7788867950439453, 0.962099552154541, 1.83182954788208, 0.46439075469970703, 1.6100282669067383, 0.597116231918335, 0.6436479091644287, 0.07134890556335449, 1.4870436191558838, 1.643805980682373, 1.5487120151519775, 1.123467206954956, 1.1090574264526367, 0.45363831520080566, 0.8077030181884766, 1.1313838958740234, 0.17266011238098145, 1.3583049774169922, 1.3224656581878662, 1.1578900814056396, 0.4652228355407715, 0.3524305820465088, 0.44071340560913086, 0.747581958770752, 1.6212708950042725, 1.0281116962432861, 1.3777174949645996, 1.2331287860870361, 1.3146443367004395, 1.164865493774414, 1.3783693313598633, 0.6977181434631348, 1.2550413608551025, 0.5155541896820068, 0.8149409294128418, 1.5880236625671387, 1.5681955814361572, 0.9237151145935059, 2.217151165008545, 0.6421306133270264, 0.039122581481933594, 2.5049989223480225, 0.5269110202789307, 0.7011151313781738, 0.3838634490966797, 1.6609997749328613, 2.0715999603271484, 1.1727023124694824, 0.9391939640045166, 1.7289505004882812, 0.21736931800842285, 0.3539867401123047, 2.0755879878997803, 0.32154369354248047, 0.8868954181671143, 0.5192687511444092, 1.636082649230957, 1.4336581230163574, 1.0949797630310059, 0.8764495849609375, 1.0426568984985352, 1.1008591651916504, 1.7073974609375, 0.6836810111999512, 1.1263542175292969, 2.076209306716919, 0.6033422946929932, 0.8353118896484375, 0.997093915939331, 1.4235732555389404, 0.8258299827575684, 1.685784101486206, 0.8663384914398193], "mean_td_error": 1.0633511543273926, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 622.0, "diff_num_grad_updates_vs_sampler_policy": 621.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.036579132080078, "actor_loss": -11.392786026000977, "critic_loss": 0.17277038097381592, "alpha_loss": -1.8707988262176514, "alpha_value": 0.8299431800842285, "log_alpha_value": -0.18639802932739258, "target_entropy": -6.0, "policy_t": -0.003704315982758999, "mean_q": 8.092580795288086, "max_q": 8.424908638000488, "min_q": 7.7658162117004395}, "td_error": [2.287806510925293, 1.0203509330749512, 2.0451436042785645, 1.8019990921020508, 0.3493328094482422, 0.3049740791320801, 1.0483860969543457, 1.8299298286437988, 1.119248867034912, 2.5901756286621094, 1.4558753967285156, 1.4147710800170898, 1.1043298244476318, 0.45380496978759766, 1.6813993453979492, 1.5531432628631592, 1.0246243476867676, 1.0492234230041504, 0.8994970321655273, 1.581129550933838, 1.5313079357147217, 1.69903564453125, 1.4570884704589844, 1.4809155464172363, 1.6823039054870605, 1.662065029144287, 0.7171535491943359, 0.25048208236694336, 0.2976541519165039, 0.9949502944946289, 0.7558994293212891, 1.5172677040100098, 0.9241843223571777, 1.3224263191223145, 2.589017152786255, 2.2038192749023438, 2.0927906036376953, 1.7452735900878906, 1.8392488956451416, 0.9839925765991211, 1.1529932022094727, 2.394686698913574, 1.0763750076293945, 0.4013643264770508, 0.6501779556274414, 0.48291492462158203, 0.6438298225402832, 1.435192584991455, 0.6642875671386719, 0.2972431182861328, 1.2430977821350098, 1.2338299751281738, 1.6605281829833984, 1.6897039413452148, 1.8392901420593262, 1.0315492153167725, 1.748642921447754, 0.4253854751586914, 0.038207054138183594, 1.4338068962097168, 1.828357458114624, 1.1344952583312988, 1.6909878253936768, 1.5393052101135254, 0.04113006591796875, 1.2415852546691895, 0.7067546844482422, 0.10682058334350586, 0.30468130111694336, 1.278393268585205, 0.5230755805969238, 0.9179234504699707, 0.8832213878631592, 0.49646615982055664, 0.30652570724487305, 0.38950252532958984, 1.4427926540374756, 1.5749783515930176, 1.7316036224365234, 2.2613887786865234, 1.471726894378662, 0.4134254455566406, 1.3856372833251953, 1.6634342670440674, 2.261634588241577, 1.9555935859680176], "mean_td_error": 1.2262392044067383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 622.0, "diff_num_grad_updates_vs_sampler_policy": 621.0}}, "num_env_steps_sampled": 5852, "num_env_steps_trained": 160476, "num_agent_steps_sampled": 17556, "num_agent_steps_trained": 160476, "last_target_update_ts": 5852, "num_target_updates": 622}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17556, "num_agent_steps_trained": 160476, "num_env_steps_sampled": 5852, "num_env_steps_trained": 160476, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.62506090298103, "num_env_steps_trained_throughput_per_sec": 2492.466530424158, "timesteps_total": 5852, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 17556, "timers": {"training_iteration_time_ms": 104.289, "sample_time_ms": 15.958, "load_time_ms": 0.309, "load_throughput": 836203.1, "learn_time_ms": 18.269, "learn_throughput": 14122.549, "synch_weights_time_ms": 10.027}, "counters": {"num_env_steps_sampled": 5852, "num_env_steps_trained": 160476, "num_agent_steps_sampled": 17556, "num_agent_steps_trained": 160476, "last_target_update_ts": 5852, "num_target_updates": 622}, "done": false, "episodes_total": 0, "training_iteration": 45, "trial_id": "db258_00000", "date": "2023-11-16_21-49-15", "timestamp": 1700200155, "time_this_iter_s": 1.5644049644470215, "time_total_s": 69.14643335342407, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb76a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 69.14643335342407, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 62.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126571655273438, "actor_loss": -16.587182998657227, "critic_loss": 0.11120355129241943, "alpha_loss": -1.9312652349472046, "alpha_value": 0.8263700008392334, "log_alpha_value": -0.19071263074874878, "target_entropy": -6.0, "policy_t": 0.02148759551346302, "mean_q": 13.289254188537598, "max_q": 14.290361404418945, "min_q": 12.696706771850586}, "td_error": [0.44830894470214844, 0.7450189590454102, 0.716092586517334, 2.902510166168213, 0.5421686172485352, 2.4035444259643555, 1.4905176162719727, 1.656811237335205, 0.7145829200744629, 1.854792594909668, 0.6140956878662109, 0.04497718811035156, 2.1961584091186523, 2.765138626098633, 0.29979610443115234, 1.5733528137207031, 1.797635555267334, 0.5130000114440918, 1.2574005126953125, 2.6499061584472656, 0.6763930320739746, 2.3965911865234375, 1.8559131622314453, 0.20247840881347656, 0.6706972122192383, 2.1080613136291504, 1.035013198852539, 2.76393985748291, 1.7604689598083496, 0.44754600524902344, 1.2151451110839844, 0.3704538345336914, 1.5736074447631836, 2.2593908309936523, 1.4066872596740723, 1.9287118911743164, 1.956911563873291, 0.43036699295043945, 1.3433794975280762, 1.317711353302002, 1.1747932434082031, 0.9233717918395996, 1.1466655731201172, 0.8622713088989258, 0.9472408294677734, 1.502558708190918, 0.7251949310302734, 1.969315528869629, 0.8970012664794922, 2.7392048835754395, 2.077273368835449, 0.6075563430786133, 0.6506767272949219, 1.1067895889282227, 0.2152094841003418, 0.8975067138671875, 0.9204292297363281, 0.4184722900390625, 0.7860326766967773, 1.5902485847473145, 1.0475845336914062, 0.610081672668457, 1.4820289611816406, 0.4856071472167969, 1.8234386444091797, 0.8560361862182617, 1.4714488983154297, 1.1480302810668945, 2.5806751251220703, 0.34854888916015625, 1.7979273796081543, 0.4599800109863281, 0.9828791618347168, 0.5494470596313477, 1.6076016426086426, 0.19707727432250977, 0.928441047668457, 0.42336463928222656, 1.6579937934875488, 1.2271838188171387, 1.0440855026245117, 0.9952878952026367, 1.1095662117004395, 0.7903246879577637, 1.7321748733520508, 1.0917396545410156], "mean_td_error": 1.226879596710205, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 637.0, "diff_num_grad_updates_vs_sampler_policy": 636.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.055790901184082, "actor_loss": -11.439001083374023, "critic_loss": 0.1012946218252182, "alpha_loss": -1.9192698001861572, "alpha_value": 0.8262465000152588, "log_alpha_value": -0.19086213409900665, "target_entropy": -6.0, "policy_t": -0.004161491058766842, "mean_q": 8.118942260742188, "max_q": 8.456355094909668, "min_q": 7.84153413772583}, "td_error": [1.4152803421020508, 2.3834471702575684, 0.6419124603271484, 1.9247522354125977, 1.0858135223388672, 0.3982076644897461, 1.210317611694336, 0.8788151741027832, 2.5511722564697266, 1.0241820812225342, 1.4191555976867676, 0.5322270393371582, 1.08912992477417, 2.632404327392578, 2.62040376663208, 0.2959709167480469, 1.140291690826416, 1.0374846458435059, 0.4048745632171631, 1.080071210861206, 0.7236366271972656, 0.538599967956543, 0.33652782440185547, 0.45386362075805664, 1.2355728149414062, 0.7224311828613281, 0.7616555690765381, 0.2538137435913086, 1.1890201568603516, 1.6705131530761719, 0.11820173263549805, 0.7081332206726074, 1.1678550243377686, 0.9303135871887207, 0.7499852180480957, 0.8837718963623047, 1.3959779739379883, 0.41597747802734375, 0.9848880767822266, 1.6307587623596191, 0.868351936340332, 1.845482349395752, 0.5053620338439941, 1.6374506950378418, 1.1240348815917969, 0.009007453918457031, 0.09154748916625977, 0.49347400665283203, 2.452120304107666, 0.6095476150512695, 1.1627755165100098, 2.7483372688293457, 0.19107866287231445, 0.788480281829834, 0.3760671615600586, 2.454423427581787, 1.278904914855957, 0.930720329284668, 0.1793067455291748, 1.3895325660705566, 1.310770034790039, 1.007307529449463, 1.1228785514831543, 1.199324131011963, 1.5051939487457275, 0.39350080490112305, 2.9803566932678223, 1.0562529563903809, 1.6907644271850586, 0.772202730178833, 0.5903685092926025, 0.22250843048095703, 0.3177833557128906, 1.6968469619750977, 0.7172088623046875, 1.1956706047058105, 0.39946413040161133, 0.7906084060668945, 1.174243450164795, 0.20460033416748047, 1.5569109916687012, 1.4063825607299805, 0.5169618129730225, 2.210306167602539, 0.5441126823425293, 1.0456280708312988], "mean_td_error": 1.0628089904785156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 637.0, "diff_num_grad_updates_vs_sampler_policy": 636.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117310523986816, "actor_loss": -11.45822525024414, "critic_loss": 0.15205861628055573, "alpha_loss": -1.9313840866088867, "alpha_value": 0.8262160420417786, "log_alpha_value": -0.19089896976947784, "target_entropy": -6.0, "policy_t": 0.01092807948589325, "mean_q": 8.067169189453125, "max_q": 8.496574401855469, "min_q": 7.742478370666504}, "td_error": [0.08148622512817383, 2.71661376953125, 0.7457981109619141, 0.058303117752075195, 0.5067768096923828, 0.4233431816101074, 1.2871427536010742, 0.40369367599487305, 2.0551223754882812, 0.1119699478149414, 1.6979174613952637, 1.460613489151001, 0.836400032043457, 2.0873589515686035, 0.26780033111572266, 1.3251547813415527, 0.7471895217895508, 1.9017648696899414, 0.18702435493469238, 0.12312960624694824, 0.4440579414367676, 1.7587356567382812, 1.361457347869873, 1.2916865348815918, 1.2962899208068848, 0.27642035484313965, 1.258122444152832, 2.2206625938415527, 1.2397661209106445, 0.7058265209197998, 1.2301111221313477, 1.1593027114868164, 0.914820671081543, 2.958536148071289, 0.7124598026275635, 1.357527256011963, 0.5256986618041992, 0.6374316215515137, 0.9217073917388916, 2.2564077377319336, 0.5351958274841309, 0.45205020904541016, 1.6151351928710938, 1.0583221912384033, 1.2526988983154297, 0.31296443939208984, 1.853163242340088, 1.546224594116211, 2.4127931594848633, 0.7630853652954102, 0.7833852767944336, 0.963129997253418, 0.30803442001342773, 1.8536477088928223, 0.1494462490081787, 0.5518324375152588, 0.13680362701416016, 0.7765316963195801, 0.8759152889251709, 1.2652997970581055, 0.039533138275146484, 1.3000683784484863, 0.4125328063964844, 1.0476527214050293, 0.8317575454711914, 1.409583568572998, 1.5688071250915527, 0.33829450607299805, 0.009128093719482422, 1.5025124549865723, 3.2451047897338867, 1.5036530494689941, 1.973045825958252, 2.048001527786255, 1.7737667560577393, 2.1203064918518066, 0.47449231147766113, 1.156787395477295, 0.7065286636352539, 1.1368112564086914, 1.2178289890289307, 1.5799436569213867, 0.13229703903198242, 0.1776747703552246, 1.2313621044158936, 2.701266288757324], "mean_td_error": 1.100651502609253, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 637.0, "diff_num_grad_updates_vs_sampler_policy": 636.0}}, "num_env_steps_sampled": 5957, "num_env_steps_trained": 164346, "num_agent_steps_sampled": 17871, "num_agent_steps_trained": 164346, "last_target_update_ts": 5957, "num_target_updates": 637}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17871, "num_agent_steps_trained": 164346, "num_env_steps_sampled": 5957, "num_env_steps_trained": 164346, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.59827032682179, "num_env_steps_trained_throughput_per_sec": 2491.4791063314315, "timesteps_total": 5957, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 17871, "timers": {"training_iteration_time_ms": 104.186, "sample_time_ms": 16.0, "load_time_ms": 0.311, "load_throughput": 830300.339, "learn_time_ms": 18.002, "learn_throughput": 14331.544, "synch_weights_time_ms": 10.359}, "counters": {"num_env_steps_sampled": 5957, "num_env_steps_trained": 164346, "num_agent_steps_sampled": 17871, "num_agent_steps_trained": 164346, "last_target_update_ts": 5957, "num_target_updates": 637}, "done": false, "episodes_total": 0, "training_iteration": 46, "trial_id": "db258_00000", "date": "2023-11-16_21-49-17", "timestamp": 1700200157, "time_this_iter_s": 1.5626790523529053, "time_total_s": 70.70911240577698, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0618a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 70.70911240577698, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.049999999999997, "ram_util_percent": 62.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149158477783203, "actor_loss": -16.506593704223633, "critic_loss": 0.09185001999139786, "alpha_loss": -1.9813700914382935, "alpha_value": 0.8226495385169983, "log_alpha_value": -0.19522503018379211, "target_entropy": -6.0, "policy_t": 0.05041276291012764, "mean_q": 13.204773902893066, "max_q": 13.809730529785156, "min_q": 12.553976058959961}, "td_error": [0.8183960914611816, 0.49540185928344727, 1.037564754486084, 0.518284797668457, 1.111964225769043, 1.1356687545776367, 0.9344258308410645, 0.8083395957946777, 2.079202651977539, 1.1015081405639648, 0.08685731887817383, 2.021287441253662, 1.0092706680297852, 0.7202157974243164, 0.30928707122802734, 1.9027223587036133, 0.09144306182861328, 0.15972375869750977, 1.3626198768615723, 1.163620948791504, 0.4716792106628418, 0.8828988075256348, 1.319817066192627, 1.4054012298583984, 0.1267538070678711, 1.3731088638305664, 1.317101001739502, 1.1415042877197266, 1.0671014785766602, 0.41721343994140625, 2.1817808151245117, 0.6840848922729492, 3.0694870948791504, 2.0860848426818848, 0.7797861099243164, 1.7070908546447754, 0.9084920883178711, 0.8261542320251465, 0.5939779281616211, 0.5181264877319336, 0.5779566764831543, 1.1801643371582031, 1.593193531036377, 1.4554433822631836, 0.6256685256958008, 1.1297473907470703, 0.5770664215087891, 1.0163917541503906, 0.7355690002441406, 1.2419524192810059, 0.7131052017211914, 0.19138050079345703, 0.5863075256347656, 2.6999974250793457, 0.9002065658569336, 0.5629305839538574, 0.6213469505310059, 0.1062617301940918, 1.1095523834228516, 0.5218663215637207, 0.6722712516784668, 0.6655845642089844, 0.5926241874694824, 0.5524225234985352, 0.5085105895996094, 2.0055813789367676, 0.19982099533081055, 4.001474380493164, 0.9778356552124023, 2.455054759979248, 0.3225669860839844, 0.8581342697143555, 0.6936326026916504, 0.9610724449157715, 2.2449512481689453, 1.2256550788879395, 0.9018311500549316, 0.6635880470275879, 2.081660270690918, 1.19482421875, 0.5485925674438477, 0.7733907699584961, 0.17714405059814453, 1.4026861190795898, 1.3267455101013184, 2.6285533905029297], "mean_td_error": 1.0526485443115234, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 652.0, "diff_num_grad_updates_vs_sampler_policy": 651.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102941513061523, "actor_loss": -11.667756080627441, "critic_loss": 0.11125548928976059, "alpha_loss": -1.9737701416015625, "alpha_value": 0.8225336074829102, "log_alpha_value": -0.19536590576171875, "target_entropy": -6.0, "policy_t": 0.025069022551178932, "mean_q": 8.297567367553711, "max_q": 8.740689277648926, "min_q": 7.960460662841797}, "td_error": [1.4066262245178223, 0.14097261428833008, 1.4877548217773438, 0.6439390182495117, 0.8621044158935547, 0.7141695022583008, 0.8495893478393555, 0.10953903198242188, 0.6672787666320801, 1.3961753845214844, 0.7937302589416504, 1.540034294128418, 0.2618861198425293, 2.1926612854003906, 1.9275035858154297, 1.6851739883422852, 1.0924410820007324, 0.7839570045471191, 1.6163196563720703, 1.3359894752502441, 0.26642847061157227, 0.8493208885192871, 0.3190426826477051, 1.108290195465088, 2.2528371810913086, 1.3734188079833984, 0.7027173042297363, 1.828366756439209, 1.1543545722961426, 1.7401995658874512, 2.456172466278076, 0.9666557312011719, 1.3629465103149414, 0.6561064720153809, 0.2731618881225586, 1.1267848014831543, 0.7492904663085938, 0.20335912704467773, 3.0047454833984375, 1.4088292121887207, 1.4705886840820312, 1.0809426307678223, 0.330902099609375, 2.873807907104492, 0.5876178741455078, 0.42818260192871094, 1.0098395347595215, 1.3065118789672852, 0.38196754455566406, 0.24340581893920898, 1.1496644020080566, 1.3487815856933594, 0.9271383285522461, 1.4493708610534668, 2.3421201705932617, 0.3195343017578125, 0.6856145858764648, 0.48520755767822266, 0.04897260665893555, 1.6229429244995117, 0.8425836563110352, 0.8879432678222656, 1.6171751022338867, 1.5385775566101074, 0.4143052101135254, 0.6947202682495117, 1.2566704750061035, 1.10884428024292, 1.6339836120605469, 1.499070644378662, 1.2023029327392578, 0.39051294326782227, 1.6313228607177734, 1.0873422622680664, 0.7612195014953613, 1.042999267578125, 0.7672100067138672, 1.3645410537719727, 1.3440394401550293, 1.9273452758789062, 1.0229132175445557, 1.5754737854003906, 1.4952473640441895, 1.991255283355713, 0.8267531394958496, 1.5917863845825195], "mean_td_error": 1.1269782781600952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 652.0, "diff_num_grad_updates_vs_sampler_policy": 651.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10673713684082, "actor_loss": -11.607244491577148, "critic_loss": 0.13964149355888367, "alpha_loss": -1.9748893976211548, "alpha_value": 0.8225029110908508, "log_alpha_value": -0.19540324807167053, "target_entropy": -6.0, "policy_t": 0.005063933786004782, "mean_q": 8.261944770812988, "max_q": 8.640331268310547, "min_q": 7.971903324127197}, "td_error": [2.4305362701416016, 0.4387626647949219, 0.3976459503173828, 0.15460896492004395, 0.15692949295043945, 1.5996112823486328, 1.1496810913085938, 0.14104747772216797, 0.021413803100585938, 0.9490489959716797, 1.0537304878234863, 1.4538021087646484, 2.7199716567993164, 0.360048770904541, 0.9944233894348145, 0.17128753662109375, 1.0850653648376465, 1.8768553733825684, 0.7048525810241699, 2.961376190185547, 0.6235284805297852, 0.6979398727416992, 0.82391357421875, 1.227766990661621, 2.269197940826416, 1.4563984870910645, 0.9212570190429688, 0.8102245330810547, 0.8899593353271484, 0.05752992630004883, 0.8173294067382812, 0.9012470245361328, 0.9524216651916504, 1.1220474243164062, 0.8662967681884766, 1.0521502494812012, 0.7889962196350098, 0.9777779579162598, 0.00896310806274414, 0.19617366790771484, 0.49533891677856445, 1.5889034271240234, 1.2589597702026367, 0.5122299194335938, 1.9667248725891113, 0.8453464508056641, 0.12830448150634766, 1.6030197143554688, 0.31023693084716797, 1.0905418395996094, 0.24463462829589844, 0.6052470207214355, 0.7707986831665039, 2.8943142890930176, 0.982642650604248, 1.092677116394043, 0.6914262771606445, 1.482874870300293, 1.6001882553100586, 0.822415828704834, 0.7208170890808105, 0.9528956413269043, 0.33057498931884766, 1.797438621520996, 1.049069881439209, 1.0397701263427734, 2.056565284729004, 1.8345675468444824, 1.8818278312683105, 0.5499544143676758, 2.802694797515869, 0.7281780242919922, 1.3334136009216309, 1.2825531959533691, 1.3079414367675781, 1.3694343566894531, 0.8085155487060547, 2.2423224449157715, 0.8041591644287109, 0.6253805160522461, 0.8480038642883301, 0.554844856262207, 1.729382038116455, 0.7227258682250977, 0.5451970100402832, 1.0268783569335938], "mean_td_error": 1.048997163772583, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 652.0, "diff_num_grad_updates_vs_sampler_policy": 651.0}}, "num_env_steps_sampled": 6062, "num_env_steps_trained": 168216, "num_agent_steps_sampled": 18186, "num_agent_steps_trained": 168216, "last_target_update_ts": 6062, "num_target_updates": 652}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18186, "num_agent_steps_trained": 168216, "num_env_steps_sampled": 6062, "num_env_steps_trained": 168216, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 63.65708350359313, "num_env_steps_trained_throughput_per_sec": 2346.218220561004, "timesteps_total": 6062, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 18186, "timers": {"training_iteration_time_ms": 112.362, "sample_time_ms": 18.385, "load_time_ms": 0.338, "load_throughput": 764054.531, "learn_time_ms": 18.949, "learn_throughput": 13615.745, "synch_weights_time_ms": 12.774}, "counters": {"num_env_steps_sampled": 6062, "num_env_steps_trained": 168216, "num_agent_steps_sampled": 18186, "num_agent_steps_trained": 168216, "last_target_update_ts": 6062, "num_target_updates": 652}, "done": false, "episodes_total": 0, "training_iteration": 47, "trial_id": "db258_00000", "date": "2023-11-16_21-49-19", "timestamp": 1700200159, "time_this_iter_s": 1.6608188152313232, "time_total_s": 72.3699312210083, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7f60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 72.3699312210083, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.833333333333336, "ram_util_percent": 62.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03105640411377, "actor_loss": -16.865192413330078, "critic_loss": 0.1012754887342453, "alpha_loss": -2.003525495529175, "alpha_value": 0.8189499974250793, "log_alpha_value": -0.19973224401474, "target_entropy": -6.0, "policy_t": -0.02482590265572071, "mean_q": 13.645450592041016, "max_q": 14.169260025024414, "min_q": 12.97923755645752}, "td_error": [0.7656826972961426, 0.5812292098999023, 0.22705745697021484, 0.1827073097229004, 0.08551692962646484, 1.9258365631103516, 0.5262660980224609, 1.7821617126464844, 0.8122138977050781, 0.2270340919494629, 0.9819321632385254, 1.3885092735290527, 0.3464975357055664, 0.7182955741882324, 1.6175642013549805, 1.192422866821289, 1.2857575416564941, 0.8919548988342285, 0.5095715522766113, 1.544480800628662, 1.3617610931396484, 1.3425278663635254, 0.11042118072509766, 1.7408294677734375, 0.738318920135498, 1.0584402084350586, 0.24947357177734375, 0.2931332588195801, 1.5431294441223145, 1.46820068359375, 1.909651279449463, 2.917595386505127, 1.1801705360412598, 1.9220328330993652, 0.8161940574645996, 0.7807464599609375, 1.625504970550537, 0.17135381698608398, 1.1926264762878418, 1.0771913528442383, 2.7587718963623047, 0.6447038650512695, 0.821479320526123, 2.0180654525756836, 0.7330646514892578, 0.5004982948303223, 0.6802616119384766, 1.0716543197631836, 1.8580780029296875, 0.7342238426208496, 0.8025908470153809, 1.7167177200317383, 0.22844743728637695, 1.3586359024047852, 2.1768908500671387, 1.098813533782959, 2.113056182861328, 1.3910431861877441, 2.925499439239502, 1.3813042640686035, 1.752213478088379, 2.3969364166259766, 0.1581883430480957, 0.12855005264282227, 0.8448443412780762, 2.1377124786376953, 0.5211186408996582, 0.06730794906616211, 1.8827753067016602, 1.4769554138183594, 1.6232690811157227, 1.937246322631836, 1.4965834617614746, 0.2170581817626953, 2.0646286010742188, 0.1876993179321289, 1.5399246215820312, 1.9096159934997559, 0.8510313034057617, 0.42627620697021484, 0.04705238342285156, 1.4012579917907715, 1.4383702278137207, 0.25533056259155273, 0.6782526969909668, 1.4957122802734375], "mean_td_error": 1.128391981124878, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 667.0, "diff_num_grad_updates_vs_sampler_policy": 666.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088190078735352, "actor_loss": -11.775439262390137, "critic_loss": 0.09461330622434616, "alpha_loss": -2.0163159370422363, "alpha_value": 0.8188380599021912, "log_alpha_value": -0.19986896216869354, "target_entropy": -6.0, "policy_t": 0.021576406434178352, "mean_q": 8.450613021850586, "max_q": 8.845600128173828, "min_q": 8.132457733154297}, "td_error": [0.12442922592163086, 0.5055789947509766, 1.7955365180969238, 1.111231803894043, 0.45543813705444336, 2.8841300010681152, 1.3278255462646484, 0.7802371978759766, 1.2713046073913574, 1.2584376335144043, 1.0521011352539062, 0.2517127990722656, 1.2080607414245605, 0.35415029525756836, 1.1583709716796875, 0.3215446472167969, 1.1281585693359375, 0.1742110252380371, 0.42540931701660156, 0.8808183670043945, 0.28873729705810547, 0.12719345092773438, 2.588571071624756, 2.353883743286133, 0.3019413948059082, 1.3981928825378418, 0.7222747802734375, 1.6232705116271973, 0.3973879814147949, 0.29732561111450195, 0.21147966384887695, 1.5360393524169922, 0.2254047393798828, 2.7424678802490234, 0.03179359436035156, 0.8574485778808594, 1.0283169746398926, 1.689246654510498, 0.47423505783081055, 0.7300467491149902, 0.503972053527832, 0.8791513442993164, 0.1716609001159668, 1.308995246887207, 1.069746494293213, 1.6183385848999023, 1.9063587188720703, 1.434372901916504, 0.7141704559326172, 1.355654239654541, 1.0262837409973145, 0.8970432281494141, 0.26307106018066406, 0.596855640411377, 3.1839475631713867, 1.722367286682129, 0.20834922790527344, 0.046871185302734375, 0.8132185935974121, 0.026688098907470703, 1.5873942375183105, 0.04401063919067383, 1.4279446601867676, 0.5463042259216309, 0.7866153717041016, 0.036240577697753906, 1.162743091583252, 0.45398521423339844, 1.2672934532165527, 0.6046571731567383, 0.7227702140808105, 0.9653596878051758, 1.1841621398925781, 1.7547712326049805, 0.7249560356140137, 0.734682559967041, 1.1415691375732422, 0.9371089935302734, 1.3605995178222656, 0.9328608512878418, 1.426224708557129, 0.8857173919677734, 1.3647408485412598, 1.2894291877746582, 1.776163101196289, 1.4454121589660645], "mean_td_error": 0.9814509749412537, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 667.0, "diff_num_grad_updates_vs_sampler_policy": 666.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122150421142578, "actor_loss": -11.864588737487793, "critic_loss": 0.14693695306777954, "alpha_loss": -2.023541212081909, "alpha_value": 0.8188026547431946, "log_alpha_value": -0.1999121755361557, "target_entropy": -6.0, "policy_t": 0.003710121149197221, "mean_q": 8.538522720336914, "max_q": 8.816930770874023, "min_q": 8.283506393432617}, "td_error": [1.3529233932495117, 0.8680434226989746, 0.9848785400390625, 3.046308994293213, 1.303542137145996, 1.4278359413146973, 0.6936745643615723, 1.3698887825012207, 0.0783376693725586, 0.019568443298339844, 0.7765979766845703, 2.23583984375, 1.5013775825500488, 2.2120251655578613, 1.2423501014709473, 0.060614585876464844, 0.688753604888916, 0.09905004501342773, 0.6170635223388672, 0.8326234817504883, 0.6763820648193359, 0.8476738929748535, 0.46502685546875, 1.1432914733886719, 0.0942997932434082, 1.3444585800170898, 0.28270912170410156, 0.4467635154724121, 1.2729921340942383, 1.016901969909668, 1.2370572090148926, 1.1733355522155762, 1.3971924781799316, 0.3466501235961914, 2.700648784637451, 1.6825666427612305, 1.2431011199951172, 0.7806944847106934, 1.0099759101867676, 0.47783946990966797, 1.49456787109375, 0.060916900634765625, 0.12476205825805664, 0.45438241958618164, 1.324124813079834, 0.13145208358764648, 0.9903678894042969, 0.7235846519470215, 1.055060863494873, 1.7685647010803223, 1.9898505210876465, 0.25446224212646484, 0.334230899810791, 1.718587875366211, 0.3863539695739746, 1.065584659576416, 0.11994123458862305, 1.563192367553711, 3.2449374198913574, 1.0147910118103027, 1.6402630805969238, 0.5417828559875488, 1.2896661758422852, 0.8091592788696289, 0.8679566383361816, 0.9760141372680664, 1.9347219467163086, 0.7973079681396484, 1.9736146926879883, 0.7784576416015625, 0.6027851104736328, 1.7840490341186523, 1.056474208831787, 0.8500752449035645, 0.48622989654541016, 0.8214817047119141, 1.088477611541748, 1.4021964073181152, 2.635197162628174, 1.6992201805114746, 0.6480622291564941, 1.473677635192871, 1.5955605506896973, 1.215878963470459, 2.2403674125671387, 0.8341035842895508], "mean_td_error": 1.0803879499435425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 667.0, "diff_num_grad_updates_vs_sampler_policy": 666.0}}, "num_env_steps_sampled": 6167, "num_env_steps_trained": 172086, "num_agent_steps_sampled": 18501, "num_agent_steps_trained": 172086, "last_target_update_ts": 6167, "num_target_updates": 667}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18501, "num_agent_steps_trained": 172086, "num_env_steps_sampled": 6167, "num_env_steps_trained": 172086, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 65.14913821261366, "num_env_steps_trained_throughput_per_sec": 2401.2110941220467, "timesteps_total": 6167, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 18501, "timers": {"training_iteration_time_ms": 106.884, "sample_time_ms": 17.193, "load_time_ms": 0.342, "load_throughput": 753310.43, "learn_time_ms": 19.088, "learn_throughput": 13516.341, "synch_weights_time_ms": 11.268}, "counters": {"num_env_steps_sampled": 6167, "num_env_steps_trained": 172086, "num_agent_steps_sampled": 18501, "num_agent_steps_trained": 172086, "last_target_update_ts": 6167, "num_target_updates": 667}, "done": false, "episodes_total": 0, "training_iteration": 48, "trial_id": "db258_00000", "date": "2023-11-16_21-49-20", "timestamp": 1700200160, "time_this_iter_s": 1.6205072402954102, "time_total_s": 73.99043846130371, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 73.99043846130371, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 54.25, "ram_util_percent": 64.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11825942993164, "actor_loss": -17.222803115844727, "critic_loss": 0.10413758456707001, "alpha_loss": -2.0665371417999268, "alpha_value": 0.8152679800987244, "log_alpha_value": -0.2042383998632431, "target_entropy": -6.0, "policy_t": -0.02507678233087063, "mean_q": 13.955049514770508, "max_q": 14.648429870605469, "min_q": 13.45943546295166}, "td_error": [0.9880094528198242, 0.11524677276611328, 2.2451977729797363, 1.552396297454834, 1.97236967086792, 1.524785041809082, 2.1406383514404297, 1.9471964836120605, 1.483403205871582, 0.902897834777832, 1.051638126373291, 2.187347888946533, 0.44701385498046875, 1.1248588562011719, 0.5847048759460449, 1.5554819107055664, 0.3655557632446289, 1.2064170837402344, 1.7046446800231934, 0.9526214599609375, 1.776512622833252, 1.3768525123596191, 0.4097781181335449, 0.49590015411376953, 0.30954599380493164, 2.122922897338867, 0.19527244567871094, 0.5685725212097168, 0.7996878623962402, 1.342440128326416, 0.9740285873413086, 1.9877057075500488, 0.8924779891967773, 0.8503475189208984, 0.25453853607177734, 0.9157586097717285, 0.8290228843688965, 0.1799488067626953, 1.3832793235778809, 0.14987993240356445, 0.1795787811279297, 0.30211925506591797, 0.3215160369873047, 0.7482614517211914, 2.654935836791992, 1.1153807640075684, 0.7222180366516113, 0.5944328308105469, 2.3343381881713867, 1.0640716552734375, 1.6891288757324219, 2.168776512145996, 2.146178722381592, 1.7318296432495117, 0.8182048797607422, 1.3344230651855469, 1.403432846069336, 2.100959300994873, 1.2923431396484375, 3.1367688179016113, 1.49257230758667, 0.41381168365478516, 1.0909490585327148, 0.7509164810180664, 0.4595198631286621, 0.5109634399414062, 1.0927362442016602, 0.31300973892211914, 1.0734691619873047, 0.19300127029418945, 1.1268243789672852, 1.3635873794555664, 0.08932638168334961, 2.101285934448242, 1.2367792129516602, 2.4918079376220703, 3.107330799102783, 1.7544150352478027, 1.4833245277404785, 0.645848274230957, 1.6780142784118652, 0.24168062210083008, 0.7070159912109375, 0.7350244522094727, 0.08350563049316406, 1.0254521369934082], "mean_td_error": 1.1510229110717773, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 682.0, "diff_num_grad_updates_vs_sampler_policy": 681.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.045341491699219, "actor_loss": -11.849721908569336, "critic_loss": 0.10911116003990173, "alpha_loss": -2.052978277206421, "alpha_value": 0.8151597380638123, "log_alpha_value": -0.20437118411064148, "target_entropy": -6.0, "policy_t": 0.02996678650379181, "mean_q": 8.595573425292969, "max_q": 9.032426834106445, "min_q": 8.291705131530762}, "td_error": [0.7657275199890137, 0.8868899345397949, 1.1995396614074707, 0.08488941192626953, 1.6400814056396484, 1.0349464416503906, 2.554304599761963, 0.4104652404785156, 0.8106675148010254, 0.34575891494750977, 1.1905279159545898, 0.9290771484375, 0.315610408782959, 2.9488778114318848, 1.482222080230713, 2.4999303817749023, 1.273911476135254, 0.7669477462768555, 0.04262113571166992, 1.133143424987793, 1.87666654586792, 0.9639124870300293, 2.816812515258789, 0.07911491394042969, 1.6253914833068848, 0.0076141357421875, 3.104839324951172, 0.5747880935668945, 0.4872093200683594, 0.053955078125, 2.5893449783325195, 1.9197497367858887, 0.6816887855529785, 1.4477787017822266, 0.12545299530029297, 1.5135884284973145, 0.4812507629394531, 1.8689484596252441, 0.18249130249023438, 1.8384008407592773, 0.9282140731811523, 0.44680309295654297, 2.253647804260254, 0.3702383041381836, 0.5121207237243652, 0.9653229713439941, 1.5002427101135254, 0.631746768951416, 0.24606895446777344, 2.1161699295043945, 0.3212251663208008, 1.9871916770935059, 1.1350932121276855, 0.9716277122497559, 0.29877471923828125, 0.4334545135498047, 1.34489107131958, 0.8685131072998047, 2.175670623779297, 0.9675679206848145, 0.7398805618286133, 0.6087179183959961, 1.7530198097229004, 0.8890552520751953, 0.825566291809082, 0.589881420135498, 0.9915857315063477, 0.8945674896240234, 1.1678709983825684, 1.8026690483093262, 1.0986437797546387, 0.6031274795532227, 2.2895703315734863, 1.3690166473388672, 0.4103660583496094, 0.6276178359985352, 1.5472512245178223, 1.1590595245361328, 0.6252717971801758, 1.9079303741455078, 0.6277532577514648, 1.2861442565917969, 1.5606107711791992, 0.26087474822998047, 0.6423811912536621, 2.498438835144043], "mean_td_error": 1.1140302419662476, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 682.0, "diff_num_grad_updates_vs_sampler_policy": 681.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06044864654541, "actor_loss": -11.929583549499512, "critic_loss": 0.15646575391292572, "alpha_loss": -2.0565297603607178, "alpha_value": 0.815122127532959, "log_alpha_value": -0.20441731810569763, "target_entropy": -6.0, "policy_t": -0.043770596385002136, "mean_q": 8.657204627990723, "max_q": 9.014625549316406, "min_q": 8.420108795166016}, "td_error": [1.8255786895751953, 0.7170844078063965, 1.6660127639770508, 0.49346065521240234, 2.9065494537353516, 1.8436050415039062, 0.2950448989868164, 0.6270041465759277, 0.0250244140625, 0.8414297103881836, 1.4059605598449707, 2.3643932342529297, 2.2633795738220215, 0.541999340057373, 1.4661221504211426, 0.3894634246826172, 0.4825301170349121, 1.9650483131408691, 1.4767189025878906, 0.5996541976928711, 0.4607253074645996, 2.246894359588623, 1.384265422821045, 0.5526604652404785, 0.6985621452331543, 0.871004581451416, 0.07171154022216797, 1.3339691162109375, 0.6915721893310547, 0.5066938400268555, 0.3112192153930664, 0.6433944702148438, 2.795297145843506, 0.8343887329101562, 1.593292236328125, 2.4749131202697754, 0.8593006134033203, 0.46514272689819336, 0.61932373046875, 2.297487735748291, 1.5201616287231445, 0.8469905853271484, 0.5430998802185059, 1.4636249542236328, 1.0697026252746582, 0.9154872894287109, 0.8255000114440918, 1.386213779449463, 1.8132514953613281, 1.0147185325622559, 1.0964007377624512, 0.5795602798461914, 0.9431796073913574, 2.9779906272888184, 0.4763169288635254, 0.9025883674621582, 1.8929338455200195, 0.9727287292480469, 0.9336609840393066, 1.0953998565673828, 0.6334123611450195, 0.9486346244812012, 1.6237163543701172, 0.675940990447998, 2.549912452697754, 1.4959707260131836, 0.4051828384399414, 0.6156463623046875, 0.3272438049316406, 1.8797264099121094, 0.6502218246459961, 0.5708379745483398, 1.2494511604309082, 1.7924094200134277, 1.5863614082336426, 0.7249059677124023, 0.43549203872680664, 2.0682592391967773, 2.280083656311035, 2.019960880279541, 0.6175312995910645, 1.668565273284912, 0.30916643142700195, 1.3142004013061523, 0.8577127456665039, 0.9583225250244141], "mean_td_error": 1.1562355756759644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 682.0, "diff_num_grad_updates_vs_sampler_policy": 681.0}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 175956, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 175956, "last_target_update_ts": 6272, "num_target_updates": 682}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 175956, "num_env_steps_sampled": 6272, "num_env_steps_trained": 175956, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 62.66640996886757, "num_env_steps_trained_throughput_per_sec": 2309.704824566833, "timesteps_total": 6272, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 103.35, "sample_time_ms": 16.556, "load_time_ms": 0.315, "load_throughput": 817751.403, "learn_time_ms": 18.141, "learn_throughput": 14221.829, "synch_weights_time_ms": 10.483}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 175956, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 175956, "last_target_update_ts": 6272, "num_target_updates": 682}, "done": false, "episodes_total": 0, "training_iteration": 49, "trial_id": "db258_00000", "date": "2023-11-16_21-49-22", "timestamp": 1700200162, "time_this_iter_s": 1.6834790706634521, "time_total_s": 75.67391753196716, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 75.67391753196716, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 47.699999999999996, "ram_util_percent": 63.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.007049560546875, "actor_loss": -17.29463768005371, "critic_loss": 0.09617399424314499, "alpha_loss": -2.0890228748321533, "alpha_value": 0.8115939497947693, "log_alpha_value": -0.20875515043735504, "target_entropy": -6.0, "policy_t": -0.03389202058315277, "mean_q": 14.084199905395508, "max_q": 14.658350944519043, "min_q": 13.619162559509277}, "td_error": [1.1898736953735352, 1.4491844177246094, 1.974809169769287, 2.2361159324645996, 1.5789556503295898, 0.9288067817687988, 2.192502975463867, 0.5235147476196289, 0.7322502136230469, 0.7357940673828125, 1.281531810760498, 1.727846622467041, 0.16114425659179688, 0.46717309951782227, 1.4680967330932617, 1.6116046905517578, 0.47271060943603516, 1.3896684646606445, 1.7982702255249023, 0.5995759963989258, 1.3927841186523438, 1.7732958793640137, 0.13071584701538086, 0.9385981559753418, 2.686483860015869, 1.3385305404663086, 0.17842626571655273, 0.27219343185424805, 0.5159797668457031, 0.4125213623046875, 1.7805137634277344, 2.0110654830932617, 1.3265743255615234, 0.44533491134643555, 0.7766265869140625, 0.6442570686340332, 1.0700840950012207, 0.9125070571899414, 0.12589693069458008, 2.216646671295166, 0.8236298561096191, 0.43453407287597656, 1.0394659042358398, 2.114253520965576, 0.3896193504333496, 0.7079153060913086, 0.6223502159118652, 2.2043986320495605, 0.8146853446960449, 0.8544912338256836, 1.00657320022583, 1.9584050178527832, 1.6805944442749023, 0.9335131645202637, 0.49947595596313477, 1.7483091354370117, 1.430227279663086, 0.8220958709716797, 0.6079020500183105, 1.2238731384277344, 0.333467960357666, 0.41617727279663086, 0.9632177352905273, 1.4754409790039062, 0.32383298873901367, 0.8922133445739746, 0.25403881072998047, 1.2486486434936523, 1.1667780876159668, 1.3800125122070312, 2.3324813842773438, 0.5879001617431641, 0.3167080879211426, 0.35272789001464844, 0.6705994606018066, 0.11715888977050781, 1.3759355545043945, 0.33567142486572266, 1.6220126152038574, 2.9315037727355957, 0.5743803977966309, 1.3840441703796387, 0.38850927352905273, 1.9149789810180664, 0.626741886138916, 2.365764617919922], "mean_td_error": 1.089950442314148, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 697.0, "diff_num_grad_updates_vs_sampler_policy": 696.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10823917388916, "actor_loss": -11.814828872680664, "critic_loss": 0.10981593281030655, "alpha_loss": -2.111335515975952, "alpha_value": 0.8114985227584839, "log_alpha_value": -0.2088727205991745, "target_entropy": -6.0, "policy_t": -0.01286203134804964, "mean_q": 8.499622344970703, "max_q": 8.96852970123291, "min_q": 8.141525268554688}, "td_error": [0.6754522323608398, 1.2887482643127441, 1.9470582008361816, 0.8793087005615234, 0.31410694122314453, 1.335319995880127, 0.8831205368041992, 1.4989352226257324, 0.27584266662597656, 1.056657314300537, 1.9301486015319824, 0.8225069046020508, 0.404388427734375, 1.6444072723388672, 0.7507109642028809, 1.1263279914855957, 0.41933441162109375, 1.4233574867248535, 0.5509214401245117, 1.6926732063293457, 0.5506582260131836, 2.2110586166381836, 2.9792723655700684, 0.09875106811523438, 0.6647176742553711, 0.4453697204589844, 0.4357566833496094, 0.529508113861084, 1.5153179168701172, 0.15269231796264648, 1.003300666809082, 1.0550727844238281, 1.0958099365234375, 1.0592927932739258, 1.5239005088806152, 0.644871711730957, 0.5588088035583496, 0.860893726348877, 2.527658462524414, 1.1859283447265625, 1.7776508331298828, 1.6872901916503906, 0.18307161331176758, 1.436680793762207, 1.0752224922180176, 2.2045536041259766, 0.8090734481811523, 0.9930009841918945, 2.294764518737793, 1.1168241500854492, 0.8534712791442871, 0.9940662384033203, 0.8184099197387695, 0.5956330299377441, 0.3887619972229004, 0.9852733612060547, 1.7180767059326172, 1.0482420921325684, 1.4520177841186523, 0.7667236328125, 1.7774548530578613, 0.04749250411987305, 1.6241235733032227, 0.7879033088684082, 1.263620376586914, 1.204193115234375, 1.3706903457641602, 1.8461055755615234, 0.9881887435913086, 2.2853212356567383, 1.9090027809143066, 0.8333740234375, 1.4275283813476562, 1.244187831878662, 0.855158805847168, 0.7747912406921387, 0.9297986030578613, 1.1861557960510254, 0.8528995513916016, 0.08303213119506836, 1.311025619506836, 0.8431611061096191, 1.6642780303955078, 0.2418651580810547, 1.3734450340270996, 2.4088215827941895], "mean_td_error": 1.1203533411026, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 697.0, "diff_num_grad_updates_vs_sampler_policy": 696.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103607177734375, "actor_loss": -12.044788360595703, "critic_loss": 0.153891921043396, "alpha_loss": -2.110804796218872, "alpha_value": 0.8114634156227112, "log_alpha_value": -0.20891596376895905, "target_entropy": -6.0, "policy_t": 0.05565963312983513, "mean_q": 8.750937461853027, "max_q": 9.08391284942627, "min_q": 8.336725234985352}, "td_error": [1.6749920845031738, 1.9628300666809082, 1.7615790367126465, 1.2168898582458496, 3.1341395378112793, 1.169877529144287, 0.5264639854431152, 0.15301513671875, 1.3545656204223633, 0.20441150665283203, 0.6042585372924805, 0.49898576736450195, 2.867506504058838, 1.1453475952148438, 2.3433127403259277, 0.41627931594848633, 1.3168296813964844, 1.8144593238830566, 1.1703433990478516, 0.5474333763122559, 0.8347015380859375, 0.755152702331543, 1.9549503326416016, 0.18976068496704102, 0.6113758087158203, 1.446582317352295, 1.44227933883667, 0.018578052520751953, 1.2199211120605469, 1.9948501586914062, 1.6474018096923828, 0.4802260398864746, 0.8662614822387695, 0.1364583969116211, 1.8087921142578125, 0.2753758430480957, 1.0571403503417969, 0.9569931030273438, 1.4707279205322266, 0.39861297607421875, 0.11547517776489258, 1.3655962944030762, 0.22046947479248047, 1.3466029167175293, 1.728851318359375, 0.2362346649169922, 1.1633753776550293, 1.956183910369873, 2.293421745300293, 1.1666922569274902, 2.118443012237549, 1.8463435173034668, 0.10945367813110352, 0.30035829544067383, 1.0304484367370605, 1.7977800369262695, 0.383237361907959, 0.6341276168823242, 0.8289403915405273, 1.7210884094238281, 2.031278133392334, 0.8357014656066895, 0.03992414474487305, 0.9512901306152344, 1.768423080444336, 1.5216951370239258, 0.7101659774780273, 0.4413933753967285, 1.0527310371398926, 1.0767269134521484, 1.742213249206543, 0.687253475189209, 1.0120439529418945, 0.8471570014953613, 1.1989192962646484, 1.265113353729248, 1.7630090713500977, 0.7923622131347656, 1.0057835578918457, 0.5347709655761719, 1.1708998680114746, 0.15752601623535156, 0.5311880111694336, 2.41005802154541, 0.7159848213195801, 1.3396430015563965], "mean_td_error": 1.1094887256622314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 697.0, "diff_num_grad_updates_vs_sampler_policy": 696.0}}, "num_env_steps_sampled": 6377, "num_env_steps_trained": 179826, "num_agent_steps_sampled": 19131, "num_agent_steps_trained": 179826, "last_target_update_ts": 6377, "num_target_updates": 697}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19131, "num_agent_steps_trained": 179826, "num_env_steps_sampled": 6377, "num_env_steps_trained": 179826, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.32405212288751, "num_env_steps_trained_throughput_per_sec": 2444.515063957854, "timesteps_total": 6377, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 19131, "timers": {"training_iteration_time_ms": 107.785, "sample_time_ms": 18.806, "load_time_ms": 0.318, "load_throughput": 811618.114, "learn_time_ms": 18.888, "learn_throughput": 13659.607, "synch_weights_time_ms": 10.662}, "counters": {"num_env_steps_sampled": 6377, "num_env_steps_trained": 179826, "num_agent_steps_sampled": 19131, "num_agent_steps_trained": 179826, "last_target_update_ts": 6377, "num_target_updates": 697}, "done": false, "episodes_total": 0, "training_iteration": 50, "trial_id": "db258_00000", "date": "2023-11-16_21-49-24", "timestamp": 1700200164, "time_this_iter_s": 1.5931718349456787, "time_total_s": 77.26708936691284, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb71a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 77.26708936691284, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 48.9, "ram_util_percent": 63.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06385612487793, "actor_loss": -17.351186752319336, "critic_loss": 0.0912594273686409, "alpha_loss": -2.146333932876587, "alpha_value": 0.8079367876052856, "log_alpha_value": -0.21327148377895355, "target_entropy": -6.0, "policy_t": 0.02592594362795353, "mean_q": 14.167293548583984, "max_q": 14.856437683105469, "min_q": 13.599472999572754}, "td_error": [0.10411882400512695, 1.5166921615600586, 0.5570993423461914, 1.3678131103515625, 0.2896733283996582, 1.5576152801513672, 0.5688018798828125, 1.1664371490478516, 1.0690693855285645, 0.8767695426940918, 1.204857349395752, 0.26152849197387695, 2.0730485916137695, 0.44759130477905273, 0.11284399032592773, 1.4923744201660156, 1.3592290878295898, 1.2337737083435059, 0.8307991027832031, 0.8541102409362793, 0.8694791793823242, 1.3056678771972656, 1.69563627243042, 1.287783145904541, 0.03888702392578125, 0.49048709869384766, 2.174583911895752, 1.022961139678955, 0.9430623054504395, 1.6962523460388184, 0.6973714828491211, 1.3428988456726074, 0.1007533073425293, 0.7675437927246094, 0.03845500946044922, 0.5047860145568848, 0.6968765258789062, 0.24032831192016602, 0.5737199783325195, 0.6044502258300781, 0.1108407974243164, 2.853516101837158, 0.19614601135253906, 1.3306374549865723, 0.45076942443847656, 1.006387710571289, 0.8833785057067871, 1.761563777923584, 1.0738468170166016, 0.8579754829406738, 2.4324722290039062, 0.33870744705200195, 2.0926880836486816, 1.424208641052246, 1.6725335121154785, 1.4728708267211914, 1.3848447799682617, 0.9770908355712891, 1.1098346710205078, 1.0349783897399902, 0.06982660293579102, 0.5114502906799316, 0.9068307876586914, 0.8175535202026367, 1.9452018737792969, 0.827430248260498, 0.9340877532958984, 2.1065335273742676, 1.607907772064209, 0.5050382614135742, 1.6690077781677246, 1.3355860710144043, 1.0923681259155273, 1.0024480819702148, 0.12958478927612305, 1.5264840126037598, 1.102668285369873, 1.1724724769592285, 0.35081958770751953, 0.6858830451965332, 1.2887353897094727, 1.136366844177246, 0.774101734161377, 1.2928929328918457, 0.9496965408325195, 2.0411276817321777], "mean_td_error": 1.026553750038147, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 712.0, "diff_num_grad_updates_vs_sampler_policy": 711.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13188362121582, "actor_loss": -12.109386444091797, "critic_loss": 0.09376156330108643, "alpha_loss": -2.1619482040405273, "alpha_value": 0.8078485727310181, "log_alpha_value": -0.21338067948818207, "target_entropy": -6.0, "policy_t": 0.008402081206440926, "mean_q": 8.812012672424316, "max_q": 9.195491790771484, "min_q": 8.589481353759766}, "td_error": [1.170069694519043, 1.4927668571472168, 0.4687790870666504, 1.4810519218444824, 0.3520383834838867, 1.165666103363037, 0.8865118026733398, 1.2640595436096191, 0.48093652725219727, 0.762598991394043, 3.331789016723633, 1.1143403053283691, 0.4164562225341797, 0.33116817474365234, 1.505566120147705, 0.5310769081115723, 2.739260673522949, 1.7236700057983398, 0.07741451263427734, 0.8814549446105957, 0.8182497024536133, 0.38829660415649414, 0.8582119941711426, 2.948269844055176, 1.3444304466247559, 0.6880025863647461, 0.8028740882873535, 2.1989049911499023, 0.27663087844848633, 1.365793228149414, 0.7290506362915039, 0.6980633735656738, 0.1364436149597168, 0.34380578994750977, 1.5734124183654785, 0.23087596893310547, 0.7646493911743164, 1.8804922103881836, 0.885319709777832, 1.0849857330322266, 0.30796337127685547, 1.203355312347412, 0.024495601654052734, 0.6420402526855469, 0.6579647064208984, 1.3921165466308594, 1.4763398170471191, 0.17580652236938477, 1.0786685943603516, 2.3343939781188965, 0.16320037841796875, 1.6744041442871094, 0.6830220222473145, 1.593672752380371, 1.160994529724121, 0.10562610626220703, 1.0828232765197754, 2.279109001159668, 1.4572677612304688, 0.0748891830444336, 1.5495963096618652, 2.057112693786621, 0.09532642364501953, 1.069413185119629, 1.6927976608276367, 0.9750094413757324, 1.1072797775268555, 2.0447030067443848, 0.5820298194885254, 1.8724308013916016, 1.3196969032287598, 0.25694894790649414, 0.5348782539367676, 0.6479792594909668, 0.9281444549560547, 0.13023662567138672, 1.7169222831726074, 0.5023317337036133, 0.8856868743896484, 0.46369123458862305, 0.6540412902832031, 0.4425220489501953, 0.014330863952636719, 0.5011324882507324, 0.9322514533996582, 0.4319028854370117], "mean_td_error": 0.9903486371040344, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 712.0, "diff_num_grad_updates_vs_sampler_policy": 711.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102279663085938, "actor_loss": -11.991262435913086, "critic_loss": 0.13950306177139282, "alpha_loss": -2.155978202819824, "alpha_value": 0.8078207969665527, "log_alpha_value": -0.2134150117635727, "target_entropy": -6.0, "policy_t": -0.001458287239074707, "mean_q": 8.686508178710938, "max_q": 9.107494354248047, "min_q": 8.464605331420898}, "td_error": [1.732010841369629, 0.2363295555114746, 0.7120156288146973, 0.7222332954406738, 1.086230754852295, 1.2480015754699707, 0.04300975799560547, 0.9736738204956055, 2.6036429405212402, 0.1833662986755371, 1.3761401176452637, 1.9835081100463867, 0.5166864395141602, 1.4051098823547363, 1.822756290435791, 0.34845447540283203, 0.39568138122558594, 0.7997169494628906, 0.8644618988037109, 0.4250054359436035, 0.8505721092224121, 1.831249713897705, 0.7556333541870117, 0.822840690612793, 2.0135650634765625, 1.2717266082763672, 0.5100564956665039, 0.6381196975708008, 0.6009159088134766, 1.3387680053710938, 2.416604518890381, 1.9387497901916504, 2.792509078979492, 0.573430061340332, 1.8093671798706055, 0.6031780242919922, 0.31824684143066406, 0.3117194175720215, 1.3688445091247559, 1.9018502235412598, 0.8784856796264648, 0.011753559112548828, 1.3429956436157227, 0.7982606887817383, 1.3227438926696777, 0.13852834701538086, 0.731381893157959, 0.9997596740722656, 0.41868019104003906, 0.9873695373535156, 0.6627445220947266, 1.6154026985168457, 0.6410360336303711, 0.08257532119750977, 0.15769195556640625, 0.0545506477355957, 1.8693666458129883, 0.7190451622009277, 1.6551079750061035, 3.14375638961792, 0.21960973739624023, 0.5943984985351562, 0.19637107849121094, 1.564598560333252, 0.9599289894104004, 0.9412226676940918, 0.5740594863891602, 1.1203603744506836, 1.2714195251464844, 1.117948055267334, 0.16229677200317383, 1.9253110885620117, 1.7168946266174316, 0.3936748504638672, 0.7302389144897461, 0.32889795303344727, 3.064207077026367, 0.08021259307861328, 1.8435287475585938, 0.06612443923950195, 0.7165751457214355, 1.655165672302246, 1.2819361686706543, 3.017033100128174, 1.1859626770019531, 1.0742392539978027], "mean_td_error": 1.0485981702804565, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 712.0, "diff_num_grad_updates_vs_sampler_policy": 711.0}}, "num_env_steps_sampled": 6482, "num_env_steps_trained": 183696, "num_agent_steps_sampled": 19446, "num_agent_steps_trained": 183696, "last_target_update_ts": 6482, "num_target_updates": 712}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19446, "num_agent_steps_trained": 183696, "num_env_steps_sampled": 6482, "num_env_steps_trained": 183696, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 57.45613672309146, "num_env_steps_trained_throughput_per_sec": 2117.6690392225137, "timesteps_total": 6482, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 19446, "timers": {"training_iteration_time_ms": 130.08, "sample_time_ms": 22.021, "load_time_ms": 0.377, "load_throughput": 684286.349, "learn_time_ms": 22.72, "learn_throughput": 11355.871, "synch_weights_time_ms": 13.964}, "counters": {"num_env_steps_sampled": 6482, "num_env_steps_trained": 183696, "num_agent_steps_sampled": 19446, "num_agent_steps_trained": 183696, "last_target_update_ts": 6482, "num_target_updates": 712}, "done": false, "episodes_total": 0, "training_iteration": 51, "trial_id": "db258_00000", "date": "2023-11-16_21-49-25", "timestamp": 1700200165, "time_this_iter_s": 1.8374230861663818, "time_total_s": 79.10451245307922, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 79.10451245307922, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 54.03333333333333, "ram_util_percent": 63.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108281135559082, "actor_loss": -17.8330020904541, "critic_loss": 0.08955317735671997, "alpha_loss": -2.2014405727386475, "alpha_value": 0.8042976260185242, "log_alpha_value": -0.21778587996959686, "target_entropy": -6.0, "policy_t": 0.004335771314799786, "mean_q": 14.626751899719238, "max_q": 15.237432479858398, "min_q": 14.233329772949219}, "td_error": [1.6100130081176758, 0.6274776458740234, 0.4575767517089844, 0.3098444938659668, 1.4917616844177246, 0.18702983856201172, 0.7345147132873535, 1.1401524543762207, 0.9186925888061523, 0.7981014251708984, 0.2557811737060547, 1.6767940521240234, 1.6088714599609375, 1.2451272010803223, 2.270017147064209, 0.36641979217529297, 0.9909706115722656, 1.1840901374816895, 1.9655461311340332, 1.353494644165039, 1.391371250152588, 0.6103277206420898, 1.3001728057861328, 0.9291996955871582, 0.628725528717041, 0.19570398330688477, 1.333970069885254, 0.9699134826660156, 1.2813215255737305, 1.1990232467651367, 0.5014615058898926, 0.6565923690795898, 0.540407657623291, 0.1619253158569336, 1.1192975044250488, 1.9166927337646484, 0.4683351516723633, 0.08195304870605469, 0.17611122131347656, 1.669079303741455, 0.514244556427002, 1.3808603286743164, 0.22952747344970703, 1.042513370513916, 1.291015625, 0.7871079444885254, 2.0493340492248535, 1.0119824409484863, 1.7818984985351562, 1.2278027534484863, 1.4847588539123535, 1.8967070579528809, 0.27869176864624023, 0.43581676483154297, 0.06993627548217773, 0.5035200119018555, 1.0400753021240234, 0.5766501426696777, 0.5474395751953125, 1.9157114028930664, 1.715789794921875, 0.8008108139038086, 1.7669291496276855, 2.132722854614258, 0.3715934753417969, 0.9515213966369629, 0.5461325645446777, 0.7301435470581055, 1.168609619140625, 0.6882824897766113, 0.23768901824951172, 0.7898960113525391, 0.7871956825256348, 2.407681465148926, 1.286832332611084, 1.679211139678955, 1.7218732833862305, 1.426598072052002, 0.06849813461303711, 0.5679259300231934, 0.6311798095703125, 1.947474479675293, 0.8821134567260742, 1.6102280616760254, 1.4372234344482422, 1.0934500694274902], "mean_td_error": 1.0213611125946045, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 727.0, "diff_num_grad_updates_vs_sampler_policy": 726.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113358497619629, "actor_loss": -12.123878479003906, "critic_loss": 0.11938825249671936, "alpha_loss": -2.203624725341797, "alpha_value": 0.8042119145393372, "log_alpha_value": -0.21789246797561646, "target_entropy": -6.0, "policy_t": -0.03832355886697769, "mean_q": 8.883878707885742, "max_q": 9.17092514038086, "min_q": 8.619483947753906}, "td_error": [1.3564801216125488, 2.166717529296875, 1.263326644897461, 0.4753599166870117, 1.848294734954834, 0.3489398956298828, 0.38524436950683594, 0.7961974143981934, 0.8445634841918945, 0.14194679260253906, 1.1353158950805664, 2.2654480934143066, 0.0836648941040039, 0.841397762298584, 0.7211894989013672, 2.069401264190674, 1.1687684059143066, 0.48451805114746094, 0.8958187103271484, 1.276820182800293, 1.8532867431640625, 4.8698530197143555, 1.9229516983032227, 1.4740495681762695, 0.708653450012207, 1.3201932907104492, 0.924623966217041, 1.5628786087036133, 0.7715206146240234, 2.192747116088867, 0.6839556694030762, 1.200479507446289, 1.6458168029785156, 1.1874966621398926, 1.5791478157043457, 0.6715078353881836, 1.6645851135253906, 1.8390207290649414, 1.7967700958251953, 0.659062385559082, 1.3566608428955078, 1.973073959350586, 2.607004165649414, 1.3385214805603027, 1.5990543365478516, 0.7028422355651855, 2.081976890563965, 0.7305850982666016, 0.6825904846191406, 2.2074379920959473, 0.4409170150756836, 1.048440933227539, 2.152543544769287, 1.260345458984375, 0.8919563293457031, 0.6387181282043457, 0.7848200798034668, 0.782099723815918, 0.9249558448791504, 0.5354909896850586, 1.531783103942871, 0.4658041000366211, 1.0274243354797363, 0.376492977142334, 0.3742408752441406, 0.12397432327270508, 0.7197422981262207, 1.1646604537963867, 2.890601634979248, 0.24373579025268555, 0.5555782318115234, 1.2925705909729004, 0.7457385063171387, 1.3554811477661133, 1.7375383377075195, 0.4439101219177246, 2.8907628059387207, 0.12633991241455078, 0.6677088737487793, 0.2554206848144531, 1.5158195495605469, 1.114306926727295, 2.4754791259765625, 1.0321989059448242, 0.4741497039794922, 0.9883236885070801], "mean_td_error": 1.19102144241333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 727.0, "diff_num_grad_updates_vs_sampler_policy": 726.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124858856201172, "actor_loss": -12.338757514953613, "critic_loss": 0.16260601580142975, "alpha_loss": -2.2063589096069336, "alpha_value": 0.8041937947273254, "log_alpha_value": -0.21791499853134155, "target_entropy": -6.0, "policy_t": 0.03564304858446121, "mean_q": 9.054254531860352, "max_q": 9.395984649658203, "min_q": 8.745682716369629}, "td_error": [0.3453998565673828, 2.456552028656006, 1.2114644050598145, 2.647489547729492, 1.5324711799621582, 4.0907440185546875, 1.9768176078796387, 0.8473639488220215, 0.2158222198486328, 0.7243170738220215, 0.4091768264770508, 1.9363093376159668, 1.468803882598877, 2.6713905334472656, 1.768864631652832, 1.526900291442871, 1.9399027824401855, 0.6774101257324219, 0.42577695846557617, 0.1433262825012207, 1.5101814270019531, 0.6157927513122559, 0.5345988273620605, 0.034549713134765625, 0.04390764236450195, 2.975776195526123, 0.02862691879272461, 2.4335227012634277, 1.150618553161621, 0.8211197853088379, 1.333094596862793, 1.3366012573242188, 1.130486011505127, 1.4194912910461426, 0.2195291519165039, 0.6354455947875977, 2.1653361320495605, 1.1011009216308594, 0.1407485008239746, 1.09828519821167, 1.0531902313232422, 1.7804780006408691, 0.9761514663696289, 2.577777862548828, 0.7721519470214844, 0.8235683441162109, 0.49542856216430664, 1.421949863433838, 0.7436418533325195, 0.3304314613342285, 2.300705909729004, 0.3104085922241211, 1.3414478302001953, 0.395327091217041, 0.19754648208618164, 1.6472978591918945, 1.9460844993591309, 1.275618553161621, 2.187239646911621, 0.36466217041015625, 1.3098726272583008, 1.7603387832641602, 0.38798999786376953, 0.08391952514648438, 0.7100515365600586, 1.4493370056152344, 1.916299819946289, 0.7585291862487793, 0.8164958953857422, 1.119314193725586, 2.082279682159424, 0.8407363891601562, 1.1405630111694336, 0.7556314468383789, 1.8653130531311035, 0.5284500122070312, 0.847724437713623, 1.2725210189819336, 0.2795748710632324, 1.4670400619506836, 0.6300802230834961, 1.6398954391479492, 0.6516237258911133, 1.5144853591918945, 1.1974964141845703, 0.35074472427368164], "mean_td_error": 1.1635178327560425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 727.0, "diff_num_grad_updates_vs_sampler_policy": 726.0}}, "num_env_steps_sampled": 6587, "num_env_steps_trained": 187566, "num_agent_steps_sampled": 19761, "num_agent_steps_trained": 187566, "last_target_update_ts": 6587, "num_target_updates": 727}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19761, "num_agent_steps_trained": 187566, "num_env_steps_sampled": 6587, "num_env_steps_trained": 187566, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.93153690884473, "num_env_steps_trained_throughput_per_sec": 2503.762360354563, "timesteps_total": 6587, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 19761, "timers": {"training_iteration_time_ms": 103.617, "sample_time_ms": 17.269, "load_time_ms": 0.305, "load_throughput": 846472.491, "learn_time_ms": 18.31, "learn_throughput": 14090.882, "synch_weights_time_ms": 10.386}, "counters": {"num_env_steps_sampled": 6587, "num_env_steps_trained": 187566, "num_agent_steps_sampled": 19761, "num_agent_steps_trained": 187566, "last_target_update_ts": 6587, "num_target_updates": 727}, "done": false, "episodes_total": 0, "training_iteration": 52, "trial_id": "db258_00000", "date": "2023-11-16_21-49-27", "timestamp": 1700200167, "time_this_iter_s": 1.5541791915893555, "time_total_s": 80.65869164466858, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 80.65869164466858, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 51.650000000000006, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.999913215637207, "actor_loss": -17.740642547607422, "critic_loss": 0.09237512946128845, "alpha_loss": -2.222999334335327, "alpha_value": 0.8006736636161804, "log_alpha_value": -0.22230184078216553, "target_entropy": -6.0, "policy_t": -0.06188497692346573, "mean_q": 14.606907844543457, "max_q": 15.473177909851074, "min_q": 14.10594654083252}, "td_error": [0.8505058288574219, 2.1071701049804688, 0.9877429008483887, 0.4637627601623535, 1.5089874267578125, 1.195298671722412, 0.4483222961425781, 0.499239444732666, 1.1321372985839844, 1.7657113075256348, 1.8307037353515625, 1.2581124305725098, 1.3986992835998535, 0.4850621223449707, 0.48343324661254883, 1.2234368324279785, 0.6610593795776367, 2.509115695953369, 0.3169269561767578, 0.5174832344055176, 1.4226412773132324, 0.7636985778808594, 2.0659236907958984, 1.314319133758545, 1.2546892166137695, 1.4320869445800781, 0.5061445236206055, 0.38755130767822266, 1.2022705078125, 1.0036554336547852, 1.7645149230957031, 0.9320282936096191, 1.1445364952087402, 1.5064849853515625, 0.15153980255126953, 0.5557899475097656, 1.283827781677246, 1.3575406074523926, 2.0308942794799805, 1.250561237335205, 0.3453397750854492, 1.2082018852233887, 1.002054214477539, 1.0538034439086914, 2.03694486618042, 0.8731899261474609, 0.26606321334838867, 0.47274303436279297, 1.6129589080810547, 0.6316614151000977, 1.183572769165039, 0.7766876220703125, 1.462613582611084, 2.079385280609131, 0.37650394439697266, 1.2049150466918945, 1.130521297454834, 0.8844747543334961, 1.7449793815612793, 1.8078665733337402, 0.1766653060913086, 0.47542572021484375, 0.2079916000366211, 1.2376408576965332, 1.27301025390625, 0.8125019073486328, 0.6176414489746094, 0.44386959075927734, 1.5494599342346191, 1.6076946258544922, 1.0080041885375977, 1.5541143417358398, 1.3874731063842773, 0.23227262496948242, 0.3302774429321289, 1.7045893669128418, 0.27654504776000977, 0.08277320861816406, 0.07568502426147461, 2.192202568054199, 0.49341821670532227, 0.7409162521362305, 2.3107423782348633, 1.0635719299316406, 1.0787463188171387, 0.16767549514770508], "mean_td_error": 1.049174427986145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 742.0, "diff_num_grad_updates_vs_sampler_policy": 741.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.111828804016113, "actor_loss": -12.44177532196045, "critic_loss": 0.11579879373311996, "alpha_loss": -2.248934745788574, "alpha_value": 0.8005900382995605, "log_alpha_value": -0.2224063128232956, "target_entropy": -6.0, "policy_t": 0.007079084869474173, "mean_q": 9.212032318115234, "max_q": 9.572150230407715, "min_q": 8.862540245056152}, "td_error": [0.5497469902038574, 0.7940812110900879, 0.9272756576538086, 0.9790573120117188, 1.184732437133789, 1.360764980316162, 2.6450772285461426, 2.9267287254333496, 0.5822420120239258, 0.5654377937316895, 0.7840700149536133, 1.7731223106384277, 2.002592086791992, 1.9848837852478027, 2.4494476318359375, 0.9656038284301758, 0.8042254447937012, 0.7316575050354004, 0.20268487930297852, 0.9091625213623047, 0.3558497428894043, 1.0421156883239746, 0.5279455184936523, 1.7075657844543457, 0.906339168548584, 1.5789060592651367, 2.3942160606384277, 1.8551836013793945, 1.5755596160888672, 1.4758672714233398, 1.2028603553771973, 0.8530998229980469, 1.0129146575927734, 0.5972418785095215, 1.5874218940734863, 0.550872802734375, 0.05987262725830078, 1.6983728408813477, 1.4632234573364258, 1.3588342666625977, 0.8525524139404297, 1.282966136932373, 0.15795516967773438, 0.08018827438354492, 0.48103761672973633, 0.7663559913635254, 1.0676231384277344, 1.5377788543701172, 0.3891582489013672, 2.161571979522705, 0.0606236457824707, 0.441195011138916, 0.8841137886047363, 2.048287868499756, 1.4227638244628906, 0.24846744537353516, 0.7269430160522461, 1.8833012580871582, 2.0001931190490723, 0.6768226623535156, 0.37279796600341797, 0.8490066528320312, 1.5636553764343262, 1.751563549041748, 0.5179524421691895, 0.6116142272949219, 0.28435802459716797, 1.5317773818969727, 2.0744504928588867, 0.8106436729431152, 0.7840981483459473, 0.9752864837646484, 0.8921022415161133, 1.2923212051391602, 2.711296558380127, 1.3287105560302734, 1.4531164169311523, 1.4292945861816406, 1.9540133476257324, 0.21740007400512695, 1.1388225555419922, 0.2394556999206543, 0.6784420013427734, 1.8950085639953613, 2.392395496368408, 2.501579761505127], "mean_td_error": 1.1668362617492676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 742.0, "diff_num_grad_updates_vs_sampler_policy": 741.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065330505371094, "actor_loss": -12.532172203063965, "critic_loss": 0.13670648634433746, "alpha_loss": -2.23873233795166, "alpha_value": 0.8005789518356323, "log_alpha_value": -0.2224201112985611, "target_entropy": -6.0, "policy_t": -0.012916759587824345, "mean_q": 9.315404891967773, "max_q": 9.779659271240234, "min_q": 8.946545600891113}, "td_error": [0.8588166236877441, 0.7989473342895508, 1.2150850296020508, 0.6673641204833984, 1.1764535903930664, 1.2079577445983887, 1.543027400970459, 0.630739688873291, 0.6722545623779297, 0.18799924850463867, 0.7599987983703613, 1.3490219116210938, 1.6859703063964844, 2.4910507202148438, 1.6483416557312012, 1.0829567909240723, 0.1240243911743164, 1.672877311706543, 1.168616771697998, 0.09160137176513672, 1.3266267776489258, 2.0474557876586914, 1.8963098526000977, 1.9157137870788574, 1.4722027778625488, 1.7884163856506348, 0.5612149238586426, 0.5764575004577637, 1.049781322479248, 2.208199977874756, 3.184964656829834, 0.3529219627380371, 0.4829373359680176, 0.9480085372924805, 0.39514827728271484, 0.19392681121826172, 1.251739501953125, 0.4376058578491211, 0.7830591201782227, 0.031000137329101562, 1.0468883514404297, 0.3109297752380371, 1.7024469375610352, 0.5691208839416504, 0.17641544342041016, 1.506481647491455, 1.1088132858276367, 1.0393657684326172, 0.4785146713256836, 0.8986935615539551, 1.4539742469787598, 0.6552753448486328, 1.8576383590698242, 0.2897772789001465, 0.8143835067749023, 1.285660743713379, 0.622800350189209, 0.8946313858032227, 0.7724437713623047, 1.1030726432800293, 0.6903257369995117, 0.0803384780883789, 0.080780029296875, 0.9665489196777344, 0.7165632247924805, 1.7230501174926758, 0.5308289527893066, 0.974097728729248, 0.9741034507751465, 2.186805248260498, 1.389173984527588, 0.10750150680541992, 1.2562174797058105, 0.019931316375732422, 2.785691261291504, 1.697800636291504, 0.23137617111206055, 1.0416374206542969, 0.8804664611816406, 0.5088200569152832, 1.695518970489502, 0.6652731895446777, 0.8372941017150879, 1.8223176002502441, 0.7152361869812012, 0.7074308395385742], "mean_td_error": 1.0210378170013428, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 742.0, "diff_num_grad_updates_vs_sampler_policy": 741.0}}, "num_env_steps_sampled": 6692, "num_env_steps_trained": 191436, "num_agent_steps_sampled": 20076, "num_agent_steps_trained": 191436, "last_target_update_ts": 6692, "num_target_updates": 742}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20076, "num_agent_steps_trained": 191436, "num_env_steps_sampled": 6692, "num_env_steps_trained": 191436, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.3128670794188, "num_env_steps_trained_throughput_per_sec": 2444.1028152128642, "timesteps_total": 6692, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 20076, "timers": {"training_iteration_time_ms": 102.348, "sample_time_ms": 15.484, "load_time_ms": 0.304, "load_throughput": 848064.602, "learn_time_ms": 17.746, "learn_throughput": 14538.511, "synch_weights_time_ms": 10.609}, "counters": {"num_env_steps_sampled": 6692, "num_env_steps_trained": 191436, "num_agent_steps_sampled": 20076, "num_agent_steps_trained": 191436, "last_target_update_ts": 6692, "num_target_updates": 742}, "done": false, "episodes_total": 0, "training_iteration": 53, "trial_id": "db258_00000", "date": "2023-11-16_21-49-29", "timestamp": 1700200169, "time_this_iter_s": 1.5924432277679443, "time_total_s": 82.25113487243652, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb71a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 82.25113487243652, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 55.900000000000006, "ram_util_percent": 63.349999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.12035846710205, "actor_loss": -18.137161254882812, "critic_loss": 0.10614806413650513, "alpha_loss": -2.29541015625, "alpha_value": 0.7970712780952454, "log_alpha_value": -0.22681114077568054, "target_entropy": -6.0, "policy_t": 0.04843813553452492, "mean_q": 14.917826652526855, "max_q": 15.560892105102539, "min_q": 14.404922485351562}, "td_error": [1.114466667175293, 1.0284438133239746, 0.7187314033508301, 1.252798080444336, 0.16774988174438477, 1.358675479888916, 1.586768627166748, 1.28717041015625, 0.636469841003418, 3.060631275177002, 1.7780938148498535, 1.3371825218200684, 0.09618043899536133, 0.9876976013183594, 1.511056900024414, 2.117058753967285, 2.1161046028137207, 0.3515644073486328, 1.08443021774292, 2.358290195465088, 0.8825459480285645, 2.9625582695007324, 2.251321315765381, 2.378490447998047, 0.20406293869018555, 1.6109404563903809, 0.8966999053955078, 1.7056422233581543, 0.6872549057006836, 1.351531982421875, 1.2999424934387207, 0.6774821281433105, 1.8189277648925781, 1.5510163307189941, 0.5343990325927734, 0.6549758911132812, 1.3076119422912598, 0.47274017333984375, 0.8098182678222656, 1.418445110321045, 0.3709077835083008, 0.8323464393615723, 0.13037872314453125, 1.5408263206481934, 1.4153175354003906, 1.5749235153198242, 2.025056838989258, 1.0465154647827148, 0.6961255073547363, 1.5012969970703125, 0.6771783828735352, 0.22708368301391602, 0.646489143371582, 1.1206507682800293, 1.2131991386413574, 0.6001529693603516, 2.09804630279541, 2.4829506874084473, 1.1906123161315918, 0.1755380630493164, 2.691643714904785, 1.607079029083252, 0.07860946655273438, 0.450223445892334, 1.0453681945800781, 2.024216651916504, 0.8296618461608887, 0.39377260208129883, 0.8898577690124512, 1.8405795097351074, 1.1836729049682617, 0.2837557792663574, 1.3113312721252441, 0.7297177314758301, 2.1062302589416504, 0.1320810317993164, 1.4478068351745605, 0.27796459197998047, 1.1504669189453125, 0.36525535583496094, 1.8755583763122559, 0.2772364616394043, 1.9660000801086426, 1.3946137428283691, 0.5533442497253418, 0.3791236877441406], "mean_td_error": 1.1660085916519165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 757.0, "diff_num_grad_updates_vs_sampler_policy": 756.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092222213745117, "actor_loss": -12.277251243591309, "critic_loss": 0.11057297885417938, "alpha_loss": -2.2900636196136475, "alpha_value": 0.7969895601272583, "log_alpha_value": -0.226913720369339, "target_entropy": -6.0, "policy_t": 0.024006471037864685, "mean_q": 9.045924186706543, "max_q": 9.483104705810547, "min_q": 8.698943138122559}, "td_error": [1.2788166999816895, 0.09414958953857422, 1.1656150817871094, 0.769312858581543, 0.6856651306152344, 1.3284187316894531, 0.9379563331604004, 1.0877161026000977, 1.5831623077392578, 0.7144222259521484, 0.32677507400512695, 0.992948055267334, 1.5554170608520508, 0.7159900665283203, 2.2486472129821777, 1.634091854095459, 1.0362286567687988, 0.043183326721191406, 2.4019341468811035, 1.310995101928711, 0.20053625106811523, 1.5736188888549805, 1.0924453735351562, 0.7022666931152344, 1.2145109176635742, 0.7111883163452148, 2.500148296356201, 1.2650566101074219, 1.733954906463623, 0.08375883102416992, 1.1445860862731934, 0.19434452056884766, 1.4377555847167969, 0.9369330406188965, 0.534205436706543, 0.20351600646972656, 0.5793275833129883, 0.20144271850585938, 0.9847550392150879, 1.6721243858337402, 0.6459169387817383, 0.9879093170166016, 1.1383795738220215, 2.298736095428467, 0.18631458282470703, 0.8389744758605957, 1.3863677978515625, 0.7861466407775879, 0.7467269897460938, 2.010443687438965, 1.6390190124511719, 0.46970272064208984, 1.9681086540222168, 0.9059844017028809, 1.5862855911254883, 1.431288719177246, 1.2608156204223633, 1.5119633674621582, 0.4836149215698242, 1.5419764518737793, 0.32299232482910156, 1.5637478828430176, 1.8483147621154785, 1.7847418785095215, 0.7129340171813965, 1.2374095916748047, 2.424659252166748, 0.39966487884521484, 0.7003870010375977, 1.9240856170654297, 1.4786005020141602, 2.4707260131835938, 0.3288412094116211, 1.270031452178955, 2.1406173706054688, 0.8301095962524414, 0.2740492820739746, 0.38373899459838867, 1.4902701377868652, 2.6018972396850586, 1.817652702331543, 0.17450475692749023, 1.249488353729248, 0.7560176849365234, 1.1599197387695312, 0.08324241638183594], "mean_td_error": 1.1178051233291626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 757.0, "diff_num_grad_updates_vs_sampler_policy": 756.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07174015045166, "actor_loss": -12.6797513961792, "critic_loss": 0.12745903432369232, "alpha_loss": -2.2855491638183594, "alpha_value": 0.7969790101051331, "log_alpha_value": -0.22692693769931793, "target_entropy": -6.0, "policy_t": 0.04252321273088455, "mean_q": 9.460341453552246, "max_q": 9.780332565307617, "min_q": 9.190731048583984}, "td_error": [0.9390277862548828, 1.0812358856201172, 0.42786121368408203, 0.8507909774780273, 0.981966495513916, 0.7159757614135742, 1.7222685813903809, 0.6230959892272949, 1.4258756637573242, 1.3291726112365723, 0.8226537704467773, 1.6341686248779297, 3.0623440742492676, 0.6057062149047852, 1.52067232131958, 0.5139579772949219, 1.4615745544433594, 0.28199195861816406, 0.1257619857788086, 0.502629280090332, 1.3803324699401855, 0.44809579849243164, 0.3034782409667969, 0.854637622833252, 1.1164484024047852, 0.3797950744628906, 0.11959171295166016, 1.1374597549438477, 0.3953108787536621, 1.0835981369018555, 0.5211505889892578, 0.6085882186889648, 0.014543533325195312, 1.3452787399291992, 0.07841157913208008, 1.9974708557128906, 1.8001585006713867, 2.7200098037719727, 1.0042791366577148, 0.8741378784179688, 1.0951948165893555, 0.5145392417907715, 0.2675943374633789, 0.223175048828125, 1.4742984771728516, 0.9953408241271973, 1.9770879745483398, 0.5172357559204102, 1.732442855834961, 0.8156204223632812, 0.8748717308044434, 0.35933971405029297, 0.3083000183105469, 0.43784523010253906, 0.721001148223877, 1.765761375427246, 0.14657926559448242, 2.034450054168701, 0.671234130859375, 1.0933265686035156, 0.4682154655456543, 0.7786741256713867, 0.6309986114501953, 0.31729841232299805, 1.9027624130249023, 3.113010883331299, 0.22324466705322266, 0.2270197868347168, 1.1501240730285645, 1.221163272857666, 1.4457345008850098, 0.6476335525512695, 0.812687873840332, 1.0544848442077637, 1.2352838516235352, 0.5690393447875977, 1.6268339157104492, 1.0559449195861816, 0.4906501770019531, 0.09916496276855469, 0.5078763961791992, 0.052446842193603516, 0.27980613708496094, 2.5794243812561035, 1.228738784790039, 1.8786883354187012], "mean_td_error": 0.9585313200950623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 757.0, "diff_num_grad_updates_vs_sampler_policy": 756.0}}, "num_env_steps_sampled": 6797, "num_env_steps_trained": 195306, "num_agent_steps_sampled": 20391, "num_agent_steps_trained": 195306, "last_target_update_ts": 6797, "num_target_updates": 757}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20391, "num_agent_steps_trained": 195306, "num_env_steps_sampled": 6797, "num_env_steps_trained": 195306, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.54448048911036, "num_env_steps_trained_throughput_per_sec": 2526.353709455782, "timesteps_total": 6797, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 20391, "timers": {"training_iteration_time_ms": 101.633, "sample_time_ms": 16.811, "load_time_ms": 0.309, "load_throughput": 834977.185, "learn_time_ms": 17.837, "learn_throughput": 14464.625, "synch_weights_time_ms": 9.455}, "counters": {"num_env_steps_sampled": 6797, "num_env_steps_trained": 195306, "num_agent_steps_sampled": 20391, "num_agent_steps_trained": 195306, "last_target_update_ts": 6797, "num_target_updates": 757}, "done": false, "episodes_total": 0, "training_iteration": 54, "trial_id": "db258_00000", "date": "2023-11-16_21-49-30", "timestamp": 1700200170, "time_this_iter_s": 1.5420749187469482, "time_total_s": 83.79320979118347, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 83.79320979118347, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 43.76666666666667, "ram_util_percent": 63.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065735816955566, "actor_loss": -18.362985610961914, "critic_loss": 0.09221571683883667, "alpha_loss": -2.328433036804199, "alpha_value": 0.7934833765029907, "log_alpha_value": -0.23132267594337463, "target_entropy": -6.0, "policy_t": 0.021114926785230637, "mean_q": 15.187704086303711, "max_q": 16.089418411254883, "min_q": 14.644282341003418}, "td_error": [1.6725049018859863, 2.0432510375976562, 0.36693429946899414, 1.2031402587890625, 1.6990032196044922, 1.721588134765625, 0.8356919288635254, 1.3738880157470703, 1.8065776824951172, 2.8016343116760254, 0.42113637924194336, 1.9304313659667969, 1.086869716644287, 2.0917038917541504, 0.9978427886962891, 3.407020092010498, 0.13354015350341797, 1.2145414352416992, 0.3109774589538574, 0.5988402366638184, 1.1914281845092773, 0.6324710845947266, 0.08908700942993164, 0.5570573806762695, 0.9971237182617188, 1.8443279266357422, 0.7247214317321777, 1.0189628601074219, 1.316185474395752, 1.8008699417114258, 0.8906431198120117, 1.209752082824707, 0.5090236663818359, 0.5261349678039551, 0.9749994277954102, 2.193903923034668, 1.1783781051635742, 1.3199663162231445, 1.921586036682129, 1.2037901878356934, 0.8123269081115723, 0.18888282775878906, 1.864060401916504, 0.5113444328308105, 1.2829771041870117, 1.0816917419433594, 1.6547093391418457, 0.757390022277832, 0.4132375717163086, 0.7730541229248047, 1.5604939460754395, 0.32322072982788086, 1.1190385818481445, 0.6773033142089844, 0.3725428581237793, 1.1663317680358887, 0.6113109588623047, 0.5698347091674805, 0.2673773765563965, 1.6478333473205566, 2.2173705101013184, 1.432969093322754, 0.2786712646484375, 0.5298142433166504, 0.9991998672485352, 0.6063075065612793, 1.3002605438232422, 1.0310821533203125, 1.357560634613037, 0.05681180953979492, 0.2613253593444824, 0.108428955078125, 1.9034972190856934, 0.2797222137451172, 2.1262755393981934, 0.28529977798461914, 0.794588565826416, 0.39485692977905273, 0.2061624526977539, 1.1229362487792969, 1.2299103736877441, 0.6562967300415039, 0.6600527763366699, 0.6907334327697754, 0.8986053466796875, 1.2527518272399902], "mean_td_error": 1.048302173614502, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 772.0, "diff_num_grad_updates_vs_sampler_policy": 771.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076940536499023, "actor_loss": -12.523321151733398, "critic_loss": 0.08302583545446396, "alpha_loss": -2.3320119380950928, "alpha_value": 0.7934056520462036, "log_alpha_value": -0.231420636177063, "target_entropy": -6.0, "policy_t": 0.00039136825944297016, "mean_q": 9.350111961364746, "max_q": 9.836548805236816, "min_q": 9.06592845916748}, "td_error": [0.5402193069458008, 0.3196377754211426, 3.283386707305908, 0.3733844757080078, 1.2414493560791016, 0.9880890846252441, 1.3816189765930176, 2.51702880859375, 0.4950852394104004, 0.9371495246887207, 0.6214151382446289, 1.2253265380859375, 1.9445886611938477, 1.1065688133239746, 0.4663662910461426, 3.1901073455810547, 1.0003361701965332, 0.5616283416748047, 1.1840648651123047, 0.8171796798706055, 0.5942072868347168, 0.586029052734375, 0.37199878692626953, 1.6551122665405273, 0.6214094161987305, 0.884404182434082, 0.7049007415771484, 0.9075145721435547, 1.1237893104553223, 1.0714502334594727, 0.5720949172973633, 1.743227481842041, 1.154320240020752, 0.9930081367492676, 0.914581298828125, 1.0840635299682617, 0.73895263671875, 0.633338451385498, 0.8712925910949707, 0.5625262260437012, 0.21323060989379883, 1.0311307907104492, 0.5777511596679688, 0.5871291160583496, 1.4101591110229492, 0.7480525970458984, 1.420720100402832, 1.5874738693237305, 1.0475716590881348, 0.5900559425354004, 2.0833168029785156, 1.076256275177002, 1.4601173400878906, 0.5726161003112793, 1.3253569602966309, 0.658637523651123, 0.40939903259277344, 0.8341121673583984, 1.251577377319336, 0.7167644500732422, 0.1286001205444336, 1.2775816917419434, 0.8562493324279785, 1.0086464881896973, 0.24001789093017578, 0.4591503143310547, 0.21834897994995117, 1.4614734649658203, 0.9720168113708496, 0.7896103858947754, 0.6586647033691406, 0.6185421943664551, 0.6094584465026855, 0.28211450576782227, 0.6358027458190918, 0.5068964958190918, 0.51025390625, 0.5008606910705566, 1.301961898803711, 0.5484271049499512, 0.3283047676086426, 0.08747339248657227, 0.8407373428344727, 0.423980712890625, 1.6986398696899414, 2.327413558959961], "mean_td_error": 0.9404129385948181, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 772.0, "diff_num_grad_updates_vs_sampler_policy": 771.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.058134078979492, "actor_loss": -12.508028030395508, "critic_loss": 0.17107421159744263, "alpha_loss": -2.327780246734619, "alpha_value": 0.7933961153030396, "log_alpha_value": -0.23143263161182404, "target_entropy": -6.0, "policy_t": -0.015841828659176826, "mean_q": 9.315589904785156, "max_q": 9.8781099319458, "min_q": 8.99711799621582}, "td_error": [0.46120691299438477, 2.249971389770508, 0.8145341873168945, 1.632767677307129, 1.5408082008361816, 1.7106542587280273, 1.4697394371032715, 0.04764604568481445, 1.9771876335144043, 1.2828426361083984, 1.3294992446899414, 0.7133312225341797, 0.6714396476745605, 2.1111345291137695, 0.47075462341308594, 0.24243736267089844, 0.7543830871582031, 0.9265670776367188, 1.6798477172851562, 1.8787403106689453, 1.5856218338012695, 2.7092843055725098, 1.4941015243530273, 0.384920597076416, 0.4034872055053711, 0.23680639266967773, 2.1168651580810547, 0.8456072807312012, 0.4815988540649414, 0.9746060371398926, 0.41190099716186523, 0.8963665962219238, 1.5931057929992676, 0.9836230278015137, 0.3040347099304199, 0.8755111694335938, 1.043485164642334, 0.42366647720336914, 1.1283988952636719, 0.8485932350158691, 0.4820690155029297, 0.7875332832336426, 2.0173234939575195, 0.1361522674560547, 1.5487451553344727, 1.6394405364990234, 1.2913274765014648, 0.21861028671264648, 0.1550440788269043, 1.3931655883789062, 2.7256903648376465, 1.9430642127990723, 0.5717029571533203, 0.3778691291809082, 1.6304750442504883, 0.2887115478515625, 1.8882155418395996, 0.06502723693847656, 1.7194852828979492, 1.1096868515014648, 2.4796485900878906, 0.7116026878356934, 1.1429171562194824, 1.7446107864379883, 0.24419116973876953, 2.1450233459472656, 3.2020936012268066, 1.252847671508789, 1.514836311340332, 1.576223373413086, 0.7582378387451172, 1.3820281028747559, 1.2956714630126953, 1.2690176963806152, 0.9919252395629883, 1.137862205505371, 2.716360092163086, 0.5320167541503906, 1.2062702178955078, 2.030207633972168, 2.3897275924682617, 0.06959009170532227, 1.5372490882873535, 1.6707477569580078, 1.9603495597839355, 1.0589165687561035], "mean_td_error": 1.2060068845748901, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 772.0, "diff_num_grad_updates_vs_sampler_policy": 771.0}}, "num_env_steps_sampled": 6902, "num_env_steps_trained": 199176, "num_agent_steps_sampled": 20706, "num_agent_steps_trained": 199176, "last_target_update_ts": 6902, "num_target_updates": 772}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20706, "num_agent_steps_trained": 199176, "num_env_steps_sampled": 6902, "num_env_steps_trained": 199176, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.71700420133058, "num_env_steps_trained_throughput_per_sec": 2532.712440563327, "timesteps_total": 6902, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 20706, "timers": {"training_iteration_time_ms": 102.269, "sample_time_ms": 14.48, "load_time_ms": 0.303, "load_throughput": 852809.861, "learn_time_ms": 17.793, "learn_throughput": 14499.803, "synch_weights_time_ms": 12.561}, "counters": {"num_env_steps_sampled": 6902, "num_env_steps_trained": 199176, "num_agent_steps_sampled": 20706, "num_agent_steps_trained": 199176, "last_target_update_ts": 6902, "num_target_updates": 772}, "done": false, "episodes_total": 0, "training_iteration": 55, "trial_id": "db258_00000", "date": "2023-11-16_21-49-32", "timestamp": 1700200172, "time_this_iter_s": 1.5358691215515137, "time_total_s": 85.32907891273499, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061bc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 85.32907891273499, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 47.45, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109161376953125, "actor_loss": -18.461366653442383, "critic_loss": 0.08019222319126129, "alpha_loss": -2.3841195106506348, "alpha_value": 0.7899090051651001, "log_alpha_value": -0.23583748936653137, "target_entropy": -6.0, "policy_t": 0.012281522154808044, "mean_q": 15.286005020141602, "max_q": 15.921868324279785, "min_q": 14.861435890197754}, "td_error": [0.1756734848022461, 0.7866730690002441, 0.6255326271057129, 2.237183094024658, 0.2739448547363281, 0.7589073181152344, 0.8442225456237793, 1.1140732765197754, 0.944669246673584, 1.092395305633545, 1.7219629287719727, 0.22312688827514648, 2.280338764190674, 0.41059064865112305, 0.5931477546691895, 0.8663034439086914, 1.0123677253723145, 0.5337104797363281, 1.4480457305908203, 1.116117000579834, 1.5425047874450684, 1.3247318267822266, 2.205109119415283, 0.558863639831543, 1.0176100730895996, 1.1899104118347168, 1.565943717956543, 0.6828131675720215, 1.3154993057250977, 0.20685958862304688, 1.289656162261963, 0.4910745620727539, 0.6813774108886719, 1.5311956405639648, 1.1980400085449219, 1.3974456787109375, 0.5595231056213379, 0.2837076187133789, 1.779080867767334, 1.1446146965026855, 0.6282062530517578, 1.6699085235595703, 1.2164020538330078, 0.21428680419921875, 0.09863519668579102, 0.12197160720825195, 0.5440378189086914, 0.15218448638916016, 1.9077916145324707, 0.27593231201171875, 1.3795995712280273, 1.619638442993164, 0.7665338516235352, 0.21132421493530273, 0.520348072052002, 0.7968244552612305, 2.115757942199707, 0.3391423225402832, 1.296682357788086, 0.5358486175537109, 1.4443273544311523, 0.5926284790039062, 0.34607410430908203, 0.6611886024475098, 0.7177567481994629, 0.12881946563720703, 0.21467876434326172, 0.9830207824707031, 0.7601099014282227, 3.168437957763672, 0.18808889389038086, 0.4344921112060547, 0.10811424255371094, 0.7015781402587891, 0.37847089767456055, 2.3396949768066406, 0.7179803848266602, 0.05730009078979492, 1.3870925903320312, 1.8099069595336914, 0.2866067886352539, 1.9325518608093262, 1.3430490493774414, 0.9295053482055664, 0.8866205215454102, 1.4153456687927246], "mean_td_error": 0.9461517333984375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 787.0, "diff_num_grad_updates_vs_sampler_policy": 786.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.118358612060547, "actor_loss": -12.649359703063965, "critic_loss": 0.11455653607845306, "alpha_loss": -2.387176513671875, "alpha_value": 0.7898396849632263, "log_alpha_value": -0.23592530190944672, "target_entropy": -6.0, "policy_t": 0.0006551770493388176, "mean_q": 9.386134147644043, "max_q": 9.635313034057617, "min_q": 9.153003692626953}, "td_error": [2.6080565452575684, 1.601630687713623, 1.790156364440918, 1.3093814849853516, 0.536381721496582, 0.1527690887451172, 0.47332000732421875, 1.2616510391235352, 3.1486330032348633, 1.170562744140625, 2.183169364929199, 0.644068717956543, 1.0599756240844727, 0.8916707038879395, 1.051863670349121, 1.6044602394104004, 1.140289306640625, 0.45171213150024414, 0.1933431625366211, 0.9278430938720703, 1.6002793312072754, 0.48630714416503906, 1.6696977615356445, 1.5181989669799805, 0.5481653213500977, 0.4068155288696289, 1.1663084030151367, 0.6618514060974121, 0.7396149635314941, 1.606058120727539, 1.3923850059509277, 0.7816257476806641, 1.7982721328735352, 1.58024263381958, 1.130286693572998, 0.657740592956543, 0.4667530059814453, 1.4937958717346191, 1.6276812553405762, 1.4429717063903809, 0.5809860229492188, 1.212005615234375, 0.16857528686523438, 1.391972541809082, 1.1716804504394531, 0.7608022689819336, 1.0295829772949219, 1.0217618942260742, 1.6634392738342285, 1.0238375663757324, 2.0130386352539062, 0.21799755096435547, 0.16276216506958008, 0.5511260032653809, 0.9440627098083496, 0.3855862617492676, 0.05599355697631836, 2.115795612335205, 0.4396986961364746, 1.4289188385009766, 2.5842838287353516, 0.6305732727050781, 1.5412750244140625, 1.047342300415039, 2.0997705459594727, 0.46927452087402344, 0.5354342460632324, 1.2384023666381836, 1.402754306793213, 0.47896480560302734, 1.4199199676513672, 0.6534819602966309, 0.19646692276000977, 0.20778846740722656, 2.348912239074707, 1.698563575744629, 1.960892677307129, 1.3211207389831543, 2.457404136657715, 1.3550124168395996, 1.8394598960876465, 0.5164289474487305, 2.3097753524780273, 0.6815228462219238, 1.1125364303588867, 1.4824938774108887], "mean_td_error": 1.1500637531280518, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 787.0, "diff_num_grad_updates_vs_sampler_policy": 786.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049589157104492, "actor_loss": -12.51205062866211, "critic_loss": 0.15536834299564362, "alpha_loss": -2.371074914932251, "alpha_value": 0.7898300290107727, "log_alpha_value": -0.23593749105930328, "target_entropy": -6.0, "policy_t": 0.0046228691935539246, "mean_q": 9.3184814453125, "max_q": 9.676421165466309, "min_q": 9.121577262878418}, "td_error": [0.07856273651123047, 0.3640108108520508, 0.9108180999755859, 1.774925708770752, 1.2878808975219727, 0.7103581428527832, 3.0189108848571777, 0.2854170799255371, 0.5525507926940918, 0.8531489372253418, 0.9261074066162109, 0.5362415313720703, 0.4463176727294922, 0.17836666107177734, 2.268125057220459, 0.8180646896362305, 1.0179591178894043, 1.3172607421875, 1.2736997604370117, 1.5851645469665527, 0.4980154037475586, 2.2345242500305176, 2.0383338928222656, 1.931063175201416, 1.7805185317993164, 1.9401025772094727, 0.25077247619628906, 0.7500557899475098, 0.2912101745605469, 1.5936532020568848, 2.084139823913574, 1.361783504486084, 1.0758466720581055, 1.5353403091430664, 2.057889461517334, 1.057175636291504, 0.8346600532531738, 1.0316686630249023, 0.8193607330322266, 0.1724410057067871, 2.049074172973633, 0.40151405334472656, 1.5188512802124023, 3.4292726516723633, 0.9722399711608887, 1.8775367736816406, 0.7680835723876953, 1.0290608406066895, 0.5650081634521484, 2.1478824615478516, 0.47881412506103516, 0.3882274627685547, 1.1307973861694336, 0.39152956008911133, 0.32143735885620117, 0.7865185737609863, 0.874506950378418, 1.2256784439086914, 1.0030512809753418, 1.1809396743774414, 0.45068883895874023, 0.45361852645874023, 2.02109432220459, 0.7887167930603027, 1.197000503540039, 1.8574280738830566, 2.7736048698425293, 1.3463664054870605, 1.0976438522338867, 0.4447917938232422, 1.5312528610229492, 1.8385968208312988, 0.3684811592102051, 0.5885105133056641, 0.526613712310791, 0.1699538230895996, 1.7330703735351562, 2.64994478225708, 0.21111774444580078, 1.1860451698303223, 0.39620161056518555, 0.5799694061279297, 1.467801570892334, 1.5263195037841797, 1.1080188751220703, 1.1060762405395508], "mean_td_error": 1.1337372064590454, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 787.0, "diff_num_grad_updates_vs_sampler_policy": 786.0}}, "num_env_steps_sampled": 7007, "num_env_steps_trained": 203046, "num_agent_steps_sampled": 21021, "num_agent_steps_trained": 203046, "last_target_update_ts": 7007, "num_target_updates": 787}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21021, "num_agent_steps_trained": 203046, "num_env_steps_sampled": 7007, "num_env_steps_trained": 203046, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.80869298113768, "num_env_steps_trained_throughput_per_sec": 2536.091827019075, "timesteps_total": 7007, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 21021, "timers": {"training_iteration_time_ms": 102.362, "sample_time_ms": 15.214, "load_time_ms": 0.306, "load_throughput": 843832.215, "learn_time_ms": 18.037, "learn_throughput": 14303.905, "synch_weights_time_ms": 9.932}, "counters": {"num_env_steps_sampled": 7007, "num_env_steps_trained": 203046, "num_agent_steps_sampled": 21021, "num_agent_steps_trained": 203046, "last_target_update_ts": 7007, "num_target_updates": 787}, "done": false, "episodes_total": 0, "training_iteration": 56, "trial_id": "db258_00000", "date": "2023-11-16_21-49-33", "timestamp": 1700200173, "time_this_iter_s": 1.5355277061462402, "time_total_s": 86.86460661888123, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb63e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 86.86460661888123, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 43.95, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075786590576172, "actor_loss": -18.714658737182617, "critic_loss": 0.11464384198188782, "alpha_loss": -2.4217138290405273, "alpha_value": 0.7863526940345764, "log_alpha_value": -0.2403498739004135, "target_entropy": -6.0, "policy_t": 0.03486242517828941, "mean_q": 15.55728816986084, "max_q": 16.602466583251953, "min_q": 15.25460433959961}, "td_error": [1.7287774085998535, 1.8731822967529297, 0.8745450973510742, 2.2207465171813965, 0.2048168182373047, 0.989954948425293, 1.4545960426330566, 0.8202362060546875, 1.0248422622680664, 1.958066463470459, 1.7468485832214355, 1.2029943466186523, 2.2821593284606934, 1.5939702987670898, 2.4518423080444336, 0.7536697387695312, 0.5403614044189453, 1.9880914688110352, 2.8870601654052734, 1.697059154510498, 2.185720443725586, 2.428739547729492, 1.1193609237670898, 0.8285388946533203, 1.5976924896240234, 1.1524162292480469, 1.1986026763916016, 2.1348352432250977, 1.0559697151184082, 1.1316070556640625, 0.31704187393188477, 0.47133731842041016, 0.2236919403076172, 2.1611485481262207, 0.02333211898803711, 1.3797988891601562, 1.372818946838379, 2.4140849113464355, 0.7246866226196289, 0.5552067756652832, 0.23759031295776367, 0.5769534111022949, 2.963578701019287, 1.5472288131713867, 0.1809377670288086, 0.4025535583496094, 0.23893356323242188, 1.3380846977233887, 1.8881607055664062, 0.2779412269592285, 1.3423871994018555, 2.555438995361328, 1.9179143905639648, 0.13219547271728516, 0.14238739013671875, 0.8940424919128418, 2.9255900382995605, 1.093729019165039, 1.5392870903015137, 0.41107797622680664, 0.3467445373535156, 1.0567941665649414, 1.0457592010498047, 1.3755192756652832, 0.7804832458496094, 0.5117912292480469, 1.6532483100891113, 0.5813808441162109, 1.875572681427002, 1.2633552551269531, 0.9101486206054688, 1.5852322578430176, 0.9129047393798828, 0.6866765022277832, 1.0920019149780273, 1.3776540756225586, 2.263152599334717, 1.012660026550293, 0.4919090270996094, 0.4151773452758789, 0.8189897537231445, 0.10345077514648438, 1.694760799407959, 2.489809513092041, 1.2117705345153809, 2.2013187408447266], "mean_td_error": 1.2457526922225952, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 802.0, "diff_num_grad_updates_vs_sampler_policy": 801.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114866256713867, "actor_loss": -12.94485092163086, "critic_loss": 0.10350542515516281, "alpha_loss": -2.4319393634796143, "alpha_value": 0.7862879633903503, "log_alpha_value": -0.24043217301368713, "target_entropy": -6.0, "policy_t": -0.01264696754515171, "mean_q": 9.766529083251953, "max_q": 10.040167808532715, "min_q": 9.45130443572998}, "td_error": [1.1174812316894531, 0.7593379020690918, 0.05383634567260742, 1.4944243431091309, 0.21041536331176758, 0.06435823440551758, 2.0602688789367676, 0.6993923187255859, 0.35014820098876953, 1.5617260932922363, 2.019735336303711, 0.8716864585876465, 1.68965482711792, 1.60129976272583, 2.1999807357788086, 1.2302045822143555, 2.0396227836608887, 0.5990800857543945, 0.9764142036437988, 1.6873445510864258, 0.6754841804504395, 1.4517040252685547, 0.7564458847045898, 0.041556358337402344, 1.0775399208068848, 0.9070587158203125, 0.4011039733886719, 0.5736141204833984, 1.2257323265075684, 0.4489269256591797, 1.5498323440551758, 0.5132946968078613, 0.10877037048339844, 2.087925910949707, 1.3823494911193848, 1.5160999298095703, 0.523838996887207, 1.6866264343261719, 1.0408439636230469, 2.794449806213379, 0.31197357177734375, 0.416778564453125, 0.8738307952880859, 0.6970024108886719, 0.3810577392578125, 1.8224763870239258, 2.134187698364258, 1.1380119323730469, 1.0399799346923828, 0.8317956924438477, 0.27441978454589844, 1.2341289520263672, 0.8112049102783203, 0.4313693046569824, 1.3060145378112793, 1.017923355102539, 1.1109461784362793, 1.4064245223999023, 1.1230230331420898, 0.8334794044494629, 0.44518613815307617, 0.8105301856994629, 1.0987133979797363, 0.7189788818359375, 0.5423717498779297, 1.36885404586792, 0.9733257293701172, 0.7702164649963379, 1.4396190643310547, 0.6829566955566406, 0.4535045623779297, 1.1163325309753418, 0.7238035202026367, 0.2664027214050293, 0.07431507110595703, 0.3251023292541504, 0.653409481048584, 1.5929021835327148, 2.0194644927978516, 1.9985203742980957, 0.7442631721496582, 1.080228328704834, 1.0583181381225586, 2.8468971252441406, 2.6115689277648926, 2.083674430847168], "mean_td_error": 1.0668033361434937, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 802.0, "diff_num_grad_updates_vs_sampler_policy": 801.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124731063842773, "actor_loss": -12.863935470581055, "critic_loss": 0.13600268959999084, "alpha_loss": -2.4344003200531006, "alpha_value": 0.7862810492515564, "log_alpha_value": -0.24044100940227509, "target_entropy": -6.0, "policy_t": 0.006802277639508247, "mean_q": 9.63885498046875, "max_q": 10.004270553588867, "min_q": 9.310906410217285}, "td_error": [2.474700927734375, 1.006840705871582, 0.6266589164733887, 1.012986183166504, 0.4978322982788086, 1.378580093383789, 0.8234858512878418, 1.7745509147644043, 1.2577857971191406, 2.2358407974243164, 0.5091390609741211, 0.6353001594543457, 1.4716691970825195, 0.47771739959716797, 1.3253188133239746, 1.168004035949707, 0.6199631690979004, 0.7403898239135742, 0.7981786727905273, 0.7288198471069336, 2.0062828063964844, 2.2336535453796387, 0.8015928268432617, 0.4228515625, 1.351454734802246, 1.5101642608642578, 0.6454720497131348, 0.9834966659545898, 1.4742088317871094, 0.933434009552002, 0.7656688690185547, 0.4109373092651367, 0.49146127700805664, 2.202641487121582, 0.20849227905273438, 0.2116107940673828, 0.8410243988037109, 0.5388612747192383, 0.3206014633178711, 1.2058677673339844, 2.497011184692383, 0.2754673957824707, 1.1678428649902344, 1.8420162200927734, 1.4786558151245117, 0.9808759689331055, 1.404245376586914, 1.8126640319824219, 1.2769603729248047, 0.392974853515625, 2.5686941146850586, 0.26518726348876953, 1.4570655822753906, 2.440037250518799, 1.4782328605651855, 1.496516227722168, 1.1892213821411133, 0.38840627670288086, 1.0430903434753418, 0.1776113510131836, 0.1871037483215332, 1.416398525238037, 0.9537715911865234, 0.010591983795166016, 0.2789015769958496, 0.4678373336791992, 0.5233702659606934, 0.8469953536987305, 1.0516514778137207, 0.5474777221679688, 0.06894254684448242, 0.5441555976867676, 0.42871618270874023, 1.5651788711547852, 1.775273323059082, 1.1523933410644531, 0.6546931266784668, 0.5817399024963379, 0.6495075225830078, 2.330313205718994, 0.30318164825439453, 0.8762459754943848, 2.027836322784424, 0.7148089408874512, 1.6047568321228027, 0.6634025573730469], "mean_td_error": 1.0346693992614746, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 802.0, "diff_num_grad_updates_vs_sampler_policy": 801.0}}, "num_env_steps_sampled": 7112, "num_env_steps_trained": 206916, "num_agent_steps_sampled": 21336, "num_agent_steps_trained": 206916, "last_target_update_ts": 7112, "num_target_updates": 802}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21336, "num_agent_steps_trained": 206916, "num_env_steps_sampled": 7112, "num_env_steps_trained": 206916, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.6280832247454, "num_env_steps_trained_throughput_per_sec": 2529.4350674263305, "timesteps_total": 7112, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 21336, "timers": {"training_iteration_time_ms": 103.024, "sample_time_ms": 15.72, "load_time_ms": 0.309, "load_throughput": 835363.928, "learn_time_ms": 18.035, "learn_throughput": 14305.663, "synch_weights_time_ms": 10.544}, "counters": {"num_env_steps_sampled": 7112, "num_env_steps_trained": 206916, "num_agent_steps_sampled": 21336, "num_agent_steps_trained": 206916, "last_target_update_ts": 7112, "num_target_updates": 802}, "done": false, "episodes_total": 0, "training_iteration": 57, "trial_id": "db258_00000", "date": "2023-11-16_21-49-35", "timestamp": 1700200175, "time_this_iter_s": 1.5384650230407715, "time_total_s": 88.403071641922, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0609a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 88.403071641922, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 43.25, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086750030517578, "actor_loss": -18.884265899658203, "critic_loss": 0.11663496494293213, "alpha_loss": -2.4698805809020996, "alpha_value": 0.7828111052513123, "log_alpha_value": -0.2448638528585434, "target_entropy": -6.0, "policy_t": -0.04633751139044762, "mean_q": 15.73669719696045, "max_q": 16.522178649902344, "min_q": 15.37040901184082}, "td_error": [0.48171329498291016, 1.444960594177246, 1.0472302436828613, 1.7424659729003906, 0.6628780364990234, 3.4174909591674805, 0.8838272094726562, 1.6419739723205566, 0.6842985153198242, 0.8417625427246094, 0.8833160400390625, 1.2013287544250488, 0.892667293548584, 1.2764859199523926, 0.16792535781860352, 2.645615577697754, 1.3382091522216797, 2.8646607398986816, 0.40977001190185547, 1.0090079307556152, 2.1741714477539062, 1.3451366424560547, 1.5173234939575195, 3.146986961364746, 0.3734893798828125, 0.8183221817016602, 1.7249703407287598, 0.3422861099243164, 3.639742851257324, 1.9003996849060059, 1.2620787620544434, 1.0392632484436035, 1.2488517761230469, 2.1286840438842773, 1.5128884315490723, 1.2742152214050293, 0.24681758880615234, 2.42984676361084, 1.420379638671875, 1.451883316040039, 1.258122444152832, 0.4207425117492676, 0.5039372444152832, 1.3624095916748047, 1.6780071258544922, 1.753474235534668, 0.8887295722961426, 0.20331954956054688, 1.284858226776123, 0.2914919853210449, 2.577087879180908, 1.7169852256774902, 1.1586475372314453, 0.280397891998291, 0.38809919357299805, 0.7606148719787598, 0.5621337890625, 0.6086492538452148, 1.425058364868164, 0.1850728988647461, 0.5988759994506836, 0.8564081192016602, 1.3028359413146973, 1.6009769439697266, 1.9687881469726562, 0.6212329864501953, 1.007695198059082, 0.8972077369689941, 0.6631431579589844, 1.2578177452087402, 1.1641077995300293, 1.479750633239746, 1.497556209564209, 0.8713865280151367, 1.731447696685791, 1.6611289978027344, 1.2582106590270996, 0.8714370727539062, 0.7941865921020508, 1.088209629058838, 0.10349702835083008, 0.7312965393066406, 1.4291949272155762, 1.9703078269958496, 1.9135246276855469, 2.2509679794311523], "mean_td_error": 1.2492367029190063, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 817.0, "diff_num_grad_updates_vs_sampler_policy": 816.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10481071472168, "actor_loss": -12.727763175964355, "critic_loss": 0.10751517117023468, "alpha_loss": -2.475055694580078, "alpha_value": 0.7827528119087219, "log_alpha_value": -0.24493835866451263, "target_entropy": -6.0, "policy_t": -0.022731183096766472, "mean_q": 9.569741249084473, "max_q": 9.884710311889648, "min_q": 9.330642700195312}, "td_error": [2.308424949645996, 1.2329754829406738, 1.2691283226013184, 0.29886531829833984, 0.5642681121826172, 0.7593708038330078, 0.45217132568359375, 1.7113218307495117, 0.6620535850524902, 0.8546996116638184, 1.6652741432189941, 1.040299415588379, 1.3388028144836426, 1.6580853462219238, 0.7183818817138672, 0.605743408203125, 0.5790834426879883, 0.06728696823120117, 0.4257998466491699, 2.6309762001037598, 1.5280108451843262, 0.5511627197265625, 2.4256067276000977, 0.8587164878845215, 1.3380703926086426, 1.5504631996154785, 1.6673917770385742, 2.162576675415039, 1.259272575378418, 0.5899271965026855, 0.8834810256958008, 0.422393798828125, 0.07239437103271484, 1.3446483612060547, 0.6043930053710938, 0.6467885971069336, 0.6154594421386719, 0.3746027946472168, 1.3707127571105957, 0.11016702651977539, 0.3547697067260742, 0.6955523490905762, 0.6201362609863281, 0.27997922897338867, 1.3641819953918457, 0.19110631942749023, 2.7352256774902344, 1.6527891159057617, 2.0003466606140137, 0.4109158515930176, 2.2684879302978516, 0.59112548828125, 1.5202531814575195, 0.6927084922790527, 1.4138612747192383, 1.0799150466918945, 1.0557193756103516, 2.0278396606445312, 1.2976436614990234, 0.9123215675354004, 0.11374998092651367, 0.7026090621948242, 1.4822092056274414, 2.0396175384521484, 2.2090225219726562, 0.37793970108032227, 2.632603168487549, 0.9581131935119629, 0.7954568862915039, 1.1799731254577637, 0.4123263359069824, 1.152604579925537, 2.34885835647583, 1.0811939239501953, 0.4899311065673828, 0.08983993530273438, 1.556307315826416, 0.10445165634155273, 1.849405288696289, 2.490203857421875, 1.3285531997680664, 1.448026180267334, 1.341174602508545, 1.1370091438293457, 0.39551687240600586, 0.3534994125366211], "mean_td_error": 1.0983061790466309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 817.0, "diff_num_grad_updates_vs_sampler_policy": 816.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.124397277832031, "actor_loss": -12.872026443481445, "critic_loss": 0.14922986924648285, "alpha_loss": -2.4799211025238037, "alpha_value": 0.7827475070953369, "log_alpha_value": -0.24494507908821106, "target_entropy": -6.0, "policy_t": -0.010962193831801414, "mean_q": 9.649077415466309, "max_q": 9.903019905090332, "min_q": 9.461458206176758}, "td_error": [1.3482003211975098, 2.5514936447143555, 1.7119369506835938, 0.646181583404541, 1.553896427154541, 0.7494831085205078, 1.612114429473877, 0.3101043701171875, 0.9406628608703613, 1.1568775177001953, 1.933431625366211, 0.4146461486816406, 0.18325233459472656, 1.5173020362854004, 0.8112583160400391, 0.06626319885253906, 0.9568777084350586, 0.6071681976318359, 1.1706809997558594, 0.35712194442749023, 0.7659082412719727, 2.3609113693237305, 2.197093963623047, 3.7455010414123535, 0.7895565032958984, 2.2865381240844727, 1.1913385391235352, 2.544461727142334, 1.8717913627624512, 2.047602653503418, 0.6177597045898438, 0.885807991027832, 0.784693717956543, 0.4866766929626465, 0.17385578155517578, 0.005473136901855469, 0.6299333572387695, 0.08490800857543945, 1.002197265625, 0.39264345169067383, 0.4439873695373535, 1.3822240829467773, 1.057821273803711, 2.9011974334716797, 0.8100128173828125, 0.4156150817871094, 0.34690189361572266, 1.2896676063537598, 0.22212934494018555, 1.8146710395812988, 1.3887948989868164, 1.4713454246520996, 1.727766513824463, 1.4957623481750488, 0.9545741081237793, 1.2568316459655762, 1.3302383422851562, 0.9560174942016602, 1.661992073059082, 1.1683039665222168, 1.0567822456359863, 1.1922001838684082, 0.7111859321594238, 1.0401372909545898, 1.3352813720703125, 0.528465747833252, 1.3363232612609863, 1.2323966026306152, 0.39271974563598633, 1.3404345512390137, 1.014561653137207, 1.6200928688049316, 0.1969289779663086, 0.7840375900268555, 0.6816978454589844, 0.31055212020874023, 0.4861888885498047, 0.12247657775878906, 0.8027019500732422, 2.182147979736328, 0.7978415489196777, 2.9241113662719727, 0.2392745018005371, 0.8848047256469727, 1.130356788635254, 1.4680142402648926], "mean_td_error": 1.1089671850204468, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 817.0, "diff_num_grad_updates_vs_sampler_policy": 816.0}}, "num_env_steps_sampled": 7217, "num_env_steps_trained": 210786, "num_agent_steps_sampled": 21651, "num_agent_steps_trained": 210786, "last_target_update_ts": 7217, "num_target_updates": 817}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21651, "num_agent_steps_trained": 210786, "num_env_steps_sampled": 7217, "num_env_steps_trained": 210786, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.71311780647355, "num_env_steps_trained_throughput_per_sec": 2495.71205629574, "timesteps_total": 7217, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 21651, "timers": {"training_iteration_time_ms": 104.108, "sample_time_ms": 16.326, "load_time_ms": 0.313, "load_throughput": 823664.509, "learn_time_ms": 18.136, "learn_throughput": 14225.886, "synch_weights_time_ms": 9.649}, "counters": {"num_env_steps_sampled": 7217, "num_env_steps_trained": 210786, "num_agent_steps_sampled": 21651, "num_agent_steps_trained": 210786, "last_target_update_ts": 7217, "num_target_updates": 817}, "done": false, "episodes_total": 0, "training_iteration": 58, "trial_id": "db258_00000", "date": "2023-11-16_21-49-37", "timestamp": 1700200177, "time_this_iter_s": 1.5594768524169922, "time_total_s": 89.96254849433899, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 89.96254849433899, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.800000000000004, "ram_util_percent": 62.833333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.132087707519531, "actor_loss": -18.981542587280273, "critic_loss": 0.09131655097007751, "alpha_loss": -2.5267252922058105, "alpha_value": 0.7792849540710449, "log_alpha_value": -0.2493785172700882, "target_entropy": -6.0, "policy_t": -0.0088345967233181, "mean_q": 15.862483978271484, "max_q": 16.542478561401367, "min_q": 15.51932144165039}, "td_error": [0.9009647369384766, 0.1496124267578125, 1.378553867340088, 0.26497745513916016, 0.12490463256835938, 0.18086767196655273, 1.9660935401916504, 1.985588550567627, 1.5190796852111816, 2.52447509765625, 2.373030662536621, 1.0785961151123047, 2.0913305282592773, 1.5974407196044922, 0.6815004348754883, 0.5408902168273926, 0.5132989883422852, 0.4229698181152344, 0.737004280090332, 0.5683012008666992, 1.4767236709594727, 0.9273386001586914, 0.0640401840209961, 1.2967748641967773, 1.2887072563171387, 0.4529428482055664, 1.0740642547607422, 1.002540111541748, 1.5161552429199219, 1.4907341003417969, 0.8137416839599609, 0.41823577880859375, 0.1357278823852539, 0.7147889137268066, 0.4338107109069824, 0.10734367370605469, 2.093503475189209, 2.213571548461914, 0.8229479789733887, 1.9441680908203125, 1.4946937561035156, 1.0380034446716309, 0.11191654205322266, 0.8253359794616699, 0.14429473876953125, 1.3014030456542969, 0.2211771011352539, 1.8384513854980469, 2.0308170318603516, 0.9775676727294922, 1.5519075393676758, 1.100320816040039, 1.4643974304199219, 0.9242429733276367, 0.03302192687988281, 0.3077974319458008, 1.8462915420532227, 0.8097577095031738, 1.1510953903198242, 1.1336374282836914, 0.6061739921569824, 0.14609766006469727, 1.037248134613037, 0.1884751319885254, 0.8934011459350586, 0.30852413177490234, 0.14261293411254883, 0.6566696166992188, 0.7980518341064453, 0.9690752029418945, 1.4225959777832031, 1.3940105438232422, 1.158045768737793, 0.9168276786804199, 2.7569079399108887, 1.6444110870361328, 1.2236442565917969, 1.1908702850341797, 0.7025012969970703, 1.1766061782836914, 1.5727386474609375, 0.7334957122802734, 1.726102352142334, 2.428311824798584, 0.6098165512084961, 0.6526422500610352], "mean_td_error": 1.037782907485962, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 832.0, "diff_num_grad_updates_vs_sampler_policy": 831.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.019834518432617, "actor_loss": -12.765881538391113, "critic_loss": 0.11818363517522812, "alpha_loss": -2.499420642852783, "alpha_value": 0.7792313694953918, "log_alpha_value": -0.2494472861289978, "target_entropy": -6.0, "policy_t": -0.02580242231488228, "mean_q": 9.692975997924805, "max_q": 9.900863647460938, "min_q": 9.464181900024414}, "td_error": [2.0709948539733887, 0.0836491584777832, 1.0335464477539062, 1.2426013946533203, 0.8358116149902344, 1.3142743110656738, 1.4638652801513672, 1.3579087257385254, 0.5280680656433105, 0.1919841766357422, 0.023716449737548828, 0.8020567893981934, 0.14764976501464844, 1.923142910003662, 2.249208927154541, 1.7819061279296875, 0.8873758316040039, 0.981907844543457, 0.8850274085998535, 1.9462285041809082, 2.4962196350097656, 0.3337864875793457, 1.5701394081115723, 0.8713321685791016, 0.0729818344116211, 0.3729071617126465, 0.8777122497558594, 1.2189931869506836, 1.7290916442871094, 1.1776533126831055, 0.006201744079589844, 0.7150797843933105, 0.9807186126708984, 1.296903133392334, 1.6633596420288086, 0.937497615814209, 2.691920757293701, 1.8227572441101074, 1.3760395050048828, 1.203794002532959, 1.6639404296875, 0.39136266708374023, 1.9208173751831055, 1.691380500793457, 2.3834352493286133, 0.8770809173583984, 2.221907138824463, 0.49983882904052734, 0.9084234237670898, 0.5519084930419922, 0.7869954109191895, 1.7209692001342773, 1.968740463256836, 1.741312026977539, 0.9937419891357422, 0.6098036766052246, 2.2114291191101074, 0.7196412086486816, 0.20948171615600586, 0.9555468559265137, 2.0895676612854004, 1.100545883178711, 0.21558237075805664, 2.0356531143188477, 1.8634071350097656, 0.5584893226623535, 0.9140377044677734, 1.6908597946166992, 2.25341796875, 0.8221592903137207, 0.9626865386962891, 1.1145305633544922, 1.2304105758666992, 0.33797359466552734, 1.2539682388305664, 0.523681640625, 1.1246137619018555, 1.8443512916564941, 0.5345964431762695, 0.4059476852416992, 1.6473455429077148, 1.5878667831420898, 1.223902702331543, 1.8152151107788086, 0.9167160987854004, 0.32311058044433594], "mean_td_error": 1.1695860624313354, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 832.0, "diff_num_grad_updates_vs_sampler_policy": 831.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071430206298828, "actor_loss": -12.98608684539795, "critic_loss": 0.14233791828155518, "alpha_loss": -2.512298822402954, "alpha_value": 0.7792307138442993, "log_alpha_value": -0.24944807589054108, "target_entropy": -6.0, "policy_t": 0.03165832534432411, "mean_q": 9.839203834533691, "max_q": 10.138965606689453, "min_q": 9.59470272064209}, "td_error": [1.8496856689453125, 2.5437145233154297, 0.8285002708435059, 0.31789350509643555, 1.5951595306396484, 1.8288021087646484, 1.0113630294799805, 0.490877628326416, 0.4246644973754883, 1.0804057121276855, 1.1638145446777344, 0.9666447639465332, 0.9307403564453125, 1.7943611145019531, 0.8417978286743164, 2.2081737518310547, 0.5859289169311523, 0.10108423233032227, 1.4624252319335938, 0.6893577575683594, 0.8437952995300293, 2.0139284133911133, 0.9026069641113281, 1.3151865005493164, 0.21065378189086914, 1.637660026550293, 0.2839622497558594, 0.9255890846252441, 1.9264698028564453, 0.4402928352355957, 1.8620376586914062, 0.9131011962890625, 1.4451494216918945, 0.30117034912109375, 0.24681520462036133, 1.0670137405395508, 1.1395206451416016, 0.4870567321777344, 0.3835310935974121, 0.5727958679199219, 1.1683402061462402, 1.4848437309265137, 2.4449687004089355, 0.6810531616210938, 1.8543124198913574, 0.3423953056335449, 1.1126313209533691, 1.0351476669311523, 1.0651607513427734, 1.196664810180664, 1.5405702590942383, 1.4822750091552734, 1.1928629875183105, 0.7030601501464844, 1.2294549942016602, 2.652247905731201, 1.2079057693481445, 0.35105037689208984, 0.74847412109375, 2.614126205444336, 1.2661705017089844, 1.1235337257385254, 0.33223485946655273, 0.15258169174194336, 1.300156593322754, 0.6322684288024902, 0.5310029983520508, 0.8069000244140625, 0.9326238632202148, 0.30425596237182617, 0.8849067687988281, 0.6492266654968262, 0.8710641860961914, 0.5363945960998535, 0.09548425674438477, 1.4278316497802734, 0.7414584159851074, 0.4923405647277832, 1.5437512397766113, 0.27831268310546875, 1.2676167488098145, 1.4700918197631836, 1.112898349761963, 1.5037765502929688, 2.345303535461426, 0.5233445167541504], "mean_td_error": 1.0565909147262573, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 832.0, "diff_num_grad_updates_vs_sampler_policy": 831.0}}, "num_env_steps_sampled": 7322, "num_env_steps_trained": 214656, "num_agent_steps_sampled": 21966, "num_agent_steps_trained": 214656, "last_target_update_ts": 7322, "num_target_updates": 832}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21966, "num_agent_steps_trained": 214656, "num_env_steps_sampled": 7322, "num_env_steps_trained": 214656, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.3243018320879, "num_env_steps_trained_throughput_per_sec": 2444.5242675255254, "timesteps_total": 7322, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 21966, "timers": {"training_iteration_time_ms": 107.287, "sample_time_ms": 17.677, "load_time_ms": 0.316, "load_throughput": 817504.293, "learn_time_ms": 18.325, "learn_throughput": 14079.002, "synch_weights_time_ms": 10.943}, "counters": {"num_env_steps_sampled": 7322, "num_env_steps_trained": 214656, "num_agent_steps_sampled": 21966, "num_agent_steps_trained": 214656, "last_target_update_ts": 7322, "num_target_updates": 832}, "done": false, "episodes_total": 0, "training_iteration": 59, "trial_id": "db258_00000", "date": "2023-11-16_21-49-38", "timestamp": 1700200178, "time_this_iter_s": 1.591745138168335, "time_total_s": 91.55429363250732, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb63e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 91.55429363250732, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 38.0, "ram_util_percent": 62.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10008430480957, "actor_loss": -19.51231575012207, "critic_loss": 0.10075241327285767, "alpha_loss": -2.5643343925476074, "alpha_value": 0.7757752537727356, "log_alpha_value": -0.2538923919200897, "target_entropy": -6.0, "policy_t": -0.007511109113693237, "mean_q": 16.396028518676758, "max_q": 16.91079330444336, "min_q": 15.986581802368164}, "td_error": [0.8517589569091797, 0.6574535369873047, 0.3918733596801758, 1.9317378997802734, 0.39318370819091797, 1.854024887084961, 1.5922136306762695, 1.2496490478515625, 1.8013696670532227, 0.8823013305664062, 1.4198341369628906, 2.9226884841918945, 1.5899038314819336, 2.60382080078125, 2.398618698120117, 0.3220386505126953, 0.1755380630493164, 1.320307731628418, 1.3905162811279297, 0.7270431518554688, 0.06453418731689453, 1.0535449981689453, 1.4661216735839844, 0.33258914947509766, 1.3135147094726562, 1.0795574188232422, 1.3259563446044922, 0.1973419189453125, 1.8087234497070312, 0.5313262939453125, 1.4633121490478516, 0.6596927642822266, 0.4006214141845703, 1.4504203796386719, 0.23454666137695312, 2.335190773010254, 0.1432971954345703, 0.2231435775756836, 2.1114683151245117, 0.7035884857177734, 2.068169593811035, 1.6672306060791016, 1.967916488647461, 1.267974853515625, 2.4746828079223633, 1.3327255249023438, 0.10731315612792969, 0.9705066680908203, 2.1945362091064453, 0.938847541809082, 0.7486400604248047, 1.015390396118164, 1.8459501266479492, 1.7664031982421875, 0.8267202377319336, 0.18676376342773438, 1.0587711334228516, 0.49952125549316406, 1.3735952377319336, 0.4821767807006836, 0.3780355453491211, 0.35259437561035156, 0.9129486083984375, 1.105708122253418, 0.2027416229248047, 1.2139606475830078, 1.0376081466674805, 1.3231983184814453, 0.036468505859375, 1.4221744537353516, 1.3624582290649414, 2.0785903930664062, 0.08080291748046875, 0.26271820068359375, 1.1152658462524414, 1.687326431274414, 0.07930850982666016, 0.4632568359375, 2.573566436767578, 0.23296070098876953, 0.6217737197875977, 2.0666112899780273, 0.8187656402587891, 1.6860885620117188, 0.5526504516601562, 0.9771852493286133], "mean_td_error": 1.1024763584136963, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 847.0, "diff_num_grad_updates_vs_sampler_policy": 846.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097919464111328, "actor_loss": -12.935325622558594, "critic_loss": 0.10448965430259705, "alpha_loss": -2.5643630027770996, "alpha_value": 0.7757309079170227, "log_alpha_value": -0.2539496123790741, "target_entropy": -6.0, "policy_t": 0.0135869849473238, "mean_q": 9.765509605407715, "max_q": 10.21810531616211, "min_q": 9.49521255493164}, "td_error": [0.734440803527832, 1.017580509185791, 1.0693588256835938, 0.7515239715576172, 1.1627898216247559, 0.023651599884033203, 1.6508102416992188, 0.15569114685058594, 1.4778542518615723, 0.9615802764892578, 1.3308815956115723, 0.9743638038635254, 0.9995222091674805, 2.45597505569458, 1.2653064727783203, 0.3137850761413574, 0.4489622116088867, 1.117009162902832, 2.242349147796631, 1.2504911422729492, 1.9721779823303223, 0.6941308975219727, 1.0292038917541504, 1.159560203552246, 1.2327542304992676, 1.2930879592895508, 2.835522174835205, 1.415036678314209, 0.8747787475585938, 1.8161506652832031, 1.2293376922607422, 0.39314937591552734, 1.4680819511413574, 1.4317469596862793, 1.2497344017028809, 1.0416254997253418, 0.7071847915649414, 0.5252189636230469, 0.6611342430114746, 1.0437045097351074, 1.4449076652526855, 0.07965469360351562, 0.07780027389526367, 1.2687830924987793, 0.8874211311340332, 0.5456423759460449, 1.038074016571045, 0.7497639656066895, 0.9584255218505859, 1.3197927474975586, 1.3847332000732422, 0.6561594009399414, 1.2206010818481445, 1.6056451797485352, 1.442152500152588, 0.9340524673461914, 0.3519010543823242, 0.627833366394043, 2.575251579284668, 1.4082884788513184, 2.365541458129883, 0.45638418197631836, 0.4691805839538574, 1.2468008995056152, 0.3229684829711914, 0.606992244720459, 0.41882896423339844, 1.1112604141235352, 0.7986149787902832, 1.6405282020568848, 1.1806106567382812, 2.017286777496338, 0.9112658500671387, 1.3270196914672852, 2.1561050415039062, 0.43735408782958984, 0.21378374099731445, 0.9276866912841797, 1.837193489074707, 0.8757996559143066, 0.46628713607788086, 1.3552465438842773, 1.5712785720825195, 1.406104564666748, 1.0551118850708008, 0.5414643287658691], "mean_td_error": 1.0903584957122803, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 847.0, "diff_num_grad_updates_vs_sampler_policy": 846.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.085176467895508, "actor_loss": -12.930990219116211, "critic_loss": 0.13919594883918762, "alpha_loss": -2.561149835586548, "alpha_value": 0.7757291197776794, "log_alpha_value": -0.25395190715789795, "target_entropy": -6.0, "policy_t": 0.03139723464846611, "mean_q": 9.791069984436035, "max_q": 10.131758689880371, "min_q": 9.430314064025879}, "td_error": [0.8932051658630371, 1.331860065460205, 0.8388957977294922, 1.1085457801818848, 1.0086607933044434, 1.1379342079162598, 2.2583937644958496, 1.8498106002807617, 1.844254970550537, 1.383443832397461, 1.3214426040649414, 1.2293586730957031, 0.42673492431640625, 0.4445028305053711, 2.4629502296447754, 0.3978142738342285, 1.062415599822998, 0.414823055267334, 0.10474205017089844, 1.343745231628418, 0.4747886657714844, 0.7520818710327148, 1.5867657661437988, 1.1876440048217773, 0.8398804664611816, 1.7991743087768555, 0.6958551406860352, 0.011993408203125, 1.9203858375549316, 1.1747212409973145, 0.6537222862243652, 0.34395837783813477, 0.4678316116333008, 1.7560820579528809, 1.1180858612060547, 0.3016548156738281, 1.3655672073364258, 1.7755846977233887, 0.3422064781188965, 0.07120609283447266, 1.759871482849121, 2.1838040351867676, 0.4937152862548828, 1.0539159774780273, 0.5941414833068848, 1.2691187858581543, 2.154231071472168, 1.0173616409301758, 0.4804511070251465, 1.8661160469055176, 2.552943706512451, 0.9158697128295898, 1.4422492980957031, 1.8104095458984375, 0.45653820037841797, 1.1017436981201172, 2.67055082321167, 1.6629219055175781, 0.5677881240844727, 0.4427475929260254, 0.46819448471069336, 0.4388246536254883, 0.2626471519470215, 0.9946498870849609, 0.3608379364013672, 1.5164060592651367, 1.365903377532959, 1.4454460144042969, 0.5824341773986816, 0.6364479064941406, 0.30916738510131836, 0.7152466773986816, 1.0683698654174805, 0.1944894790649414, 0.5238437652587891, 1.1764025688171387, 0.8948001861572266, 0.32108163833618164, 1.9734344482421875, 0.9680004119873047, 0.14571523666381836, 0.8630151748657227, 1.960087776184082, 1.0879502296447754, 0.8609604835510254, 0.10910463333129883], "mean_td_error": 1.0377055406570435, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 847.0, "diff_num_grad_updates_vs_sampler_policy": 846.0}}, "num_env_steps_sampled": 7427, "num_env_steps_trained": 218526, "num_agent_steps_sampled": 22281, "num_agent_steps_trained": 218526, "last_target_update_ts": 7427, "num_target_updates": 847}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22281, "num_agent_steps_trained": 218526, "num_env_steps_sampled": 7427, "num_env_steps_trained": 218526, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.5941825053389, "num_env_steps_trained_throughput_per_sec": 2491.3284409110624, "timesteps_total": 7427, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 22281, "timers": {"training_iteration_time_ms": 103.785, "sample_time_ms": 15.766, "load_time_ms": 0.314, "load_throughput": 820479.515, "learn_time_ms": 17.92, "learn_throughput": 14397.288, "synch_weights_time_ms": 10.498}, "counters": {"num_env_steps_sampled": 7427, "num_env_steps_trained": 218526, "num_agent_steps_sampled": 22281, "num_agent_steps_trained": 218526, "last_target_update_ts": 7427, "num_target_updates": 847}, "done": false, "episodes_total": 0, "training_iteration": 60, "trial_id": "db258_00000", "date": "2023-11-16_21-49-40", "timestamp": 1700200180, "time_this_iter_s": 1.5622351169586182, "time_total_s": 93.11652874946594, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 93.11652874946594, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 41.8, "ram_util_percent": 62.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.151809692382812, "actor_loss": -19.32335090637207, "critic_loss": 0.09356412291526794, "alpha_loss": -2.62332820892334, "alpha_value": 0.7722786068916321, "log_alpha_value": -0.25840988755226135, "target_entropy": -6.0, "policy_t": -0.05252881348133087, "mean_q": 16.213947296142578, "max_q": 16.641849517822266, "min_q": 15.813246726989746}, "td_error": [1.602386474609375, 1.007925033569336, 0.7445487976074219, 0.9020400047302246, 1.7416210174560547, 0.4460277557373047, 0.422637939453125, 1.594069480895996, 0.47046756744384766, 1.92633056640625, 0.7086381912231445, 0.25962162017822266, 2.0311927795410156, 1.4302825927734375, 0.6328744888305664, 0.43949413299560547, 0.5940341949462891, 1.3399896621704102, 0.5364980697631836, 0.8227963447570801, 0.6163721084594727, 0.12994384765625, 2.4516239166259766, 0.9681663513183594, 0.04413795471191406, 1.2939443588256836, 1.0008344650268555, 2.6050758361816406, 1.3784208297729492, 1.066131591796875, 2.073240280151367, 1.0446815490722656, 0.0606999397277832, 0.2909584045410156, 0.6317672729492188, 0.5331830978393555, 0.7904062271118164, 1.189286231994629, 1.9444665908813477, 0.5824985504150391, 1.9061121940612793, 0.4003324508666992, 0.3440589904785156, 0.508544921875, 0.4873313903808594, 0.7595224380493164, 0.2924623489379883, 0.6202216148376465, 0.45452022552490234, 1.3355493545532227, 1.2311105728149414, 0.15589427947998047, 1.4668140411376953, 1.4315929412841797, 0.5559072494506836, 2.0775604248046875, 0.8788280487060547, 0.7528800964355469, 3.0606918334960938, 0.6859054565429688, 1.6961345672607422, 0.08744430541992188, 0.35463714599609375, 2.1823654174804688, 2.082378387451172, 2.072986602783203, 0.3763246536254883, 0.03465557098388672, 1.820939064025879, 3.0613040924072266, 1.4951534271240234, 0.7394075393676758, 1.1687898635864258, 0.18093585968017578, 0.824254035949707, 0.4619159698486328, 0.7643604278564453, 0.3206310272216797, 1.1884765625, 1.5501298904418945, 0.4455595016479492, 0.27784252166748047, 2.125455856323242, 2.000187873840332, 0.958094596862793, 2.162569046020508], "mean_td_error": 1.0486987829208374, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 862.0, "diff_num_grad_updates_vs_sampler_policy": 861.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064669609069824, "actor_loss": -13.24825668334961, "critic_loss": 0.10495246201753616, "alpha_loss": -2.601238250732422, "alpha_value": 0.7722457647323608, "log_alpha_value": -0.2584524154663086, "target_entropy": -6.0, "policy_t": 0.013499145396053791, "mean_q": 10.12020206451416, "max_q": 10.37531852722168, "min_q": 9.725227355957031}, "td_error": [2.3521032333374023, 1.400303840637207, 1.08746337890625, 1.2490005493164062, 1.0472321510314941, 0.9154806137084961, 0.9523568153381348, 1.8700647354125977, 0.40253686904907227, 0.9437637329101562, 1.3149333000183105, 1.8100061416625977, 0.5903277397155762, 1.0872106552124023, 1.0170469284057617, 1.279630184173584, 1.349268913269043, 2.207551956176758, 1.407266616821289, 0.8621664047241211, 0.4073338508605957, 0.5455770492553711, 1.1695747375488281, 0.3264122009277344, 1.3427433967590332, 1.035390853881836, 1.5396671295166016, 0.4546346664428711, 1.4430251121520996, 1.7178311347961426, 1.4908323287963867, 0.9424076080322266, 1.5909719467163086, 0.4900236129760742, 0.43896007537841797, 0.3413705825805664, 2.797611713409424, 1.0622186660766602, 0.39281463623046875, 0.16829347610473633, 2.0438485145568848, 2.030792236328125, 0.8788895606994629, 1.6788454055786133, 1.3157873153686523, 0.6476473808288574, 0.13227319717407227, 0.5258326530456543, 0.8448238372802734, 0.9527864456176758, 0.27662086486816406, 0.9595928192138672, 0.38823604583740234, 1.1036982536315918, 0.9443597793579102, 0.9707694053649902, 1.0999507904052734, 1.2482199668884277, 1.4272642135620117, 1.4127817153930664, 0.666717529296875, 1.6173357963562012, 0.5484514236450195, 0.6887898445129395, 0.3536972999572754, 1.057558536529541, 0.9891777038574219, 1.1283373832702637, 0.7408676147460938, 0.6154012680053711, 0.7727394104003906, 0.5402889251708984, 0.23650264739990234, 3.0222291946411133, 0.9661722183227539, 0.971433162689209, 1.596205234527588, 2.748671054840088, 1.860264778137207, 0.6529045104980469, 0.14583778381347656, 1.9085354804992676, 1.5268235206604004, 1.2625250816345215, 0.47203588485717773, 0.31572771072387695], "mean_td_error": 1.0829262733459473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 862.0, "diff_num_grad_updates_vs_sampler_policy": 861.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.072087287902832, "actor_loss": -12.869186401367188, "critic_loss": 0.1600971519947052, "alpha_loss": -2.603217840194702, "alpha_value": 0.7722409963607788, "log_alpha_value": -0.25845861434936523, "target_entropy": -6.0, "policy_t": -0.0018547468353062868, "mean_q": 9.740310668945312, "max_q": 10.080289840698242, "min_q": 9.397930145263672}, "td_error": [0.9255905151367188, 0.9331517219543457, 0.997413158416748, 2.590505599975586, 1.6629090309143066, 0.7559690475463867, 0.35744762420654297, 0.602025032043457, 0.3062925338745117, 0.3004765510559082, 0.8036766052246094, 1.4511818885803223, 2.642294406890869, 3.372255325317383, 0.7210931777954102, 1.0680627822875977, 2.499812602996826, 0.25550031661987305, 0.26621341705322266, 0.197052001953125, 0.1026458740234375, 2.3659772872924805, 1.6078715324401855, 2.2844996452331543, 1.150156021118164, 0.5651044845581055, 1.4319276809692383, 1.0201492309570312, 0.12732553482055664, 1.2354803085327148, 0.9513802528381348, 0.25438499450683594, 2.628056526184082, 1.0477294921875, 0.23607826232910156, 1.1374316215515137, 0.4658632278442383, 1.485121250152588, 1.1683158874511719, 1.5638375282287598, 0.3794822692871094, 0.14880132675170898, 0.7046656608581543, 0.08975744247436523, 0.6211504936218262, 2.2519478797912598, 0.843320369720459, 0.9005327224731445, 1.2143688201904297, 2.180696964263916, 1.1400413513183594, 2.8580589294433594, 1.219193458557129, 2.215728759765625, 0.03069925308227539, 0.5007181167602539, 0.6148500442504883, 2.4084630012512207, 2.2877397537231445, 0.8808422088623047, 0.1173391342163086, 1.473597526550293, 0.3270411491394043, 0.8492364883422852, 0.8842449188232422, 0.49689579010009766, 0.2038106918334961, 1.2283849716186523, 1.0758061408996582, 2.611419200897217, 1.4568309783935547, 0.28818655014038086, 0.4432792663574219, 1.594090461730957, 1.6120572090148926, 3.3192214965820312, 1.6074371337890625, 0.47839832305908203, 0.7118096351623535, 0.1058645248413086, 0.7599906921386719, 1.498941421508789, 0.8810601234436035, 0.7987604141235352, 1.6775908470153809, 1.6901445388793945], "mean_td_error": 1.1304739713668823, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 862.0, "diff_num_grad_updates_vs_sampler_policy": 861.0}}, "num_env_steps_sampled": 7532, "num_env_steps_trained": 222396, "num_agent_steps_sampled": 22596, "num_agent_steps_trained": 222396, "last_target_update_ts": 7532, "num_target_updates": 862}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22596, "num_agent_steps_trained": 222396, "num_env_steps_sampled": 7532, "num_env_steps_trained": 222396, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.61953904441616, "num_env_steps_trained_throughput_per_sec": 2455.405867637053, "timesteps_total": 7532, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 22596, "timers": {"training_iteration_time_ms": 105.189, "sample_time_ms": 17.281, "load_time_ms": 0.314, "load_throughput": 822037.703, "learn_time_ms": 17.749, "learn_throughput": 14536.109, "synch_weights_time_ms": 10.582}, "counters": {"num_env_steps_sampled": 7532, "num_env_steps_trained": 222396, "num_agent_steps_sampled": 22596, "num_agent_steps_trained": 222396, "last_target_update_ts": 7532, "num_target_updates": 862}, "done": false, "episodes_total": 0, "training_iteration": 61, "trial_id": "db258_00000", "date": "2023-11-16_21-49-41", "timestamp": 1700200181, "time_this_iter_s": 1.5846490859985352, "time_total_s": 94.70117783546448, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0636a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 94.70117783546448, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 41.4, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131566047668457, "actor_loss": -19.62838363647461, "critic_loss": 0.09742294251918793, "alpha_loss": -2.663861036300659, "alpha_value": 0.7687981128692627, "log_alpha_value": -0.2629268765449524, "target_entropy": -6.0, "policy_t": 0.01264769397675991, "mean_q": 16.52714729309082, "max_q": 17.082637786865234, "min_q": 16.209339141845703}, "td_error": [1.9245185852050781, 1.2934808731079102, 0.519989013671875, 0.693455696105957, 1.4572429656982422, 0.08270645141601562, 1.0636701583862305, 2.2023019790649414, 0.7582998275756836, 1.0004081726074219, 1.1842336654663086, 0.20568466186523438, 1.0660762786865234, 0.1851205825805664, 0.6303043365478516, 0.5642433166503906, 1.583669662475586, 0.1914205551147461, 1.2943344116210938, 1.0488786697387695, 1.3403120040893555, 1.4050207138061523, 1.4638872146606445, 0.5792551040649414, 0.8149967193603516, 1.3230400085449219, 1.1939220428466797, 0.9743833541870117, 0.39374446868896484, 0.5797929763793945, 1.7109127044677734, 0.5019397735595703, 1.4662961959838867, 2.2735347747802734, 2.201030731201172, 1.434554100036621, 2.207402229309082, 0.5008811950683594, 1.314291000366211, 2.0890254974365234, 0.762843132019043, 0.2928047180175781, 1.7397260665893555, 0.47396087646484375, 1.149653434753418, 0.5274868011474609, 2.2125673294067383, 0.8607816696166992, 1.984999656677246, 0.779444694519043, 0.5335273742675781, 0.7619667053222656, 0.9681558609008789, 0.8499965667724609, 2.7400083541870117, 2.244251251220703, 2.5037689208984375, 0.43926334381103516, 1.5899686813354492, 0.6239986419677734, 0.1120615005493164, 0.06414413452148438, 1.0705060958862305, 1.2683067321777344, 2.108757972717285, 1.3438653945922852, 1.2218408584594727, 1.3795576095581055, 0.43229103088378906, 1.2655649185180664, 1.3113946914672852, 1.274322509765625, 2.4091949462890625, 1.2000322341918945, 1.2115669250488281, 1.3117446899414062, 0.6166658401489258, 1.2498464584350586, 1.0661382675170898, 0.5223255157470703, 0.9188203811645508, 1.2569961547851562, 0.17267227172851562, 0.1316375732421875, 0.18425750732421875, 0.6161670684814453], "mean_td_error": 1.0985827445983887, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 877.0, "diff_num_grad_updates_vs_sampler_policy": 876.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094003677368164, "actor_loss": -13.294739723205566, "critic_loss": 0.09940053522586823, "alpha_loss": -2.654278516769409, "alpha_value": 0.7687757611274719, "log_alpha_value": -0.2629559338092804, "target_entropy": -6.0, "policy_t": -0.020833086222410202, "mean_q": 10.173541069030762, "max_q": 10.504266738891602, "min_q": 9.764239311218262}, "td_error": [2.1527581214904785, 0.2867145538330078, 0.16709613800048828, 0.6708455085754395, 0.15006589889526367, 0.32033443450927734, 2.7033190727233887, 0.7693009376525879, 0.594329833984375, 0.5660233497619629, 0.29520702362060547, 1.6744747161865234, 0.9617514610290527, 2.516781806945801, 0.47935914993286133, 1.161890983581543, 1.5579261779785156, 1.7080044746398926, 0.2733774185180664, 0.9310975074768066, 1.327805519104004, 1.6011009216308594, 0.09015130996704102, 1.059741497039795, 1.5036001205444336, 0.11017894744873047, 1.1710147857666016, 0.23033809661865234, 1.0482754707336426, 0.7541861534118652, 0.7412519454956055, 0.47929811477661133, 0.6989889144897461, 1.1164274215698242, 1.1518092155456543, 0.6429181098937988, 0.336700439453125, 0.905975341796875, 2.264936923980713, 0.8240823745727539, 1.1354212760925293, 1.1317076683044434, 0.8825740814208984, 1.3837251663208008, 1.0813088417053223, 0.6418552398681641, 0.3876338005065918, 1.4254755973815918, 1.1960859298706055, 0.8311233520507812, 0.5474424362182617, 3.1147470474243164, 0.8619570732116699, 0.8646140098571777, 0.9738788604736328, 2.1032843589782715, 0.4111142158508301, 2.107619285583496, 0.8417758941650391, 0.42185497283935547, 0.10274410247802734, 1.4279966354370117, 0.4543776512145996, 0.5340070724487305, 0.8676037788391113, 1.8996973037719727, 3.4493536949157715, 0.30722713470458984, 0.8680934906005859, 1.6132831573486328, 1.2860918045043945, 0.6405229568481445, 0.6829924583435059, 1.0968151092529297, 1.6531758308410645, 1.133927822113037, 0.3721952438354492, 1.4116296768188477, 0.5229711532592773, 1.6456971168518066, 0.6039085388183594, 1.5251884460449219, 1.8027315139770508, 1.223222255706787, 0.7689900398254395, 1.3135666847229004], "mean_td_error": 1.0413098335266113, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 877.0, "diff_num_grad_updates_vs_sampler_policy": 876.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.104680061340332, "actor_loss": -13.298955917358398, "critic_loss": 0.1392883062362671, "alpha_loss": -2.657158136367798, "alpha_value": 0.7687702775001526, "log_alpha_value": -0.26296311616897583, "target_entropy": -6.0, "policy_t": 0.029002903029322624, "mean_q": 10.166596412658691, "max_q": 10.500722885131836, "min_q": 9.975685119628906}, "td_error": [0.5906119346618652, 0.21428442001342773, 1.6975374221801758, 0.8907308578491211, 1.0125994682312012, 1.6024861335754395, 0.6231927871704102, 1.060835361480713, 0.8707365989685059, 0.8239846229553223, 0.35622739791870117, 0.7579050064086914, 0.36484670639038086, 1.2338242530822754, 1.5174732208251953, 2.3281774520874023, 1.2772254943847656, 0.8277158737182617, 0.09474039077758789, 1.0756359100341797, 1.2581658363342285, 0.29316091537475586, 0.6547470092773438, 1.272557258605957, 0.7706022262573242, 0.37181663513183594, 3.57025146484375, 0.08971214294433594, 0.17761707305908203, 2.694652557373047, 1.0249309539794922, 1.957437515258789, 0.46123456954956055, 0.6070003509521484, 1.0445098876953125, 1.2711892127990723, 1.391122817993164, 1.3898210525512695, 0.39669179916381836, 1.665013313293457, 3.2367849349975586, 2.7084197998046875, 0.7668552398681641, 0.06716108322143555, 2.0350770950317383, 1.707775592803955, 0.9924235343933105, 2.042109489440918, 0.25456809997558594, 1.8442153930664062, 0.5398898124694824, 2.841308116912842, 0.5500974655151367, 0.4280581474304199, 0.4284520149230957, 0.9089479446411133, 1.6682839393615723, 1.3553800582885742, 0.8661322593688965, 0.8463449478149414, 0.6594619750976562, 0.902008056640625, 0.0073337554931640625, 1.643174171447754, 1.1918034553527832, 0.9700756072998047, 0.9885563850402832, 0.5433273315429688, 0.3152952194213867, 2.3725690841674805, 1.5957746505737305, 0.7797870635986328, 0.6840434074401855, 1.0958127975463867, 0.6504678726196289, 0.8410286903381348, 0.7424287796020508, 0.3488917350769043, 1.0993547439575195, 1.4616403579711914, 1.416154384613037, 0.5831141471862793, 1.155454158782959, 0.3590121269226074, 0.9093608856201172, 0.3172764778137207], "mean_td_error": 1.0616801977157593, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 877.0, "diff_num_grad_updates_vs_sampler_policy": 876.0}}, "num_env_steps_sampled": 7637, "num_env_steps_trained": 226266, "num_agent_steps_sampled": 22911, "num_agent_steps_trained": 226266, "last_target_update_ts": 7637, "num_target_updates": 877}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22911, "num_agent_steps_trained": 226266, "num_env_steps_sampled": 7637, "num_env_steps_trained": 226266, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.56362549508748, "num_env_steps_trained_throughput_per_sec": 2453.3450539617957, "timesteps_total": 7637, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 22911, "timers": {"training_iteration_time_ms": 105.619, "sample_time_ms": 17.287, "load_time_ms": 0.313, "load_throughput": 823163.268, "learn_time_ms": 17.851, "learn_throughput": 14453.169, "synch_weights_time_ms": 11.02}, "counters": {"num_env_steps_sampled": 7637, "num_env_steps_trained": 226266, "num_agent_steps_sampled": 22911, "num_agent_steps_trained": 226266, "last_target_update_ts": 7637, "num_target_updates": 877}, "done": false, "episodes_total": 0, "training_iteration": 62, "trial_id": "db258_00000", "date": "2023-11-16_21-49-43", "timestamp": 1700200183, "time_this_iter_s": 1.586256980895996, "time_total_s": 96.28743481636047, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062f20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 96.28743481636047, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 42.833333333333336, "ram_util_percent": 62.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083440780639648, "actor_loss": -19.820613861083984, "critic_loss": 0.09714184701442719, "alpha_loss": -2.6967365741729736, "alpha_value": 0.7653346657752991, "log_alpha_value": -0.26744210720062256, "target_entropy": -6.0, "policy_t": 0.016167733818292618, "mean_q": 16.7855224609375, "max_q": 17.413633346557617, "min_q": 16.244976043701172}, "td_error": [1.0221385955810547, 1.214080810546875, 0.5326995849609375, 0.8709249496459961, 1.0926990509033203, 0.9709196090698242, 0.5938005447387695, 0.9495010375976562, 1.704345703125, 1.5108051300048828, 0.20495319366455078, 0.44380855560302734, 1.1356525421142578, 1.6634140014648438, 1.4184913635253906, 0.07166671752929688, 1.3072261810302734, 0.3798637390136719, 0.5976285934448242, 1.9525718688964844, 0.7249288558959961, 1.5092439651489258, 0.16773509979248047, 1.6711196899414062, 1.3560104370117188, 0.9756183624267578, 2.452463150024414, 0.6483640670776367, 0.9793004989624023, 1.5884103775024414, 1.390829086303711, 0.8920259475708008, 1.6592140197753906, 0.831298828125, 1.0870838165283203, 0.15306663513183594, 1.9271135330200195, 1.6943473815917969, 2.311504364013672, 1.764510154724121, 0.2142467498779297, 0.1688985824584961, 1.7260570526123047, 0.5071849822998047, 1.107966423034668, 1.110616683959961, 2.440403938293457, 1.833160400390625, 0.34359073638916016, 0.20943164825439453, 1.092778205871582, 0.8640193939208984, 1.1729316711425781, 1.1221332550048828, 0.6309413909912109, 0.6983413696289062, 0.12650394439697266, 1.4088335037231445, 0.3429718017578125, 1.2380380630493164, 0.7847709655761719, 0.9431219100952148, 1.358541488647461, 1.523900032043457, 0.9282035827636719, 1.2894039154052734, 0.09263896942138672, 2.291841506958008, 1.1969470977783203, 1.1427345275878906, 2.1370887756347656, 0.2364177703857422, 0.9618568420410156, 0.5566959381103516, 1.3003978729248047, 0.22730064392089844, 1.0642900466918945, 1.1448450088500977, 0.9180164337158203, 1.678053855895996, 0.19746017456054688, 1.3746414184570312, 2.9413652420043945, 1.5412235260009766, 1.4129924774169922, 0.4752082824707031], "mean_td_error": 1.0872138738632202, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 892.0, "diff_num_grad_updates_vs_sampler_policy": 891.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083235740661621, "actor_loss": -13.24426555633545, "critic_loss": 0.11895817518234253, "alpha_loss": -2.6968510150909424, "alpha_value": 0.7653217911720276, "log_alpha_value": -0.26745885610580444, "target_entropy": -6.0, "policy_t": -0.003462034510448575, "mean_q": 10.164999008178711, "max_q": 10.623331069946289, "min_q": 9.834835052490234}, "td_error": [0.09225177764892578, 0.9431619644165039, 2.0231637954711914, 2.457411766052246, 2.9045042991638184, 0.6904191970825195, 0.8455843925476074, 1.2287540435791016, 0.6385207176208496, 0.11014890670776367, 1.5243420600891113, 0.3189525604248047, 2.0296096801757812, 1.5322813987731934, 0.46025800704956055, 0.8968019485473633, 1.745028018951416, 0.5574178695678711, 1.2319040298461914, 1.0662798881530762, 0.34007978439331055, 1.8742609024047852, 1.6952323913574219, 0.18903160095214844, 1.551762580871582, 0.5993227958679199, 0.9086318016052246, 1.1517648696899414, 0.9360756874084473, 0.7553310394287109, 0.41698312759399414, 0.2461528778076172, 0.5403389930725098, 1.6474003791809082, 1.3911323547363281, 0.9101214408874512, 0.8507413864135742, 1.2625923156738281, 2.870298385620117, 1.7370710372924805, 2.120652675628662, 2.130763530731201, 0.018274784088134766, 0.7454319000244141, 1.0227298736572266, 0.3525686264038086, 1.4862027168273926, 0.6247320175170898, 1.837885856628418, 0.20086336135864258, 2.32185697555542, 1.5461597442626953, 0.9611635208129883, 0.4626731872558594, 0.8337345123291016, 1.4042673110961914, 2.986105442047119, 2.651935577392578, 1.3039145469665527, 0.8449487686157227, 1.4523506164550781, 0.37409067153930664, 1.1950836181640625, 1.8082504272460938, 0.8427181243896484, 1.6489038467407227, 0.472994327545166, 1.5658211708068848, 1.147791862487793, 0.15025615692138672, 0.6649312973022461, 0.8178482055664062, 2.6643733978271484, 1.425994873046875, 1.0103883743286133, 0.5944728851318359, 2.2170610427856445, 1.8674592971801758, 1.364959716796875, 0.5824050903320312, 1.9012656211853027, 1.0821638107299805, 0.9545936584472656, 1.3228721618652344, 1.9376964569091797, 0.5236420631408691], "mean_td_error": 1.1932368278503418, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 892.0, "diff_num_grad_updates_vs_sampler_policy": 891.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090086936950684, "actor_loss": -13.423185348510742, "critic_loss": 0.13696369528770447, "alpha_loss": -2.698758602142334, "alpha_value": 0.7653161287307739, "log_alpha_value": -0.26746630668640137, "target_entropy": -6.0, "policy_t": -0.022506114095449448, "mean_q": 10.31076431274414, "max_q": 10.761669158935547, "min_q": 10.058576583862305}, "td_error": [0.2973752021789551, 1.4556307792663574, 1.918227195739746, 1.0695672035217285, 0.6460580825805664, 0.15081548690795898, 0.18821430206298828, 0.5555620193481445, 0.44767045974731445, 0.19292116165161133, 2.2529563903808594, 1.0862789154052734, 1.2147488594055176, 1.2142815589904785, 3.052661418914795, 0.8331913948059082, 0.9056434631347656, 2.159698486328125, 0.8693785667419434, 1.568164348602295, 0.3777332305908203, 1.6641263961791992, 0.19999933242797852, 1.2626733779907227, 0.977757453918457, 0.5277919769287109, 1.4471182823181152, 0.2871837615966797, 0.8903264999389648, 2.820805549621582, 0.2687101364135742, 0.9715509414672852, 0.782689094543457, 0.7898635864257812, 0.9692473411560059, 1.6530699729919434, 0.7220907211303711, 0.8978443145751953, 1.142866611480713, 1.6098432540893555, 1.9292535781860352, 0.9610943794250488, 0.6904163360595703, 2.4890003204345703, 1.1617059707641602, 1.5552148818969727, 1.6594724655151367, 0.8278994560241699, 0.3817014694213867, 0.8845338821411133, 0.9743657112121582, 0.587122917175293, 1.1109380722045898, 1.9636530876159668, 0.5702195167541504, 1.311819076538086, 0.9860749244689941, 1.0397272109985352, 0.3998603820800781, 0.8626575469970703, 0.039255619049072266, 0.06510686874389648, 1.0128178596496582, 0.6306571960449219, 2.4764223098754883, 0.7690529823303223, 0.20090150833129883, 1.004690170288086, 0.48314476013183594, 2.1144237518310547, 0.8692364692687988, 1.6572976112365723, 0.39873170852661133, 0.9845609664916992, 0.35784912109375, 0.903841495513916, 0.9451994895935059, 0.8913025856018066, 0.19080448150634766, 1.067967414855957, 2.42360258102417, 2.227199077606201, 0.1329350471496582, 1.329932689666748, 1.1970443725585938, 0.7944679260253906], "mean_td_error": 1.044854760169983, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 892.0, "diff_num_grad_updates_vs_sampler_policy": 891.0}}, "num_env_steps_sampled": 7742, "num_env_steps_trained": 230136, "num_agent_steps_sampled": 23226, "num_agent_steps_trained": 230136, "last_target_update_ts": 7742, "num_target_updates": 892}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23226, "num_agent_steps_trained": 230136, "num_env_steps_sampled": 7742, "num_env_steps_trained": 230136, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.82809503222975, "num_env_steps_trained_throughput_per_sec": 2499.949788330754, "timesteps_total": 7742, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 23226, "timers": {"training_iteration_time_ms": 103.877, "sample_time_ms": 15.209, "load_time_ms": 0.315, "load_throughput": 820292.929, "learn_time_ms": 18.265, "learn_throughput": 14125.48, "synch_weights_time_ms": 10.424}, "counters": {"num_env_steps_sampled": 7742, "num_env_steps_trained": 230136, "num_agent_steps_sampled": 23226, "num_agent_steps_trained": 230136, "last_target_update_ts": 7742, "num_target_updates": 892}, "done": false, "episodes_total": 0, "training_iteration": 63, "trial_id": "db258_00000", "date": "2023-11-16_21-49-45", "timestamp": 1700200185, "time_this_iter_s": 1.5572409629821777, "time_total_s": 97.84467577934265, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0620c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 97.84467577934265, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.150000000000006, "ram_util_percent": 62.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.120561599731445, "actor_loss": -19.929645538330078, "critic_loss": 0.09677988290786743, "alpha_loss": -2.752349853515625, "alpha_value": 0.7618876099586487, "log_alpha_value": -0.2719562351703644, "target_entropy": -6.0, "policy_t": 0.028708819299936295, "mean_q": 16.886863708496094, "max_q": 17.396743774414062, "min_q": 16.42146873474121}, "td_error": [0.3278388977050781, 2.452615737915039, 0.5173721313476562, 2.288201332092285, 0.9362983703613281, 1.0437860488891602, 1.672307014465332, 1.0354194641113281, 0.7316007614135742, 0.31358909606933594, 0.2910890579223633, 0.7936210632324219, 0.8721609115600586, 2.507444381713867, 1.013162612915039, 1.887343406677246, 0.12061595916748047, 3.0626678466796875, 0.15912342071533203, 1.944570541381836, 0.020017623901367188, 1.6387643814086914, 1.7079439163208008, 0.41596221923828125, 0.5956230163574219, 0.8222837448120117, 1.3707427978515625, 0.5164499282836914, 0.6532020568847656, 1.2075586318969727, 0.20516490936279297, 1.9337377548217773, 1.4929351806640625, 2.0030832290649414, 0.6300764083862305, 1.396500587463379, 0.9733982086181641, 2.672739028930664, 0.7306289672851562, 0.5855522155761719, 0.42693328857421875, 0.8826417922973633, 3.145298957824707, 0.6400938034057617, 1.2890386581420898, 1.1455421447753906, 0.08907890319824219, 0.8425350189208984, 2.0003089904785156, 2.3128910064697266, 0.34519386291503906, 0.8209743499755859, 0.22509193420410156, 0.8984260559082031, 1.3044681549072266, 1.6858453750610352, 0.3451957702636719, 0.4295330047607422, 0.1784191131591797, 0.36389827728271484, 1.4684371948242188, 1.9682579040527344, 1.365189552307129, 1.3639297485351562, 1.618133544921875, 0.6803646087646484, 0.311370849609375, 1.122323989868164, 1.8774843215942383, 0.29882240295410156, 0.8483476638793945, 0.7765035629272461, 1.8265724182128906, 0.8321361541748047, 1.737412452697754, 0.9523162841796875, 1.0331478118896484, 0.5062227249145508, 2.2920284271240234, 0.7179279327392578, 1.3730621337890625, 0.2965688705444336, 0.8672752380371094, 1.357935905456543, 0.5168952941894531, 0.9558076858520508], "mean_td_error": 1.0916171073913574, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 907.0, "diff_num_grad_updates_vs_sampler_policy": 906.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.016173362731934, "actor_loss": -13.315723419189453, "critic_loss": 0.09738396108150482, "alpha_loss": -2.724043369293213, "alpha_value": 0.7618812918663025, "log_alpha_value": -0.27196449041366577, "target_entropy": -6.0, "policy_t": -0.019194073975086212, "mean_q": 10.281333923339844, "max_q": 10.49329948425293, "min_q": 9.965885162353516}, "td_error": [0.5638575553894043, 0.23324203491210938, 1.0942354202270508, 0.8579044342041016, 0.3206205368041992, 0.5598421096801758, 0.5446386337280273, 0.06306171417236328, 1.001999855041504, 0.5993647575378418, 1.493215560913086, 1.9989891052246094, 0.8248214721679688, 1.1478972434997559, 0.20411205291748047, 0.39044713973999023, 0.9001221656799316, 1.2692813873291016, 2.9022669792175293, 1.13618803024292, 1.0215387344360352, 0.8636507987976074, 1.9467582702636719, 0.543118953704834, 0.19820833206176758, 1.3360276222229004, 2.2736334800720215, 0.7420744895935059, 1.8725495338439941, 1.276510238647461, 1.1135501861572266, 0.6238279342651367, 1.2533831596374512, 0.15215110778808594, 0.901547908782959, 1.5422859191894531, 0.27306604385375977, 1.053318977355957, 2.537777900695801, 0.4777989387512207, 1.4943609237670898, 1.4078035354614258, 0.459531307220459, 1.1739988327026367, 0.6339216232299805, 1.397219181060791, 0.14037036895751953, 2.1125645637512207, 1.030503273010254, 0.4817495346069336, 1.0744409561157227, 0.9404006004333496, 2.004197120666504, 1.1662650108337402, 1.532444953918457, 1.511319637298584, 1.4497036933898926, 0.4845719337463379, 0.5209064483642578, 2.119762420654297, 1.5906038284301758, 0.7393884658813477, 0.7082080841064453, 1.9522390365600586, 0.8884553909301758, 0.7318987846374512, 0.12332820892333984, 2.049048900604248, 0.522362232208252, 0.35593605041503906, 2.4861645698547363, 0.1816563606262207, 0.9280605316162109, 1.6095738410949707, 1.9583702087402344, 0.1575307846069336, 1.377366542816162, 0.33286046981811523, 0.7622818946838379, 0.055140018463134766, 0.5551161766052246, 1.0761356353759766, 0.5420365333557129, 1.1550073623657227, 1.6161036491394043, 0.5831494331359863], "mean_td_error": 1.0265460014343262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 907.0, "diff_num_grad_updates_vs_sampler_policy": 906.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108671188354492, "actor_loss": -13.589517593383789, "critic_loss": 0.12867102026939392, "alpha_loss": -2.7492125034332275, "alpha_value": 0.7618803381919861, "log_alpha_value": -0.27196574211120605, "target_entropy": -6.0, "policy_t": 0.020228056237101555, "mean_q": 10.496281623840332, "max_q": 10.757232666015625, "min_q": 10.206907272338867}, "td_error": [0.4981570243835449, 0.44637298583984375, 1.2510170936584473, 0.4442563056945801, 1.2429399490356445, 0.6432380676269531, 0.5943307876586914, 1.7321419715881348, 1.6494698524475098, 0.7226481437683105, 1.302598476409912, 0.9152593612670898, 0.8960542678833008, 1.0588655471801758, 0.14644718170166016, 1.124995231628418, 0.5921430587768555, 1.613400936126709, 0.019498348236083984, 1.1950631141662598, 0.886995792388916, 1.3748235702514648, 1.0309538841247559, 1.2772817611694336, 0.1273937225341797, 1.3321995735168457, 1.4359102249145508, 1.9025816917419434, 0.5193490982055664, 1.2660622596740723, 1.0642061233520508, 1.6236610412597656, 0.3329501152038574, 0.9345898628234863, 0.2277522087097168, 0.5710229873657227, 0.09912443161010742, 0.6108999252319336, 2.0092878341674805, 0.4400005340576172, 2.249823570251465, 2.320807456970215, 1.1717991828918457, 0.1050577163696289, 1.0781769752502441, 0.27645015716552734, 0.674217700958252, 0.39450836181640625, 1.2178435325622559, 0.5572423934936523, 1.5377988815307617, 1.9146380424499512, 0.6568074226379395, 1.7475600242614746, 1.6458024978637695, 1.9830780029296875, 0.5032191276550293, 1.6536359786987305, 0.838874340057373, 1.3498125076293945, 1.5485496520996094, 0.8361597061157227, 0.2582130432128906, 0.24674272537231445, 2.1667284965515137, 0.6481199264526367, 1.1091866493225098, 0.2020411491394043, 1.3282690048217773, 0.23040771484375, 1.1014714241027832, 0.4907045364379883, 0.38654136657714844, 1.8211650848388672, 0.15239953994750977, 1.2693123817443848, 1.69366455078125, 0.6165771484375, 0.9652023315429688, 0.7705578804016113, 1.3929924964904785, 1.5250630378723145, 0.2927665710449219, 0.5585651397705078, 1.3721380233764648, 1.0320701599121094], "mean_td_error": 0.9889384508132935, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 907.0, "diff_num_grad_updates_vs_sampler_policy": 906.0}}, "num_env_steps_sampled": 7847, "num_env_steps_trained": 234006, "num_agent_steps_sampled": 23541, "num_agent_steps_trained": 234006, "last_target_update_ts": 7847, "num_target_updates": 907}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23541, "num_agent_steps_trained": 234006, "num_env_steps_sampled": 7847, "num_env_steps_trained": 234006, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.43166257980106, "num_env_steps_trained_throughput_per_sec": 2485.338420798382, "timesteps_total": 7847, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 23541, "timers": {"training_iteration_time_ms": 103.943, "sample_time_ms": 15.663, "load_time_ms": 0.31, "load_throughput": 833048.831, "learn_time_ms": 17.985, "learn_throughput": 14344.918, "synch_weights_time_ms": 10.238}, "counters": {"num_env_steps_sampled": 7847, "num_env_steps_trained": 234006, "num_agent_steps_sampled": 23541, "num_agent_steps_trained": 234006, "last_target_update_ts": 7847, "num_target_updates": 907}, "done": false, "episodes_total": 0, "training_iteration": 64, "trial_id": "db258_00000", "date": "2023-11-16_21-49-46", "timestamp": 1700200186, "time_this_iter_s": 1.5651819705963135, "time_total_s": 99.40985774993896, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0609a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 99.40985774993896, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.85, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095998764038086, "actor_loss": -20.097814559936523, "critic_loss": 0.1139574646949768, "alpha_loss": -2.7912890911102295, "alpha_value": 0.7584527134895325, "log_alpha_value": -0.27647483348846436, "target_entropy": -6.0, "policy_t": 0.028347857296466827, "mean_q": 17.04918098449707, "max_q": 17.69891929626465, "min_q": 16.697811126708984}, "td_error": [0.9762964248657227, 1.8662471771240234, 1.1354093551635742, 0.24699020385742188, 1.2316360473632812, 0.9843778610229492, 1.0617446899414062, 1.0787115097045898, 0.5283403396606445, 0.07059478759765625, 2.616121292114258, 0.3193798065185547, 0.37352561950683594, 2.0966758728027344, 1.4933176040649414, 0.973750114440918, 1.7820711135864258, 0.9487991333007812, 0.40199851989746094, 1.6906185150146484, 1.193094253540039, 0.7080116271972656, 1.5380611419677734, 1.2313356399536133, 1.754368782043457, 0.6895074844360352, 1.6012887954711914, 2.1143274307250977, 0.2693061828613281, 0.9009742736816406, 1.623300552368164, 1.106903076171875, 1.2654085159301758, 0.47484588623046875, 1.7295913696289062, 0.937352180480957, 0.6733922958374023, 0.45154571533203125, 2.654611587524414, 1.0122737884521484, 1.5657644271850586, 1.8924713134765625, 2.01937198638916, 1.7019929885864258, 2.329782485961914, 1.9180946350097656, 0.019901275634765625, 2.3170394897460938, 0.25641727447509766, 0.15201377868652344, 1.0600461959838867, 1.4009685516357422, 2.8404903411865234, 0.4477081298828125, 2.325497627258301, 1.3203191757202148, 1.2775869369506836, 1.0967369079589844, 1.525899887084961, 0.9569587707519531, 1.040999412536621, 0.4281044006347656, 1.1715011596679688, 0.25038909912109375, 0.8790559768676758, 0.8001079559326172, 0.33589839935302734, 0.6899242401123047, 1.4945907592773438, 0.783635139465332, 2.967954635620117, 0.6477079391479492, 0.44266510009765625, 2.065762519836426, 0.34398651123046875, 2.247279167175293, 0.28549957275390625, 1.1543359756469727, 0.728877067565918, 1.4346504211425781, 2.0057907104492188, 2.871720314025879, 0.537388801574707, 1.4577617645263672, 2.500088691711426, 1.1671485900878906], "mean_td_error": 1.220511555671692, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 922.0, "diff_num_grad_updates_vs_sampler_policy": 921.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10562515258789, "actor_loss": -13.5997314453125, "critic_loss": 0.09663592278957367, "alpha_loss": -2.7938714027404785, "alpha_value": 0.75845867395401, "log_alpha_value": -0.2764669358730316, "target_entropy": -6.0, "policy_t": 0.01807120442390442, "mean_q": 10.517714500427246, "max_q": 10.883323669433594, "min_q": 10.204505920410156}, "td_error": [0.7829618453979492, 0.5068359375, 2.004725933074951, 0.9606270790100098, 0.3455171585083008, 0.700171947479248, 0.5925145149230957, 0.3416152000427246, 0.7744522094726562, 0.8584508895874023, 0.9609808921813965, 2.1956701278686523, 0.4930872917175293, 0.45903635025024414, 0.9734797477722168, 1.440535545349121, 0.7751069068908691, 1.1108894348144531, 0.36629629135131836, 1.0708460807800293, 0.3411593437194824, 0.06186866760253906, 1.520005226135254, 0.0031862258911132812, 0.9836506843566895, 1.547490119934082, 1.890723705291748, 1.3575377464294434, 1.2496581077575684, 1.476487636566162, 0.9813246726989746, 0.745488166809082, 0.807741641998291, 0.7606830596923828, 2.4698996543884277, 0.6702008247375488, 2.0831289291381836, 1.9147744178771973, 0.3012509346008301, 1.743058204650879, 0.6575946807861328, 1.038743019104004, 1.2296710014343262, 0.28827571868896484, 0.46201324462890625, 0.8296990394592285, 1.1650667190551758, 2.163939952850342, 0.7607207298278809, 0.7852039337158203, 1.3408584594726562, 0.2656216621398926, 1.4631047248840332, 0.49128198623657227, 0.08511924743652344, 1.322981834411621, 1.2719335556030273, 0.927884578704834, 1.3680105209350586, 0.7806639671325684, 0.724151611328125, 3.1343350410461426, 1.0363011360168457, 0.5400819778442383, 0.5147261619567871, 0.012852668762207031, 0.5842876434326172, 0.05952739715576172, 0.7236366271972656, 1.4436554908752441, 2.1521363258361816, 1.6989588737487793, 1.4299168586730957, 1.3408870697021484, 0.5694317817687988, 1.039168357849121, 0.844672679901123, 0.5740242004394531, 0.3145570755004883, 1.805419921875, 2.6920385360717773, 0.41441965103149414, 0.7482776641845703, 0.7791900634765625, 2.7455830574035645, 0.22439193725585938], "mean_td_error": 1.0170714855194092, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 922.0, "diff_num_grad_updates_vs_sampler_policy": 921.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.078493118286133, "actor_loss": -13.548162460327148, "critic_loss": 0.15143786370754242, "alpha_loss": -2.7864065170288086, "alpha_value": 0.7584559321403503, "log_alpha_value": -0.2764705419540405, "target_entropy": -6.0, "policy_t": -0.020744360983371735, "mean_q": 10.497159004211426, "max_q": 10.924210548400879, "min_q": 10.25811767578125}, "td_error": [1.605271339416504, 1.6818699836730957, 0.2777700424194336, 1.0416374206542969, 2.008716583251953, 0.5585722923278809, 1.205948829650879, 0.9749002456665039, 1.8164548873901367, 0.21816635131835938, 1.0481524467468262, 0.03888416290283203, 0.3306598663330078, 0.15393829345703125, 0.1592082977294922, 0.7699270248413086, 1.4365520477294922, 1.0986027717590332, 1.0371136665344238, 0.43746471405029297, 1.094059944152832, 1.8564362525939941, 0.5735979080200195, 0.5444793701171875, 1.298337459564209, 0.5742073059082031, 0.9160280227661133, 0.4665665626525879, 1.686938762664795, 0.027185916900634766, 0.21258831024169922, 1.5898008346557617, 0.48441219329833984, 1.794966220855713, 2.2103919982910156, 1.339406967163086, 1.3909940719604492, 0.9186692237854004, 0.6752901077270508, 1.3329553604125977, 0.2840290069580078, 0.20637989044189453, 1.3143491744995117, 1.4457383155822754, 1.1678481101989746, 1.477034568786621, 2.1897659301757812, 0.36406612396240234, 0.9401512145996094, 1.0492439270019531, 2.2661080360412598, 0.6481752395629883, 2.5656166076660156, 0.501774787902832, 0.5473694801330566, 1.4294953346252441, 1.4921112060546875, 0.7399530410766602, 1.1902494430541992, 0.3658027648925781, 2.936338424682617, 0.48622894287109375, 1.582984447479248, 0.993535041809082, 1.3941383361816406, 0.8516268730163574, 0.05200529098510742, 1.8548688888549805, 1.3002700805664062, 1.2024421691894531, 1.2784719467163086, 1.1780986785888672, 1.0862679481506348, 1.7008728981018066, 2.123502731323242, 1.5826687812805176, 0.4250478744506836, 1.9869842529296875, 0.504981517791748, 2.1056394577026367, 0.9581456184387207, 0.39928388595581055, 0.19657135009765625, 2.513761520385742, 1.7659907341003418, 1.9266643524169922], "mean_td_error": 1.1099973917007446, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 922.0, "diff_num_grad_updates_vs_sampler_policy": 921.0}}, "num_env_steps_sampled": 7952, "num_env_steps_trained": 237876, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 237876, "last_target_update_ts": 7952, "num_target_updates": 922}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 237876, "num_env_steps_sampled": 7952, "num_env_steps_trained": 237876, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 61.683679793626695, "num_env_steps_trained_throughput_per_sec": 2273.4841981079553, "timesteps_total": 7952, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 119.187, "sample_time_ms": 15.271, "load_time_ms": 0.314, "load_throughput": 820355.115, "learn_time_ms": 18.06, "learn_throughput": 14285.475, "synch_weights_time_ms": 10.231}, "counters": {"num_env_steps_sampled": 7952, "num_env_steps_trained": 237876, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 237876, "last_target_update_ts": 7952, "num_target_updates": 922}, "done": false, "episodes_total": 0, "training_iteration": 65, "trial_id": "db258_00000", "date": "2023-11-16_21-49-48", "timestamp": 1700200188, "time_this_iter_s": 1.7122538089752197, "time_total_s": 101.12211155891418, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e114040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 101.12211155891418, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.966666666666665, "ram_util_percent": 62.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.154021263122559, "actor_loss": -20.419509887695312, "critic_loss": 0.09198442101478577, "alpha_loss": -2.8531899452209473, "alpha_value": 0.7550349831581116, "log_alpha_value": -0.28099116683006287, "target_entropy": -6.0, "policy_t": 0.014810250140726566, "mean_q": 17.352638244628906, "max_q": 17.918411254882812, "min_q": 16.95254135131836}, "td_error": [1.3986845016479492, 2.256185531616211, 0.4111976623535156, 0.09912490844726562, 0.17541885375976562, 0.6041984558105469, 1.1289854049682617, 0.8223857879638672, 1.400217056274414, 1.498565673828125, 0.8695211410522461, 2.2100887298583984, 1.2001380920410156, 0.8571767807006836, 0.8298263549804688, 0.8078031539916992, 1.574915885925293, 0.8479318618774414, 1.361588478088379, 0.9978704452514648, 0.1958141326904297, 1.3051538467407227, 1.3161983489990234, 0.4110565185546875, 0.3449716567993164, 1.1200227737426758, 0.18461227416992188, 0.8474578857421875, 1.286062240600586, 0.7743749618530273, 1.5247993469238281, 1.4164676666259766, 0.48682403564453125, 0.9023122787475586, 0.9298133850097656, 1.030827522277832, 0.7020473480224609, 1.6737089157104492, 1.1121807098388672, 1.8422794342041016, 0.5736618041992188, 1.7493352890014648, 1.9009084701538086, 0.1889181137084961, 0.17365264892578125, 1.372262954711914, 1.2988367080688477, 0.4342365264892578, 1.5702800750732422, 0.14885711669921875, 1.404245376586914, 1.5860538482666016, 1.819070816040039, 0.9069576263427734, 0.7023019790649414, 0.47337913513183594, 1.569375991821289, 0.18156051635742188, 1.9453611373901367, 1.4324188232421875, 0.3801116943359375, 0.5856513977050781, 0.4129180908203125, 1.0967655181884766, 0.6373052597045898, 0.42108917236328125, 1.1719436645507812, 1.7988929748535156, 1.4955596923828125, 0.3108539581298828, 2.515080451965332, 1.3642282485961914, 0.7365932464599609, 0.8947029113769531, 1.6676158905029297, 1.6797561645507812, 1.2614631652832031, 0.3710174560546875, 0.4128284454345703, 1.5955276489257812, 0.9671649932861328, 0.36149024963378906, 0.8664646148681641, 1.9266719818115234, 2.081462860107422, 1.1331672668457031], "mean_td_error": 1.050428032875061, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 937.0, "diff_num_grad_updates_vs_sampler_policy": 936.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101576805114746, "actor_loss": -13.53928279876709, "critic_loss": 0.11947593092918396, "alpha_loss": -2.838245391845703, "alpha_value": 0.7550505995750427, "log_alpha_value": -0.2809705436229706, "target_entropy": -6.0, "policy_t": 0.024991998448967934, "mean_q": 10.48717212677002, "max_q": 10.880650520324707, "min_q": 10.14671516418457}, "td_error": [1.5753283500671387, 0.7199206352233887, 1.0920414924621582, 1.1726226806640625, 2.449430465698242, 0.05113029479980469, 1.4427824020385742, 1.7602148056030273, 0.7632055282592773, 0.7237157821655273, 0.4472508430480957, 1.3382534980773926, 0.5829977989196777, 1.6170177459716797, 1.6269679069519043, 1.0386505126953125, 1.3859148025512695, 0.6985511779785156, 1.079643726348877, 1.1945295333862305, 0.4004511833190918, 0.9747176170349121, 0.6232233047485352, 0.6804847717285156, 1.4780006408691406, 0.6445417404174805, 0.8571968078613281, 1.6121702194213867, 1.4180445671081543, 0.5878458023071289, 1.2470073699951172, 0.6153779029846191, 2.6237378120422363, 1.229764461517334, 0.9621462821960449, 2.917337417602539, 0.654447078704834, 1.4280853271484375, 1.6947073936462402, 1.37943696975708, 0.8356566429138184, 0.13292169570922852, 1.3223700523376465, 0.2517409324645996, 1.3021750450134277, 1.0559444427490234, 0.6291961669921875, 0.750007152557373, 1.7930030822753906, 1.5788421630859375, 1.1612358093261719, 1.8628020286560059, 2.0562615394592285, 0.38327980041503906, 1.0033860206604004, 0.982947826385498, 0.6887702941894531, 1.3126754760742188, 1.1223669052124023, 1.4878616333007812, 1.2924866676330566, 1.6937503814697266, 0.9731388092041016, 0.5432643890380859, 1.2296781539916992, 0.8896713256835938, 2.3449935913085938, 1.7363858222961426, 1.28068208694458, 1.658646583557129, 1.215837001800537, 1.9336051940917969, 0.867668628692627, 1.4472260475158691, 0.3937978744506836, 0.9947042465209961, 1.3353490829467773, 0.041507720947265625, 2.392212390899658, 1.5053653717041016, 0.8446478843688965, 1.252662181854248, 2.654391288757324, 0.175750732421875, 2.0945358276367188, 1.229027271270752], "mean_td_error": 1.1921316385269165, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 937.0, "diff_num_grad_updates_vs_sampler_policy": 936.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116467475891113, "actor_loss": -13.697494506835938, "critic_loss": 0.1461111456155777, "alpha_loss": -2.8424489498138428, "alpha_value": 0.7550491094589233, "log_alpha_value": -0.2809724807739258, "target_entropy": -6.0, "policy_t": 0.009082947857677937, "mean_q": 10.6294527053833, "max_q": 11.035266876220703, "min_q": 10.246919631958008}, "td_error": [1.8210859298706055, 0.8033699989318848, 0.6880607604980469, 1.2808666229248047, 1.9620585441589355, 0.4481334686279297, 1.2343497276306152, 1.8518128395080566, 0.9846868515014648, 1.1345505714416504, 0.8222451210021973, 0.9183182716369629, 1.5846552848815918, 1.5449795722961426, 0.9926176071166992, 1.7298917770385742, 1.0971760749816895, 1.8685870170593262, 0.09618759155273438, 0.7223029136657715, 1.3523139953613281, 2.022648334503174, 0.6682004928588867, 1.6429085731506348, 0.892941951751709, 0.2894611358642578, 0.7416315078735352, 0.8458347320556641, 0.40963029861450195, 0.06383180618286133, 0.9451828002929688, 1.4843268394470215, 1.3174772262573242, 0.8756508827209473, 1.6773271560668945, 0.7132339477539062, 1.2739572525024414, 0.36791133880615234, 2.230835437774658, 1.3755760192871094, 1.1842293739318848, 0.8592839241027832, 0.30704784393310547, 1.2351784706115723, 2.1591796875, 1.4022517204284668, 0.2021484375, 0.5632915496826172, 0.590947151184082, 0.5098972320556641, 2.5484256744384766, 0.9703149795532227, 2.150864601135254, 0.5736541748046875, 1.4630632400512695, 2.252608299255371, 0.5840377807617188, 0.8811683654785156, 0.9492135047912598, 1.4237093925476074, 1.3181524276733398, 0.8065104484558105, 0.3604450225830078, 0.709498405456543, 0.7007598876953125, 0.7453551292419434, 0.38885927200317383, 0.828707218170166, 2.085357189178467, 1.0462684631347656, 1.0243144035339355, 0.8331618309020996, 2.413797378540039, 1.0548920631408691, 0.46127891540527344, 0.9042730331420898, 1.8329339027404785, 1.1482024192810059, 1.6913833618164062, 0.9658384323120117, 0.8816046714782715, 0.5430440902709961, 0.8144040107727051, 0.43158817291259766, 0.7597932815551758, 1.6989693641662598], "mean_td_error": 1.0934501886367798, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 937.0, "diff_num_grad_updates_vs_sampler_policy": 936.0}}, "num_env_steps_sampled": 8057, "num_env_steps_trained": 241746, "num_agent_steps_sampled": 24171, "num_agent_steps_trained": 241746, "last_target_update_ts": 8057, "num_target_updates": 937}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24171, "num_agent_steps_trained": 241746, "num_env_steps_sampled": 8057, "num_env_steps_trained": 241746, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.36896724160006, "num_env_steps_trained_throughput_per_sec": 2483.027649761831, "timesteps_total": 8057, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 24171, "timers": {"training_iteration_time_ms": 104.369, "sample_time_ms": 15.709, "load_time_ms": 0.312, "load_throughput": 825927.669, "learn_time_ms": 18.226, "learn_throughput": 14155.303, "synch_weights_time_ms": 10.024}, "counters": {"num_env_steps_sampled": 8057, "num_env_steps_trained": 241746, "num_agent_steps_sampled": 24171, "num_agent_steps_trained": 241746, "last_target_update_ts": 8057, "num_target_updates": 937}, "done": false, "episodes_total": 0, "training_iteration": 66, "trial_id": "db258_00000", "date": "2023-11-16_21-49-50", "timestamp": 1700200190, "time_this_iter_s": 1.5671260356903076, "time_total_s": 102.68923759460449, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 102.68923759460449, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.25, "ram_util_percent": 63.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.174384117126465, "actor_loss": -20.68091583251953, "critic_loss": 0.08934464305639267, "alpha_loss": -2.904881477355957, "alpha_value": 0.7516313195228577, "log_alpha_value": -0.285509318113327, "target_entropy": -6.0, "policy_t": -0.037123940885066986, "mean_q": 17.67872428894043, "max_q": 18.194564819335938, "min_q": 17.23233985900879}, "td_error": [1.5669631958007812, 1.7067975997924805, 0.2577991485595703, 1.115457534790039, 0.540400505065918, 1.2950677871704102, 0.3683738708496094, 1.0575218200683594, 1.1508026123046875, 0.4300413131713867, 0.4715604782104492, 1.519235610961914, 0.7955684661865234, 1.1515865325927734, 1.9007453918457031, 0.6399402618408203, 1.5712652206420898, 2.0259323120117188, 1.462686538696289, 0.42173290252685547, 0.18413543701171875, 1.79156494140625, 1.1867361068725586, 2.5833473205566406, 1.4632930755615234, 0.4238548278808594, 0.6065311431884766, 0.7474908828735352, 1.131108283996582, 1.1798152923583984, 1.3858747482299805, 1.1920366287231445, 1.149200439453125, 0.08164024353027344, 1.6934633255004883, 1.041773796081543, 0.3871316909790039, 0.09288978576660156, 1.2901887893676758, 0.1963672637939453, 1.2389764785766602, 0.2958707809448242, 1.2671546936035156, 0.7521724700927734, 1.5111656188964844, 1.9531831741333008, 1.356241226196289, 2.3503551483154297, 0.27466392517089844, 0.5400686264038086, 0.686640739440918, 2.2168779373168945, 0.6346225738525391, 0.11354637145996094, 0.33048343658447266, 0.7536993026733398, 0.7332725524902344, 0.3466663360595703, 1.6478090286254883, 1.6353645324707031, 0.5519886016845703, 0.3179454803466797, 0.4926567077636719, 0.5064382553100586, 1.5974102020263672, 0.9622249603271484, 0.9961757659912109, 1.35565185546875, 2.341838836669922, 1.4352130889892578, 0.5117549896240234, 2.356888771057129, 0.26438331604003906, 0.0691995620727539, 1.0882492065429688, 0.0857696533203125, 0.4619407653808594, 1.7448196411132812, 0.9872531890869141, 1.022871971130371, 1.2473573684692383, 0.9751644134521484, 1.4422016143798828, 0.5766239166259766, 0.7551345825195312, 1.3784847259521484], "mean_td_error": 1.0165395736694336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 952.0, "diff_num_grad_updates_vs_sampler_policy": 951.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082526206970215, "actor_loss": -13.643322944641113, "critic_loss": 0.12054207921028137, "alpha_loss": -2.878291368484497, "alpha_value": 0.7516584396362305, "log_alpha_value": -0.2854732573032379, "target_entropy": -6.0, "policy_t": 0.024691229686141014, "mean_q": 10.617471694946289, "max_q": 11.017269134521484, "min_q": 10.110456466674805}, "td_error": [0.5720219612121582, 1.3942480087280273, 1.1631994247436523, 1.0593972206115723, 1.404618263244629, 2.225377082824707, 1.3198156356811523, 2.7659597396850586, 1.4681577682495117, 0.90606689453125, 0.9220247268676758, 0.9899129867553711, 0.21119022369384766, 1.5155749320983887, 1.0985565185546875, 2.6785683631896973, 1.6784696578979492, 1.0098843574523926, 0.5841183662414551, 1.9539051055908203, 1.3693938255310059, 1.438718318939209, 1.449704647064209, 0.5608806610107422, 1.1768083572387695, 2.7164368629455566, 0.6043720245361328, 1.4141631126403809, 0.7509160041809082, 1.8993587493896484, 1.8691377639770508, 0.7003364562988281, 0.6948013305664062, 1.758206844329834, 1.3017544746398926, 1.5651674270629883, 1.1747450828552246, 1.9493951797485352, 1.6038503646850586, 1.4495491981506348, 0.6383705139160156, 1.0392169952392578, 1.315171241760254, 1.782541275024414, 1.255418300628662, 1.771500587463379, 0.7670116424560547, 0.6185979843139648, 0.5659570693969727, 1.361558437347412, 0.3553624153137207, 1.6932058334350586, 1.3820223808288574, 1.6632003784179688, 0.933967113494873, 0.7028961181640625, 0.5852079391479492, 1.2130894660949707, 1.2968392372131348, 1.0643572807312012, 1.134265422821045, 2.853011131286621, 0.691469669342041, 0.47591543197631836, 0.6801409721374512, 0.4714622497558594, 1.2889127731323242, 0.5315237045288086, 0.8442273139953613, 1.037400245666504, 1.2518467903137207, 0.479034423828125, 0.5371437072753906, 1.6425766944885254, 2.836268901824951, 1.1499629020690918, 0.8632969856262207, 0.5182218551635742, 0.5584821701049805, 0.4739665985107422, 1.6731781959533691, 0.8564696311950684, 0.67950439453125, 1.7967596054077148, 0.0779271125793457, 0.7475700378417969], "mean_td_error": 1.1921488046646118, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 952.0, "diff_num_grad_updates_vs_sampler_policy": 951.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113089561462402, "actor_loss": -13.751008987426758, "critic_loss": 0.1592692732810974, "alpha_loss": -2.887047052383423, "alpha_value": 0.751656174659729, "log_alpha_value": -0.2854762375354767, "target_entropy": -6.0, "policy_t": 0.0342724546790123, "mean_q": 10.74271011352539, "max_q": 11.244043350219727, "min_q": 10.489294052124023}, "td_error": [1.2791991233825684, 1.6624374389648438, 1.8881454467773438, 1.1417412757873535, 0.7237095832824707, 0.621457576751709, 0.4787874221801758, 0.7403526306152344, 0.055088043212890625, 1.4447050094604492, 0.997838020324707, 2.019700050354004, 1.9891576766967773, 0.22716522216796875, 0.6133174896240234, 1.1717095375061035, 0.037906646728515625, 1.397130012512207, 0.1147012710571289, 1.284914493560791, 1.6483983993530273, 2.180959701538086, 1.0332369804382324, 2.494791030883789, 0.07744407653808594, 0.05382966995239258, 1.1157493591308594, 1.083533763885498, 1.1699237823486328, 2.1504106521606445, 1.4543442726135254, 1.4712705612182617, 1.6684670448303223, 0.5203752517700195, 1.076730728149414, 1.3859529495239258, 3.923431396484375, 0.2196211814880371, 1.2420148849487305, 2.858971118927002, 1.0691008567810059, 1.518972396850586, 1.0828194618225098, 1.3817811012268066, 0.9267597198486328, 0.6013507843017578, 1.6267428398132324, 0.8017826080322266, 1.4350180625915527, 1.4397902488708496, 0.5618805885314941, 0.725400447845459, 2.8808703422546387, 0.8349709510803223, 1.043480396270752, 3.319528102874756, 0.9996547698974609, 0.944582462310791, 0.6077895164489746, 1.5655083656311035, 1.1412887573242188, 0.8546876907348633, 0.1327681541442871, 0.6038608551025391, 1.2900276184082031, 1.078458309173584, 0.1729884147644043, 0.7777523994445801, 1.1322593688964844, 0.560248851776123, 1.3144245147705078, 0.4645242691040039, 0.3565635681152344, 0.20810747146606445, 1.7610974311828613, 2.5181427001953125, 1.4857101440429688, 1.0655927658081055, 0.6986637115478516, 1.0082683563232422, 1.230544090270996, 1.3039984703063965, 0.45600366592407227, 0.4190502166748047, 0.5211405754089355, 0.8710517883300781], "mean_td_error": 1.1338794231414795, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 952.0, "diff_num_grad_updates_vs_sampler_policy": 951.0}}, "num_env_steps_sampled": 8162, "num_env_steps_trained": 245616, "num_agent_steps_sampled": 24486, "num_agent_steps_trained": 245616, "last_target_update_ts": 8162, "num_target_updates": 952}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24486, "num_agent_steps_trained": 245616, "num_env_steps_sampled": 8162, "num_env_steps_trained": 245616, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.89644675694913, "num_env_steps_trained_throughput_per_sec": 2465.6118947561254, "timesteps_total": 8162, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 24486, "timers": {"training_iteration_time_ms": 104.379, "sample_time_ms": 16.142, "load_time_ms": 0.315, "load_throughput": 819299.237, "learn_time_ms": 18.129, "learn_throughput": 14231.368, "synch_weights_time_ms": 9.926}, "counters": {"num_env_steps_sampled": 8162, "num_env_steps_trained": 245616, "num_agent_steps_sampled": 24486, "num_agent_steps_trained": 245616, "last_target_update_ts": 8162, "num_target_updates": 952}, "done": false, "episodes_total": 0, "training_iteration": 67, "trial_id": "db258_00000", "date": "2023-11-16_21-49-51", "timestamp": 1700200191, "time_this_iter_s": 1.5779907703399658, "time_total_s": 104.26722836494446, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0609a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 104.26722836494446, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 63.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06631088256836, "actor_loss": -20.669160842895508, "critic_loss": 0.08970733731985092, "alpha_loss": -2.919484853744507, "alpha_value": 0.7482446432113647, "log_alpha_value": -0.2900253236293793, "target_entropy": -6.0, "policy_t": 0.04714459180831909, "mean_q": 17.732254028320312, "max_q": 18.26150894165039, "min_q": 17.303634643554688}, "td_error": [0.4168109893798828, 0.8111476898193359, 0.6331548690795898, 1.5268259048461914, 2.107121467590332, 0.21922683715820312, 0.34172916412353516, 1.31689453125, 1.4930343627929688, 0.062058448791503906, 0.6460294723510742, 1.7706527709960938, 1.7030448913574219, 1.995737075805664, 2.065349578857422, 1.7248954772949219, 1.2078990936279297, 0.7620306015014648, 1.2780990600585938, 1.0085124969482422, 1.1360788345336914, 0.3038511276245117, 0.9234676361083984, 0.7088737487792969, 0.3067169189453125, 0.7119016647338867, 1.275472640991211, 0.32557201385498047, 0.4468860626220703, 0.5114936828613281, 0.823028564453125, 1.805135726928711, 0.4013242721557617, 0.3122100830078125, 1.648188591003418, 0.6428194046020508, 0.10768890380859375, 1.5993032455444336, 0.7243423461914062, 0.5472202301025391, 0.5001983642578125, 1.7643318176269531, 0.3343801498413086, 2.282626152038574, 1.5844755172729492, 2.3535709381103516, 0.9144954681396484, 0.8580036163330078, 0.5872440338134766, 0.5770320892333984, 0.13935470581054688, 0.4373025894165039, 2.6086559295654297, 0.06228160858154297, 0.8001594543457031, 0.7975988388061523, 0.0873250961303711, 0.5141811370849609, 1.442840576171875, 0.7976398468017578, 1.1716079711914062, 0.138885498046875, 0.5962362289428711, 1.156595230102539, 0.6530475616455078, 2.9027252197265625, 1.8327836990356445, 0.6766386032104492, 1.2493419647216797, 0.20372295379638672, 2.679060935974121, 0.19926738739013672, 1.9462108612060547, 0.5388708114624023, 2.2806901931762695, 0.9726343154907227, 0.31864070892333984, 2.355854034423828, 1.0312824249267578, 1.5393085479736328, 0.3542146682739258, 1.2500905990600586, 1.1036052703857422, 0.9744415283203125, 1.0321674346923828, 1.7146129608154297], "mean_td_error": 1.0310240983963013, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 967.0, "diff_num_grad_updates_vs_sampler_policy": 966.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10586166381836, "actor_loss": -13.860269546508789, "critic_loss": 0.10798996686935425, "alpha_loss": -2.930510997772217, "alpha_value": 0.7482775449752808, "log_alpha_value": -0.28998130559921265, "target_entropy": -6.0, "policy_t": -0.0495465062558651, "mean_q": 10.796916961669922, "max_q": 11.086223602294922, "min_q": 10.305543899536133}, "td_error": [2.381610870361328, 1.4057021141052246, 1.4847912788391113, 0.7058196067810059, 0.5282368659973145, 2.089838981628418, 2.089193344116211, 1.3218622207641602, 1.2260375022888184, 1.1941895484924316, 1.3805017471313477, 1.9867534637451172, 1.0306816101074219, 0.5912394523620605, 1.2214927673339844, 0.7805051803588867, 0.21717071533203125, 0.3943791389465332, 1.1908111572265625, 1.9310956001281738, 0.3906521797180176, 0.742192268371582, 0.8078689575195312, 1.3624200820922852, 0.272430419921875, 1.4722480773925781, 0.2194204330444336, 0.9407687187194824, 1.1651344299316406, 0.44861507415771484, 0.20328140258789062, 1.5642461776733398, 2.18699312210083, 0.9631304740905762, 1.324944019317627, 0.11147308349609375, 0.41282129287719727, 0.10639572143554688, 2.0092825889587402, 0.5729799270629883, 0.17938470840454102, 0.19194412231445312, 0.0851125717163086, 0.38451576232910156, 1.6637439727783203, 0.9392447471618652, 1.206193447113037, 1.8269519805908203, 1.5284080505371094, 1.2530202865600586, 0.8611955642700195, 0.38261985778808594, 1.4258527755737305, 1.4749135971069336, 0.48385143280029297, 1.2198429107666016, 2.758051872253418, 2.277282238006592, 2.490128517150879, 0.31052541732788086, 0.760953426361084, 0.24863147735595703, 1.6932415962219238, 0.09032154083251953, 1.8985772132873535, 0.47550296783447266, 1.8567891120910645, 1.4193944931030273, 1.1356940269470215, 1.7990717887878418, 0.1242518424987793, 2.1448583602905273, 0.6579217910766602, 1.0921096801757812, 0.1123189926147461, 1.5116186141967773, 2.0213212966918945, 1.1669840812683105, 2.2908568382263184, 1.431786060333252, 1.0348610877990723, 0.43038082122802734, 0.49471473693847656, 0.2146930694580078, 1.7512273788452148, 0.7623014450073242], "mean_td_error": 1.0929346084594727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 967.0, "diff_num_grad_updates_vs_sampler_policy": 966.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.091118812561035, "actor_loss": -13.969141960144043, "critic_loss": 0.16512271761894226, "alpha_loss": -2.9262616634368896, "alpha_value": 0.748275637626648, "log_alpha_value": -0.2899838387966156, "target_entropy": -6.0, "policy_t": 0.0037753337528556585, "mean_q": 10.94626522064209, "max_q": 11.284305572509766, "min_q": 10.541760444641113}, "td_error": [1.2446880340576172, 0.06789398193359375, 0.5990209579467773, 1.7315545082092285, 1.2981867790222168, 0.9987688064575195, 2.3099074363708496, 1.6760802268981934, 0.9391965866088867, 0.6235036849975586, 0.8311491012573242, 1.1629858016967773, 0.7741928100585938, 2.2035083770751953, 2.008485794067383, 1.6602649688720703, 0.756803035736084, 3.3620553016662598, 0.9128570556640625, 1.3810105323791504, 0.6062140464782715, 0.6013669967651367, 0.9955348968505859, 0.8439550399780273, 0.6122903823852539, 1.3044214248657227, 0.4679231643676758, 1.1226682662963867, 0.30567026138305664, 1.3070478439331055, 0.95184326171875, 1.199014663696289, 1.2114505767822266, 1.9275450706481934, 1.4274230003356934, 0.8627109527587891, 0.1726827621459961, 1.0661063194274902, 0.29280757904052734, 1.7312774658203125, 0.04100847244262695, 1.3076820373535156, 0.6280117034912109, 2.2192225456237793, 1.1230058670043945, 2.2624783515930176, 0.8845071792602539, 3.000253200531006, 0.24738407135009766, 1.1412715911865234, 1.4287638664245605, 0.8933591842651367, 0.6934728622436523, 0.42978477478027344, 1.5499467849731445, 1.7033333778381348, 0.4895143508911133, 0.8728399276733398, 0.1354060173034668, 0.8314061164855957, 1.1375737190246582, 0.7852864265441895, 1.7376389503479004, 0.6306543350219727, 1.5887393951416016, 2.6561570167541504, 2.3220553398132324, 1.0151915550231934, 0.6512665748596191, 0.029662609100341797, 0.2339935302734375, 1.069819450378418, 2.056220054626465, 2.5257930755615234, 2.297114849090576, 1.9468564987182617, 1.6181154251098633, 0.7870311737060547, 0.05702924728393555, 2.5634756088256836, 2.7764077186584473, 0.5325651168823242, 0.9803304672241211, 1.0415892601013184, 0.7497539520263672, 0.4534263610839844], "mean_td_error": 1.1823077201843262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 967.0, "diff_num_grad_updates_vs_sampler_policy": 966.0}}, "num_env_steps_sampled": 8267, "num_env_steps_trained": 249486, "num_agent_steps_sampled": 24801, "num_agent_steps_trained": 249486, "last_target_update_ts": 8267, "num_target_updates": 967}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24801, "num_agent_steps_trained": 249486, "num_env_steps_sampled": 8267, "num_env_steps_trained": 249486, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.45459634742745, "num_env_steps_trained_throughput_per_sec": 2449.3265510908977, "timesteps_total": 8267, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 24801, "timers": {"training_iteration_time_ms": 106.043, "sample_time_ms": 16.65, "load_time_ms": 0.313, "load_throughput": 825549.612, "learn_time_ms": 18.368, "learn_throughput": 14046.163, "synch_weights_time_ms": 10.178}, "counters": {"num_env_steps_sampled": 8267, "num_env_steps_trained": 249486, "num_agent_steps_sampled": 24801, "num_agent_steps_trained": 249486, "last_target_update_ts": 8267, "num_target_updates": 967}, "done": false, "episodes_total": 0, "training_iteration": 68, "trial_id": "db258_00000", "date": "2023-11-16_21-49-53", "timestamp": 1700200193, "time_this_iter_s": 1.587944746017456, "time_total_s": 105.85517311096191, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063ec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 105.85517311096191, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 63.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112959861755371, "actor_loss": -20.978557586669922, "critic_loss": 0.09298040717840195, "alpha_loss": -2.9786934852600098, "alpha_value": 0.744872510433197, "log_alpha_value": -0.2945421636104584, "target_entropy": -6.0, "policy_t": -0.04397609457373619, "mean_q": 17.965484619140625, "max_q": 18.462804794311523, "min_q": 17.58832550048828}, "td_error": [0.9134283065795898, 0.7323541641235352, 0.8081874847412109, 0.7289619445800781, 1.277541160583496, 0.675358772277832, 0.7194900512695312, 1.5485305786132812, 0.47220420837402344, 0.7758340835571289, 0.458251953125, 0.08999252319335938, 0.2938098907470703, 0.07171249389648438, 2.3906850814819336, 2.3470077514648438, 0.37154388427734375, 0.7154417037963867, 1.0465078353881836, 0.5271673202514648, 0.022902488708496094, 1.2179374694824219, 2.7836599349975586, 1.4808282852172852, 1.8508777618408203, 0.2302265167236328, 2.696512222290039, 2.1605119705200195, 0.5980405807495117, 0.2793264389038086, 1.126199722290039, 1.4841747283935547, 1.718947410583496, 1.3383636474609375, 0.7622947692871094, 2.4375038146972656, 1.2395906448364258, 1.6643524169921875, 0.1768054962158203, 0.7972202301025391, 1.2927570343017578, 0.9379072189331055, 0.046889305114746094, 1.1293773651123047, 0.8881855010986328, 0.2474822998046875, 1.430516242980957, 1.5927209854125977, 0.7169399261474609, 0.3105630874633789, 1.027634620666504, 1.2956981658935547, 0.9088535308837891, 0.9369525909423828, 0.5347957611083984, 0.38072681427001953, 0.43917274475097656, 0.46057605743408203, 1.363107681274414, 0.5007610321044922, 1.4723167419433594, 0.7391376495361328, 0.5528469085693359, 0.4139251708984375, 1.7873964309692383, 0.8301143646240234, 2.2074413299560547, 2.7772741317749023, 1.4066858291625977, 2.06050968170166, 1.2347230911254883, 1.4176826477050781, 0.8729076385498047, 1.7805252075195312, 1.240839958190918, 0.6991596221923828, 1.6446113586425781, 1.768101692199707, 0.41817188262939453, 0.6369266510009766, 1.4160957336425781, 1.0329513549804688, 0.5220918655395508, 0.6183652877807617, 0.48908519744873047, 1.5326242446899414], "mean_td_error": 1.058656096458435, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 982.0, "diff_num_grad_updates_vs_sampler_policy": 981.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00719928741455, "actor_loss": -13.90738582611084, "critic_loss": 0.10767681896686554, "alpha_loss": -2.947005271911621, "alpha_value": 0.7449125051498413, "log_alpha_value": -0.29448848962783813, "target_entropy": -6.0, "policy_t": -0.0007546220440417528, "mean_q": 10.951950073242188, "max_q": 11.257916450500488, "min_q": 10.479104995727539}, "td_error": [1.1514978408813477, 1.2725095748901367, 0.8166084289550781, 2.8431506156921387, 2.0163187980651855, 0.6596298217773438, 1.4039673805236816, 1.4817657470703125, 1.071371078491211, 0.22071361541748047, 0.0701761245727539, 1.7029924392700195, 0.6151232719421387, 3.0929737091064453, 0.7128643989562988, 1.938830852508545, 1.5764312744140625, 0.9206204414367676, 1.0909385681152344, 1.2632274627685547, 1.1313762664794922, 0.21932363510131836, 0.9866485595703125, 1.325120449066162, 0.7868871688842773, 1.160550594329834, 0.5551271438598633, 0.5610442161560059, 0.19287538528442383, 0.6032319068908691, 1.8814802169799805, 1.3551549911499023, 0.3892402648925781, 1.0272941589355469, 1.3125648498535156, 1.863067626953125, 2.0397233963012695, 0.011563777923583984, 2.417377471923828, 1.6710996627807617, 0.3739604949951172, 1.4076018333435059, 1.411210060119629, 2.2918500900268555, 0.4817991256713867, 1.777153491973877, 1.8800320625305176, 0.5523605346679688, 0.8697175979614258, 1.6587324142456055, 0.41954898834228516, 1.7209572792053223, 1.9375286102294922, 1.0023622512817383, 2.0225915908813477, 1.26129150390625, 0.12161493301391602, 0.4360818862915039, 0.9824166297912598, 0.12387657165527344, 1.552361011505127, 0.6168947219848633, 0.7846879959106445, 1.4781498908996582, 0.7615556716918945, 0.4219207763671875, 1.9315505027770996, 0.8711471557617188, 0.33009862899780273, 0.6205072402954102, 1.4701895713806152, 0.2529125213623047, 1.0338468551635742, 1.8548145294189453, 1.9650211334228516, 0.9177870750427246, 0.300997257232666, 0.28056764602661133, 0.13607025146484375, 0.7788877487182617, 0.7081847190856934, 0.8659162521362305, 0.7959494590759277, 0.6872496604919434, 1.3710227012634277, 1.0817179679870605], "mean_td_error": 1.0931994915008545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 982.0, "diff_num_grad_updates_vs_sampler_policy": 981.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.080290794372559, "actor_loss": -14.109107971191406, "critic_loss": 0.13528746366500854, "alpha_loss": -2.9685256481170654, "alpha_value": 0.7449128031730652, "log_alpha_value": -0.2944881021976471, "target_entropy": -6.0, "policy_t": 0.010531888343393803, "mean_q": 11.071540832519531, "max_q": 11.504749298095703, "min_q": 10.819459915161133}, "td_error": [1.885183334350586, 0.7259573936462402, 0.749176025390625, 0.9571447372436523, 1.3605809211730957, 1.608419418334961, 1.8283429145812988, 0.526557445526123, 0.7831649780273438, 2.063858985900879, 0.8012943267822266, 0.7463469505310059, 1.824638843536377, 1.3054194450378418, 0.22739553451538086, 0.30240345001220703, 1.345231056213379, 1.134674072265625, 1.7845172882080078, 2.1706666946411133, 0.6204314231872559, 0.6899914741516113, 0.28466796875, 0.17716026306152344, 0.2028369903564453, 0.43804311752319336, 1.349778175354004, 0.8242006301879883, 1.7516388893127441, 0.7159590721130371, 0.2086944580078125, 0.4986848831176758, 1.3460783958435059, 1.0184988975524902, 0.10193252563476562, 1.5149879455566406, 1.3318729400634766, 0.7086796760559082, 2.2114439010620117, 0.06123638153076172, 1.1437253952026367, 0.6197257041931152, 1.2441434860229492, 2.375131607055664, 1.3496427536010742, 1.197770118713379, 0.18166637420654297, 0.7617330551147461, 0.13211679458618164, 0.06927824020385742, 1.088714599609375, 0.3286895751953125, 1.3072295188903809, 0.3539571762084961, 2.4392857551574707, 0.5829272270202637, 1.2243900299072266, 1.1190214157104492, 0.6415581703186035, 2.0559425354003906, 0.5045862197875977, 0.07556772232055664, 1.2008023262023926, 1.4920635223388672, 0.40711450576782227, 2.1139636039733887, 1.1589374542236328, 0.8917326927185059, 0.5442242622375488, 0.9422578811645508, 1.282017707824707, 0.7183589935302734, 0.5696010589599609, 2.6880435943603516, 0.025421619415283203, 1.2266111373901367, 1.5522708892822266, 1.5869359970092773, 0.36808156967163086, 0.8218727111816406, 0.4735102653503418, 0.6918697357177734, 2.2822771072387695, 0.7782340049743652, 0.670494556427002, 1.5269813537597656], "mean_td_error": 1.0116078853607178, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 982.0, "diff_num_grad_updates_vs_sampler_policy": 981.0}}, "num_env_steps_sampled": 8372, "num_env_steps_trained": 253356, "num_agent_steps_sampled": 25116, "num_agent_steps_trained": 253356, "last_target_update_ts": 8372, "num_target_updates": 982}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25116, "num_agent_steps_trained": 253356, "num_env_steps_sampled": 8372, "num_env_steps_trained": 253356, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.51272641537346, "num_env_steps_trained_throughput_per_sec": 2488.326202166622, "timesteps_total": 8372, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 25116, "timers": {"training_iteration_time_ms": 103.964, "sample_time_ms": 15.725, "load_time_ms": 0.31, "load_throughput": 832984.706, "learn_time_ms": 18.263, "learn_throughput": 14126.771, "synch_weights_time_ms": 9.729}, "counters": {"num_env_steps_sampled": 8372, "num_env_steps_trained": 253356, "num_agent_steps_sampled": 25116, "num_agent_steps_trained": 253356, "last_target_update_ts": 8372, "num_target_updates": 982}, "done": false, "episodes_total": 0, "training_iteration": 69, "trial_id": "db258_00000", "date": "2023-11-16_21-49-54", "timestamp": 1700200194, "time_this_iter_s": 1.5626630783081055, "time_total_s": 107.41783618927002, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 107.41783618927002, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.950000000000003, "ram_util_percent": 62.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112906455993652, "actor_loss": -21.25338363647461, "critic_loss": 0.09477198123931885, "alpha_loss": -3.0244088172912598, "alpha_value": 0.7415117621421814, "log_alpha_value": -0.2990642488002777, "target_entropy": -6.0, "policy_t": -0.06128082424402237, "mean_q": 18.298625946044922, "max_q": 18.786081314086914, "min_q": 17.848848342895508}, "td_error": [0.5657367706298828, 1.0704879760742188, 0.7440214157104492, 0.7178306579589844, 1.5151681900024414, 0.9249448776245117, 1.1970329284667969, 0.6559381484985352, 0.5823173522949219, 1.550307273864746, 0.9254980087280273, 1.393172264099121, 0.7147350311279297, 1.9004526138305664, 0.3157520294189453, 2.799288749694824, 0.23197174072265625, 1.299154281616211, 0.3839750289916992, 0.794184684753418, 1.0801544189453125, 0.48105907440185547, 2.4072952270507812, 3.0828332901000977, 2.367076873779297, 0.653935432434082, 1.2840967178344727, 0.8830509185791016, 0.17568492889404297, 0.39422035217285156, 1.5408353805541992, 1.7989215850830078, 0.3963165283203125, 0.7460422515869141, 2.298147201538086, 1.5133247375488281, 0.8829898834228516, 0.5784921646118164, 0.044152259826660156, 0.4929790496826172, 1.333388328552246, 0.29250335693359375, 1.484583854675293, 0.2804107666015625, 1.1727733612060547, 0.881129264831543, 0.9395236968994141, 1.7297592163085938, 0.36435794830322266, 1.4370079040527344, 1.177053451538086, 0.1799020767211914, 1.5090036392211914, 0.06628131866455078, 0.45082855224609375, 0.4788818359375, 2.903632164001465, 1.6152143478393555, 0.4910306930541992, 0.7228164672851562, 0.4122610092163086, 0.4103078842163086, 1.4965028762817383, 1.7365894317626953, 1.280691146850586, 1.6226186752319336, 0.4054555892944336, 1.3568601608276367, 1.6897478103637695, 0.40976619720458984, 0.4885082244873047, 1.8401527404785156, 1.0932121276855469, 1.256937026977539, 0.5851821899414062, 0.7425165176391602, 1.1988420486450195, 0.4761190414428711, 1.5339078903198242, 0.8834066390991211, 2.1193065643310547, 1.001795768737793, 2.3142547607421875, 0.1904306411743164, 1.2008581161499023, 1.9083003997802734], "mean_td_error": 1.0761417150497437, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 997.0, "diff_num_grad_updates_vs_sampler_policy": 996.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077543258666992, "actor_loss": -13.740316390991211, "critic_loss": 0.08888047933578491, "alpha_loss": -3.013129949569702, "alpha_value": 0.7415634989738464, "log_alpha_value": -0.2989944815635681, "target_entropy": -6.0, "policy_t": 0.00525349797680974, "mean_q": 10.804864883422852, "max_q": 11.028068542480469, "min_q": 10.596358299255371}, "td_error": [0.6186337471008301, 0.6487703323364258, 0.6429600715637207, 0.45128631591796875, 1.170072078704834, 1.2549214363098145, 0.6921405792236328, 1.4760956764221191, 1.7738704681396484, 1.5998029708862305, 2.2670793533325195, 0.7369012832641602, 0.803034782409668, 0.9872350692749023, 0.8784990310668945, 1.2710204124450684, 1.0197820663452148, 1.3243036270141602, 0.43956947326660156, 0.6636276245117188, 0.9282646179199219, 0.17550086975097656, 0.6171321868896484, 1.9391059875488281, 0.38124561309814453, 0.5489869117736816, 0.517432689666748, 0.9056768417358398, 1.2046527862548828, 2.683990478515625, 0.38646507263183594, 1.1074156761169434, 1.748708724975586, 0.8969316482543945, 2.1380434036254883, 1.3072943687438965, 0.5301265716552734, 1.4198932647705078, 1.2489728927612305, 1.32600736618042, 0.10175704956054688, 1.806699275970459, 0.006385326385498047, 0.6420869827270508, 1.8143668174743652, 1.203211784362793, 1.2235260009765625, 0.29164600372314453, 0.10709285736083984, 0.5452642440795898, 0.4228048324584961, 0.8055181503295898, 1.0698199272155762, 0.3189210891723633, 0.5262994766235352, 0.5954484939575195, 0.027307987213134766, 0.8447270393371582, 0.7177238464355469, 1.0080604553222656, 1.4163427352905273, 0.6607236862182617, 2.8088865280151367, 1.1612520217895508, 0.36003589630126953, 0.8529815673828125, 1.9105753898620605, 1.0987210273742676, 1.2009763717651367, 1.2271900177001953, 0.6833343505859375, 0.7068324089050293, 0.727963924407959, 1.09407377243042, 0.7034697532653809, 0.640587329864502, 0.4633188247680664, 1.7861628532409668, 0.8895878791809082, 0.7275185585021973, 1.3018321990966797, 1.0094165802001953, 0.8429327011108398, 1.123462200164795, 0.5926337242126465, 0.20815086364746094], "mean_td_error": 0.9652218222618103, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 997.0, "diff_num_grad_updates_vs_sampler_policy": 996.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10590648651123, "actor_loss": -14.315818786621094, "critic_loss": 0.13756133615970612, "alpha_loss": -3.0215532779693604, "alpha_value": 0.7415676712989807, "log_alpha_value": -0.29898884892463684, "target_entropy": -6.0, "policy_t": -0.026629691943526268, "mean_q": 11.304132461547852, "max_q": 11.583027839660645, "min_q": 11.06773567199707}, "td_error": [0.47535276412963867, 0.24007797241210938, 0.49601173400878906, 0.9192981719970703, 1.4339556694030762, 1.7498044967651367, 1.4623827934265137, 1.4798927307128906, 1.1349906921386719, 2.8824334144592285, 0.6103076934814453, 0.1103062629699707, 0.23326826095581055, 1.862515926361084, 0.32915735244750977, 1.4586782455444336, 0.3879070281982422, 0.6450252532958984, 1.5470914840698242, 0.5354385375976562, 1.314241886138916, 1.893876552581787, 0.6677045822143555, 1.4684219360351562, 1.720219612121582, 1.3808069229125977, 1.9072861671447754, 0.9488143920898438, 0.8707151412963867, 1.8210148811340332, 1.024665355682373, 0.12407207489013672, 1.5651469230651855, 0.6223659515380859, 0.26297473907470703, 0.8849086761474609, 1.3660573959350586, 1.1093363761901855, 1.2018342018127441, 1.5119786262512207, 0.9097161293029785, 1.5054569244384766, 0.9451503753662109, 2.1695823669433594, 1.1225275993347168, 0.7470321655273438, 0.6738400459289551, 0.09408330917358398, 0.3683748245239258, 1.2440004348754883, 1.1703157424926758, 0.7034530639648438, 1.130964756011963, 0.8763394355773926, 0.19799041748046875, 0.8809232711791992, 1.7713584899902344, 0.6733856201171875, 0.10428619384765625, 2.0057005882263184, 1.1018924713134766, 1.9988913536071777, 1.0642499923706055, 0.37329959869384766, 0.6847786903381348, 0.49956417083740234, 0.6097078323364258, 0.5738487243652344, 0.09140396118164062, 0.5298328399658203, 1.5318284034729004, 1.4628300666809082, 1.2149691581726074, 0.7236714363098145, 0.5360136032104492, 2.2086572647094727, 0.27698802947998047, 0.9268875122070312, 3.115683078765869, 2.087214946746826, 0.5532608032226562, 0.6568713188171387, 2.2502188682556152, 0.8497867584228516, 0.6959676742553711, 0.07595968246459961], "mean_td_error": 1.042431354522705, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 997.0, "diff_num_grad_updates_vs_sampler_policy": 996.0}}, "num_env_steps_sampled": 8477, "num_env_steps_trained": 257226, "num_agent_steps_sampled": 25431, "num_agent_steps_trained": 257226, "last_target_update_ts": 8477, "num_target_updates": 997}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25431, "num_agent_steps_trained": 257226, "num_env_steps_sampled": 8477, "num_env_steps_trained": 257226, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.87941561071787, "num_env_steps_trained_throughput_per_sec": 2501.841318223602, "timesteps_total": 8477, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 25431, "timers": {"training_iteration_time_ms": 103.631, "sample_time_ms": 16.665, "load_time_ms": 0.315, "load_throughput": 818369.834, "learn_time_ms": 17.889, "learn_throughput": 14422.31, "synch_weights_time_ms": 9.734}, "counters": {"num_env_steps_sampled": 8477, "num_env_steps_trained": 257226, "num_agent_steps_sampled": 25431, "num_agent_steps_trained": 257226, "last_target_update_ts": 8477, "num_target_updates": 997}, "done": false, "episodes_total": 0, "training_iteration": 70, "trial_id": "db258_00000", "date": "2023-11-16_21-49-56", "timestamp": 1700200196, "time_this_iter_s": 1.5558462142944336, "time_total_s": 108.97368240356445, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 108.97368240356445, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 32.45, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028443336486816, "actor_loss": -21.336946487426758, "critic_loss": 0.08853419125080109, "alpha_loss": -3.0444860458374023, "alpha_value": 0.7381671071052551, "log_alpha_value": -0.30358508229255676, "target_entropy": -6.0, "policy_t": 0.02456078492105007, "mean_q": 18.400333404541016, "max_q": 19.08074188232422, "min_q": 17.928943634033203}, "td_error": [2.311918258666992, 1.3583488464355469, 1.1099052429199219, 0.9190187454223633, 0.47514915466308594, 0.8212518692016602, 0.47728633880615234, 0.4259052276611328, 1.8713645935058594, 0.670628547668457, 0.45325469970703125, 1.5591182708740234, 0.8560276031494141, 1.745473861694336, 1.5642433166503906, 1.963719367980957, 0.20190906524658203, 1.1478204727172852, 0.6010780334472656, 0.7596845626831055, 1.5036706924438477, 2.1413955688476562, 0.877110481262207, 1.6865453720092773, 0.7981739044189453, 2.0614757537841797, 0.5672025680541992, 1.1026544570922852, 1.4738740921020508, 0.6720495223999023, 1.5898809432983398, 0.9588174819946289, 1.7042808532714844, 0.9471588134765625, 1.1588783264160156, 0.11153984069824219, 1.1683588027954102, 1.6281070709228516, 0.09296703338623047, 2.1549415588378906, 0.5252151489257812, 0.2903318405151367, 0.8138818740844727, 0.5109415054321289, 0.09448432922363281, 0.44165992736816406, 1.420095443725586, 1.8318977355957031, 0.36754417419433594, 0.28250789642333984, 1.178217887878418, 0.5688571929931641, 1.7407712936401367, 0.7545318603515625, 0.9240608215332031, 1.7198762893676758, 0.695439338684082, 0.3386421203613281, 0.22800731658935547, 1.3564605712890625, 0.4577951431274414, 0.25737857818603516, 0.5179338455200195, 1.9982585906982422, 2.7271947860717773, 1.405684471130371, 2.437480926513672, 0.894282341003418, 0.1422290802001953, 0.33456993103027344, 1.9419174194335938, 0.9666509628295898, 1.5761222839355469, 1.3766155242919922, 0.44101905822753906, 1.0296640396118164, 1.0586652755737305, 1.451822280883789, 0.22622966766357422, 0.3910694122314453, 0.1229085922241211, 1.0704536437988281, 0.3791952133178711, 0.2255382537841797, 0.709559440612793, 1.159193992614746], "mean_td_error": 1.012500524520874, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1012.0, "diff_num_grad_updates_vs_sampler_policy": 1011.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113449096679688, "actor_loss": -14.1317720413208, "critic_loss": 0.10726338624954224, "alpha_loss": -3.069443702697754, "alpha_value": 0.7382290363311768, "log_alpha_value": -0.3035011887550354, "target_entropy": -6.0, "policy_t": -0.00932705495506525, "mean_q": 11.133522033691406, "max_q": 11.513427734375, "min_q": 10.616552352905273}, "td_error": [0.7539710998535156, 0.5064291954040527, 0.4308433532714844, 1.24485445022583, 0.5874309539794922, 1.3501086235046387, 0.8241949081420898, 3.2649707794189453, 2.1491785049438477, 1.7832646369934082, 1.2092289924621582, 0.1612091064453125, 1.7949457168579102, 0.35270118713378906, 0.09794855117797852, 0.08502435684204102, 1.785630702972412, 0.3132743835449219, 0.49954700469970703, 1.2502741813659668, 1.7886905670166016, 1.9191703796386719, 0.6413354873657227, 1.6145877838134766, 1.4231491088867188, 0.5203051567077637, 1.5475239753723145, 0.7028360366821289, 0.3224353790283203, 1.647524356842041, 1.5703034400939941, 1.31119966506958, 1.5654935836791992, 2.114454746246338, 1.2944560050964355, 1.1044139862060547, 0.3813509941101074, 2.348623275756836, 0.8715238571166992, 2.0410966873168945, 0.43087244033813477, 0.9655013084411621, 0.8759665489196777, 1.1762323379516602, 0.21131229400634766, 0.8834114074707031, 0.8759946823120117, 0.7145648002624512, 0.6657238006591797, 1.2770166397094727, 1.0874323844909668, 2.6560659408569336, 0.9340066909790039, 0.6720318794250488, 0.4147930145263672, 0.9180879592895508, 0.2328052520751953, 0.9279389381408691, 1.2078742980957031, 1.594862461090088, 0.6722402572631836, 0.4354572296142578, 0.7604513168334961, 1.0151300430297852, 0.09052705764770508, 1.9962968826293945, 0.37528038024902344, 1.688765048980713, 0.9085569381713867, 0.4125027656555176, 0.6701898574829102, 0.19634485244750977, 2.197993278503418, 0.2638874053955078, 0.2677464485168457, 0.49304914474487305, 1.0025944709777832, 1.903632640838623, 1.1525588035583496, 1.1410808563232422, 1.703256607055664, 1.2482357025146484, 2.314006805419922, 0.7603468894958496, 1.2766170501708984, 2.292177200317383], "mean_td_error": 1.0829875469207764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1012.0, "diff_num_grad_updates_vs_sampler_policy": 1011.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1072416305542, "actor_loss": -14.165284156799316, "critic_loss": 0.15259374678134918, "alpha_loss": -3.0674495697021484, "alpha_value": 0.7382370829582214, "log_alpha_value": -0.3034902811050415, "target_entropy": -6.0, "policy_t": -0.011865462176501751, "mean_q": 11.165741920471191, "max_q": 11.478365898132324, "min_q": 10.806182861328125}, "td_error": [1.543224811553955, 0.8441133499145508, 0.6168947219848633, 1.3329691886901855, 1.9008779525756836, 1.199263572692871, 2.162435531616211, 0.8566412925720215, 1.3575019836425781, 1.9335522651672363, 1.031510829925537, 0.04448747634887695, 1.8484997749328613, 1.2327823638916016, 1.1912174224853516, 0.4736800193786621, 0.0983734130859375, 0.1475663185119629, 2.0506153106689453, 0.7833409309387207, 1.9407668113708496, 0.6607623100280762, 0.9384474754333496, 0.816746711730957, 1.9836101531982422, 0.14154386520385742, 1.5218753814697266, 1.4903154373168945, 1.7311067581176758, 0.6233386993408203, 0.6870570182800293, 0.49840211868286133, 1.06170654296875, 0.8249068260192871, 1.274728775024414, 1.5446815490722656, 1.1669673919677734, 2.306180953979492, 0.48539161682128906, 0.7458467483520508, 1.1349048614501953, 1.3268084526062012, 1.2448797225952148, 0.8622150421142578, 2.0592527389526367, 0.1827855110168457, 0.46593618392944336, 1.9286341667175293, 0.9025888442993164, 0.7871508598327637, 0.9119052886962891, 1.3975272178649902, 0.35511112213134766, 1.5858750343322754, 0.9438891410827637, 0.8239164352416992, 0.5054597854614258, 0.009202003479003906, 1.9010305404663086, 0.6336665153503418, 0.5955700874328613, 1.9559011459350586, 1.916952133178711, 1.7909088134765625, 0.6371641159057617, 1.3006906509399414, 3.090257167816162, 1.8151812553405762, 1.2160868644714355, 0.27977466583251953, 0.15310192108154297, 1.1523160934448242, 0.6952009201049805, 0.8330602645874023, 0.8082451820373535, 1.1013917922973633, 1.4456758499145508, 0.5055088996887207, 1.591221809387207, 2.5165843963623047, 1.1678261756896973, 0.9374866485595703, 1.5695834159851074, 0.3986639976501465, 0.1936206817626953, 1.3402681350708008], "mean_td_error": 1.117033839225769, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1012.0, "diff_num_grad_updates_vs_sampler_policy": 1011.0}}, "num_env_steps_sampled": 8582, "num_env_steps_trained": 261096, "num_agent_steps_sampled": 25746, "num_agent_steps_trained": 261096, "last_target_update_ts": 8582, "num_target_updates": 1012}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25746, "num_agent_steps_trained": 261096, "num_env_steps_sampled": 8582, "num_env_steps_trained": 261096, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.46022253811088, "num_env_steps_trained_throughput_per_sec": 2486.391059261801, "timesteps_total": 8582, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 25746, "timers": {"training_iteration_time_ms": 104.355, "sample_time_ms": 17.06, "load_time_ms": 0.31, "load_throughput": 831896.089, "learn_time_ms": 17.992, "learn_throughput": 14339.805, "synch_weights_time_ms": 10.339}, "counters": {"num_env_steps_sampled": 8582, "num_env_steps_trained": 261096, "num_agent_steps_sampled": 25746, "num_agent_steps_trained": 261096, "last_target_update_ts": 8582, "num_target_updates": 1012}, "done": false, "episodes_total": 0, "training_iteration": 71, "trial_id": "db258_00000", "date": "2023-11-16_21-49-58", "timestamp": 1700200198, "time_this_iter_s": 1.5646758079528809, "time_total_s": 110.53835821151733, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7d80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 110.53835821151733, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 33.36666666666667, "ram_util_percent": 62.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.164711952209473, "actor_loss": -21.369890213012695, "critic_loss": 0.10837693512439728, "alpha_loss": -3.1317567825317383, "alpha_value": 0.7348411679267883, "log_alpha_value": -0.3081009089946747, "target_entropy": -6.0, "policy_t": 0.015868769958615303, "mean_q": 18.372703552246094, "max_q": 18.818567276000977, "min_q": 18.023330688476562}, "td_error": [0.6817655563354492, 0.9568004608154297, 1.8119850158691406, 1.662954330444336, 0.6647415161132812, 1.4756107330322266, 1.328810691833496, 0.567234992980957, 1.916529655456543, 1.3107948303222656, 1.6577701568603516, 0.5433683395385742, 0.7014656066894531, 0.18583106994628906, 1.809992790222168, 0.7126703262329102, 1.2930097579956055, 0.9972143173217773, 1.039656639099121, 0.25156688690185547, 2.5863285064697266, 0.5536794662475586, 0.90362548828125, 0.5822439193725586, 0.34004783630371094, 1.3900928497314453, 2.392333984375, 1.0225419998168945, 1.6014232635498047, 1.3415946960449219, 2.170957565307617, 0.48288631439208984, 0.017549514770507812, 0.5389671325683594, 1.523280143737793, 1.4196062088012695, 0.9970693588256836, 0.2852210998535156, 0.1571216583251953, 0.6145610809326172, 2.1725082397460938, 1.0780696868896484, 2.008793830871582, 2.056942939758301, 2.8227834701538086, 0.4732351303100586, 1.2120933532714844, 1.4908533096313477, 2.669569969177246, 1.498605728149414, 0.14750385284423828, 0.5617160797119141, 1.8205318450927734, 1.380070686340332, 1.2287015914916992, 0.6988849639892578, 1.0741338729858398, 1.659438133239746, 2.6425905227661133, 0.8393774032592773, 0.17299461364746094, 1.4304113388061523, 0.7386455535888672, 1.2612857818603516, 1.1143436431884766, 0.4611625671386719, 0.25780391693115234, 0.9628133773803711, 2.3509645462036133, 1.6968488693237305, 1.0660953521728516, 1.5728206634521484, 1.2808637619018555, 0.28931713104248047, 0.1186819076538086, 1.3097171783447266, 1.5355920791625977, 0.9903430938720703, 1.4521188735961914, 0.10862350463867188, 2.337796211242676, 1.3407630920410156, 2.4749927520751953, 0.4941825866699219, 1.195383071899414, 1.1987895965576172], "mean_td_error": 1.1772170066833496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1027.0, "diff_num_grad_updates_vs_sampler_policy": 1026.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103628158569336, "actor_loss": -14.126726150512695, "critic_loss": 0.11028856784105301, "alpha_loss": -3.1120011806488037, "alpha_value": 0.7349092364311218, "log_alpha_value": -0.3080083131790161, "target_entropy": -6.0, "policy_t": -0.006801513023674488, "mean_q": 11.176615715026855, "max_q": 11.487567901611328, "min_q": 10.883947372436523}, "td_error": [1.5922541618347168, 0.7962770462036133, 0.7595148086547852, 0.7343096733093262, 0.31390857696533203, 2.102748394012451, 0.9761972427368164, 0.3893136978149414, 0.8504276275634766, 0.02430438995361328, 0.12942028045654297, 1.8872380256652832, 1.28171968460083, 0.7662110328674316, 2.7352094650268555, 0.8299598693847656, 1.0291156768798828, 1.2566823959350586, 1.2029423713684082, 0.5510921478271484, 1.087693214416504, 1.1121397018432617, 2.1814374923706055, 0.3219890594482422, 1.320786952972412, 0.5649962425231934, 0.6659579277038574, 0.19572782516479492, 0.13496112823486328, 1.0614800453186035, 2.0119409561157227, 0.5758471488952637, 0.1417851448059082, 1.7179746627807617, 0.2110276222229004, 0.4087514877319336, 0.2747812271118164, 0.38802337646484375, 1.485795497894287, 2.0606274604797363, 1.1620993614196777, 1.469954490661621, 2.272520065307617, 1.4335861206054688, 1.7489099502563477, 2.1177449226379395, 0.8972897529602051, 0.2075643539428711, 1.6083154678344727, 0.8480978012084961, 1.32462739944458, 0.741084098815918, 1.9016108512878418, 1.2114543914794922, 1.297811508178711, 1.7044124603271484, 0.14177274703979492, 0.5090193748474121, 0.251615047454834, 1.4178962707519531, 0.7768268585205078, 0.5239181518554688, 1.212778091430664, 1.5548624992370605, 0.07820653915405273, 0.6070184707641602, 0.40558910369873047, 1.9009809494018555, 2.2795181274414062, 0.7834458351135254, 1.2366185188293457, 2.9234743118286133, 0.8943438529968262, 1.9859099388122559, 0.5856695175170898, 2.2076563835144043, 0.778996467590332, 0.5447349548339844, 0.2744002342224121, 0.679652214050293, 0.4651503562927246, 2.9815659523010254, 3.1179189682006836, 1.238847255706787, 2.4854297637939453, 0.4718947410583496], "mean_td_error": 1.109248399734497, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1027.0, "diff_num_grad_updates_vs_sampler_policy": 1026.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.030620574951172, "actor_loss": -14.478386878967285, "critic_loss": 0.126109316945076, "alpha_loss": -3.08939266204834, "alpha_value": 0.7349181175231934, "log_alpha_value": -0.30799615383148193, "target_entropy": -6.0, "policy_t": 0.03711676225066185, "mean_q": 11.567171096801758, "max_q": 11.88380241394043, "min_q": 11.316579818725586}, "td_error": [1.870560646057129, 1.448326587677002, 0.2836112976074219, 0.2349109649658203, 1.6534156799316406, 1.5292339324951172, 1.4491033554077148, 0.6495504379272461, 1.6148548126220703, 0.05835676193237305, 0.3440704345703125, 0.9992189407348633, 1.0928964614868164, 0.8415327072143555, 0.617459774017334, 1.5132322311401367, 1.4754300117492676, 0.7246251106262207, 1.4317059516906738, 1.3969497680664062, 0.42968034744262695, 1.1306867599487305, 0.2444143295288086, 0.48264217376708984, 1.8874244689941406, 1.3524856567382812, 1.7056007385253906, 1.9155640602111816, 1.2131648063659668, 0.2302227020263672, 1.1951537132263184, 0.6273326873779297, 0.37981557846069336, 0.5227317810058594, 1.235619068145752, 0.8765244483947754, 0.5523958206176758, 1.2664413452148438, 0.8060965538024902, 0.09937524795532227, 0.002685546875, 0.5666294097900391, 1.5503196716308594, 0.035259246826171875, 0.07822561264038086, 0.5154628753662109, 0.568178653717041, 0.14075136184692383, 0.838010311126709, 0.8767995834350586, 1.556431770324707, 1.001699447631836, 0.34630537033081055, 0.7299132347106934, 0.5148305892944336, 0.24843883514404297, 1.6865825653076172, 0.9586806297302246, 2.4504594802856445, 0.23398303985595703, 0.799278736114502, 0.7761240005493164, 0.901005744934082, 1.1710519790649414, 0.8065299987792969, 1.0333642959594727, 1.4990301132202148, 0.22272348403930664, 0.856083869934082, 0.23122215270996094, 0.5123581886291504, 1.63584566116333, 1.4712610244750977, 1.1063189506530762, 0.6459512710571289, 0.9896326065063477, 1.8619022369384766, 2.3437633514404297, 0.33130645751953125, 0.4581122398376465, 2.248323440551758, 1.9674043655395508, 1.056666374206543, 0.7112841606140137, 0.38176536560058594, 1.5199565887451172], "mean_td_error": 0.9513993263244629, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1027.0, "diff_num_grad_updates_vs_sampler_policy": 1026.0}}, "num_env_steps_sampled": 8687, "num_env_steps_trained": 264966, "num_agent_steps_sampled": 26061, "num_agent_steps_trained": 264966, "last_target_update_ts": 8687, "num_target_updates": 1027}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26061, "num_agent_steps_trained": 264966, "num_env_steps_sampled": 8687, "num_env_steps_trained": 264966, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.40667568071416, "num_env_steps_trained_throughput_per_sec": 2484.417475089179, "timesteps_total": 8687, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 26061, "timers": {"training_iteration_time_ms": 103.748, "sample_time_ms": 15.985, "load_time_ms": 0.311, "load_throughput": 828330.092, "learn_time_ms": 18.022, "learn_throughput": 14315.997, "synch_weights_time_ms": 10.264}, "counters": {"num_env_steps_sampled": 8687, "num_env_steps_trained": 264966, "num_agent_steps_sampled": 26061, "num_agent_steps_trained": 264966, "last_target_update_ts": 8687, "num_target_updates": 1027}, "done": false, "episodes_total": 0, "training_iteration": 72, "trial_id": "db258_00000", "date": "2023-11-16_21-49-59", "timestamp": 1700200199, "time_this_iter_s": 1.721625804901123, "time_total_s": 112.25998401641846, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 112.25998401641846, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 33.55, "ram_util_percent": 63.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10107421875, "actor_loss": -21.5961971282959, "critic_loss": 0.10304783284664154, "alpha_loss": -3.157750368118286, "alpha_value": 0.7315313220024109, "log_alpha_value": -0.3126152753829956, "target_entropy": -6.0, "policy_t": 0.013839169405400753, "mean_q": 18.709136962890625, "max_q": 19.543699264526367, "min_q": 18.136844635009766}, "td_error": [0.639984130859375, 2.3844146728515625, 1.0508756637573242, 2.178339958190918, 0.7134513854980469, 1.2805728912353516, 1.1273384094238281, 0.4527597427368164, 2.4517040252685547, 2.4250707626342773, 0.9059085845947266, 1.4495506286621094, 1.7985649108886719, 0.695246696472168, 1.3488597869873047, 1.3191661834716797, 0.25296497344970703, 0.8893756866455078, 1.3564720153808594, 0.6880464553833008, 1.547719955444336, 1.0306205749511719, 1.4163475036621094, 0.9084806442260742, 0.7207965850830078, 0.9578151702880859, 1.069911003112793, 1.6124382019042969, 1.6875886917114258, 0.2297830581665039, 2.8939294815063477, 1.039419174194336, 0.9862518310546875, 0.4962606430053711, 0.5675773620605469, 1.1305627822875977, 0.26416969299316406, 0.9014854431152344, 0.7417306900024414, 0.7443618774414062, 1.8482532501220703, 0.8154277801513672, 0.30530452728271484, 0.9297542572021484, 0.6455116271972656, 1.5713834762573242, 0.6838283538818359, 0.2518177032470703, 0.4886350631713867, 0.05280780792236328, 1.9374828338623047, 2.6189537048339844, 1.093094825744629, 0.8355541229248047, 1.0006446838378906, 1.1247882843017578, 1.3404369354248047, 0.8878393173217773, 0.010709762573242188, 2.1234865188598633, 1.935816764831543, 0.9421157836914062, 0.8984899520874023, 1.2765941619873047, 1.4631147384643555, 1.9676017761230469, 0.8477506637573242, 0.9820690155029297, 2.075407028198242, 0.7889156341552734, 1.2928094863891602, 1.6655158996582031, 0.9333562850952148, 3.050874710083008, 3.4181747436523438, 1.3599834442138672, 0.5512790679931641, 0.37769508361816406, 0.23049640655517578, 1.1316728591918945, 2.151015281677246, 1.2394819259643555, 0.6903467178344727, 0.9087858200073242, 0.2070302963256836, 0.4361228942871094], "mean_td_error": 1.1598156690597534, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1042.0, "diff_num_grad_updates_vs_sampler_policy": 1041.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.039603233337402, "actor_loss": -14.188183784484863, "critic_loss": 0.12304436415433884, "alpha_loss": -3.1375179290771484, "alpha_value": 0.7316052913665771, "log_alpha_value": -0.31251412630081177, "target_entropy": -6.0, "policy_t": 0.04575610160827637, "mean_q": 11.270201683044434, "max_q": 11.577546119689941, "min_q": 11.006023406982422}, "td_error": [1.262514591217041, 1.3660955429077148, 1.0943236351013184, 1.5199084281921387, 1.676112174987793, 1.1306509971618652, 2.284813404083252, 1.0808439254760742, 0.9993042945861816, 1.5292749404907227, 0.6069526672363281, 1.9627070426940918, 1.0861425399780273, 2.301631450653076, 2.099123477935791, 1.2755718231201172, 1.9382858276367188, 0.03567314147949219, 1.040998935699463, 0.8506488800048828, 1.4711551666259766, 1.4044976234436035, 1.646090030670166, 0.9227724075317383, 2.4064674377441406, 0.28198909759521484, 0.8252744674682617, 2.777474880218506, 0.430391788482666, 0.7189240455627441, 1.8260021209716797, 1.421891212463379, 1.1003661155700684, 1.6197938919067383, 0.5019774436950684, 0.32266998291015625, 0.06682968139648438, 0.8920273780822754, 1.6385459899902344, 0.53021240234375, 1.2354736328125, 1.6826152801513672, 1.4690313339233398, 1.7521076202392578, 1.4234590530395508, 1.0169038772583008, 0.8743448257446289, 2.1566362380981445, 0.8591680526733398, 0.4465146064758301, 1.3023104667663574, 0.8572325706481934, 1.798264980316162, 0.590876579284668, 0.9300580024719238, 0.9565582275390625, 1.83723783493042, 0.3389744758605957, 1.5844082832336426, 1.2434654235839844, 1.322248935699463, 2.0291147232055664, 0.8590521812438965, 0.04267072677612305, 0.6037435531616211, 1.0253801345825195, 0.5372929573059082, 0.8473401069641113, 0.27229928970336914, 2.4859519004821777, 1.3838224411010742, 1.2439680099487305, 1.8716654777526855, 0.4540386199951172, 0.7431631088256836, 0.16884279251098633, 0.9547710418701172, 3.3483591079711914, 2.0386171340942383, 1.0004291534423828, 0.6756200790405273, 1.7434120178222656, 0.27675962448120117, 0.8392744064331055, 1.3241243362426758, 1.7001724243164062], "mean_td_error": 1.210403561592102, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1042.0, "diff_num_grad_updates_vs_sampler_policy": 1041.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097946166992188, "actor_loss": -14.365498542785645, "critic_loss": 0.12004999816417694, "alpha_loss": -3.155622959136963, "alpha_value": 0.7316145896911621, "log_alpha_value": -0.3125014305114746, "target_entropy": -6.0, "policy_t": -0.0013611206086352468, "mean_q": 11.406783103942871, "max_q": 11.787994384765625, "min_q": 11.062053680419922}, "td_error": [0.6697449684143066, 1.3830080032348633, 1.0424365997314453, 1.6002607345581055, 2.044342517852783, 0.6299128532409668, 0.09335136413574219, 0.19275522232055664, 0.16889333724975586, 0.6904687881469727, 0.5023598670959473, 0.9195318222045898, 2.310025691986084, 0.1514730453491211, 0.648310661315918, 1.7057037353515625, 0.18398809432983398, 0.10397148132324219, 0.7530422210693359, 0.60223388671875, 1.0212430953979492, 1.3663949966430664, 1.7512993812561035, 1.6800661087036133, 0.13421344757080078, 1.1351313591003418, 1.3822965621948242, 1.8523716926574707, 2.237588405609131, 1.2516183853149414, 1.3836736679077148, 0.026291847229003906, 1.1310791969299316, 0.49634552001953125, 1.8219919204711914, 0.42577266693115234, 1.6687684059143066, 0.7512259483337402, 0.7650375366210938, 0.33434009552001953, 0.8645305633544922, 0.14791250228881836, 1.9018611907958984, 0.35601329803466797, 2.3373804092407227, 0.9147472381591797, 0.40427112579345703, 0.06854486465454102, 0.9731121063232422, 0.48560667037963867, 0.5322003364562988, 0.7941036224365234, 1.3786702156066895, 0.6900315284729004, 0.6022777557373047, 0.4362964630126953, 0.3886446952819824, 0.9902644157409668, 0.4761171340942383, 0.8506388664245605, 1.124528408050537, 1.2935571670532227, 0.3218541145324707, 0.8057217597961426, 0.7540926933288574, 0.8421201705932617, 1.4132709503173828, 1.160923957824707, 0.7687339782714844, 0.3907794952392578, 0.30185747146606445, 0.712799072265625, 0.6959362030029297, 0.8661375045776367, 1.3110003471374512, 0.9827480316162109, 1.4286255836486816, 1.7798094749450684, 0.30814647674560547, 1.345529556274414, 2.3547563552856445, 1.0130462646484375, 0.6442985534667969, 1.887631893157959, 1.0855588912963867, 0.7555985450744629], "mean_td_error": 0.9413355588912964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1042.0, "diff_num_grad_updates_vs_sampler_policy": 1041.0}}, "num_env_steps_sampled": 8792, "num_env_steps_trained": 268836, "num_agent_steps_sampled": 26376, "num_agent_steps_trained": 268836, "last_target_update_ts": 8792, "num_target_updates": 1042}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26376, "num_agent_steps_trained": 268836, "num_env_steps_sampled": 8792, "num_env_steps_trained": 268836, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.40980189961952, "num_env_steps_trained_throughput_per_sec": 2484.532698585977, "timesteps_total": 8792, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 26376, "timers": {"training_iteration_time_ms": 103.546, "sample_time_ms": 15.811, "load_time_ms": 0.306, "load_throughput": 843569.093, "learn_time_ms": 17.908, "learn_throughput": 14407.371, "synch_weights_time_ms": 11.04}, "counters": {"num_env_steps_sampled": 8792, "num_env_steps_trained": 268836, "num_agent_steps_sampled": 26376, "num_agent_steps_trained": 268836, "last_target_update_ts": 8792, "num_target_updates": 1042}, "done": false, "episodes_total": 0, "training_iteration": 73, "trial_id": "db258_00000", "date": "2023-11-16_21-50-01", "timestamp": 1700200201, "time_this_iter_s": 1.5654151439666748, "time_total_s": 113.82539916038513, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e11c4a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 113.82539916038513, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 37.95, "ram_util_percent": 62.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109681129455566, "actor_loss": -21.872705459594727, "critic_loss": 0.10561642050743103, "alpha_loss": -3.206040859222412, "alpha_value": 0.728239119052887, "log_alpha_value": -0.3171258270740509, "target_entropy": -6.0, "policy_t": 0.012294188141822815, "mean_q": 18.962047576904297, "max_q": 19.486419677734375, "min_q": 18.60614776611328}, "td_error": [1.2942142486572266, 1.7497215270996094, 1.2306251525878906, 0.5255489349365234, 1.181436538696289, 1.5299386978149414, 1.5802688598632812, 0.40978145599365234, 1.119131088256836, 1.6527214050292969, 1.1964759826660156, 0.36388206481933594, 0.8757524490356445, 2.159067153930664, 0.38228797912597656, 1.0844078063964844, 0.7457456588745117, 0.8156976699829102, 1.021733283996582, 0.16839885711669922, 1.3249711990356445, 0.24805164337158203, 0.14849281311035156, 1.4183425903320312, 0.7918167114257812, 0.8448524475097656, 1.6779718399047852, 1.194681167602539, 0.8709001541137695, 0.2460775375366211, 1.2768774032592773, 0.42037296295166016, 1.1851797103881836, 1.4537696838378906, 0.9946422576904297, 0.1153421401977539, 1.4100284576416016, 2.770824432373047, 0.9477663040161133, 2.2914323806762695, 2.0738525390625, 0.2815694808959961, 1.6982908248901367, 2.0890159606933594, 0.7530813217163086, 0.07194232940673828, 0.8919544219970703, 0.5799798965454102, 2.275449752807617, 1.5207948684692383, 1.2253704071044922, 1.1355133056640625, 1.058302879333496, 0.7048702239990234, 1.781682014465332, 2.164351463317871, 1.0034618377685547, 1.2653865814208984, 2.580388069152832, 0.24641799926757812, 0.4922962188720703, 2.4250450134277344, 0.6892309188842773, 1.5198888778686523, 0.8134450912475586, 1.3372821807861328, 1.123335838317871, 1.2886028289794922, 1.165212631225586, 1.2928647994995117, 1.040940284729004, 2.378420829772949, 0.6492328643798828, 1.4486465454101562, 1.8155975341796875, 1.4965152740478516, 2.357912063598633, 0.633112907409668, 1.4356193542480469, 1.027623176574707, 1.013981819152832, 0.3639841079711914, 0.8842153549194336, 1.1653814315795898, 0.794835090637207, 1.7573204040527344], "mean_td_error": 1.1689702272415161, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1057.0, "diff_num_grad_updates_vs_sampler_policy": 1056.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108105659484863, "actor_loss": -14.369538307189941, "critic_loss": 0.09739330410957336, "alpha_loss": -3.204460382461548, "alpha_value": 0.7283170223236084, "log_alpha_value": -0.31701886653900146, "target_entropy": -6.0, "policy_t": -0.0006668955902568996, "mean_q": 11.424074172973633, "max_q": 11.670698165893555, "min_q": 11.155912399291992}, "td_error": [1.0551714897155762, 1.2596192359924316, 1.5748090744018555, 0.9994087219238281, 0.4634714126586914, 0.7250900268554688, 0.8225612640380859, 1.0908708572387695, 0.7078356742858887, 1.9206209182739258, 1.2500786781311035, 1.2572040557861328, 1.906083583831787, 0.5801811218261719, 1.2777652740478516, 1.7668614387512207, 1.0175762176513672, 1.125899314880371, 1.4870352745056152, 0.528383731842041, 0.7608137130737305, 0.26878786087036133, 1.8326082229614258, 0.40048646926879883, 1.647627830505371, 0.4473085403442383, 1.139115333557129, 1.6301841735839844, 1.120044231414795, 0.9556169509887695, 1.1349921226501465, 1.840836524963379, 0.6259951591491699, 1.8214645385742188, 0.414461612701416, 0.29848575592041016, 0.514552116394043, 0.8580350875854492, 1.9084892272949219, 0.5997657775878906, 0.2297663688659668, 0.041052818298339844, 0.6342768669128418, 0.23845434188842773, 0.5074782371520996, 1.3175134658813477, 1.592757225036621, 0.25547122955322266, 0.17799901962280273, 0.944918155670166, 1.3223686218261719, 0.6135473251342773, 1.5284667015075684, 1.4346284866333008, 0.5962810516357422, 0.36296701431274414, 0.5463848114013672, 2.6934337615966797, 0.8561367988586426, 1.3842406272888184, 2.2807536125183105, 1.5646095275878906, 0.015538215637207031, 0.28291940689086914, 0.4217567443847656, 0.8583889007568359, 1.6174201965332031, 1.536923885345459, 0.28176021575927734, 0.8526554107666016, 0.3203287124633789, 0.32201385498046875, 1.5488743782043457, 0.9301633834838867, 1.0284528732299805, 1.67948579788208, 1.647336483001709, 1.2425689697265625, 0.5338668823242188, 1.8140459060668945, 1.4235305786132812, 0.7271904945373535, 0.7494988441467285, 0.453399658203125, 0.03017425537109375, 2.1649045944213867], "mean_td_error": 1.0074756145477295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1057.0, "diff_num_grad_updates_vs_sampler_policy": 1056.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061422348022461, "actor_loss": -14.647725105285645, "critic_loss": 0.13906274735927582, "alpha_loss": -3.1895053386688232, "alpha_value": 0.728328287601471, "log_alpha_value": -0.31700339913368225, "target_entropy": -6.0, "policy_t": -0.0041769882664084435, "mean_q": 11.690215110778809, "max_q": 12.056991577148438, "min_q": 11.225812911987305}, "td_error": [1.0371956825256348, 1.1711740493774414, 1.9638662338256836, 0.029976844787597656, 1.9158616065979004, 1.171459674835205, 0.038199424743652344, 1.545907974243164, 0.08064889907836914, 0.8702945709228516, 1.2756810188293457, 2.2091097831726074, 0.6651425361633301, 0.5597381591796875, 1.9810538291931152, 1.5747990608215332, 1.9704012870788574, 0.6148457527160645, 1.5647592544555664, 0.9277162551879883, 0.23056650161743164, 0.8489303588867188, 0.13929414749145508, 0.8819789886474609, 0.5308356285095215, 0.5095987319946289, 0.22304534912109375, 0.6433467864990234, 1.9035224914550781, 0.4332895278930664, 1.3601422309875488, 0.7478923797607422, 0.3926239013671875, 2.15771484375, 1.4831933975219727, 0.683070182800293, 1.1592683792114258, 0.39356231689453125, 1.138047218322754, 2.0651679039001465, 1.084090232849121, 1.3091402053833008, 0.9926762580871582, 0.1256866455078125, 0.3025374412536621, 0.8439054489135742, 1.8394737243652344, 1.627110481262207, 0.12471914291381836, 1.3344626426696777, 0.6803088188171387, 2.8874802589416504, 1.420919418334961, 0.44377946853637695, 0.2702193260192871, 1.2198047637939453, 2.0160932540893555, 0.6594247817993164, 0.7749013900756836, 0.06875991821289062, 0.4939432144165039, 1.4585051536560059, 0.29186439514160156, 0.8646430969238281, 0.4943866729736328, 1.4771637916564941, 0.8235044479370117, 1.2051963806152344, 1.458064079284668, 0.3172950744628906, 2.1461243629455566, 0.32395267486572266, 1.1497840881347656, 0.9697837829589844, 0.9010682106018066, 0.24784278869628906, 2.2271223068237305, 1.9232921600341797, 0.13917255401611328, 2.817427158355713, 0.7080726623535156, 0.6991453170776367, 0.8926310539245605, 1.452486515045166, 0.5516853332519531, 0.773350715637207], "mean_td_error": 1.0223945379257202, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1057.0, "diff_num_grad_updates_vs_sampler_policy": 1056.0}}, "num_env_steps_sampled": 8897, "num_env_steps_trained": 272706, "num_agent_steps_sampled": 26691, "num_agent_steps_trained": 272706, "last_target_update_ts": 8897, "num_target_updates": 1057}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26691, "num_agent_steps_trained": 272706, "num_env_steps_sampled": 8897, "num_env_steps_trained": 272706, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.27957213800686, "num_env_steps_trained_throughput_per_sec": 2479.732801657967, "timesteps_total": 8897, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 26691, "timers": {"training_iteration_time_ms": 103.421, "sample_time_ms": 15.954, "load_time_ms": 0.315, "load_throughput": 818122.35, "learn_time_ms": 18.218, "learn_throughput": 14161.99, "synch_weights_time_ms": 10.307}, "counters": {"num_env_steps_sampled": 8897, "num_env_steps_trained": 272706, "num_agent_steps_sampled": 26691, "num_agent_steps_trained": 272706, "last_target_update_ts": 8897, "num_target_updates": 1057}, "done": false, "episodes_total": 0, "training_iteration": 74, "trial_id": "db258_00000", "date": "2023-11-16_21-50-03", "timestamp": 1700200203, "time_this_iter_s": 1.569972038269043, "time_total_s": 115.39537119865417, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 115.39537119865417, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 34.53333333333333, "ram_util_percent": 62.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100032806396484, "actor_loss": -22.03158187866211, "critic_loss": 0.10016161948442459, "alpha_loss": -3.248565673828125, "alpha_value": 0.7249597907066345, "log_alpha_value": -0.32163912057876587, "target_entropy": -6.0, "policy_t": 0.047265030443668365, "mean_q": 19.152294158935547, "max_q": 19.6323184967041, "min_q": 18.747344970703125}, "td_error": [0.7770977020263672, 0.40149497985839844, 1.4313421249389648, 1.3843231201171875, 0.6193714141845703, 1.0403337478637695, 0.7727146148681641, 0.9320602416992188, 1.4055919647216797, 2.293124198913574, 0.7580652236938477, 2.004429817199707, 1.684453010559082, 1.7080821990966797, 1.2691421508789062, 1.6787109375, 0.7670774459838867, 0.0955057144165039, 0.817814826965332, 0.5404777526855469, 1.7678728103637695, 2.5703125, 0.7218761444091797, 1.4486827850341797, 0.5961828231811523, 0.7634220123291016, 0.5354785919189453, 1.2043819427490234, 0.8795280456542969, 1.391469955444336, 1.3807039260864258, 1.695054054260254, 0.33808422088623047, 0.2464885711669922, 0.6177654266357422, 0.7764053344726562, 0.3494691848754883, 1.240401268005371, 1.5245399475097656, 2.0407581329345703, 1.2876272201538086, 2.016427993774414, 0.16168212890625, 0.39882659912109375, 1.9394750595092773, 0.2098712921142578, 1.8236989974975586, 0.41265106201171875, 0.8915882110595703, 1.445486068725586, 1.5561103820800781, 1.7654895782470703, 1.0534772872924805, 1.2625408172607422, 0.7309789657592773, 0.5734186172485352, 0.3231973648071289, 0.27392005920410156, 0.9599409103393555, 1.2908935546875, 1.5588159561157227, 0.6848087310791016, 1.108983039855957, 1.8691902160644531, 0.3018951416015625, 0.2718229293823242, 1.6403541564941406, 1.401402473449707, 1.6175155639648438, 1.7588691711425781, 0.414276123046875, 2.4162683486938477, 2.1572275161743164, 1.273660659790039, 1.592264175415039, 1.1687259674072266, 0.7191333770751953, 1.2602272033691406, 0.2478199005126953, 3.022796630859375, 0.8236703872680664, 0.9139976501464844, 1.7040510177612305, 0.10329437255859375, 1.494278907775879, 0.1588153839111328], "mean_td_error": 1.122459888458252, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1072.0, "diff_num_grad_updates_vs_sampler_policy": 1071.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067180633544922, "actor_loss": -14.520565032958984, "critic_loss": 0.10707596689462662, "alpha_loss": -3.236844539642334, "alpha_value": 0.7250429391860962, "log_alpha_value": -0.32152441143989563, "target_entropy": -6.0, "policy_t": -0.03247161954641342, "mean_q": 11.585273742675781, "max_q": 11.965986251831055, "min_q": 11.17201042175293}, "td_error": [0.32579803466796875, 0.8467550277709961, 1.4920353889465332, 1.3748087882995605, 0.3350543975830078, 1.3242268562316895, 0.1905841827392578, 0.06415557861328125, 1.6175622940063477, 0.9325227737426758, 1.5213184356689453, 2.0004544258117676, 0.5165882110595703, 0.7089071273803711, 0.435516357421875, 1.3163609504699707, 2.6050829887390137, 1.3764429092407227, 1.0131583213806152, 0.36280107498168945, 1.7354984283447266, 0.8959565162658691, 0.6175127029418945, 0.46106624603271484, 2.3579115867614746, 2.9337620735168457, 2.2581419944763184, 0.5136508941650391, 0.6543111801147461, 1.9139394760131836, 0.20331478118896484, 1.107071876525879, 0.9884252548217773, 2.6872854232788086, 0.39950990676879883, 0.3733210563659668, 0.6434264183044434, 0.5902833938598633, 0.24027013778686523, 0.9962596893310547, 1.474259853363037, 1.1288909912109375, 1.132166862487793, 0.5987896919250488, 0.9423961639404297, 1.0379533767700195, 2.214168071746826, 0.9280595779418945, 0.6091880798339844, 0.958651065826416, 1.002549171447754, 0.17752981185913086, 0.6177759170532227, 1.7492685317993164, 0.11892080307006836, 1.9031429290771484, 1.1227283477783203, 0.6123485565185547, 1.968205451965332, 0.9707918167114258, 0.2822585105895996, 0.47649288177490234, 0.5095310211181641, 0.417572021484375, 1.9832239151000977, 1.346043586730957, 0.4792037010192871, 0.44599485397338867, 1.7915096282958984, 0.8976459503173828, 0.922182559967041, 1.7058186531066895, 1.7509708404541016, 1.2872376441955566, 0.5070915222167969, 0.38706016540527344, 1.8315138816833496, 0.9137964248657227, 0.5485954284667969, 1.5846481323242188, 0.7248601913452148, 1.4938716888427734, 2.8384928703308105, 1.232884407043457, 1.3891077041625977, 2.2655138969421387], "mean_td_error": 1.0954879522323608, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1072.0, "diff_num_grad_updates_vs_sampler_policy": 1071.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.059623718261719, "actor_loss": -14.532647132873535, "critic_loss": 0.15719492733478546, "alpha_loss": -3.2342145442962646, "alpha_value": 0.7250573039054871, "log_alpha_value": -0.3215045630931854, "target_entropy": -6.0, "policy_t": -0.026997677981853485, "mean_q": 11.635416984558105, "max_q": 11.902825355529785, "min_q": 11.291015625}, "td_error": [0.7659645080566406, 1.601468563079834, 0.7709369659423828, 0.0506134033203125, 0.44110965728759766, 2.966660499572754, 0.6271719932556152, 1.1274642944335938, 1.3657622337341309, 0.9681191444396973, 1.2318553924560547, 0.8785896301269531, 1.5636224746704102, 1.0789151191711426, 0.8034701347351074, 0.06286334991455078, 1.488809585571289, 0.796027660369873, 0.8509397506713867, 2.1274118423461914, 1.150698184967041, 1.0465383529663086, 1.7251362800598145, 1.921882152557373, 0.16054058074951172, 1.144021987915039, 1.0855212211608887, 1.3510522842407227, 1.3498387336730957, 2.2088379859924316, 0.5429363250732422, 3.264845371246338, 0.4474034309387207, 2.6637344360351562, 1.1163616180419922, 2.0260043144226074, 1.2745838165283203, 1.2208905220031738, 0.9766864776611328, 0.3895435333251953, 0.608273983001709, 2.070250988006592, 0.5200424194335938, 0.6519412994384766, 1.4546418190002441, 0.8884124755859375, 0.48618459701538086, 0.3447866439819336, 1.6227612495422363, 0.86920166015625, 1.7960491180419922, 1.9892330169677734, 0.15698003768920898, 0.6163778305053711, 1.1410465240478516, 1.1441888809204102, 0.4875011444091797, 0.41154003143310547, 2.2840442657470703, 2.891620635986328, 0.8515934944152832, 0.9363083839416504, 0.34685611724853516, 0.4149346351623535, 1.3404607772827148, 1.9386882781982422, 0.7499632835388184, 1.363668441772461, 1.0430598258972168, 1.3527765274047852, 1.4974827766418457, 0.8859682083129883, 1.214111328125, 0.26288938522338867, 0.725275993347168, 1.1979560852050781, 1.401677131652832, 1.0557427406311035, 0.5716753005981445, 1.4332571029663086, 1.8199777603149414, 1.519761085510254, 1.4012455940246582, 1.8283653259277344, 0.046353816986083984, 1.6183233261108398], "mean_td_error": 1.1614915132522583, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1072.0, "diff_num_grad_updates_vs_sampler_policy": 1071.0}}, "num_env_steps_sampled": 9002, "num_env_steps_trained": 276576, "num_agent_steps_sampled": 27006, "num_agent_steps_trained": 276576, "last_target_update_ts": 9002, "num_target_updates": 1072}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27006, "num_agent_steps_trained": 276576, "num_env_steps_sampled": 9002, "num_env_steps_trained": 276576, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.9054243769851, "num_env_steps_trained_throughput_per_sec": 2502.7999270374507, "timesteps_total": 9002, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 27006, "timers": {"training_iteration_time_ms": 103.598, "sample_time_ms": 16.365, "load_time_ms": 0.309, "load_throughput": 835751.029, "learn_time_ms": 18.028, "learn_throughput": 14310.904, "synch_weights_time_ms": 10.112}, "counters": {"num_env_steps_sampled": 9002, "num_env_steps_trained": 276576, "num_agent_steps_sampled": 27006, "num_agent_steps_trained": 276576, "last_target_update_ts": 9002, "num_target_updates": 1072}, "done": false, "episodes_total": 0, "training_iteration": 75, "trial_id": "db258_00000", "date": "2023-11-16_21-50-04", "timestamp": 1700200204, "time_this_iter_s": 1.5545859336853027, "time_total_s": 116.94995713233948, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 116.94995713233948, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 62.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129046440124512, "actor_loss": -22.178457260131836, "critic_loss": 0.08173607289791107, "alpha_loss": -3.3035924434661865, "alpha_value": 0.721696674823761, "log_alpha_value": -0.32615038752555847, "target_entropy": -6.0, "policy_t": -0.02198469638824463, "mean_q": 19.28137969970703, "max_q": 19.759151458740234, "min_q": 18.879711151123047}, "td_error": [1.7271099090576172, 0.6748676300048828, 0.30585670471191406, 1.2392425537109375, 0.7925434112548828, 0.8610668182373047, 0.3039073944091797, 1.0354862213134766, 0.17788124084472656, 1.0382280349731445, 1.3444747924804688, 0.22705078125, 1.802877426147461, 0.5482749938964844, 0.8010988235473633, 0.5374717712402344, 0.6146888732910156, 1.8292961120605469, 1.3263654708862305, 1.5053892135620117, 0.6775894165039062, 0.1190185546875, 0.5769004821777344, 1.2809877395629883, 1.810837745666504, 0.5334053039550781, 0.9093093872070312, 0.3378791809082031, 1.7931632995605469, 1.2539196014404297, 0.2913379669189453, 0.2734231948852539, 0.07184028625488281, 1.0210514068603516, 1.3819103240966797, 1.6324577331542969, 0.3346986770629883, 1.114945411682129, 1.4700441360473633, 0.8086996078491211, 1.354990005493164, 0.5706653594970703, 1.3508014678955078, 0.9861087799072266, 0.5998916625976562, 0.8412895202636719, 1.4627094268798828, 1.0511579513549805, 1.6676149368286133, 0.7837905883789062, 1.3945016860961914, 1.1250801086425781, 0.03749656677246094, 0.41869354248046875, 1.6323614120483398, 0.4769906997680664, 1.9315986633300781, 1.6200933456420898, 0.5787506103515625, 1.9756879806518555, 1.3184185028076172, 0.933837890625, 0.1195220947265625, 0.5431814193725586, 1.1226091384887695, 1.6332483291625977, 1.1403207778930664, 0.18010520935058594, 0.3271322250366211, 0.4864778518676758, 0.37146568298339844, 0.7926559448242188, 0.8854331970214844, 1.3338117599487305, 1.4217090606689453, 1.6725587844848633, 0.47652721405029297, 1.9132232666015625, 0.947540283203125, 1.142587661743164, 1.6916828155517578, 2.575887680053711, 0.38460636138916016, 0.41480541229248047, 0.4728107452392578, 1.0170116424560547], "mean_td_error": 0.9716982245445251, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1087.0, "diff_num_grad_updates_vs_sampler_policy": 1086.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09006118774414, "actor_loss": -14.598082542419434, "critic_loss": 0.10693579912185669, "alpha_loss": -3.2896578311920166, "alpha_value": 0.7217838764190674, "log_alpha_value": -0.326029509305954, "target_entropy": -6.0, "policy_t": 0.01815458945930004, "mean_q": 11.691454887390137, "max_q": 11.981218338012695, "min_q": 11.402606010437012}, "td_error": [1.9967260360717773, 0.5281310081481934, 0.7823781967163086, 1.1772146224975586, 0.969733715057373, 0.49721813201904297, 1.9288253784179688, 0.2256793975830078, 0.42966222763061523, 0.9776949882507324, 0.719123363494873, 3.163093090057373, 1.250070571899414, 0.9393882751464844, 1.0350432395935059, 0.790461540222168, 1.0909652709960938, 0.7548627853393555, 1.5380139350891113, 1.0777502059936523, 0.5404462814331055, 1.7865638732910156, 0.35463380813598633, 2.8178787231445312, 2.175750732421875, 0.3670969009399414, 0.8403143882751465, 0.7550806999206543, 0.9614019393920898, 1.7119026184082031, 0.6848182678222656, 1.284715175628662, 1.594167709350586, 1.006765365600586, 1.9972729682922363, 0.8722200393676758, 1.255868911743164, 1.5440945625305176, 1.0910539627075195, 1.6059913635253906, 0.7556667327880859, 1.9656872749328613, 1.1315064430236816, 0.5724859237670898, 0.9053125381469727, 0.3254384994506836, 2.587535858154297, 0.40820980072021484, 0.820338249206543, 0.9798860549926758, 0.6720590591430664, 1.9228935241699219, 0.493497371673584, 0.6648917198181152, 1.183032512664795, 0.00920724868774414, 0.5685787200927734, 1.662602424621582, 0.6752185821533203, 2.5740275382995605, 1.5053949356079102, 0.9771065711975098, 1.772329330444336, 1.5091009140014648, 1.639000415802002, 1.1545519828796387, 1.3568792343139648, 1.331467628479004, 1.7783942222595215, 0.6470255851745605, 1.1732063293457031, 0.18999195098876953, 0.059946537017822266, 0.5106325149536133, 2.4620742797851562, 0.8781471252441406, 0.4131617546081543, 0.13387298583984375, 0.15764093399047852, 0.09213829040527344, 1.1509466171264648, 0.5778169631958008, 1.6064410209655762, 0.2377452850341797, 0.4297318458557129, 1.3705267906188965], "mean_td_error": 1.0827140808105469, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1087.0, "diff_num_grad_updates_vs_sampler_policy": 1086.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110000610351562, "actor_loss": -14.50329875946045, "critic_loss": 0.12716169655323029, "alpha_loss": -3.2959258556365967, "alpha_value": 0.7218004465103149, "log_alpha_value": -0.32600653171539307, "target_entropy": -6.0, "policy_t": 0.023175619542598724, "mean_q": 11.577601432800293, "max_q": 11.874221801757812, "min_q": 11.124166488647461}, "td_error": [0.4390678405761719, 1.3143696784973145, 0.8605403900146484, 1.326833724975586, 0.41654443740844727, 1.1555838584899902, 0.9603543281555176, 0.45132970809936523, 1.5356645584106445, 1.4324016571044922, 1.2714648246765137, 0.0709829330444336, 1.3966455459594727, 1.1718173027038574, 1.4304423332214355, 0.9562749862670898, 0.1192636489868164, 0.9648823738098145, 0.14784002304077148, 0.811429500579834, 0.5656380653381348, 0.46033668518066406, 1.5934219360351562, 1.2063603401184082, 0.4252285957336426, 1.3443965911865234, 1.1799144744873047, 0.6328420639038086, 2.3914127349853516, 1.7896742820739746, 2.601320266723633, 0.8057594299316406, 0.19215822219848633, 1.8576970100402832, 1.1789054870605469, 0.11739110946655273, 0.07131242752075195, 0.5699472427368164, 1.168416976928711, 0.9902362823486328, 1.1141343116760254, 0.4186210632324219, 1.5573554039001465, 0.8702759742736816, 0.5685029029846191, 1.7418889999389648, 0.6689372062683105, 1.420639991760254, 0.23702430725097656, 0.8634738922119141, 0.9508848190307617, 1.0445795059204102, 0.2890009880065918, 1.7681245803833008, 1.7136826515197754, 0.2070770263671875, 0.9269351959228516, 0.6454854011535645, 0.5324888229370117, 1.4254794120788574, 0.4350728988647461, 0.4670238494873047, 1.0221600532531738, 1.404982089996338, 0.13762569427490234, 0.24661588668823242, 1.7058720588684082, 0.6258058547973633, 1.6125965118408203, 1.1587252616882324, 1.3531599044799805, 0.3672933578491211, 0.24517536163330078, 0.23341608047485352, 1.7950921058654785, 1.157778263092041, 0.46343469619750977, 1.3934574127197266, 0.41770362854003906, 1.0755786895751953, 1.7177057266235352, 1.566762924194336, 1.450854778289795, 1.4401979446411133, 0.3269844055175781, 2.593235969543457], "mean_td_error": 0.9855232834815979, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1087.0, "diff_num_grad_updates_vs_sampler_policy": 1086.0}}, "num_env_steps_sampled": 9107, "num_env_steps_trained": 280446, "num_agent_steps_sampled": 27321, "num_agent_steps_trained": 280446, "last_target_update_ts": 9107, "num_target_updates": 1087}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27321, "num_agent_steps_trained": 280446, "num_env_steps_sampled": 9107, "num_env_steps_trained": 280446, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.60037668165565, "num_env_steps_trained_throughput_per_sec": 2491.556740552451, "timesteps_total": 9107, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 27321, "timers": {"training_iteration_time_ms": 103.454, "sample_time_ms": 16.053, "load_time_ms": 0.319, "load_throughput": 809796.028, "learn_time_ms": 17.805, "learn_throughput": 14490.347, "synch_weights_time_ms": 10.515}, "counters": {"num_env_steps_sampled": 9107, "num_env_steps_trained": 280446, "num_agent_steps_sampled": 27321, "num_agent_steps_trained": 280446, "last_target_update_ts": 9107, "num_target_updates": 1087}, "done": false, "episodes_total": 0, "training_iteration": 76, "trial_id": "db258_00000", "date": "2023-11-16_21-50-06", "timestamp": 1700200206, "time_this_iter_s": 1.560986042022705, "time_total_s": 118.51094317436218, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 118.51094317436218, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 34.45, "ram_util_percent": 62.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.050699234008789, "actor_loss": -22.47157859802246, "critic_loss": 0.09249786287546158, "alpha_loss": -3.323336601257324, "alpha_value": 0.7184513807296753, "log_alpha_value": -0.3306572437286377, "target_entropy": -6.0, "policy_t": -0.0022247133310884237, "mean_q": 19.61335563659668, "max_q": 20.159015655517578, "min_q": 19.161216735839844}, "td_error": [0.9699897766113281, 0.7099056243896484, 0.5802898406982422, 1.2520599365234375, 1.3096809387207031, 2.474946975708008, 1.3824787139892578, 0.6781930923461914, 1.7113723754882812, 1.0371036529541016, 0.6830520629882812, 0.49779415130615234, 0.7673168182373047, 1.6677093505859375, 1.5161676406860352, 0.18658447265625, 0.8446207046508789, 0.6135005950927734, 2.2136993408203125, 0.578887939453125, 0.9895858764648438, 1.2309513092041016, 0.22511577606201172, 1.3169517517089844, 1.8704299926757812, 0.11876964569091797, 1.8759574890136719, 0.5942935943603516, 2.399394989013672, 0.7120170593261719, 1.4977941513061523, 1.8929424285888672, 0.4233989715576172, 1.1727771759033203, 1.7743902206420898, 0.10982513427734375, 0.5945587158203125, 1.9818801879882812, 0.5478973388671875, 0.06827259063720703, 1.6594934463500977, 0.7812013626098633, 2.336848258972168, 1.0021848678588867, 1.9392662048339844, 0.8349208831787109, 1.4217853546142578, 2.0983448028564453, 0.45903968811035156, 0.4884166717529297, 1.5882606506347656, 0.7310094833374023, 1.4290218353271484, 1.1901588439941406, 0.3108196258544922, 0.9079742431640625, 0.6542873382568359, 0.6594829559326172, 0.6898860931396484, 0.6228504180908203, 2.0711727142333984, 0.3015108108520508, 0.9343032836914062, 0.6753273010253906, 1.9034814834594727, 1.379715919494629, 0.3276643753051758, 1.2542610168457031, 0.8286342620849609, 0.6884336471557617, 0.6933479309082031, 2.0222301483154297, 0.7493391036987305, 0.8135786056518555, 0.17521953582763672, 1.2398386001586914, 2.2476119995117188, 0.49952220916748047, 0.23090553283691406, 0.14431095123291016, 0.6853189468383789, 1.0809440612792969, 0.4841156005859375, 1.1664628982543945, 1.889378547668457, 0.9047756195068359], "mean_td_error": 1.0496419668197632, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1102.0, "diff_num_grad_updates_vs_sampler_policy": 1101.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.028654098510742, "actor_loss": -14.518885612487793, "critic_loss": 0.12206186354160309, "alpha_loss": -3.314789056777954, "alpha_value": 0.7185415029525757, "log_alpha_value": -0.3305317759513855, "target_entropy": -6.0, "policy_t": -0.05217316746711731, "mean_q": 11.601134300231934, "max_q": 12.114774703979492, "min_q": 11.212850570678711}, "td_error": [0.7761969566345215, 1.2885255813598633, 0.4307985305786133, 0.0060672760009765625, 0.07816028594970703, 0.8939647674560547, 0.717109203338623, 0.44133615493774414, 1.8242545127868652, 0.8800539970397949, 2.581264019012451, 1.8426642417907715, 1.4862585067749023, 0.8647642135620117, 0.7219066619873047, 1.6788735389709473, 0.551795482635498, 2.982626438140869, 1.1669931411743164, 0.7430295944213867, 2.459184169769287, 0.6244282722473145, 0.648125171661377, 1.9830083847045898, 1.669081687927246, 1.687535285949707, 1.828606128692627, 1.228525161743164, 0.35309553146362305, 1.2046551704406738, 0.5341968536376953, 0.7762980461120605, 2.0177788734436035, 1.622586727142334, 1.0048723220825195, 1.7029261589050293, 1.0909790992736816, 0.503870964050293, 1.648134708404541, 1.0941243171691895, 1.2058448791503906, 1.2053322792053223, 0.8409976959228516, 2.982834815979004, 1.9718379974365234, 1.8249669075012207, 1.0852384567260742, 0.17035865783691406, 2.091353416442871, 1.149498462677002, 0.831273078918457, 0.5430707931518555, 0.8569374084472656, 1.8864822387695312, 2.0225563049316406, 1.3064069747924805, 1.0172553062438965, 2.7267775535583496, 1.367471694946289, 0.6282272338867188, 1.8676910400390625, 1.9826464653015137, 0.8826637268066406, 0.7816462516784668, 1.2626190185546875, 0.6412215232849121, 0.4592771530151367, 2.234768867492676, 0.25827503204345703, 0.8661594390869141, 0.21812915802001953, 0.4456357955932617, 0.09598541259765625, 1.4824504852294922, 1.8681154251098633, 0.8134121894836426, 1.8023853302001953, 0.2825145721435547, 1.538283348083496, 1.3908710479736328, 2.1357932090759277, 0.8552742004394531, 0.29262542724609375, 0.2421126365661621, 1.216649055480957, 1.0888805389404297], "mean_td_error": 1.1902263164520264, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1102.0, "diff_num_grad_updates_vs_sampler_policy": 1101.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081526756286621, "actor_loss": -14.424489974975586, "critic_loss": 0.13297155499458313, "alpha_loss": -3.332003593444824, "alpha_value": 0.7185601592063904, "log_alpha_value": -0.3305058479309082, "target_entropy": -6.0, "policy_t": -0.007836650125682354, "mean_q": 11.505002975463867, "max_q": 11.83070182800293, "min_q": 11.10704231262207}, "td_error": [1.0642609596252441, 0.2513585090637207, 1.2033414840698242, 0.05913114547729492, 0.7776737213134766, 0.4267287254333496, 0.6871776580810547, 0.043744564056396484, 1.234121322631836, 0.24882173538208008, 0.22190475463867188, 0.9773335456848145, 0.7810397148132324, 0.24155902862548828, 1.9104185104370117, 0.5806241035461426, 0.60418701171875, 0.5210199356079102, 0.7702903747558594, 0.06248283386230469, 0.6384463310241699, 0.08517885208129883, 1.290693759918213, 0.9904055595397949, 1.3523221015930176, 2.9436511993408203, 1.1025452613830566, 0.37419700622558594, 3.032329559326172, 1.3278717994689941, 0.41603565216064453, 1.051218032836914, 1.0129656791687012, 2.504232406616211, 0.9204587936401367, 1.49702787399292, 1.1783056259155273, 3.4778223037719727, 1.6533656120300293, 0.5393218994140625, 0.22587966918945312, 0.9970874786376953, 2.1455845832824707, 0.4962925910949707, 0.7173829078674316, 1.3254995346069336, 1.897143840789795, 2.309391975402832, 1.2580623626708984, 1.7564377784729004, 0.0490565299987793, 1.6021103858947754, 1.6572933197021484, 0.8035268783569336, 1.2746129035949707, 1.2220182418823242, 1.2676262855529785, 1.7212190628051758, 0.7875628471374512, 1.6582355499267578, 1.4737019538879395, 1.390134334564209, 1.4078168869018555, 0.7915091514587402, 1.109898567199707, 0.21501779556274414, 2.11245059967041, 1.4302482604980469, 0.4609212875366211, 0.2698812484741211, 0.36275815963745117, 0.3502483367919922, 1.6771845817565918, 0.644648551940918, 0.9275622367858887, 1.1325531005859375, 0.9121875762939453, 0.8429412841796875, 0.13328838348388672, 0.6878113746643066, 0.19238710403442383, 0.5243172645568848, 0.9194779396057129, 1.419724464416504, 0.5085511207580566, 0.7630691528320312], "mean_td_error": 1.021952748298645, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1102.0, "diff_num_grad_updates_vs_sampler_policy": 1101.0}}, "num_env_steps_sampled": 9212, "num_env_steps_trained": 284316, "num_agent_steps_sampled": 27636, "num_agent_steps_trained": 284316, "last_target_update_ts": 9212, "num_target_updates": 1102}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27636, "num_agent_steps_trained": 284316, "num_env_steps_sampled": 9212, "num_env_steps_trained": 284316, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.91044002812627, "num_env_steps_trained_throughput_per_sec": 2502.984789608083, "timesteps_total": 9212, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 27636, "timers": {"training_iteration_time_ms": 103.57, "sample_time_ms": 16.374, "load_time_ms": 0.305, "load_throughput": 845678.675, "learn_time_ms": 17.862, "learn_throughput": 14443.832, "synch_weights_time_ms": 10.184}, "counters": {"num_env_steps_sampled": 9212, "num_env_steps_trained": 284316, "num_agent_steps_sampled": 27636, "num_agent_steps_trained": 284316, "last_target_update_ts": 9212, "num_target_updates": 1102}, "done": false, "episodes_total": 0, "training_iteration": 77, "trial_id": "db258_00000", "date": "2023-11-16_21-50-07", "timestamp": 1700200207, "time_this_iter_s": 1.5564911365509033, "time_total_s": 120.06743431091309, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 120.06743431091309, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 32.85, "ram_util_percent": 62.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086488723754883, "actor_loss": -22.246902465820312, "critic_loss": 0.09945090860128403, "alpha_loss": -3.3806731700897217, "alpha_value": 0.7152175903320312, "log_alpha_value": -0.3351684808731079, "target_entropy": -6.0, "policy_t": 0.008480492979288101, "mean_q": 19.363218307495117, "max_q": 19.82613182067871, "min_q": 19.034568786621094}, "td_error": [1.9526901245117188, 0.11414909362792969, 1.1215438842773438, 1.0682659149169922, 0.10785579681396484, 0.06737613677978516, 1.2128314971923828, 0.0762948989868164, 0.29295825958251953, 0.419342041015625, 0.2694244384765625, 1.5805339813232422, 0.5546894073486328, 1.2404041290283203, 1.690164566040039, 2.561338424682617, 1.4382429122924805, 1.806208610534668, 0.5586452484130859, 1.7719078063964844, 1.1723480224609375, 0.7491893768310547, 2.850250244140625, 0.7835826873779297, 0.7094917297363281, 0.8858938217163086, 1.9475593566894531, 1.0215835571289062, 2.2663631439208984, 2.13112735748291, 0.069366455078125, 1.131068229675293, 0.7765064239501953, 0.7162284851074219, 1.1904268264770508, 0.9148941040039062, 1.2359752655029297, 1.663224220275879, 0.8264636993408203, 2.2674970626831055, 0.029993057250976562, 0.17406654357910156, 0.08756351470947266, 0.7980985641479492, 0.6600275039672852, 0.9047689437866211, 0.2863025665283203, 0.23309326171875, 1.0390033721923828, 1.2197818756103516, 1.298935890197754, 0.48798084259033203, 0.5473575592041016, 0.47951221466064453, 0.6418399810791016, 1.0507640838623047, 1.5873794555664062, 2.2738637924194336, 0.7298831939697266, 2.16995906829834, 2.0017871856689453, 1.0020256042480469, 0.5235633850097656, 1.7517938613891602, 0.43923282623291016, 1.091994285583496, 1.2632455825805664, 0.5731611251831055, 2.2469301223754883, 0.32369518280029297, 1.6198444366455078, 0.3976106643676758, 1.924245834350586, 0.8716831207275391, 1.6833133697509766, 1.8026762008666992, 2.182370185852051, 0.0556793212890625, 0.5464591979980469, 1.2273368835449219, 1.8442630767822266, 2.2377662658691406, 0.5981864929199219, 1.5878715515136719, 0.9038963317871094, 0.11940193176269531], "mean_td_error": 1.0783036947250366, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1117.0, "diff_num_grad_updates_vs_sampler_policy": 1116.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.155488014221191, "actor_loss": -14.756976127624512, "critic_loss": 0.09536001831293106, "alpha_loss": -3.402395486831665, "alpha_value": 0.7153164148330688, "log_alpha_value": -0.3350302577018738, "target_entropy": -6.0, "policy_t": 0.02152302674949169, "mean_q": 11.839090347290039, "max_q": 12.137980461120605, "min_q": 11.608343124389648}, "td_error": [0.16125202178955078, 1.2177925109863281, 1.9577598571777344, 0.847987174987793, 1.9969525337219238, 0.5955586433410645, 0.45067930221557617, 1.1406893730163574, 0.7500066757202148, 1.7756943702697754, 1.3810806274414062, 1.3014898300170898, 0.09387874603271484, 0.8398075103759766, 1.386922836303711, 1.4239983558654785, 1.2389559745788574, 1.0031661987304688, 1.4557294845581055, 0.4834723472595215, 0.66973876953125, 1.2518506050109863, 0.8850493431091309, 0.5691061019897461, 1.6220998764038086, 0.5715408325195312, 0.43393802642822266, 1.6011195182800293, 0.3654026985168457, 0.505378246307373, 1.1561779975891113, 0.917212963104248, 0.19662046432495117, 0.0669565200805664, 0.4839134216308594, 1.796156406402588, 0.3500852584838867, 0.492612361907959, 0.09587812423706055, 1.5816545486450195, 1.4202580451965332, 1.1001262664794922, 1.598391056060791, 0.07284688949584961, 1.7666993141174316, 0.39038515090942383, 1.050065517425537, 2.0080513954162598, 1.519019603729248, 1.142326831817627, 0.9671831130981445, 0.5332403182983398, 2.81095552444458, 0.31873035430908203, 0.03156232833862305, 0.4817976951599121, 1.868624210357666, 2.4179577827453613, 0.7428731918334961, 0.7188172340393066, 1.2236442565917969, 1.1622381210327148, 0.10061120986938477, 1.4293155670166016, 0.7671165466308594, 2.5455689430236816, 1.0142993927001953, 0.9458303451538086, 0.626528263092041, 0.49036216735839844, 1.7425966262817383, 1.0856904983520508, 1.0300202369689941, 0.8753066062927246, 0.7621064186096191, 0.060321807861328125, 2.5918140411376953, 0.293975830078125, 1.562021255493164, 0.43987226486206055, 0.05765247344970703, 1.3028793334960938, 0.7369308471679688, 0.5933623313903809, 0.5965404510498047, 1.361279010772705], "mean_td_error": 0.9938739538192749, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1117.0, "diff_num_grad_updates_vs_sampler_policy": 1116.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107221603393555, "actor_loss": -14.523550987243652, "critic_loss": 0.1598089039325714, "alpha_loss": -3.3859493732452393, "alpha_value": 0.7153359651565552, "log_alpha_value": -0.33500298857688904, "target_entropy": -6.0, "policy_t": -0.0226396806538105, "mean_q": 11.5719633102417, "max_q": 11.897990226745605, "min_q": 11.243858337402344}, "td_error": [1.3753271102905273, 0.15711116790771484, 1.0837640762329102, 1.1122040748596191, 0.9061565399169922, 0.34948205947875977, 0.3983016014099121, 1.915532112121582, 0.25025033950805664, 1.3800244331359863, 1.9529361724853516, 0.5798554420471191, 2.1408329010009766, 1.8991975784301758, 1.3162145614624023, 2.3684582710266113, 1.024765968322754, 0.6940131187438965, 0.36245298385620117, 1.1346440315246582, 3.022913932800293, 0.7707042694091797, 0.4471426010131836, 0.36716508865356445, 0.610234260559082, 2.3563179969787598, 2.212879180908203, 0.8078670501708984, 0.18166828155517578, 0.7664527893066406, 0.7321500778198242, 1.71104097366333, 0.8803939819335938, 0.09587240219116211, 0.2444171905517578, 4.0192155838012695, 0.677574634552002, 0.3523693084716797, 1.575984001159668, 0.6286067962646484, 0.513493537902832, 0.6289024353027344, 1.6277618408203125, 0.9163408279418945, 1.4052019119262695, 1.6982851028442383, 1.700150966644287, 3.104682445526123, 0.7555627822875977, 1.2919483184814453, 1.5287299156188965, 1.0276336669921875, 1.2971248626708984, 0.5461773872375488, 2.3092756271362305, 0.8730669021606445, 1.0316486358642578, 0.8019719123840332, 1.7627472877502441, 1.4369158744812012, 0.5687155723571777, 0.9909472465515137, 0.5637607574462891, 0.3295717239379883, 0.8536057472229004, 0.7689342498779297, 2.5101747512817383, 1.0093035697937012, 1.402587890625, 0.2833528518676758, 1.7791848182678223, 1.9981565475463867, 0.7271084785461426, 2.2219128608703613, 0.36429882049560547, 2.1675281524658203, 1.4735746383666992, 1.497084617614746, 0.06782007217407227, 1.6638288497924805, 2.3432774543762207, 1.7571935653686523, 0.6700491905212402, 1.6124653816223145, 1.516998291015625, 0.023504257202148438], "mean_td_error": 1.1893612146377563, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1117.0, "diff_num_grad_updates_vs_sampler_policy": 1116.0}}, "num_env_steps_sampled": 9317, "num_env_steps_trained": 288186, "num_agent_steps_sampled": 27951, "num_agent_steps_trained": 288186, "last_target_update_ts": 9317, "num_target_updates": 1117}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27951, "num_agent_steps_trained": 288186, "num_env_steps_sampled": 9317, "num_env_steps_trained": 288186, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.57178089531298, "num_env_steps_trained_throughput_per_sec": 2490.5027815701073, "timesteps_total": 9317, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 27951, "timers": {"training_iteration_time_ms": 103.598, "sample_time_ms": 16.345, "load_time_ms": 0.314, "load_throughput": 820355.115, "learn_time_ms": 17.897, "learn_throughput": 14416.027, "synch_weights_time_ms": 10.115}, "counters": {"num_env_steps_sampled": 9317, "num_env_steps_trained": 288186, "num_agent_steps_sampled": 27951, "num_agent_steps_trained": 288186, "last_target_update_ts": 9317, "num_target_updates": 1117}, "done": false, "episodes_total": 0, "training_iteration": 78, "trial_id": "db258_00000", "date": "2023-11-16_21-50-09", "timestamp": 1700200209, "time_this_iter_s": 1.5624101161956787, "time_total_s": 121.62984442710876, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 121.62984442710876, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 62.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077607154846191, "actor_loss": -22.5762996673584, "critic_loss": 0.09739412367343903, "alpha_loss": -3.4231369495391846, "alpha_value": 0.7119998931884766, "log_alpha_value": -0.33967751264572144, "target_entropy": -6.0, "policy_t": -0.031492605805397034, "mean_q": 19.709135055541992, "max_q": 20.011917114257812, "min_q": 19.382328033447266}, "td_error": [0.9665346145629883, 0.7679424285888672, 0.6102199554443359, 1.369680404663086, 0.44623756408691406, 0.2572298049926758, 0.2808094024658203, 1.4581470489501953, 3.2698116302490234, 0.8185205459594727, 2.7632017135620117, 3.216737747192383, 1.3294639587402344, 1.5940465927124023, 1.3457708358764648, 2.2167253494262695, 0.9042882919311523, 1.845259666442871, 1.2689199447631836, 0.3104400634765625, 1.2697057723999023, 0.8634653091430664, 0.1737051010131836, 3.2959136962890625, 1.4678077697753906, 0.7662992477416992, 1.292276382446289, 1.0740280151367188, 0.5758190155029297, 1.9340381622314453, 1.1760482788085938, 0.4683237075805664, 2.246173858642578, 1.1883440017700195, 2.159306526184082, 0.609217643737793, 2.302488327026367, 1.2351932525634766, 0.14447021484375, 0.9587602615356445, 0.08648872375488281, 1.1812419891357422, 0.5508499145507812, 0.12628746032714844, 0.7123537063598633, 1.4789314270019531, 1.8598613739013672, 1.078993797302246, 0.11762237548828125, 0.7960214614868164, 0.673741340637207, 1.0838308334350586, 0.630828857421875, 0.34082984924316406, 1.0825843811035156, 0.060379981994628906, 1.5677080154418945, 0.20041465759277344, 0.5297327041625977, 1.613306999206543, 1.8958959579467773, 0.2064685821533203, 1.5105562210083008, 1.7233619689941406, 0.27177906036376953, 1.5832109451293945, 0.26421356201171875, 0.43163299560546875, 1.275191307067871, 0.4854106903076172, 0.27828407287597656, 0.6526041030883789, 1.7978696823120117, 1.2046232223510742, 1.0676336288452148, 0.5427265167236328, 0.35789012908935547, 0.23905658721923828, 1.3480396270751953, 2.4040355682373047, 1.446645736694336, 1.0348138809204102, 0.744415283203125, 0.06579303741455078, 0.32805728912353516, 1.8590497970581055], "mean_td_error": 1.0817748308181763, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1132.0, "diff_num_grad_updates_vs_sampler_policy": 1131.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073458671569824, "actor_loss": -14.876962661743164, "critic_loss": 0.10960619896650314, "alpha_loss": -3.4202585220336914, "alpha_value": 0.7121037244796753, "log_alpha_value": -0.33953168988227844, "target_entropy": -6.0, "policy_t": -0.026489587500691414, "mean_q": 12.040513038635254, "max_q": 12.367877960205078, "min_q": 11.753137588500977}, "td_error": [1.4930038452148438, 1.4311857223510742, 1.7776670455932617, 2.682596206665039, 0.9059123992919922, 0.03747129440307617, 1.3156113624572754, 1.053492546081543, 1.9698371887207031, 0.5480384826660156, 0.6066756248474121, 0.03472614288330078, 0.4802412986755371, 0.17147064208984375, 1.9890084266662598, 1.858762264251709, 0.763279914855957, 0.9521775245666504, 1.4691543579101562, 0.28594255447387695, 1.3220582008361816, 1.009265422821045, 1.6119427680969238, 1.0156574249267578, 1.8076839447021484, 1.8640618324279785, 0.5255346298217773, 1.1222004890441895, 0.6069464683532715, 0.0503087043762207, 0.0432734489440918, 0.19146347045898438, 0.6538906097412109, 2.6677017211914062, 0.47669315338134766, 0.07396841049194336, 2.2477145195007324, 1.1394844055175781, 0.7851805686950684, 0.6846404075622559, 0.4200706481933594, 0.8430304527282715, 2.2470202445983887, 0.7021241188049316, 0.9040694236755371, 1.6088190078735352, 2.8020424842834473, 1.3093419075012207, 0.6951470375061035, 0.8620681762695312, 2.157632350921631, 1.124464988708496, 1.24774169921875, 2.877955436706543, 1.444906234741211, 0.8657217025756836, 1.0859198570251465, 1.5904669761657715, 0.4557304382324219, 0.7883095741271973, 0.3740973472595215, 1.224837303161621, 0.9883837699890137, 1.1917247772216797, 0.6937174797058105, 2.3389487266540527, 0.6916632652282715, 0.7838683128356934, 1.1441130638122559, 0.4206576347351074, 2.399265766143799, 1.7379045486450195, 0.3891768455505371, 1.0818028450012207, 1.50484037399292, 0.5488734245300293, 0.16907405853271484, 1.0478386878967285, 1.699838638305664, 0.5500726699829102, 1.46848726272583, 1.0542254447937012, 1.2398161888122559, 2.0003604888916016, 1.111328125, 1.3528637886047363], "mean_td_error": 1.1275150775909424, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1132.0, "diff_num_grad_updates_vs_sampler_policy": 1131.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.00546932220459, "actor_loss": -14.451026916503906, "critic_loss": 0.14159119129180908, "alpha_loss": -3.396937847137451, "alpha_value": 0.712120532989502, "log_alpha_value": -0.3395081162452698, "target_entropy": -6.0, "policy_t": 0.020913103595376015, "mean_q": 11.649127960205078, "max_q": 11.972999572753906, "min_q": 11.307165145874023}, "td_error": [0.49970388412475586, 0.5678439140319824, 0.7817749977111816, 1.476212978363037, 1.1337847709655762, 0.15248966217041016, 1.6484746932983398, 0.2534480094909668, 1.4655146598815918, 1.7086763381958008, 0.7411322593688965, 0.9397873878479004, 0.7466869354248047, 1.115912914276123, 1.645432472229004, 1.026102066040039, 0.3084392547607422, 1.3413515090942383, 1.4544425010681152, 1.1184382438659668, 1.1306943893432617, 0.9906797409057617, 2.4452643394470215, 1.4092531204223633, 0.0530247688293457, 1.9908037185668945, 2.0100021362304688, 1.4488458633422852, 0.39011287689208984, 0.4538865089416504, 0.579383373260498, 0.9589447975158691, 0.8517355918884277, 0.8702692985534668, 0.7314424514770508, 0.5405020713806152, 1.9671177864074707, 2.0095438957214355, 0.8452186584472656, 0.575749397277832, 2.1082773208618164, 1.2517967224121094, 1.384605884552002, 1.2302141189575195, 1.4163446426391602, 0.5655512809753418, 0.2737865447998047, 0.9685220718383789, 0.8599748611450195, 1.2151274681091309, 0.5406641960144043, 0.5596885681152344, 0.7436022758483887, 0.5917510986328125, 1.784590721130371, 0.6991152763366699, 0.9506378173828125, 0.999384880065918, 1.7785639762878418, 0.49939489364624023, 0.9688138961791992, 1.5154705047607422, 1.0897064208984375, 1.0768804550170898, 1.5137825012207031, 0.5835404396057129, 1.6574692726135254, 2.072342872619629, 0.6805181503295898, 1.377485752105713, 2.044492244720459, 1.1810698509216309, 0.3490424156188965, 0.35271692276000977, 0.13433218002319336, 0.8242940902709961, 1.6480517387390137, 2.0225276947021484, 0.7771434783935547, 1.137324333190918, 0.05883216857910156, 1.5626826286315918, 1.4370355606079102, 1.7447023391723633, 1.4313149452209473, 0.10819005966186523], "mean_td_error": 1.0715056657791138, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1132.0, "diff_num_grad_updates_vs_sampler_policy": 1131.0}}, "num_env_steps_sampled": 9422, "num_env_steps_trained": 292056, "num_agent_steps_sampled": 28266, "num_agent_steps_trained": 292056, "last_target_update_ts": 9422, "num_target_updates": 1132}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28266, "num_agent_steps_trained": 292056, "num_env_steps_sampled": 9422, "num_env_steps_trained": 292056, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.17105473350249, "num_env_steps_trained_throughput_per_sec": 2512.5903030348063, "timesteps_total": 9422, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 28266, "timers": {"training_iteration_time_ms": 103.293, "sample_time_ms": 15.626, "load_time_ms": 0.314, "load_throughput": 821164.389, "learn_time_ms": 17.986, "learn_throughput": 14344.69, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 9422, "num_env_steps_trained": 292056, "num_agent_steps_sampled": 28266, "num_agent_steps_trained": 292056, "last_target_update_ts": 9422, "num_target_updates": 1132}, "done": false, "episodes_total": 0, "training_iteration": 79, "trial_id": "db258_00000", "date": "2023-11-16_21-50-11", "timestamp": 1700200211, "time_this_iter_s": 1.5491890907287598, "time_total_s": 123.17903351783752, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 123.17903351783752, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 62.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073013305664062, "actor_loss": -22.935319900512695, "critic_loss": 0.09544724225997925, "alpha_loss": -3.466963291168213, "alpha_value": 0.7087990045547485, "log_alpha_value": -0.3441833257675171, "target_entropy": -6.0, "policy_t": -0.02493131160736084, "mean_q": 20.119495391845703, "max_q": 20.556434631347656, "min_q": 19.72567367553711}, "td_error": [0.8615379333496094, 1.3918075561523438, 0.9103155136108398, 1.1603593826293945, 0.4717569351196289, 0.1272106170654297, 1.1207618713378906, 0.7314720153808594, 1.9898529052734375, 1.5253162384033203, 0.6815824508666992, 0.6875267028808594, 0.7815532684326172, 2.0453786849975586, 1.9059467315673828, 0.31601619720458984, 1.8675613403320312, 0.890986442565918, 0.9024982452392578, 0.9154758453369141, 1.2010822296142578, 1.304281234741211, 2.4071550369262695, 1.5433759689331055, 0.5524797439575195, 1.0491580963134766, 0.8246984481811523, 0.022312164306640625, 2.6712656021118164, 0.7806339263916016, 1.5364398956298828, 0.3007698059082031, 1.2864322662353516, 0.16935253143310547, 2.249723434448242, 0.7813882827758789, 0.05410003662109375, 1.6319522857666016, 2.0742015838623047, 1.4323158264160156, 0.06499004364013672, 1.8316583633422852, 1.313955307006836, 0.5723648071289062, 3.1599903106689453, 0.5601968765258789, 0.05436897277832031, 0.22069931030273438, 1.4698619842529297, 1.1222972869873047, 1.5018882751464844, 1.8759851455688477, 2.1009645462036133, 1.3301305770874023, 0.30460357666015625, 0.5272369384765625, 1.8012285232543945, 1.6806650161743164, 1.0645027160644531, 0.2309408187866211, 0.9779691696166992, 0.40533447265625, 1.6269454956054688, 1.6670246124267578, 0.9434938430786133, 0.3543548583984375, 1.3387422561645508, 0.7286348342895508, 2.3029088973999023, 0.8407497406005859, 1.7406654357910156, 0.9468669891357422, 1.005537986755371, 0.2592897415161133, 0.15325260162353516, 0.8599939346313477, 0.44710826873779297, 0.5085649490356445, 0.7492961883544922, 1.761331558227539, 0.5402011871337891, 1.4586906433105469, 0.30304718017578125, 1.034341812133789, 1.9645652770996094, 0.08389568328857422], "mean_td_error": 1.0808066129684448, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1147.0, "diff_num_grad_updates_vs_sampler_policy": 1146.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035249710083008, "actor_loss": -14.962342262268066, "critic_loss": 0.10454736649990082, "alpha_loss": -3.452460289001465, "alpha_value": 0.7089053392410278, "log_alpha_value": -0.34403330087661743, "target_entropy": -6.0, "policy_t": -0.046375375241041183, "mean_q": 12.12583065032959, "max_q": 12.5157470703125, "min_q": 11.776056289672852}, "td_error": [0.16005516052246094, 1.2103562355041504, 0.8039760589599609, 1.848775863647461, 1.8726425170898438, 0.30197620391845703, 1.124384880065918, 1.4584007263183594, 0.7761116027832031, 0.12160444259643555, 0.14484024047851562, 1.0883936882019043, 0.573676586151123, 1.8705525398254395, 1.990738868713379, 1.2283716201782227, 0.6621227264404297, 0.05046367645263672, 1.5137724876403809, 1.606898307800293, 1.794295310974121, 1.185452938079834, 1.3095664978027344, 0.6510000228881836, 2.578514575958252, 1.557436466217041, 1.4753923416137695, 0.5893898010253906, 0.6131162643432617, 1.1745710372924805, 1.83673095703125, 0.2583894729614258, 1.7031731605529785, 0.43385791778564453, 1.1830878257751465, 1.1151351928710938, 0.6458477973937988, 0.5084400177001953, 1.3625297546386719, 1.3110876083374023, 0.649559497833252, 0.12274408340454102, 1.415177345275879, 0.5459723472595215, 0.08957481384277344, 1.0465731620788574, 1.211555004119873, 0.47089099884033203, 0.48388051986694336, 0.18914461135864258, 1.516942024230957, 1.9727516174316406, 0.36610889434814453, 1.341968059539795, 1.782465934753418, 1.0256009101867676, 0.680931568145752, 0.21940183639526367, 1.6035480499267578, 1.876112937927246, 0.42987918853759766, 0.616612434387207, 2.9227757453918457, 1.3494977951049805, 2.8225812911987305, 0.9888467788696289, 0.7732405662536621, 0.02919769287109375, 0.8098649978637695, 0.9509878158569336, 1.0627107620239258, 0.7641968727111816, 1.4449739456176758, 1.4862747192382812, 0.42618608474731445, 0.8563022613525391, 0.3781313896179199, 1.917109489440918, 0.6435308456420898, 2.706831455230713, 1.235792636871338, 2.3139100074768066, 0.7438111305236816, 0.4750218391418457, 0.557945728302002, 0.5482840538024902], "mean_td_error": 1.0646573305130005, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1147.0, "diff_num_grad_updates_vs_sampler_policy": 1146.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0829496383667, "actor_loss": -14.76061725616455, "critic_loss": 0.1453116238117218, "alpha_loss": -3.4686241149902344, "alpha_value": 0.7089226841926575, "log_alpha_value": -0.34400883316993713, "target_entropy": -6.0, "policy_t": -0.01638645865023136, "mean_q": 11.895623207092285, "max_q": 12.409305572509766, "min_q": 11.237771987915039}, "td_error": [1.0945258140563965, 2.7392187118530273, 1.5613746643066406, 0.2300405502319336, 1.148918628692627, 0.526249885559082, 0.19614171981811523, 0.10857868194580078, 0.7489948272705078, 2.176553726196289, 0.5529880523681641, 0.9853978157043457, 0.6804990768432617, 2.3853759765625, 1.060009479522705, 0.5949597358703613, 1.0545449256896973, 0.8615846633911133, 0.8373661041259766, 0.12718772888183594, 0.5577917098999023, 1.0687522888183594, 0.9556574821472168, 0.47696685791015625, 1.0834722518920898, 1.8411884307861328, 1.5537233352661133, 0.7222838401794434, 0.9352250099182129, 1.0446796417236328, 0.6297903060913086, 1.0026168823242188, 1.949307918548584, 1.8065848350524902, 0.6930241584777832, 1.4440021514892578, 0.5713014602661133, 0.34064769744873047, 1.9923896789550781, 0.4780387878417969, 0.929448127746582, 0.3469867706298828, 1.0951409339904785, 1.1331005096435547, 0.37212705612182617, 0.06223726272583008, 2.213583469390869, 1.9587726593017578, 0.566624641418457, 0.2988924980163574, 0.5471372604370117, 1.0096135139465332, 1.581784725189209, 1.0451345443725586, 0.2030315399169922, 1.5670151710510254, 2.0361533164978027, 1.2002148628234863, 1.8701214790344238, 2.1364479064941406, 0.17290115356445312, 0.3975706100463867, 1.3263797760009766, 1.1601605415344238, 1.876999855041504, 0.8842911720275879, 1.2380523681640625, 1.6607422828674316, 0.8328442573547363, 1.7101788520812988, 0.8598074913024902, 1.1765804290771484, 1.5139923095703125, 0.9461207389831543, 2.952061653137207, 1.381324291229248, 0.7242183685302734, 1.1428890228271484, 0.28749942779541016, 0.9821834564208984, 1.1115188598632812, 0.21816062927246094, 1.3704285621643066, 2.8928141593933105, 2.253744602203369, 1.1894631385803223], "mean_td_error": 1.1076099872589111, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1147.0, "diff_num_grad_updates_vs_sampler_policy": 1146.0}}, "num_env_steps_sampled": 9527, "num_env_steps_trained": 295926, "num_agent_steps_sampled": 28581, "num_agent_steps_trained": 295926, "last_target_update_ts": 9527, "num_target_updates": 1147}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28581, "num_agent_steps_trained": 295926, "num_env_steps_sampled": 9527, "num_env_steps_trained": 295926, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 58.954517671419154, "num_env_steps_trained_throughput_per_sec": 2172.895079889449, "timesteps_total": 9527, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 28581, "timers": {"training_iteration_time_ms": 126.305, "sample_time_ms": 18.574, "load_time_ms": 0.315, "load_throughput": 818927.223, "learn_time_ms": 18.865, "learn_throughput": 13676.283, "synch_weights_time_ms": 12.996}, "counters": {"num_env_steps_sampled": 9527, "num_env_steps_trained": 295926, "num_agent_steps_sampled": 28581, "num_agent_steps_trained": 295926, "last_target_update_ts": 9527, "num_target_updates": 1147}, "done": false, "episodes_total": 0, "training_iteration": 80, "trial_id": "db258_00000", "date": "2023-11-16_21-50-12", "timestamp": 1700200212, "time_this_iter_s": 1.7916557788848877, "time_total_s": 124.97068929672241, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 124.97068929672241, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 39.15, "ram_util_percent": 62.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.098081588745117, "actor_loss": -23.044214248657227, "critic_loss": 0.08987264335155487, "alpha_loss": -3.5211384296417236, "alpha_value": 0.705609142780304, "log_alpha_value": -0.3486937880516052, "target_entropy": -6.0, "policy_t": 0.029095709323883057, "mean_q": 20.244016647338867, "max_q": 20.72168731689453, "min_q": 19.786376953125}, "td_error": [0.8803596496582031, 1.062178611755371, 0.3831520080566406, 0.704747200012207, 0.6851682662963867, 1.6476860046386719, 1.5712013244628906, 0.5297975540161133, 0.7847042083740234, 0.25413990020751953, 2.541659355163574, 0.6623058319091797, 0.6524782180786133, 1.9677038192749023, 2.503268241882324, 0.5631694793701172, 1.9097633361816406, 0.4425983428955078, 1.387216567993164, 0.9262962341308594, 1.5822420120239258, 0.8281240463256836, 0.3493051528930664, 0.6512508392333984, 0.4412574768066406, 0.7355499267578125, 0.8608856201171875, 0.13068771362304688, 0.44812965393066406, 0.7196168899536133, 1.1586713790893555, 1.4779510498046875, 0.517329216003418, 2.059056282043457, 0.5399541854858398, 0.4272756576538086, 1.5309839248657227, 0.9940147399902344, 2.272848129272461, 0.9429025650024414, 2.6889286041259766, 0.2283334732055664, 0.2981538772583008, 1.1420373916625977, 3.465937614440918, 1.2142305374145508, 0.8648672103881836, 2.283365249633789, 0.8892641067504883, 0.5337285995483398, 1.0583362579345703, 0.22453880310058594, 1.378260612487793, 0.25615596771240234, 1.6393356323242188, 0.30834293365478516, 0.8589544296264648, 1.202718734741211, 0.48068714141845703, 0.3837013244628906, 0.23179244995117188, 1.5365362167358398, 0.4327249526977539, 1.8872289657592773, 2.714090347290039, 0.45361328125, 0.18750953674316406, 1.299072265625, 0.41452503204345703, 1.4349746704101562, 0.4012298583984375, 0.24367523193359375, 2.026531219482422, 0.717987060546875, 0.45560455322265625, 0.8787288665771484, 1.478703498840332, 2.068467140197754, 1.0144596099853516, 1.616424560546875, 0.32415771484375, 0.058330535888671875, 1.3742027282714844, 0.17048358917236328, 1.5811386108398438, 0.729304313659668], "mean_td_error": 1.0216163396835327, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1162.0, "diff_num_grad_updates_vs_sampler_policy": 1161.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067880630493164, "actor_loss": -14.691184997558594, "critic_loss": 0.10256082564592361, "alpha_loss": -3.509018659591675, "alpha_value": 0.7057205438613892, "log_alpha_value": -0.3485359847545624, "target_entropy": -6.0, "policy_t": -0.014969291165471077, "mean_q": 11.857995986938477, "max_q": 12.12429428100586, "min_q": 11.545011520385742}, "td_error": [1.7667174339294434, 1.0850558280944824, 0.28049516677856445, 1.7184171676635742, 0.7322664260864258, 0.06013059616088867, 2.1941728591918945, 0.3837904930114746, 0.6275296211242676, 1.474754810333252, 1.3991422653198242, 1.4010958671569824, 2.8565263748168945, 2.380251884460449, 0.15599775314331055, 1.4322667121887207, 0.8257961273193359, 0.04883384704589844, 0.07173824310302734, 1.2950072288513184, 2.066103935241699, 1.6360340118408203, 1.4296202659606934, 0.8837242126464844, 0.07074308395385742, 2.425457000732422, 1.3078546524047852, 1.1542415618896484, 0.4535245895385742, 1.118542194366455, 0.8775782585144043, 0.8102822303771973, 0.32885122299194336, 0.22942876815795898, 0.9630274772644043, 0.05887460708618164, 0.6389288902282715, 1.4315824508666992, 0.29607105255126953, 0.5334548950195312, 0.721623420715332, 1.276257038116455, 0.6680922508239746, 0.4904813766479492, 3.6728296279907227, 1.29158353805542, 1.3625097274780273, 0.34253835678100586, 4.7784929275512695, 0.17032861709594727, 0.3912935256958008, 0.1698298454284668, 0.12582826614379883, 0.6845335960388184, 0.7795586585998535, 0.8548622131347656, 2.875676155090332, 0.8453712463378906, 0.8616900444030762, 1.0802736282348633, 0.9091596603393555, 0.6726083755493164, 0.4803466796875, 0.2784242630004883, 1.051426887512207, 1.464460849761963, 0.4821186065673828, 1.0629329681396484, 1.2800426483154297, 0.24941253662109375, 1.1510095596313477, 0.4276576042175293, 2.544447898864746, 2.0020313262939453, 0.8380498886108398, 0.7791018486022949, 1.6393218040466309, 0.6588773727416992, 0.4437236785888672, 0.8844103813171387, 0.30438947677612305, 1.8977580070495605, 1.5907588005065918, 0.08346748352050781, 2.624307632446289, 1.184767246246338], "mean_td_error": 1.0620067119598389, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1162.0, "diff_num_grad_updates_vs_sampler_policy": 1161.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.179532051086426, "actor_loss": -14.981401443481445, "critic_loss": 0.14206600189208984, "alpha_loss": -3.5476691722869873, "alpha_value": 0.7057388424873352, "log_alpha_value": -0.3485100269317627, "target_entropy": -6.0, "policy_t": 0.005308591295033693, "mean_q": 12.079127311706543, "max_q": 12.528268814086914, "min_q": 11.764791488647461}, "td_error": [1.508176326751709, 1.5298748016357422, 1.0767998695373535, 1.1255121231079102, 0.4036135673522949, 1.2581439018249512, 1.400960922241211, 0.2515249252319336, 1.1718788146972656, 1.622878074645996, 0.5769968032836914, 2.0914430618286133, 0.07930326461791992, 2.989778995513916, 1.1365280151367188, 1.918506145477295, 0.38627052307128906, 0.43442249298095703, 0.2554798126220703, 0.10352945327758789, 0.6462383270263672, 0.4266958236694336, 0.09332990646362305, 1.395167350769043, 1.8391327857971191, 1.2449989318847656, 0.04279756546020508, 1.661977767944336, 1.471573829650879, 0.46700382232666016, 1.6104321479797363, 1.1338043212890625, 2.0875954627990723, 0.7205600738525391, 2.2820358276367188, 0.3314228057861328, 1.2340364456176758, 0.5629892349243164, 3.132185459136963, 1.6151208877563477, 1.0436344146728516, 0.9062247276306152, 1.2214303016662598, 1.848337173461914, 2.110713005065918, 0.850792407989502, 0.47013378143310547, 3.5411434173583984, 1.7697858810424805, 1.0016136169433594, 0.1425766944885254, 1.9361310005187988, 0.9306435585021973, 0.6548514366149902, 0.9944047927856445, 1.4667749404907227, 0.5862469673156738, 0.39417314529418945, 1.6589069366455078, 0.7175555229187012, 1.5845584869384766, 1.4877142906188965, 0.9487457275390625, 0.8196525573730469, 0.9149093627929688, 0.35546350479125977, 0.3154463768005371, 0.7475290298461914, 1.2579283714294434, 2.097048282623291, 0.5953989028930664, 0.8394002914428711, 1.2856874465942383, 0.24996709823608398, 0.6923990249633789, 0.37841367721557617, 0.5464382171630859, 1.1415314674377441, 0.8738069534301758, 0.7823820114135742, 0.27686119079589844, 1.2888712882995605, 0.7183775901794434, 1.2086682319641113, 1.387000560760498, 0.8315062522888184], "mean_td_error": 1.0836337804794312, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1162.0, "diff_num_grad_updates_vs_sampler_policy": 1161.0}}, "num_env_steps_sampled": 9632, "num_env_steps_trained": 299796, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 299796, "last_target_update_ts": 9632, "num_target_updates": 1162}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 299796, "num_env_steps_sampled": 9632, "num_env_steps_trained": 299796, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 65.63409953805956, "num_env_steps_trained_throughput_per_sec": 2419.0853829741955, "timesteps_total": 9632, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 105.021, "sample_time_ms": 16.718, "load_time_ms": 0.309, "load_throughput": 834526.438, "learn_time_ms": 18.436, "learn_throughput": 13994.23, "synch_weights_time_ms": 10.386}, "counters": {"num_env_steps_sampled": 9632, "num_env_steps_trained": 299796, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 299796, "last_target_update_ts": 9632, "num_target_updates": 1162}, "done": false, "episodes_total": 0, "training_iteration": 81, "trial_id": "db258_00000", "date": "2023-11-16_21-50-14", "timestamp": 1700200214, "time_this_iter_s": 1.6085240840911865, "time_total_s": 126.5792133808136, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 126.5792133808136, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 51.03333333333333, "ram_util_percent": 63.166666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10050106048584, "actor_loss": -23.390989303588867, "critic_loss": 0.10196752846240997, "alpha_loss": -3.5675201416015625, "alpha_value": 0.7024350762367249, "log_alpha_value": -0.35320228338241577, "target_entropy": -6.0, "policy_t": 0.0017321351915597916, "mean_q": 20.579496383666992, "max_q": 20.975513458251953, "min_q": 20.158676147460938}, "td_error": [0.1977081298828125, 0.4445781707763672, 1.1747722625732422, 1.7602148056030273, 1.218170166015625, 1.2372989654541016, 1.717759132385254, 0.3350362777709961, 1.1377935409545898, 2.0358829498291016, 0.6092281341552734, 2.191556930541992, 2.182436943054199, 1.3881940841674805, 1.7809944152832031, 1.4986066818237305, 1.0163240432739258, 2.24613094329834, 0.8158855438232422, 2.520143508911133, 2.050847053527832, 0.8300018310546875, 1.1208562850952148, 1.2220706939697266, 0.2888469696044922, 0.6188421249389648, 1.2184724807739258, 0.680720329284668, 0.12182331085205078, 1.0149974822998047, 0.6682138442993164, 0.23899173736572266, 1.3536968231201172, 2.5389795303344727, 0.7902202606201172, 0.5193872451782227, 0.8728160858154297, 1.0532655715942383, 0.8932723999023438, 1.569894790649414, 1.2786540985107422, 0.501887321472168, 0.2903108596801758, 0.6028509140014648, 0.2729835510253906, 1.7964982986450195, 1.4387273788452148, 1.9872550964355469, 1.1326732635498047, 0.045841217041015625, 0.6223430633544922, 1.090963363647461, 1.7234697341918945, 0.7719087600708008, 0.5198831558227539, 1.9253005981445312, 2.889598846435547, 0.9431858062744141, 1.48785400390625, 0.5070438385009766, 0.22617244720458984, 1.0586299896240234, 1.502004623413086, 1.0666275024414062, 0.1251983642578125, 1.9281206130981445, 2.9221420288085938, 0.8713817596435547, 0.5637092590332031, 1.6073760986328125, 0.5597915649414062, 0.7289295196533203, 1.9928054809570312, 0.9547290802001953, 0.9105377197265625, 2.126596450805664, 0.7839212417602539, 0.1516590118408203, 1.5608901977539062, 0.3567771911621094, 0.8694591522216797, 0.2888460159301758, 0.7937822341918945, 1.636662483215332, 1.577500343322754, 1.1994314193725586], "mean_td_error": 1.1321842670440674, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1177.0, "diff_num_grad_updates_vs_sampler_policy": 1176.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090673446655273, "actor_loss": -14.842302322387695, "critic_loss": 0.091387540102005, "alpha_loss": -3.562427520751953, "alpha_value": 0.7025479674339294, "log_alpha_value": -0.3530416190624237, "target_entropy": -6.0, "policy_t": -0.01508466899394989, "mean_q": 12.01627254486084, "max_q": 12.334057807922363, "min_q": 11.756536483764648}, "td_error": [1.2564282417297363, 0.3394746780395508, 0.2314462661743164, 0.7998771667480469, 0.6719284057617188, 2.0378904342651367, 0.9435648918151855, 1.340949535369873, 2.0411057472229004, 0.9789166450500488, 0.6221585273742676, 0.4785900115966797, 0.12891483306884766, 1.6723971366882324, 1.7232003211975098, 2.451937198638916, 1.3303766250610352, 0.10987997055053711, 0.8086414337158203, 1.3540215492248535, 0.30864524841308594, 1.0062241554260254, 0.18595027923583984, 0.45699071884155273, 1.2877388000488281, 0.7089600563049316, 2.2760305404663086, 0.5207948684692383, 1.0787582397460938, 1.7179069519042969, 1.0300664901733398, 1.1318254470825195, 0.9563674926757812, 0.46868133544921875, 0.3982357978820801, 1.485865592956543, 0.8712978363037109, 1.5481500625610352, 0.8428792953491211, 1.3806195259094238, 1.0514178276062012, 0.988245964050293, 0.6074414253234863, 0.5978689193725586, 1.6264629364013672, 1.4007511138916016, 0.8833661079406738, 0.7021217346191406, 1.1287436485290527, 0.38820600509643555, 0.9330463409423828, 1.2785320281982422, 0.6710028648376465, 0.6798100471496582, 1.0871868133544922, 0.6416358947753906, 2.8791017532348633, 0.0724334716796875, 0.5426759719848633, 1.6962099075317383, 0.27338218688964844, 0.5777440071105957, 0.6636667251586914, 1.6284756660461426, 0.1918182373046875, 0.036562442779541016, 0.3667736053466797, 2.8650245666503906, 2.1358208656311035, 0.765167236328125, 0.029521942138671875, 1.2969627380371094, 0.4406623840332031, 0.9689545631408691, 0.5600481033325195, 0.6572208404541016, 0.7226419448852539, 0.8639650344848633, 0.20084428787231445, 0.9055709838867188, 0.7759389877319336, 0.6089239120483398, 1.4614129066467285, 0.8427629470825195, 0.6759781837463379, 2.319579601287842], "mean_td_error": 0.9729694128036499, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1177.0, "diff_num_grad_updates_vs_sampler_policy": 1176.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.178620338439941, "actor_loss": -14.8998441696167, "critic_loss": 0.11950545012950897, "alpha_loss": -3.593141794204712, "alpha_value": 0.7025710940361023, "log_alpha_value": -0.3530087172985077, "target_entropy": -6.0, "policy_t": -0.015488837845623493, "mean_q": 12.009109497070312, "max_q": 12.295442581176758, "min_q": 11.636210441589355}, "td_error": [0.26606178283691406, 1.758103370666504, 1.453150749206543, 0.4906797409057617, 1.7324752807617188, 0.3610715866088867, 0.2292938232421875, 0.3008699417114258, 1.2825689315795898, 0.689176082611084, 1.202296257019043, 2.6397085189819336, 0.09468841552734375, 0.2962508201599121, 0.932525634765625, 2.0605978965759277, 0.6744852066040039, 0.2986125946044922, 1.7761940956115723, 1.6337556838989258, 2.4384641647338867, 0.4445176124572754, 1.8853435516357422, 0.41104698181152344, 0.8371458053588867, 0.7600088119506836, 0.4767017364501953, 2.080082416534424, 1.9316611289978027, 2.271611213684082, 0.25932836532592773, 0.5963211059570312, 0.5398120880126953, 1.1523094177246094, 0.4499959945678711, 0.9139013290405273, 0.6167616844177246, 0.5736818313598633, 0.5849785804748535, 0.9938774108886719, 1.375596046447754, 1.0516605377197266, 1.042802333831787, 0.37610816955566406, 0.8165421485900879, 0.4543933868408203, 1.4922380447387695, 1.4423017501831055, 0.26484155654907227, 0.46579551696777344, 1.3818473815917969, 0.757166862487793, 1.0305023193359375, 0.07443952560424805, 1.5886077880859375, 0.10288476943969727, 1.0306711196899414, 1.83797025680542, 2.1289615631103516, 0.7561426162719727, 0.6862249374389648, 1.050058364868164, 0.2507328987121582, 0.6548418998718262, 0.043453216552734375, 1.942246913909912, 1.8294496536254883, 1.5402212142944336, 0.412325382232666, 1.239729881286621, 0.08601856231689453, 0.3486342430114746, 1.2662339210510254, 0.29461097717285156, 0.8493356704711914, 0.19193124771118164, 0.6399765014648438, 1.544736385345459, 0.6356391906738281, 0.3515596389770508, 0.7307581901550293, 1.1074929237365723, 0.8611555099487305, 1.8422355651855469, 0.11893844604492188, 1.1805052757263184], "mean_td_error": 0.9483795166015625, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1177.0, "diff_num_grad_updates_vs_sampler_policy": 1176.0}}, "num_env_steps_sampled": 9737, "num_env_steps_trained": 303666, "num_agent_steps_sampled": 29211, "num_agent_steps_trained": 303666, "last_target_update_ts": 9737, "num_target_updates": 1177}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29211, "num_agent_steps_trained": 303666, "num_env_steps_sampled": 9737, "num_env_steps_trained": 303666, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.55726926240484, "num_env_steps_trained_throughput_per_sec": 2489.9679242429215, "timesteps_total": 9737, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 29211, "timers": {"training_iteration_time_ms": 104.275, "sample_time_ms": 16.45, "load_time_ms": 0.315, "load_throughput": 820292.929, "learn_time_ms": 17.777, "learn_throughput": 14512.851, "synch_weights_time_ms": 10.734}, "counters": {"num_env_steps_sampled": 9737, "num_env_steps_trained": 303666, "num_agent_steps_sampled": 29211, "num_agent_steps_trained": 303666, "last_target_update_ts": 9737, "num_target_updates": 1177}, "done": false, "episodes_total": 0, "training_iteration": 82, "trial_id": "db258_00000", "date": "2023-11-16_21-50-16", "timestamp": 1700200216, "time_this_iter_s": 1.5617129802703857, "time_total_s": 128.14092636108398, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 128.14092636108398, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 33.650000000000006, "ram_util_percent": 63.099999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062912940979004, "actor_loss": -23.362140655517578, "critic_loss": 0.10017846524715424, "alpha_loss": -3.5996384620666504, "alpha_value": 0.6992734670639038, "log_alpha_value": -0.35771337151527405, "target_entropy": -6.0, "policy_t": 0.029219238087534904, "mean_q": 20.584566116333008, "max_q": 20.996036529541016, "min_q": 20.334552764892578}, "td_error": [0.239501953125, 1.290994644165039, 0.26127052307128906, 1.081130027770996, 0.14055156707763672, 1.3286018371582031, 2.5370216369628906, 0.2518119812011719, 2.2972259521484375, 0.8752708435058594, 0.7861824035644531, 0.6359767913818359, 1.0646343231201172, 0.11392402648925781, 2.3918819427490234, 1.2750167846679688, 0.36882591247558594, 0.41199684143066406, 0.8580513000488281, 1.3935508728027344, 2.275942802429199, 0.7244596481323242, 1.1359806060791016, 1.0722980499267578, 1.6110944747924805, 0.21801376342773438, 0.7912940979003906, 1.5675992965698242, 1.6742019653320312, 1.2269706726074219, 0.9816722869873047, 2.2790918350219727, 1.9721717834472656, 0.6550731658935547, 0.531463623046875, 1.185185432434082, 0.8257818222045898, 1.225895881652832, 0.5892114639282227, 1.4142436981201172, 1.375234603881836, 1.1872215270996094, 2.1201276779174805, 0.6407337188720703, 0.40857982635498047, 2.450139045715332, 0.8944978713989258, 1.6218032836914062, 0.8819990158081055, 1.503072738647461, 1.1787424087524414, 3.183992385864258, 0.5468521118164062, 2.195375442504883, 0.972503662109375, 1.8334646224975586, 0.6387395858764648, 1.7898788452148438, 0.1553936004638672, 2.2380428314208984, 1.0444459915161133, 0.9201450347900391, 0.8670587539672852, 0.6375150680541992, 1.6752405166625977, 0.5532293319702148, 1.3889007568359375, 0.717747688293457, 0.9189538955688477, 0.7406530380249023, 0.24680423736572266, 0.4083566665649414, 2.121614456176758, 0.6668167114257812, 1.1298160552978516, 0.40834617614746094, 0.15990352630615234, 1.4819412231445312, 1.7754325866699219, 0.7364997863769531, 1.4897308349609375, 0.3293495178222656, 1.483555793762207, 1.4280033111572266, 1.9090280532836914, 0.6299943923950195], "mean_td_error": 1.130773901939392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1192.0, "diff_num_grad_updates_vs_sampler_policy": 1191.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065768241882324, "actor_loss": -14.871668815612793, "critic_loss": 0.09281282126903534, "alpha_loss": -3.598940134048462, "alpha_value": 0.6993929743766785, "log_alpha_value": -0.357542484998703, "target_entropy": -6.0, "policy_t": 0.04924613982439041, "mean_q": 12.04272174835205, "max_q": 12.360105514526367, "min_q": 11.627486228942871}, "td_error": [0.8591799736022949, 1.3050098419189453, 0.962803840637207, 1.6148180961608887, 1.690507411956787, 0.06221580505371094, 0.5855183601379395, 0.08500146865844727, 1.648055076599121, 0.7185215950012207, 2.10603666305542, 0.4476194381713867, 1.4508557319641113, 0.8667292594909668, 0.7559871673583984, 0.3092021942138672, 2.103868007659912, 0.9460291862487793, 1.747344970703125, 1.8618073463439941, 0.9626173973083496, 1.206265926361084, 0.17503738403320312, 1.2464146614074707, 0.22408676147460938, 0.3033876419067383, 1.6406784057617188, 2.0656375885009766, 1.3189654350280762, 1.3067269325256348, 1.4808616638183594, 1.9536457061767578, 1.040283203125, 1.0653200149536133, 1.2285890579223633, 0.28630638122558594, 1.219141960144043, 1.349581241607666, 1.2381019592285156, 0.6108908653259277, 1.3902735710144043, 1.3738532066345215, 0.3209242820739746, 0.40376901626586914, 0.06415128707885742, 0.5067839622497559, 1.07936429977417, 0.038433074951171875, 1.4285049438476562, 1.259023666381836, 0.10238409042358398, 0.24657869338989258, 1.250251293182373, 0.44974374771118164, 0.5240120887756348, 1.1715140342712402, 0.4988594055175781, 0.9435925483703613, 0.5765366554260254, 0.35782814025878906, 0.13601160049438477, 0.6808438301086426, 0.9531922340393066, 0.9550704956054688, 0.6813144683837891, 0.5938248634338379, 1.9804601669311523, 2.964855194091797, 1.0606694221496582, 1.5792646408081055, 0.38681888580322266, 1.738032341003418, 1.2281503677368164, 0.29437875747680664, 2.2630815505981445, 1.3019094467163086, 0.7072305679321289, 0.9167232513427734, 0.4255356788635254, 1.4951677322387695, 0.14772796630859375, 1.50974702835083, 0.6271119117736816, 0.46569204330444336, 0.28505611419677734, 0.7006912231445312], "mean_td_error": 0.978076696395874, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1192.0, "diff_num_grad_updates_vs_sampler_policy": 1191.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081426620483398, "actor_loss": -15.031195640563965, "critic_loss": 0.1461964100599289, "alpha_loss": -3.6042184829711914, "alpha_value": 0.6994151473045349, "log_alpha_value": -0.3575107753276825, "target_entropy": -6.0, "policy_t": 0.011248971335589886, "mean_q": 12.214728355407715, "max_q": 12.577545166015625, "min_q": 11.793890953063965}, "td_error": [0.8414440155029297, 1.5550570487976074, 1.6065678596496582, 1.312002182006836, 1.5885848999023438, 1.9068584442138672, 0.11536216735839844, 1.0398921966552734, 0.8389129638671875, 0.2867269515991211, 1.7685637474060059, 1.1025915145874023, 1.4769749641418457, 1.5267696380615234, 0.6604199409484863, 1.2355141639709473, 0.22519826889038086, 0.7152032852172852, 1.4623522758483887, 0.9316239356994629, 0.489138126373291, 1.042281150817871, 0.9811077117919922, 2.450427532196045, 1.3803839683532715, 1.5949339866638184, 0.0722036361694336, 0.9747982025146484, 1.6376304626464844, 2.559272289276123, 0.1648554801940918, 2.191373825073242, 0.6268625259399414, 0.9464859962463379, 0.22308874130249023, 0.7140960693359375, 1.320404052734375, 0.20242786407470703, 0.8410153388977051, 1.0618209838867188, 0.176239013671875, 1.296806812286377, 1.0669293403625488, 1.0105476379394531, 1.8663935661315918, 2.654050827026367, 2.5799479484558105, 1.6012840270996094, 1.3859338760375977, 0.09356975555419922, 1.080312728881836, 1.8487401008605957, 0.17956066131591797, 0.990424633026123, 1.725684642791748, 0.10688591003417969, 2.086207866668701, 2.178086280822754, 1.1437273025512695, 0.7314629554748535, 0.978670597076416, 1.7071442604064941, 0.6127848625183105, 0.7486777305603027, 1.4563484191894531, 1.0910425186157227, 0.8943662643432617, 0.4433307647705078, 0.8960180282592773, 0.26766395568847656, 0.21136856079101562, 1.9883403778076172, 0.6193814277648926, 0.030970096588134766, 1.1447505950927734, 2.133111000061035, 0.9289712905883789, 1.6058521270751953, 2.4800758361816406, 1.9326043128967285, 0.60919189453125, 0.18077850341796875, 0.5213236808776855, 0.7814369201660156, 0.7667074203491211, 0.2709517478942871], "mean_td_error": 1.1020451784133911, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1192.0, "diff_num_grad_updates_vs_sampler_policy": 1191.0}}, "num_env_steps_sampled": 9842, "num_env_steps_trained": 307536, "num_agent_steps_sampled": 29526, "num_agent_steps_trained": 307536, "last_target_update_ts": 9842, "num_target_updates": 1192}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29526, "num_agent_steps_trained": 307536, "num_env_steps_sampled": 9842, "num_env_steps_trained": 307536, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.15879506175897, "num_env_steps_trained_throughput_per_sec": 2512.1384465619735, "timesteps_total": 9842, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 29526, "timers": {"training_iteration_time_ms": 103.215, "sample_time_ms": 16.75, "load_time_ms": 0.304, "load_throughput": 848131.07, "learn_time_ms": 18.228, "learn_throughput": 14154.192, "synch_weights_time_ms": 10.863}, "counters": {"num_env_steps_sampled": 9842, "num_env_steps_trained": 307536, "num_agent_steps_sampled": 29526, "num_agent_steps_trained": 307536, "last_target_update_ts": 9842, "num_target_updates": 1192}, "done": false, "episodes_total": 0, "training_iteration": 83, "trial_id": "db258_00000", "date": "2023-11-16_21-50-17", "timestamp": 1700200217, "time_this_iter_s": 1.5490922927856445, "time_total_s": 129.69001865386963, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 129.69001865386963, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 44.5, "ram_util_percent": 63.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099696159362793, "actor_loss": -23.60222625732422, "critic_loss": 0.09324003756046295, "alpha_loss": -3.6583991050720215, "alpha_value": 0.6961232423782349, "log_alpha_value": -0.3622286021709442, "target_entropy": -6.0, "policy_t": -0.031665507704019547, "mean_q": 20.815155029296875, "max_q": 21.469560623168945, "min_q": 20.26313018798828}, "td_error": [0.9928112030029297, 0.8441867828369141, 1.5158662796020508, 0.8279104232788086, 2.606260299682617, 1.5042438507080078, 1.4760456085205078, 1.9130535125732422, 0.3507375717163086, 1.963897705078125, 0.8256969451904297, 0.7215251922607422, 0.8848056793212891, 0.6849508285522461, 0.8746614456176758, 0.8134880065917969, 1.9502849578857422, 0.018645286560058594, 1.5379467010498047, 1.4795761108398438, 0.0825967788696289, 1.3515396118164062, 0.26133060455322266, 1.3493318557739258, 0.8971328735351562, 0.5680990219116211, 1.9526357650756836, 1.0486936569213867, 0.9200944900512695, 1.9773025512695312, 2.4787206649780273, 0.3048381805419922, 0.49510955810546875, 1.0593805313110352, 0.9434843063354492, 0.22018814086914062, 0.5198640823364258, 1.169729232788086, 1.9004507064819336, 0.14813232421875, 1.8211002349853516, 0.9747190475463867, 0.6549530029296875, 2.2390480041503906, 0.6196670532226562, 0.4581727981567383, 0.5138673782348633, 0.5206546783447266, 2.4893970489501953, 0.33304500579833984, 0.07061767578125, 1.0192270278930664, 0.42845726013183594, 1.4835271835327148, 0.5499153137207031, 0.42321014404296875, 0.33031654357910156, 0.14698219299316406, 0.8069925308227539, 2.094207763671875, 2.306473731994629, 0.2674894332885742, 0.4770660400390625, 2.9772682189941406, 0.8128767013549805, 1.7918262481689453, 0.7185516357421875, 0.30358219146728516, 2.9906482696533203, 1.0878362655639648, 1.1690521240234375, 1.497797966003418, 1.0480079650878906, 0.48253822326660156, 1.9324684143066406, 1.382843017578125, 0.6345882415771484, 0.31314849853515625, 1.2688255310058594, 0.6673002243041992, 0.6837348937988281, 0.4914989471435547, 0.13902854919433594, 1.2766704559326172, 1.5008020401000977, 0.11763763427734375], "mean_td_error": 1.0436382293701172, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1207.0, "diff_num_grad_updates_vs_sampler_policy": 1206.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074023246765137, "actor_loss": -15.055411338806152, "critic_loss": 0.10054774582386017, "alpha_loss": -3.6472511291503906, "alpha_value": 0.6962509155273438, "log_alpha_value": -0.36204516887664795, "target_entropy": -6.0, "policy_t": -0.009501881897449493, "mean_q": 12.236806869506836, "max_q": 12.605639457702637, "min_q": 11.884323120117188}, "td_error": [0.3062705993652344, 1.8431024551391602, 1.166954517364502, 0.829681396484375, 0.5382246971130371, 1.3949522972106934, 0.39884519577026367, 0.19068622589111328, 0.7592697143554688, 0.6877565383911133, 2.4314351081848145, 0.512847900390625, 0.6388392448425293, 1.2671985626220703, 1.5055880546569824, 0.712651252746582, 1.390150547027588, 3.1411170959472656, 1.2712764739990234, 0.1671128273010254, 2.610645294189453, 2.0703606605529785, 0.09397649765014648, 2.1530556678771973, 0.9218940734863281, 1.0144729614257812, 0.7517127990722656, 1.43941068649292, 0.9181723594665527, 0.5678019523620605, 0.07778358459472656, 0.950098991394043, 0.7696447372436523, 0.6464848518371582, 1.6238741874694824, 1.1864533424377441, 0.44756126403808594, 0.42977046966552734, 1.0620036125183105, 1.3163704872131348, 0.7842707633972168, 1.5106725692749023, 1.7972345352172852, 1.9953842163085938, 1.1309781074523926, 0.9119691848754883, 0.8427586555480957, 0.9722156524658203, 0.30429744720458984, 0.2814340591430664, 0.5224142074584961, 1.1522598266601562, 3.3472437858581543, 0.4119539260864258, 0.6608753204345703, 0.2279362678527832, 1.1562509536743164, 1.1178956031799316, 0.7973709106445312, 1.2656145095825195, 1.4527935981750488, 1.7406439781188965, 0.6138033866882324, 1.47857666015625, 0.8452486991882324, 0.5797252655029297, 0.7248344421386719, 0.5978093147277832, 0.5188755989074707, 0.6478161811828613, 0.24312448501586914, 1.0567317008972168, 1.3813977241516113, 1.1356315612792969, 1.443903923034668, 2.1680660247802734, 1.4857759475708008, 1.1009950637817383, 0.46215343475341797, 0.5495967864990234, 1.9496264457702637, 0.8936214447021484, 0.49014902114868164, 0.11118936538696289, 2.079422950744629, 0.2107558250427246], "mean_td_error": 1.0390559434890747, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1207.0, "diff_num_grad_updates_vs_sampler_policy": 1206.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.092181205749512, "actor_loss": -15.044846534729004, "critic_loss": 0.12666939198970795, "alpha_loss": -3.653475046157837, "alpha_value": 0.6962750554084778, "log_alpha_value": -0.36201047897338867, "target_entropy": -6.0, "policy_t": 0.021871931850910187, "mean_q": 12.201053619384766, "max_q": 12.538047790527344, "min_q": 11.75266170501709}, "td_error": [0.7115912437438965, 0.06370162963867188, 0.03136444091796875, 0.41538047790527344, 0.3521113395690918, 2.0328097343444824, 1.6307463645935059, 1.509047508239746, 2.188945770263672, 1.301480770111084, 1.9881415367126465, 0.07729768753051758, 0.40108156204223633, 1.2467541694641113, 0.48185062408447266, 3.022451400756836, 0.4973583221435547, 0.9342026710510254, 0.09361076354980469, 0.36598634719848633, 0.5149064064025879, 0.9395790100097656, 2.1811819076538086, 1.1154975891113281, 0.7898130416870117, 1.1897473335266113, 0.29331493377685547, 1.3300213813781738, 0.8143758773803711, 0.9528141021728516, 1.5931000709533691, 0.6880011558532715, 1.0956454277038574, 0.8108916282653809, 0.6587686538696289, 2.0072898864746094, 1.6481051445007324, 0.703127384185791, 0.06802940368652344, 0.7877545356750488, 1.0288381576538086, 0.538179874420166, 0.010039329528808594, 1.6962928771972656, 0.6325435638427734, 0.16690587997436523, 0.7639684677124023, 0.5119590759277344, 0.6531257629394531, 0.8463287353515625, 1.3326358795166016, 1.3985743522644043, 0.3381538391113281, 0.11242914199829102, 0.508847713470459, 1.5919113159179688, 0.3856973648071289, 1.2111821174621582, 1.9659004211425781, 0.1693120002746582, 0.6069040298461914, 1.253075122833252, 0.8331170082092285, 1.4008641242980957, 2.8413748741149902, 0.9666647911071777, 1.5214152336120605, 1.6770644187927246, 0.2195262908935547, 2.1398768424987793, 1.165654182434082, 0.2974696159362793, 1.0386252403259277, 0.2348461151123047, 2.4969186782836914, 0.892646312713623, 0.929201602935791, 0.8946037292480469, 1.1846933364868164, 0.6093416213989258, 0.6055850982666016, 0.4104628562927246, 1.4301342964172363, 0.4627494812011719, 1.6243705749511719, 1.8840084075927734], "mean_td_error": 0.9885104894638062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1207.0, "diff_num_grad_updates_vs_sampler_policy": 1206.0}}, "num_env_steps_sampled": 9947, "num_env_steps_trained": 311406, "num_agent_steps_sampled": 29841, "num_agent_steps_trained": 311406, "last_target_update_ts": 9947, "num_target_updates": 1207}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29841, "num_agent_steps_trained": 311406, "num_env_steps_sampled": 9947, "num_env_steps_trained": 311406, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 68.74957187811334, "num_env_steps_trained_throughput_per_sec": 2533.9127920790347, "timesteps_total": 9947, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 29841, "timers": {"training_iteration_time_ms": 102.181, "sample_time_ms": 16.088, "load_time_ms": 0.301, "load_throughput": 858493.004, "learn_time_ms": 17.715, "learn_throughput": 14564.183, "synch_weights_time_ms": 10.474}, "counters": {"num_env_steps_sampled": 9947, "num_env_steps_trained": 311406, "num_agent_steps_sampled": 29841, "num_agent_steps_trained": 311406, "last_target_update_ts": 9947, "num_target_updates": 1207}, "done": false, "episodes_total": 0, "training_iteration": 84, "trial_id": "db258_00000", "date": "2023-11-16_21-50-19", "timestamp": 1700200219, "time_this_iter_s": 1.5362310409545898, "time_total_s": 131.22624969482422, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 131.22624969482422, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 64.16666666666667, "ram_util_percent": 63.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097368240356445, "actor_loss": -23.587915420532227, "critic_loss": 0.10201726853847504, "alpha_loss": -3.7031149864196777, "alpha_value": 0.6929893493652344, "log_alpha_value": -0.3667406439781189, "target_entropy": -6.0, "policy_t": -0.026176227256655693, "mean_q": 20.845827102661133, "max_q": 21.387210845947266, "min_q": 20.36776351928711}, "td_error": [2.4342050552368164, 0.5963230133056641, 0.029531478881835938, 0.30658531188964844, 0.5517683029174805, 0.5212278366088867, 1.1887178421020508, 2.620891571044922, 0.6814346313476562, 0.6510639190673828, 1.822575569152832, 0.4401721954345703, 1.8811912536621094, 1.0255451202392578, 0.11387252807617188, 0.7443466186523438, 0.9307432174682617, 0.2076854705810547, 1.1141395568847656, 2.1892738342285156, 0.6335000991821289, 1.2107439041137695, 0.5627212524414062, 1.9787006378173828, 1.9005870819091797, 0.3679780960083008, 1.2894048690795898, 2.073105812072754, 0.7792396545410156, 0.9875679016113281, 0.10002613067626953, 0.9760189056396484, 2.5612688064575195, 1.707871437072754, 2.1561546325683594, 1.2145023345947266, 1.0085487365722656, 0.23549461364746094, 2.981546401977539, 1.3847112655639648, 0.9799766540527344, 1.540980339050293, 0.40706920623779297, 2.7448883056640625, 2.407780647277832, 1.0095586776733398, 2.0141658782958984, 1.1179733276367188, 0.08767032623291016, 0.8018760681152344, 1.2047843933105469, 2.024106979370117, 0.9470443725585938, 0.8378381729125977, 1.0491409301757812, 0.45764923095703125, 1.2054710388183594, 1.9403371810913086, 1.3385686874389648, 0.3514566421508789, 1.020212173461914, 0.7909145355224609, 1.7998228073120117, 0.14667224884033203, 0.9111328125, 0.14481639862060547, 0.9861621856689453, 0.6241817474365234, 1.8878345489501953, 0.3674030303955078, 0.8799314498901367, 2.3098363876342773, 0.6661176681518555, 3.313718795776367, 0.6831130981445312, 1.5419301986694336, 1.2640304565429688, 0.9094486236572266, 0.29791831970214844, 0.968876838684082, 0.5082311630249023, 0.5114612579345703, 1.2989625930786133, 0.522486686706543, 0.2593955993652344, 2.106351852416992], "mean_td_error": 1.1319801807403564, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1222.0, "diff_num_grad_updates_vs_sampler_policy": 1221.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.035819053649902, "actor_loss": -15.136040687561035, "critic_loss": 0.09412751346826553, "alpha_loss": -3.6785898208618164, "alpha_value": 0.6931241750717163, "log_alpha_value": -0.366546094417572, "target_entropy": -6.0, "policy_t": -0.0488155335187912, "mean_q": 12.389744758605957, "max_q": 12.793540000915527, "min_q": 12.066191673278809}, "td_error": [1.6389789581298828, 0.1879105567932129, 0.6129331588745117, 1.955345630645752, 0.08900642395019531, 1.8342900276184082, 1.074812889099121, 1.625227451324463, 0.2857542037963867, 2.327796459197998, 0.8085155487060547, 1.5723962783813477, 1.609440803527832, 0.4408907890319824, 1.5645532608032227, 1.4029321670532227, 0.4945192337036133, 1.2562332153320312, 1.270376205444336, 0.15810012817382812, 1.4253015518188477, 1.0538430213928223, 0.720123291015625, 0.8921680450439453, 2.6780505180358887, 2.0607995986938477, 0.4012913703918457, 0.6058511734008789, 0.7506651878356934, 0.7951555252075195, 1.6150946617126465, 1.36045503616333, 1.3095111846923828, 0.22559118270874023, 0.26627302169799805, 0.6589832305908203, 0.1262826919555664, 1.9680280685424805, 0.9481968879699707, 1.2209486961364746, 0.09661340713500977, 0.37308692932128906, 0.38602161407470703, 0.2108445167541504, 1.3987793922424316, 1.251640796661377, 0.4816579818725586, 0.4707784652709961, 1.266512393951416, 1.6086993217468262, 0.8549127578735352, 2.5975213050842285, 1.162881851196289, 1.8307533264160156, 0.9196600914001465, 0.17432689666748047, 1.4765992164611816, 1.2936744689941406, 0.9521150588989258, 0.5551319122314453, 0.5941829681396484, 0.9885778427124023, 1.1995811462402344, 0.5096778869628906, 0.6664047241210938, 0.48526954650878906, 0.9503283500671387, 0.44572019577026367, 0.16637802124023438, 0.700554370880127, 0.9291067123413086, 0.23080825805664062, 0.7279572486877441, 0.22630691528320312, 0.9544501304626465, 1.391305923461914, 1.522998332977295, 0.5387768745422363, 2.1824984550476074, 0.7775373458862305, 0.38616418838500977, 1.4598336219787598, 0.9692068099975586, 0.8966245651245117, 2.1433119773864746, 0.08978939056396484], "mean_td_error": 0.9859092235565186, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1222.0, "diff_num_grad_updates_vs_sampler_policy": 1221.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097668647766113, "actor_loss": -15.367652893066406, "critic_loss": 0.15875442326068878, "alpha_loss": -3.7009079456329346, "alpha_value": 0.6931484341621399, "log_alpha_value": -0.36651110649108887, "target_entropy": -6.0, "policy_t": -0.0030098145361989737, "mean_q": 12.544976234436035, "max_q": 12.772273063659668, "min_q": 12.298691749572754}, "td_error": [1.3344883918762207, 1.2906689643859863, 2.630476951599121, 0.5074634552001953, 1.4279613494873047, 0.9626822471618652, 0.5619516372680664, 1.6552238464355469, 0.40203189849853516, 0.6962380409240723, 2.8528552055358887, 1.6334238052368164, 1.2147636413574219, 1.1824584007263184, 1.088219165802002, 0.3201603889465332, 1.3617897033691406, 0.7948174476623535, 1.966646671295166, 0.5145206451416016, 0.4582695960998535, 1.736856460571289, 1.2375812530517578, 0.7993655204772949, 1.110517978668213, 2.686006546020508, 0.6828808784484863, 1.4838142395019531, 0.11070108413696289, 0.341916561126709, 1.458841323852539, 1.394941806793213, 1.381103515625, 2.452670097351074, 0.5696473121643066, 0.7488975524902344, 1.27473783493042, 0.3323817253112793, 1.7891316413879395, 0.7564105987548828, 2.251676559448242, 1.0818805694580078, 1.7819581031799316, 1.659743309020996, 0.7578439712524414, 0.13860321044921875, 1.162064552307129, 0.43577098846435547, 0.3919205665588379, 2.115208148956299, 0.21702289581298828, 0.9724569320678711, 1.0008063316345215, 0.7620038986206055, 0.6662936210632324, 0.08816766738891602, 2.0807390213012695, 1.7659311294555664, 0.9657135009765625, 0.4479184150695801, 3.676823616027832, 0.9630446434020996, 0.46720266342163086, 1.258082389831543, 2.6213088035583496, 0.4455404281616211, 0.4351491928100586, 0.23402118682861328, 0.3430614471435547, 0.9744391441345215, 3.220095634460449, 2.4393720626831055, 2.059175968170166, 0.9362044334411621, 1.1379318237304688, 0.7234702110290527, 3.503990650177002, 1.2570505142211914, 1.2759065628051758, 1.4065709114074707, 0.537083625793457, 2.1841464042663574, 1.1200714111328125, 0.1910262107849121, 1.1121912002563477, 0.9586529731750488], "mean_td_error": 1.2026842832565308, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1222.0, "diff_num_grad_updates_vs_sampler_policy": 1221.0}}, "num_env_steps_sampled": 10052, "num_env_steps_trained": 315276, "num_agent_steps_sampled": 30156, "num_agent_steps_trained": 315276, "last_target_update_ts": 10052, "num_target_updates": 1222}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30156, "num_agent_steps_trained": 315276, "num_env_steps_sampled": 10052, "num_env_steps_trained": 315276, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.14375317307736, "num_env_steps_trained_throughput_per_sec": 2474.7269026648514, "timesteps_total": 10052, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 30156, "timers": {"training_iteration_time_ms": 105.237, "sample_time_ms": 16.488, "load_time_ms": 0.305, "load_throughput": 844820.386, "learn_time_ms": 18.248, "learn_throughput": 14138.898, "synch_weights_time_ms": 10.316}, "counters": {"num_env_steps_sampled": 10052, "num_env_steps_trained": 315276, "num_agent_steps_sampled": 30156, "num_agent_steps_trained": 315276, "last_target_update_ts": 10052, "num_target_updates": 1222}, "done": false, "episodes_total": 0, "training_iteration": 85, "trial_id": "db258_00000", "date": "2023-11-16_21-50-20", "timestamp": 1700200220, "time_this_iter_s": 1.570763111114502, "time_total_s": 132.79701280593872, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 132.79701280593872, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 63.349999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.162389755249023, "actor_loss": -23.852561950683594, "critic_loss": 0.09805312752723694, "alpha_loss": -3.7728052139282227, "alpha_value": 0.6898702383041382, "log_alpha_value": -0.37125179171562195, "target_entropy": -6.0, "policy_t": -0.011516954749822617, "mean_q": 21.01641082763672, "max_q": 21.486635208129883, "min_q": 20.616657257080078}, "td_error": [0.5377311706542969, 0.47976112365722656, 0.7437105178833008, 0.47588443756103516, 0.9237070083618164, 1.018977165222168, 1.2933740615844727, 1.652750015258789, 0.21811962127685547, 2.242587089538574, 1.5138664245605469, 1.4681739807128906, 0.609187126159668, 0.4625530242919922, 0.9950551986694336, 1.1043472290039062, 1.2469511032104492, 0.9722604751586914, 2.587130546569824, 1.6093664169311523, 0.9828605651855469, 0.2330770492553711, 0.4583301544189453, 0.16393470764160156, 1.5947685241699219, 1.5355796813964844, 0.3019218444824219, 0.1136016845703125, 1.9413337707519531, 0.8373966217041016, 0.48018455505371094, 2.4730958938598633, 0.23370933532714844, 0.14644908905029297, 0.8246879577636719, 1.7217655181884766, 1.6739435195922852, 0.7944021224975586, 1.737894058227539, 2.3932275772094727, 1.6138992309570312, 0.756037712097168, 1.6664791107177734, 0.42495250701904297, 0.5380744934082031, 0.2287006378173828, 1.884124755859375, 0.853759765625, 0.9443073272705078, 0.28278160095214844, 0.25247764587402344, 1.0323219299316406, 1.8494501113891602, 1.6717958450317383, 0.7321338653564453, 1.8273086547851562, 2.083371162414551, 1.9154548645019531, 0.7220697402954102, 1.7098751068115234, 0.3144388198852539, 0.15104103088378906, 0.09955120086669922, 1.452509880065918, 1.180790901184082, 0.30280113220214844, 1.2701730728149414, 0.9625167846679688, 0.5506095886230469, 0.9320096969604492, 0.21181106567382812, 0.8326148986816406, 0.8933496475219727, 1.2717247009277344, 0.6779937744140625, 0.9414682388305664, 2.329096794128418, 2.731448173522949, 1.245722770690918, 2.2579498291015625, 2.319978713989258, 0.9836158752441406, 0.5629768371582031, 0.6530027389526367, 0.9454317092895508, 2.1299657821655273], "mean_td_error": 1.0929259061813354, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1237.0, "diff_num_grad_updates_vs_sampler_policy": 1236.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122821807861328, "actor_loss": -15.302799224853516, "critic_loss": 0.1116153746843338, "alpha_loss": -3.756016969680786, "alpha_value": 0.6900132298469543, "log_alpha_value": -0.3710445165634155, "target_entropy": -6.0, "policy_t": -0.03751593455672264, "mean_q": 12.49414348602295, "max_q": 12.800239562988281, "min_q": 12.0169677734375}, "td_error": [1.0103473663330078, 0.05319929122924805, 0.35671043395996094, 2.6538209915161133, 0.25596141815185547, 1.470689296722412, 0.9648513793945312, 2.341440200805664, 2.1362667083740234, 0.5504150390625, 0.6818604469299316, 0.7445058822631836, 1.3776240348815918, 1.214426040649414, 0.9947290420532227, 0.39111852645874023, 0.9462366104125977, 0.14119815826416016, 1.6911940574645996, 1.005958080291748, 1.1659774780273438, 0.9666323661804199, 1.527674674987793, 0.4636240005493164, 0.7800922393798828, 0.8389034271240234, 1.2142014503479004, 0.0566096305847168, 1.322397232055664, 0.38399696350097656, 1.7971138954162598, 1.1071147918701172, 0.6969213485717773, 0.7947177886962891, 0.6065497398376465, 1.9653453826904297, 0.2091817855834961, 1.9837541580200195, 0.7803659439086914, 0.36016368865966797, 0.26114511489868164, 0.34589147567749023, 0.5486083030700684, 1.6006298065185547, 0.5848202705383301, 0.9802985191345215, 1.9968347549438477, 1.0609087944030762, 1.4043302536010742, 1.2395977973937988, 1.7760496139526367, 1.120290756225586, 3.2784690856933594, 1.0710935592651367, 2.3233323097229004, 1.1641864776611328, 1.4351720809936523, 0.9898438453674316, 0.3239860534667969, 2.4165611267089844, 0.9577078819274902, 1.1008710861206055, 0.9203910827636719, 0.015940189361572266, 1.717477798461914, 0.9241046905517578, 0.6115989685058594, 0.7722206115722656, 0.22841215133666992, 2.533413887023926, 2.685976028442383, 0.5334854125976562, 1.0024666786193848, 1.3164191246032715, 0.18610858917236328, 1.0416793823242188, 2.2563552856445312, 1.3729615211486816, 1.336477279663086, 2.2279672622680664, 2.532538890838623, 0.8606953620910645, 0.3363008499145508, 0.48780107498168945, 1.7919154167175293, 1.7838335037231445], "mean_td_error": 1.133268117904663, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1237.0, "diff_num_grad_updates_vs_sampler_policy": 1236.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.088155746459961, "actor_loss": -15.375598907470703, "critic_loss": 0.13434401154518127, "alpha_loss": -3.7427783012390137, "alpha_value": 0.6900389790534973, "log_alpha_value": -0.37100720405578613, "target_entropy": -6.0, "policy_t": -0.004217511974275112, "mean_q": 12.574119567871094, "max_q": 13.067788124084473, "min_q": 12.178487777709961}, "td_error": [1.5195722579956055, 1.698227882385254, 0.6505050659179688, 0.4775867462158203, 1.0731196403503418, 2.1270108222961426, 1.2340459823608398, 0.7346715927124023, 0.47249603271484375, 0.27538394927978516, 0.9279675483703613, 1.608670711517334, 0.8478918075561523, 1.2094902992248535, 1.9132471084594727, 0.6962475776672363, 2.41372013092041, 1.0051307678222656, 0.5348753929138184, 0.5154428482055664, 1.3966178894042969, 1.091592788696289, 0.2566499710083008, 1.3553133010864258, 1.3460521697998047, 2.2063961029052734, 2.2694497108459473, 0.19878911972045898, 1.0752253532409668, 1.0810174942016602, 0.9370722770690918, 0.28539562225341797, 0.43877649307250977, 0.46906423568725586, 1.284409523010254, 1.8355827331542969, 1.5995540618896484, 0.9932928085327148, 0.7249774932861328, 0.35294198989868164, 2.977044105529785, 1.9546818733215332, 0.648500919342041, 1.1747236251831055, 1.0432820320129395, 1.1547508239746094, 0.03527021408081055, 1.3798680305480957, 0.49947452545166016, 2.4381532669067383, 1.4612164497375488, 0.4691619873046875, 1.0783476829528809, 1.505312442779541, 0.7766938209533691, 0.9378013610839844, 1.0333290100097656, 0.4581136703491211, 0.7404613494873047, 2.0317983627319336, 0.4999098777770996, 0.2974667549133301, 0.6508951187133789, 0.3501410484313965, 0.722386360168457, 0.2317180633544922, 0.8089919090270996, 0.9637103080749512, 1.094710350036621, 1.915959358215332, 1.2157583236694336, 0.8030176162719727, 2.1261558532714844, 0.9946141242980957, 1.3696932792663574, 0.9883747100830078, 0.364743709564209, 1.7499065399169922, 0.3762397766113281, 1.2706336975097656, 0.7072339057922363, 1.1409845352172852, 1.0474681854248047, 0.42310142517089844, 0.9455413818359375, 0.4427518844604492], "mean_td_error": 1.0515531301498413, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1237.0, "diff_num_grad_updates_vs_sampler_policy": 1236.0}}, "num_env_steps_sampled": 10157, "num_env_steps_trained": 319146, "num_agent_steps_sampled": 30471, "num_agent_steps_trained": 319146, "last_target_update_ts": 10157, "num_target_updates": 1237}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30471, "num_agent_steps_trained": 319146, "num_env_steps_sampled": 10157, "num_env_steps_trained": 319146, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.88238703273261, "num_env_steps_trained_throughput_per_sec": 2501.950836349288, "timesteps_total": 10157, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 30471, "timers": {"training_iteration_time_ms": 103.465, "sample_time_ms": 14.722, "load_time_ms": 0.311, "load_throughput": 828837.647, "learn_time_ms": 18.269, "learn_throughput": 14122.623, "synch_weights_time_ms": 9.917}, "counters": {"num_env_steps_sampled": 10157, "num_env_steps_trained": 319146, "num_agent_steps_sampled": 30471, "num_agent_steps_trained": 319146, "last_target_update_ts": 10157, "num_target_updates": 1237}, "done": false, "episodes_total": 0, "training_iteration": 86, "trial_id": "db258_00000", "date": "2023-11-16_21-50-22", "timestamp": 1700200222, "time_this_iter_s": 1.5562608242034912, "time_total_s": 134.3532736301422, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 134.3532736301422, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 30.1, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110686302185059, "actor_loss": -23.969911575317383, "critic_loss": 0.10022109746932983, "alpha_loss": -3.799194574356079, "alpha_value": 0.6867669224739075, "log_alpha_value": -0.3757603168487549, "target_entropy": -6.0, "policy_t": -0.0571039617061615, "mean_q": 21.259723663330078, "max_q": 21.775501251220703, "min_q": 20.84514617919922}, "td_error": [0.503046989440918, 1.0495033264160156, 1.8866710662841797, 0.8808841705322266, 2.6193532943725586, 1.5042266845703125, 0.6475715637207031, 0.028046607971191406, 0.8390331268310547, 0.5093097686767578, 1.8039894104003906, 0.0969686508178711, 0.7312126159667969, 2.0082836151123047, 1.1388311386108398, 2.6558265686035156, 0.6546096801757812, 1.8322629928588867, 1.3797636032104492, 1.176095962524414, 2.0347824096679688, 2.5364370346069336, 0.7977333068847656, 1.3551454544067383, 0.7597713470458984, 1.4488048553466797, 0.5565242767333984, 1.666391372680664, 0.6346197128295898, 1.8469123840332031, 0.4263639450073242, 0.9999818801879883, 1.3299293518066406, 1.4227943420410156, 2.0665225982666016, 0.21546554565429688, 0.7620620727539062, 1.4906082153320312, 0.386077880859375, 1.3475704193115234, 2.8987855911254883, 1.2015094757080078, 0.7980461120605469, 0.16358375549316406, 2.091583251953125, 0.8951482772827148, 0.3600778579711914, 0.8389568328857422, 0.16825294494628906, 0.5991640090942383, 0.04863548278808594, 1.130472183227539, 0.4292631149291992, 1.9881763458251953, 2.1062135696411133, 0.768671989440918, 1.5304126739501953, 0.8957176208496094, 0.8250141143798828, 0.7711105346679688, 0.7978076934814453, 1.3203659057617188, 1.9678754806518555, 0.2191476821899414, 1.9335002899169922, 0.23802566528320312, 1.1572742462158203, 0.27178287506103516, 0.4770355224609375, 1.368210792541504, 0.07301521301269531, 2.169703483581543, 0.8708162307739258, 1.6406974792480469, 0.26956844329833984, 2.3257179260253906, 1.0020837783813477, 0.5603580474853516, 0.8274335861206055, 0.9387521743774414, 0.9433555603027344, 1.3553171157836914, 1.8340625762939453, 1.2184715270996094, 1.6511154174804688, 0.5197362899780273], "mean_td_error": 1.1219768524169922, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1252.0, "diff_num_grad_updates_vs_sampler_policy": 1251.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067220687866211, "actor_loss": -15.44388198852539, "critic_loss": 0.11272598803043365, "alpha_loss": -3.7806942462921143, "alpha_value": 0.68691486120224, "log_alpha_value": -0.3755449652671814, "target_entropy": -6.0, "policy_t": -0.030052339658141136, "mean_q": 12.669207572937012, "max_q": 13.024913787841797, "min_q": 12.236122131347656}, "td_error": [0.5526838302612305, 1.4194145202636719, 0.24103689193725586, 0.2094273567199707, 0.39830636978149414, 1.7076807022094727, 0.889676570892334, 1.1824545860290527, 0.9353022575378418, 1.0270934104919434, 1.8993840217590332, 0.8248038291931152, 0.3309803009033203, 0.49591064453125, 0.6741981506347656, 0.5256938934326172, 1.157911777496338, 1.086512565612793, 0.8839998245239258, 0.5302486419677734, 2.5311713218688965, 1.9196844100952148, 1.7541804313659668, 0.5223288536071777, 2.481595993041992, 0.07483530044555664, 1.6846885681152344, 2.1717777252197266, 2.171699047088623, 0.13808727264404297, 1.7387046813964844, 1.3669910430908203, 0.5325069427490234, 0.6393604278564453, 1.6243438720703125, 1.690202236175537, 1.7485389709472656, 1.2801313400268555, 1.7613105773925781, 0.08568477630615234, 1.551589012145996, 1.8472604751586914, 1.1817240715026855, 1.4943952560424805, 0.07974576950073242, 2.1667399406433105, 0.9615349769592285, 1.2080788612365723, 2.347853660583496, 1.4472160339355469, 0.3835873603820801, 1.380424976348877, 1.6021623611450195, 0.8475723266601562, 0.24773073196411133, 1.6450343132019043, 0.8428468704223633, 1.5121655464172363, 0.8403224945068359, 1.7265563011169434, 1.0260462760925293, 2.154115676879883, 0.927879810333252, 0.725125789642334, 0.9734363555908203, 1.926701545715332, 1.363959789276123, 0.8732190132141113, 1.0480022430419922, 0.9657320976257324, 1.0694899559020996, 2.1423964500427246, 0.5845441818237305, 0.1565542221069336, 0.053668975830078125, 1.9138689041137695, 0.8836431503295898, 1.0642080307006836, 0.8520298004150391, 0.6074929237365723, 1.483449935913086, 0.9295945167541504, 0.5330467224121094, 0.3615260124206543, 0.3465914726257324, 1.830223560333252], "mean_td_error": 1.127925992012024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1252.0, "diff_num_grad_updates_vs_sampler_policy": 1251.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.077520370483398, "actor_loss": -15.328034400939941, "critic_loss": 0.1504095494747162, "alpha_loss": -3.784170150756836, "alpha_value": 0.6869415044784546, "log_alpha_value": -0.37550610303878784, "target_entropy": -6.0, "policy_t": 0.015921926125884056, "mean_q": 12.546720504760742, "max_q": 12.899415969848633, "min_q": 12.165509223937988}, "td_error": [0.08427810668945312, 0.9303445816040039, 0.7392120361328125, 1.0528068542480469, 0.9724464416503906, 2.7309865951538086, 2.758883476257324, 0.7114119529724121, 2.0507125854492188, 1.6200737953186035, 0.764805793762207, 1.8093757629394531, 1.7448148727416992, 0.33687877655029297, 1.0452265739440918, 0.8007559776306152, 1.1644792556762695, 2.243241310119629, 0.1260690689086914, 0.26869678497314453, 0.8304200172424316, 0.9416861534118652, 0.17403507232666016, 1.216099739074707, 1.5065903663635254, 0.6033382415771484, 1.5667304992675781, 1.2289214134216309, 1.096517562866211, 0.9778304100036621, 0.3966197967529297, 1.611037254333496, 1.6232924461364746, 0.9328365325927734, 1.0167393684387207, 1.5158162117004395, 0.9077033996582031, 1.1184606552124023, 2.006638526916504, 2.0746755599975586, 1.7189297676086426, 1.240091323852539, 0.868563175201416, 3.0551400184631348, 0.17996788024902344, 0.9683341979980469, 0.4099564552307129, 0.18657493591308594, 0.9850430488586426, 0.457244873046875, 1.1279382705688477, 1.7204780578613281, 0.9130458831787109, 0.0849308967590332, 0.7892522811889648, 0.40398216247558594, 1.8912196159362793, 0.05049943923950195, 1.980987548828125, 1.283348560333252, 1.583667278289795, 2.036149501800537, 0.7540798187255859, 0.11323928833007812, 2.5093936920166016, 1.0911188125610352, 1.6489753723144531, 1.8706622123718262, 0.9051766395568848, 0.5311970710754395, 1.261601448059082, 0.9221048355102539, 0.28322267532348633, 1.7635502815246582, 2.237114429473877, 2.546773910522461, 0.4601426124572754, 0.7374973297119141, 1.2250943183898926, 0.9614005088806152, 0.4267120361328125, 1.192880630493164, 2.1125073432922363, 0.4604511260986328, 2.195511817932129, 0.5848278999328613], "mean_td_error": 1.163163661956787, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1252.0, "diff_num_grad_updates_vs_sampler_policy": 1251.0}}, "num_env_steps_sampled": 10262, "num_env_steps_trained": 323016, "num_agent_steps_sampled": 30786, "num_agent_steps_trained": 323016, "last_target_update_ts": 10262, "num_target_updates": 1252}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30786, "num_agent_steps_trained": 323016, "num_env_steps_sampled": 10262, "num_env_steps_trained": 323016, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.54674186551509, "num_env_steps_trained_throughput_per_sec": 2489.5799144718417, "timesteps_total": 10262, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 30786, "timers": {"training_iteration_time_ms": 103.856, "sample_time_ms": 15.665, "load_time_ms": 0.317, "load_throughput": 815102.766, "learn_time_ms": 18.016, "learn_throughput": 14320.392, "synch_weights_time_ms": 9.363}, "counters": {"num_env_steps_sampled": 10262, "num_env_steps_trained": 323016, "num_agent_steps_sampled": 30786, "num_agent_steps_trained": 323016, "last_target_update_ts": 10262, "num_target_updates": 1252}, "done": false, "episodes_total": 0, "training_iteration": 87, "trial_id": "db258_00000", "date": "2023-11-16_21-50-24", "timestamp": 1700200224, "time_this_iter_s": 1.5631229877471924, "time_total_s": 135.9163966178894, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 135.9163966178894, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 31.6, "ram_util_percent": 63.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08340072631836, "actor_loss": -24.02261734008789, "critic_loss": 0.09711605310440063, "alpha_loss": -3.834397077560425, "alpha_value": 0.6836779713630676, "log_alpha_value": -0.38026827573776245, "target_entropy": -6.0, "policy_t": -0.0017866349080577493, "mean_q": 21.256088256835938, "max_q": 21.689319610595703, "min_q": 20.655488967895508}, "td_error": [1.7661352157592773, 0.3989419937133789, 1.1299095153808594, 1.5874404907226562, 0.44600486755371094, 1.2848787307739258, 0.26546669006347656, 2.6260757446289062, 0.5302810668945312, 1.3252553939819336, 1.8671340942382812, 0.7562484741210938, 0.5516233444213867, 1.6555004119873047, 2.3316869735717773, 0.7045631408691406, 1.3672361373901367, 2.16201114654541, 0.5322360992431641, 1.1166572570800781, 0.5053987503051758, 0.5854511260986328, 1.9351520538330078, 0.8194675445556641, 0.8505144119262695, 0.5665664672851562, 0.7251110076904297, 1.8721122741699219, 0.6227960586547852, 1.6154413223266602, 0.1875762939453125, 1.3583002090454102, 1.8585529327392578, 0.8182201385498047, 0.3959951400756836, 0.08476543426513672, 0.3914003372192383, 2.723027229309082, 2.259002685546875, 0.7495508193969727, 1.2161102294921875, 0.8916854858398438, 1.481583595275879, 0.6646175384521484, 1.8665781021118164, 1.2607154846191406, 3.015707015991211, 0.27644824981689453, 0.36874961853027344, 0.9219064712524414, 1.5186443328857422, 1.8805150985717773, 0.4104156494140625, 0.5320911407470703, 1.286799430847168, 1.2414617538452148, 0.26918697357177734, 0.2674903869628906, 0.45051002502441406, 0.6496200561523438, 1.672652244567871, 0.9186897277832031, 0.18480491638183594, 0.8688344955444336, 1.248708724975586, 0.9923610687255859, 2.083918571472168, 1.9301300048828125, 2.458395004272461, 0.9534912109375, 0.11533355712890625, 1.2191104888916016, 0.4773883819580078, 2.337984085083008, 0.3122234344482422, 0.1870250701904297, 2.841655731201172, 0.9951963424682617, 1.3445625305175781, 0.08462715148925781, 1.2784852981567383, 2.0712642669677734, 0.9625139236450195, 0.9797506332397461, 0.26775264739990234, 0.03917121887207031], "mean_td_error": 1.100308895111084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1267.0, "diff_num_grad_updates_vs_sampler_policy": 1266.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126076698303223, "actor_loss": -15.594938278198242, "critic_loss": 0.11592140793800354, "alpha_loss": -3.8483736515045166, "alpha_value": 0.6838300228118896, "log_alpha_value": -0.3800458610057831, "target_entropy": -6.0, "policy_t": 0.013888255693018436, "mean_q": 12.813538551330566, "max_q": 13.129165649414062, "min_q": 12.471537590026855}, "td_error": [0.42220354080200195, 1.7530760765075684, 1.3571667671203613, 0.2687416076660156, 1.0701775550842285, 1.2129149436950684, 0.7745881080627441, 1.0462632179260254, 1.8311543464660645, 0.24735498428344727, 2.2247209548950195, 1.5947532653808594, 1.4286174774169922, 1.5153651237487793, 1.6303997039794922, 0.8046293258666992, 1.1975774765014648, 0.8702449798583984, 0.40843820571899414, 0.05821514129638672, 0.6305503845214844, 0.28278589248657227, 2.90695858001709, 0.7963290214538574, 0.8932132720947266, 1.6637606620788574, 2.152862071990967, 1.538325309753418, 1.8117728233337402, 0.6466045379638672, 0.9868001937866211, 0.32523250579833984, 0.21922016143798828, 0.44646739959716797, 1.4499740600585938, 1.5001835823059082, 2.949324607849121, 0.3469114303588867, 1.9201436042785645, 0.6893596649169922, 2.922424793243408, 0.25368833541870117, 2.432595729827881, 0.32719898223876953, 0.41213369369506836, 0.05722379684448242, 1.5643410682678223, 1.1863369941711426, 1.2233877182006836, 2.185180187225342, 0.07900571823120117, 1.86468505859375, 0.319455623626709, 1.0663580894470215, 1.0484790802001953, 1.1108150482177734, 1.282243251800537, 0.3344898223876953, 1.920759677886963, 1.1632575988769531, 0.9706449508666992, 1.2155070304870605, 2.6989493370056152, 0.11576414108276367, 2.706117630004883, 0.3749852180480957, 0.27451229095458984, 0.6766357421875, 0.78338623046875, 1.9480876922607422, 0.3347043991088867, 1.260221004486084, 0.6904802322387695, 2.6207971572875977, 2.365128993988037, 0.5725564956665039, 1.0368719100952148, 0.015644550323486328, 1.1724705696105957, 1.101534366607666, 1.0267252922058105, 1.283452033996582, 1.297131061553955, 1.652761459350586, 1.4509034156799316, 1.6878609657287598], "mean_td_error": 1.162340521812439, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1267.0, "diff_num_grad_updates_vs_sampler_policy": 1266.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099587440490723, "actor_loss": -15.477887153625488, "critic_loss": 0.11711565405130386, "alpha_loss": -3.837876081466675, "alpha_value": 0.6838591694831848, "log_alpha_value": -0.38000327348709106, "target_entropy": -6.0, "policy_t": -0.010715169832110405, "mean_q": 12.718400955200195, "max_q": 13.110391616821289, "min_q": 12.423223495483398}, "td_error": [0.6013126373291016, 2.2305221557617188, 1.1307191848754883, 0.776430606842041, 0.13683795928955078, 1.5860323905944824, 0.18279314041137695, 1.5203275680541992, 1.2095890045166016, 2.5129809379577637, 0.24836349487304688, 0.5848464965820312, 0.39083099365234375, 1.8055028915405273, 0.7028989791870117, 1.5716257095336914, 0.09975242614746094, 0.37337303161621094, 0.2982473373413086, 0.540013313293457, 0.9406223297119141, 0.5243124961853027, 1.5731573104858398, 0.2784419059753418, 1.259660243988037, 2.018409252166748, 1.664229393005371, 0.32570838928222656, 0.20749902725219727, 0.4966087341308594, 0.055294036865234375, 0.6202678680419922, 1.7240581512451172, 1.2462568283081055, 1.9065265655517578, 0.4757208824157715, 0.8009910583496094, 0.11118221282958984, 0.40911293029785156, 0.5620579719543457, 0.33962249755859375, 1.0596585273742676, 0.8868536949157715, 0.4210333824157715, 1.0038323402404785, 0.8081493377685547, 1.1130824089050293, 0.37005090713500977, 0.17031526565551758, 1.630502700805664, 1.3770108222961426, 1.4992313385009766, 1.001235008239746, 1.3021774291992188, 1.4935178756713867, 0.21563434600830078, 0.990814208984375, 0.5861248970031738, 0.7877511978149414, 0.9143195152282715, 3.3752546310424805, 0.28920650482177734, 0.9949955940246582, 1.7548346519470215, 2.015249729156494, 1.400813102722168, 1.9947047233581543, 1.0344514846801758, 1.6876211166381836, 0.08816051483154297, 1.322817325592041, 1.68888521194458, 0.743189811706543, 0.4767589569091797, 1.193619728088379, 2.020354747772217, 0.8623948097229004, 0.89434814453125, 0.844670295715332, 0.5810112953186035, 0.6464500427246094, 0.046436309814453125, 0.5970554351806641, 0.9940876960754395, 0.7219634056091309, 1.7444324493408203], "mean_td_error": 0.9731139540672302, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1267.0, "diff_num_grad_updates_vs_sampler_policy": 1266.0}}, "num_env_steps_sampled": 10367, "num_env_steps_trained": 326886, "num_agent_steps_sampled": 31101, "num_agent_steps_trained": 326886, "last_target_update_ts": 10367, "num_target_updates": 1267}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31101, "num_agent_steps_trained": 326886, "num_env_steps_sampled": 10367, "num_env_steps_trained": 326886, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.20094337261814, "num_env_steps_trained_throughput_per_sec": 2476.8347700193544, "timesteps_total": 10367, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 31101, "timers": {"training_iteration_time_ms": 104.847, "sample_time_ms": 17.139, "load_time_ms": 0.311, "load_throughput": 830618.999, "learn_time_ms": 17.847, "learn_throughput": 14455.891, "synch_weights_time_ms": 9.9}, "counters": {"num_env_steps_sampled": 10367, "num_env_steps_trained": 326886, "num_agent_steps_sampled": 31101, "num_agent_steps_trained": 326886, "last_target_update_ts": 10367, "num_target_updates": 1267}, "done": false, "episodes_total": 0, "training_iteration": 88, "trial_id": "db258_00000", "date": "2023-11-16_21-50-25", "timestamp": 1700200225, "time_this_iter_s": 1.5707271099090576, "time_total_s": 137.48712372779846, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0618a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 137.48712372779846, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 30.46666666666667, "ram_util_percent": 63.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.074164390563965, "actor_loss": -24.37972640991211, "critic_loss": 0.09274649620056152, "alpha_loss": -3.876317262649536, "alpha_value": 0.6806017160415649, "log_alpha_value": -0.3847779929637909, "target_entropy": -6.0, "policy_t": -0.020546728745102882, "mean_q": 21.685510635375977, "max_q": 22.229936599731445, "min_q": 21.241256713867188}, "td_error": [0.563075065612793, 1.4360408782958984, 0.8602180480957031, 1.2795448303222656, 2.0394582748413086, 1.2200508117675781, 0.9058914184570312, 1.1108341217041016, 2.648500442504883, 0.8803615570068359, 1.0928840637207031, 1.2348365783691406, 1.48272705078125, 0.6388568878173828, 2.106888771057129, 2.6042909622192383, 0.6348419189453125, 0.6104965209960938, 1.7640924453735352, 0.25830841064453125, 0.8759193420410156, 0.9195270538330078, 2.7233381271362305, 1.0283565521240234, 0.2650604248046875, 2.316852569580078, 0.11182975769042969, 0.710296630859375, 0.33864784240722656, 0.858088493347168, 0.25730419158935547, 3.806447982788086, 1.8052425384521484, 2.0088653564453125, 0.07731056213378906, 0.5398979187011719, 0.05740547180175781, 0.4158439636230469, 0.16941452026367188, 0.7073526382446289, 0.3676910400390625, 1.0085620880126953, 0.2451496124267578, 0.9809436798095703, 1.0805292129516602, 1.559885025024414, 1.0741691589355469, 0.8016977310180664, 0.8327054977416992, 1.118722915649414, 1.2114753723144531, 0.7420625686645508, 0.4472799301147461, 1.8444242477416992, 1.8921451568603516, 0.9714794158935547, 0.9276275634765625, 1.459543228149414, 1.0655593872070312, 0.899775505065918, 2.1949806213378906, 1.071974754333496, 1.2818527221679688, 1.1810178756713867, 0.9091615676879883, 0.6515531539916992, 0.9999475479125977, 0.5993213653564453, 0.08231449127197266, 1.3037986755371094, 0.06010246276855469, 1.2473249435424805, 0.013185501098632812, 2.009554862976074, 0.08564090728759766, 0.4296531677246094, 1.629166603088379, 1.3354816436767578, 1.5261831283569336, 1.2334156036376953, 0.5193290710449219, 0.18327713012695312, 1.0038795471191406, 1.1152210235595703, 1.1578083038330078, 1.357076644897461], "mean_td_error": 1.0590564012527466, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1282.0, "diff_num_grad_updates_vs_sampler_policy": 1281.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121801376342773, "actor_loss": -15.612796783447266, "critic_loss": 0.10175348073244095, "alpha_loss": -3.892301321029663, "alpha_value": 0.6807594299316406, "log_alpha_value": -0.38454630970954895, "target_entropy": -6.0, "policy_t": 0.014011424966156483, "mean_q": 12.854510307312012, "max_q": 13.238008499145508, "min_q": 12.576162338256836}, "td_error": [0.4014463424682617, 1.4902348518371582, 0.5271720886230469, 0.28629350662231445, 0.2959327697753906, 0.06349992752075195, 2.3404669761657715, 1.710829257965088, 1.017707347869873, 0.8538365364074707, 0.19706344604492188, 1.5896968841552734, 1.311342716217041, 1.5474128723144531, 1.3635191917419434, 1.0582036972045898, 0.8159580230712891, 1.254539966583252, 1.3206324577331543, 0.0513758659362793, 0.2695484161376953, 0.6901025772094727, 1.7856831550598145, 0.9732151031494141, 1.6295514106750488, 0.7357525825500488, 1.0180492401123047, 0.9851722717285156, 1.3508033752441406, 0.0668954849243164, 0.13595962524414062, 0.7652091979980469, 2.406489372253418, 0.5300922393798828, 2.4921979904174805, 0.045723915100097656, 1.655022144317627, 0.24245738983154297, 0.4788217544555664, 0.5430130958557129, 1.150648593902588, 0.6906790733337402, 1.9797987937927246, 1.7047481536865234, 1.18790864944458, 1.0397448539733887, 2.16861629486084, 0.516350269317627, 0.8514628410339355, 0.9399814605712891, 1.6648311614990234, 3.534022331237793, 0.5288901329040527, 1.838827133178711, 1.6248440742492676, 1.7588810920715332, 0.972691535949707, 1.728205680847168, 1.6036643981933594, 0.7938017845153809, 0.9816923141479492, 0.2875537872314453, 0.7165513038635254, 0.7810897827148438, 1.4438095092773438, 0.8743143081665039, 1.4704375267028809, 0.5137534141540527, 0.6753582954406738, 0.890235424041748, 0.041866302490234375, 1.9406003952026367, 2.322831630706787, 0.6517353057861328, 0.9687614440917969, 0.21632957458496094, 1.7996220588684082, 1.1673355102539062, 1.0999236106872559, 1.8273811340332031, 0.3512439727783203, 0.06996965408325195, 0.6934423446655273, 0.07828712463378906, 1.543135643005371, 0.7857089042663574], "mean_td_error": 1.0554475784301758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1282.0, "diff_num_grad_updates_vs_sampler_policy": 1281.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101974487304688, "actor_loss": -15.51367473602295, "critic_loss": 0.12901461124420166, "alpha_loss": -3.884242296218872, "alpha_value": 0.6807887554168701, "log_alpha_value": -0.38450324535369873, "target_entropy": -6.0, "policy_t": 0.038972482085227966, "mean_q": 12.761473655700684, "max_q": 13.118115425109863, "min_q": 12.521289825439453}, "td_error": [1.039072036743164, 1.6553258895874023, 1.553807258605957, 0.8276462554931641, 0.975825309753418, 0.2850179672241211, 1.737105369567871, 1.6585488319396973, 1.5522923469543457, 0.9071149826049805, 0.5927286148071289, 0.9504642486572266, 2.526444911956787, 1.6837873458862305, 1.8678922653198242, 0.5054230690002441, 0.20478487014770508, 0.5132761001586914, 1.1382536888122559, 1.221691608428955, 0.3453073501586914, 0.7998523712158203, 1.5580048561096191, 0.09089469909667969, 0.5510601997375488, 1.0715007781982422, 1.0403366088867188, 0.580864429473877, 0.5532684326171875, 0.9031357765197754, 1.0765013694763184, 1.3743138313293457, 0.9708666801452637, 2.6482439041137695, 0.22791385650634766, 1.0237603187561035, 2.519099712371826, 2.378720760345459, 2.2363696098327637, 1.365617275238037, 2.9542527198791504, 1.2857651710510254, 0.3148536682128906, 0.5382308959960938, 1.1675543785095215, 0.30888843536376953, 1.3257122039794922, 0.9715976715087891, 1.349076747894287, 1.8922600746154785, 1.3263726234436035, 0.5756101608276367, 1.413217544555664, 0.6929707527160645, 1.0140557289123535, 0.19777822494506836, 0.5052909851074219, 0.42261552810668945, 0.9026055335998535, 0.7325687408447266, 0.712681770324707, 0.6571531295776367, 1.1925044059753418, 1.5064787864685059, 0.6387138366699219, 0.8122577667236328, 1.1892247200012207, 0.1779928207397461, 1.46636962890625, 0.4546332359313965, 1.0115151405334473, 1.2372546195983887, 0.9973940849304199, 0.8041768074035645, 1.7329187393188477, 0.8299827575683594, 0.604588508605957, 2.0768213272094727, 0.14806175231933594, 0.6569705009460449, 1.1915879249572754, 0.7532529830932617, 1.3158416748046875, 0.8361806869506836, 0.8271470069885254, 0.7213873863220215], "mean_td_error": 1.0599594116210938, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1282.0, "diff_num_grad_updates_vs_sampler_policy": 1281.0}}, "num_env_steps_sampled": 10472, "num_env_steps_trained": 330756, "num_agent_steps_sampled": 31416, "num_agent_steps_trained": 330756, "last_target_update_ts": 10472, "num_target_updates": 1282}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31416, "num_agent_steps_trained": 330756, "num_env_steps_sampled": 10472, "num_env_steps_trained": 330756, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.50061959596978, "num_env_steps_trained_throughput_per_sec": 2487.879979394315, "timesteps_total": 10472, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 31416, "timers": {"training_iteration_time_ms": 104.742, "sample_time_ms": 16.092, "load_time_ms": 0.314, "load_throughput": 822725.182, "learn_time_ms": 18.368, "learn_throughput": 14046.418, "synch_weights_time_ms": 10.046}, "counters": {"num_env_steps_sampled": 10472, "num_env_steps_trained": 330756, "num_agent_steps_sampled": 31416, "num_agent_steps_trained": 330756, "last_target_update_ts": 10472, "num_target_updates": 1282}, "done": false, "episodes_total": 0, "training_iteration": 89, "trial_id": "db258_00000", "date": "2023-11-16_21-50-27", "timestamp": 1700200227, "time_this_iter_s": 1.5649049282073975, "time_total_s": 139.05202865600586, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140cc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 139.05202865600586, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.799999999999997, "ram_util_percent": 63.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081526756286621, "actor_loss": -24.36896514892578, "critic_loss": 0.11289297789335251, "alpha_loss": -3.9245822429656982, "alpha_value": 0.6775414943695068, "log_alpha_value": -0.38928452134132385, "target_entropy": -6.0, "policy_t": -0.0020911023020744324, "mean_q": 21.674421310424805, "max_q": 22.151752471923828, "min_q": 21.08219337463379}, "td_error": [1.4301538467407227, 1.5880203247070312, 0.8949270248413086, 2.335862159729004, 0.7629013061523438, 1.31072998046875, 1.049093246459961, 1.6582517623901367, 1.654921531677246, 1.302774429321289, 0.4112386703491211, 1.042684555053711, 0.871551513671875, 2.5620813369750977, 0.7657814025878906, 1.3031120300292969, 0.76287841796875, 2.0102930068969727, 1.6426887512207031, 0.21476459503173828, 2.3587331771850586, 1.734994888305664, 2.2385902404785156, 0.4990262985229492, 1.3067922592163086, 1.5064821243286133, 0.8576679229736328, 0.9239139556884766, 1.9197511672973633, 2.3428964614868164, 1.2315292358398438, 0.07071781158447266, 1.4158096313476562, 0.2716865539550781, 0.5704307556152344, 0.7769508361816406, 1.020522117614746, 1.6235628128051758, 1.4243755340576172, 1.9856204986572266, 1.1081066131591797, 1.543522834777832, 0.29268836975097656, 0.5858583450317383, 2.6310958862304688, 1.572011947631836, 2.319735527038574, 1.3418636322021484, 1.7557392120361328, 0.23439311981201172, 0.9405632019042969, 0.07771778106689453, 1.3547773361206055, 1.0302019119262695, 0.8991022109985352, 0.9255886077880859, 0.5255508422851562, 0.27774810791015625, 1.0648736953735352, 2.431870460510254, 1.9605646133422852, 1.9123811721801758, 1.4044418334960938, 0.909480094909668, 0.4978981018066406, 0.6545305252075195, 1.9688453674316406, 2.3307924270629883, 2.5131521224975586, 0.8357954025268555, 1.542572021484375, 1.6959514617919922, 0.10657691955566406, 0.10468006134033203, 0.09649276733398438, 1.0760364532470703, 0.7234697341918945, 1.190159797668457, 1.2028789520263672, 1.0202388763427734, 1.8253068923950195, 0.21358776092529297, 1.0507020950317383, 1.2293758392333984, 1.8105182647705078, 0.6137046813964844], "mean_td_error": 1.2216036319732666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1297.0, "diff_num_grad_updates_vs_sampler_policy": 1296.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049850463867188, "actor_loss": -15.499665260314941, "critic_loss": 0.10901591181755066, "alpha_loss": -3.909893274307251, "alpha_value": 0.677700400352478, "log_alpha_value": -0.3890499770641327, "target_entropy": -6.0, "policy_t": -0.01962832175195217, "mean_q": 12.777143478393555, "max_q": 13.206574440002441, "min_q": 12.353124618530273}, "td_error": [1.1574716567993164, 1.5431981086730957, 1.270878791809082, 1.7174830436706543, 1.1670074462890625, 1.222966194152832, 0.7316722869873047, 0.5370264053344727, 2.004006862640381, 0.9855966567993164, 0.8104720115661621, 1.498486042022705, 1.4791903495788574, 0.941047191619873, 1.513908863067627, 2.418419361114502, 1.5532512664794922, 0.6335005760192871, 1.06101655960083, 1.0230355262756348, 2.7655935287475586, 1.916623592376709, 0.876014232635498, 0.09601116180419922, 3.072660446166992, 0.6352734565734863, 0.1948556900024414, 0.748661994934082, 1.1099109649658203, 1.9514431953430176, 1.9159374237060547, 0.33495426177978516, 1.5698204040527344, 0.39286136627197266, 2.4309520721435547, 0.7408275604248047, 0.726377010345459, 2.6699342727661133, 0.024566650390625, 0.3598752021789551, 0.8626418113708496, 1.4779095649719238, 0.17348670959472656, 0.9219555854797363, 0.0362858772277832, 0.5137481689453125, 1.2933063507080078, 1.4259252548217773, 0.549809455871582, 0.641294002532959, 0.8205413818359375, 0.9014692306518555, 0.30937910079956055, 0.533238410949707, 1.1011700630187988, 1.2274541854858398, 1.0415058135986328, 1.5414671897888184, 0.5880160331726074, 1.101060390472412, 1.0578117370605469, 1.3698062896728516, 0.8658790588378906, 0.9061627388000488, 0.8863000869750977, 1.6727557182312012, 1.226499080657959, 2.601321220397949, 0.989619255065918, 1.6923675537109375, 0.3833036422729492, 0.7855525016784668, 0.8215465545654297, 0.5361990928649902, 1.0107765197753906, 1.3717145919799805, 0.6919240951538086, 0.34676361083984375, 1.231574535369873, 1.8372550010681152, 1.5132789611816406, 0.6585884094238281, 0.4049234390258789, 1.516519546508789, 1.7161245346069336, 1.239621639251709], "mean_td_error": 1.1185888051986694, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1297.0, "diff_num_grad_updates_vs_sampler_policy": 1296.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149253845214844, "actor_loss": -15.629162788391113, "critic_loss": 0.13706780970096588, "alpha_loss": -3.948077917098999, "alpha_value": 0.6777330040931702, "log_alpha_value": -0.38900184631347656, "target_entropy": -6.0, "policy_t": -0.0231263916939497, "mean_q": 12.865633010864258, "max_q": 13.160901069641113, "min_q": 12.399808883666992}, "td_error": [0.4065389633178711, 0.9273581504821777, 1.8170409202575684, 0.8947238922119141, 2.1837477684020996, 0.7945303916931152, 0.8947477340698242, 0.08839988708496094, 1.1888055801391602, 0.825169563293457, 1.7969236373901367, 0.9654936790466309, 0.5103254318237305, 0.9407954216003418, 0.7493562698364258, 0.6099362373352051, 0.8725399971008301, 1.12959623336792, 1.4979205131530762, 0.9350457191467285, 1.990267276763916, 0.9364986419677734, 1.332106113433838, 0.8548388481140137, 1.861638069152832, 0.48677778244018555, 0.9308643341064453, 1.0543241500854492, 0.8679666519165039, 1.7455873489379883, 1.6289682388305664, 0.5693597793579102, 1.442582130432129, 2.4874000549316406, 1.7784981727600098, 1.8347458839416504, 1.878178596496582, 1.478297233581543, 0.4056529998779297, 0.2576026916503906, 0.6473031044006348, 0.5723176002502441, 2.0803937911987305, 0.9074106216430664, 1.7274222373962402, 0.09872150421142578, 1.172276496887207, 1.0975451469421387, 1.6907329559326172, 0.5007424354553223, 0.809260368347168, 1.0469765663146973, 1.309783935546875, 1.3255062103271484, 0.5740237236022949, 0.4363136291503906, 1.4452424049377441, 2.3593764305114746, 0.5692658424377441, 2.5832462310791016, 0.8101177215576172, 0.5482454299926758, 1.5329370498657227, 1.0042705535888672, 2.0829033851623535, 1.0122461318969727, 1.7027544975280762, 0.11759662628173828, 0.9069256782531738, 1.6936607360839844, 0.2706308364868164, 0.024759769439697266, 0.5715899467468262, 0.7554864883422852, 1.469813346862793, 0.9578914642333984, 1.6521282196044922, 0.6329612731933594, 1.1041054725646973, 1.3928256034851074, 1.718501091003418, 0.4396042823791504, 1.715766429901123, 0.6351885795593262, 1.2079505920410156, 0.8710036277770996], "mean_td_error": 1.1120566129684448, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1297.0, "diff_num_grad_updates_vs_sampler_policy": 1296.0}}, "num_env_steps_sampled": 10577, "num_env_steps_trained": 334626, "num_agent_steps_sampled": 31731, "num_agent_steps_trained": 334626, "last_target_update_ts": 10577, "num_target_updates": 1297}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31731, "num_agent_steps_trained": 334626, "num_env_steps_sampled": 10577, "num_env_steps_trained": 334626, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.38500647300243, "num_env_steps_trained_throughput_per_sec": 2483.6188100049467, "timesteps_total": 10577, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 31731, "timers": {"training_iteration_time_ms": 105.002, "sample_time_ms": 15.856, "load_time_ms": 0.305, "load_throughput": 846207.72, "learn_time_ms": 18.147, "learn_throughput": 14217.494, "synch_weights_time_ms": 11.515}, "counters": {"num_env_steps_sampled": 10577, "num_env_steps_trained": 334626, "num_agent_steps_sampled": 31731, "num_agent_steps_trained": 334626, "last_target_update_ts": 10577, "num_target_updates": 1297}, "done": false, "episodes_total": 0, "training_iteration": 90, "trial_id": "db258_00000", "date": "2023-11-16_21-50-29", "timestamp": 1700200229, "time_this_iter_s": 1.567094087600708, "time_total_s": 140.61912274360657, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 140.61912274360657, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 31.15, "ram_util_percent": 63.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110359191894531, "actor_loss": -24.545989990234375, "critic_loss": 0.0956280529499054, "alpha_loss": -3.9813473224639893, "alpha_value": 0.6744964718818665, "log_alpha_value": -0.3937888741493225, "target_entropy": -6.0, "policy_t": -0.007642252370715141, "mean_q": 21.83057975769043, "max_q": 22.262189865112305, "min_q": 21.3435115814209}, "td_error": [1.3508825302124023, 1.6024465560913086, 0.4990396499633789, 0.6474981307983398, 0.18824386596679688, 1.15087890625, 1.5876779556274414, 0.6338367462158203, 0.8420209884643555, 0.2744607925415039, 2.3178491592407227, 2.677377700805664, 0.6111078262329102, 0.06850337982177734, 0.21996116638183594, 1.2189464569091797, 1.1377134323120117, 1.030599594116211, 0.6583843231201172, 1.2171592712402344, 1.4082145690917969, 1.2827205657958984, 0.9366607666015625, 0.7261714935302734, 0.11358070373535156, 0.30765438079833984, 1.1622943878173828, 1.2747344970703125, 2.7777252197265625, 0.3188753128051758, 1.948451042175293, 0.25795745849609375, 1.1511669158935547, 2.555084228515625, 1.7554569244384766, 0.45922279357910156, 1.0339031219482422, 0.8784313201904297, 0.18064498901367188, 1.3951797485351562, 1.907832145690918, 0.22252464294433594, 0.7645969390869141, 1.639103889465332, 1.9467582702636719, 1.9757518768310547, 0.6279125213623047, 2.5638952255249023, 1.6683883666992188, 1.6961069107055664, 1.4354887008666992, 1.6577186584472656, 1.8433446884155273, 0.5505428314208984, 1.5669031143188477, 0.3436307907104492, 0.40106773376464844, 1.7950716018676758, 2.0382347106933594, 0.6193027496337891, 0.26551246643066406, 0.5894546508789062, 0.1390838623046875, 0.9416093826293945, 1.2434196472167969, 0.6430244445800781, 0.5332622528076172, 0.5784626007080078, 1.4337787628173828, 0.5676841735839844, 0.6850061416625977, 1.1746788024902344, 3.0020647048950195, 0.08923721313476562, 1.9316997528076172, 0.07332324981689453, 1.506800651550293, 1.0208215713500977, 1.3084230422973633, 0.3885679244995117, 1.2741498947143555, 0.9822816848754883, 0.01941394805908203, 0.6198158264160156, 1.8066043853759766, 0.221527099609375], "mean_td_error": 1.0716581344604492, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1312.0, "diff_num_grad_updates_vs_sampler_policy": 1311.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067845344543457, "actor_loss": -15.568414688110352, "critic_loss": 0.1053849309682846, "alpha_loss": -3.9622445106506348, "alpha_value": 0.6746546626091003, "log_alpha_value": -0.39355432987213135, "target_entropy": -6.0, "policy_t": -0.026030415669083595, "mean_q": 12.820367813110352, "max_q": 13.164291381835938, "min_q": 12.45608901977539}, "td_error": [1.1536908149719238, 1.4628500938415527, 0.1938486099243164, 0.2714376449584961, 2.1951823234558105, 1.028536319732666, 0.33785009384155273, 1.7581233978271484, 1.7933001518249512, 0.9429831504821777, 0.8830528259277344, 4.349514484405518, 1.009507179260254, 0.7299623489379883, 1.288515567779541, 1.2301959991455078, 1.1658196449279785, 0.29303836822509766, 0.3186635971069336, 0.8716468811035156, 0.9655337333679199, 0.6251068115234375, 1.1009831428527832, 0.5601282119750977, 0.4947075843811035, 1.519803524017334, 2.6073527336120605, 0.12086200714111328, 0.9578356742858887, 1.3347163200378418, 1.6862983703613281, 1.0305290222167969, 1.1772150993347168, 1.3603978157043457, 1.0324726104736328, 1.5033679008483887, 1.2773399353027344, 0.9719266891479492, 1.3083314895629883, 0.9579401016235352, 0.614408016204834, 0.9475111961364746, 1.26408052444458, 0.2883753776550293, 0.8402776718139648, 0.44628238677978516, 0.22313880920410156, 1.8501310348510742, 0.15136337280273438, 1.0140786170959473, 1.4179086685180664, 0.688652515411377, 0.9701881408691406, 0.25428009033203125, 1.2978758811950684, 0.9080452919006348, 1.770197868347168, 0.6287970542907715, 0.026415348052978516, 1.0436968803405762, 0.7999958992004395, 0.8027091026306152, 1.818014144897461, 0.9533267021179199, 1.121300220489502, 1.2917671203613281, 1.104543685913086, 1.7608051300048828, 0.1698436737060547, 0.9982028007507324, 0.9111700057983398, 1.782930850982666, 1.0605840682983398, 0.9946928024291992, 1.6189842224121094, 1.5906243324279785, 1.2806954383850098, 2.3840370178222656, 1.4056835174560547, 1.7447543144226074, 1.1443514823913574, 0.7456574440002441, 0.8051228523254395, 0.3958902359008789, 0.7503528594970703, 0.67498779296875], "mean_td_error": 1.077061653137207, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1312.0, "diff_num_grad_updates_vs_sampler_policy": 1311.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094122886657715, "actor_loss": -15.5411376953125, "critic_loss": 0.13342316448688507, "alpha_loss": -3.9720962047576904, "alpha_value": 0.674687385559082, "log_alpha_value": -0.39350584149360657, "target_entropy": -6.0, "policy_t": 0.005085088312625885, "mean_q": 12.813910484313965, "max_q": 13.157535552978516, "min_q": 12.497247695922852}, "td_error": [1.5292606353759766, 0.18264102935791016, 0.5810065269470215, 2.707158088684082, 2.2619481086730957, 0.3209800720214844, 1.6121726036071777, 0.9766936302185059, 0.9275364875793457, 0.33396339416503906, 0.29358339309692383, 0.42318058013916016, 0.6478080749511719, 0.9611334800720215, 0.8592886924743652, 0.18982458114624023, 2.050795078277588, 1.2483444213867188, 1.7431588172912598, 1.3453574180603027, 1.5146303176879883, 0.8927745819091797, 0.3545408248901367, 2.6345062255859375, 0.2628798484802246, 1.663069725036621, 0.7264351844787598, 1.042684555053711, 1.321397304534912, 0.23541784286499023, 1.1514806747436523, 0.07513046264648438, 0.7953753471374512, 0.2576913833618164, 1.640885829925537, 0.8703813552856445, 0.27704668045043945, 2.027007579803467, 0.963005542755127, 3.2353906631469727, 0.23406410217285156, 0.5831384658813477, 1.7572822570800781, 0.839421272277832, 0.7404756546020508, 2.2771201133728027, 0.8372511863708496, 0.11754083633422852, 0.7059502601623535, 2.015030860900879, 0.04795026779174805, 0.40125608444213867, 1.7233123779296875, 1.2233710289001465, 2.1276321411132812, 0.9638972282409668, 0.5579013824462891, 0.44750404357910156, 0.3662090301513672, 0.6869769096374512, 1.1505169868469238, 1.3685393333435059, 1.4858598709106445, 0.4989480972290039, 1.944084644317627, 1.620460033416748, 1.450352668762207, 0.9991331100463867, 3.423647403717041, 0.40113306045532227, 0.5334100723266602, 1.3157362937927246, 1.6358628273010254, 1.6640405654907227, 0.015120506286621094, 1.4127507209777832, 1.7934012413024902, 0.23425865173339844, 0.9192719459533691, 0.1503162384033203, 1.7082972526550293, 0.483126163482666, 0.992734432220459, 1.2387909889221191, 0.7506470680236816, 1.1015820503234863], "mean_td_error": 1.0707311630249023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1312.0, "diff_num_grad_updates_vs_sampler_policy": 1311.0}}, "num_env_steps_sampled": 10682, "num_env_steps_trained": 338496, "num_agent_steps_sampled": 32046, "num_agent_steps_trained": 338496, "last_target_update_ts": 10682, "num_target_updates": 1312}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32046, "num_agent_steps_trained": 338496, "num_env_steps_sampled": 10682, "num_env_steps_trained": 338496, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.79262572587753, "num_env_steps_trained_throughput_per_sec": 2461.785348182343, "timesteps_total": 10682, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 32046, "timers": {"training_iteration_time_ms": 105.406, "sample_time_ms": 16.627, "load_time_ms": 0.308, "load_throughput": 837173.474, "learn_time_ms": 18.129, "learn_throughput": 14231.574, "synch_weights_time_ms": 10.22}, "counters": {"num_env_steps_sampled": 10682, "num_env_steps_trained": 338496, "num_agent_steps_sampled": 32046, "num_agent_steps_trained": 338496, "last_target_update_ts": 10682, "num_target_updates": 1312}, "done": false, "episodes_total": 0, "training_iteration": 91, "trial_id": "db258_00000", "date": "2023-11-16_21-50-30", "timestamp": 1700200230, "time_this_iter_s": 1.5826809406280518, "time_total_s": 142.20180368423462, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140cc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 142.20180368423462, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 32.666666666666664, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086856842041016, "actor_loss": -24.32554817199707, "critic_loss": 0.1034424677491188, "alpha_loss": -4.017587184906006, "alpha_value": 0.6714611053466797, "log_alpha_value": -0.3982992172241211, "target_entropy": -6.0, "policy_t": 0.029846608638763428, "mean_q": 21.645742416381836, "max_q": 22.111675262451172, "min_q": 21.23526954650879}, "td_error": [0.6263360977172852, 0.5853242874145508, 2.2305946350097656, 1.0984039306640625, 0.14834022521972656, 0.6468067169189453, 1.8199987411499023, 3.106295585632324, 0.36074352264404297, 0.4969921112060547, 0.8133983612060547, 2.027562141418457, 1.809128761291504, 0.03311634063720703, 0.6887035369873047, 0.27759552001953125, 0.15985679626464844, 0.14888286590576172, 1.8108768463134766, 1.3755931854248047, 0.5706939697265625, 0.9722042083740234, 1.3542890548706055, 1.9203605651855469, 1.9154586791992188, 0.03385448455810547, 1.1009788513183594, 1.3032665252685547, 0.16734027862548828, 1.0661048889160156, 0.7755832672119141, 0.49375152587890625, 1.3307743072509766, 2.103456497192383, 0.055950164794921875, 1.4907255172729492, 0.9247770309448242, 0.14278411865234375, 2.7531213760375977, 2.931753158569336, 1.8014812469482422, 2.1756839752197266, 0.22619247436523438, 0.08611392974853516, 0.4903831481933594, 1.3338603973388672, 0.8841066360473633, 1.767526626586914, 1.8897018432617188, 1.0794124603271484, 1.1696348190307617, 0.9955520629882812, 1.6843461990356445, 0.4801197052001953, 1.4838237762451172, 1.8581085205078125, 0.556370735168457, 1.6235971450805664, 0.559666633605957, 1.7673025131225586, 0.8529386520385742, 0.6547822952270508, 2.1367874145507812, 0.3881092071533203, 2.216106414794922, 0.8803396224975586, 0.19147872924804688, 1.6592063903808594, 1.3099298477172852, 0.9947042465209961, 0.3987236022949219, 1.5618057250976562, 1.6840429306030273, 1.8777704238891602, 0.8634204864501953, 1.4667425155639648, 0.8863887786865234, 1.8575162887573242, 0.29093265533447266, 1.3397502899169922, 0.8168630599975586, 1.1863327026367188, 0.5521106719970703, 0.6602334976196289, 0.8222866058349609, 1.5189476013183594], "mean_td_error": 1.1238722801208496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1327.0, "diff_num_grad_updates_vs_sampler_policy": 1326.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.095049858093262, "actor_loss": -15.75899600982666, "critic_loss": 0.10235394537448883, "alpha_loss": -4.018413543701172, "alpha_value": 0.671623170375824, "log_alpha_value": -0.39805781841278076, "target_entropy": -6.0, "policy_t": -0.04024248570203781, "mean_q": 13.031651496887207, "max_q": 13.611579895019531, "min_q": 12.638507843017578}, "td_error": [0.3052034378051758, 1.0214881896972656, 0.4785637855529785, 2.2011241912841797, 1.3041763305664062, 0.4052162170410156, 0.8492426872253418, 0.12314891815185547, 1.2758946418762207, 1.2180209159851074, 0.043274879455566406, 1.191133975982666, 0.7914810180664062, 0.2479872703552246, 0.5089406967163086, 0.5240025520324707, 1.3922233581542969, 1.5607528686523438, 1.7035369873046875, 1.9102091789245605, 2.0742626190185547, 1.5958127975463867, 0.2805333137512207, 0.7675895690917969, 1.427647590637207, 1.754624366760254, 1.6485710144042969, 1.85662841796875, 0.15959453582763672, 0.10721111297607422, 2.3542680740356445, 0.6233482360839844, 0.4231448173522949, 1.3158106803894043, 1.125023365020752, 0.06330394744873047, 0.7184534072875977, 1.1679368019104004, 0.5931811332702637, 1.7722725868225098, 1.1628713607788086, 0.24524307250976562, 1.0310564041137695, 0.6157989501953125, 0.406949520111084, 2.4814724922180176, 1.1593170166015625, 1.1741313934326172, 0.9319257736206055, 1.4591741561889648, 1.0039958953857422, 0.8709573745727539, 2.5839734077453613, 1.3460731506347656, 0.6494159698486328, 0.9289488792419434, 1.7758755683898926, 0.9760556221008301, 0.8602886199951172, 0.8987541198730469, 1.669935703277588, 0.6649513244628906, 1.7157349586486816, 0.5262670516967773, 1.7651700973510742, 1.4941015243530273, 1.1100878715515137, 1.8362369537353516, 0.35515308380126953, 0.968015193939209, 2.723446846008301, 1.3613386154174805, 0.1614360809326172, 0.777862548828125, 0.8635883331298828, 1.0232081413269043, 1.4178094863891602, 1.3014039993286133, 0.6756157875061035, 0.07236528396606445, 0.7682671546936035, 0.9046354293823242, 1.0356597900390625, 1.2823247909545898, 1.009279727935791, 0.37670183181762695], "mean_td_error": 1.0617176294326782, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1327.0, "diff_num_grad_updates_vs_sampler_policy": 1326.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070738792419434, "actor_loss": -15.479928970336914, "critic_loss": 0.13075727224349976, "alpha_loss": -4.008255481719971, "alpha_value": 0.6716552376747131, "log_alpha_value": -0.39801010489463806, "target_entropy": -6.0, "policy_t": 0.04770178720355034, "mean_q": 12.78609561920166, "max_q": 13.043758392333984, "min_q": 12.476602554321289}, "td_error": [0.9199709892272949, 0.7756586074829102, 1.1859874725341797, 1.3728752136230469, 0.7522411346435547, 0.5425548553466797, 0.6334867477416992, 1.1227893829345703, 3.224977493286133, 1.0888619422912598, 0.39517974853515625, 1.9962759017944336, 1.2239203453063965, 0.17158269882202148, 0.5547361373901367, 0.9039154052734375, 0.4602360725402832, 0.38643598556518555, 1.1618099212646484, 0.9339275360107422, 2.2484183311462402, 2.4181671142578125, 1.3754539489746094, 1.7799577713012695, 0.37233638763427734, 0.6841344833374023, 1.8248653411865234, 1.190788745880127, 0.34350109100341797, 2.438469886779785, 0.527252197265625, 0.605809211730957, 0.17652654647827148, 0.20704174041748047, 1.3519911766052246, 1.3806986808776855, 0.4609217643737793, 1.4822492599487305, 1.3245525360107422, 1.1822948455810547, 0.6821303367614746, 1.3013081550598145, 1.4418845176696777, 0.8041830062866211, 0.45587968826293945, 1.621316909790039, 0.2831840515136719, 1.8656229972839355, 0.5856504440307617, 0.6560544967651367, 1.7808837890625, 2.1591615676879883, 1.1184115409851074, 1.356109619140625, 1.7054758071899414, 0.542572021484375, 1.8614435195922852, 0.04265880584716797, 0.1968989372253418, 0.04650592803955078, 1.1488704681396484, 0.12154579162597656, 0.4136028289794922, 1.34635591506958, 0.13317584991455078, 1.089348316192627, 0.7789196968078613, 1.0032577514648438, 1.0613059997558594, 0.6895380020141602, 1.0188102722167969, 0.7693204879760742, 0.4448995590209961, 0.4752187728881836, 2.5736260414123535, 0.5765652656555176, 2.1874561309814453, 1.205291748046875, 1.1269588470458984, 1.702157974243164, 0.8685369491577148, 1.1038546562194824, 2.7318902015686035, 1.1045351028442383, 0.721135139465332, 1.0607852935791016], "mean_td_error": 1.0598506927490234, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1327.0, "diff_num_grad_updates_vs_sampler_policy": 1326.0}}, "num_env_steps_sampled": 10787, "num_env_steps_trained": 342366, "num_agent_steps_sampled": 32361, "num_agent_steps_trained": 342366, "last_target_update_ts": 10787, "num_target_updates": 1327}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32361, "num_agent_steps_trained": 342366, "num_env_steps_sampled": 10787, "num_env_steps_trained": 342366, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.63781461604212, "num_env_steps_trained_throughput_per_sec": 2456.079452991267, "timesteps_total": 10787, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 32361, "timers": {"training_iteration_time_ms": 105.165, "sample_time_ms": 15.515, "load_time_ms": 0.314, "load_throughput": 821850.408, "learn_time_ms": 17.718, "learn_throughput": 14561.635, "synch_weights_time_ms": 12.197}, "counters": {"num_env_steps_sampled": 10787, "num_env_steps_trained": 342366, "num_agent_steps_sampled": 32361, "num_agent_steps_trained": 342366, "last_target_update_ts": 10787, "num_target_updates": 1327}, "done": false, "episodes_total": 0, "training_iteration": 92, "trial_id": "db258_00000", "date": "2023-11-16_21-50-32", "timestamp": 1700200232, "time_this_iter_s": 1.5854079723358154, "time_total_s": 143.78721165657043, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0623e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 143.78721165657043, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 63.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.069595336914062, "actor_loss": -24.708396911621094, "critic_loss": 0.08777417987585068, "alpha_loss": -4.0561017990112305, "alpha_value": 0.6684412360191345, "log_alpha_value": -0.40280681848526, "target_entropy": -6.0, "policy_t": -0.009176461026072502, "mean_q": 22.057668685913086, "max_q": 22.534536361694336, "min_q": 21.665821075439453}, "td_error": [0.7308273315429688, 0.41483497619628906, 1.0558900833129883, 1.3765268325805664, 1.3080577850341797, 0.057491302490234375, 0.23563766479492188, 2.257073402404785, 1.0476064682006836, 0.22233200073242188, 0.2554435729980469, 1.8069610595703125, 1.2572460174560547, 1.4140949249267578, 1.4744863510131836, 0.811915397644043, 1.0599517822265625, 0.03469657897949219, 0.8100700378417969, 1.4883651733398438, 0.6640901565551758, 0.5501508712768555, 1.3756599426269531, 0.284698486328125, 0.7587070465087891, 2.2367935180664062, 1.4096431732177734, 0.6198282241821289, 0.06813240051269531, 0.4463014602661133, 1.304962158203125, 1.0662336349487305, 1.655874252319336, 1.192068099975586, 0.5795669555664062, 0.4251880645751953, 1.3249006271362305, 1.4824256896972656, 2.307882308959961, 0.7567119598388672, 0.7497940063476562, 1.789259910583496, 1.7082958221435547, 1.1756105422973633, 0.543304443359375, 1.7866744995117188, 0.18814659118652344, 1.6442203521728516, 1.249485969543457, 1.7139654159545898, 0.1557931900024414, 1.143284797668457, 0.6736783981323242, 1.535048484802246, 0.35075950622558594, 0.5303020477294922, 1.5150909423828125, 0.033354759216308594, 1.626861572265625, 0.7980785369873047, 1.244314193725586, 0.18793773651123047, 0.8481721878051758, 0.6686038970947266, 0.42044639587402344, 0.33820343017578125, 0.26865100860595703, 1.8128767013549805, 1.3291902542114258, 0.24933910369873047, 2.785386085510254, 0.6674165725708008, 1.8839473724365234, 1.3489952087402344, 0.6098995208740234, 1.3385047912597656, 0.4631376266479492, 2.4610538482666016, 1.8707246780395508, 0.16410255432128906, 0.7030744552612305, 1.540421485900879, 1.5603227615356445, 0.4513874053955078, 0.784022331237793, 0.4273538589477539], "mean_td_error": 1.011253833770752, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1342.0, "diff_num_grad_updates_vs_sampler_policy": 1341.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.138060569763184, "actor_loss": -15.689752578735352, "critic_loss": 0.11895404756069183, "alpha_loss": -4.08119010925293, "alpha_value": 0.668605387210846, "log_alpha_value": -0.4025612771511078, "target_entropy": -6.0, "policy_t": -0.009859846904873848, "mean_q": 13.009076118469238, "max_q": 13.382027626037598, "min_q": 12.664942741394043}, "td_error": [2.3325295448303223, 0.39861202239990234, 0.17706584930419922, 1.129927635192871, 2.527374744415283, 1.005112648010254, 1.0339469909667969, 0.20482349395751953, 0.8021125793457031, 0.7148070335388184, 1.339357852935791, 0.2650165557861328, 0.06279802322387695, 1.814669132232666, 1.284515380859375, 1.544489860534668, 2.073812484741211, 1.1589837074279785, 0.5658988952636719, 0.996455192565918, 1.604557991027832, 1.1807336807250977, 0.9236974716186523, 2.04019832611084, 1.9023122787475586, 1.8394379615783691, 2.3846688270568848, 0.44397592544555664, 0.38103675842285156, 0.44173765182495117, 0.5618772506713867, 1.5410747528076172, 0.6404428482055664, 0.6545109748840332, 1.141495704650879, 1.1517152786254883, 2.571321964263916, 0.5802726745605469, 0.38687992095947266, 1.281144618988037, 1.1448993682861328, 1.1635675430297852, 1.8455939292907715, 0.9116568565368652, 1.0761213302612305, 2.322002410888672, 0.20914506912231445, 2.184865951538086, 2.6147122383117676, 0.7974658012390137, 1.7503433227539062, 0.6865520477294922, 1.5077705383300781, 1.2782487869262695, 1.136458396911621, 0.9318094253540039, 1.2549195289611816, 0.8555693626403809, 0.6954407691955566, 1.0867185592651367, 0.7295775413513184, 1.9161782264709473, 1.3093643188476562, 1.1071066856384277, 0.9567098617553711, 0.47508811950683594, 0.7202939987182617, 0.6347541809082031, 1.645965576171875, 0.6775035858154297, 1.0825929641723633, 0.40215158462524414, 0.5913839340209961, 2.2693872451782227, 0.1448831558227539, 1.4795427322387695, 1.353135585784912, 1.3588371276855469, 0.24150609970092773, 2.3789405822753906, 0.5026679039001465, 1.4172286987304688, 0.8584995269775391, 1.5936784744262695, 3.058161735534668, 2.3677353858947754], "mean_td_error": 1.1838620901107788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1342.0, "diff_num_grad_updates_vs_sampler_policy": 1341.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131495475769043, "actor_loss": -15.880606651306152, "critic_loss": 0.13191592693328857, "alpha_loss": -4.078044414520264, "alpha_value": 0.6686385869979858, "log_alpha_value": -0.4025115966796875, "target_entropy": -6.0, "policy_t": -0.009231870993971825, "mean_q": 13.161652565002441, "max_q": 13.547418594360352, "min_q": 12.878361701965332}, "td_error": [0.8455805778503418, 0.9483327865600586, 0.8941464424133301, 0.9572849273681641, 0.8870868682861328, 0.8582906723022461, 1.2405390739440918, 1.0641217231750488, 0.2973518371582031, 0.406036376953125, 1.269190788269043, 0.23027515411376953, 0.7419133186340332, 1.1066489219665527, 1.566366195678711, 0.458463191986084, 1.1450715065002441, 0.9257235527038574, 0.18976116180419922, 0.7521352767944336, 0.8022947311401367, 0.09934854507446289, 1.885025978088379, 1.8087353706359863, 0.41231822967529297, 2.9790353775024414, 1.9788284301757812, 1.323028564453125, 0.5209550857543945, 0.7174758911132812, 1.8218750953674316, 0.4070448875427246, 1.3640861511230469, 2.220885753631592, 0.5110177993774414, 0.5396862030029297, 0.8841094970703125, 0.5579423904418945, 1.8696331977844238, 0.7032661437988281, 1.1505231857299805, 1.614995002746582, 0.6326751708984375, 0.9527263641357422, 1.2353487014770508, 0.4138522148132324, 2.2319250106811523, 0.5438199043273926, 0.7424983978271484, 1.3969783782958984, 1.0648198127746582, 0.6597113609313965, 1.2858200073242188, 0.21317768096923828, 0.38737010955810547, 1.118070125579834, 2.5087480545043945, 0.4835538864135742, 1.342658519744873, 1.1219654083251953, 2.2687602043151855, 1.7080669403076172, 1.555300235748291, 2.351789951324463, 1.6005983352661133, 0.6994357109069824, 1.1439127922058105, 1.5273418426513672, 0.5852112770080566, 0.6029243469238281, 1.7449722290039062, 0.4307699203491211, 0.7526655197143555, 1.2778005599975586, 1.1844196319580078, 1.5772042274475098, 1.3585643768310547, 0.7574934959411621, 0.9435176849365234, 1.462289810180664, 0.6832289695739746, 0.7830934524536133, 1.7223124504089355, 0.7625350952148438, 0.8771977424621582, 0.13749980926513672], "mean_td_error": 1.0673378705978394, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1342.0, "diff_num_grad_updates_vs_sampler_policy": 1341.0}}, "num_env_steps_sampled": 10892, "num_env_steps_trained": 346236, "num_agent_steps_sampled": 32676, "num_agent_steps_trained": 346236, "last_target_update_ts": 10892, "num_target_updates": 1342}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32676, "num_agent_steps_trained": 346236, "num_env_steps_sampled": 10892, "num_env_steps_trained": 346236, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.78103496756636, "num_env_steps_trained_throughput_per_sec": 2498.215288804589, "timesteps_total": 10892, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 32676, "timers": {"training_iteration_time_ms": 102.873, "sample_time_ms": 15.385, "load_time_ms": 0.308, "load_throughput": 836849.766, "learn_time_ms": 17.626, "learn_throughput": 14637.131, "synch_weights_time_ms": 10.073}, "counters": {"num_env_steps_sampled": 10892, "num_env_steps_trained": 346236, "num_agent_steps_sampled": 32676, "num_agent_steps_trained": 346236, "last_target_update_ts": 10892, "num_target_updates": 1342}, "done": false, "episodes_total": 0, "training_iteration": 93, "trial_id": "db258_00000", "date": "2023-11-16_21-50-33", "timestamp": 1700200233, "time_this_iter_s": 1.5584237575531006, "time_total_s": 145.34563541412354, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e1409a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 145.34563541412354, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 31.55, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109577178955078, "actor_loss": -24.918806076049805, "critic_loss": 0.08193203806877136, "alpha_loss": -4.117762088775635, "alpha_value": 0.6654359102249146, "log_alpha_value": -0.40731295943260193, "target_entropy": -6.0, "policy_t": -0.014494014903903008, "mean_q": 22.248027801513672, "max_q": 22.614212036132812, "min_q": 21.857120513916016}, "td_error": [0.700526237487793, 0.5246124267578125, 0.1379404067993164, 0.2638664245605469, 0.56463623046875, 0.5658435821533203, 1.3142967224121094, 1.4629650115966797, 0.1770486831665039, 1.4202346801757812, 1.1068077087402344, 0.6317024230957031, 1.414240837097168, 0.5959072113037109, 0.7857093811035156, 1.4956398010253906, 0.37847328186035156, 1.5781278610229492, 0.3109254837036133, 0.5670080184936523, 2.013355255126953, 1.027602195739746, 1.9603939056396484, 1.312265396118164, 0.17017650604248047, 0.9160375595092773, 0.48590564727783203, 1.2328929901123047, 0.23708629608154297, 1.0201711654663086, 1.3173408508300781, 1.1920404434204102, 0.42151641845703125, 2.0319080352783203, 0.4181547164916992, 0.678471565246582, 0.9538202285766602, 0.39359283447265625, 0.3372678756713867, 1.0733356475830078, 1.816131591796875, 0.36479759216308594, 2.414301872253418, 1.0143394470214844, 0.1331005096435547, 0.4700946807861328, 0.5552883148193359, 2.0164060592651367, 0.23660850524902344, 1.8134708404541016, 1.5608711242675781, 0.055217742919921875, 0.5841884613037109, 0.9605312347412109, 1.2229938507080078, 1.9904842376708984, 1.6125764846801758, 1.3615531921386719, 0.06589317321777344, 0.7082996368408203, 1.4761333465576172, 0.5447635650634766, 1.5332221984863281, 0.39862060546875, 0.628565788269043, 1.1443843841552734, 1.278822898864746, 1.6855506896972656, 3.024411201477051, 0.92303466796875, 1.6259479522705078, 0.8021039962768555, 0.5472621917724609, 1.683584213256836, 0.909820556640625, 1.338719367980957, 0.8814277648925781, 0.5674972534179688, 0.4061613082885742, 1.0926570892333984, 1.133143424987793, 0.6102733612060547, 0.15109634399414062, 0.274932861328125, 0.07867431640625, 0.927952766418457], "mean_td_error": 0.9513460993766785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1357.0, "diff_num_grad_updates_vs_sampler_policy": 1356.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129610061645508, "actor_loss": -15.731593132019043, "critic_loss": 0.10427873581647873, "alpha_loss": -4.123440265655518, "alpha_value": 0.6655989289283752, "log_alpha_value": -0.40706801414489746, "target_entropy": -6.0, "policy_t": -0.025688646361231804, "mean_q": 13.009632110595703, "max_q": 13.402495384216309, "min_q": 12.603076934814453}, "td_error": [0.8261370658874512, 0.47911500930786133, 1.780099868774414, 0.48741579055786133, 0.1026759147644043, 0.4815540313720703, 1.8941774368286133, 1.4867539405822754, 1.2319750785827637, 1.7245845794677734, 0.39000415802001953, 0.5973453521728516, 1.329599380493164, 1.3575353622436523, 0.42110347747802734, 0.9400043487548828, 0.3954606056213379, 1.2729377746582031, 0.2644023895263672, 2.2941393852233887, 0.8922319412231445, 0.6055779457092285, 0.6110000610351562, 1.5152316093444824, 1.17388916015625, 0.8053722381591797, 1.4563636779785156, 1.4676671028137207, 1.067427158355713, 1.474198341369629, 0.5231466293334961, 1.4014148712158203, 0.1133279800415039, 0.9979791641235352, 0.2427215576171875, 1.0686473846435547, 0.6121277809143066, 2.3514351844787598, 0.7170619964599609, 0.9902639389038086, 1.3412013053894043, 1.9244513511657715, 0.5664243698120117, 1.4309005737304688, 1.236189842224121, 0.2847743034362793, 0.06259775161743164, 1.5545735359191895, 1.390491008758545, 0.4891533851623535, 2.1000804901123047, 0.6981077194213867, 1.2817535400390625, 1.4962706565856934, 2.5341625213623047, 1.7108144760131836, 0.7151575088500977, 2.531374931335449, 1.5411052703857422, 0.9174337387084961, 0.20175933837890625, 0.9052629470825195, 0.6436738967895508, 0.746953010559082, 1.1545124053955078, 0.8343400955200195, 1.5094776153564453, 1.0164151191711426, 1.2145166397094727, 0.7637448310852051, 0.9251656532287598, 0.7904329299926758, 0.6316413879394531, 0.8490824699401855, 1.4640998840332031, 1.6516823768615723, 1.7015352249145508, 0.1705169677734375, 1.9584941864013672, 1.1794495582580566, 1.0852336883544922, 1.0696673393249512, 0.7193031311035156, 0.7151832580566406, 0.7389888763427734, 1.2305431365966797], "mean_td_error": 1.064218521118164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1357.0, "diff_num_grad_updates_vs_sampler_policy": 1356.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.201143264770508, "actor_loss": -15.835405349731445, "critic_loss": 0.13151083886623383, "alpha_loss": -4.1520185470581055, "alpha_value": 0.6656342148780823, "log_alpha_value": -0.40701496601104736, "target_entropy": -6.0, "policy_t": 0.02310134842991829, "mean_q": 13.098685264587402, "max_q": 13.484464645385742, "min_q": 12.625161170959473}, "td_error": [0.46338558197021484, 0.07708978652954102, 0.16221094131469727, 0.8212003707885742, 2.011366367340088, 1.2070388793945312, 0.7478652000427246, 1.0122098922729492, 1.3583369255065918, 1.3338627815246582, 0.6589460372924805, 0.4393277168273926, 1.1802277565002441, 1.1168503761291504, 0.9037747383117676, 1.044541358947754, 1.3567709922790527, 1.5766777992248535, 0.9619898796081543, 1.1220998764038086, 1.800279140472412, 1.7989654541015625, 0.4899330139160156, 0.3379335403442383, 1.1601858139038086, 0.7327671051025391, 0.4899601936340332, 1.7404279708862305, 0.4383997917175293, 2.531343936920166, 0.2196025848388672, 1.6799135208129883, 1.103189468383789, 0.6922798156738281, 0.7747535705566406, 1.4294085502624512, 0.9726772308349609, 0.07581281661987305, 0.8879423141479492, 0.36280250549316406, 1.5075011253356934, 2.2052884101867676, 1.3271303176879883, 0.10059738159179688, 0.8273119926452637, 1.4839134216308594, 0.2433781623840332, 1.630767822265625, 1.9169130325317383, 0.4911956787109375, 0.902094841003418, 0.30714845657348633, 1.0581440925598145, 0.47327566146850586, 0.500666618347168, 0.5646762847900391, 1.4640202522277832, 0.8400759696960449, 0.12424230575561523, 1.520111083984375, 0.9267439842224121, 0.7262229919433594, 1.7624378204345703, 1.8735833168029785, 1.4619245529174805, 0.25962018966674805, 1.1238985061645508, 1.8100805282592773, 1.4661617279052734, 2.181562900543213, 0.7322449684143066, 2.1955862045288086, 0.0729684829711914, 0.8981294631958008, 1.3898119926452637, 0.12177324295043945, 1.4971294403076172, 0.34952211380004883, 1.783090591430664, 0.42095375061035156, 1.437544345855713, 0.6241588592529297, 0.5801191329956055, 2.5313501358032227, 2.018131732940674, 1.5716829299926758], "mean_td_error": 1.0532469749450684, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1357.0, "diff_num_grad_updates_vs_sampler_policy": 1356.0}}, "num_env_steps_sampled": 10997, "num_env_steps_trained": 350106, "num_agent_steps_sampled": 32991, "num_agent_steps_trained": 350106, "last_target_update_ts": 10997, "num_target_updates": 1357}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32991, "num_agent_steps_trained": 350106, "num_env_steps_sampled": 10997, "num_env_steps_trained": 350106, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.37563558323731, "num_env_steps_trained_throughput_per_sec": 2483.2734257821753, "timesteps_total": 10997, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 32991, "timers": {"training_iteration_time_ms": 104.222, "sample_time_ms": 15.843, "load_time_ms": 0.315, "load_throughput": 819671.589, "learn_time_ms": 18.053, "learn_throughput": 14290.889, "synch_weights_time_ms": 10.117}, "counters": {"num_env_steps_sampled": 10997, "num_env_steps_trained": 350106, "num_agent_steps_sampled": 32991, "num_agent_steps_trained": 350106, "last_target_update_ts": 10997, "num_target_updates": 1357}, "done": false, "episodes_total": 0, "training_iteration": 94, "trial_id": "db258_00000", "date": "2023-11-16_21-50-35", "timestamp": 1700200235, "time_this_iter_s": 1.5674152374267578, "time_total_s": 146.9130506515503, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 146.9130506515503, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.26666666666667, "ram_util_percent": 63.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087409973144531, "actor_loss": -24.819162368774414, "critic_loss": 0.11012069880962372, "alpha_loss": -4.154201507568359, "alpha_value": 0.662443220615387, "log_alpha_value": -0.4118204116821289, "target_entropy": -6.0, "policy_t": 0.03957079350948334, "mean_q": 22.15732765197754, "max_q": 22.613811492919922, "min_q": 21.818008422851562}, "td_error": [1.5194873809814453, 0.25647640228271484, 0.31893348693847656, 1.2521142959594727, 0.821690559387207, 0.9552459716796875, 1.5206146240234375, 3.012613296508789, 1.2420234680175781, 1.0037946701049805, 0.3443489074707031, 1.199601173400879, 1.2067241668701172, 1.6089210510253906, 0.9686613082885742, 1.8314266204833984, 0.42305660247802734, 1.0864620208740234, 2.0443639755249023, 2.4407176971435547, 0.17009449005126953, 0.2469949722290039, 0.1097555160522461, 1.6259346008300781, 1.1464452743530273, 2.293336868286133, 0.4828777313232422, 0.39214038848876953, 1.058863639831543, 1.5210628509521484, 0.03978443145751953, 1.8972625732421875, 0.11395835876464844, 1.0171527862548828, 0.736231803894043, 1.5718364715576172, 1.0057544708251953, 0.6378688812255859, 1.6625547409057617, 1.8292932510375977, 0.8205547332763672, 2.4748153686523438, 1.391860008239746, 1.2000961303710938, 0.22545623779296875, 1.1874885559082031, 1.002145767211914, 0.2284231185913086, 0.14335346221923828, 0.7828788757324219, 0.23448562622070312, 2.403000831604004, 1.5631990432739258, 1.7629375457763672, 1.0547466278076172, 1.625575065612793, 2.9604101181030273, 1.246774673461914, 2.5169525146484375, 1.1898632049560547, 0.9747037887573242, 0.6297264099121094, 1.1366195678710938, 0.370208740234375, 0.823451042175293, 1.9374408721923828, 0.43474674224853516, 0.48586273193359375, 0.31118297576904297, 1.0897016525268555, 2.7415523529052734, 1.0600881576538086, 2.0630369186401367, 2.1406898498535156, 2.5487728118896484, 0.6688747406005859, 0.41942787170410156, 3.318521499633789, 0.4369335174560547, 0.7842483520507812, 1.2688217163085938, 1.3770074844360352, 1.2355527877807617, 1.3971843719482422, 1.6484994888305664, 0.5267324447631836], "mean_td_error": 1.1914080381393433, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1372.0, "diff_num_grad_updates_vs_sampler_policy": 1371.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.086325645446777, "actor_loss": -15.826441764831543, "critic_loss": 0.11183203756809235, "alpha_loss": -4.151263236999512, "alpha_value": 0.6626068949699402, "log_alpha_value": -0.4115733802318573, "target_entropy": -6.0, "policy_t": 0.010830612853169441, "mean_q": 13.192112922668457, "max_q": 13.559694290161133, "min_q": 12.826130867004395}, "td_error": [0.44790029525756836, 2.7206501960754395, 1.8226628303527832, 0.4678521156311035, 0.352691650390625, 1.5124726295471191, 1.2196931838989258, 0.4798297882080078, 1.1352195739746094, 2.484152317047119, 1.573720932006836, 0.2558555603027344, 0.6445674896240234, 0.3828749656677246, 0.3099822998046875, 1.3979802131652832, 1.2059893608093262, 0.04268980026245117, 0.9685964584350586, 0.7681660652160645, 2.4902610778808594, 0.4140334129333496, 2.042585849761963, 2.012749671936035, 0.4920945167541504, 2.6313424110412598, 0.8163261413574219, 1.574345588684082, 1.0985169410705566, 1.0169157981872559, 0.715240478515625, 0.3521294593811035, 0.9666380882263184, 0.9922127723693848, 0.7250509262084961, 1.852555274963379, 1.3009977340698242, 1.0652198791503906, 1.3311195373535156, 0.7380228042602539, 1.7170157432556152, 1.7251911163330078, 0.8486042022705078, 0.5913810729980469, 1.1128268241882324, 3.193497657775879, 1.5105671882629395, 1.1006441116333008, 0.18669843673706055, 2.0539870262145996, 0.2947216033935547, 1.7726497650146484, 0.9787049293518066, 0.47260522842407227, 1.3771719932556152, 1.6117157936096191, 1.559823989868164, 0.7520065307617188, 0.7859797477722168, 1.6113739013671875, 0.8544425964355469, 0.5550746917724609, 1.3617362976074219, 0.7274017333984375, 0.19417142868041992, 0.9221949577331543, 2.3300633430480957, 0.9136519432067871, 0.3864474296569824, 0.8170576095581055, 0.905850887298584, 1.408210277557373, 1.18611478805542, 1.0567355155944824, 0.38845300674438477, 1.086151123046875, 0.7925491333007812, 1.9442033767700195, 0.5751476287841797, 2.4013657569885254, 1.5157122611999512, 1.5147466659545898, 1.84437894821167, 0.08546924591064453, 0.8164286613464355, 1.1218771934509277], "mean_td_error": 1.1370315551757812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1372.0, "diff_num_grad_updates_vs_sampler_policy": 1371.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130880355834961, "actor_loss": -15.91640853881836, "critic_loss": 0.11701391637325287, "alpha_loss": -4.169073104858398, "alpha_value": 0.6626414060592651, "log_alpha_value": -0.4115212857723236, "target_entropy": -6.0, "policy_t": 0.04084235057234764, "mean_q": 13.246561050415039, "max_q": 13.562467575073242, "min_q": 12.7874174118042}, "td_error": [0.6064486503601074, 2.196195125579834, 1.26947021484375, 1.3595080375671387, 1.276865005493164, 1.7730131149291992, 1.820058822631836, 0.7691035270690918, 0.037653446197509766, 1.0691170692443848, 0.8325343132019043, 2.2955312728881836, 0.7317819595336914, 1.0232739448547363, 0.9777450561523438, 0.5677766799926758, 1.138033390045166, 0.46080446243286133, 0.6134285926818848, 1.4938263893127441, 0.4869532585144043, 0.581636905670166, 0.22952747344970703, 0.6013240814208984, 0.4302659034729004, 0.17823028564453125, 1.285733699798584, 0.04810619354248047, 0.6907806396484375, 0.902977466583252, 0.616612434387207, 0.18551349639892578, 0.9027390480041504, 1.1390271186828613, 1.1459269523620605, 0.7841429710388184, 1.7376446723937988, 0.8941812515258789, 0.6679177284240723, 1.5815448760986328, 1.9038801193237305, 1.0283818244934082, 0.4027228355407715, 0.06958436965942383, 1.3830633163452148, 1.885580062866211, 1.3433141708374023, 2.4949822425842285, 0.47845935821533203, 0.440096378326416, 0.676508903503418, 1.0335884094238281, 2.442042350769043, 0.9359579086303711, 0.849757194519043, 0.13027381896972656, 1.1524667739868164, 1.3256940841674805, 0.40174007415771484, 0.7888984680175781, 0.22556018829345703, 1.0886268615722656, 0.980010986328125, 1.4929852485656738, 0.5725255012512207, 0.475308895111084, 0.22489118576049805, 0.5735917091369629, 2.066373348236084, 0.8219203948974609, 0.9132757186889648, 0.9737210273742676, 2.3875370025634766, 0.8734631538391113, 1.3447222709655762, 0.9730229377746582, 0.5407447814941406, 1.0615453720092773, 1.6370139122009277, 0.47171640396118164, 1.4330034255981445, 0.510706901550293, 0.5138587951660156, 0.8553647994995117, 0.41110801696777344, 2.769129753112793], "mean_td_error": 0.9856009483337402, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1372.0, "diff_num_grad_updates_vs_sampler_policy": 1371.0}}, "num_env_steps_sampled": 11102, "num_env_steps_trained": 353976, "num_agent_steps_sampled": 33306, "num_agent_steps_trained": 353976, "last_target_update_ts": 11102, "num_target_updates": 1372}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33306, "num_agent_steps_trained": 353976, "num_env_steps_sampled": 11102, "num_env_steps_trained": 353976, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.78684608451093, "num_env_steps_trained_throughput_per_sec": 2498.429469971974, "timesteps_total": 11102, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 33306, "timers": {"training_iteration_time_ms": 103.818, "sample_time_ms": 16.352, "load_time_ms": 0.307, "load_throughput": 839576.718, "learn_time_ms": 17.476, "learn_throughput": 14763.155, "synch_weights_time_ms": 9.932}, "counters": {"num_env_steps_sampled": 11102, "num_env_steps_trained": 353976, "num_agent_steps_sampled": 33306, "num_agent_steps_trained": 353976, "last_target_update_ts": 11102, "num_target_updates": 1372}, "done": false, "episodes_total": 0, "training_iteration": 95, "trial_id": "db258_00000", "date": "2023-11-16_21-50-37", "timestamp": 1700200237, "time_this_iter_s": 1.5577239990234375, "time_total_s": 148.47077465057373, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 148.47077465057373, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 31.65, "ram_util_percent": 63.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057241439819336, "actor_loss": -24.970623016357422, "critic_loss": 0.09398148953914642, "alpha_loss": -4.187131881713867, "alpha_value": 0.659462571144104, "log_alpha_value": -0.4163300693035126, "target_entropy": -6.0, "policy_t": 0.038095179945230484, "mean_q": 22.312814712524414, "max_q": 23.00111198425293, "min_q": 21.891895294189453}, "td_error": [1.4758939743041992, 1.4345636367797852, 0.1483478546142578, 1.3032093048095703, 1.2324628829956055, 1.715301513671875, 0.14923095703125, 0.2829475402832031, 0.13640403747558594, 0.8960275650024414, 0.5010566711425781, 1.872450828552246, 1.7328929901123047, 0.5097599029541016, 0.6190738677978516, 2.0466880798339844, 0.7120466232299805, 0.5179233551025391, 0.892298698425293, 0.09503936767578125, 0.42919921875, 1.0423555374145508, 2.605478286743164, 1.9495820999145508, 1.887415885925293, 0.13092041015625, 0.9754161834716797, 1.6988296508789062, 0.7595672607421875, 0.16256332397460938, 0.5080204010009766, 0.782038688659668, 2.743472099304199, 1.7020196914672852, 0.8673992156982422, 0.9438333511352539, 0.9760198593139648, 1.074941635131836, 0.6864852905273438, 0.3537883758544922, 0.44023799896240234, 1.436924934387207, 0.47796630859375, 2.0343503952026367, 1.7129135131835938, 0.5884265899658203, 1.269963264465332, 1.8949270248413086, 1.1158161163330078, 0.8532247543334961, 0.827418327331543, 1.3664798736572266, 0.7692327499389648, 0.11507892608642578, 0.964299201965332, 0.18436717987060547, 1.5342559814453125, 2.5629777908325195, 1.4162273406982422, 0.6172962188720703, 1.109135627746582, 0.8514041900634766, 0.8997974395751953, 1.4271621704101562, 0.7280311584472656, 0.24408721923828125, 2.2334632873535156, 2.6242237091064453, 0.23249530792236328, 1.3546504974365234, 1.0633554458618164, 0.780914306640625, 2.703690528869629, 0.9647941589355469, 0.8356609344482422, 0.7215518951416016, 0.9739751815795898, 1.1116085052490234, 0.3651447296142578, 1.1006803512573242, 0.3364734649658203, 1.3770875930786133, 0.573054313659668, 1.0717239379882812, 0.2037181854248047, 2.1725006103515625], "mean_td_error": 1.0557643175125122, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1387.0, "diff_num_grad_updates_vs_sampler_policy": 1386.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11329174041748, "actor_loss": -15.819422721862793, "critic_loss": 0.1116323322057724, "alpha_loss": -4.207923889160156, "alpha_value": 0.6596285104751587, "log_alpha_value": -0.41607850790023804, "target_entropy": -6.0, "policy_t": 0.006666614208370447, "mean_q": 13.142984390258789, "max_q": 13.533262252807617, "min_q": 12.76632308959961}, "td_error": [0.23787832260131836, 1.24591064453125, 0.7596707344055176, 0.7396907806396484, 0.6341152191162109, 2.051283836364746, 0.5672450065612793, 1.5357561111450195, 0.49137258529663086, 0.8741707801818848, 2.1093788146972656, 2.0464439392089844, 1.6600027084350586, 0.3650059700012207, 1.0259170532226562, 0.24082136154174805, 1.207268238067627, 1.3497505187988281, 2.066054344177246, 1.3447389602661133, 2.273374557495117, 0.6831436157226562, 1.7068533897399902, 1.2034425735473633, 2.551980972290039, 1.9444007873535156, 1.3507165908813477, 0.15657806396484375, 1.0200166702270508, 1.429300308227539, 1.9301400184631348, 1.5714316368103027, 0.6535172462463379, 0.5849723815917969, 0.46062803268432617, 1.1245718002319336, 0.20763826370239258, 0.8529443740844727, 1.290018081665039, 1.092331886291504, 0.8466100692749023, 0.2218484878540039, 2.1615524291992188, 1.5627784729003906, 1.9083375930786133, 1.3897290229797363, 0.38873863220214844, 2.836758613586426, 0.9184207916259766, 0.5948486328125, 0.5327186584472656, 0.45896053314208984, 1.7683110237121582, 0.46485090255737305, 1.5864567756652832, 0.5570921897888184, 1.3040070533752441, 0.5962486267089844, 1.0319209098815918, 0.7481627464294434, 0.44062376022338867, 0.1560535430908203, 1.7910990715026855, 1.679741382598877, 1.1117167472839355, 2.3124117851257324, 1.7995405197143555, 1.3105216026306152, 1.0646400451660156, 0.8178181648254395, 1.0865263938903809, 2.1390304565429688, 0.6145105361938477, 0.4600229263305664, 1.4152960777282715, 0.7144742012023926, 1.4551420211791992, 1.6210699081420898, 0.9421744346618652, 1.1299004554748535, 2.0879592895507812, 1.4625091552734375, 0.43999624252319336, 0.22973918914794922, 0.4994049072265625, 0.13284540176391602], "mean_td_error": 1.132948875427246, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1387.0, "diff_num_grad_updates_vs_sampler_policy": 1386.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.141210556030273, "actor_loss": -16.132471084594727, "critic_loss": 0.15028154850006104, "alpha_loss": -4.2189764976501465, "alpha_value": 0.6596651673316956, "log_alpha_value": -0.4160228967666626, "target_entropy": -6.0, "policy_t": 0.017772745341062546, "mean_q": 13.406112670898438, "max_q": 13.92337417602539, "min_q": 13.131690979003906}, "td_error": [1.068680763244629, 1.0533957481384277, 1.5342159271240234, 0.4294590950012207, 1.3378229141235352, 1.3718371391296387, 1.1125264167785645, 0.6579189300537109, 1.185842514038086, 0.04244279861450195, 1.11806058883667, 1.4662623405456543, 0.45297670364379883, 2.5096263885498047, 0.5905981063842773, 0.5524730682373047, 1.5076770782470703, 0.6065831184387207, 0.4478139877319336, 0.49305295944213867, 0.9610090255737305, 1.495065689086914, 0.41796350479125977, 0.4046492576599121, 1.226954460144043, 1.0222434997558594, 3.062483310699463, 0.2003345489501953, 0.7073330879211426, 0.8629417419433594, 0.12824153900146484, 1.4065914154052734, 0.8860683441162109, 1.3929290771484375, 0.26909732818603516, 2.3982038497924805, 0.907196044921875, 1.003458023071289, 2.1584153175354004, 1.0939555168151855, 3.6906299591064453, 0.6426844596862793, 0.2951335906982422, 0.8327240943908691, 2.106419563293457, 0.5098505020141602, 2.5565829277038574, 1.5700950622558594, 3.2371511459350586, 2.9964780807495117, 0.11122322082519531, 0.7904767990112305, 0.3802671432495117, 0.8154501914978027, 1.1360349655151367, 1.6050467491149902, 0.2591571807861328, 0.9936013221740723, 1.9425549507141113, 0.8638796806335449, 3.0730371475219727, 1.6087455749511719, 2.166107654571533, 0.8186798095703125, 0.6853585243225098, 1.2296028137207031, 2.3323822021484375, 0.8874640464782715, 0.47081947326660156, 0.5487289428710938, 0.9174127578735352, 1.7571754455566406, 0.7659335136413574, 1.408102035522461, 1.367478847503662, 1.6209220886230469, 0.32266950607299805, 0.07709503173828125, 1.1217546463012695, 1.5314364433288574, 0.8332729339599609, 2.1562252044677734, 1.1347942352294922, 1.8438358306884766, 0.9402594566345215, 1.3729333877563477], "mean_td_error": 1.1845589876174927, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1387.0, "diff_num_grad_updates_vs_sampler_policy": 1386.0}}, "num_env_steps_sampled": 11207, "num_env_steps_trained": 357846, "num_agent_steps_sampled": 33621, "num_agent_steps_trained": 357846, "last_target_update_ts": 11207, "num_target_updates": 1387}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33621, "num_agent_steps_trained": 357846, "num_env_steps_sampled": 11207, "num_env_steps_trained": 357846, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.47719437055115, "num_env_steps_trained_throughput_per_sec": 2487.0165925145993, "timesteps_total": 11207, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 33621, "timers": {"training_iteration_time_ms": 104.658, "sample_time_ms": 15.943, "load_time_ms": 0.317, "load_throughput": 814366.671, "learn_time_ms": 18.322, "learn_throughput": 14081.586, "synch_weights_time_ms": 10.123}, "counters": {"num_env_steps_sampled": 11207, "num_env_steps_trained": 357846, "num_agent_steps_sampled": 33621, "num_agent_steps_trained": 357846, "last_target_update_ts": 11207, "num_target_updates": 1387}, "done": false, "episodes_total": 0, "training_iteration": 96, "trial_id": "db258_00000", "date": "2023-11-16_21-50-38", "timestamp": 1700200238, "time_this_iter_s": 1.565762996673584, "time_total_s": 150.03653764724731, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e1409a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 150.03653764724731, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.4, "ram_util_percent": 63.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08094310760498, "actor_loss": -25.42961883544922, "critic_loss": 0.07878778874874115, "alpha_loss": -4.242430686950684, "alpha_value": 0.6564972996711731, "log_alpha_value": -0.4208367168903351, "target_entropy": -6.0, "policy_t": 0.019932253286242485, "mean_q": 22.78834342956543, "max_q": 23.500133514404297, "min_q": 22.273712158203125}, "td_error": [1.8711633682250977, 0.7783689498901367, 0.4941577911376953, 0.5037498474121094, 0.07605552673339844, 0.4622001647949219, 1.099090576171875, 0.24959182739257812, 0.7962875366210938, 0.8418712615966797, 0.6930789947509766, 1.389359474182129, 0.8229236602783203, 0.22557830810546875, 0.5790567398071289, 0.9275360107421875, 0.7240114212036133, 0.13231182098388672, 1.9673633575439453, 0.4040794372558594, 0.5577220916748047, 0.13812255859375, 0.1577615737915039, 0.6419553756713867, 0.5362339019775391, 0.8318405151367188, 1.0467634201049805, 0.3375358581542969, 1.5759105682373047, 0.11802482604980469, 0.9045276641845703, 0.36841869354248047, 1.4762964248657227, 1.7816448211669922, 2.627739906311035, 1.3521108627319336, 1.0520896911621094, 0.8705930709838867, 0.9898185729980469, 2.1445322036743164, 1.4270248413085938, 0.5924263000488281, 1.0185327529907227, 0.911799430847168, 0.35289764404296875, 1.6094446182250977, 0.6771965026855469, 1.2461481094360352, 0.575505256652832, 0.34496212005615234, 1.5507678985595703, 0.3016529083251953, 0.45162010192871094, 0.41091346740722656, 2.1374101638793945, 0.11757659912109375, 1.5922441482543945, 1.2661380767822266, 0.6811418533325195, 1.835097312927246, 0.22806072235107422, 0.18039608001708984, 0.6855392456054688, 0.1924896240234375, 1.4821529388427734, 0.5698795318603516, 2.6552696228027344, 2.2018890380859375, 0.0932931900024414, 0.6057558059692383, 1.300156593322754, 1.349161148071289, 0.2180938720703125, 1.228372573852539, 0.653071403503418, 1.0447616577148438, 0.7594165802001953, 1.321396827697754, 0.25055599212646484, 0.6367683410644531, 1.7023344039916992, 1.0842599868774414, 0.8157758712768555, 2.04636287689209, 0.6203994750976562, 1.9509057998657227], "mean_td_error": 0.9247034788131714, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1402.0, "diff_num_grad_updates_vs_sampler_policy": 1401.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07712459564209, "actor_loss": -15.748648643493652, "critic_loss": 0.11168532818555832, "alpha_loss": -4.2382402420043945, "alpha_value": 0.6566656231880188, "log_alpha_value": -0.42058035731315613, "target_entropy": -6.0, "policy_t": -0.03823109716176987, "mean_q": 13.053289413452148, "max_q": 13.498006820678711, "min_q": 12.682008743286133}, "td_error": [0.24010801315307617, 1.6483440399169922, 0.7009596824645996, 0.9488625526428223, 0.0069675445556640625, 0.8524713516235352, 2.3945741653442383, 1.6501107215881348, 0.3177638053894043, 0.007009983062744141, 0.9002184867858887, 2.1442747116088867, 1.1930699348449707, 1.0045361518859863, 2.068197250366211, 1.429877758026123, 0.8173847198486328, 1.5908856391906738, 1.292945384979248, 1.474637508392334, 0.3701496124267578, 1.2032670974731445, 0.7992820739746094, 1.615325927734375, 0.9248905181884766, 0.8643836975097656, 2.505247116088867, 0.0179290771484375, 1.9118032455444336, 0.28533315658569336, 1.4391803741455078, 1.8182268142700195, 1.241422176361084, 1.3098335266113281, 0.4624748229980469, 0.31270551681518555, 1.8779754638671875, 0.4016399383544922, 2.0075736045837402, 1.9244165420532227, 2.7449278831481934, 1.6001720428466797, 0.40195417404174805, 0.2769608497619629, 1.1260795593261719, 0.552863597869873, 0.980320930480957, 0.2714061737060547, 0.8927092552185059, 1.759124755859375, 1.4582457542419434, 1.7116165161132812, 0.9488925933837891, 0.7622361183166504, 0.7278785705566406, 1.2612967491149902, 0.19105768203735352, 0.40172481536865234, 1.564969539642334, 1.6717514991760254, 0.6606817245483398, 1.0491681098937988, 0.2799386978149414, 0.36882591247558594, 0.5203495025634766, 1.854997158050537, 2.470336437225342, 2.995032787322998, 0.17594385147094727, 0.8490242958068848, 1.9173583984375, 1.0253477096557617, 1.0507631301879883, 0.5031833648681641, 1.634758472442627, 0.3585395812988281, 1.6076526641845703, 0.3298788070678711, 0.6956338882446289, 0.3094019889831543, 0.5545368194580078, 1.0821590423583984, 0.8057088851928711, 1.9077796936035156, 1.5500364303588867, 1.4478235244750977], "mean_td_error": 1.1079919338226318, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1402.0, "diff_num_grad_updates_vs_sampler_policy": 1401.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09709358215332, "actor_loss": -16.043750762939453, "critic_loss": 0.14580592513084412, "alpha_loss": -4.246085166931152, "alpha_value": 0.6567016839981079, "log_alpha_value": -0.420525461435318, "target_entropy": -6.0, "policy_t": 0.013362796977162361, "mean_q": 13.411470413208008, "max_q": 13.701885223388672, "min_q": 13.070045471191406}, "td_error": [0.8823032379150391, 1.6658058166503906, 0.5150327682495117, 1.543649673461914, 1.8499860763549805, 0.6098470687866211, 1.1412320137023926, 0.3776822090148926, 0.6188039779663086, 0.6937808990478516, 1.2735447883605957, 1.3052153587341309, 0.5250921249389648, 1.4511427879333496, 0.9979343414306641, 2.38071346282959, 0.42992162704467773, 1.1770710945129395, 0.5776190757751465, 1.6515045166015625, 0.45856761932373047, 2.0557851791381836, 1.1411857604980469, 1.2658324241638184, 1.3372149467468262, 2.4693026542663574, 1.9217123985290527, 2.004815101623535, 0.7889413833618164, 0.7240252494812012, 0.8535313606262207, 0.27337217330932617, 1.1563801765441895, 1.2502374649047852, 1.251582145690918, 1.4370570182800293, 0.9472074508666992, 1.907928466796875, 0.10548591613769531, 0.5465083122253418, 1.2201313972473145, 0.8699007034301758, 0.49434518814086914, 1.4686403274536133, 0.6889991760253906, 0.33908939361572266, 0.5678482055664062, 1.4565443992614746, 2.86270809173584, 1.7361831665039062, 1.0445442199707031, 1.5982141494750977, 1.7535057067871094, 0.5348234176635742, 2.015510082244873, 0.6809191703796387, 0.3407778739929199, 0.6070055961608887, 1.8806095123291016, 1.4007186889648438, 1.491729736328125, 0.8109207153320312, 2.4039502143859863, 2.6782212257385254, 0.6188936233520508, 1.0044946670532227, 0.35912609100341797, 0.3531074523925781, 0.7321133613586426, 2.594733715057373, 0.7210516929626465, 0.8822078704833984, 0.7987232208251953, 0.08661079406738281, 0.8160905838012695, 1.1801185607910156, 2.9663119316101074, 2.1694226264953613, 1.724423885345459, 1.5259714126586914, 0.5675201416015625, 0.8155193328857422, 0.7977948188781738, 0.016940593719482422, 1.2283902168273926, 0.3530421257019043], "mean_td_error": 1.1491047143936157, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1402.0, "diff_num_grad_updates_vs_sampler_policy": 1401.0}}, "num_env_steps_sampled": 11312, "num_env_steps_trained": 361716, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 361716, "last_target_update_ts": 11312, "num_target_updates": 1402}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 361716, "num_env_steps_sampled": 11312, "num_env_steps_trained": 361716, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.40210278439811, "num_env_steps_trained_throughput_per_sec": 2447.3917883392446, "timesteps_total": 11312, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 105.579, "sample_time_ms": 16.182, "load_time_ms": 0.314, "load_throughput": 821538.439, "learn_time_ms": 18.355, "learn_throughput": 14056.289, "synch_weights_time_ms": 10.325}, "counters": {"num_env_steps_sampled": 11312, "num_env_steps_trained": 361716, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 361716, "last_target_update_ts": 11312, "num_target_updates": 1402}, "done": false, "episodes_total": 0, "training_iteration": 97, "trial_id": "db258_00000", "date": "2023-11-16_21-50-40", "timestamp": 1700200240, "time_this_iter_s": 1.5910840034484863, "time_total_s": 151.6276216506958, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 151.6276216506958, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 37.2, "ram_util_percent": 63.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125144958496094, "actor_loss": -25.526105880737305, "critic_loss": 0.09365959465503693, "alpha_loss": -4.3066325187683105, "alpha_value": 0.6535473465919495, "log_alpha_value": -0.42534032464027405, "target_entropy": -6.0, "policy_t": 0.038673315197229385, "mean_q": 22.884296417236328, "max_q": 23.384313583374023, "min_q": 22.383750915527344}, "td_error": [2.0282535552978516, 0.6494359970092773, 1.4603519439697266, 0.6078290939331055, 1.149770736694336, 0.42467594146728516, 1.178497314453125, 1.148055076599121, 0.48038291931152344, 1.4076175689697266, 1.9669609069824219, 0.9555387496948242, 0.4685678482055664, 1.8022212982177734, 0.1514759063720703, 1.108994483947754, 1.2200050354003906, 0.8381834030151367, 0.8202743530273438, 1.0843067169189453, 0.8038139343261719, 1.3647079467773438, 0.785308837890625, 0.9335899353027344, 1.23046875, 0.9390583038330078, 0.6201944351196289, 0.4665184020996094, 1.2481842041015625, 1.5843372344970703, 1.4656686782836914, 1.0463809967041016, 2.0577850341796875, 1.3803863525390625, 0.3454313278198242, 1.3154172897338867, 2.392148971557617, 1.204416275024414, 0.8747959136962891, 1.2716665267944336, 1.265676498413086, 0.34407997131347656, 1.5575122833251953, 2.5677928924560547, 0.6222562789916992, 0.3510150909423828, 0.042224884033203125, 1.2397565841674805, 0.7763528823852539, 0.25397777557373047, 1.4308557510375977, 0.23061752319335938, 1.8683652877807617, 0.4165048599243164, 1.2527027130126953, 1.4335556030273438, 0.9355669021606445, 0.11341094970703125, 0.9169921875, 0.4320793151855469, 1.2399187088012695, 2.627504348754883, 0.080535888671875, 0.07197093963623047, 1.2296781539916992, 1.367955207824707, 1.8375024795532227, 0.7811565399169922, 1.9237899780273438, 1.7469596862792969, 1.215036392211914, 1.7210140228271484, 0.7170419692993164, 1.8650016784667969, 0.20552730560302734, 2.1741580963134766, 0.6828823089599609, 1.3929405212402344, 0.7580928802490234, 1.9670534133911133, 0.07827377319335938, 1.3619928359985352, 0.9025764465332031, 0.5005302429199219, 1.0860605239868164, 0.035091400146484375], "mean_td_error": 1.0686421394348145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1417.0, "diff_num_grad_updates_vs_sampler_policy": 1416.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075955390930176, "actor_loss": -15.877310752868652, "critic_loss": 0.10169915854930878, "alpha_loss": -4.283112049102783, "alpha_value": 0.6537158489227295, "log_alpha_value": -0.4250825047492981, "target_entropy": -6.0, "policy_t": 0.029986809939146042, "mean_q": 13.27917766571045, "max_q": 13.69497299194336, "min_q": 13.026613235473633}, "td_error": [2.3222131729125977, 0.989748477935791, 0.0894160270690918, 2.0131797790527344, 0.859184741973877, 0.3717041015625, 1.362107276916504, 0.19289302825927734, 2.028689384460449, 0.26172637939453125, 0.7119464874267578, 0.35265207290649414, 0.26407384872436523, 2.4902138710021973, 0.08231258392333984, 0.8399868011474609, 0.7477192878723145, 1.1141667366027832, 1.7711834907531738, 0.990668773651123, 0.8483724594116211, 0.5046191215515137, 1.9711418151855469, 0.35875892639160156, 0.3180060386657715, 0.6572904586791992, 0.7429952621459961, 0.915123462677002, 0.9608211517333984, 0.6407690048217773, 1.878580093383789, 1.5840277671813965, 0.19483327865600586, 0.10694313049316406, 0.183013916015625, 1.712076187133789, 1.9972248077392578, 0.7781410217285156, 2.182541847229004, 1.1641349792480469, 0.8800201416015625, 1.7864127159118652, 0.5777640342712402, 0.5931406021118164, 1.9272489547729492, 0.8720521926879883, 1.3184103965759277, 0.12807846069335938, 0.10644245147705078, 1.4407339096069336, 1.9738268852233887, 1.8081755638122559, 1.123314380645752, 1.6877703666687012, 0.3282585144042969, 0.2020115852355957, 0.3917813301086426, 1.2076101303100586, 0.41692066192626953, 1.743896484375, 1.1115407943725586, 1.285604476928711, 2.5998477935791016, 0.5320959091186523, 1.9115595817565918, 0.018911361694335938, 0.12332677841186523, 0.6406478881835938, 2.1228203773498535, 0.5340595245361328, 1.2517986297607422, 0.7269940376281738, 1.1984996795654297, 2.0147705078125, 0.8047938346862793, 1.0076818466186523, 0.32373714447021484, 1.9910826683044434, 1.3964686393737793, 1.8187379837036133, 1.545769214630127, 0.9442868232727051, 0.5777163505554199, 1.3244895935058594, 1.5995750427246094, 0.7055912017822266], "mean_td_error": 1.0486218929290771, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1417.0, "diff_num_grad_updates_vs_sampler_policy": 1416.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112003326416016, "actor_loss": -16.142839431762695, "critic_loss": 0.12236322462558746, "alpha_loss": -4.297884464263916, "alpha_value": 0.6537514328956604, "log_alpha_value": -0.4250280261039734, "target_entropy": -6.0, "policy_t": -0.007289297878742218, "mean_q": 13.5042085647583, "max_q": 13.835610389709473, "min_q": 13.016552925109863}, "td_error": [0.8159294128417969, 1.2019548416137695, 0.29425716400146484, 1.2590374946594238, 0.6470370292663574, 1.6122674942016602, 1.4744939804077148, 0.9939761161804199, 0.8701696395874023, 0.507483959197998, 1.8036384582519531, 0.07040643692016602, 0.45923709869384766, 2.622802257537842, 0.7872858047485352, 0.48069334030151367, 0.07077646255493164, 0.048386573791503906, 1.554975986480713, 0.7696824073791504, 0.360260009765625, 1.6222033500671387, 0.5947833061218262, 1.315462589263916, 1.3051180839538574, 0.8721075057983398, 0.33281660079956055, 2.2605905532836914, 1.718480110168457, 1.681295394897461, 2.1753053665161133, 0.29816627502441406, 0.5882797241210938, 0.12445878982543945, 0.3666839599609375, 1.8194828033447266, 1.2296252250671387, 0.42342090606689453, 0.8334016799926758, 1.042973518371582, 1.7142853736877441, 0.41745758056640625, 1.6332764625549316, 1.7443819046020508, 1.5311388969421387, 0.8642511367797852, 0.7811479568481445, 0.9117116928100586, 1.276965618133545, 0.1188044548034668, 1.0390667915344238, 0.7543206214904785, 0.8594040870666504, 0.8940439224243164, 1.5711355209350586, 0.022466182708740234, 0.9124374389648438, 1.7999415397644043, 0.5747370719909668, 0.05736827850341797, 1.2339234352111816, 1.6019439697265625, 1.0656189918518066, 1.2681193351745605, 0.5829973220825195, 2.5587587356567383, 1.5306029319763184, 0.9071331024169922, 2.3751978874206543, 1.3479251861572266, 0.9878354072570801, 0.5426177978515625, 1.0701651573181152, 0.7190899848937988, 1.0655264854431152, 1.0751943588256836, 1.5201311111450195, 0.509498119354248, 1.6536555290222168, 0.38073015213012695, 0.46306514739990234, 0.4814186096191406, 0.5401873588562012, 0.4115595817565918, 1.064774513244629, 0.2268829345703125], "mean_td_error": 0.9996780753135681, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1417.0, "diff_num_grad_updates_vs_sampler_policy": 1416.0}}, "num_env_steps_sampled": 11417, "num_env_steps_trained": 365586, "num_agent_steps_sampled": 34251, "num_agent_steps_trained": 365586, "last_target_update_ts": 11417, "num_target_updates": 1417}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34251, "num_agent_steps_trained": 365586, "num_env_steps_sampled": 11417, "num_env_steps_trained": 365586, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 54.05432951935306, "num_env_steps_trained_throughput_per_sec": 1992.2881451418698, "timesteps_total": 11417, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 34251, "timers": {"training_iteration_time_ms": 139.249, "sample_time_ms": 25.016, "load_time_ms": 0.376, "load_throughput": 686456.757, "learn_time_ms": 24.577, "learn_throughput": 10497.539, "synch_weights_time_ms": 14.323}, "counters": {"num_env_steps_sampled": 11417, "num_env_steps_trained": 365586, "num_agent_steps_sampled": 34251, "num_agent_steps_trained": 365586, "last_target_update_ts": 11417, "num_target_updates": 1417}, "done": false, "episodes_total": 0, "training_iteration": 98, "trial_id": "db258_00000", "date": "2023-11-16_21-50-42", "timestamp": 1700200242, "time_this_iter_s": 1.9573841094970703, "time_total_s": 153.58500576019287, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 153.58500576019287, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 44.53333333333333, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.144680976867676, "actor_loss": -25.604427337646484, "critic_loss": 0.09479917585849762, "alpha_loss": -4.360665321350098, "alpha_value": 0.6506083607673645, "log_alpha_value": -0.4298474192619324, "target_entropy": -6.0, "policy_t": -0.012756756506860256, "mean_q": 22.94353675842285, "max_q": 23.376800537109375, "min_q": 22.48316192626953}, "td_error": [0.6800928115844727, 0.7885332107543945, 0.3070411682128906, 0.24950122833251953, 1.726837158203125, 2.2372474670410156, 1.1009235382080078, 1.0440902709960938, 1.1074600219726562, 2.0673484802246094, 0.818328857421875, 0.3498411178588867, 0.7881908416748047, 0.32097911834716797, 0.4288625717163086, 0.4570474624633789, 0.7274246215820312, 0.8813247680664062, 1.6677780151367188, 0.046256065368652344, 2.0653295516967773, 0.3008298873901367, 1.6147441864013672, 0.5270786285400391, 1.22601318359375, 0.2763185501098633, 2.2714309692382812, 0.3285074234008789, 0.8689126968383789, 1.6488971710205078, 2.062765121459961, 1.284235954284668, 1.7044639587402344, 0.11477947235107422, 1.425704002380371, 0.7849607467651367, 0.6612720489501953, 0.24350738525390625, 0.9867897033691406, 0.5954694747924805, 0.4609489440917969, 2.030590057373047, 0.8241338729858398, 1.9282960891723633, 0.4766855239868164, 1.2743377685546875, 1.3789606094360352, 0.7058906555175781, 0.4791526794433594, 3.057450294494629, 1.8660907745361328, 0.9854869842529297, 0.5652122497558594, 2.732746124267578, 1.4899044036865234, 2.3333187103271484, 1.3576240539550781, 1.6622686386108398, 1.2046031951904297, 0.9721240997314453, 1.1517219543457031, 1.1430721282958984, 0.8119010925292969, 0.7171421051025391, 0.7453823089599609, 1.4693431854248047, 0.7970638275146484, 0.7087411880493164, 0.5069074630737305, 0.7782058715820312, 0.23974895477294922, 0.22756385803222656, 1.4560775756835938, 0.0948486328125, 0.16203022003173828, 0.16768932342529297, 2.5566844940185547, 2.318800926208496, 2.1159448623657227, 0.581944465637207, 0.7268171310424805, 1.5048933029174805, 1.2385063171386719, 0.32115650177001953, 0.9906654357910156, 1.1532716751098633], "mean_td_error": 1.0611521005630493, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1432.0, "diff_num_grad_updates_vs_sampler_policy": 1431.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126693725585938, "actor_loss": -16.00518226623535, "critic_loss": 0.11728238314390182, "alpha_loss": -4.350265026092529, "alpha_value": 0.6507797837257385, "log_alpha_value": -0.42958396673202515, "target_entropy": -6.0, "policy_t": -0.05007999762892723, "mean_q": 13.401174545288086, "max_q": 13.743438720703125, "min_q": 13.103374481201172}, "td_error": [1.9254732131958008, 0.3991823196411133, 0.5128517150878906, 0.28455114364624023, 0.5624256134033203, 1.6431751251220703, 0.5163698196411133, 0.517911434173584, 0.8654417991638184, 2.147247314453125, 2.144713878631592, 2.526033401489258, 0.9970746040344238, 1.2690649032592773, 0.7885627746582031, 2.06788969039917, 0.4403343200683594, 0.8007035255432129, 0.8649015426635742, 0.671938419342041, 1.3620777130126953, 1.5518760681152344, 1.5667409896850586, 0.7643442153930664, 1.1294374465942383, 1.1088905334472656, 0.6399540901184082, 1.835649013519287, 2.421217441558838, 0.8380002975463867, 1.1559205055236816, 0.3346076011657715, 1.1194839477539062, 2.0775222778320312, 1.3700642585754395, 0.6616158485412598, 2.1221485137939453, 0.8381309509277344, 2.198516845703125, 0.6071233749389648, 1.8500938415527344, 1.955721378326416, 0.8518581390380859, 0.890474796295166, 0.27547788619995117, 0.899940013885498, 2.14919376373291, 0.6892890930175781, 1.5328903198242188, 1.3802671432495117, 1.3066344261169434, 0.9630875587463379, 0.8869366645812988, 0.7285671234130859, 1.1805553436279297, 0.13578319549560547, 0.25508737564086914, 0.3967747688293457, 1.4180645942687988, 3.717461109161377, 0.3087019920349121, 1.4333643913269043, 0.7445917129516602, 0.4262886047363281, 0.7413811683654785, 1.0447478294372559, 1.4521703720092773, 2.266127109527588, 0.6642942428588867, 1.374894142150879, 0.9093680381774902, 2.305917739868164, 1.7019414901733398, 1.5687851905822754, 1.3599085807800293, 2.4351954460144043, 1.1039237976074219, 0.9218544960021973, 1.6771697998046875, 0.7283549308776855, 1.8306694030761719, 0.20956802368164062, 0.938361644744873, 0.7474002838134766, 0.8988471031188965, 0.834714412689209], "mean_td_error": 1.1830450296401978, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1432.0, "diff_num_grad_updates_vs_sampler_policy": 1431.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.102777481079102, "actor_loss": -16.13176155090332, "critic_loss": 0.14789940416812897, "alpha_loss": -4.339439868927002, "alpha_value": 0.6508153080940247, "log_alpha_value": -0.4295293986797333, "target_entropy": -6.0, "policy_t": 0.0018173996359109879, "mean_q": 13.521599769592285, "max_q": 13.922198295593262, "min_q": 13.130298614501953}, "td_error": [0.9689297676086426, 2.2022366523742676, 1.0820684432983398, 0.2730717658996582, 1.3549184799194336, 0.9955172538757324, 2.141495704650879, 1.4627833366394043, 1.1110477447509766, 1.4763054847717285, 0.8466701507568359, 0.9043135643005371, 1.0768623352050781, 0.11723136901855469, 0.9781813621520996, 1.0821895599365234, 0.9190540313720703, 0.04693031311035156, 2.7583694458007812, 1.7412219047546387, 0.8271737098693848, 0.9412832260131836, 1.0158185958862305, 0.796602725982666, 1.3894233703613281, 2.2237377166748047, 1.9329423904418945, 1.4260807037353516, 3.6223015785217285, 0.5283808708190918, 0.6044554710388184, 0.9431309700012207, 1.9182562828063965, 1.5630927085876465, 0.7719483375549316, 2.2470884323120117, 0.37458276748657227, 1.1613068580627441, 1.56703519821167, 0.8110289573669434, 0.5948829650878906, 0.8182907104492188, 1.3897790908813477, 0.9025650024414062, 0.5794425010681152, 1.0475358963012695, 2.0780324935913086, 0.1656022071838379, 1.4919843673706055, 0.9657549858093262, 0.8155393600463867, 0.797976016998291, 1.1855072975158691, 1.0008573532104492, 2.0907974243164062, 0.4830203056335449, 0.38162755966186523, 0.6783485412597656, 0.0942082405090332, 2.989560604095459, 1.6199350357055664, 2.103653907775879, 0.44333600997924805, 0.6471753120422363, 1.4108271598815918, 0.22285747528076172, 1.0430283546447754, 1.4655351638793945, 0.8572607040405273, 0.7177004814147949, 0.49914979934692383, 0.9722423553466797, 3.1978745460510254, 3.230712890625, 0.5189447402954102, 0.37746381759643555, 0.6143741607666016, 2.520803451538086, 1.207775592803955, 1.3493452072143555, 0.6088895797729492, 1.1148862838745117, 0.7668795585632324, 0.4059138298034668, 2.7020530700683594, 0.39696264266967773], "mean_td_error": 1.1833949089050293, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1432.0, "diff_num_grad_updates_vs_sampler_policy": 1431.0}}, "num_env_steps_sampled": 11522, "num_env_steps_trained": 369456, "num_agent_steps_sampled": 34566, "num_agent_steps_trained": 369456, "last_target_update_ts": 11522, "num_target_updates": 1432}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34566, "num_agent_steps_trained": 369456, "num_env_steps_sampled": 11522, "num_env_steps_trained": 369456, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 54.553672019650136, "num_env_steps_trained_throughput_per_sec": 2010.6924830099622, "timesteps_total": 11522, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 34566, "timers": {"training_iteration_time_ms": 120.419, "sample_time_ms": 19.921, "load_time_ms": 0.427, "load_throughput": 603766.352, "learn_time_ms": 20.513, "learn_throughput": 12577.428, "synch_weights_time_ms": 12.393}, "counters": {"num_env_steps_sampled": 11522, "num_env_steps_trained": 369456, "num_agent_steps_sampled": 34566, "num_agent_steps_trained": 369456, "last_target_update_ts": 11522, "num_target_updates": 1432}, "done": false, "episodes_total": 0, "training_iteration": 99, "trial_id": "db258_00000", "date": "2023-11-16_21-50-44", "timestamp": 1700200244, "time_this_iter_s": 1.9377260208129883, "time_total_s": 155.52273178100586, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e1409a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 155.52273178100586, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 51.70000000000001, "ram_util_percent": 63.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084343910217285, "actor_loss": -25.57833480834961, "critic_loss": 0.10253883898258209, "alpha_loss": -4.380157947540283, "alpha_value": 0.6476840376853943, "log_alpha_value": -0.4343523383140564, "target_entropy": -6.0, "policy_t": 0.03196592628955841, "mean_q": 23.01519012451172, "max_q": 23.542028427124023, "min_q": 22.58759307861328}, "td_error": [2.090282440185547, 0.5423669815063477, 0.8432846069335938, 0.2142019271850586, 0.09223556518554688, 0.1883697509765625, 0.9701271057128906, 0.6953372955322266, 0.8808984756469727, 1.6855459213256836, 1.557509422302246, 1.6276140213012695, 1.9326629638671875, 0.5100669860839844, 2.034487724304199, 1.2547502517700195, 0.13287830352783203, 1.3694581985473633, 0.2566709518432617, 0.8357610702514648, 0.9183168411254883, 0.8919878005981445, 1.0497760772705078, 1.897247314453125, 1.203592300415039, 1.062856674194336, 1.16656494140625, 1.234182357788086, 1.1975364685058594, 0.49321746826171875, 2.664794921875, 1.7521228790283203, 1.4228830337524414, 0.5883140563964844, 1.428502082824707, 1.3339309692382812, 0.4061098098754883, 1.9173717498779297, 2.7751731872558594, 1.2330760955810547, 2.7013378143310547, 0.10984325408935547, 1.0308666229248047, 1.8139686584472656, 0.9221363067626953, 0.8519687652587891, 1.0345392227172852, 0.02404308319091797, 0.6786165237426758, 3.4812278747558594, 1.190079689025879, 1.6978998184204102, 1.0209169387817383, 1.0821952819824219, 0.9357995986938477, 2.242647171020508, 1.332773208618164, 0.9315586090087891, 0.9713973999023438, 1.444666862487793, 0.7594985961914062, 1.0506095886230469, 0.3914461135864258, 0.6201467514038086, 0.7747859954833984, 1.2553634643554688, 0.19978713989257812, 0.7909631729125977, 2.681086540222168, 0.7105255126953125, 1.376779556274414, 1.3708696365356445, 0.9408645629882812, 0.5603981018066406, 1.9452428817749023, 2.675204277038574, 1.3509635925292969, 0.05442523956298828, 0.1525249481201172, 0.9898967742919922, 1.3560056686401367, 0.13806915283203125, 1.2477130889892578, 0.18639278411865234, 0.8364963531494141, 1.089289665222168], "mean_td_error": 1.1320452690124512, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1447.0, "diff_num_grad_updates_vs_sampler_policy": 1446.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084844589233398, "actor_loss": -16.082395553588867, "critic_loss": 0.1110706627368927, "alpha_loss": -4.377694129943848, "alpha_value": 0.6478562951087952, "log_alpha_value": -0.434086412191391, "target_entropy": -6.0, "policy_t": 0.0011377852642908692, "mean_q": 13.478450775146484, "max_q": 13.7727689743042, "min_q": 13.18245792388916}, "td_error": [2.027996063232422, 0.30777454376220703, 0.7623825073242188, 1.2113385200500488, 0.5701231956481934, 1.0976347923278809, 1.1411070823669434, 1.5595874786376953, 1.524221420288086, 2.516084671020508, 1.2049436569213867, 0.33008670806884766, 1.792938232421875, 0.9623637199401855, 0.8086767196655273, 0.6313033103942871, 1.4480695724487305, 1.5493488311767578, 0.9469876289367676, 1.1536402702331543, 0.7905941009521484, 1.236006736755371, 1.0209898948669434, 1.1877021789550781, 1.1334123611450195, 1.5040340423583984, 0.7508363723754883, 1.6033806800842285, 0.5470952987670898, 0.42563819885253906, 0.6234698295593262, 0.4674825668334961, 0.04241037368774414, 0.5704121589660645, 1.4929604530334473, 0.35564517974853516, 1.8646612167358398, 1.2694740295410156, 2.616361618041992, 1.6643872261047363, 1.9234652519226074, 1.162705421447754, 1.2592310905456543, 2.589120864868164, 0.9111824035644531, 1.9280147552490234, 1.5480737686157227, 0.9658336639404297, 1.1572608947753906, 0.9652099609375, 1.4400429725646973, 0.9244327545166016, 1.0620927810668945, 1.361473560333252, 1.3572163581848145, 1.2043070793151855, 1.507645606994629, 1.3032875061035156, 1.5057668685913086, 1.6477303504943848, 0.5946717262268066, 1.811614990234375, 0.5056877136230469, 0.9147143363952637, 0.03943061828613281, 0.2397603988647461, 1.0137476921081543, 0.8855290412902832, 0.9121899604797363, 0.5004429817199707, 0.06768798828125, 0.3584918975830078, 1.0153355598449707, 1.756037712097168, 0.5862975120544434, 1.2613940238952637, 1.3000774383544922, 0.8237457275390625, 1.1318082809448242, 0.957364559173584, 0.8820209503173828, 2.157705783843994, 1.346163272857666, 0.7386617660522461, 1.6087627410888672, 1.8795275688171387], "mean_td_error": 1.1363550424575806, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1447.0, "diff_num_grad_updates_vs_sampler_policy": 1446.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.099267959594727, "actor_loss": -16.18746566772461, "critic_loss": 0.11772318184375763, "alpha_loss": -4.383374214172363, "alpha_value": 0.6478935480117798, "log_alpha_value": -0.43402886390686035, "target_entropy": -6.0, "policy_t": 0.02034677378833294, "mean_q": 13.575041770935059, "max_q": 13.918399810791016, "min_q": 13.251977920532227}, "td_error": [0.43973350524902344, 0.9023494720458984, 0.1842803955078125, 2.0321974754333496, 0.09188079833984375, 1.2510709762573242, 0.7183246612548828, 1.0199942588806152, 0.14275836944580078, 1.0778264999389648, 0.6085882186889648, 0.47095489501953125, 2.0035061836242676, 0.5722217559814453, 0.6907730102539062, 0.8656473159790039, 0.5950431823730469, 1.336240291595459, 0.7350649833679199, 1.1864466667175293, 1.4439382553100586, 0.7321610450744629, 1.0783119201660156, 1.2349166870117188, 0.37507152557373047, 0.17809295654296875, 2.0345282554626465, 0.5491847991943359, 1.5516057014465332, 1.278066635131836, 0.38899850845336914, 0.9784450531005859, 0.9686546325683594, 1.6412272453308105, 1.1427531242370605, 2.3539767265319824, 0.8754539489746094, 0.9201879501342773, 0.8213653564453125, 0.8908467292785645, 0.7202777862548828, 0.507756233215332, 0.5317497253417969, 0.2160015106201172, 0.8553915023803711, 1.2301740646362305, 0.5595569610595703, 1.4676170349121094, 0.062152862548828125, 0.14518404006958008, 1.2025299072265625, 0.22992944717407227, 1.086726188659668, 0.045584678649902344, 1.4848008155822754, 3.0576276779174805, 0.27500152587890625, 0.584993839263916, 1.7565717697143555, 0.19118213653564453, 1.09987211227417, 1.7167396545410156, 2.1190247535705566, 0.1369013786315918, 0.8462605476379395, 1.1942462921142578, 1.333414077758789, 2.437819480895996, 0.45440196990966797, 0.632929801940918, 0.5936346054077148, 0.3860301971435547, 1.4016494750976562, 2.1705312728881836, 1.3156304359436035, 1.0254831314086914, 1.2961969375610352, 0.1752924919128418, 2.064624309539795, 0.6318492889404297, 2.5527501106262207, 1.1479015350341797, 0.9938302040100098, 0.35304975509643555, 0.8547897338867188, 0.597956657409668], "mean_td_error": 0.9779803156852722, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1447.0, "diff_num_grad_updates_vs_sampler_policy": 1446.0}}, "num_env_steps_sampled": 11627, "num_env_steps_trained": 373326, "num_agent_steps_sampled": 34881, "num_agent_steps_trained": 373326, "last_target_update_ts": 11627, "num_target_updates": 1447}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34881, "num_agent_steps_trained": 373326, "num_env_steps_sampled": 11627, "num_env_steps_trained": 373326, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.13468463909014, "num_env_steps_trained_throughput_per_sec": 2474.3926624121796, "timesteps_total": 11627, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 34881, "timers": {"training_iteration_time_ms": 103.73, "sample_time_ms": 16.337, "load_time_ms": 0.312, "load_throughput": 826369.173, "learn_time_ms": 17.942, "learn_throughput": 14379.515, "synch_weights_time_ms": 9.973}, "counters": {"num_env_steps_sampled": 11627, "num_env_steps_trained": 373326, "num_agent_steps_sampled": 34881, "num_agent_steps_trained": 373326, "last_target_update_ts": 11627, "num_target_updates": 1447}, "done": false, "episodes_total": 0, "training_iteration": 100, "trial_id": "db258_00000", "date": "2023-11-16_21-50-45", "timestamp": 1700200245, "time_this_iter_s": 1.5734891891479492, "time_total_s": 157.0962209701538, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 157.0962209701538, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 38.2, "ram_util_percent": 64.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.103802680969238, "actor_loss": -25.786191940307617, "critic_loss": 0.09723740816116333, "alpha_loss": -4.434144020080566, "alpha_value": 0.6447717547416687, "log_alpha_value": -0.43885892629623413, "target_entropy": -6.0, "policy_t": 0.02039565145969391, "mean_q": 23.22234344482422, "max_q": 24.05608367919922, "min_q": 22.61263656616211}, "td_error": [1.0395011901855469, 0.36118221282958984, 0.8359146118164062, 1.1573686599731445, 1.3230304718017578, 0.3003864288330078, 1.2690353393554688, 1.277984619140625, 0.9469928741455078, 0.9909276962280273, 1.2603168487548828, 1.5666942596435547, 0.4397239685058594, 1.0891962051391602, 2.055556297302246, 0.4663991928100586, 1.1513900756835938, 0.4489784240722656, 1.4244365692138672, 2.1503963470458984, 0.7923345565795898, 2.390880584716797, 0.7040224075317383, 0.6163139343261719, 2.2367000579833984, 0.7675313949584961, 1.8490667343139648, 0.952418327331543, 0.6465616226196289, 0.1239461898803711, 1.2250785827636719, 0.7249536514282227, 2.1777353286743164, 0.8464393615722656, 1.8728055953979492, 0.2541313171386719, 0.2614412307739258, 1.9706811904907227, 0.8924245834350586, 0.5393381118774414, 0.5899209976196289, 2.4779129028320312, 0.2564973831176758, 0.2569694519042969, 0.7085304260253906, 0.3168973922729492, 1.9427862167358398, 0.9789180755615234, 0.8568696975708008, 0.08769893646240234, 0.40421581268310547, 2.3624038696289062, 1.632223129272461, 1.7221689224243164, 0.7812061309814453, 0.03997611999511719, 0.2536029815673828, 0.37706470489501953, 1.314051628112793, 0.1465301513671875, 0.5644464492797852, 0.10267257690429688, 1.9275455474853516, 1.0099420547485352, 0.9303369522094727, 2.5908336639404297, 2.157197952270508, 1.1903305053710938, 2.1934328079223633, 0.7504854202270508, 0.9144926071166992, 3.2369384765625, 0.8279619216918945, 1.4106769561767578, 0.49855613708496094, 1.0970535278320312, 1.3264875411987305, 0.5488729476928711, 2.136768341064453, 1.281184196472168, 1.294717788696289, 0.814824104309082, 0.5802755355834961, 2.379016876220703, 0.8491592407226562, 0.31289100646972656], "mean_td_error": 1.0910903215408325, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1462.0, "diff_num_grad_updates_vs_sampler_policy": 1461.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107604026794434, "actor_loss": -16.262531280517578, "critic_loss": 0.10820936411619186, "alpha_loss": -4.433043956756592, "alpha_value": 0.6449483036994934, "log_alpha_value": -0.438585102558136, "target_entropy": -6.0, "policy_t": -0.02983276918530464, "mean_q": 13.652654647827148, "max_q": 13.932201385498047, "min_q": 13.339127540588379}, "td_error": [0.5859923362731934, 1.3209285736083984, 0.4782071113586426, 1.3053936958312988, 0.5183877944946289, 0.1894397735595703, 1.4855074882507324, 0.5437130928039551, 1.8822441101074219, 1.7302193641662598, 1.3811116218566895, 1.9582328796386719, 0.6593012809753418, 0.08108377456665039, 1.0964622497558594, 0.3865532875061035, 1.8533992767333984, 0.4573349952697754, 1.035161018371582, 1.5998420715332031, 1.830350399017334, 0.43947696685791016, 0.5707483291625977, 1.1960158348083496, 0.07055950164794922, 1.4264955520629883, 0.7472100257873535, 0.9485592842102051, 1.8596539497375488, 0.7658915519714355, 0.36719369888305664, 0.9288644790649414, 1.2439579963684082, 0.9144868850708008, 0.8045382499694824, 0.20893192291259766, 1.6681575775146484, 1.2475099563598633, 0.2055525779724121, 1.2665886878967285, 2.403179168701172, 0.5421419143676758, 1.6325969696044922, 0.8084864616394043, 0.33234357833862305, 0.8832159042358398, 2.4291720390319824, 1.1264748573303223, 0.8618535995483398, 1.6006851196289062, 1.2747931480407715, 1.9965763092041016, 1.2106614112854004, 0.06543540954589844, 1.6980829238891602, 0.9822883605957031, 0.751610279083252, 0.8727931976318359, 2.064429759979248, 0.6371212005615234, 0.05831336975097656, 0.7321381568908691, 0.4818110466003418, 0.9720087051391602, 1.8030619621276855, 1.1681861877441406, 0.5572528839111328, 0.8175501823425293, 0.8862524032592773, 2.273369312286377, 1.040975570678711, 2.0990943908691406, 1.70139741897583, 2.5243215560913086, 1.417724609375, 2.016256809234619, 2.4107608795166016, 0.6244344711303711, 1.3820762634277344, 1.5137853622436523, 0.6178812980651855, 2.22495174407959, 1.2524971961975098, 0.29306936264038086, 0.20881128311157227, 0.7912387847900391], "mean_td_error": 1.1081676483154297, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1462.0, "diff_num_grad_updates_vs_sampler_policy": 1461.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.076828956604004, "actor_loss": -16.0849666595459, "critic_loss": 0.13064086437225342, "alpha_loss": -4.418997287750244, "alpha_value": 0.6449835300445557, "log_alpha_value": -0.4385305345058441, "target_entropy": -6.0, "policy_t": 0.02790304832160473, "mean_q": 13.480231285095215, "max_q": 13.854019165039062, "min_q": 13.202665328979492}, "td_error": [0.5821824073791504, 1.1472454071044922, 2.010082721710205, 1.8651013374328613, 0.7677545547485352, 1.4175872802734375, 0.42383909225463867, 0.47211694717407227, 1.629622459411621, 0.49109315872192383, 1.1339712142944336, 0.08826637268066406, 1.5926189422607422, 0.3086395263671875, 1.0137104988098145, 1.548253059387207, 0.7754268646240234, 0.39847707748413086, 0.8292503356933594, 0.7530636787414551, 1.3585100173950195, 0.5070223808288574, 1.8957843780517578, 2.2990732192993164, 0.40052366256713867, 1.093623161315918, 1.3651199340820312, 0.7813401222229004, 1.7410693168640137, 1.3166561126708984, 0.36089658737182617, 1.2052793502807617, 0.9196920394897461, 0.8580732345581055, 0.6877627372741699, 1.4671449661254883, 0.15791654586791992, 2.6264829635620117, 0.27745962142944336, 0.4898967742919922, 0.5947437286376953, 2.099658966064453, 1.0762863159179688, 0.16405057907104492, 0.9455108642578125, 0.6316919326782227, 0.4385557174682617, 0.9390616416931152, 0.667299747467041, 2.2534217834472656, 1.7536978721618652, 0.21065902709960938, 1.3971614837646484, 1.1787395477294922, 0.9597005844116211, 1.0827960968017578, 2.0465269088745117, 0.7381916046142578, 1.510408878326416, 2.0023627281188965, 0.5599880218505859, 0.9994726181030273, 0.41138124465942383, 0.9239664077758789, 1.2141962051391602, 1.2619600296020508, 2.8289175033569336, 1.0531888008117676, 0.3719663619995117, 0.49350452423095703, 1.528637409210205, 2.000575065612793, 0.33896446228027344, 1.182988166809082, 0.33045434951782227, 1.2659831047058105, 1.861494541168213, 0.2583284378051758, 1.3377227783203125, 1.9283461570739746, 1.314661979675293, 0.08711004257202148, 1.6481976509094238, 0.8484888076782227, 0.26311397552490234, 1.445317268371582], "mean_td_error": 1.0640358924865723, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1462.0, "diff_num_grad_updates_vs_sampler_policy": 1461.0}}, "num_env_steps_sampled": 11732, "num_env_steps_trained": 377196, "num_agent_steps_sampled": 35196, "num_agent_steps_trained": 377196, "last_target_update_ts": 11732, "num_target_updates": 1462}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35196, "num_agent_steps_trained": 377196, "num_env_steps_sampled": 11732, "num_env_steps_trained": 377196, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 59.42988046873292, "num_env_steps_trained_throughput_per_sec": 2190.4155944190134, "timesteps_total": 11732, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 35196, "timers": {"training_iteration_time_ms": 106.468, "sample_time_ms": 16.437, "load_time_ms": 0.326, "load_throughput": 791088.846, "learn_time_ms": 19.31, "learn_throughput": 13361.235, "synch_weights_time_ms": 10.955}, "counters": {"num_env_steps_sampled": 11732, "num_env_steps_trained": 377196, "num_agent_steps_sampled": 35196, "num_agent_steps_trained": 377196, "last_target_update_ts": 11732, "num_target_updates": 1462}, "done": false, "episodes_total": 0, "training_iteration": 101, "trial_id": "db258_00000", "date": "2023-11-16_21-50-47", "timestamp": 1700200247, "time_this_iter_s": 1.7761168479919434, "time_total_s": 158.87233781814575, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 158.87233781814575, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 35.6, "ram_util_percent": 64.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082082748413086, "actor_loss": -26.01786231994629, "critic_loss": 0.08981862664222717, "alpha_loss": -4.470034122467041, "alpha_value": 0.6418733596801758, "log_alpha_value": -0.4433642625808716, "target_entropy": -6.0, "policy_t": -0.013094639405608177, "mean_q": 23.454578399658203, "max_q": 24.214370727539062, "min_q": 23.116924285888672}, "td_error": [0.6993446350097656, 0.8616838455200195, 0.4142646789550781, 0.6024341583251953, 0.053188323974609375, 1.0499649047851562, 2.7717437744140625, 0.5341482162475586, 1.3259601593017578, 0.48563289642333984, 1.8575077056884766, 0.7377290725708008, 0.307037353515625, 1.1410236358642578, 1.9187793731689453, 1.2086410522460938, 1.841339111328125, 1.1417512893676758, 0.04070568084716797, 0.4608135223388672, 0.2431507110595703, 0.5419645309448242, 2.407327651977539, 0.6974382400512695, 0.7885227203369141, 1.7025747299194336, 0.6239795684814453, 0.2653341293334961, 1.580526351928711, 1.2389564514160156, 0.8896827697753906, 0.6982574462890625, 1.241377830505371, 0.3464670181274414, 2.184650421142578, 1.9987716674804688, 0.5357503890991211, 1.6719532012939453, 0.43599510192871094, 0.3270702362060547, 1.7601394653320312, 1.602691650390625, 0.5747175216674805, 0.25780582427978516, 0.8534832000732422, 1.033151626586914, 0.9750175476074219, 0.833038330078125, 1.195444107055664, 1.2918386459350586, 0.2063312530517578, 1.1725311279296875, 1.6493072509765625, 0.9767284393310547, 0.2924823760986328, 1.3411750793457031, 0.1379566192626953, 1.8537979125976562, 1.3340387344360352, 0.2502899169921875, 1.7048473358154297, 0.02431488037109375, 1.2117385864257812, 0.6212596893310547, 0.5874166488647461, 1.3544645309448242, 1.3252754211425781, 0.8925666809082031, 0.6668996810913086, 1.3955860137939453, 0.5580263137817383, 1.5602827072143555, 1.782820701599121, 2.0691566467285156, 1.0072107315063477, 1.7415027618408203, 0.9643373489379883, 1.1927642822265625, 1.271885871887207, 1.4865484237670898, 0.888453483581543, 0.5486574172973633, 0.5985012054443359, 0.6051645278930664, 1.4135475158691406, 1.3915128707885742], "mean_td_error": 1.0270949602127075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1477.0, "diff_num_grad_updates_vs_sampler_policy": 1476.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105900764465332, "actor_loss": -16.111724853515625, "critic_loss": 0.10334945470094681, "alpha_loss": -4.477771282196045, "alpha_value": 0.6420527100563049, "log_alpha_value": -0.44308483600616455, "target_entropy": -6.0, "policy_t": -0.018840434029698372, "mean_q": 13.493390083312988, "max_q": 13.932696342468262, "min_q": 13.136951446533203}, "td_error": [0.6368007659912109, 0.4531364440917969, 0.44527387619018555, 2.4154438972473145, 1.0133066177368164, 0.7307896614074707, 0.47737693786621094, 1.5597705841064453, 1.0406455993652344, 1.0382165908813477, 0.5611419677734375, 0.6096515655517578, 1.2873106002807617, 2.2095694541931152, 2.0680503845214844, 0.972933292388916, 0.20254802703857422, 0.8042993545532227, 0.8952350616455078, 1.198683261871338, 1.4028801918029785, 0.05265951156616211, 2.637576103210449, 0.1440601348876953, 0.11116600036621094, 1.7706670761108398, 2.3425168991088867, 1.9016799926757812, 0.46854352951049805, 1.1169099807739258, 2.6610026359558105, 0.7445640563964844, 0.9412555694580078, 0.30758094787597656, 1.4873976707458496, 0.14552736282348633, 1.674612045288086, 0.9677877426147461, 0.14162540435791016, 0.8568277359008789, 2.1759352684020996, 1.337724208831787, 1.3919811248779297, 0.06744766235351562, 0.22739219665527344, 0.4590926170349121, 2.487771987915039, 0.794562816619873, 1.7442612648010254, 0.7559409141540527, 1.5550823211669922, 0.4937105178833008, 0.5663323402404785, 1.3127012252807617, 0.6979317665100098, 0.2810215950012207, 1.0316572189331055, 1.2994508743286133, 1.7031583786010742, 1.5353455543518066, 1.123593807220459, 0.9537596702575684, 0.6632475852966309, 1.9077692031860352, 0.7291646003723145, 2.302858829498291, 1.1343250274658203, 1.0938282012939453, 1.6876206398010254, 1.6426496505737305, 0.5075693130493164, 1.1994352340698242, 0.7959442138671875, 0.04939842224121094, 1.0122709274291992, 1.6903762817382812, 1.3718109130859375, 0.3652667999267578, 1.2117094993591309, 0.43954992294311523, 0.6836085319519043, 1.2227473258972168, 0.07794523239135742, 1.0234546661376953, 1.7863268852233887, 0.08298301696777344], "mean_td_error": 1.0601714849472046, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1477.0, "diff_num_grad_updates_vs_sampler_policy": 1476.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126540184020996, "actor_loss": -16.247716903686523, "critic_loss": 0.14701321721076965, "alpha_loss": -4.486396312713623, "alpha_value": 0.6420857310295105, "log_alpha_value": -0.44303345680236816, "target_entropy": -6.0, "policy_t": 0.026304202154278755, "mean_q": 13.63967227935791, "max_q": 13.943988800048828, "min_q": 13.276928901672363}, "td_error": [1.1287918090820312, 0.915855884552002, 0.33153629302978516, 0.8260684013366699, 1.2585878372192383, 2.1899337768554688, 1.8131322860717773, 1.0208277702331543, 2.421847343444824, 1.7906885147094727, 1.4075026512145996, 0.39847564697265625, 0.4766879081726074, 0.8745632171630859, 0.3054466247558594, 0.5524883270263672, 0.44720458984375, 1.3459076881408691, 0.7907514572143555, 0.8774290084838867, 1.1402578353881836, 1.4502568244934082, 1.7932467460632324, 0.5238428115844727, 1.4769701957702637, 2.0168819427490234, 0.6887807846069336, 1.264817714691162, 1.2899575233459473, 2.0104031562805176, 1.8963842391967773, 1.5541348457336426, 1.0195832252502441, 1.986109733581543, 1.0013604164123535, 0.9079241752624512, 1.1499199867248535, 1.1154417991638184, 1.3212018013000488, 1.215911865234375, 2.006350517272949, 1.659193992614746, 0.9111943244934082, 0.7597475051879883, 1.0684938430786133, 1.572911262512207, 1.1546072959899902, 1.2516584396362305, 1.5056910514831543, 1.2886853218078613, 0.601712703704834, 1.7340269088745117, 0.4781017303466797, 1.9069709777832031, 0.35780906677246094, 1.0221786499023438, 0.6021451950073242, 1.1881580352783203, 1.1774964332580566, 0.9471917152404785, 1.8343868255615234, 0.9546017646789551, 0.5898432731628418, 1.8464627265930176, 0.3939971923828125, 1.5155558586120605, 0.8888416290283203, 1.247082233428955, 0.16428661346435547, 1.5436506271362305, 1.3198699951171875, 1.6251130104064941, 2.9599103927612305, 0.17699289321899414, 0.4965629577636719, 0.09168577194213867, 0.5361795425415039, 0.7031397819519043, 3.6352462768554688, 1.5239677429199219, 0.9776487350463867, 0.54473876953125, 1.452322006225586, 1.5938448905944824, 0.2356433868408203, 0.8889765739440918], "mean_td_error": 1.1736278533935547, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1477.0, "diff_num_grad_updates_vs_sampler_policy": 1476.0}}, "num_env_steps_sampled": 11837, "num_env_steps_trained": 381066, "num_agent_steps_sampled": 35511, "num_agent_steps_trained": 381066, "last_target_update_ts": 11837, "num_target_updates": 1477}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35511, "num_agent_steps_trained": 381066, "num_env_steps_sampled": 11837, "num_env_steps_trained": 381066, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.93469104427537, "num_env_steps_trained_throughput_per_sec": 2503.8786127747203, "timesteps_total": 11837, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 35511, "timers": {"training_iteration_time_ms": 103.438, "sample_time_ms": 15.847, "load_time_ms": 0.306, "load_throughput": 844358.951, "learn_time_ms": 17.975, "learn_throughput": 14353.557, "synch_weights_time_ms": 11.211}, "counters": {"num_env_steps_sampled": 11837, "num_env_steps_trained": 381066, "num_agent_steps_sampled": 35511, "num_agent_steps_trained": 381066, "last_target_update_ts": 11837, "num_target_updates": 1477}, "done": false, "episodes_total": 0, "training_iteration": 102, "trial_id": "db258_00000", "date": "2023-11-16_21-50-49", "timestamp": 1700200249, "time_this_iter_s": 1.5567660331726074, "time_total_s": 160.42910385131836, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0636a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 160.42910385131836, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 35.9, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.054377555847168, "actor_loss": -26.068206787109375, "critic_loss": 0.10818952322006226, "alpha_loss": -4.503048419952393, "alpha_value": 0.6389880776405334, "log_alpha_value": -0.4478694796562195, "target_entropy": -6.0, "policy_t": -0.015826530754566193, "mean_q": 23.530004501342773, "max_q": 24.027118682861328, "min_q": 22.928529739379883}, "td_error": [1.2444467544555664, 1.5960893630981445, 1.4716987609863281, 0.5588617324829102, 1.266000747680664, 1.0569496154785156, 0.18430614471435547, 1.2131004333496094, 0.7895231246948242, 0.650146484375, 0.6837339401245117, 3.0207176208496094, 0.42432212829589844, 0.8153743743896484, 0.45258331298828125, 0.631378173828125, 1.2041473388671875, 1.8090438842773438, 2.350616455078125, 0.5924148559570312, 0.24633502960205078, 2.378570556640625, 0.7515506744384766, 1.1797370910644531, 2.1171798706054688, 1.3998661041259766, 1.6764049530029297, 1.6160612106323242, 1.7993049621582031, 1.0890674591064453, 2.094816207885742, 0.33339405059814453, 1.3911161422729492, 0.46680545806884766, 0.08321666717529297, 1.4518632888793945, 1.8048839569091797, 0.4681882858276367, 1.4178638458251953, 0.7627534866333008, 0.6408214569091797, 0.7602901458740234, 1.575714111328125, 0.1463766098022461, 1.431344985961914, 0.6079502105712891, 1.007303237915039, 1.5005111694335938, 0.4701728820800781, 1.3223590850830078, 0.3767051696777344, 2.196409225463867, 0.5366268157958984, 1.5124120712280273, 2.7755680084228516, 1.323648452758789, 1.9796886444091797, 0.5281267166137695, 0.24587249755859375, 1.320845603942871, 1.1465768814086914, 2.0355758666992188, 1.0329608917236328, 0.7116165161132812, 0.44913768768310547, 1.2749271392822266, 0.36817169189453125, 2.231365203857422, 1.935800552368164, 0.5287561416625977, 1.6488113403320312, 0.9478797912597656, 1.1937255859375, 0.7887973785400391, 0.8589448928833008, 2.0426902770996094, 0.5262918472290039, 0.6018753051757812, 1.8993453979492188, 1.023386001586914, 2.6731481552124023, 1.876326560974121, 1.2550230026245117, 1.9842090606689453, 1.2327966690063477, 0.7063846588134766], "mean_td_error": 1.1834615468978882, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1492.0, "diff_num_grad_updates_vs_sampler_policy": 1491.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113468170166016, "actor_loss": -16.26835823059082, "critic_loss": 0.10554779320955276, "alpha_loss": -4.526660442352295, "alpha_value": 0.639168381690979, "log_alpha_value": -0.44758734107017517, "target_entropy": -6.0, "policy_t": -0.0035556568764150143, "mean_q": 13.66756534576416, "max_q": 14.038060188293457, "min_q": 13.238479614257812}, "td_error": [1.014509677886963, 0.26761341094970703, 0.8410649299621582, 1.4209585189819336, 2.301088333129883, 1.277116298675537, 0.3323078155517578, 1.8979148864746094, 1.6600956916809082, 2.1893701553344727, 0.11698436737060547, 0.08691167831420898, 0.8006577491760254, 0.3196120262145996, 1.471970558166504, 1.1880035400390625, 2.166757106781006, 0.5136599540710449, 0.25904273986816406, 0.6526374816894531, 0.9199533462524414, 1.8914427757263184, 0.4445366859436035, 0.880763053894043, 0.9130468368530273, 2.5780887603759766, 1.7486376762390137, 1.9664583206176758, 0.35892629623413086, 1.5881409645080566, 1.2696866989135742, 0.827021598815918, 0.8489365577697754, 3.1860814094543457, 1.6985111236572266, 0.6441121101379395, 0.7032008171081543, 0.7753934860229492, 0.7301435470581055, 0.30131053924560547, 1.5376396179199219, 0.523745059967041, 0.1380910873413086, 1.2565078735351562, 1.7883028984069824, 1.3606877326965332, 1.0006933212280273, 1.5158963203430176, 0.9040203094482422, 1.2061214447021484, 0.9706082344055176, 0.9745779037475586, 1.7931561470031738, 0.9321708679199219, 0.3202357292175293, 0.23409318923950195, 2.0069308280944824, 0.4617757797241211, 0.18175411224365234, 0.9461870193481445, 0.5267524719238281, 0.809598445892334, 0.7537879943847656, 0.7797379493713379, 0.8131799697875977, 1.1700043678283691, 0.3218846321105957, 1.6149678230285645, 1.0009875297546387, 2.385995388031006, 1.0518736839294434, 1.0554699897766113, 1.815505027770996, 0.0392460823059082, 1.0527887344360352, 0.9886417388916016, 0.1445779800415039, 2.3817758560180664, 2.195054054260254, 0.6385574340820312, 0.0441441535949707, 0.637054443359375, 0.7180237770080566, 1.754889965057373, 2.0911145210266113, 1.6153850555419922], "mean_td_error": 1.0872890949249268, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1492.0, "diff_num_grad_updates_vs_sampler_policy": 1491.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10311222076416, "actor_loss": -16.319385528564453, "critic_loss": 0.14087271690368652, "alpha_loss": -4.521514415740967, "alpha_value": 0.6392006874084473, "log_alpha_value": -0.447536826133728, "target_entropy": -6.0, "policy_t": -0.04513336718082428, "mean_q": 13.745901107788086, "max_q": 14.073823928833008, "min_q": 13.487922668457031}, "td_error": [3.8071489334106445, 1.8003506660461426, 0.20035362243652344, 1.1251111030578613, 1.0327978134155273, 0.5826997756958008, 1.2724723815917969, 0.6421914100646973, 0.7439570426940918, 0.5702857971191406, 0.7907509803771973, 0.09267902374267578, 0.9955587387084961, 1.0677824020385742, 2.1719250679016113, 0.16859197616577148, 0.22698402404785156, 0.3567490577697754, 0.4915199279785156, 1.1353673934936523, 1.0470476150512695, 0.34805870056152344, 1.0671029090881348, 1.714040756225586, 2.3274388313293457, 1.1387066841125488, 0.475522518157959, 0.10502147674560547, 0.8839826583862305, 0.7171192169189453, 2.262361526489258, 1.830970287322998, 0.9349827766418457, 0.6198492050170898, 1.8350038528442383, 0.5085630416870117, 0.3511996269226074, 0.5066161155700684, 0.6353487968444824, 0.05537080764770508, 1.4233827590942383, 2.0147924423217773, 1.3790578842163086, 1.0630784034729004, 1.7359414100646973, 0.33374595642089844, 0.9346790313720703, 0.8457760810852051, 0.5624942779541016, 1.8206005096435547, 0.31906986236572266, 1.0726866722106934, 0.8535699844360352, 0.9362287521362305, 1.9119153022766113, 1.101942539215088, 0.9889326095581055, 1.2955822944641113, 1.1911077499389648, 1.8539676666259766, 0.9140639305114746, 1.245593547821045, 0.6703085899353027, 1.3525185585021973, 0.3935723304748535, 1.8575506210327148, 1.1173734664916992, 2.2245912551879883, 3.1422486305236816, 0.4877920150756836, 0.49205780029296875, 1.1757893562316895, 1.0366277694702148, 0.9442505836486816, 1.9642038345336914, 1.3172197341918945, 1.1628141403198242, 2.219205379486084, 1.766622543334961, 0.918266773223877, 2.59592866897583, 0.03446006774902344, 1.2614336013793945, 2.241605758666992, 0.15362834930419922, 1.2337450981140137], "mean_td_error": 1.1186232566833496, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1492.0, "diff_num_grad_updates_vs_sampler_policy": 1491.0}}, "num_env_steps_sampled": 11942, "num_env_steps_trained": 384936, "num_agent_steps_sampled": 35826, "num_agent_steps_trained": 384936, "last_target_update_ts": 11942, "num_target_updates": 1492}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35826, "num_agent_steps_trained": 384936, "num_env_steps_sampled": 11942, "num_env_steps_trained": 384936, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 64.844995516527, "num_env_steps_trained_throughput_per_sec": 2390.001263323424, "timesteps_total": 11942, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 35826, "timers": {"training_iteration_time_ms": 108.89, "sample_time_ms": 17.519, "load_time_ms": 0.32, "load_throughput": 806536.806, "learn_time_ms": 19.764, "learn_throughput": 13054.23, "synch_weights_time_ms": 11.377}, "counters": {"num_env_steps_sampled": 11942, "num_env_steps_trained": 384936, "num_agent_steps_sampled": 35826, "num_agent_steps_trained": 384936, "last_target_update_ts": 11942, "num_target_updates": 1492}, "done": false, "episodes_total": 0, "training_iteration": 103, "trial_id": "db258_00000", "date": "2023-11-16_21-50-51", "timestamp": 1700200251, "time_this_iter_s": 1.633648157119751, "time_total_s": 162.0627520084381, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0637e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 162.0627520084381, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 41.43333333333333, "ram_util_percent": 64.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.090106010437012, "actor_loss": -26.196428298950195, "critic_loss": 0.09583941102027893, "alpha_loss": -4.564487934112549, "alpha_value": 0.6361171007156372, "log_alpha_value": -0.45237261056900024, "target_entropy": -6.0, "policy_t": -0.0003814914380200207, "mean_q": 23.651702880859375, "max_q": 24.052392959594727, "min_q": 22.931791305541992}, "td_error": [0.1399822235107422, 1.2149934768676758, 1.2876253128051758, 1.3601465225219727, 0.8287782669067383, 1.8000335693359375, 0.31340599060058594, 1.1022100448608398, 0.119110107421875, 1.5773639678955078, 1.0136756896972656, 1.8764753341674805, 1.8448123931884766, 0.5277194976806641, 1.2805309295654297, 0.28876399993896484, 1.4431705474853516, 1.5526933670043945, 1.957472801208496, 0.4306983947753906, 2.070556640625, 1.8730926513671875, 2.1673593521118164, 0.9106197357177734, 1.8222618103027344, 0.501556396484375, 1.8377685546875, 0.8171768188476562, 0.45246219635009766, 0.4031200408935547, 2.2336254119873047, 0.7266016006469727, 0.6425037384033203, 0.13266468048095703, 0.33943939208984375, 0.9924526214599609, 1.6694116592407227, 1.6502838134765625, 1.3234386444091797, 0.10820293426513672, 2.0817079544067383, 1.2203044891357422, 1.0680646896362305, 0.6661014556884766, 0.6537113189697266, 0.8421945571899414, 1.0633907318115234, 0.4049978256225586, 0.786503791809082, 1.6669702529907227, 0.81060791015625, 1.8230295181274414, 0.6717929840087891, 0.5062484741210938, 1.3813934326171875, 3.6496829986572266, 1.3125286102294922, 0.10982131958007812, 0.45140743255615234, 0.9603767395019531, 0.2209033966064453, 0.883366584777832, 1.8852834701538086, 0.5131893157958984, 1.0567474365234375, 0.8069705963134766, 0.12937355041503906, 1.8568696975708008, 1.0712909698486328, 1.2569570541381836, 1.4761886596679688, 0.6954708099365234, 1.027735710144043, 0.36030101776123047, 0.6117649078369141, 1.049774169921875, 1.4256725311279297, 1.6119003295898438, 0.8008661270141602, 0.5187492370605469, 0.5787553787231445, 1.6287736892700195, 0.5005998611450195, 1.9889822006225586, 1.3113136291503906, 0.9102973937988281], "mean_td_error": 1.0807348489761353, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1507.0, "diff_num_grad_updates_vs_sampler_policy": 1506.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.023386001586914, "actor_loss": -16.147003173828125, "critic_loss": 0.10964465141296387, "alpha_loss": -4.531489372253418, "alpha_value": 0.6362958550453186, "log_alpha_value": -0.45209166407585144, "target_entropy": -6.0, "policy_t": -0.040013644844293594, "mean_q": 13.609217643737793, "max_q": 13.932104110717773, "min_q": 13.169283866882324}, "td_error": [0.8177862167358398, 2.055996894836426, 0.9033393859863281, 0.8672189712524414, 1.6293258666992188, 0.9763078689575195, 0.5879216194152832, 0.6945843696594238, 0.47462987899780273, 0.9331245422363281, 0.24354267120361328, 2.230902671813965, 1.5099468231201172, 2.297138214111328, 0.02583026885986328, 0.042189598083496094, 1.2120580673217773, 0.871086597442627, 1.2853245735168457, 0.6991968154907227, 2.933441162109375, 1.7822346687316895, 0.2485184669494629, 0.5666165351867676, 0.41690921783447266, 0.5399231910705566, 0.7549839019775391, 0.8338994979858398, 1.037506103515625, 1.1540136337280273, 1.9466285705566406, 1.4627690315246582, 0.7295637130737305, 0.36684703826904297, 2.372189998626709, 1.2453408241271973, 1.6820507049560547, 1.7754898071289062, 1.200235366821289, 0.8576755523681641, 0.10789155960083008, 1.2171053886413574, 2.383294105529785, 2.2216057777404785, 0.5158181190490723, 0.6696734428405762, 1.8751587867736816, 0.35479021072387695, 1.7621688842773438, 1.8245477676391602, 2.403313159942627, 0.6962442398071289, 0.7529864311218262, 1.0685863494873047, 0.8418550491333008, 1.1804800033569336, 0.4642825126647949, 0.6624102592468262, 0.47636938095092773, 0.07529544830322266, 0.4435110092163086, 0.6076202392578125, 1.8658027648925781, 1.7289180755615234, 2.31906795501709, 1.2818279266357422, 1.4297089576721191, 0.08256292343139648, 1.5402960777282715, 1.0635547637939453, 2.521998882293701, 0.18276739120483398, 0.6461844444274902, 1.0988187789916992, 0.12106037139892578, 0.7030458450317383, 1.9343385696411133, 0.11315727233886719, 1.3064794540405273, 1.4442057609558105, 1.4147777557373047, 0.8081598281860352, 1.7843122482299805, 0.4517240524291992, 1.2301063537597656, 0.5480422973632812], "mean_td_error": 1.0987235307693481, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1507.0, "diff_num_grad_updates_vs_sampler_policy": 1506.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.097890853881836, "actor_loss": -16.253936767578125, "critic_loss": 0.18854151666164398, "alpha_loss": -4.564652919769287, "alpha_value": 0.6363285183906555, "log_alpha_value": -0.45204028487205505, "target_entropy": -6.0, "policy_t": -0.013937488198280334, "mean_q": 13.673345565795898, "max_q": 13.982644081115723, "min_q": 13.299444198608398}, "td_error": [1.0782732963562012, 1.5796294212341309, 0.9221925735473633, 2.0206685066223145, 1.0105886459350586, 1.1620206832885742, 0.40038633346557617, 2.0314836502075195, 1.738955020904541, 1.249100685119629, 2.528441905975342, 1.4544334411621094, 1.1436080932617188, 2.1603989601135254, 0.285494327545166, 0.38828611373901367, 2.2920284271240234, 0.22233915328979492, 1.8419303894042969, 1.1462230682373047, 0.9118123054504395, 3.128624439239502, 1.1865644454956055, 3.8803625106811523, 0.8695931434631348, 1.8203535079956055, 1.642763614654541, 2.03855562210083, 1.0134468078613281, 2.5555615425109863, 1.1512608528137207, 0.52142333984375, 1.840479850769043, 1.036177635192871, 1.2774076461791992, 1.6905856132507324, 1.8486847877502441, 3.9315738677978516, 0.9090003967285156, 1.803110122680664, 0.8316893577575684, 0.5171585083007812, 1.2134218215942383, 1.546938419342041, 1.8999919891357422, 0.5923523902893066, 2.3699169158935547, 1.4461350440979004, 0.994288444519043, 1.1761627197265625, 0.42986011505126953, 0.9530792236328125, 1.1150212287902832, 0.5733194351196289, 0.1653733253479004, 1.779078483581543, 0.7002983093261719, 0.5070838928222656, 1.8402671813964844, 2.442750930786133, 0.18681049346923828, 0.1983013153076172, 0.9755210876464844, 1.6823797225952148, 0.20673418045043945, 0.44420957565307617, 1.445692539215088, 1.6967482566833496, 2.3980326652526855, 0.5957374572753906, 1.4878215789794922, 1.997373104095459, 1.711212158203125, 0.3397355079650879, 2.315702438354492, 1.2297759056091309, 1.1254487037658691, 2.51806640625, 2.550487518310547, 1.6972107887268066, 2.0073728561401367, 1.6984210014343262, 0.3379969596862793, 0.9597692489624023, 2.5786819458007812, 2.7883615493774414], "mean_td_error": 1.4183909893035889, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1507.0, "diff_num_grad_updates_vs_sampler_policy": 1506.0}}, "num_env_steps_sampled": 12047, "num_env_steps_trained": 388806, "num_agent_steps_sampled": 36141, "num_agent_steps_trained": 388806, "last_target_update_ts": 12047, "num_target_updates": 1507}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36141, "num_agent_steps_trained": 388806, "num_env_steps_sampled": 12047, "num_env_steps_trained": 388806, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 65.84797437621876, "num_env_steps_trained_throughput_per_sec": 2426.968198437777, "timesteps_total": 12047, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 36141, "timers": {"training_iteration_time_ms": 106.428, "sample_time_ms": 17.106, "load_time_ms": 0.325, "load_throughput": 793641.681, "learn_time_ms": 18.62, "learn_throughput": 13855.987, "synch_weights_time_ms": 10.596}, "counters": {"num_env_steps_sampled": 12047, "num_env_steps_trained": 388806, "num_agent_steps_sampled": 36141, "num_agent_steps_trained": 388806, "last_target_update_ts": 12047, "num_target_updates": 1507}, "done": false, "episodes_total": 0, "training_iteration": 104, "trial_id": "db258_00000", "date": "2023-11-16_21-50-52", "timestamp": 1700200252, "time_this_iter_s": 1.604567050933838, "time_total_s": 163.66731905937195, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 163.66731905937195, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 41.05, "ram_util_percent": 64.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082712173461914, "actor_loss": -26.42485237121582, "critic_loss": 0.11281151324510574, "alpha_loss": -4.6065473556518555, "alpha_value": 0.6332589983940125, "log_alpha_value": -0.4568758010864258, "target_entropy": -6.0, "policy_t": 0.024654068052768707, "mean_q": 23.9045467376709, "max_q": 24.32691192626953, "min_q": 23.365907669067383}, "td_error": [1.4329185485839844, 0.023572921752929688, 1.4361810684204102, 2.6566267013549805, 1.4771146774291992, 0.6729507446289062, 0.24944210052490234, 1.1640243530273438, 1.0031118392944336, 1.0622272491455078, 0.9956178665161133, 0.8407573699951172, 1.2860965728759766, 1.8393621444702148, 0.6683816909790039, 0.6889381408691406, 1.1866140365600586, 1.9429969787597656, 1.5474615097045898, 2.071613311767578, 1.5045127868652344, 1.3922176361083984, 0.6900138854980469, 1.6271257400512695, 1.8108396530151367, 1.342538833618164, 0.65203857421875, 0.08653068542480469, 1.3124475479125977, 0.2339305877685547, 0.2101898193359375, 1.06781005859375, 0.5207815170288086, 0.07744026184082031, 0.032619476318359375, 1.2663030624389648, 1.4589414596557617, 0.19280052185058594, 0.5999002456665039, 1.7247838973999023, 2.622561454772949, 0.7205390930175781, 0.2006988525390625, 0.20327091217041016, 1.625746726989746, 0.24366378784179688, 0.9284439086914062, 1.8205394744873047, 0.9550924301147461, 1.9829540252685547, 1.9139442443847656, 1.9899721145629883, 1.207315444946289, 0.806706428527832, 1.325850486755371, 0.8472213745117188, 3.254758834838867, 1.816995620727539, 1.9067745208740234, 0.07397842407226562, 1.891977310180664, 1.4092769622802734, 0.5174684524536133, 0.3624601364135742, 0.5863628387451172, 0.5971860885620117, 1.4880847930908203, 1.9220647811889648, 0.6552257537841797, 1.3444480895996094, 1.6724767684936523, 0.159698486328125, 1.944718360900879, 1.3332452774047852, 0.24853801727294922, 1.086195945739746, 2.6301469802856445, 0.8997869491577148, 2.3710927963256836, 1.364699363708496, 1.320113182067871, 2.6194276809692383, 1.6037635803222656, 0.5072259902954102, 2.6351194381713867, 2.091552734375], "mean_td_error": 1.206501841545105, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1522.0, "diff_num_grad_updates_vs_sampler_policy": 1521.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073969841003418, "actor_loss": -16.21204376220703, "critic_loss": 0.09394952654838562, "alpha_loss": -4.599733829498291, "alpha_value": 0.6334362626075745, "log_alpha_value": -0.45659589767456055, "target_entropy": -6.0, "policy_t": 0.014719081111252308, "mean_q": 13.658685684204102, "max_q": 14.173727989196777, "min_q": 13.169479370117188}, "td_error": [0.6853413581848145, 0.8119091987609863, 1.0398316383361816, 0.8266329765319824, 0.62506103515625, 0.8262519836425781, 1.5994195938110352, 0.4519643783569336, 0.8525705337524414, 0.17199230194091797, 2.3522262573242188, 0.5787663459777832, 0.6925139427185059, 0.08189868927001953, 0.8705754280090332, 2.10507869720459, 2.417119026184082, 1.4530668258666992, 0.3216114044189453, 0.8265657424926758, 0.585874080657959, 0.5410127639770508, 0.1064920425415039, 1.0219979286193848, 0.6712799072265625, 0.6877632141113281, 0.03086090087890625, 1.3747363090515137, 0.9728846549987793, 0.03579902648925781, 0.9734311103820801, 0.39089059829711914, 1.097132682800293, 1.186326026916504, 1.1362290382385254, 1.6955575942993164, 0.10364341735839844, 1.2171430587768555, 1.7367463111877441, 1.4373078346252441, 0.468137264251709, 1.3603968620300293, 1.2260851860046387, 0.1365976333618164, 0.25857019424438477, 0.7255845069885254, 2.7746663093566895, 0.9721107482910156, 0.025617599487304688, 1.2612276077270508, 0.35090160369873047, 1.0514297485351562, 1.3513917922973633, 1.9694242477416992, 0.6405277252197266, 0.8936448097229004, 1.0461807250976562, 0.29158926010131836, 1.920994758605957, 2.104891777038574, 1.4523100852966309, 0.9963626861572266, 0.8503732681274414, 0.727508544921875, 0.45296716690063477, 0.41768932342529297, 1.632598876953125, 1.4688720703125, 1.8620948791503906, 0.4435544013977051, 0.3681764602661133, 0.9277420043945312, 0.6756973266601562, 0.2678666114807129, 0.7849578857421875, 1.411217212677002, 1.6204891204833984, 0.7644410133361816, 0.2987480163574219, 0.8469018936157227, 2.5721349716186523, 0.939262866973877, 0.8332605361938477, 1.1608161926269531, 2.2011208534240723, 1.5159845352172852], "mean_td_error": 0.9874025583267212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1522.0, "diff_num_grad_updates_vs_sampler_policy": 1521.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.127660751342773, "actor_loss": -16.294771194458008, "critic_loss": 0.14655452966690063, "alpha_loss": -4.623709201812744, "alpha_value": 0.6334699988365173, "log_alpha_value": -0.4565426707267761, "target_entropy": -6.0, "policy_t": -0.01636168174445629, "mean_q": 13.732572555541992, "max_q": 13.989128112792969, "min_q": 13.478294372558594}, "td_error": [1.0068426132202148, 0.07226228713989258, 2.552943229675293, 1.5010004043579102, 0.7057352066040039, 0.6318411827087402, 1.190000057220459, 1.3055033683776855, 1.5063796043395996, 1.339156150817871, 1.7854347229003906, 2.1374568939208984, 0.7943520545959473, 1.3857698440551758, 0.010226249694824219, 1.4243526458740234, 1.693162441253662, 0.8247575759887695, 1.7949943542480469, 1.8153400421142578, 0.855008602142334, 0.27303600311279297, 0.16025972366333008, 0.1903247833251953, 1.1042280197143555, 0.4754161834716797, 1.5481252670288086, 1.3549633026123047, 1.2999119758605957, 1.1253175735473633, 0.6304931640625, 0.12171125411987305, 0.7627372741699219, 2.4388904571533203, 0.08640575408935547, 0.05640411376953125, 0.38829898834228516, 1.3031415939331055, 1.1821441650390625, 1.0617876052856445, 0.5304865837097168, 0.5915966033935547, 3.416813373565674, 2.205439567565918, 1.4996438026428223, 0.7420234680175781, 0.6559672355651855, 0.44521617889404297, 0.8215994834899902, 1.9877986907958984, 1.441939353942871, 0.6454224586486816, 0.7721824645996094, 1.7943339347839355, 0.8799905776977539, 0.21464157104492188, 0.17950916290283203, 1.8885002136230469, 1.0821290016174316, 1.8615875244140625, 1.2979040145874023, 1.356522560119629, 0.7440075874328613, 1.025430679321289, 1.232633113861084, 0.4803180694580078, 1.6256680488586426, 1.5601835250854492, 0.6468186378479004, 1.1002988815307617, 2.1198034286499023, 2.133627414703369, 0.5908007621765137, 1.5556249618530273, 0.7538719177246094, 2.244783401489258, 1.4171671867370605, 0.4310774803161621, 0.5315494537353516, 1.8781862258911133, 2.00148868560791, 0.601555347442627, 1.5667338371276855, 1.4198684692382812, 1.5984044075012207, 0.7689690589904785], "mean_td_error": 1.1422817707061768, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1522.0, "diff_num_grad_updates_vs_sampler_policy": 1521.0}}, "num_env_steps_sampled": 12152, "num_env_steps_trained": 392676, "num_agent_steps_sampled": 36456, "num_agent_steps_trained": 392676, "last_target_update_ts": 12152, "num_target_updates": 1522}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36456, "num_agent_steps_trained": 392676, "num_env_steps_sampled": 12152, "num_env_steps_trained": 392676, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.16661112742065, "num_env_steps_trained_throughput_per_sec": 2438.712238696361, "timesteps_total": 12152, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 36456, "timers": {"training_iteration_time_ms": 106.468, "sample_time_ms": 17.144, "load_time_ms": 0.314, "load_throughput": 821039.781, "learn_time_ms": 18.662, "learn_throughput": 13825.132, "synch_weights_time_ms": 10.314}, "counters": {"num_env_steps_sampled": 12152, "num_env_steps_trained": 392676, "num_agent_steps_sampled": 36456, "num_agent_steps_trained": 392676, "last_target_update_ts": 12152, "num_target_updates": 1522}, "done": false, "episodes_total": 0, "training_iteration": 105, "trial_id": "db258_00000", "date": "2023-11-16_21-50-54", "timestamp": 1700200254, "time_this_iter_s": 1.5963199138641357, "time_total_s": 165.26363897323608, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb7b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 165.26363897323608, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 35.95, "ram_util_percent": 63.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125432014465332, "actor_loss": -26.505645751953125, "critic_loss": 0.08691749721765518, "alpha_loss": -4.67169189453125, "alpha_value": 0.6304118037223816, "log_alpha_value": -0.4613819718360901, "target_entropy": -6.0, "policy_t": 0.005594157613813877, "mean_q": 23.984235763549805, "max_q": 24.365951538085938, "min_q": 23.47844696044922}, "td_error": [0.7853775024414062, 0.2631959915161133, 1.7901182174682617, 1.232858657836914, 1.0626325607299805, 1.1629676818847656, 0.03513145446777344, 0.02099895477294922, 1.2335624694824219, 1.7219057083129883, 0.9322109222412109, 1.1935348510742188, 2.270411491394043, 0.1301107406616211, 0.33608436584472656, 0.3038797378540039, 0.3596954345703125, 0.6549892425537109, 0.5184297561645508, 1.1036710739135742, 1.7701988220214844, 1.0927925109863281, 0.23309707641601562, 1.9023847579956055, 1.902008056640625, 1.1503582000732422, 0.8943500518798828, 0.9577598571777344, 0.14501953125, 1.0731773376464844, 1.0990829467773438, 1.0698680877685547, 0.3404693603515625, 1.0833330154418945, 0.4648933410644531, 0.4698934555053711, 1.540924072265625, 1.8274707794189453, 3.214527130126953, 2.7584962844848633, 0.4733390808105469, 3.3989076614379883, 0.5430660247802734, 1.295400619506836, 0.19040298461914062, 1.6582660675048828, 1.1501693725585938, 1.1490516662597656, 0.5490303039550781, 0.8087377548217773, 0.17890167236328125, 1.1871757507324219, 0.8920669555664062, 0.06374645233154297, 2.001384735107422, 0.6782989501953125, 3.143564224243164, 0.1446371078491211, 1.3571176528930664, 0.560551643371582, 0.2578849792480469, 1.7046432495117188, 1.1325197219848633, 1.1777114868164062, 1.3282947540283203, 0.9528884887695312, 0.07485675811767578, 0.8005590438842773, 0.5518093109130859, 1.5425348281860352, 0.42189884185791016, 0.6306018829345703, 0.4611682891845703, 0.11353397369384766, 0.6972227096557617, 2.1356143951416016, 0.6481847763061523, 0.25286102294921875, 0.5097770690917969, 0.014257431030273438, 1.6748113632202148, 0.9820070266723633, 0.9765243530273438, 1.411250114440918, 0.672266960144043, 0.6364507675170898], "mean_td_error": 0.9917188882827759, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1537.0, "diff_num_grad_updates_vs_sampler_policy": 1536.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093740463256836, "actor_loss": -16.32636833190918, "critic_loss": 0.11108845472335815, "alpha_loss": -4.654238224029541, "alpha_value": 0.630588710308075, "log_alpha_value": -0.4611014425754547, "target_entropy": -6.0, "policy_t": 0.042239535599946976, "mean_q": 13.79043960571289, "max_q": 14.121618270874023, "min_q": 13.43053913116455}, "td_error": [0.048720359802246094, 1.6698217391967773, 0.5876874923706055, 0.6753091812133789, 0.8896818161010742, 1.1191906929016113, 1.5171308517456055, 1.976388931274414, 0.4611372947692871, 0.32268667221069336, 1.807462215423584, 1.4198198318481445, 1.6317310333251953, 0.31726598739624023, 0.6264748573303223, 1.9681272506713867, 0.8095741271972656, 1.2366247177124023, 1.4960169792175293, 0.3141331672668457, 0.4961099624633789, 0.7526025772094727, 1.1426925659179688, 1.1645374298095703, 2.0602474212646484, 0.054157257080078125, 2.0530333518981934, 0.888361930847168, 2.014772415161133, 0.959040641784668, 0.9429769515991211, 2.7437567710876465, 0.6923837661743164, 2.1842665672302246, 1.2099618911743164, 0.46558380126953125, 2.4641594886779785, 1.4421906471252441, 0.18449783325195312, 0.7657709121704102, 1.2585844993591309, 1.4308185577392578, 0.3014044761657715, 1.304182529449463, 0.9693255424499512, 2.540212631225586, 1.2152304649353027, 1.6502432823181152, 1.81486177444458, 0.7707042694091797, 0.9804973602294922, 0.22047138214111328, 2.2047324180603027, 0.19327640533447266, 0.7460975646972656, 1.1474390029907227, 1.0617671012878418, 0.9238944053649902, 0.5700254440307617, 0.16484355926513672, 0.8316235542297363, 1.6660857200622559, 1.6504125595092773, 0.554718017578125, 2.6973166465759277, 0.42391109466552734, 1.1439170837402344, 0.3109593391418457, 1.0760912895202637, 1.2665519714355469, 2.5016088485717773, 0.5723004341125488, 0.41819286346435547, 0.28334474563598633, 1.632979393005371, 1.4947786331176758, 0.5048480033874512, 1.7345771789550781, 1.49375581741333, 1.2334465980529785, 0.6290206909179688, 0.9048905372619629, 1.0772624015808105, 1.2804784774780273, 0.8020725250244141, 2.014580249786377], "mean_td_error": 1.1307491064071655, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1537.0, "diff_num_grad_updates_vs_sampler_policy": 1536.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025993347167969, "actor_loss": -16.195533752441406, "critic_loss": 0.13879474997520447, "alpha_loss": -4.62247896194458, "alpha_value": 0.6306214332580566, "log_alpha_value": -0.46104949712753296, "target_entropy": -6.0, "policy_t": 0.021745149046182632, "mean_q": 13.71866512298584, "max_q": 14.094490051269531, "min_q": 13.384746551513672}, "td_error": [0.13176918029785156, 0.8026676177978516, 3.44051456451416, 0.646122932434082, 1.6041250228881836, 0.4232187271118164, 1.5102944374084473, 2.2584142684936523, 0.049985408782958984, 0.4148826599121094, 0.8082294464111328, 1.0079703330993652, 0.684443473815918, 0.6739153861999512, 1.7414417266845703, 0.38486146926879883, 0.883333683013916, 0.44049072265625, 2.323906898498535, 0.0074787139892578125, 1.0134992599487305, 0.22848939895629883, 0.41832923889160156, 1.5882434844970703, 0.24208784103393555, 0.38851165771484375, 0.6137466430664062, 0.8322749137878418, 0.6732759475708008, 1.795166015625, 0.8160481452941895, 1.9891433715820312, 0.8910355567932129, 1.0196013450622559, 0.3268923759460449, 1.43182373046875, 2.53375244140625, 0.25954771041870117, 0.646575927734375, 1.2404966354370117, 0.9614725112915039, 0.8096408843994141, 0.1842813491821289, 0.1668257713317871, 1.8702654838562012, 0.0678858757019043, 0.11285018920898438, 1.5273423194885254, 0.7619056701660156, 2.472320556640625, 0.5809717178344727, 0.1443924903869629, 0.5857734680175781, 1.6771235466003418, 2.0772976875305176, 2.517192840576172, 0.8071937561035156, 2.294107437133789, 2.095825672149658, 1.1072196960449219, 0.8311872482299805, 0.4743471145629883, 1.0247907638549805, 0.9993429183959961, 1.0915837287902832, 1.7954659461975098, 1.6056199073791504, 2.627336025238037, 0.8503751754760742, 1.1859498023986816, 0.8069496154785156, 0.9322566986083984, 2.337775230407715, 1.5070686340332031, 0.41160106658935547, 3.0420947074890137, 0.5320987701416016, 0.1519331932067871, 0.9633574485778809, 1.3073153495788574, 2.144918918609619, 1.476393222808838, 1.7459306716918945, 0.7898893356323242, 0.5685358047485352, 0.9956188201904297], "mean_td_error": 1.0954445600509644, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1537.0, "diff_num_grad_updates_vs_sampler_policy": 1536.0}}, "num_env_steps_sampled": 12257, "num_env_steps_trained": 396546, "num_agent_steps_sampled": 36771, "num_agent_steps_trained": 396546, "last_target_update_ts": 12257, "num_target_updates": 1537}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36771, "num_agent_steps_trained": 396546, "num_env_steps_sampled": 12257, "num_env_steps_trained": 396546, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.03726564648895, "num_env_steps_trained_throughput_per_sec": 2470.8020766848786, "timesteps_total": 12257, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 36771, "timers": {"training_iteration_time_ms": 104.14, "sample_time_ms": 15.721, "load_time_ms": 0.315, "load_throughput": 819051.19, "learn_time_ms": 18.073, "learn_throughput": 14275.562, "synch_weights_time_ms": 9.615}, "counters": {"num_env_steps_sampled": 12257, "num_env_steps_trained": 396546, "num_agent_steps_sampled": 36771, "num_agent_steps_trained": 396546, "last_target_update_ts": 12257, "num_target_updates": 1537}, "done": false, "episodes_total": 0, "training_iteration": 106, "trial_id": "db258_00000", "date": "2023-11-16_21-50-55", "timestamp": 1700200255, "time_this_iter_s": 1.57352614402771, "time_total_s": 166.8371651172638, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 166.8371651172638, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 34.833333333333336, "ram_util_percent": 63.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.168861389160156, "actor_loss": -26.40384864807129, "critic_loss": 0.08896149694919586, "alpha_loss": -4.737606525421143, "alpha_value": 0.6275741457939148, "log_alpha_value": -0.4658934473991394, "target_entropy": -6.0, "policy_t": 0.02088611014187336, "mean_q": 23.827125549316406, "max_q": 24.216384887695312, "min_q": 23.3211612701416}, "td_error": [1.3580083847045898, 0.8466129302978516, 2.351747512817383, 1.3416156768798828, 1.6201152801513672, 0.44992637634277344, 0.5090713500976562, 3.194766044616699, 0.9357089996337891, 0.8069238662719727, 0.15497970581054688, 0.6164398193359375, 2.4002685546875, 1.217214584350586, 2.0800256729125977, 0.9515523910522461, 0.9308900833129883, 0.14871692657470703, 1.0282268524169922, 0.8855104446411133, 0.4724893569946289, 1.0395793914794922, 2.557906150817871, 0.8294916152954102, 0.5203142166137695, 1.0813522338867188, 1.604771614074707, 0.03717327117919922, 1.350001335144043, 0.3108196258544922, 0.9789505004882812, 0.9095277786254883, 1.432478904724121, 1.6900463104248047, 0.84814453125, 1.2090301513671875, 2.6141719818115234, 0.8292150497436523, 0.4934358596801758, 0.2865324020385742, 0.3233470916748047, 0.6822643280029297, 1.8749885559082031, 1.7821226119995117, 2.160917282104492, 1.5016717910766602, 0.6038370132446289, 0.9059505462646484, 0.7920370101928711, 0.5793647766113281, 2.265768051147461, 1.886077880859375, 1.0512619018554688, 2.1153125762939453, 0.7992534637451172, 0.6261415481567383, 0.8878049850463867, 1.0910663604736328, 0.30530643463134766, 0.26430511474609375, 0.09087181091308594, 0.14453697204589844, 0.707667350769043, 1.0770912170410156, 1.6890182495117188, 0.5649080276489258, 1.7020435333251953, 0.5512590408325195, 0.3017921447753906, 1.5358829498291016, 1.7445011138916016, 1.3727760314941406, 0.6991329193115234, 0.5567941665649414, 0.2664670944213867, 1.4016637802124023, 2.311457633972168, 0.531702995300293, 0.664769172668457, 0.4728384017944336, 0.2633199691772461, 0.2944831848144531, 1.4589738845825195, 0.16434574127197266, 0.3835592269897461, 0.41193103790283203], "mean_td_error": 1.0323994159698486, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1552.0, "diff_num_grad_updates_vs_sampler_policy": 1551.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.187479019165039, "actor_loss": -16.247690200805664, "critic_loss": 0.14182564616203308, "alpha_loss": -4.743319988250732, "alpha_value": 0.6277565360069275, "log_alpha_value": -0.46560290455818176, "target_entropy": -6.0, "policy_t": -0.01967809908092022, "mean_q": 13.647778511047363, "max_q": 13.961610794067383, "min_q": 13.17936897277832}, "td_error": [0.8306436538696289, 1.316269874572754, 0.6660137176513672, 0.6350955963134766, 2.2781076431274414, 1.8941059112548828, 1.2560639381408691, 2.7857370376586914, 0.4186735153198242, 1.169097900390625, 2.7989940643310547, 1.767836093902588, 1.9653005599975586, 0.58209228515625, 0.9115710258483887, 0.3031482696533203, 0.49707984924316406, 1.1380105018615723, 1.1881628036499023, 1.182906150817871, 1.754225730895996, 0.9921755790710449, 0.5919089317321777, 3.830867290496826, 2.957458019256592, 2.809610366821289, 0.4269380569458008, 0.22945451736450195, 2.1902623176574707, 0.9673395156860352, 2.9332900047302246, 0.6073169708251953, 0.9633378982543945, 0.7347464561462402, 1.3586835861206055, 1.0869574546813965, 0.24868392944335938, 1.1348481178283691, 0.05850791931152344, 0.20776748657226562, 1.0474987030029297, 2.3387980461120605, 1.0342459678649902, 1.3413715362548828, 2.0551915168762207, 1.568984031677246, 3.3818297386169434, 1.2451729774475098, 0.4042959213256836, 1.112701416015625, 0.9385476112365723, 1.5077199935913086, 0.1304788589477539, 0.5268874168395996, 1.6623878479003906, 1.400960922241211, 0.7478446960449219, 1.9095044136047363, 2.4692907333374023, 3.3988232612609863, 1.2854433059692383, 2.218759536743164, 0.10261154174804688, 1.6167802810668945, 0.4715709686279297, 0.7150182723999023, 2.4526920318603516, 1.3477396965026855, 0.3858332633972168, 1.1342353820800781, 1.7910280227661133, 1.0536813735961914, 1.795987606048584, 0.4902510643005371, 2.7300586700439453, 2.9933061599731445, 0.7774910926818848, 1.5000057220458984, 1.5441522598266602, 1.20442533493042, 1.721064567565918, 0.4717679023742676, 0.7376117706298828, 2.9543633460998535, 0.8634061813354492, 1.6137723922729492], "mean_td_error": 1.3705220222473145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1552.0, "diff_num_grad_updates_vs_sampler_policy": 1551.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.057180404663086, "actor_loss": -16.406047821044922, "critic_loss": 0.12251269817352295, "alpha_loss": -4.682189464569092, "alpha_value": 0.6277854442596436, "log_alpha_value": -0.4655568599700928, "target_entropy": -6.0, "policy_t": 0.013624181970953941, "mean_q": 13.91141414642334, "max_q": 14.27353286743164, "min_q": 13.569416046142578}, "td_error": [0.9282999038696289, 0.13640403747558594, 1.5338935852050781, 0.48891496658325195, 0.8098354339599609, 0.6270318031311035, 0.04794740676879883, 1.4314942359924316, 1.4417753219604492, 1.1113271713256836, 2.461820602416992, 1.574467658996582, 0.8235445022583008, 0.39342737197875977, 0.5619597434997559, 0.3369302749633789, 0.21190595626831055, 1.7614765167236328, 0.5809965133666992, 2.1386728286743164, 0.4621238708496094, 0.6646504402160645, 0.8624696731567383, 0.6818814277648926, 0.8304376602172852, 1.8726143836975098, 1.8133468627929688, 0.5120325088500977, 0.7634329795837402, 1.2810344696044922, 2.035114288330078, 1.6219701766967773, 1.1792659759521484, 1.5950603485107422, 3.811972141265869, 1.3184428215026855, 0.0638723373413086, 0.27904605865478516, 1.661820411682129, 1.1683402061462402, 0.8698959350585938, 1.965151309967041, 0.32451343536376953, 1.970015048980713, 0.397367000579834, 0.0802907943725586, 0.21276283264160156, 1.4326868057250977, 1.3137798309326172, 0.6426558494567871, 0.5877022743225098, 0.4039926528930664, 1.5695304870605469, 1.2673139572143555, 0.4017815589904785, 0.526759147644043, 1.1348605155944824, 0.8293590545654297, 1.3862924575805664, 1.5812005996704102, 1.8779678344726562, 0.40782642364501953, 0.8952984809875488, 1.1386079788208008, 0.9235010147094727, 0.9072685241699219, 0.724952220916748, 2.437556266784668, 1.3190975189208984, 1.391186237335205, 0.03720808029174805, 0.040386199951171875, 0.7260661125183105, 0.8892526626586914, 1.2308220863342285, 0.6388416290283203, 1.6903929710388184, 0.6006426811218262, 1.4133939743041992, 0.5383014678955078, 0.4445042610168457, 1.0669703483581543, 1.1696767807006836, 0.6323800086975098, 0.6523647308349609, 0.7790484428405762], "mean_td_error": 1.0157264471054077, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1552.0, "diff_num_grad_updates_vs_sampler_policy": 1551.0}}, "num_env_steps_sampled": 12362, "num_env_steps_trained": 400416, "num_agent_steps_sampled": 37086, "num_agent_steps_trained": 400416, "last_target_update_ts": 12362, "num_target_updates": 1552}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37086, "num_agent_steps_trained": 400416, "num_env_steps_sampled": 12362, "num_env_steps_trained": 400416, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.79409460271489, "num_env_steps_trained_throughput_per_sec": 2461.8394867857774, "timesteps_total": 12362, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 37086, "timers": {"training_iteration_time_ms": 105.586, "sample_time_ms": 16.88, "load_time_ms": 0.316, "load_throughput": 816763.855, "learn_time_ms": 18.313, "learn_throughput": 14088.185, "synch_weights_time_ms": 9.912}, "counters": {"num_env_steps_sampled": 12362, "num_env_steps_trained": 400416, "num_agent_steps_sampled": 37086, "num_agent_steps_trained": 400416, "last_target_update_ts": 12362, "num_target_updates": 1552}, "done": false, "episodes_total": 0, "training_iteration": 107, "trial_id": "db258_00000", "date": "2023-11-16_21-50-57", "timestamp": 1700200257, "time_this_iter_s": 1.5825121402740479, "time_total_s": 168.41967725753784, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 168.41967725753784, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 63.150000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14330768585205, "actor_loss": -26.641237258911133, "critic_loss": 0.09243018925189972, "alpha_loss": -4.771500110626221, "alpha_value": 0.6247469782829285, "log_alpha_value": -0.4704085886478424, "target_entropy": -6.0, "policy_t": -0.010606774128973484, "mean_q": 24.0994815826416, "max_q": 24.54494285583496, "min_q": 23.467863082885742}, "td_error": [0.12337112426757812, 0.8799171447753906, 0.9792194366455078, 1.1402606964111328, 0.8483772277832031, 2.2397994995117188, 1.326643943786621, 1.1850814819335938, 0.5713586807250977, 0.2244577407836914, 1.3069381713867188, 0.6972246170043945, 1.5212383270263672, 0.6591567993164062, 0.37467479705810547, 0.11769580841064453, 3.0419607162475586, 0.6566123962402344, 1.4841957092285156, 0.49279212951660156, 0.8350210189819336, 0.1990489959716797, 1.4809179306030273, 0.6907577514648438, 0.8311090469360352, 0.3263845443725586, 1.621896743774414, 1.4374809265136719, 0.3663663864135742, 1.855433464050293, 2.8899097442626953, 0.5867061614990234, 0.6625804901123047, 1.521296501159668, 0.6278533935546875, 0.8244400024414062, 0.6657791137695312, 0.809565544128418, 1.2633047103881836, 0.07902145385742188, 0.807525634765625, 0.6972198486328125, 1.1517562866210938, 1.621438980102539, 2.63714599609375, 1.4522361755371094, 0.39624786376953125, 1.1715316772460938, 2.5689077377319336, 1.3548316955566406, 2.1433658599853516, 2.0767574310302734, 0.10129261016845703, 2.367340087890625, 1.923884391784668, 0.18309879302978516, 1.3053302764892578, 0.24303340911865234, 0.2687406539916992, 1.399641990661621, 1.978750228881836, 0.5280065536499023, 2.3434619903564453, 0.2733650207519531, 0.29142093658447266, 0.4966154098510742, 0.9060878753662109, 0.9549617767333984, 1.1502256393432617, 0.21497249603271484, 2.157158851623535, 0.052753448486328125, 0.34294795989990234, 0.604609489440918, 0.6451873779296875, 1.879683494567871, 1.856729507446289, 0.7993335723876953, 1.5866069793701172, 0.2516050338745117, 2.133329391479492, 0.6844120025634766, 0.387603759765625, 0.25273895263671875, 0.8536605834960938, 0.9852752685546875], "mean_td_error": 1.0456823110580444, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1567.0, "diff_num_grad_updates_vs_sampler_policy": 1566.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.025163650512695, "actor_loss": -16.38287925720215, "critic_loss": 0.11676101386547089, "alpha_loss": -4.712893962860107, "alpha_value": 0.6249357461929321, "log_alpha_value": -0.47010642290115356, "target_entropy": -6.0, "policy_t": 0.009774901904165745, "mean_q": 13.900588035583496, "max_q": 14.266691207885742, "min_q": 13.514167785644531}, "td_error": [0.8918070793151855, 1.2236042022705078, 0.4835796356201172, 1.335219383239746, 0.9872102737426758, 0.6951751708984375, 0.4016447067260742, 0.6556520462036133, 0.5817451477050781, 0.8303680419921875, 1.3929405212402344, 1.4123659133911133, 1.3079423904418945, 0.7537860870361328, 0.4090147018432617, 1.107740879058838, 1.1640996932983398, 0.6721310615539551, 1.2743864059448242, 2.818504810333252, 2.653618335723877, 1.7321629524230957, 1.4764375686645508, 0.6457529067993164, 1.9126315116882324, 0.18987655639648438, 1.0116510391235352, 0.7299666404724121, 1.4644970893859863, 0.8322434425354004, 1.7901229858398438, 0.1648731231689453, 0.3412151336669922, 0.6788473129272461, 0.7816863059997559, 2.173546314239502, 3.3569517135620117, 1.1464061737060547, 2.5965042114257812, 2.444765567779541, 2.234963893890381, 0.7022237777709961, 1.1019768714904785, 1.6612129211425781, 0.42345619201660156, 1.2224998474121094, 1.9656438827514648, 1.2560782432556152, 1.8387632369995117, 2.831040382385254, 1.8701210021972656, 0.36042356491088867, 0.6471757888793945, 0.6283078193664551, 0.9822168350219727, 0.4749436378479004, 1.899521827697754, 1.9915485382080078, 0.47793149948120117, 0.684575080871582, 1.9453716278076172, 0.9749531745910645, 0.8976407051086426, 0.10973167419433594, 1.410712718963623, 0.5652217864990234, 1.6052327156066895, 1.0008478164672852, 1.0817999839782715, 0.0979461669921875, 1.1811332702636719, 1.4027070999145508, 1.966540813446045, 1.056447982788086, 0.4505648612976074, 1.2738409042358398, 1.9358329772949219, 0.5022592544555664, 0.7940988540649414, 1.653951644897461, 0.3410816192626953, 0.44444894790649414, 0.6700439453125, 0.33273744583129883, 2.363487720489502, 1.517533302307129], "mean_td_error": 1.1785286664962769, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1567.0, "diff_num_grad_updates_vs_sampler_policy": 1566.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.145589828491211, "actor_loss": -16.679027557373047, "critic_loss": 0.14489036798477173, "alpha_loss": -4.769046783447266, "alpha_value": 0.6249640583992004, "log_alpha_value": -0.4700610935688019, "target_entropy": -6.0, "policy_t": 0.01621258445084095, "mean_q": 14.140499114990234, "max_q": 14.466253280639648, "min_q": 13.871871948242188}, "td_error": [0.7834057807922363, 1.0450854301452637, 0.6425628662109375, 0.837552547454834, 1.158698558807373, 1.049600601196289, 2.0897998809814453, 0.9503183364868164, 0.5739955902099609, 1.8794307708740234, 2.1862521171569824, 1.4197397232055664, 1.4612517356872559, 1.5924358367919922, 0.3631887435913086, 0.11004161834716797, 0.7317428588867188, 0.28912353515625, 0.45488691329956055, 0.4471416473388672, 1.1625609397888184, 1.5067229270935059, 1.7758598327636719, 2.5683674812316895, 2.0712037086486816, 0.7249526977539062, 0.2462143898010254, 0.4657773971557617, 0.6958918571472168, 0.5576682090759277, 0.45671796798706055, 1.1693778038024902, 2.8467254638671875, 0.56024169921875, 0.23943424224853516, 2.6048269271850586, 1.0925993919372559, 1.4388866424560547, 0.7350883483886719, 1.6421442031860352, 2.091346263885498, 0.15949440002441406, 1.9595184326171875, 2.207913398742676, 1.514913558959961, 0.3577899932861328, 2.352828025817871, 2.097571849822998, 0.24267196655273438, 0.038787841796875, 0.9011316299438477, 1.7339959144592285, 0.5443315505981445, 0.6404232978820801, 1.277646541595459, 1.362877368927002, 1.4527082443237305, 0.554619312286377, 0.392331600189209, 1.20361328125, 1.3034343719482422, 0.4448127746582031, 1.2770657539367676, 1.8645281791687012, 1.2878518104553223, 0.7701358795166016, 0.982020378112793, 1.6142396926879883, 1.3670883178710938, 1.834155559539795, 0.49695730209350586, 1.7864012718200684, 1.4622578620910645, 0.36406707763671875, 1.1678152084350586, 0.2180027961730957, 1.5383453369140625, 1.8856158256530762, 1.099604606628418, 1.058645248413086, 0.4916853904724121, 1.1297707557678223, 1.8707685470581055, 1.3868346214294434, 0.5462565422058105, 0.49720048904418945], "mean_td_error": 1.1332510709762573, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1567.0, "diff_num_grad_updates_vs_sampler_policy": 1566.0}}, "num_env_steps_sampled": 12467, "num_env_steps_trained": 404286, "num_agent_steps_sampled": 37401, "num_agent_steps_trained": 404286, "last_target_update_ts": 12467, "num_target_updates": 1567}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37401, "num_agent_steps_trained": 404286, "num_env_steps_sampled": 12467, "num_env_steps_trained": 404286, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 65.34316958392577, "num_env_steps_trained_throughput_per_sec": 2408.362536093264, "timesteps_total": 12467, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 37401, "timers": {"training_iteration_time_ms": 108.042, "sample_time_ms": 18.06, "load_time_ms": 0.32, "load_throughput": 806657.05, "learn_time_ms": 18.723, "learn_throughput": 13779.94, "synch_weights_time_ms": 10.747}, "counters": {"num_env_steps_sampled": 12467, "num_env_steps_trained": 404286, "num_agent_steps_sampled": 37401, "num_agent_steps_trained": 404286, "last_target_update_ts": 12467, "num_target_updates": 1567}, "done": false, "episodes_total": 0, "training_iteration": 108, "trial_id": "db258_00000", "date": "2023-11-16_21-50-59", "timestamp": 1700200259, "time_this_iter_s": 1.6180119514465332, "time_total_s": 170.03768920898438, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e141d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 170.03768920898438, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 33.7, "ram_util_percent": 63.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093223571777344, "actor_loss": -26.508176803588867, "critic_loss": 0.09722507745027542, "alpha_loss": -4.793478965759277, "alpha_value": 0.6219344735145569, "log_alpha_value": -0.4749205410480499, "target_entropy": -6.0, "policy_t": -0.045176226645708084, "mean_q": 23.975482940673828, "max_q": 24.39657974243164, "min_q": 23.594966888427734}, "td_error": [1.6740808486938477, 0.33859729766845703, 0.24660968780517578, 1.3301610946655273, 0.2676715850830078, 1.5695886611938477, 0.5826530456542969, 1.5518579483032227, 0.09502220153808594, 2.0870485305786133, 1.2146806716918945, 1.396651268005371, 2.0721607208251953, 1.0408439636230469, 0.7620515823364258, 0.6254749298095703, 1.0662403106689453, 1.3891735076904297, 0.6537675857543945, 1.9510345458984375, 1.609654426574707, 1.907750129699707, 0.21307086944580078, 1.8839473724365234, 1.6982202529907227, 2.371337890625, 3.7668275833129883, 0.8869256973266602, 0.1559009552001953, 0.8869438171386719, 0.35860252380371094, 1.4450492858886719, 0.23599815368652344, 0.1382427215576172, 0.6976795196533203, 1.328927993774414, 0.9693975448608398, 0.19520187377929688, 1.165130615234375, 1.0918188095092773, 1.552586555480957, 0.5626840591430664, 0.9753828048706055, 0.7954883575439453, 0.6621541976928711, 0.4432554244995117, 0.660792350769043, 1.0141582489013672, 0.4697408676147461, 1.0369815826416016, 0.17777538299560547, 0.9677648544311523, 0.03480815887451172, 0.38732337951660156, 0.770024299621582, 1.942209243774414, 0.5612564086914062, 1.2744178771972656, 1.6410284042358398, 0.16291427612304688, 1.0103759765625, 3.9063491821289062, 1.706918716430664, 2.196868896484375, 0.9343967437744141, 1.0387964248657227, 0.6049118041992188, 0.6818990707397461, 0.7864046096801758, 0.7002105712890625, 0.7025318145751953, 0.09952354431152344, 0.844334602355957, 2.702073097229004, 2.1893625259399414, 0.26881980895996094, 0.6599493026733398, 0.9004859924316406, 0.97210693359375, 0.9196634292602539, 1.008392333984375, 0.7909774780273438, 1.553513526916504, 1.9651899337768555, 1.9266719818115234, 0.5665855407714844], "mean_td_error": 1.0773494243621826, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1582.0, "diff_num_grad_updates_vs_sampler_policy": 1581.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.05237102508545, "actor_loss": -16.49538230895996, "critic_loss": 0.11028511822223663, "alpha_loss": -4.770883560180664, "alpha_value": 0.6221321225166321, "log_alpha_value": -0.4746028184890747, "target_entropy": -6.0, "policy_t": -0.02595369890332222, "mean_q": 14.022037506103516, "max_q": 14.389629364013672, "min_q": 13.686966896057129}, "td_error": [1.0487847328186035, 1.1075267791748047, 0.7098731994628906, 1.07997465133667, 1.66343355178833, 0.9431729316711426, 0.3321523666381836, 1.2797584533691406, 1.8733386993408203, 1.269787311553955, 1.8116726875305176, 0.5867891311645508, 0.7494096755981445, 1.398207664489746, 1.0233864784240723, 0.09113836288452148, 2.1586523056030273, 1.117478370666504, 2.478274345397949, 2.295546531677246, 1.5810918807983398, 0.5345883369445801, 0.8452253341674805, 0.5650382041931152, 0.5849723815917969, 2.6233649253845215, 2.0076956748962402, 0.6201000213623047, 0.48241615295410156, 0.44726085662841797, 0.3136277198791504, 2.490750789642334, 0.5802545547485352, 1.213730812072754, 0.1253499984741211, 0.20384883880615234, 1.404982089996338, 0.6764359474182129, 0.5809226036071777, 1.4483046531677246, 1.0273919105529785, 0.8402342796325684, 1.057908535003662, 1.8338966369628906, 0.6388354301452637, 1.4805827140808105, 0.8570199012756348, 2.099733352661133, 1.0048956871032715, 0.4412112236022949, 0.8000473976135254, 1.275174617767334, 1.5735502243041992, 0.9982995986938477, 1.002190113067627, 0.6111016273498535, 0.08296442031860352, 0.10173225402832031, 1.3015828132629395, 0.05694866180419922, 1.3635501861572266, 0.6709318161010742, 0.5910277366638184, 2.438133716583252, 0.7052597999572754, 1.6848325729370117, 0.6215863227844238, 0.2273721694946289, 1.9192652702331543, 1.6186943054199219, 0.8545422554016113, 1.2714228630065918, 1.4136161804199219, 3.3464155197143555, 1.8067030906677246, 0.7185878753662109, 2.5956602096557617, 0.7362613677978516, 0.9383993148803711, 1.375333309173584, 0.4170041084289551, 2.1271305084228516, 1.5157127380371094, 0.9943900108337402, 0.8966050148010254, 0.07768869400024414], "mean_td_error": 1.1204620599746704, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1582.0, "diff_num_grad_updates_vs_sampler_policy": 1581.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.109719276428223, "actor_loss": -16.722471237182617, "critic_loss": 0.12479525804519653, "alpha_loss": -4.797741413116455, "alpha_value": 0.6221542358398438, "log_alpha_value": -0.4745672047138214, "target_entropy": -6.0, "policy_t": 0.05033387243747711, "mean_q": 14.2024507522583, "max_q": 14.67519760131836, "min_q": 13.834595680236816}, "td_error": [1.199239730834961, 0.3547334671020508, 0.9084677696228027, 0.48163318634033203, 0.5636897087097168, 0.5083684921264648, 1.0403308868408203, 0.21657991409301758, 0.49486351013183594, 0.478635311126709, 0.34993648529052734, 1.3901705741882324, 2.1045446395874023, 0.28977394104003906, 0.7715678215026855, 0.053342342376708984, 1.2182765007019043, 0.4970831871032715, 2.103727340698242, 1.2457818984985352, 1.8358821868896484, 1.5540719032287598, 0.8308582305908203, 1.4453473091125488, 1.022383689880371, 0.6209850311279297, 1.5243377685546875, 0.6130862236022949, 1.0322895050048828, 1.2661142349243164, 0.8801536560058594, 1.0346436500549316, 1.8051838874816895, 0.6904568672180176, 2.3385162353515625, 0.11863517761230469, 1.1840147972106934, 1.9899253845214844, 0.8048663139343262, 1.272068977355957, 2.7845029830932617, 0.2723722457885742, 2.194087028503418, 1.8400230407714844, 0.7896728515625, 1.3189849853515625, 0.39757823944091797, 0.7666869163513184, 0.9978771209716797, 1.0337929725646973, 0.18531084060668945, 1.5003137588500977, 1.4670534133911133, 0.7227625846862793, 0.5389909744262695, 0.58575439453125, 0.05989646911621094, 0.6486139297485352, 1.418980598449707, 0.5596327781677246, 0.42154741287231445, 1.4535918235778809, 1.0969510078430176, 0.34838294982910156, 0.6150603294372559, 0.6892819404602051, 1.0924620628356934, 1.7581281661987305, 1.9833526611328125, 1.511092185974121, 2.078211784362793, 0.3069753646850586, 1.56494140625, 0.5290603637695312, 0.17684364318847656, 0.8894338607788086, 0.2555718421936035, 1.6008386611938477, 1.2975401878356934, 1.6086058616638184, 2.6607866287231445, 0.09412002563476562, 1.7363357543945312, 1.0168709754943848, 0.5919513702392578, 0.39125967025756836], "mean_td_error": 1.0231006145477295, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1582.0, "diff_num_grad_updates_vs_sampler_policy": 1581.0}}, "num_env_steps_sampled": 12572, "num_env_steps_trained": 408156, "num_agent_steps_sampled": 37716, "num_agent_steps_trained": 408156, "last_target_update_ts": 12572, "num_target_updates": 1582}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37716, "num_agent_steps_trained": 408156, "num_env_steps_sampled": 12572, "num_env_steps_trained": 408156, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 65.82436360717733, "num_env_steps_trained_throughput_per_sec": 2426.0979729502506, "timesteps_total": 12572, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 37716, "timers": {"training_iteration_time_ms": 105.481, "sample_time_ms": 17.347, "load_time_ms": 0.307, "load_throughput": 839967.734, "learn_time_ms": 18.07, "learn_throughput": 14278.086, "synch_weights_time_ms": 9.475}, "counters": {"num_env_steps_sampled": 12572, "num_env_steps_trained": 408156, "num_agent_steps_sampled": 37716, "num_agent_steps_trained": 408156, "last_target_update_ts": 12572, "num_target_updates": 1582}, "done": false, "episodes_total": 0, "training_iteration": 109, "trial_id": "db258_00000", "date": "2023-11-16_21-51-00", "timestamp": 1700200260, "time_this_iter_s": 1.6051461696624756, "time_total_s": 171.64283537864685, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140e00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 171.64283537864685, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 40.45, "ram_util_percent": 62.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.117137908935547, "actor_loss": -26.64739227294922, "critic_loss": 0.09353432059288025, "alpha_loss": -4.850440502166748, "alpha_value": 0.6191373467445374, "log_alpha_value": -0.47942814230918884, "target_entropy": -6.0, "policy_t": -0.010820318944752216, "mean_q": 24.177583694458008, "max_q": 24.640079498291016, "min_q": 23.686992645263672}, "td_error": [0.967987060546875, 1.3812675476074219, 1.0444040298461914, 2.417506217956543, 0.5957841873168945, 0.8755741119384766, 1.3105897903442383, 2.1899776458740234, 2.3823118209838867, 1.2024383544921875, 0.3775949478149414, 1.8345251083374023, 0.23457813262939453, 2.1222572326660156, 0.0763845443725586, 0.4080028533935547, 0.19757556915283203, 0.12057876586914062, 0.5198507308959961, 0.10786247253417969, 0.8364639282226562, 1.5555849075317383, 0.8955841064453125, 1.109877586364746, 1.5301332473754883, 1.7296552658081055, 2.2487411499023438, 1.6846532821655273, 0.4595632553100586, 0.23504257202148438, 0.5843687057495117, 1.7156562805175781, 0.46073341369628906, 0.9287929534912109, 0.29361438751220703, 1.2779664993286133, 0.7985401153564453, 1.3896760940551758, 0.1571817398071289, 0.0934743881225586, 1.4610767364501953, 1.6707544326782227, 0.1941547393798828, 0.9337892532348633, 0.4290313720703125, 1.1234416961669922, 0.26088523864746094, 0.8968610763549805, 1.7814712524414062, 2.2613306045532227, 1.6489582061767578, 0.5238256454467773, 1.4048738479614258, 0.9084587097167969, 1.6377801895141602, 2.043285369873047, 1.464015007019043, 0.1660289764404297, 1.3309097290039062, 0.06120872497558594, 1.112060546875, 1.2707805633544922, 1.6766395568847656, 1.2761955261230469, 1.1048307418823242, 0.31549072265625, 0.4087991714477539, 1.6687088012695312, 0.19608402252197266, 1.1489992141723633, 0.2869138717651367, 0.6998786926269531, 1.4587125778198242, 1.3499202728271484, 1.8390178680419922, 0.05672454833984375, 2.2547779083251953, 2.2524642944335938, 0.08796024322509766, 0.14223480224609375, 0.7849264144897461, 0.7110137939453125, 0.4290924072265625, 0.5210838317871094, 1.9695549011230469, 0.10907649993896484], "mean_td_error": 1.019609808921814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1597.0, "diff_num_grad_updates_vs_sampler_policy": 1596.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1644926071167, "actor_loss": -16.511274337768555, "critic_loss": 0.09361030906438828, "alpha_loss": -4.869808197021484, "alpha_value": 0.6193405389785767, "log_alpha_value": -0.47909998893737793, "target_entropy": -6.0, "policy_t": -0.0013370300875976682, "mean_q": 13.97329330444336, "max_q": 14.352622032165527, "min_q": 13.623981475830078}, "td_error": [0.3427858352661133, 0.03690195083618164, 1.1575326919555664, 0.47156381607055664, 0.7798495292663574, 1.3138360977172852, 0.8222088813781738, 1.1758909225463867, 1.329329490661621, 0.8958439826965332, 2.227447032928467, 1.8686838150024414, 1.014493465423584, 0.14562749862670898, 0.8321046829223633, 0.5896892547607422, 0.3258543014526367, 1.4084515571594238, 0.4317178726196289, 0.9288444519042969, 1.5487327575683594, 0.2788524627685547, 0.8431506156921387, 1.8634967803955078, 0.9520540237426758, 1.3145465850830078, 2.0558714866638184, 1.0699377059936523, 0.48801088333129883, 0.42562103271484375, 1.5826034545898438, 0.8841018676757812, 0.5539536476135254, 0.7548980712890625, 0.31172990798950195, 0.4039182662963867, 1.4424552917480469, 0.05583524703979492, 0.5931429862976074, 1.1339635848999023, 1.0938658714294434, 1.8287129402160645, 0.5972867012023926, 0.2191152572631836, 0.2325730323791504, 0.39847278594970703, 1.902374267578125, 1.2992939949035645, 1.0313148498535156, 1.0372357368469238, 0.9697299003601074, 1.1851749420166016, 1.0718588829040527, 0.5387134552001953, 1.9728145599365234, 1.7044682502746582, 0.6840791702270508, 0.4075288772583008, 0.7662386894226074, 0.5637102127075195, 0.4576740264892578, 1.7906041145324707, 1.3483877182006836, 1.22552490234375, 0.3273582458496094, 0.8397216796875, 2.608185291290283, 0.8157529830932617, 1.1959476470947266, 2.392374038696289, 0.5834035873413086, 0.32584667205810547, 1.709218978881836, 0.7769012451171875, 0.7339396476745605, 1.4646406173706055, 0.5560359954833984, 0.8012533187866211, 1.1056957244873047, 0.25589561462402344, 2.5374183654785156, 0.9282627105712891, 0.5513219833374023, 1.06107759475708, 1.957564353942871, 0.933845043182373], "mean_td_error": 0.9935343265533447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1597.0, "diff_num_grad_updates_vs_sampler_policy": 1596.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.108987808227539, "actor_loss": -16.68103790283203, "critic_loss": 0.13644742965698242, "alpha_loss": -4.842895984649658, "alpha_value": 0.6193601489067078, "log_alpha_value": -0.4790683388710022, "target_entropy": -6.0, "policy_t": -0.031688909977674484, "mean_q": 14.141919136047363, "max_q": 14.590178489685059, "min_q": 13.747444152832031}, "td_error": [0.03794670104980469, 1.333571434020996, 0.9165048599243164, 1.2327027320861816, 2.323648452758789, 2.2780656814575195, 2.033262252807617, 0.5056672096252441, 3.3043665885925293, 0.8816156387329102, 1.758781909942627, 1.5401477813720703, 1.6227221488952637, 1.7199101448059082, 1.546104907989502, 0.7744636535644531, 0.9588565826416016, 0.9372682571411133, 0.6104941368103027, 0.1751546859741211, 0.40740966796875, 0.37459278106689453, 1.244213581085205, 0.9588451385498047, 0.8040847778320312, 0.9026150703430176, 1.0307769775390625, 0.06585359573364258, 0.8869757652282715, 0.17638301849365234, 1.4470291137695312, 1.5812110900878906, 1.4437651634216309, 2.481499195098877, 1.6758079528808594, 0.10350322723388672, 0.9192633628845215, 1.186129093170166, 0.5981478691101074, 0.6094284057617188, 0.6615567207336426, 1.41078519821167, 0.45995187759399414, 1.561018466949463, 0.7599039077758789, 0.062355995178222656, 0.9357032775878906, 1.4678773880004883, 1.0551576614379883, 1.0306072235107422, 2.1268911361694336, 1.065164566040039, 1.0352106094360352, 0.5436930656433105, 0.7522335052490234, 0.4969005584716797, 0.6967854499816895, 0.7130641937255859, 2.200031280517578, 1.170882225036621, 0.8844723701477051, 0.553016185760498, 1.3951683044433594, 1.636101245880127, 0.9341473579406738, 1.479264736175537, 1.5732369422912598, 1.916670799255371, 1.425400733947754, 0.8703293800354004, 0.2637948989868164, 2.6253066062927246, 0.1122140884399414, 0.38010215759277344, 0.9016122817993164, 0.7344141006469727, 0.34191226959228516, 1.759000301361084, 2.408818244934082, 1.2366013526916504, 0.5031065940856934, 1.3326358795166016, 0.23529529571533203, 0.46196937561035156, 1.8411626815795898, 0.15236949920654297], "mean_td_error": 1.0878218412399292, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1597.0, "diff_num_grad_updates_vs_sampler_policy": 1596.0}}, "num_env_steps_sampled": 12677, "num_env_steps_trained": 412026, "num_agent_steps_sampled": 38031, "num_agent_steps_trained": 412026, "last_target_update_ts": 12677, "num_target_updates": 1597}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38031, "num_agent_steps_trained": 412026, "num_env_steps_sampled": 12677, "num_env_steps_trained": 412026, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.11937809076987, "num_env_steps_trained_throughput_per_sec": 2473.82850677409, "timesteps_total": 12677, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 38031, "timers": {"training_iteration_time_ms": 105.266, "sample_time_ms": 15.085, "load_time_ms": 0.312, "load_throughput": 827759.835, "learn_time_ms": 17.856, "learn_throughput": 14449.251, "synch_weights_time_ms": 12.022}, "counters": {"num_env_steps_sampled": 12677, "num_env_steps_trained": 412026, "num_agent_steps_sampled": 38031, "num_agent_steps_trained": 412026, "last_target_update_ts": 12677, "num_target_updates": 1597}, "done": false, "episodes_total": 0, "training_iteration": 110, "trial_id": "db258_00000", "date": "2023-11-16_21-51-02", "timestamp": 1700200262, "time_this_iter_s": 1.5733850002288818, "time_total_s": 173.21622037887573, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e142340>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 173.21622037887573, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 31.333333333333332, "ram_util_percent": 62.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.100179672241211, "actor_loss": -27.225034713745117, "critic_loss": 0.10611087083816528, "alpha_loss": -4.887855052947998, "alpha_value": 0.6163517832756042, "log_alpha_value": -0.48393744230270386, "target_entropy": -6.0, "policy_t": 0.0152701735496521, "mean_q": 24.742494583129883, "max_q": 25.194438934326172, "min_q": 24.289047241210938}, "td_error": [2.113157272338867, 0.9541234970092773, 1.1687355041503906, 0.6567459106445312, 0.47823238372802734, 1.5881919860839844, 1.119894027709961, 0.09779548645019531, 1.1831531524658203, 1.6546268463134766, 0.4189291000366211, 1.5244770050048828, 0.3593320846557617, 0.8751287460327148, 0.6497049331665039, 0.7363290786743164, 1.4680871963500977, 0.2616119384765625, 0.34741878509521484, 1.5346450805664062, 0.6564435958862305, 0.6420774459838867, 0.5672855377197266, 0.7860527038574219, 0.9128093719482422, 2.041720390319824, 0.8362112045288086, 1.345346450805664, 0.8463411331176758, 2.0752735137939453, 2.688648223876953, 0.1330242156982422, 1.0921649932861328, 1.6173133850097656, 0.3096179962158203, 0.7138738632202148, 1.4624643325805664, 0.18215084075927734, 1.8627290725708008, 1.9523391723632812, 0.8723468780517578, 1.2352008819580078, 1.9063634872436523, 0.41948604583740234, 0.4886655807495117, 1.332066535949707, 0.8703927993774414, 1.9791631698608398, 1.2348661422729492, 0.6878585815429688, 0.23200130462646484, 1.4327592849731445, 1.6631965637207031, 0.6223506927490234, 1.6432418823242188, 1.0456523895263672, 1.7535886764526367, 2.099287986755371, 0.06713104248046875, 0.1374502182006836, 1.1851043701171875, 2.6631669998168945, 0.6740350723266602, 1.2994403839111328, 0.9213752746582031, 2.2084083557128906, 0.6090869903564453, 1.6946516036987305, 1.4015274047851562, 2.013763427734375, 1.1082448959350586, 1.841787338256836, 0.9791660308837891, 1.2092456817626953, 1.1835107803344727, 1.8255739212036133, 0.4204139709472656, 0.977203369140625, 0.27807044982910156, 1.7483768463134766, 0.9437932968139648, 0.9303693771362305, 2.8732128143310547, 1.1298866271972656, 1.5690135955810547, 2.7438459396362305], "mean_td_error": 1.1635996103286743, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1612.0, "diff_num_grad_updates_vs_sampler_policy": 1611.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.06777286529541, "actor_loss": -16.58057975769043, "critic_loss": 0.11197270452976227, "alpha_loss": -4.868810176849365, "alpha_value": 0.6165575981140137, "log_alpha_value": -0.4836035370826721, "target_entropy": -6.0, "policy_t": 0.011987744830548763, "mean_q": 14.049662590026855, "max_q": 14.503281593322754, "min_q": 13.653392791748047}, "td_error": [0.3777427673339844, 1.5283727645874023, 1.4086918830871582, 1.5722293853759766, 1.0000686645507812, 2.0887680053710938, 0.4206695556640625, 0.5702486038208008, 1.5797514915466309, 0.5184102058410645, 1.2781577110290527, 0.20986223220825195, 0.7547144889831543, 1.7668161392211914, 2.766669750213623, 0.24579143524169922, 1.0801324844360352, 1.1518621444702148, 1.3638548851013184, 0.3543729782104492, 1.0543851852416992, 0.2858743667602539, 2.4697041511535645, 1.0408658981323242, 1.7340683937072754, 0.21498394012451172, 1.5931987762451172, 0.7808737754821777, 0.848297119140625, 0.32012224197387695, 0.9279875755310059, 0.6448335647583008, 0.30181884765625, 0.7461490631103516, 0.7905287742614746, 0.665985107421875, 0.8329658508300781, 0.974663257598877, 1.2280964851379395, 1.0378174781799316, 1.3889703750610352, 0.34201622009277344, 0.08989286422729492, 1.5090875625610352, 1.5350961685180664, 0.7465615272521973, 1.9375019073486328, 0.9439382553100586, 0.8500266075134277, 3.35067081451416, 0.6304430961608887, 1.452265739440918, 0.706911563873291, 1.8318138122558594, 1.3103246688842773, 0.530949592590332, 1.3770031929016113, 1.4166526794433594, 1.1933603286743164, 1.748208999633789, 0.624173641204834, 1.3579444885253906, 2.078707695007324, 1.242344856262207, 2.2275238037109375, 0.5800743103027344, 0.14832305908203125, 0.16869831085205078, 0.9210062026977539, 0.2444453239440918, 1.5835185050964355, 0.17096424102783203, 1.0651435852050781, 1.3819913864135742, 1.4385113716125488, 2.434358596801758, 1.722346305847168, 1.3825187683105469, 1.3355259895324707, 1.4028444290161133, 0.47729921340942383, 1.1960992813110352, 1.4958882331848145, 1.6514310836791992, 0.19836711883544922, 1.5802249908447266], "mean_td_error": 1.1108416318893433, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1612.0, "diff_num_grad_updates_vs_sampler_policy": 1611.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.03670597076416, "actor_loss": -16.670129776000977, "critic_loss": 0.13231149315834045, "alpha_loss": -4.853439807891846, "alpha_value": 0.6165788769721985, "log_alpha_value": -0.48356902599334717, "target_entropy": -6.0, "policy_t": 0.037688229233026505, "mean_q": 14.216474533081055, "max_q": 14.56747055053711, "min_q": 13.963529586791992}, "td_error": [0.5467476844787598, 1.692643642425537, 0.4565243721008301, 2.2001566886901855, 0.5497937202453613, 0.6583809852600098, 1.7909483909606934, 1.770899772644043, 1.0870904922485352, 0.5827369689941406, 2.293309211730957, 0.5986084938049316, 0.13442516326904297, 0.18253850936889648, 0.7526435852050781, 2.027334690093994, 0.6234817504882812, 0.36317968368530273, 1.0177092552185059, 1.733922004699707, 0.19611740112304688, 2.1302571296691895, 0.8656845092773438, 0.6430606842041016, 0.7298183441162109, 0.7545156478881836, 1.3519024848937988, 1.6840529441833496, 2.457317352294922, 0.8014087677001953, 0.9610605239868164, 0.17062664031982422, 0.4622063636779785, 1.3043789863586426, 1.05928373336792, 2.3320627212524414, 0.6386780738830566, 1.3445501327514648, 0.6194553375244141, 0.8772454261779785, 0.17967939376831055, 1.4677128791809082, 0.548466682434082, 0.18452739715576172, 1.2281556129455566, 1.5704336166381836, 0.3071432113647461, 1.5205073356628418, 1.4074573516845703, 0.7425413131713867, 0.8495440483093262, 1.197394847869873, 0.6110997200012207, 0.26089954376220703, 0.4811835289001465, 1.668074131011963, 2.092921733856201, 0.718876838684082, 0.6810646057128906, 0.5209794044494629, 0.4692878723144531, 0.15166854858398438, 1.1917228698730469, 1.4768600463867188, 1.0819392204284668, 2.3457932472229004, 1.5861601829528809, 1.0397768020629883, 0.508906364440918, 2.0306825637817383, 0.518280029296875, 2.701174259185791, 0.7368741035461426, 0.3589448928833008, 2.441715717315674, 1.2849879264831543, 1.2632842063903809, 1.056717872619629, 2.702634334564209, 1.0451040267944336, 0.6640396118164062, 0.8489437103271484, 0.12023544311523438, 0.9266633987426758, 0.8283500671386719, 1.2484941482543945], "mean_td_error": 1.0617984533309937, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1612.0, "diff_num_grad_updates_vs_sampler_policy": 1611.0}}, "num_env_steps_sampled": 12782, "num_env_steps_trained": 415896, "num_agent_steps_sampled": 38346, "num_agent_steps_trained": 415896, "last_target_update_ts": 12782, "num_target_updates": 1612}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38346, "num_agent_steps_trained": 415896, "num_env_steps_sampled": 12782, "num_env_steps_trained": 415896, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.18547335575178, "num_env_steps_trained_throughput_per_sec": 2476.2645893977087, "timesteps_total": 12782, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 38346, "timers": {"training_iteration_time_ms": 104.528, "sample_time_ms": 15.75, "load_time_ms": 0.316, "load_throughput": 815778.69, "learn_time_ms": 18.232, "learn_throughput": 14150.731, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 12782, "num_env_steps_trained": 415896, "num_agent_steps_sampled": 38346, "num_agent_steps_trained": 415896, "last_target_update_ts": 12782, "num_target_updates": 1612}, "done": false, "episodes_total": 0, "training_iteration": 111, "trial_id": "db258_00000", "date": "2023-11-16_21-51-04", "timestamp": 1700200264, "time_this_iter_s": 1.5720000267028809, "time_total_s": 174.7882204055786, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e142ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 174.7882204055786, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 31.15, "ram_util_percent": 62.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084991455078125, "actor_loss": -27.163225173950195, "critic_loss": 0.09286138415336609, "alpha_loss": -4.925987243652344, "alpha_value": 0.6135783195495605, "log_alpha_value": -0.4884473383426666, "target_entropy": -6.0, "policy_t": -0.006970011163502932, "mean_q": 24.7362003326416, "max_q": 25.230125427246094, "min_q": 24.316558837890625}, "td_error": [1.4097881317138672, 0.6763143539428711, 0.4488506317138672, 0.9982624053955078, 1.3603878021240234, 0.6673040390014648, 1.0260963439941406, 0.5198793411254883, 1.7756891250610352, 1.7073593139648438, 0.553950309753418, 0.5620574951171875, 0.9174594879150391, 0.1821308135986328, 0.3582601547241211, 1.7700843811035156, 0.9027318954467773, 0.8656291961669922, 0.07047843933105469, 0.3928985595703125, 0.20806503295898438, 1.2064523696899414, 1.3620319366455078, 1.5521316528320312, 0.035308837890625, 0.6868820190429688, 0.41437435150146484, 1.0662612915039062, 0.36220645904541016, 0.12343120574951172, 2.712613105773926, 1.0367212295532227, 1.1158056259155273, 0.5460739135742188, 0.6268310546875, 0.13605022430419922, 1.8649635314941406, 1.9562044143676758, 1.0196619033813477, 2.557284355163574, 0.4318962097167969, 0.9190921783447266, 0.4397621154785156, 0.34865283966064453, 0.9654245376586914, 2.0970935821533203, 0.39541053771972656, 2.130892753601074, 0.0984792709350586, 0.1638040542602539, 1.1556472778320312, 1.3654050827026367, 0.4407663345336914, 0.8045549392700195, 0.8768224716186523, 0.5252161026000977, 1.4824905395507812, 1.1424636840820312, 0.5397100448608398, 1.1006689071655273, 1.0042667388916016, 0.4266395568847656, 1.6264638900756836, 0.6566867828369141, 0.27295875549316406, 1.4711151123046875, 2.705807685852051, 0.5729856491088867, 2.5512542724609375, 1.4711523056030273, 1.637136459350586, 1.3173484802246094, 1.2614212036132812, 1.8426332473754883, 0.9149599075317383, 1.409219741821289, 1.6353282928466797, 1.060262680053711, 1.2941055297851562, 1.6892738342285156, 1.0079679489135742, 2.93424129486084, 0.6818914413452148, 2.0346899032592773, 1.089071273803711, 0.44972896575927734], "mean_td_error": 1.0488120317459106, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1627.0, "diff_num_grad_updates_vs_sampler_policy": 1626.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126928329467773, "actor_loss": -16.522979736328125, "critic_loss": 0.1088104248046875, "alpha_loss": -4.943009853363037, "alpha_value": 0.6137880682945251, "log_alpha_value": -0.48810556530952454, "target_entropy": -6.0, "policy_t": -0.04228443279862404, "mean_q": 14.014781951904297, "max_q": 14.446924209594727, "min_q": 13.697361946105957}, "td_error": [0.3455619812011719, 1.681375503540039, 0.5145363807678223, 0.31379032135009766, 1.5013713836669922, 0.7286906242370605, 0.4615607261657715, 0.0650033950805664, 1.6693220138549805, 0.5705885887145996, 1.589005470275879, 0.5010509490966797, 0.3392467498779297, 1.4647321701049805, 0.7410087585449219, 0.42102670669555664, 2.386702060699463, 0.6298294067382812, 2.27506160736084, 0.9648103713989258, 1.7508635520935059, 1.502673625946045, 1.565938949584961, 0.8035998344421387, 1.4401535987854004, 1.4148459434509277, 2.1620655059814453, 1.1390376091003418, 0.6391406059265137, 1.7821259498596191, 0.7739648818969727, 0.12644624710083008, 0.7486038208007812, 0.4982776641845703, 1.544379711151123, 1.0973248481750488, 0.7827663421630859, 0.08980131149291992, 2.429764747619629, 0.9463934898376465, 0.0828089714050293, 1.2338056564331055, 1.6100349426269531, 1.59788179397583, 1.482492446899414, 0.29680299758911133, 0.7823562622070312, 2.0382590293884277, 1.687138557434082, 1.7492637634277344, 0.4724884033203125, 0.08565616607666016, 1.5088472366333008, 1.699188232421875, 0.37657880783081055, 1.7725028991699219, 0.6758890151977539, 0.1433882713317871, 1.5934514999389648, 0.8994531631469727, 2.0204010009765625, 0.5167055130004883, 0.9216213226318359, 0.9827060699462891, 0.039895057678222656, 0.7636570930480957, 1.6908140182495117, 2.3358817100524902, 0.459658145904541, 1.8076629638671875, 1.144864559173584, 1.0424842834472656, 1.9076757431030273, 1.7172203063964844, 0.7224798202514648, 1.1023731231689453, 0.7776813507080078, 0.6166906356811523, 1.2062888145446777, 2.143874168395996, 1.6475815773010254, 0.6490974426269531, 0.9134206771850586, 1.0040168762207031, 0.7244691848754883, 1.4330863952636719], "mean_td_error": 1.098639965057373, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1627.0, "diff_num_grad_updates_vs_sampler_policy": 1626.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.112814903259277, "actor_loss": -16.71247673034668, "critic_loss": 0.1369924247264862, "alpha_loss": -4.935781955718994, "alpha_value": 0.6138085722923279, "log_alpha_value": -0.48807212710380554, "target_entropy": -6.0, "policy_t": 0.04904979467391968, "mean_q": 14.202947616577148, "max_q": 14.456418991088867, "min_q": 13.823240280151367}, "td_error": [0.9790592193603516, 1.1028227806091309, 0.852747917175293, 1.6754426956176758, 0.037367820739746094, 0.1900014877319336, 2.080716133117676, 1.0181078910827637, 3.135754108428955, 0.31350040435791016, 1.2928991317749023, 1.6109304428100586, 0.7699823379516602, 0.5062541961669922, 1.0722761154174805, 0.39384031295776367, 1.2243118286132812, 0.3277111053466797, 0.8781895637512207, 3.247288703918457, 0.23076486587524414, 1.3463020324707031, 1.05442476272583, 2.1301870346069336, 0.6538534164428711, 0.8551187515258789, 2.0879621505737305, 0.5826845169067383, 1.5084800720214844, 1.3259077072143555, 2.522469997406006, 1.1372718811035156, 0.9229178428649902, 1.0073919296264648, 0.30944299697875977, 0.4492807388305664, 0.7582492828369141, 2.5223989486694336, 1.6597795486450195, 1.9011011123657227, 1.103440761566162, 1.9844369888305664, 0.7924814224243164, 1.6319513320922852, 0.9017653465270996, 0.2191929817199707, 1.0479998588562012, 1.143435001373291, 0.07005834579467773, 1.9430723190307617, 0.5239481925964355, 1.8167543411254883, 0.42462968826293945, 1.2820196151733398, 0.8594279289245605, 1.5198040008544922, 1.1161723136901855, 1.1767873764038086, 1.0515379905700684, 1.306748390197754, 0.47359132766723633, 0.5079026222229004, 1.5169925689697266, 1.6762142181396484, 0.35372114181518555, 0.5085415840148926, 0.3599729537963867, 0.5370783805847168, 1.0314388275146484, 1.5465898513793945, 1.041384220123291, 0.15720224380493164, 0.9167070388793945, 0.48285436630249023, 1.9087419509887695, 1.7144594192504883, 0.38508033752441406, 1.5633888244628906, 0.20559406280517578, 0.831965446472168, 2.554898262023926, 1.060957431793213, 0.7438473701477051, 1.7796859741210938, 0.26394081115722656, 1.1967058181762695], "mean_td_error": 1.1036083698272705, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1627.0, "diff_num_grad_updates_vs_sampler_policy": 1626.0}}, "num_env_steps_sampled": 12887, "num_env_steps_trained": 419766, "num_agent_steps_sampled": 38661, "num_agent_steps_trained": 419766, "last_target_update_ts": 12887, "num_target_updates": 1627}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38661, "num_agent_steps_trained": 419766, "num_env_steps_sampled": 12887, "num_env_steps_trained": 419766, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.84488654025489, "num_env_steps_trained_throughput_per_sec": 2463.7115324836805, "timesteps_total": 12887, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 38661, "timers": {"training_iteration_time_ms": 104.905, "sample_time_ms": 16.565, "load_time_ms": 0.305, "load_throughput": 845678.675, "learn_time_ms": 17.961, "learn_throughput": 14364.57, "synch_weights_time_ms": 10.078}, "counters": {"num_env_steps_sampled": 12887, "num_env_steps_trained": 419766, "num_agent_steps_sampled": 38661, "num_agent_steps_trained": 419766, "last_target_update_ts": 12887, "num_target_updates": 1627}, "done": false, "episodes_total": 0, "training_iteration": 112, "trial_id": "db258_00000", "date": "2023-11-16_21-51-05", "timestamp": 1700200265, "time_this_iter_s": 1.580078125, "time_total_s": 176.3682985305786, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0637e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 176.3682985305786, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 30.35, "ram_util_percent": 62.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.047576904296875, "actor_loss": -26.874942779541016, "critic_loss": 0.09457357227802277, "alpha_loss": -4.953010559082031, "alpha_value": 0.6108183264732361, "log_alpha_value": -0.49295574426651, "target_entropy": -6.0, "policy_t": 0.038928281515836716, "mean_q": 24.480300903320312, "max_q": 24.999088287353516, "min_q": 24.032262802124023}, "td_error": [0.8689470291137695, 0.3397798538208008, 0.4851398468017578, 1.7762279510498047, 1.4952068328857422, 0.9727725982666016, 0.8802623748779297, 0.4197521209716797, 2.1462717056274414, 1.3460502624511719, 0.20360755920410156, 0.5084304809570312, 3.086543083190918, 0.34916114807128906, 1.7491645812988281, 0.05867576599121094, 2.63559627532959, 0.49735450744628906, 1.0214262008666992, 1.1538686752319336, 0.806859016418457, 1.5248241424560547, 1.9625701904296875, 0.6880292892456055, 1.160675048828125, 1.0081462860107422, 0.7419147491455078, 1.0683889389038086, 0.9312114715576172, 1.6622962951660156, 2.801449775695801, 1.0251541137695312, 1.079411506652832, 0.30756664276123047, 0.23499774932861328, 0.26186656951904297, 2.0856428146362305, 0.7663946151733398, 0.47661781311035156, 1.3132028579711914, 1.6140336990356445, 1.0640487670898438, 1.7692861557006836, 1.2431869506835938, 0.12646007537841797, 0.4649190902709961, 1.0876712799072266, 0.7846908569335938, 0.52557373046875, 1.0538749694824219, 2.0350770950317383, 2.341604232788086, 0.35327720642089844, 0.7304325103759766, 1.4231042861938477, 0.7716598510742188, 0.7945632934570312, 1.060317039489746, 0.9543170928955078, 2.0687341690063477, 1.3132123947143555, 0.4308433532714844, 1.9819984436035156, 0.7493820190429688, 0.5037174224853516, 0.6527347564697266, 0.42412662506103516, 0.7203807830810547, 0.9837913513183594, 0.5962791442871094, 1.676386833190918, 0.4237842559814453, 1.8182125091552734, 0.8329582214355469, 0.9785137176513672, 1.0008764266967773, 1.571310043334961, 0.7400169372558594, 0.5499401092529297, 1.2290210723876953, 1.0863189697265625, 0.8806352615356445, 0.2629556655883789, 1.020400047302246, 2.1363649368286133, 1.1913604736328125], "mean_td_error": 1.0688815116882324, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1642.0, "diff_num_grad_updates_vs_sampler_policy": 1641.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.081358909606934, "actor_loss": -16.289331436157227, "critic_loss": 0.11085616797208786, "alpha_loss": -4.966163635253906, "alpha_value": 0.6110303997993469, "log_alpha_value": -0.49260860681533813, "target_entropy": -6.0, "policy_t": -0.016246112063527107, "mean_q": 13.804940223693848, "max_q": 14.24174976348877, "min_q": 13.403253555297852}, "td_error": [0.9585685729980469, 1.9240455627441406, 1.0086479187011719, 0.5937671661376953, 1.5858945846557617, 1.120009422302246, 1.6042699813842773, 1.459867000579834, 1.132768154144287, 1.6158528327941895, 0.8091135025024414, 3.021979331970215, 0.8089637756347656, 0.825495719909668, 0.33617210388183594, 0.6476926803588867, 0.7998895645141602, 0.29834604263305664, 1.4475698471069336, 1.4076900482177734, 1.6405839920043945, 2.9553489685058594, 0.8652787208557129, 2.0575976371765137, 1.442824363708496, 0.07857513427734375, 1.0785341262817383, 1.543856143951416, 1.850287914276123, 1.0026445388793945, 1.2758636474609375, 0.10975456237792969, 2.358501434326172, 1.1922974586486816, 0.8831110000610352, 0.3506336212158203, 0.20389509201049805, 0.4359111785888672, 1.5961933135986328, 0.987091064453125, 0.12076187133789062, 1.2281761169433594, 1.0364484786987305, 1.5424799919128418, 0.9487109184265137, 1.4807767868041992, 0.4155611991882324, 0.7904949188232422, 0.035616397857666016, 0.15813684463500977, 1.0120434761047363, 1.2926645278930664, 1.601874828338623, 0.308258056640625, 2.244872570037842, 2.519136905670166, 1.9809961318969727, 0.5837163925170898, 1.398195743560791, 1.7168192863464355, 0.2939605712890625, 0.737358570098877, 1.6071162223815918, 2.1579713821411133, 0.7956304550170898, 0.611299991607666, 0.5808887481689453, 0.4170999526977539, 0.15462684631347656, 1.8701138496398926, 1.4279217720031738, 1.6299691200256348, 0.21958065032958984, 1.605748176574707, 0.0345306396484375, 1.386162281036377, 0.9135861396789551, 1.01069974899292, 0.057660579681396484, 2.0517592430114746, 1.2602777481079102, 0.05327796936035156, 1.731492042541504, 1.3355488777160645, 0.5761055946350098, 0.5981841087341309], "mean_td_error": 1.1029033660888672, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1642.0, "diff_num_grad_updates_vs_sampler_policy": 1641.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.066977500915527, "actor_loss": -16.751544952392578, "critic_loss": 0.14388993382453918, "alpha_loss": -4.958746433258057, "alpha_value": 0.6110506057739258, "log_alpha_value": -0.4925754964351654, "target_entropy": -6.0, "policy_t": -0.045516546815633774, "mean_q": 14.324508666992188, "max_q": 14.758271217346191, "min_q": 13.929831504821777}, "td_error": [0.37288618087768555, 1.2434906959533691, 1.132737636566162, 1.669499397277832, 2.9266715049743652, 1.086705207824707, 0.4948110580444336, 0.16859722137451172, 1.2124700546264648, 0.701591968536377, 1.3105859756469727, 0.3619976043701172, 1.4889612197875977, 0.021442890167236328, 0.32726192474365234, 2.7451086044311523, 0.578972339630127, 1.3716421127319336, 2.769199848175049, 0.023507118225097656, 0.5758333206176758, 1.353036880493164, 1.1654205322265625, 0.6873102188110352, 0.25622034072875977, 0.8603076934814453, 0.4784832000732422, 0.14334917068481445, 0.788689136505127, 0.68072509765625, 0.6886563301086426, 0.2683706283569336, 0.7964987754821777, 0.7211480140686035, 0.4559822082519531, 1.635514736175537, 1.5359077453613281, 1.6810197830200195, 0.17057180404663086, 1.345334529876709, 0.8364443778991699, 0.37845468521118164, 0.7364892959594727, 2.072564125061035, 0.29693078994750977, 2.926431655883789, 0.2804117202758789, 1.5234899520874023, 1.2486915588378906, 2.344895362854004, 0.759373664855957, 1.2890057563781738, 1.8874468803405762, 1.0715670585632324, 2.0135765075683594, 0.5393939018249512, 1.3180561065673828, 2.5216054916381836, 2.548403263092041, 1.0670194625854492, 0.6593289375305176, 1.6195745468139648, 0.9592609405517578, 0.6511240005493164, 1.3284320831298828, 1.156893253326416, 0.34093713760375977, 1.390127182006836, 0.6446390151977539, 1.148923397064209, 0.36435604095458984, 2.024141788482666, 1.6623101234436035, 2.183535099029541, 2.3299570083618164, 2.126926898956299, 0.6166200637817383, 1.278226375579834, 1.2428226470947266, 1.4607367515563965, 0.8468489646911621, 1.4700546264648438, 0.4517049789428711, 1.4489636421203613, 0.8493037223815918, 2.317416191101074], "mean_td_error": 1.145696997642517, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1642.0, "diff_num_grad_updates_vs_sampler_policy": 1641.0}}, "num_env_steps_sampled": 12992, "num_env_steps_trained": 423636, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 423636, "last_target_update_ts": 12992, "num_target_updates": 1642}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 423636, "num_env_steps_sampled": 12992, "num_env_steps_trained": 423636, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.50765550950659, "num_env_steps_trained_throughput_per_sec": 2488.139303064672, "timesteps_total": 12992, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 104.511, "sample_time_ms": 15.654, "load_time_ms": 0.311, "load_throughput": 830810.312, "learn_time_ms": 18.05, "learn_throughput": 14293.626, "synch_weights_time_ms": 10.15}, "counters": {"num_env_steps_sampled": 12992, "num_env_steps_trained": 423636, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 423636, "last_target_update_ts": 12992, "num_target_updates": 1642}, "done": false, "episodes_total": 0, "training_iteration": 113, "trial_id": "db258_00000", "date": "2023-11-16_21-51-07", "timestamp": 1700200267, "time_this_iter_s": 1.5650620460510254, "time_total_s": 177.93336057662964, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 177.93336057662964, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 30.233333333333334, "ram_util_percent": 62.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.067734718322754, "actor_loss": -27.091121673583984, "critic_loss": 0.10331034660339355, "alpha_loss": -5.008285999298096, "alpha_value": 0.6080737709999084, "log_alpha_value": -0.4974590241909027, "target_entropy": -6.0, "policy_t": -0.016160055994987488, "mean_q": 24.714540481567383, "max_q": 25.332319259643555, "min_q": 24.18236541748047}, "td_error": [0.5751523971557617, 0.9521455764770508, 0.08988189697265625, 0.6165752410888672, 0.989222526550293, 1.5733633041381836, 0.8426094055175781, 2.423203468322754, 2.00260066986084, 1.7408218383789062, 0.3375864028930664, 2.184446334838867, 2.6037254333496094, 1.069915771484375, 1.6016883850097656, 0.8054523468017578, 0.8845901489257812, 1.0040950775146484, 0.43479347229003906, 0.08103561401367188, 1.7544164657592773, 0.08553600311279297, 1.912546157836914, 0.7891864776611328, 1.0678091049194336, 1.057835578918457, 0.8934049606323242, 0.9695024490356445, 1.5062999725341797, 0.3259611129760742, 0.510523796081543, 1.3378753662109375, 0.5362672805786133, 0.9021587371826172, 1.5478687286376953, 2.586050033569336, 1.241231918334961, 1.876429557800293, 1.1650705337524414, 0.7443838119506836, 1.3579931259155273, 1.3379898071289062, 0.0752716064453125, 0.7675142288208008, 0.5873384475708008, 1.207000732421875, 1.7145633697509766, 0.350067138671875, 1.4230384826660156, 0.06760597229003906, 0.8714361190795898, 1.1338071823120117, 0.7394399642944336, 2.4912309646606445, 1.5729999542236328, 1.3875293731689453, 0.9301071166992188, 0.7589149475097656, 0.36365222930908203, 0.2567110061645508, 0.38273143768310547, 1.1906547546386719, 1.5046377182006836, 0.621190071105957, 0.6040916442871094, 2.1004276275634766, 0.41802120208740234, 1.7862892150878906, 0.9596004486083984, 0.6435317993164062, 0.3997821807861328, 1.0570039749145508, 1.2635326385498047, 2.5773983001708984, 0.8853940963745117, 2.588046073913574, 1.9841394424438477, 1.1914091110229492, 0.8036689758300781, 0.9845685958862305, 0.1934185028076172, 1.1865243911743164, 2.7382965087890625, 0.7957134246826172, 0.7425117492675781, 2.1724796295166016], "mean_td_error": 1.1254947185516357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1657.0, "diff_num_grad_updates_vs_sampler_policy": 1656.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.13269329071045, "actor_loss": -16.763654708862305, "critic_loss": 0.0927017480134964, "alpha_loss": -5.037065505981445, "alpha_value": 0.6082859635353088, "log_alpha_value": -0.4971102178096771, "target_entropy": -6.0, "policy_t": 0.0021328278817236423, "mean_q": 14.294084548950195, "max_q": 14.628167152404785, "min_q": 13.96645736694336}, "td_error": [1.6434917449951172, 1.3764543533325195, 0.7691302299499512, 0.3370819091796875, 0.04071950912475586, 0.5350341796875, 0.20771026611328125, 0.5652618408203125, 1.4036283493041992, 0.8951387405395508, 0.5579514503479004, 0.9563593864440918, 1.203618049621582, 1.5134806632995605, 0.832700252532959, 0.8106517791748047, 1.6441974639892578, 0.513211727142334, 1.8985061645507812, 0.6630902290344238, 0.10816097259521484, 2.340510845184326, 0.5044832229614258, 0.3019256591796875, 0.5125446319580078, 2.0943713188171387, 0.5699191093444824, 0.3776512145996094, 0.23338031768798828, 0.28092479705810547, 2.0710601806640625, 0.13901233673095703, 0.03867149353027344, 0.3568882942199707, 1.5703539848327637, 0.5277166366577148, 0.7899332046508789, 0.36310291290283203, 0.27353858947753906, 2.40358829498291, 1.427919864654541, 0.9820866584777832, 1.2364349365234375, 0.9830365180969238, 1.0062150955200195, 0.7092647552490234, 1.2125282287597656, 0.1490650177001953, 0.5684280395507812, 1.030036449432373, 1.6116409301757812, 1.144972324371338, 0.5383920669555664, 2.2903289794921875, 1.693678379058838, 1.4817991256713867, 0.4271883964538574, 1.0065836906433105, 1.525007724761963, 1.4439058303833008, 1.7206707000732422, 2.535641670227051, 0.40921926498413086, 1.2338924407958984, 0.7122430801391602, 1.5563898086547852, 0.27890825271606445, 0.6808123588562012, 0.06937789916992188, 1.0040440559387207, 0.4042830467224121, 0.20669841766357422, 1.7649974822998047, 1.2283611297607422, 0.6559767723083496, 1.4632391929626465, 1.394270896911621, 0.9804997444152832, 0.8557510375976562, 1.736872673034668, 0.8463802337646484, 1.1781678199768066, 1.391502857208252, 1.696619987487793, 0.918515682220459, 0.492891788482666], "mean_td_error": 0.9780220985412598, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1657.0, "diff_num_grad_updates_vs_sampler_policy": 1656.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084811210632324, "actor_loss": -16.963533401489258, "critic_loss": 0.12518025934696198, "alpha_loss": -5.012928009033203, "alpha_value": 0.6083061099052429, "log_alpha_value": -0.497077077627182, "target_entropy": -6.0, "policy_t": 0.005683887749910355, "mean_q": 14.507591247558594, "max_q": 14.83245849609375, "min_q": 14.119479179382324}, "td_error": [0.7328948974609375, 0.7318501472473145, 2.369353771209717, 1.0822324752807617, 1.9240508079528809, 1.7671175003051758, 2.0662107467651367, 1.5924649238586426, 0.17323589324951172, 0.5315732955932617, 1.1510934829711914, 0.48699474334716797, 0.2840275764465332, 0.3335542678833008, 0.2945380210876465, 1.1560659408569336, 0.10549163818359375, 0.5262861251831055, 0.9781808853149414, 0.4156813621520996, 0.6444077491760254, 0.7763848304748535, 0.4700140953063965, 1.6447629928588867, 0.8019313812255859, 1.352612018585205, 1.8073368072509766, 0.6229329109191895, 1.4300384521484375, 0.851710319519043, 0.5591411590576172, 0.38420677185058594, 2.370941638946533, 0.9747295379638672, 1.5789151191711426, 0.1386432647705078, 0.8978753089904785, 0.9914350509643555, 1.3703174591064453, 1.1304030418395996, 0.12338066101074219, 0.7960963249206543, 0.7148561477661133, 1.1809430122375488, 0.8107948303222656, 0.7811398506164551, 0.04180717468261719, 1.342752456665039, 0.656987190246582, 0.5455851554870605, 2.047610282897949, 0.9149398803710938, 0.23278427124023438, 1.9180512428283691, 2.873664379119873, 1.3639178276062012, 0.7141327857971191, 0.29059648513793945, 0.6509079933166504, 1.5924711227416992, 1.1141633987426758, 0.39428091049194336, 1.1770601272583008, 0.08870935440063477, 0.7755312919616699, 1.2016215324401855, 1.4696292877197266, 0.7238774299621582, 1.0564422607421875, 0.5856714248657227, 0.07465744018554688, 0.34555912017822266, 0.7038931846618652, 1.9271392822265625, 0.5268087387084961, 1.0465059280395508, 1.459887981414795, 2.0851778984069824, 1.0110235214233398, 2.6067147254943848, 0.8107361793518066, 2.1138248443603516, 1.2986855506896973, 1.2108936309814453, 2.1603503227233887, 0.9288430213928223], "mean_td_error": 1.0231714248657227, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1657.0, "diff_num_grad_updates_vs_sampler_policy": 1656.0}}, "num_env_steps_sampled": 13097, "num_env_steps_trained": 427506, "num_agent_steps_sampled": 39291, "num_agent_steps_trained": 427506, "last_target_update_ts": 13097, "num_target_updates": 1657}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39291, "num_agent_steps_trained": 427506, "num_env_steps_sampled": 13097, "num_env_steps_trained": 427506, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.48003762562624, "num_env_steps_trained_throughput_per_sec": 2487.1213867730817, "timesteps_total": 13097, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 39291, "timers": {"training_iteration_time_ms": 104.455, "sample_time_ms": 16.213, "load_time_ms": 0.313, "load_throughput": 824480.329, "learn_time_ms": 18.042, "learn_throughput": 14300.03, "synch_weights_time_ms": 9.459}, "counters": {"num_env_steps_sampled": 13097, "num_env_steps_trained": 427506, "num_agent_steps_sampled": 39291, "num_agent_steps_trained": 427506, "last_target_update_ts": 13097, "num_target_updates": 1657}, "done": false, "episodes_total": 0, "training_iteration": 114, "trial_id": "db258_00000", "date": "2023-11-16_21-51-08", "timestamp": 1700200268, "time_this_iter_s": 1.5653157234191895, "time_total_s": 179.49867630004883, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e1405e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 179.49867630004883, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 31.7, "ram_util_percent": 62.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.155405044555664, "actor_loss": -27.497541427612305, "critic_loss": 0.10114775598049164, "alpha_loss": -5.097639083862305, "alpha_value": 0.6053411364555359, "log_alpha_value": -0.5019631385803223, "target_entropy": -6.0, "policy_t": -0.036334335803985596, "mean_q": 25.0168399810791, "max_q": 25.38123321533203, "min_q": 24.579631805419922}, "td_error": [0.9247322082519531, 1.9165706634521484, 1.2001276016235352, 1.1680974960327148, 1.8936805725097656, 2.2068347930908203, 1.1045570373535156, 2.1183156967163086, 0.47759056091308594, 0.7774085998535156, 0.6627788543701172, 1.6443309783935547, 1.650670051574707, 0.9616966247558594, 0.5312814712524414, 0.741053581237793, 1.337244987487793, 1.018625259399414, 0.0806741714477539, 1.6581306457519531, 0.847346305847168, 2.8632659912109375, 0.13802623748779297, 2.155179977416992, 0.7913837432861328, 1.1561107635498047, 1.1689796447753906, 0.5608100891113281, 1.0030078887939453, 0.5346202850341797, 0.9395818710327148, 0.7516403198242188, 1.435256004333496, 0.695012092590332, 1.5130367279052734, 1.071310043334961, 1.529557228088379, 1.6010160446166992, 2.0318450927734375, 0.6397933959960938, 1.717987060546875, 1.206843376159668, 1.4696836471557617, 1.4364166259765625, 1.3404245376586914, 1.3228950500488281, 0.5240507125854492, 1.8546419143676758, 0.8465681076049805, 0.34480953216552734, 0.8250093460083008, 1.0241270065307617, 0.0554656982421875, 0.08728408813476562, 0.8016862869262695, 2.2217893600463867, 1.9252243041992188, 1.9116277694702148, 0.9078378677368164, 0.4230194091796875, 0.5079622268676758, 1.804250717163086, 0.7862377166748047, 1.0685701370239258, 0.7464141845703125, 1.0690546035766602, 0.23508930206298828, 0.5923910140991211, 0.20586299896240234, 1.2776670455932617, 0.45848941802978516, 0.9041166305541992, 0.29502391815185547, 0.6830787658691406, 1.2613086700439453, 1.3557281494140625, 0.3373451232910156, 1.033066749572754, 1.1377019882202148, 1.2390708923339844, 0.7973976135253906, 1.1442584991455078, 2.0242834091186523, 1.2378416061401367, 3.2276697158813477, 1.4890546798706055], "mean_td_error": 1.1240408420562744, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1672.0, "diff_num_grad_updates_vs_sampler_policy": 1671.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.037619590759277, "actor_loss": -16.499202728271484, "critic_loss": 0.10849475860595703, "alpha_loss": -5.03495979309082, "alpha_value": 0.605555534362793, "log_alpha_value": -0.5016089677810669, "target_entropy": -6.0, "policy_t": 0.024380480870604515, "mean_q": 14.088512420654297, "max_q": 14.474477767944336, "min_q": 13.645526885986328}, "td_error": [1.1546688079833984, 1.578078269958496, 2.1543965339660645, 0.8498034477233887, 0.38753366470336914, 1.0785174369812012, 1.7712769508361816, 2.2417683601379395, 0.32714128494262695, 1.1247773170471191, 0.17353343963623047, 0.795677661895752, 1.224808692932129, 0.02824687957763672, 0.7903623580932617, 1.8550753593444824, 0.0348057746887207, 2.0438756942749023, 1.7844829559326172, 0.02908468246459961, 1.1699237823486328, 2.3540287017822266, 0.6508083343505859, 0.9814610481262207, 0.5586271286010742, 0.32155942916870117, 1.187678337097168, 1.0324459075927734, 1.328805923461914, 0.5940961837768555, 1.4845075607299805, 1.6888818740844727, 1.6195549964904785, 0.07061147689819336, 1.4646506309509277, 2.58126163482666, 2.8202667236328125, 1.7086782455444336, 2.276604175567627, 1.5370054244995117, 0.2623481750488281, 0.31514930725097656, 0.19537591934204102, 1.0804986953735352, 0.9085574150085449, 1.2134957313537598, 0.41716814041137695, 1.6146197319030762, 0.21706867218017578, 0.6311159133911133, 0.13661956787109375, 1.2256450653076172, 1.5520381927490234, 0.8296403884887695, 0.27089405059814453, 2.1768712997436523, 1.9343295097351074, 0.2266855239868164, 0.4167056083679199, 0.4233860969543457, 0.4169135093688965, 2.3189048767089844, 0.7855243682861328, 0.4407815933227539, 1.324897289276123, 2.1644253730773926, 0.41065216064453125, 1.0880699157714844, 1.5033950805664062, 0.7278733253479004, 1.0199041366577148, 0.8848199844360352, 1.578606128692627, 0.5480847358703613, 0.7733440399169922, 0.9795293807983398, 0.7069859504699707, 1.2926526069641113, 0.09081840515136719, 1.6243038177490234, 1.5429177284240723, 1.3979878425598145, 1.0216856002807617, 0.7901692390441895, 1.2132916450500488, 1.1566214561462402], "mean_td_error": 1.0780320167541504, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1672.0, "diff_num_grad_updates_vs_sampler_policy": 1671.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.094316482543945, "actor_loss": -16.997844696044922, "critic_loss": 0.1410476565361023, "alpha_loss": -5.063094139099121, "alpha_value": 0.605573832988739, "log_alpha_value": -0.5015787482261658, "target_entropy": -6.0, "policy_t": -0.005729012656956911, "mean_q": 14.558633804321289, "max_q": 14.992620468139648, "min_q": 14.123191833496094}, "td_error": [1.8560161590576172, 0.5737485885620117, 0.3690605163574219, 1.4991779327392578, 0.9692153930664062, 1.568882942199707, 2.035897731781006, 1.2675819396972656, 1.7017288208007812, 1.6243371963500977, 1.513427734375, 0.7839975357055664, 0.5159978866577148, 0.6108784675598145, 0.9456639289855957, 0.9831199645996094, 1.6819062232971191, 0.09844398498535156, 1.6319775581359863, 0.8612451553344727, 1.002161979675293, 1.3716163635253906, 2.278153419494629, 3.472853660583496, 0.2582426071166992, 1.891110897064209, 1.8946614265441895, 1.0496230125427246, 1.6509952545166016, 1.9540629386901855, 2.2920608520507812, 1.1060724258422852, 1.5671639442443848, 3.009918689727783, 0.5766897201538086, 0.8735041618347168, 0.6279401779174805, 0.10770130157470703, 0.7171502113342285, 0.3829636573791504, 2.0175118446350098, 1.2507200241088867, 1.3068170547485352, 0.647984504699707, 0.875300407409668, 0.039399147033691406, 0.7763729095458984, 0.5693755149841309, 2.1999893188476562, 0.40712785720825195, 1.23344087600708, 0.2350778579711914, 0.16068124771118164, 0.997840404510498, 0.4250516891479492, 0.25359201431274414, 1.7162117958068848, 0.3029212951660156, 1.0676660537719727, 1.4000625610351562, 0.4951753616333008, 0.18416118621826172, 1.867701530456543, 1.3788962364196777, 1.488929271697998, 0.21930599212646484, 1.6198163032531738, 0.6004462242126465, 1.3638114929199219, 0.06683206558227539, 1.3673815727233887, 1.299389362335205, 0.25147199630737305, 1.9011282920837402, 0.051413536071777344, 0.3569469451904297, 0.8809099197387695, 0.19582366943359375, 1.7339024543762207, 1.2731170654296875, 0.9443826675415039, 2.1745290756225586, 1.6445064544677734, 0.6828517913818359, 0.8870582580566406, 0.7182679176330566], "mean_td_error": 1.1012588739395142, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1672.0, "diff_num_grad_updates_vs_sampler_policy": 1671.0}}, "num_env_steps_sampled": 13202, "num_env_steps_trained": 431376, "num_agent_steps_sampled": 39606, "num_agent_steps_trained": 431376, "last_target_update_ts": 13202, "num_target_updates": 1672}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39606, "num_agent_steps_trained": 431376, "num_env_steps_sampled": 13202, "num_env_steps_trained": 431376, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.39287425989052, "num_env_steps_trained_throughput_per_sec": 2483.9087941502507, "timesteps_total": 13202, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 39606, "timers": {"training_iteration_time_ms": 104.172, "sample_time_ms": 15.927, "load_time_ms": 0.31, "load_throughput": 832024.014, "learn_time_ms": 18.061, "learn_throughput": 14284.739, "synch_weights_time_ms": 9.796}, "counters": {"num_env_steps_sampled": 13202, "num_env_steps_trained": 431376, "num_agent_steps_sampled": 39606, "num_agent_steps_trained": 431376, "last_target_update_ts": 13202, "num_target_updates": 1672}, "done": false, "episodes_total": 0, "training_iteration": 115, "trial_id": "db258_00000", "date": "2023-11-16_21-51-10", "timestamp": 1700200270, "time_this_iter_s": 1.5683519840240479, "time_total_s": 181.06702828407288, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e061a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 181.06702828407288, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 31.9, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.126347541809082, "actor_loss": -27.831066131591797, "critic_loss": 0.09089727699756622, "alpha_loss": -5.128692626953125, "alpha_value": 0.6026190519332886, "log_alpha_value": -0.5064700841903687, "target_entropy": -6.0, "policy_t": -0.032613035291433334, "mean_q": 25.37488555908203, "max_q": 25.979755401611328, "min_q": 24.879764556884766}, "td_error": [0.21983718872070312, 2.0984506607055664, 0.057015419006347656, 0.19806766510009766, 1.6663684844970703, 0.5524826049804688, 1.7018299102783203, 1.469085693359375, 1.3721923828125, 1.0594940185546875, 1.6755189895629883, 0.3817472457885742, 0.7444334030151367, 1.7775688171386719, 0.8896827697753906, 1.6787528991699219, 1.3911666870117188, 1.158524513244629, 1.2587099075317383, 0.1686687469482422, 2.1772680282592773, 1.3906173706054688, 2.0987930297851562, 1.2105398178100586, 0.3578023910522461, 0.7278718948364258, 0.97705078125, 2.453301429748535, 0.30541419982910156, 1.1436777114868164, 1.7247257232666016, 0.5215244293212891, 1.263845443725586, 0.6102075576782227, 0.35591983795166016, 1.595987319946289, 1.3371124267578125, 0.2800426483154297, 1.7967472076416016, 0.6813373565673828, 0.2064800262451172, 0.7599143981933594, 1.1613521575927734, 0.6132240295410156, 0.04585552215576172, 0.18108844757080078, 0.7473764419555664, 0.5229654312133789, 1.3110837936401367, 0.9143695831298828, 1.120682716369629, 0.24750804901123047, 1.3569393157958984, 1.1834239959716797, 1.1105804443359375, 0.05947685241699219, 1.0379304885864258, 0.4781312942504883, 1.6923942565917969, 0.08732986450195312, 1.1553001403808594, 1.5076103210449219, 1.4340877532958984, 0.6251630783081055, 0.8893585205078125, 0.43117427825927734, 1.5571346282958984, 2.9049062728881836, 1.1007814407348633, 1.2946281433105469, 1.040848731994629, 0.13736343383789062, 1.915374755859375, 0.21036338806152344, 1.0890274047851562, 0.48280811309814453, 1.075418472290039, 0.4964141845703125, 1.359884262084961, 1.3599262237548828, 1.9328432083129883, 0.5336542129516602, 0.3204498291015625, 1.1012401580810547, 0.630396842956543, 1.1124143600463867], "mean_td_error": 1.0123960971832275, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1687.0, "diff_num_grad_updates_vs_sampler_policy": 1686.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11236572265625, "actor_loss": -16.775442123413086, "critic_loss": 0.10768628865480423, "alpha_loss": -5.118006706237793, "alpha_value": 0.6028338670730591, "log_alpha_value": -0.5061136484146118, "target_entropy": -6.0, "policy_t": 0.04221651330590248, "mean_q": 14.347641944885254, "max_q": 14.62826919555664, "min_q": 14.021688461303711}, "td_error": [0.6349887847900391, 0.39395904541015625, 0.9360456466674805, 1.636549949645996, 2.0081820487976074, 0.5843877792358398, 2.218808650970459, 0.9874887466430664, 0.5733938217163086, 1.9391708374023438, 1.0011553764343262, 0.24967479705810547, 1.6650896072387695, 2.5068788528442383, 0.9719576835632324, 0.05223989486694336, 2.196669578552246, 2.0057826042175293, 1.2509417533874512, 1.7645854949951172, 0.49963998794555664, 1.8729333877563477, 0.07339048385620117, 1.273977279663086, 1.1405220031738281, 1.8286933898925781, 1.9612278938293457, 1.5803542137145996, 0.06223726272583008, 1.020031452178955, 0.9638566970825195, 0.40999746322631836, 0.19952154159545898, 0.1737060546875, 1.3268184661865234, 0.8328590393066406, 0.6445980072021484, 0.23537302017211914, 0.6931915283203125, 0.646277904510498, 1.1054821014404297, 1.1089730262756348, 0.7669858932495117, 0.655451774597168, 2.9813880920410156, 1.6817035675048828, 1.5294561386108398, 1.3626441955566406, 0.48023414611816406, 2.4747872352600098, 1.5298590660095215, 0.3481578826904297, 0.28121042251586914, 0.36999988555908203, 1.2467913627624512, 2.4072585105895996, 0.055666446685791016, 0.756129264831543, 0.04258298873901367, 0.40439891815185547, 0.40256261825561523, 0.8765707015991211, 0.990443229675293, 0.9517593383789062, 1.3524093627929688, 2.148381233215332, 1.249051570892334, 0.991544246673584, 1.342961311340332, 1.0102171897888184, 0.7856531143188477, 2.07381010055542, 0.981748104095459, 0.864837646484375, 1.9516758918762207, 0.8046765327453613, 2.1279702186584473, 0.8086199760437012, 1.4876489639282227, 0.8127689361572266, 1.084953784942627, 0.8251042366027832, 1.3672022819519043, 0.44458866119384766, 0.7523064613342285, 1.0285248756408691], "mean_td_error": 1.0944687128067017, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1687.0, "diff_num_grad_updates_vs_sampler_policy": 1686.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08006763458252, "actor_loss": -16.718244552612305, "critic_loss": 0.16023042798042297, "alpha_loss": -5.10133695602417, "alpha_value": 0.6028531789779663, "log_alpha_value": -0.5060815811157227, "target_entropy": -6.0, "policy_t": 0.0010077176848426461, "mean_q": 14.33773136138916, "max_q": 14.810295104980469, "min_q": 13.935276985168457}, "td_error": [1.1462860107421875, 1.989389419555664, 0.7656464576721191, 2.257364273071289, 1.2774529457092285, 1.0231494903564453, 1.673309326171875, 1.4891853332519531, 0.9576096534729004, 1.3686094284057617, 0.10465145111083984, 0.8736915588378906, 0.5210065841674805, 0.03318500518798828, 1.4990696907043457, 1.9220504760742188, 2.5401668548583984, 0.35418033599853516, 0.5432119369506836, 0.5479726791381836, 1.3410301208496094, 0.9469208717346191, 2.8474926948547363, 0.14815235137939453, 1.6884565353393555, 0.258730411529541, 1.8928194046020508, 1.1726603507995605, 1.4620227813720703, 0.6823720932006836, 0.9038958549499512, 2.4838342666625977, 1.2051210403442383, 1.239811897277832, 2.128654956817627, 0.8919253349304199, 2.0031166076660156, 1.489656925201416, 1.0005950927734375, 0.08499670028686523, 1.1621408462524414, 0.6058988571166992, 1.9321370124816895, 0.10921096801757812, 1.6718130111694336, 1.3269681930541992, 2.290017604827881, 0.8626174926757812, 1.8447542190551758, 0.07910728454589844, 1.5774335861206055, 1.4084758758544922, 0.5690445899963379, 1.0028953552246094, 1.3599977493286133, 0.5299124717712402, 0.7691841125488281, 2.7251105308532715, 1.8187856674194336, 2.2775497436523438, 1.528273582458496, 1.0001206398010254, 0.7735319137573242, 2.8170623779296875, 1.2911319732666016, 0.6454353332519531, 1.8197216987609863, 1.3327569961547852, 1.428487777709961, 1.0800952911376953, 1.3990893363952637, 0.7711515426635742, 0.3982524871826172, 1.8917179107666016, 0.049803733825683594, 2.4537086486816406, 0.2645416259765625, 0.5889520645141602, 2.164839744567871, 0.4830303192138672, 1.730036735534668, 0.5211186408996582, 0.6089754104614258, 0.862281322479248, 2.0366172790527344, 1.098200798034668], "mean_td_error": 1.2293192148208618, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1687.0, "diff_num_grad_updates_vs_sampler_policy": 1686.0}}, "num_env_steps_sampled": 13307, "num_env_steps_trained": 435246, "num_agent_steps_sampled": 39921, "num_agent_steps_trained": 435246, "last_target_update_ts": 13307, "num_target_updates": 1687}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39921, "num_agent_steps_trained": 435246, "num_env_steps_sampled": 13307, "num_env_steps_trained": 435246, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 57.358242469842445, "num_env_steps_trained_throughput_per_sec": 2114.060936745622, "timesteps_total": 13307, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 39921, "timers": {"training_iteration_time_ms": 129.647, "sample_time_ms": 18.085, "load_time_ms": 0.322, "load_throughput": 802291.246, "learn_time_ms": 19.43, "learn_throughput": 13278.668, "synch_weights_time_ms": 11.108}, "counters": {"num_env_steps_sampled": 13307, "num_env_steps_trained": 435246, "num_agent_steps_sampled": 39921, "num_agent_steps_trained": 435246, "last_target_update_ts": 13307, "num_target_updates": 1687}, "done": false, "episodes_total": 0, "training_iteration": 116, "trial_id": "db258_00000", "date": "2023-11-16_21-51-12", "timestamp": 1700200272, "time_this_iter_s": 1.839845895767212, "time_total_s": 182.9068741798401, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e142480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 182.9068741798401, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 37.73333333333333, "ram_util_percent": 63.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.114032745361328, "actor_loss": -27.465139389038086, "critic_loss": 0.1085287407040596, "alpha_loss": -5.168027877807617, "alpha_value": 0.599909782409668, "log_alpha_value": -0.5109759569168091, "target_entropy": -6.0, "policy_t": 0.0310919638723135, "mean_q": 25.09455680847168, "max_q": 25.60443878173828, "min_q": 24.631242752075195}, "td_error": [1.067697525024414, 1.5556020736694336, 0.9385404586791992, 1.0998172760009766, 1.627852439880371, 1.4690351486206055, 1.5688982009887695, 1.668349266052246, 0.9578914642333984, 1.2727384567260742, 1.5941238403320312, 0.8115777969360352, 0.7099494934082031, 0.8835172653198242, 1.971266746520996, 0.7941427230834961, 2.3698415756225586, 2.362722396850586, 0.3688936233520508, 1.0438032150268555, 1.230727195739746, 0.9201717376708984, 0.7342529296875, 0.05305957794189453, 0.05615234375, 3.059022903442383, 1.1318397521972656, 0.45064353942871094, 1.1754684448242188, 0.6355600357055664, 1.850337028503418, 0.4324951171875, 2.9656105041503906, 1.616154670715332, 1.3158721923828125, 1.7070741653442383, 0.39807987213134766, 0.8152017593383789, 2.0699100494384766, 1.0523767471313477, 1.908677101135254, 0.7040414810180664, 1.569544792175293, 0.8650646209716797, 0.3747224807739258, 0.6714801788330078, 0.7342567443847656, 1.2917776107788086, 1.0883674621582031, 0.4416961669921875, 0.7134342193603516, 1.5541715621948242, 0.31554508209228516, 2.121257781982422, 0.7993917465209961, 1.1768722534179688, 1.6644830703735352, 0.5637798309326172, 0.7011203765869141, 1.5647497177124023, 0.8146982192993164, 1.955331802368164, 1.6345462799072266, 0.6967144012451172, 1.0910224914550781, 3.125260353088379, 1.8018074035644531, 1.028977394104004, 0.6932840347290039, 1.8118162155151367, 0.6133270263671875, 0.641657829284668, 0.30132484436035156, 0.1631622314453125, 1.1924877166748047, 1.8059015274047852, 1.5969161987304688, 1.4402694702148438, 2.3534107208251953, 1.0884933471679688, 1.3896064758300781, 1.121124267578125, 0.8839502334594727, 0.17765140533447266, 1.5383167266845703, 0.40410423278808594], "mean_td_error": 1.1859984397888184, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1702.0, "diff_num_grad_updates_vs_sampler_policy": 1701.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.07536506652832, "actor_loss": -16.942203521728516, "critic_loss": 0.08779837191104889, "alpha_loss": -5.144658088684082, "alpha_value": 0.6001248359680176, "log_alpha_value": -0.5106175541877747, "target_entropy": -6.0, "policy_t": 0.019471662119030952, "mean_q": 14.541022300720215, "max_q": 14.992198944091797, "min_q": 14.222740173339844}, "td_error": [0.3528175354003906, 1.8277626037597656, 0.44510936737060547, 2.317154884338379, 2.1911392211914062, 0.7387228012084961, 1.1701278686523438, 0.0713644027709961, 0.5245490074157715, 3.004521369934082, 1.3563141822814941, 0.8313202857971191, 1.7033076286315918, 0.23564577102661133, 0.3339204788208008, 0.6151852607727051, 0.6080436706542969, 0.6426658630371094, 0.4924430847167969, 0.22141456604003906, 0.8246955871582031, 0.034119606018066406, 1.0266327857971191, 0.31928539276123047, 2.4920907020568848, 0.880833625793457, 0.4756622314453125, 1.3298072814941406, 1.6329693794250488, 0.2786569595336914, 0.6182394027709961, 1.129061222076416, 0.8122272491455078, 1.8434362411499023, 2.1318655014038086, 0.5389266014099121, 0.08690690994262695, 1.001363754272461, 0.25940513610839844, 1.1292924880981445, 0.6304450035095215, 1.1382970809936523, 1.4347314834594727, 0.19962120056152344, 0.3667292594909668, 1.2465887069702148, 1.1175689697265625, 1.6403884887695312, 1.3137726783752441, 0.9246606826782227, 1.0444111824035645, 1.0364818572998047, 0.6607704162597656, 0.7026939392089844, 0.6426372528076172, 2.060844898223877, 1.5682134628295898, 0.1898655891418457, 2.666304111480713, 0.6820468902587891, 1.2294650077819824, 0.45816564559936523, 1.2816352844238281, 0.5274291038513184, 2.028764247894287, 0.47629833221435547, 0.6332192420959473, 0.8947463035583496, 0.2474536895751953, 0.6306967735290527, 0.7382173538208008, 0.7936158180236816, 1.090583324432373, 0.8455448150634766, 1.7803378105163574, 0.30321264266967773, 1.7300500869750977, 1.412856101989746, 0.47817325592041016, 1.176518440246582, 0.45781803131103516, 1.096142292022705, 0.10435962677001953, 0.5414156913757324, 0.3799400329589844, 0.6384034156799316], "mean_td_error": 0.9508273005485535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1702.0, "diff_num_grad_updates_vs_sampler_policy": 1701.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.116290092468262, "actor_loss": -16.832916259765625, "critic_loss": 0.12728185951709747, "alpha_loss": -5.165236473083496, "alpha_value": 0.6001437902450562, "log_alpha_value": -0.5105860233306885, "target_entropy": -6.0, "policy_t": -0.05803970620036125, "mean_q": 14.405253410339355, "max_q": 14.829275131225586, "min_q": 13.913337707519531}, "td_error": [1.1536273956298828, 0.9564142227172852, 0.9033222198486328, 0.21904277801513672, 0.5030899047851562, 0.44409847259521484, 1.8210687637329102, 0.927250862121582, 2.0146732330322266, 0.7821388244628906, 1.8116064071655273, 0.8858704566955566, 1.7256178855895996, 1.0464215278625488, 0.6750802993774414, 1.4734210968017578, 1.1809258460998535, 2.0684661865234375, 0.31824779510498047, 1.3115663528442383, 0.3527803421020508, 0.10806131362915039, 0.20370149612426758, 0.32207679748535156, 0.41462182998657227, 0.5801911354064941, 2.3511881828308105, 0.7126703262329102, 0.8245282173156738, 0.5715336799621582, 1.3990297317504883, 1.6203136444091797, 0.14586257934570312, 1.7955808639526367, 1.0339174270629883, 0.016332626342773438, 0.5288915634155273, 0.45754146575927734, 1.521336555480957, 1.0910258293151855, 2.0474319458007812, 0.26817941665649414, 1.480875015258789, 2.104701519012451, 1.2303624153137207, 0.42283201217651367, 0.6970791816711426, 0.2748689651489258, 1.2520484924316406, 0.6644482612609863, 0.1186971664428711, 0.042420387268066406, 2.128673553466797, 0.5977210998535156, 2.1277451515197754, 0.4698977470397949, 1.5817203521728516, 0.5826935768127441, 2.09515380859375, 2.3861804008483887, 0.8112106323242188, 1.309168815612793, 1.730154037475586, 1.2521142959594727, 0.7285847663879395, 0.04921770095825195, 0.8218321800231934, 0.23036718368530273, 0.8827409744262695, 1.7893457412719727, 0.9737677574157715, 1.0006465911865234, 0.10649442672729492, 0.25788164138793945, 1.5650734901428223, 2.260199546813965, 0.9418125152587891, 2.0518102645874023, 0.38431739807128906, 0.7138433456420898, 1.5362796783447266, 0.5324225425720215, 1.4790616035461426, 1.219998836517334, 1.8631014823913574, 0.17174530029296875], "mean_td_error": 1.0175588130950928, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1702.0, "diff_num_grad_updates_vs_sampler_policy": 1701.0}}, "num_env_steps_sampled": 13412, "num_env_steps_trained": 439116, "num_agent_steps_sampled": 40236, "num_agent_steps_trained": 439116, "last_target_update_ts": 13412, "num_target_updates": 1702}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40236, "num_agent_steps_trained": 439116, "num_env_steps_sampled": 13412, "num_env_steps_trained": 439116, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 64.75174269498696, "num_env_steps_trained_throughput_per_sec": 2386.5642307580906, "timesteps_total": 13412, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 40236, "timers": {"training_iteration_time_ms": 108.03, "sample_time_ms": 18.366, "load_time_ms": 0.322, "load_throughput": 800569.973, "learn_time_ms": 18.986, "learn_throughput": 13588.663, "synch_weights_time_ms": 10.583}, "counters": {"num_env_steps_sampled": 13412, "num_env_steps_trained": 439116, "num_agent_steps_sampled": 40236, "num_agent_steps_trained": 439116, "last_target_update_ts": 13412, "num_target_updates": 1702}, "done": false, "episodes_total": 0, "training_iteration": 117, "trial_id": "db258_00000", "date": "2023-11-16_21-51-14", "timestamp": 1700200274, "time_this_iter_s": 1.635145902633667, "time_total_s": 184.54202008247375, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e1405e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 184.54202008247375, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 37.05, "ram_util_percent": 63.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.053462982177734, "actor_loss": -27.49014663696289, "critic_loss": 0.1119026243686676, "alpha_loss": -5.182429313659668, "alpha_value": 0.5972096920013428, "log_alpha_value": -0.515487015247345, "target_entropy": -6.0, "policy_t": -0.011173875071108341, "mean_q": 25.1844425201416, "max_q": 25.59663200378418, "min_q": 24.698448181152344}, "td_error": [1.3262500762939453, 0.5613460540771484, 1.4798154830932617, 1.2570514678955078, 0.5806884765625, 1.6811084747314453, 1.1960735321044922, 0.7110834121704102, 1.099736213684082, 0.2355661392211914, 1.583597183227539, 1.0101118087768555, 1.7393932342529297, 1.6820755004882812, 2.7520370483398438, 0.43961238861083984, 2.0247011184692383, 0.48252010345458984, 0.6857414245605469, 1.164743423461914, 0.5125102996826172, 0.7089824676513672, 0.41910743713378906, 0.6368370056152344, 0.9920825958251953, 2.390244483947754, 1.2454204559326172, 0.34257984161376953, 1.5963134765625, 2.491415023803711, 0.05189037322998047, 0.43149375915527344, 0.6691799163818359, 2.0945215225219727, 1.8419981002807617, 2.2239322662353516, 1.351797103881836, 1.4821271896362305, 0.9051723480224609, 0.9552154541015625, 1.4863166809082031, 1.6128807067871094, 0.8659448623657227, 1.7470521926879883, 2.154568672180176, 1.9482030868530273, 1.5826139450073242, 2.2896194458007812, 1.5834388732910156, 1.9772682189941406, 1.450098991394043, 1.637176513671875, 2.080829620361328, 1.5709075927734375, 0.9612751007080078, 0.7167787551879883, 1.175577163696289, 1.9825706481933594, 0.9424152374267578, 1.6976661682128906, 0.5728473663330078, 1.9210433959960938, 0.8425045013427734, 1.1867914199829102, 0.5792989730834961, 0.7091293334960938, 0.6793804168701172, 1.816329002380371, 1.2694015502929688, 0.21610450744628906, 1.4567022323608398, 1.344858169555664, 1.4973506927490234, 0.1776294708251953, 0.7975025177001953, 0.5795555114746094, 1.4303455352783203, 0.07373619079589844, 2.4280338287353516, 0.2764759063720703, 1.618372917175293, 0.9772853851318359, 0.99957275390625, 0.08491992950439453, 0.7162714004516602, 0.8927783966064453], "mean_td_error": 1.205156922340393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1717.0, "diff_num_grad_updates_vs_sampler_policy": 1716.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.065458297729492, "actor_loss": -16.769243240356445, "critic_loss": 0.09727881103754044, "alpha_loss": -5.18491792678833, "alpha_value": 0.5974289774894714, "log_alpha_value": -0.5151199102401733, "target_entropy": -6.0, "policy_t": -0.008466129191219807, "mean_q": 14.379076957702637, "max_q": 14.659507751464844, "min_q": 13.8414306640625}, "td_error": [0.8775506019592285, 2.3358707427978516, 1.505049705505371, 0.3684349060058594, 1.0884132385253906, 0.39479780197143555, 0.11126995086669922, 1.7091870307922363, 0.9938302040100098, 1.5206999778747559, 0.7847070693969727, 0.3765087127685547, 1.8921184539794922, 0.22321271896362305, 0.8119778633117676, 0.16544485092163086, 1.6036081314086914, 1.1251554489135742, 1.3535089492797852, 0.5337429046630859, 1.3431262969970703, 0.7558026313781738, 0.7342367172241211, 0.4705648422241211, 0.7680001258850098, 0.05563831329345703, 0.3052492141723633, 1.943385124206543, 0.5883817672729492, 0.6925897598266602, 0.39264678955078125, 1.8905706405639648, 1.389328956604004, 1.3732895851135254, 0.5128202438354492, 1.023991584777832, 0.8948607444763184, 0.4261007308959961, 0.8599104881286621, 1.1219944953918457, 1.3387179374694824, 0.8078341484069824, 0.7873325347900391, 1.4703426361083984, 0.4841270446777344, 0.88909912109375, 0.387606143951416, 1.181715965270996, 0.4838705062866211, 2.262474536895752, 2.0291590690612793, 1.4870762825012207, 0.24207162857055664, 1.1391711235046387, 0.8715715408325195, 1.2525091171264648, 1.2949323654174805, 1.1000709533691406, 0.09377431869506836, 1.3968968391418457, 1.1656475067138672, 0.3344874382019043, 0.2040243148803711, 2.6289358139038086, 0.24427461624145508, 0.8863401412963867, 1.6423540115356445, 0.23773670196533203, 1.1869468688964844, 0.9799494743347168, 1.863142490386963, 0.6896719932556152, 2.066497802734375, 1.5893383026123047, 1.123399257659912, 0.6861782073974609, 0.9028029441833496, 1.3343305587768555, 0.42885875701904297, 1.0928406715393066, 1.643503189086914, 1.88508939743042, 2.353126049041748, 1.0711088180541992, 1.1599531173706055, 0.6135272979736328], "mean_td_error": 1.027116298675537, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1717.0, "diff_num_grad_updates_vs_sampler_policy": 1716.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087091445922852, "actor_loss": -16.97603416442871, "critic_loss": 0.14232316613197327, "alpha_loss": -5.195712089538574, "alpha_value": 0.5974497199058533, "log_alpha_value": -0.5150851607322693, "target_entropy": -6.0, "policy_t": -0.0444028340280056, "mean_q": 14.573107719421387, "max_q": 14.911981582641602, "min_q": 14.203604698181152}, "td_error": [1.0809764862060547, 1.5439558029174805, 0.33278560638427734, 0.564854621887207, 1.1001701354980469, 0.8744421005249023, 2.2513794898986816, 0.6708493232727051, 0.9511704444885254, 1.115854263305664, 0.1997241973876953, 0.24749994277954102, 0.2916984558105469, 1.331397533416748, 2.9968247413635254, 0.4056673049926758, 1.6133427619934082, 0.4863557815551758, 3.478152275085449, 1.2997536659240723, 0.26757240295410156, 0.3029155731201172, 0.8528966903686523, 1.9201908111572266, 0.6909785270690918, 1.1842212677001953, 0.5679206848144531, 0.20837116241455078, 0.8601546287536621, 0.7004532814025879, 0.566493034362793, 1.753840446472168, 0.41701269149780273, 1.650773048400879, 3.0204696655273438, 0.9548158645629883, 0.5428614616394043, 0.3116278648376465, 0.21734380722045898, 1.8041505813598633, 2.6771950721740723, 0.8616495132446289, 0.13769149780273438, 1.798583984375, 2.0856099128723145, 1.3995170593261719, 1.1209640502929688, 1.5967979431152344, 0.637610912322998, 0.8724174499511719, 1.890944004058838, 2.0490407943725586, 1.1695680618286133, 1.528961181640625, 0.21471405029296875, 0.28426122665405273, 0.9292731285095215, 0.673987865447998, 1.1389575004577637, 1.919656753540039, 2.531057834625244, 0.9818482398986816, 0.5814533233642578, 1.1078243255615234, 1.997624397277832, 0.37764549255371094, 1.811326026916504, 0.5409107208251953, 1.1030263900756836, 1.4616780281066895, 1.7668046951293945, 1.129096508026123, 0.5208625793457031, 0.8774480819702148, 1.8837165832519531, 0.6490135192871094, 1.5757732391357422, 1.2279458045959473, 0.48769569396972656, 1.029676914215088, 1.1803154945373535, 1.4946823120117188, 0.8437652587890625, 0.46691274642944336, 2.611445903778076, 0.27068042755126953], "mean_td_error": 1.1294134855270386, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1717.0, "diff_num_grad_updates_vs_sampler_policy": 1716.0}}, "num_env_steps_sampled": 13517, "num_env_steps_trained": 442986, "num_agent_steps_sampled": 40551, "num_agent_steps_trained": 442986, "last_target_update_ts": 13517, "num_target_updates": 1717}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40551, "num_agent_steps_trained": 442986, "num_env_steps_sampled": 13517, "num_env_steps_trained": 442986, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.38825441923636, "num_env_steps_trained_throughput_per_sec": 2483.738520023283, "timesteps_total": 13517, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 40551, "timers": {"training_iteration_time_ms": 104.343, "sample_time_ms": 16.004, "load_time_ms": 0.307, "load_throughput": 840489.656, "learn_time_ms": 17.95, "learn_throughput": 14373.117, "synch_weights_time_ms": 10.053}, "counters": {"num_env_steps_sampled": 13517, "num_env_steps_trained": 442986, "num_agent_steps_sampled": 40551, "num_agent_steps_trained": 442986, "last_target_update_ts": 13517, "num_target_updates": 1717}, "done": false, "episodes_total": 0, "training_iteration": 118, "trial_id": "db258_00000", "date": "2023-11-16_21-51-15", "timestamp": 1700200275, "time_this_iter_s": 1.5664951801300049, "time_total_s": 186.10851526260376, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e060360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 186.10851526260376, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 33.6, "ram_util_percent": 63.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.071250915527344, "actor_loss": -27.676698684692383, "critic_loss": 0.09758411347866058, "alpha_loss": -5.236987590789795, "alpha_value": 0.5945242643356323, "log_alpha_value": -0.5199937224388123, "target_entropy": -6.0, "policy_t": 0.04003842547535896, "mean_q": 25.329444885253906, "max_q": 25.806564331054688, "min_q": 24.831933975219727}, "td_error": [2.226133346557617, 1.417032241821289, 0.04926490783691406, 1.789189338684082, 0.5816411972045898, 0.1753215789794922, 0.06718730926513672, 0.5007762908935547, 1.2320985794067383, 2.347738265991211, 0.8685235977172852, 0.12352180480957031, 1.1619930267333984, 0.7445611953735352, 0.6764116287231445, 1.5179262161254883, 1.0340604782104492, 1.0882129669189453, 1.3254814147949219, 1.572077751159668, 1.406315803527832, 0.8550815582275391, 1.6692352294921875, 1.4871816635131836, 0.1960773468017578, 2.1297712326049805, 0.9494924545288086, 0.45685577392578125, 0.28267478942871094, 0.9656047821044922, 0.1748819351196289, 1.8306655883789062, 0.863896369934082, 0.5681314468383789, 0.8109722137451172, 2.329331398010254, 0.4702033996582031, 0.11435699462890625, 0.6780519485473633, 0.9126262664794922, 1.367666244506836, 0.6294746398925781, 0.4599161148071289, 2.209591865539551, 1.2622547149658203, 0.9986152648925781, 1.3345279693603516, 0.5842475891113281, 1.4151859283447266, 2.0078859329223633, 2.046940803527832, 2.7885169982910156, 1.0857563018798828, 0.2589082717895508, 0.2640981674194336, 1.339482307434082, 1.2921772003173828, 1.5291767120361328, 0.5035076141357422, 0.1703968048095703, 2.8534765243530273, 1.7052192687988281, 1.50054931640625, 0.30384349822998047, 0.8569307327270508, 0.8890666961669922, 1.1828384399414062, 0.5272912979125977, 0.3401937484741211, 0.3343372344970703, 0.08556842803955078, 1.0111160278320312, 1.9865837097167969, 0.17726707458496094, 2.2308549880981445, 0.3934345245361328, 0.7091312408447266, 1.145751953125, 0.9601058959960938, 1.6323127746582031, 0.8345527648925781, 1.6268224716186523, 1.902756690979004, 1.5394659042358398, 1.2542972564697266, 1.4015827178955078], "mean_td_error": 1.0765609741210938, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1732.0, "diff_num_grad_updates_vs_sampler_policy": 1731.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017899513244629, "actor_loss": -16.86559295654297, "critic_loss": 0.10018406808376312, "alpha_loss": -5.205502986907959, "alpha_value": 0.5947464108467102, "log_alpha_value": -0.5196201205253601, "target_entropy": -6.0, "policy_t": 0.04054705798625946, "mean_q": 14.499046325683594, "max_q": 14.960790634155273, "min_q": 14.135225296020508}, "td_error": [0.9702577590942383, 0.7120718955993652, 1.1015849113464355, 2.7327418327331543, 0.16028118133544922, 0.34680938720703125, 0.9292020797729492, 3.183929443359375, 0.8880739212036133, 0.5550403594970703, 0.9406261444091797, 0.8115081787109375, 0.5769219398498535, 0.6831941604614258, 1.5147266387939453, 0.6710758209228516, 2.2121119499206543, 1.6870226860046387, 0.9050397872924805, 1.0666999816894531, 0.7484302520751953, 0.8754525184631348, 0.7996892929077148, 1.0421075820922852, 0.11653518676757812, 0.8877115249633789, 1.5263614654541016, 0.6789817810058594, 0.8664350509643555, 2.420435905456543, 0.5150456428527832, 0.8470087051391602, 1.388613224029541, 2.143893241882324, 1.010495662689209, 0.2224287986755371, 1.090703010559082, 0.8586006164550781, 2.031606674194336, 0.13822650909423828, 0.44500732421875, 1.5344934463500977, 0.7895951271057129, 0.8144559860229492, 1.0760459899902344, 1.090883731842041, 1.6722817420959473, 1.3985815048217773, 1.1491546630859375, 0.7557377815246582, 1.9723153114318848, 0.9261746406555176, 1.154283046722412, 0.7955617904663086, 1.342951774597168, 1.0378127098083496, 1.3635153770446777, 1.1274175643920898, 1.4327731132507324, 1.0875473022460938, 2.1869869232177734, 0.29016923904418945, 0.7272977828979492, 0.8450384140014648, 1.3482561111450195, 0.1561145782470703, 2.0432934761047363, 0.6769022941589355, 1.365335464477539, 1.4197320938110352, 0.7717084884643555, 0.089691162109375, 1.2419681549072266, 1.605445384979248, 0.04195261001586914, 1.1865105628967285, 1.122659683227539, 0.2741098403930664, 1.1458239555358887, 0.7370615005493164, 2.4793190956115723, 0.024937152862548828, 0.37285280227661133, 0.5968704223632812, 1.2536931037902832, 0.771761417388916], "mean_td_error": 1.053485631942749, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1732.0, "diff_num_grad_updates_vs_sampler_policy": 1731.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.084513664245605, "actor_loss": -16.767297744750977, "critic_loss": 0.13535846769809723, "alpha_loss": -5.239758014678955, "alpha_value": 0.5947675108909607, "log_alpha_value": -0.5195846557617188, "target_entropy": -6.0, "policy_t": -0.01899508759379387, "mean_q": 14.316563606262207, "max_q": 14.928107261657715, "min_q": 13.70211410522461}, "td_error": [1.6979074478149414, 1.2236180305480957, 0.51605224609375, 1.2952651977539062, 0.8595099449157715, 0.8897008895874023, 1.1883211135864258, 0.9032683372497559, 1.2661471366882324, 1.9308252334594727, 0.7790517807006836, 2.287839412689209, 1.1166439056396484, 2.146129608154297, 1.0276446342468262, 0.07933902740478516, 0.7538671493530273, 0.44524478912353516, 0.8453273773193359, 1.6802620887756348, 0.7054710388183594, 0.940915584564209, 0.2979698181152344, 0.6618976593017578, 1.1997451782226562, 1.4009523391723633, 1.1887316703796387, 1.3614811897277832, 1.7626280784606934, 1.0082545280456543, 0.8782739639282227, 1.5884757041931152, 0.3060111999511719, 0.43993139266967773, 1.5825319290161133, 1.2827672958374023, 1.0561227798461914, 0.832695484161377, 2.201411247253418, 1.339761734008789, 0.19108819961547852, 1.0190067291259766, 0.6405706405639648, 0.48381948471069336, 1.1902995109558105, 0.744265079498291, 0.31854915618896484, 0.8077969551086426, 0.3093447685241699, 1.4408855438232422, 0.32594776153564453, 2.361907958984375, 1.50128173828125, 0.6278705596923828, 2.432321071624756, 0.1617431640625, 1.0004148483276367, 1.7101659774780273, 1.361100673675537, 1.1959218978881836, 1.380324363708496, 1.2707905769348145, 1.2068815231323242, 1.826796054840088, 0.13147640228271484, 2.2566375732421875, 0.49669885635375977, 0.6573266983032227, 1.322122573852539, 0.6282882690429688, 0.28801441192626953, 0.348783016204834, 1.1728596687316895, 1.0105857849121094, 2.21895694732666, 0.7859349250793457, 0.7661595344543457, 1.0605039596557617, 1.5913968086242676, 1.5046610832214355, 0.9709482192993164, 0.48057079315185547, 0.44675588607788086, 1.0261244773864746, 1.204986572265625, 1.6878962516784668], "mean_td_error": 1.0759857892990112, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1732.0, "diff_num_grad_updates_vs_sampler_policy": 1731.0}}, "num_env_steps_sampled": 13622, "num_env_steps_trained": 446856, "num_agent_steps_sampled": 40866, "num_agent_steps_trained": 446856, "last_target_update_ts": 13622, "num_target_updates": 1732}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40866, "num_agent_steps_trained": 446856, "num_env_steps_sampled": 13622, "num_env_steps_trained": 446856, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.18989111630027, "num_env_steps_trained_throughput_per_sec": 2439.57027257221, "timesteps_total": 13622, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 40866, "timers": {"training_iteration_time_ms": 105.387, "sample_time_ms": 16.704, "load_time_ms": 0.312, "load_throughput": 825990.712, "learn_time_ms": 18.287, "learn_throughput": 14108.004, "synch_weights_time_ms": 10.266}, "counters": {"num_env_steps_sampled": 13622, "num_env_steps_trained": 446856, "num_agent_steps_sampled": 40866, "num_agent_steps_trained": 446856, "last_target_update_ts": 13622, "num_target_updates": 1732}, "done": false, "episodes_total": 0, "training_iteration": 119, "trial_id": "db258_00000", "date": "2023-11-16_21-51-17", "timestamp": 1700200277, "time_this_iter_s": 1.5960018634796143, "time_total_s": 187.70451712608337, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e140400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 187.70451712608337, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 35.05, "ram_util_percent": 63.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.130468368530273, "actor_loss": -27.903539657592773, "critic_loss": 0.09562210738658905, "alpha_loss": -5.313441276550293, "alpha_value": 0.5918505787849426, "log_alpha_value": -0.5245010852813721, "target_entropy": -6.0, "policy_t": -0.0018196202581748366, "mean_q": 25.521461486816406, "max_q": 26.085826873779297, "min_q": 25.072980880737305}, "td_error": [1.0328130722045898, 1.1413631439208984, 0.864802360534668, 1.1266260147094727, 0.42366981506347656, 1.7084064483642578, 0.9789505004882812, 1.2159013748168945, 1.341848373413086, 0.6993799209594727, 0.37960147857666016, 0.6263771057128906, 0.7053813934326172, 2.4903955459594727, 1.609339714050293, 1.1499443054199219, 0.7351169586181641, 1.2094488143920898, 0.9879026412963867, 1.446589469909668, 1.6445379257202148, 1.2079238891601562, 1.0050020217895508, 1.612177848815918, 0.906407356262207, 0.06657600402832031, 1.3581323623657227, 2.1684188842773438, 2.092352867126465, 1.3496952056884766, 1.8913908004760742, 0.9400968551635742, 1.8788738250732422, 1.6719532012939453, 1.6544857025146484, 0.6225242614746094, 1.4175548553466797, 0.6425914764404297, 0.8900747299194336, 0.07775020599365234, 0.9857006072998047, 1.0111398696899414, 1.090667724609375, 2.459566116333008, 2.4880218505859375, 0.20576953887939453, 1.9405231475830078, 1.4113750457763672, 0.9610424041748047, 0.24306488037109375, 0.6324872970581055, 1.2274627685546875, 0.4919471740722656, 1.4037837982177734, 1.9314708709716797, 0.7754907608032227, 1.2095575332641602, 1.2507133483886719, 0.38416194915771484, 0.6722078323364258, 1.4853439331054688, 0.10091590881347656, 0.42925357818603516, 1.0213336944580078, 0.6641941070556641, 0.3680286407470703, 1.1113262176513672, 1.6585750579833984, 1.1861658096313477, 0.8152370452880859, 1.1409358978271484, 1.6564035415649414, 1.4655189514160156, 0.04847431182861328, 1.712285041809082, 0.9091386795043945, 0.7303361892700195, 0.41367435455322266, 0.5535879135131836, 2.5142822265625, 0.27590179443359375, 1.010995864868164, 0.9803390502929688, 1.0472440719604492, 0.39026641845703125, 0.7444133758544922], "mean_td_error": 1.095147728919983, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1747.0, "diff_num_grad_updates_vs_sampler_policy": 1746.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.051616668701172, "actor_loss": -16.935335159301758, "critic_loss": 0.11493977904319763, "alpha_loss": -5.268237113952637, "alpha_value": 0.5920771956443787, "log_alpha_value": -0.5241183042526245, "target_entropy": -6.0, "policy_t": -0.004313769284635782, "mean_q": 14.578384399414062, "max_q": 14.963921546936035, "min_q": 14.076160430908203}, "td_error": [0.3392181396484375, 2.6504874229431152, 0.339479923248291, 0.017356395721435547, 2.345432758331299, 1.3810758590698242, 0.7767515182495117, 2.0450897216796875, 1.4703454971313477, 0.6636967658996582, 0.3608670234680176, 1.7647571563720703, 2.206765651702881, 0.5866150856018066, 0.10483551025390625, 1.3993597030639648, 0.704338550567627, 0.9687647819519043, 1.590031623840332, 1.1460933685302734, 1.6598877906799316, 1.520799160003662, 0.778721809387207, 1.5310068130493164, 1.4596757888793945, 0.1575756072998047, 1.774946689605713, 2.6970696449279785, 1.1454119682312012, 1.2495365142822266, 0.053694725036621094, 1.0168628692626953, 1.1766777038574219, 0.9337682723999023, 0.8711280822753906, 1.2853379249572754, 0.07168292999267578, 1.5492253303527832, 1.3372516632080078, 0.5940737724304199, 0.4388737678527832, 1.120612621307373, 1.466386318206787, 2.2128548622131348, 1.3012146949768066, 1.269697666168213, 1.3112120628356934, 0.889495849609375, 0.5678181648254395, 0.8332843780517578, 2.4120054244995117, 0.12796401977539062, 0.6947989463806152, 1.4988322257995605, 1.6025443077087402, 2.271056652069092, 1.1636838912963867, 1.5139479637145996, 1.8557548522949219, 1.336888313293457, 0.9681272506713867, 1.8463940620422363, 0.7809963226318359, 0.9568414688110352, 1.2962074279785156, 0.14876794815063477, 0.6341233253479004, 1.0673785209655762, 0.09868669509887695, 0.44686317443847656, 0.9377346038818359, 1.0014948844909668, 1.6667404174804688, 0.6517415046691895, 1.6455249786376953, 1.3509011268615723, 1.659818172454834, 0.8079671859741211, 1.5120577812194824, 0.1957859992980957, 1.728734016418457, 2.0869035720825195, 1.2226948738098145, 0.6304197311401367, 1.0466156005859375, 0.8481578826904297], "mean_td_error": 1.1494454145431519, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1747.0, "diff_num_grad_updates_vs_sampler_policy": 1746.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.09546184539795, "actor_loss": -16.645904541015625, "critic_loss": 0.14980235695838928, "alpha_loss": -5.290877819061279, "alpha_value": 0.5920969843864441, "log_alpha_value": -0.5240848064422607, "target_entropy": -6.0, "policy_t": 0.013118920847773552, "mean_q": 14.259934425354004, "max_q": 14.689398765563965, "min_q": 13.846171379089355}, "td_error": [1.4542179107666016, 1.8483781814575195, 0.6303472518920898, 0.8678627014160156, 0.4590573310852051, 0.5667338371276855, 0.09873342514038086, 2.082413673400879, 1.4003796577453613, 0.9654874801635742, 2.9268484115600586, 1.3595585823059082, 2.142223358154297, 1.2325663566589355, 0.22244501113891602, 0.9555940628051758, 1.6108074188232422, 1.0763626098632812, 0.5721120834350586, 1.7082195281982422, 1.1445040702819824, 0.5065155029296875, 2.1791820526123047, 1.0522551536560059, 0.021622180938720703, 1.7826433181762695, 0.9834756851196289, 0.9236593246459961, 2.4063897132873535, 0.5801906585693359, 0.05529308319091797, 0.846003532409668, 1.4361295700073242, 0.8007841110229492, 0.5311613082885742, 0.3715386390686035, 1.496962547302246, 0.8489751815795898, 2.058102607727051, 0.047135353088378906, 1.694887638092041, 0.7129554748535156, 0.836308479309082, 0.48944759368896484, 0.19743776321411133, 2.0988826751708984, 1.304335594177246, 0.28699541091918945, 1.2148513793945312, 1.335768222808838, 0.5079083442687988, 1.934946060180664, 1.9232797622680664, 1.2670855522155762, 1.4904956817626953, 1.1722831726074219, 2.1085572242736816, 2.0122933387756348, 1.9730567932128906, 0.09848308563232422, 1.9862680435180664, 0.6020298004150391, 0.23017120361328125, 0.17227983474731445, 0.5734844207763672, 0.7892227172851562, 0.17058563232421875, 0.4279184341430664, 2.3028478622436523, 0.05015707015991211, 0.5999212265014648, 0.494417667388916, 2.0944314002990723, 0.1446390151977539, 0.8292055130004883, 2.2018613815307617, 0.12334394454956055, 1.0160222053527832, 0.35469675064086914, 2.488022804260254, 0.8731880187988281, 1.650953769683838, 0.04517173767089844, 1.9300727844238281, 2.4123940467834473, 1.8848071098327637], "mean_td_error": 1.1088515520095825, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1747.0, "diff_num_grad_updates_vs_sampler_policy": 1746.0}}, "num_env_steps_sampled": 13727, "num_env_steps_trained": 450726, "num_agent_steps_sampled": 41181, "num_agent_steps_trained": 450726, "last_target_update_ts": 13727, "num_target_updates": 1747}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41181, "num_agent_steps_trained": 450726, "num_env_steps_sampled": 13727, "num_env_steps_trained": 450726, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.8495945325649, "num_env_steps_trained_throughput_per_sec": 2463.8850556288207, "timesteps_total": 13727, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 41181, "timers": {"training_iteration_time_ms": 105.153, "sample_time_ms": 16.309, "load_time_ms": 0.313, "load_throughput": 824543.151, "learn_time_ms": 18.557, "learn_throughput": 13902.859, "synch_weights_time_ms": 10.714}, "counters": {"num_env_steps_sampled": 13727, "num_env_steps_trained": 450726, "num_agent_steps_sampled": 41181, "num_agent_steps_trained": 450726, "last_target_update_ts": 13727, "num_target_updates": 1747}, "done": false, "episodes_total": 0, "training_iteration": 120, "trial_id": "db258_00000", "date": "2023-11-16_21-51-18", "timestamp": 1700200278, "time_this_iter_s": 1.5798258781433105, "time_total_s": 189.28434300422668, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e143420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 189.28434300422668, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 37.05, "ram_util_percent": 63.650000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110029220581055, "actor_loss": -27.88211441040039, "critic_loss": 0.08229688555002213, "alpha_loss": -5.34832239151001, "alpha_value": 0.5891870856285095, "log_alpha_value": -0.5290115475654602, "target_entropy": -6.0, "policy_t": -0.01139160431921482, "mean_q": 25.49122428894043, "max_q": 26.02482032775879, "min_q": 25.149124145507812}, "td_error": [0.33274173736572266, 1.9687128067016602, 1.74542236328125, 1.4313993453979492, 0.7221431732177734, 1.0802631378173828, 0.8748893737792969, 0.5837259292602539, 0.43358612060546875, 0.4468975067138672, 0.9660234451293945, 1.917811393737793, 1.6097955703735352, 1.0402469635009766, 1.1502037048339844, 0.5623970031738281, 0.8194980621337891, 1.1084003448486328, 1.473771095275879, 0.6712846755981445, 0.7298479080200195, 0.2211589813232422, 2.078470230102539, 0.9306201934814453, 1.9505243301391602, 0.9237518310546875, 0.7129878997802734, 0.8247337341308594, 0.7980375289916992, 2.538066864013672, 0.2538185119628906, 0.21217060089111328, 1.175889015197754, 0.8293666839599609, 0.7994308471679688, 0.042250633239746094, 0.5885810852050781, 0.8224430084228516, 0.45576000213623047, 0.9996585845947266, 0.06989669799804688, 0.8111820220947266, 2.5907230377197266, 1.2230091094970703, 0.2346353530883789, 1.3308124542236328, 0.29296398162841797, 0.5743169784545898, 1.220118522644043, 0.8464727401733398, 0.6867637634277344, 1.7605619430541992, 0.38666534423828125, 1.1445140838623047, 0.74615478515625, 0.9571046829223633, 1.8248558044433594, 0.6124181747436523, 0.6140317916870117, 1.7245597839355469, 1.271714210510254, 0.5713443756103516, 1.0573148727416992, 0.3786897659301758, 0.9413299560546875, 0.4974527359008789, 1.0089521408081055, 1.4269428253173828, 1.4366140365600586, 1.2222356796264648, 0.7347440719604492, 0.8636188507080078, 1.381052017211914, 0.9093313217163086, 1.3969097137451172, 0.7702207565307617, 0.26715660095214844, 0.6743316650390625, 0.8213396072387695, 1.6441650390625, 1.6543703079223633, 0.2149066925048828, 1.0464582443237305, 1.5181236267089844, 1.0592308044433594, 1.1853609085083008], "mean_td_error": 0.981772780418396, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1762.0, "diff_num_grad_updates_vs_sampler_policy": 1761.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.070298194885254, "actor_loss": -17.063112258911133, "critic_loss": 0.11283177882432938, "alpha_loss": -5.3233256340026855, "alpha_value": 0.5894199013710022, "log_alpha_value": -0.5286164283752441, "target_entropy": -6.0, "policy_t": -0.001480627921409905, "mean_q": 14.684457778930664, "max_q": 15.138218879699707, "min_q": 14.200736999511719}, "td_error": [2.7725048065185547, 0.3759012222290039, 2.635413646697998, 0.043836116790771484, 1.6475696563720703, 1.6287574768066406, 0.38942718505859375, 0.5242304801940918, 1.4162416458129883, 2.1482152938842773, 1.1516098976135254, 1.2818489074707031, 2.275491714477539, 0.44414186477661133, 2.0419797897338867, 1.6183791160583496, 0.7716593742370605, 1.5391783714294434, 1.2978019714355469, 1.3885259628295898, 0.8805084228515625, 1.027383804321289, 0.13936090469360352, 0.16855573654174805, 1.3799009323120117, 0.5263729095458984, 0.05255270004272461, 0.2720475196838379, 0.2340412139892578, 0.17655181884765625, 0.344357967376709, 0.28789567947387695, 1.1390390396118164, 0.6136784553527832, 1.6627869606018066, 0.33174562454223633, 0.2590451240539551, 2.1886420249938965, 1.070892333984375, 2.132136344909668, 0.3202371597290039, 0.5581169128417969, 0.2822446823120117, 1.3771257400512695, 1.4952659606933594, 1.2739205360412598, 0.46100378036499023, 1.8148221969604492, 0.8897905349731445, 1.431401252746582, 0.3209986686706543, 1.0968847274780273, 2.2144341468811035, 1.0851707458496094, 2.127622127532959, 0.9048128128051758, 0.31060171127319336, 1.3054838180541992, 2.3377933502197266, 1.876068115234375, 0.10503005981445312, 0.604311466217041, 1.416487693786621, 1.345860481262207, 1.1871099472045898, 0.23683643341064453, 1.4220094680786133, 2.2339558601379395, 1.7538409233093262, 0.6510820388793945, 0.5934467315673828, 0.6953978538513184, 0.4034609794616699, 0.24620437622070312, 2.6351284980773926, 1.7796692848205566, 0.30883073806762695, 0.9469566345214844, 1.467153549194336, 1.126208782196045, 0.4792146682739258, 0.6182818412780762, 0.7668290138244629, 1.4586000442504883, 3.5787363052368164, 2.6881351470947266], "mean_td_error": 1.122241735458374, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1762.0, "diff_num_grad_updates_vs_sampler_policy": 1761.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.075531005859375, "actor_loss": -16.96369743347168, "critic_loss": 0.12506258487701416, "alpha_loss": -5.325799942016602, "alpha_value": 0.5894370079040527, "log_alpha_value": -0.5285874605178833, "target_entropy": -6.0, "policy_t": -0.023016024380922318, "mean_q": 14.592645645141602, "max_q": 15.035832405090332, "min_q": 14.262012481689453}, "td_error": [0.6400361061096191, 0.634040355682373, 0.6255459785461426, 2.646822452545166, 0.46598291397094727, 3.247356414794922, 1.595911979675293, 1.1384587287902832, 0.7855238914489746, 0.2503228187561035, 0.5389523506164551, 2.065145492553711, 0.056044578552246094, 2.1069021224975586, 0.24371957778930664, 0.4941549301147461, 0.04327392578125, 2.195552349090576, 2.2911300659179688, 1.3550653457641602, 0.6586389541625977, 1.2745795249938965, 0.6266465187072754, 0.15260887145996094, 1.0107059478759766, 0.4736480712890625, 0.10666418075561523, 1.6401352882385254, 1.893305778503418, 1.0935745239257812, 0.8376131057739258, 0.3334174156188965, 1.5853939056396484, 1.5113763809204102, 0.4827413558959961, 1.2611479759216309, 1.6109232902526855, 1.858567237854004, 0.9336061477661133, 0.6692347526550293, 3.0052103996276855, 0.17360782623291016, 0.8802003860473633, 0.4188723564147949, 0.6612539291381836, 0.9499068260192871, 0.46134471893310547, 0.20041370391845703, 0.04784870147705078, 0.8791999816894531, 0.9866061210632324, 1.3187618255615234, 1.703742504119873, 1.9335932731628418, 1.0000762939453125, 0.7831563949584961, 1.0044775009155273, 0.5441875457763672, 1.228409767150879, 1.797269344329834, 0.9036550521850586, 0.776911735534668, 0.8493995666503906, 0.31369972229003906, 1.4739995002746582, 0.3806896209716797, 0.1807112693786621, 0.950932502746582, 1.8328704833984375, 0.25359582901000977, 0.10174989700317383, 1.648451805114746, 0.30989837646484375, 1.0501623153686523, 0.755882740020752, 0.9002470970153809, 1.0177006721496582, 0.6019020080566406, 0.043372154235839844, 2.132781982421875, 2.9149160385131836, 0.6632485389709473, 2.6855387687683105, 0.9692044258117676, 0.7879047393798828, 0.5210332870483398], "mean_td_error": 1.0282917022705078, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1762.0, "diff_num_grad_updates_vs_sampler_policy": 1761.0}}, "num_env_steps_sampled": 13832, "num_env_steps_trained": 454596, "num_agent_steps_sampled": 41496, "num_agent_steps_trained": 454596, "last_target_update_ts": 13832, "num_target_updates": 1762}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41496, "num_agent_steps_trained": 454596, "num_env_steps_sampled": 13832, "num_env_steps_trained": 454596, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.5536216038117, "num_env_steps_trained_throughput_per_sec": 2489.83348196906, "timesteps_total": 13832, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 41496, "timers": {"training_iteration_time_ms": 104.381, "sample_time_ms": 16.163, "load_time_ms": 0.316, "load_throughput": 816086.299, "learn_time_ms": 17.962, "learn_throughput": 14363.959, "synch_weights_time_ms": 9.927}, "counters": {"num_env_steps_sampled": 13832, "num_env_steps_trained": 454596, "num_agent_steps_sampled": 41496, "num_agent_steps_trained": 454596, "last_target_update_ts": 13832, "num_target_updates": 1762}, "done": false, "episodes_total": 0, "training_iteration": 121, "trial_id": "db258_00000", "date": "2023-11-16_21-51-20", "timestamp": 1700200280, "time_this_iter_s": 1.5646090507507324, "time_total_s": 190.84895205497742, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 190.84895205497742, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 33.65, "ram_util_percent": 63.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.151594161987305, "actor_loss": -28.460065841674805, "critic_loss": 0.11319628357887268, "alpha_loss": -5.416120529174805, "alpha_value": 0.586534321308136, "log_alpha_value": -0.5335240960121155, "target_entropy": -6.0, "policy_t": 0.02986527793109417, "mean_q": 26.06380844116211, "max_q": 26.75191879272461, "min_q": 25.520469665527344}, "td_error": [2.9441394805908203, 2.0248098373413086, 0.24974822998046875, 0.23123741149902344, 0.07888984680175781, 1.157552719116211, 3.4488162994384766, 0.51446533203125, 1.4982166290283203, 0.5137262344360352, 0.7217416763305664, 0.07280826568603516, 1.7396936416625977, 0.9236564636230469, 0.056858062744140625, 1.0481395721435547, 0.48577117919921875, 0.45165252685546875, 0.11425018310546875, 1.337510108947754, 0.5799570083618164, 0.883331298828125, 1.4451360702514648, 0.3275423049926758, 2.503170967102051, 1.3454170227050781, 1.5811052322387695, 2.1656808853149414, 2.7333555221557617, 0.9434337615966797, 2.214810371398926, 1.680490493774414, 1.191812515258789, 0.4504432678222656, 0.6059446334838867, 0.8163928985595703, 0.3113269805908203, 1.3011856079101562, 0.7035322189331055, 1.6524925231933594, 2.285646438598633, 1.5307674407958984, 0.8753328323364258, 2.7786102294921875, 1.4627418518066406, 1.577540397644043, 2.362842559814453, 0.15062332153320312, 1.610152244567871, 1.4936342239379883, 1.4881582260131836, 0.06605815887451172, 1.6911334991455078, 0.6143426895141602, 0.45288848876953125, 1.769331932067871, 1.6111927032470703, 1.300436019897461, 1.4218168258666992, 1.2763605117797852, 0.821624755859375, 0.2607879638671875, 1.8043251037597656, 1.1825523376464844, 0.927128791809082, 1.4931421279907227, 1.502610206604004, 2.218935966491699, 1.690770149230957, 0.070648193359375, 0.5887575149536133, 0.33951663970947266, 1.1458663940429688, 1.5093812942504883, 0.7710332870483398, 0.8975706100463867, 1.3648462295532227, 0.8736066818237305, 1.7354717254638672, 1.184748649597168, 2.0898094177246094, 0.47305870056152344, 0.49616527557373047, 1.7649059295654297, 1.5041656494140625, 2.726109504699707], "mean_td_error": 1.212876796722412, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1777.0, "diff_num_grad_updates_vs_sampler_policy": 1776.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.073690414428711, "actor_loss": -16.874937057495117, "critic_loss": 0.11209510266780853, "alpha_loss": -5.370463848114014, "alpha_value": 0.5867726802825928, "log_alpha_value": -0.5331178307533264, "target_entropy": -6.0, "policy_t": -0.01042984239757061, "mean_q": 14.551873207092285, "max_q": 15.055906295776367, "min_q": 14.046878814697266}, "td_error": [0.2509160041809082, 1.925363540649414, 0.8934407234191895, 2.6025118827819824, 0.3648204803466797, 0.9330806732177734, 2.7063231468200684, 1.7640185356140137, 0.6850781440734863, 0.04640007019042969, 0.23243379592895508, 0.2979445457458496, 0.15905141830444336, 1.3681960105895996, 0.04738140106201172, 3.7382078170776367, 1.9996490478515625, 1.1315412521362305, 2.134507179260254, 0.1486053466796875, 0.30592823028564453, 1.8046565055847168, 2.4022645950317383, 1.186762809753418, 0.9834365844726562, 0.39195728302001953, 0.26477909088134766, 1.20159912109375, 0.9100608825683594, 1.947634220123291, 0.690584659576416, 0.38729429244995117, 1.5419769287109375, 2.064329147338867, 1.0990653038024902, 0.4911489486694336, 1.9431753158569336, 0.08391714096069336, 0.591127872467041, 1.1018638610839844, 0.7116031646728516, 1.612492561340332, 1.8566398620605469, 0.41897153854370117, 1.208449363708496, 0.21745586395263672, 0.6164016723632812, 0.48595380783081055, 1.3232145309448242, 0.6669468879699707, 1.0952835083007812, 1.2212433815002441, 0.37609004974365234, 2.3287177085876465, 0.4359135627746582, 0.5193123817443848, 0.7880635261535645, 0.12136220932006836, 0.5526256561279297, 1.9523091316223145, 0.7114911079406738, 1.1188344955444336, 1.6423492431640625, 0.6694564819335938, 0.6786661148071289, 0.7386207580566406, 0.5592808723449707, 0.10361194610595703, 0.7805252075195312, 0.5152983665466309, 0.43403100967407227, 2.593350410461426, 1.2416343688964844, 1.3255367279052734, 0.1200098991394043, 2.1180543899536133, 2.2883663177490234, 3.2264604568481445, 0.7878594398498535, 1.2252116203308105, 1.096163272857666, 2.8310070037841797, 2.195059299468994, 1.587745189666748, 1.2049150466918945, 0.5090179443359375], "mean_td_error": 1.1120307445526123, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1777.0, "diff_num_grad_updates_vs_sampler_policy": 1776.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.063633918762207, "actor_loss": -16.86639976501465, "critic_loss": 0.12516501545906067, "alpha_loss": -5.364815711975098, "alpha_value": 0.5867893695831299, "log_alpha_value": -0.5330893397331238, "target_entropy": -6.0, "policy_t": -0.014420575462281704, "mean_q": 14.478936195373535, "max_q": 14.855550765991211, "min_q": 14.027294158935547}, "td_error": [1.3890604972839355, 0.31394386291503906, 0.06904220581054688, 1.5436019897460938, 0.9322104454040527, 0.28931474685668945, 1.2893280982971191, 0.7283568382263184, 0.2242870330810547, 0.7141237258911133, 0.05605030059814453, 0.32073259353637695, 0.8866376876831055, 1.7031006813049316, 1.1984596252441406, 2.3733811378479004, 0.18599605560302734, 0.1550893783569336, 1.0184297561645508, 0.6218366622924805, 1.1246204376220703, 0.8634395599365234, 0.3365621566772461, 0.6315078735351562, 0.32770776748657227, 2.4451074600219727, 1.1439290046691895, 0.4817328453063965, 1.1877555847167969, 1.428196907043457, 2.026897430419922, 1.0571608543395996, 0.618044376373291, 1.0272321701049805, 0.7425260543823242, 0.4256563186645508, 1.3417673110961914, 2.0953965187072754, 1.933305263519287, 0.7549300193786621, 1.6249566078186035, 0.8603200912475586, 1.0529255867004395, 0.08344173431396484, 0.6701288223266602, 0.48102331161499023, 0.8778314590454102, 1.0086321830749512, 1.9570140838623047, 1.088106632232666, 0.722538948059082, 1.2850356101989746, 1.7996492385864258, 1.158647060394287, 1.132875919342041, 0.3998289108276367, 1.7198257446289062, 0.697838306427002, 0.9162402153015137, 0.3568296432495117, 0.5322809219360352, 1.61045503616333, 0.9876112937927246, 1.1170663833618164, 1.4743170738220215, 0.8582258224487305, 2.0806612968444824, 2.5028820037841797, 0.9763054847717285, 0.7480282783508301, 0.17131328582763672, 3.0070133209228516, 1.7146387100219727, 0.02485370635986328, 0.0915384292602539, 1.1484427452087402, 1.3031330108642578, 1.791818618774414, 0.6630253791809082, 0.28842592239379883, 1.429595947265625, 1.009549617767334, 0.5989370346069336, 0.5214791297912598, 1.064988613128662, 0.13233518600463867], "mean_td_error": 0.9970821738243103, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1777.0, "diff_num_grad_updates_vs_sampler_policy": 1776.0}}, "num_env_steps_sampled": 13937, "num_env_steps_trained": 458466, "num_agent_steps_sampled": 41811, "num_agent_steps_trained": 458466, "last_target_update_ts": 13937, "num_target_updates": 1777}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41811, "num_agent_steps_trained": 458466, "num_env_steps_sampled": 13937, "num_env_steps_trained": 458466, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.97316234062578, "num_env_steps_trained_throughput_per_sec": 2468.4394119830645, "timesteps_total": 13937, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 41811, "timers": {"training_iteration_time_ms": 104.419, "sample_time_ms": 15.98, "load_time_ms": 0.317, "load_throughput": 814366.671, "learn_time_ms": 18.028, "learn_throughput": 14311.282, "synch_weights_time_ms": 10.082}, "counters": {"num_env_steps_sampled": 13937, "num_env_steps_trained": 458466, "num_agent_steps_sampled": 41811, "num_agent_steps_trained": 458466, "last_target_update_ts": 13937, "num_target_updates": 1777}, "done": false, "episodes_total": 0, "training_iteration": 122, "trial_id": "db258_00000", "date": "2023-11-16_21-51-22", "timestamp": 1700200282, "time_this_iter_s": 1.5768837928771973, "time_total_s": 192.42583584785461, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e062fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 192.42583584785461, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 30.23333333333333, "ram_util_percent": 63.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.136512756347656, "actor_loss": -28.279333114624023, "critic_loss": 0.08580014109611511, "alpha_loss": -5.453784942626953, "alpha_value": 0.5838952660560608, "log_alpha_value": -0.538033664226532, "target_entropy": -6.0, "policy_t": 0.008392324671149254, "mean_q": 25.914968490600586, "max_q": 26.406051635742188, "min_q": 25.522451400756836}, "td_error": [0.6639394760131836, 2.1533803939819336, 0.35587215423583984, 1.0581378936767578, 1.194570541381836, 0.4599647521972656, 0.5240869522094727, 1.0995025634765625, 1.0413179397583008, 0.64520263671875, 0.7167701721191406, 1.1467475891113281, 1.4368667602539062, 0.17072010040283203, 0.762782096862793, 0.899409294128418, 0.6307249069213867, 0.42731571197509766, 0.5767078399658203, 0.17613887786865234, 0.8366317749023438, 0.6608982086181641, 1.1435346603393555, 0.6862716674804688, 0.04601478576660156, 1.0394115447998047, 0.8782520294189453, 0.4109764099121094, 0.9643688201904297, 1.3788394927978516, 2.2885704040527344, 1.2093448638916016, 1.0229911804199219, 0.24078655242919922, 1.0513877868652344, 2.021167755126953, 1.0185041427612305, 0.06746482849121094, 0.5170049667358398, 0.994293212890625, 1.9286117553710938, 1.2104263305664062, 0.08929824829101562, 0.9038505554199219, 1.1173629760742188, 0.4164705276489258, 0.7962970733642578, 0.817591667175293, 0.1332530975341797, 1.6003360748291016, 0.46100521087646484, 0.9408864974975586, 1.1128826141357422, 1.063532829284668, 1.8047161102294922, 0.6782875061035156, 2.0161609649658203, 2.117154121398926, 1.901529312133789, 0.0635843276977539, 0.781275749206543, 1.8807878494262695, 0.45133018493652344, 0.2625389099121094, 0.8561649322509766, 1.7784452438354492, 0.41617488861083984, 0.6588211059570312, 2.2403812408447266, 1.415247917175293, 0.6988840103149414, 0.8777122497558594, 1.641362190246582, 0.4833850860595703, 0.47110939025878906, 1.4264192581176758, 1.1018028259277344, 0.5388584136962891, 0.2029733657836914, 1.69464111328125, 2.731276512145996, 2.845430374145508, 1.242936134338379, 0.041286468505859375, 2.0299549102783203, 0.3054666519165039], "mean_td_error": 0.9867997169494629, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1792.0, "diff_num_grad_updates_vs_sampler_policy": 1791.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.150385856628418, "actor_loss": -17.04336166381836, "critic_loss": 0.10763993114233017, "alpha_loss": -5.457043170928955, "alpha_value": 0.5841372609138489, "log_alpha_value": -0.5376192927360535, "target_entropy": -6.0, "policy_t": 0.03820077329874039, "mean_q": 14.620121002197266, "max_q": 14.992818832397461, "min_q": 14.226624488830566}, "td_error": [1.4838104248046875, 1.2398982048034668, 0.10136985778808594, 1.5253896713256836, 0.5955033302307129, 0.1370253562927246, 1.7770419120788574, 1.3184494972229004, 0.16813230514526367, 0.3977036476135254, 0.4204983711242676, 1.6663455963134766, 1.4272241592407227, 1.0225114822387695, 0.7916126251220703, 0.9803352355957031, 0.9622220993041992, 1.6160259246826172, 1.8799338340759277, 1.2970457077026367, 1.3132495880126953, 0.7665576934814453, 1.1538820266723633, 0.13112354278564453, 1.76698637008667, 2.7726964950561523, 0.8912124633789062, 0.15494203567504883, 2.1926074028015137, 2.5079784393310547, 0.5515909194946289, 1.0482587814331055, 2.6127800941467285, 1.2758731842041016, 1.339181900024414, 0.30644989013671875, 0.6101675033569336, 0.3314986228942871, 0.6020236015319824, 1.3199868202209473, 0.9996418952941895, 0.7611169815063477, 0.9636058807373047, 1.0762767791748047, 1.5360498428344727, 1.324172019958496, 2.0326714515686035, 1.0482864379882812, 0.8658347129821777, 0.7118830680847168, 0.43575096130371094, 0.8639430999755859, 0.28957366943359375, 1.526228427886963, 0.8605055809020996, 0.630760669708252, 0.9487872123718262, 0.11581611633300781, 0.9509730339050293, 1.0687851905822754, 2.8706674575805664, 1.3369083404541016, 1.1078743934631348, 0.1780400276184082, 1.1084785461425781, 2.799372673034668, 0.7973318099975586, 0.039620399475097656, 1.8321785926818848, 0.9966788291931152, 1.175898551940918, 1.9176950454711914, 1.468151569366455, 0.6419010162353516, 1.7442359924316406, 0.47872495651245117, 1.1990351676940918, 0.3182864189147949, 0.5426793098449707, 1.875840663909912, 1.7744574546813965, 0.8718605041503906, 0.7428674697875977, 1.9812145233154297, 1.139204978942871, 0.5492005348205566], "mean_td_error": 1.1041417121887207, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1792.0, "diff_num_grad_updates_vs_sampler_policy": 1791.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.11791706085205, "actor_loss": -17.07429313659668, "critic_loss": 0.12991777062416077, "alpha_loss": -5.439235687255859, "alpha_value": 0.5841576457023621, "log_alpha_value": -0.5375844240188599, "target_entropy": -6.0, "policy_t": -0.053748659789562225, "mean_q": 14.713430404663086, "max_q": 15.027058601379395, "min_q": 14.368799209594727}, "td_error": [0.475372314453125, 1.030350685119629, 1.622091293334961, 0.9101409912109375, 0.20724773406982422, 1.5836706161499023, 1.6770730018615723, 1.8412694931030273, 2.078042984008789, 1.0834150314331055, 1.7710728645324707, 1.3320741653442383, 1.442896842956543, 1.953547477722168, 1.1916680335998535, 0.8267321586608887, 1.225919246673584, 1.59312105178833, 1.572084903717041, 0.36945152282714844, 0.5797009468078613, 0.2625274658203125, 0.8395004272460938, 1.2723426818847656, 0.6950139999389648, 0.42907238006591797, 2.1575050354003906, 1.0277719497680664, 1.0028390884399414, 0.8394670486450195, 0.20160913467407227, 1.8606376647949219, 1.084909439086914, 0.26665258407592773, 1.4973578453063965, 0.07257747650146484, 0.15912771224975586, 1.206639289855957, 0.5319266319274902, 1.9817981719970703, 1.3744306564331055, 1.6452827453613281, 0.4861564636230469, 0.7105674743652344, 1.6829986572265625, 2.514888286590576, 0.5529403686523438, 1.1603236198425293, 0.4303874969482422, 0.30544042587280273, 1.319544792175293, 1.526247501373291, 0.9079713821411133, 2.095926284790039, 1.1578478813171387, 0.12361764907836914, 0.10782337188720703, 0.49390602111816406, 1.438603401184082, 0.6707453727722168, 2.050856113433838, 2.0981836318969727, 0.6218781471252441, 1.321977138519287, 0.5266990661621094, 1.125990867614746, 0.7598223686218262, 1.4439215660095215, 0.8477716445922852, 0.8255743980407715, 0.3251771926879883, 0.6885490417480469, 2.0604076385498047, 0.8274974822998047, 0.18253707885742188, 0.6128687858581543, 1.246748924255371, 0.1742229461669922, 0.18648433685302734, 1.6586904525756836, 1.1758131980895996, 0.824620246887207, 0.7653341293334961, 0.6293883323669434, 2.129444122314453, 1.1604957580566406], "mean_td_error": 1.0550328493118286, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1792.0, "diff_num_grad_updates_vs_sampler_policy": 1791.0}}, "num_env_steps_sampled": 14042, "num_env_steps_trained": 462336, "num_agent_steps_sampled": 42126, "num_agent_steps_trained": 462336, "last_target_update_ts": 14042, "num_target_updates": 1792}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42126, "num_agent_steps_trained": 462336, "num_env_steps_sampled": 14042, "num_env_steps_trained": 462336, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.26885367896706, "num_env_steps_trained_throughput_per_sec": 2479.3377498819286, "timesteps_total": 14042, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 42126, "timers": {"training_iteration_time_ms": 104.651, "sample_time_ms": 16.388, "load_time_ms": 0.321, "load_throughput": 804318.739, "learn_time_ms": 17.96, "learn_throughput": 14365.371, "synch_weights_time_ms": 9.921}, "counters": {"num_env_steps_sampled": 14042, "num_env_steps_trained": 462336, "num_agent_steps_sampled": 42126, "num_agent_steps_trained": 462336, "last_target_update_ts": 14042, "num_target_updates": 1792}, "done": false, "episodes_total": 0, "training_iteration": 123, "trial_id": "db258_00000", "date": "2023-11-16_21-51-23", "timestamp": 1700200283, "time_this_iter_s": 1.5699281692504883, "time_total_s": 193.9957640171051, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e0623e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 193.9957640171051, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.129352569580078, "actor_loss": -28.3111572265625, "critic_loss": 0.12578292191028595, "alpha_loss": -5.495596885681152, "alpha_value": 0.5812689661979675, "log_alpha_value": -0.5425417423248291, "target_entropy": -6.0, "policy_t": 0.04167890176177025, "mean_q": 25.98929214477539, "max_q": 26.510169982910156, "min_q": 25.492284774780273}, "td_error": [1.1411848068237305, 1.4802513122558594, 1.1432456970214844, 1.3836898803710938, 1.6079254150390625, 0.8897123336791992, 2.438671112060547, 1.0418071746826172, 2.3446998596191406, 1.4552240371704102, 1.7458171844482422, 0.7875814437866211, 0.4744224548339844, 1.5691900253295898, 1.2936973571777344, 1.4309701919555664, 1.3452377319335938, 0.9601097106933594, 1.8029594421386719, 2.346053123474121, 2.085503578186035, 1.10980224609375, 2.244845390319824, 1.3338336944580078, 1.0927419662475586, 0.603022575378418, 1.365591049194336, 0.8245811462402344, 0.8501996994018555, 0.8003702163696289, 0.3935222625732422, 0.6191062927246094, 0.2788505554199219, 1.2898540496826172, 0.8497095108032227, 2.5222015380859375, 0.13643360137939453, 1.9029655456542969, 1.8587474822998047, 1.3982524871826172, 1.430105209350586, 0.2855672836303711, 2.0358142852783203, 1.337874412536621, 0.9366912841796875, 1.7887086868286133, 1.0625591278076172, 0.39203739166259766, 1.1876916885375977, 2.1137800216674805, 2.058465003967285, 1.3558292388916016, 1.4443044662475586, 2.637631416320801, 1.9342594146728516, 1.2509078979492188, 1.2650022506713867, 0.776738166809082, 2.0186710357666016, 0.8130702972412109, 0.19798660278320312, 1.7081260681152344, 1.5682563781738281, 1.4919681549072266, 0.33809661865234375, 1.9185609817504883, 2.846249580383301, 0.7321395874023438, 0.4100923538208008, 2.0891151428222656, 0.20123958587646484, 2.2909412384033203, 1.3285045623779297, 0.11190414428710938, 1.0541973114013672, 2.7495670318603516, 2.296255111694336, 1.5779199600219727, 0.41036415100097656, 0.17882156372070312, 1.9821233749389648, 1.3953819274902344, 0.23421669006347656, 0.1247568130493164, 0.28261470794677734, 1.7691621780395508], "mean_td_error": 1.2983355522155762, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1807.0, "diff_num_grad_updates_vs_sampler_policy": 1806.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.152854919433594, "actor_loss": -16.96204948425293, "critic_loss": 0.11053106188774109, "alpha_loss": -5.504074573516846, "alpha_value": 0.5815136432647705, "log_alpha_value": -0.5421208739280701, "target_entropy": -6.0, "policy_t": -0.05243412405252457, "mean_q": 14.587240219116211, "max_q": 14.91480827331543, "min_q": 14.157837867736816}, "td_error": [2.2950057983398438, 1.057297706604004, 0.3334665298461914, 0.6770439147949219, 0.17593860626220703, 0.37315940856933594, 1.326559066772461, 0.5770125389099121, 1.4736361503601074, 1.4545869827270508, 1.2155227661132812, 1.6134581565856934, 0.3218832015991211, 1.542712688446045, 0.39226245880126953, 1.6723384857177734, 0.39801549911499023, 1.0632567405700684, 2.2885942459106445, 2.104903221130371, 1.3272476196289062, 0.8914999961853027, 1.6461906433105469, 0.7635540962219238, 0.16550588607788086, 0.7456064224243164, 2.3845090866088867, 0.27994537353515625, 0.09359407424926758, 1.117978572845459, 1.0507421493530273, 1.562352180480957, 1.269301414489746, 3.338998794555664, 2.406951904296875, 1.7717814445495605, 0.9722757339477539, 0.12819194793701172, 2.036777973175049, 0.6588149070739746, 1.2178525924682617, 1.0416393280029297, 0.5142993927001953, 0.16542577743530273, 1.5109672546386719, 2.3221254348754883, 0.7767553329467773, 1.6210718154907227, 1.1794276237487793, 0.7197341918945312, 0.9186534881591797, 1.6611928939819336, 1.2078027725219727, 1.4482121467590332, 2.019717216491699, 1.6808085441589355, 0.7016191482543945, 1.922797679901123, 0.9331512451171875, 0.7161092758178711, 0.7756633758544922, 0.39827585220336914, 0.7388191223144531, 1.3175883293151855, 1.2777628898620605, 1.7352204322814941, 0.40079641342163086, 0.11574888229370117, 0.9386711120605469, 0.257108211517334, 2.622859001159668, 0.290524959564209, 0.4471116065979004, 0.4015388488769531, 1.2671871185302734, 1.134099006652832, 0.4133448600769043, 0.8969974517822266, 0.9463071823120117, 1.1139860153198242, 0.7200798988342285, 1.490455150604248, 0.825650691986084, 0.9434857368469238, 0.7279648780822754, 0.6697854995727539], "mean_td_error": 1.0943589210510254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1807.0, "diff_num_grad_updates_vs_sampler_policy": 1806.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.083173751831055, "actor_loss": -17.236141204833984, "critic_loss": 0.14432716369628906, "alpha_loss": -5.465950965881348, "alpha_value": 0.5815337300300598, "log_alpha_value": -0.5420863032341003, "target_entropy": -6.0, "policy_t": -0.01712549850344658, "mean_q": 14.895251274108887, "max_q": 15.454339981079102, "min_q": 14.449301719665527}, "td_error": [0.6284322738647461, 1.6684017181396484, 0.9176907539367676, 1.3461651802062988, 0.8566064834594727, 0.4806838035583496, 0.891294002532959, 0.7423791885375977, 0.8955068588256836, 1.9606876373291016, 2.3578176498413086, 1.3982934951782227, 1.7135119438171387, 1.0669035911560059, 1.1000289916992188, 0.7043280601501465, 0.6640338897705078, 0.33867454528808594, 0.6324458122253418, 1.414945125579834, 0.03751564025878906, 1.4995684623718262, 1.1443357467651367, 0.543757438659668, 0.6203393936157227, 0.7308592796325684, 0.8424224853515625, 2.446949005126953, 1.4758849143981934, 0.08176469802856445, 1.4503512382507324, 1.1819443702697754, 0.594517707824707, 0.5102367401123047, 1.5099296569824219, 0.522700309753418, 0.2875809669494629, 1.0682597160339355, 0.3040742874145508, 1.5733060836791992, 2.140519618988037, 1.787862777709961, 1.131436824798584, 1.3954343795776367, 0.21474981307983398, 1.482375144958496, 0.6762223243713379, 2.6482043266296387, 1.753061294555664, 1.4760665893554688, 1.098374366760254, 2.2453842163085938, 2.070937156677246, 0.36399173736572266, 0.26567888259887695, 3.770966053009033, 0.03486013412475586, 1.6474051475524902, 1.3806023597717285, 2.6101040840148926, 0.44370555877685547, 2.444977283477783, 1.0010871887207031, 0.853480339050293, 0.537696361541748, 1.5887880325317383, 1.2720723152160645, 1.6876659393310547, 1.6675620079040527, 1.20253324508667, 0.6449499130249023, 0.8855681419372559, 0.6517329216003418, 1.1918649673461914, 1.3013172149658203, 0.812349796295166, 0.5703363418579102, 0.08598041534423828, 0.1540536880493164, 1.654444694519043, 1.0549225807189941, 0.17468690872192383, 1.3986544609069824, 1.1336374282836914, 0.515751838684082, 1.813687801361084], "mean_td_error": 1.1295684576034546, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1807.0, "diff_num_grad_updates_vs_sampler_policy": 1806.0}}, "num_env_steps_sampled": 14147, "num_env_steps_trained": 466206, "num_agent_steps_sampled": 42441, "num_agent_steps_trained": 466206, "last_target_update_ts": 14147, "num_target_updates": 1807}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42441, "num_agent_steps_trained": 466206, "num_env_steps_sampled": 14147, "num_env_steps_trained": 466206, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.97008667296524, "num_env_steps_trained_throughput_per_sec": 2468.326051660719, "timesteps_total": 14147, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 42441, "timers": {"training_iteration_time_ms": 104.788, "sample_time_ms": 16.482, "load_time_ms": 0.309, "load_throughput": 835815.58, "learn_time_ms": 18.311, "learn_throughput": 14089.708, "synch_weights_time_ms": 9.996}, "counters": {"num_env_steps_sampled": 14147, "num_env_steps_trained": 466206, "num_agent_steps_sampled": 42441, "num_agent_steps_trained": 466206, "last_target_update_ts": 14147, "num_target_updates": 1807}, "done": false, "episodes_total": 0, "training_iteration": 124, "trial_id": "db258_00000", "date": "2023-11-16_21-51-25", "timestamp": 1700200285, "time_this_iter_s": 1.576805830001831, "time_total_s": 195.57256984710693, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16dfb5620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 195.57256984710693, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 33.9, "ram_util_percent": 63.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.062318801879883, "actor_loss": -28.495969772338867, "critic_loss": 0.0860765129327774, "alpha_loss": -5.504549980163574, "alpha_value": 0.5786567330360413, "log_alpha_value": -0.5470458269119263, "target_entropy": -6.0, "policy_t": 0.005107709672302008, "mean_q": 26.213624954223633, "max_q": 26.85344886779785, "min_q": 25.830923080444336}, "td_error": [0.05547904968261719, 1.0042991638183594, 1.1280717849731445, 1.4732513427734375, 1.2335987091064453, 0.8472166061401367, 0.749664306640625, 0.4759483337402344, 0.25815391540527344, 1.7892446517944336, 2.242422103881836, 0.5804891586303711, 1.2733287811279297, 0.3333930969238281, 1.1296977996826172, 0.8432960510253906, 0.7257175445556641, 0.42554664611816406, 1.1748628616333008, 0.8531494140625, 2.2613582611083984, 1.025284767150879, 0.09405994415283203, 0.6486282348632812, 0.8087882995605469, 0.14212322235107422, 1.5627508163452148, 0.30674266815185547, 0.5243968963623047, 0.41049766540527344, 1.3138971328735352, 2.4255027770996094, 1.3065595626831055, 0.9367752075195312, 1.6100730895996094, 1.9993009567260742, 0.9040260314941406, 1.026357650756836, 0.5753889083862305, 1.3671770095825195, 0.9699306488037109, 0.3661928176879883, 0.927708625793457, 0.5061960220336914, 0.9275684356689453, 1.371255874633789, 1.3469371795654297, 0.10332393646240234, 0.6394519805908203, 0.8870887756347656, 1.9119853973388672, 1.4697980880737305, 1.8392000198364258, 0.051415443420410156, 1.2192573547363281, 0.8833932876586914, 0.8891315460205078, 1.2114801406860352, 0.8594970703125, 2.017894744873047, 0.186553955078125, 1.8539142608642578, 0.7312040328979492, 1.8267498016357422, 0.4472675323486328, 0.7464714050292969, 0.47281932830810547, 2.1215972900390625, 0.9442272186279297, 2.0947322845458984, 1.8382177352905273, 0.6227779388427734, 0.8800525665283203, 1.405588150024414, 0.5100955963134766, 0.4098339080810547, 0.7185430526733398, 0.8819408416748047, 0.9451379776000977, 0.4853839874267578, 1.2488908767700195, 0.4675264358520508, 1.401789665222168, 0.9858007431030273, 0.5902442932128906, 1.2681350708007812], "mean_td_error": 1.0038456916809082, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1822.0, "diff_num_grad_updates_vs_sampler_policy": 1821.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123665809631348, "actor_loss": -16.977602005004883, "critic_loss": 0.10734561085700989, "alpha_loss": -5.53383207321167, "alpha_value": 0.5789012908935547, "log_alpha_value": -0.5466233491897583, "target_entropy": -6.0, "policy_t": -0.0032358630560338497, "mean_q": 14.654284477233887, "max_q": 15.178092956542969, "min_q": 14.23271369934082}, "td_error": [0.12543392181396484, 0.8356542587280273, 0.9098305702209473, 0.6930842399597168, 1.9595375061035156, 1.5631089210510254, 0.5216598510742188, 2.010110855102539, 0.7054595947265625, 1.8394484519958496, 1.1928434371948242, 0.9668674468994141, 2.177323341369629, 2.036184787750244, 1.3438324928283691, 0.7398552894592285, 1.9916315078735352, 1.2262611389160156, 1.5551996231079102, 1.1217870712280273, 1.1199345588684082, 1.2749767303466797, 1.5448918342590332, 0.7690987586975098, 0.6619076728820801, 1.2694592475891113, 2.928898811340332, 1.2667970657348633, 0.23688745498657227, 0.3213920593261719, 1.4817371368408203, 0.5870685577392578, 0.27809858322143555, 0.9948501586914062, 0.5663785934448242, 1.8744664192199707, 1.302626132965088, 0.16321849822998047, 0.8955802917480469, 1.3554620742797852, 0.8349370956420898, 1.344254493713379, 1.3778047561645508, 1.2846932411193848, 0.08122730255126953, 1.8878040313720703, 3.648007869720459, 0.6356987953186035, 0.4575376510620117, 0.4179987907409668, 0.604856014251709, 0.544288158416748, 1.4079742431640625, 2.2702736854553223, 1.4881911277770996, 0.812408447265625, 0.7814111709594727, 0.7254805564880371, 0.5723628997802734, 0.8052115440368652, 0.15111446380615234, 2.9328341484069824, 2.263035774230957, 0.18096542358398438, 1.796799659729004, 1.284766674041748, 0.4298739433288574, 0.39267826080322266, 1.8815531730651855, 1.387740135192871, 1.1050171852111816, 0.2735929489135742, 0.6815381050109863, 2.094174385070801, 0.021068096160888672, 1.069375991821289, 0.43326282501220703, 0.26773738861083984, 0.6946640014648438, 0.2930459976196289, 0.665257453918457, 1.2239303588867188, 0.6301369667053223, 0.09772682189941406, 1.4145112037658691, 0.6877884864807129], "mean_td_error": 1.0784355401992798, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1822.0, "diff_num_grad_updates_vs_sampler_policy": 1821.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.107418060302734, "actor_loss": -17.431076049804688, "critic_loss": 0.11421311646699905, "alpha_loss": -5.524618148803711, "alpha_value": 0.5789203643798828, "log_alpha_value": -0.5465903282165527, "target_entropy": -6.0, "policy_t": 0.04565304145216942, "mean_q": 15.11318588256836, "max_q": 15.496174812316895, "min_q": 14.752546310424805}, "td_error": [1.214165210723877, 0.9862914085388184, 1.0397801399230957, 0.4499473571777344, 1.0690021514892578, 0.615394115447998, 1.8281021118164062, 0.350527286529541, 1.0941710472106934, 1.5468063354492188, 0.5400886535644531, 0.5159263610839844, 1.4006619453430176, 1.3882064819335938, 1.4256019592285156, 1.640207290649414, 2.046298027038574, 1.6272225379943848, 1.7335824966430664, 0.025575637817382812, 0.3297901153564453, 0.8584089279174805, 0.2146310806274414, 0.6578917503356934, 1.5509848594665527, 0.2671060562133789, 0.8468165397644043, 0.025669097900390625, 0.08892107009887695, 1.1984586715698242, 1.1090292930603027, 1.7743210792541504, 1.9633283615112305, 1.3465094566345215, 0.09344482421875, 0.16005516052246094, 0.4873051643371582, 0.34680938720703125, 1.5497121810913086, 1.3531060218811035, 0.9585638046264648, 0.28759002685546875, 0.5853433609008789, 0.14024972915649414, 0.32529640197753906, 0.6013221740722656, 0.5483546257019043, 0.34667444229125977, 1.1315360069274902, 0.9805564880371094, 0.7919111251831055, 1.5623559951782227, 1.481851577758789, 1.2938623428344727, 1.0799245834350586, 1.367227554321289, 0.21078109741210938, 0.3996105194091797, 0.4960780143737793, 2.1251955032348633, 1.2071666717529297, 0.19135808944702148, 1.2596549987792969, 0.8384685516357422, 1.0206074714660645, 1.1963958740234375, 0.39581775665283203, 0.04708290100097656, 1.496572494506836, 0.3555426597595215, 1.33774995803833, 1.3242316246032715, 0.2743949890136719, 1.1468720436096191, 1.991163730621338, 0.4908003807067871, 0.5566959381103516, 0.20963811874389648, 0.7203106880187988, 0.10982418060302734, 0.9191856384277344, 0.878880500793457, 0.7340583801269531, 1.8337907791137695, 1.7885217666625977, 0.9732747077941895], "mean_td_error": 0.9159559011459351, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1822.0, "diff_num_grad_updates_vs_sampler_policy": 1821.0}}, "num_env_steps_sampled": 14252, "num_env_steps_trained": 470076, "num_agent_steps_sampled": 42756, "num_agent_steps_trained": 470076, "last_target_update_ts": 14252, "num_target_updates": 1822}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42756, "num_agent_steps_trained": 470076, "num_env_steps_sampled": 14252, "num_env_steps_trained": 470076, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 67.30549347365744, "num_env_steps_trained_throughput_per_sec": 2480.6881880290885, "timesteps_total": 14252, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 42756, "timers": {"training_iteration_time_ms": 104.44, "sample_time_ms": 16.235, "load_time_ms": 0.308, "load_throughput": 838340.899, "learn_time_ms": 17.878, "learn_throughput": 14431.273, "synch_weights_time_ms": 10.602}, "counters": {"num_env_steps_sampled": 14252, "num_env_steps_trained": 470076, "num_agent_steps_sampled": 42756, "num_agent_steps_trained": 470076, "last_target_update_ts": 14252, "num_target_updates": 1822}, "done": false, "episodes_total": 0, "training_iteration": 125, "trial_id": "db258_00000", "date": "2023-11-16_21-51-27", "timestamp": 1700200287, "time_this_iter_s": 1.5694258213043213, "time_total_s": 197.14199566841125, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e063740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 197.14199566841125, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 32.76666666666667, "ram_util_percent": 63.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.096263885498047, "actor_loss": -28.72675895690918, "critic_loss": 0.09160514175891876, "alpha_loss": -5.568576335906982, "alpha_value": 0.5760572552680969, "log_alpha_value": -0.5515482425689697, "target_entropy": -6.0, "policy_t": 0.010162947699427605, "mean_q": 26.37250518798828, "max_q": 27.205608367919922, "min_q": 25.843284606933594}, "td_error": [0.31355857849121094, 1.5277099609375, 0.7713222503662109, 0.3258857727050781, 1.2227106094360352, 0.1918010711669922, 0.10448074340820312, 0.1843881607055664, 0.05355644226074219, 1.053213119506836, 1.3953285217285156, 1.7439537048339844, 1.3835172653198242, 1.4784784317016602, 2.1748790740966797, 0.4472379684448242, 0.518773078918457, 1.10894775390625, 0.07880210876464844, 2.731247901916504, 2.209578514099121, 2.298924446105957, 0.5507488250732422, 0.9956693649291992, 0.13387489318847656, 0.7291126251220703, 1.5666561126708984, 0.4559059143066406, 1.083587646484375, 0.8354902267456055, 0.37929725646972656, 1.592432975769043, 0.11234092712402344, 0.27958011627197266, 1.4424200057983398, 0.7052488327026367, 0.10586738586425781, 1.8873701095581055, 0.06755447387695312, 0.3106069564819336, 0.8922967910766602, 1.1559877395629883, 0.9713172912597656, 1.2338571548461914, 0.3750295639038086, 0.3995237350463867, 0.19531631469726562, 0.05348968505859375, 1.901296615600586, 2.0549821853637695, 0.9301357269287109, 0.42305850982666016, 0.7622804641723633, 2.5121517181396484, 1.5830135345458984, 2.5367698669433594, 0.5355958938598633, 1.6668004989624023, 1.5651540756225586, 0.10114860534667969, 0.49211978912353516, 2.0149011611938477, 2.41072940826416, 1.8161487579345703, 1.74310302734375, 0.21460437774658203, 0.3515739440917969, 1.1351251602172852, 0.1481800079345703, 0.5239648818969727, 2.167551040649414, 2.5951223373413086, 1.7416229248046875, 0.9447078704833984, 0.5524225234985352, 0.20952987670898438, 0.2139148712158203, 0.6605844497680664, 0.5767812728881836, 0.6156291961669922, 0.8938560485839844, 1.5004215240478516, 1.7119598388671875, 0.11618804931640625, 0.26874351501464844, 3.403712272644043], "mean_td_error": 1.0165635347366333, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1837.0, "diff_num_grad_updates_vs_sampler_policy": 1836.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.087984085083008, "actor_loss": -17.30760955810547, "critic_loss": 0.10381686687469482, "alpha_loss": -5.559763431549072, "alpha_value": 0.576299786567688, "log_alpha_value": -0.5511273145675659, "target_entropy": -6.0, "policy_t": 0.03026622347533703, "mean_q": 14.992477416992188, "max_q": 15.426192283630371, "min_q": 14.464265823364258}, "td_error": [0.02139759063720703, 1.923661708831787, 0.07689666748046875, 1.1313791275024414, 1.0374016761779785, 0.042938232421875, 1.613440990447998, 0.6510868072509766, 1.496546745300293, 0.5996279716491699, 2.4380970001220703, 0.522007942199707, 2.3873229026794434, 0.9470176696777344, 1.0581021308898926, 2.540457248687744, 0.24320316314697266, 0.47710657119750977, 0.25677013397216797, 0.8168487548828125, 1.1606922149658203, 0.9200725555419922, 0.5322046279907227, 0.7718310356140137, 0.4261140823364258, 0.9723100662231445, 0.8868041038513184, 1.3286004066467285, 1.1183524131774902, 0.6724472045898438, 1.4132566452026367, 2.3125925064086914, 0.4368896484375, 1.6694855690002441, 1.8239340782165527, 0.42748165130615234, 1.8492918014526367, 0.9082469940185547, 0.9002175331115723, 0.4453849792480469, 1.314197063446045, 1.0515055656433105, 1.4766054153442383, 0.018796443939208984, 1.7402586936950684, 0.5704174041748047, 0.6321845054626465, 0.8165292739868164, 1.347313404083252, 1.2271509170532227, 0.555333137512207, 0.2421112060546875, 1.739830493927002, 1.1718425750732422, 0.5548577308654785, 1.0541768074035645, 0.2982363700866699, 0.7302956581115723, 1.5232763290405273, 2.1099185943603516, 1.2323474884033203, 0.6172008514404297, 0.3854827880859375, 1.3232316970825195, 1.6589908599853516, 1.944939136505127, 0.08976030349731445, 1.6623759269714355, 1.2047677040100098, 1.245826244354248, 0.4100170135498047, 0.5733003616333008, 0.10250329971313477, 1.6538009643554688, 1.8476066589355469, 0.8295016288757324, 0.8134913444519043, 0.2378544807434082, 0.5078325271606445, 2.5547423362731934, 0.6378030776977539, 1.1620831489562988, 1.5859274864196777, 1.7185454368591309, 1.2038116455078125, 1.564054012298584], "mean_td_error": 1.0488390922546387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1837.0, "diff_num_grad_updates_vs_sampler_policy": 1836.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101373672485352, "actor_loss": -17.173418045043945, "critic_loss": 0.145196795463562, "alpha_loss": -5.566809177398682, "alpha_value": 0.5763188004493713, "log_alpha_value": -0.5510942935943604, "target_entropy": -6.0, "policy_t": -0.015160559676587582, "mean_q": 14.863860130310059, "max_q": 15.320123672485352, "min_q": 14.547101974487305}, "td_error": [1.9763789176940918, 1.1967487335205078, 1.152876377105713, 2.0089383125305176, 0.8972821235656738, 0.677670955657959, 0.4969062805175781, 0.9732246398925781, 1.9808869361877441, 0.5707674026489258, 0.6829805374145508, 1.924936294555664, 0.934168815612793, 0.3713264465332031, 0.05931282043457031, 0.06477499008178711, 1.1292753219604492, 1.1841320991516113, 2.320549964904785, 2.1627984046936035, 1.7596383094787598, 1.7247982025146484, 0.5886764526367188, 0.8062782287597656, 1.2061810493469238, 1.3253602981567383, 0.3021249771118164, 1.1494359970092773, 1.728764533996582, 1.3497366905212402, 0.6726226806640625, 1.039841651916504, 1.3110313415527344, 0.5073904991149902, 0.9150652885437012, 2.324389934539795, 0.9759120941162109, 0.9606537818908691, 1.0850400924682617, 2.6728339195251465, 2.7956814765930176, 0.9033284187316895, 0.7042560577392578, 1.4660863876342773, 1.1583013534545898, 1.5515351295471191, 0.21274852752685547, 1.8461637496948242, 1.4294028282165527, 0.8534879684448242, 0.4496297836303711, 0.0649561882019043, 0.3690299987792969, 0.2692384719848633, 1.2158513069152832, 1.5890522003173828, 0.7714400291442871, 0.9424819946289062, 2.97269868850708, 0.9099149703979492, 0.7416062355041504, 1.5818681716918945, 1.313344955444336, 1.2922472953796387, 1.648416519165039, 1.347276210784912, 0.27138566970825195, 1.0496606826782227, 0.3911762237548828, 0.6070709228515625, 0.5617561340332031, 1.4304556846618652, 2.4056992530822754, 0.07180261611938477, 1.3549261093139648, 0.2312617301940918, 0.7644968032836914, 0.5573310852050781, 1.687751293182373, 1.5656533241271973, 1.5350141525268555, 1.4832992553710938, 0.06604290008544922, 0.2061905860900879, 1.203531265258789, 2.587380886077881], "mean_td_error": 1.1349260807037354, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1837.0, "diff_num_grad_updates_vs_sampler_policy": 1836.0}}, "num_env_steps_sampled": 14357, "num_env_steps_trained": 473946, "num_agent_steps_sampled": 43071, "num_agent_steps_trained": 473946, "last_target_update_ts": 14357, "num_target_updates": 1837}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43071, "num_agent_steps_trained": 473946, "num_env_steps_sampled": 14357, "num_env_steps_trained": 473946, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 66.32619968346094, "num_env_steps_trained_throughput_per_sec": 2444.5942169047034, "timesteps_total": 14357, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 43071, "timers": {"training_iteration_time_ms": 105.849, "sample_time_ms": 16.75, "load_time_ms": 0.316, "load_throughput": 815348.427, "learn_time_ms": 18.632, "learn_throughput": 13847.104, "synch_weights_time_ms": 10.44}, "counters": {"num_env_steps_sampled": 14357, "num_env_steps_trained": 473946, "num_agent_steps_sampled": 43071, "num_agent_steps_trained": 473946, "last_target_update_ts": 14357, "num_target_updates": 1837}, "done": false, "episodes_total": 0, "training_iteration": 126, "trial_id": "db258_00000", "date": "2023-11-16_21-51-28", "timestamp": 1700200288, "time_this_iter_s": 1.5932817459106445, "time_total_s": 198.7352774143219, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e142d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 198.7352774143219, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 63.349999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.175727844238281, "actor_loss": -28.657499313354492, "critic_loss": 0.11043694615364075, "alpha_loss": -5.658248424530029, "alpha_value": 0.5734678506851196, "log_alpha_value": -0.5560534000396729, "target_entropy": -6.0, "policy_t": 0.023157374933362007, "mean_q": 26.337547302246094, "max_q": 26.8762264251709, "min_q": 25.660110473632812}, "td_error": [2.369579315185547, 2.173760414123535, 1.5394506454467773, 0.8235015869140625, 0.7995967864990234, 2.67903995513916, 1.4522037506103516, 2.2028751373291016, 0.767939567565918, 1.504018783569336, 0.3206062316894531, 0.5197610855102539, 1.1465930938720703, 0.4438037872314453, 0.9712066650390625, 1.2351694107055664, 2.470919609069824, 1.1097993850708008, 1.3464794158935547, 0.3823833465576172, 0.8173017501831055, 0.21140670776367188, 1.4390230178833008, 2.4835758209228516, 1.1087608337402344, 1.240478515625, 0.5902652740478516, 0.8668746948242188, 1.7875432968139648, 0.12796783447265625, 0.9521970748901367, 0.9233598709106445, 1.2110042572021484, 2.737004280090332, 0.8592462539672852, 0.20672321319580078, 0.0696420669555664, 2.0567245483398438, 1.3000354766845703, 1.5386772155761719, 0.8577384948730469, 0.3732414245605469, 1.1660594940185547, 0.3663358688354492, 1.4281530380249023, 1.1227178573608398, 1.462275505065918, 0.19051837921142578, 1.4123477935791016, 1.7094964981079102, 1.0504817962646484, 0.26154041290283203, 0.27652931213378906, 0.39229488372802734, 1.052830696105957, 1.5525798797607422, 1.1923952102661133, 0.4796600341796875, 1.3827266693115234, 1.0611591339111328, 3.2620677947998047, 0.8246488571166992, 2.048280715942383, 1.4052038192749023, 1.061441421508789, 0.9337339401245117, 2.3749732971191406, 0.22226428985595703, 1.4648475646972656, 2.3007287979125977, 1.4062623977661133, 1.1222591400146484, 2.57369327545166, 0.6070413589477539, 0.5371694564819336, 0.8528366088867188, 2.105924606323242, 1.8522357940673828, 1.0108146667480469, 1.380105972290039, 0.6182746887207031, 1.0173158645629883, 0.17251968383789062, 2.038254737854004, 1.3578643798828125, 1.6509971618652344], "mean_td_error": 1.2067365646362305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1852.0, "diff_num_grad_updates_vs_sampler_policy": 1851.0}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.10459041595459, "actor_loss": -17.34262466430664, "critic_loss": 0.11441664397716522, "alpha_loss": -5.614414691925049, "alpha_value": 0.5737106204032898, "log_alpha_value": -0.5556301474571228, "target_entropy": -6.0, "policy_t": 0.020616549998521805, "mean_q": 15.009832382202148, "max_q": 15.37757396697998, "min_q": 14.570728302001953}, "td_error": [1.2685136795043945, 0.636505126953125, 0.8347816467285156, 0.4962954521179199, 0.094024658203125, 1.6052799224853516, 1.2652859687805176, 1.4918251037597656, 0.9674310684204102, 0.9675369262695312, 1.2737751007080078, 0.7039251327514648, 0.8761792182922363, 0.2819647789001465, 1.0808830261230469, 0.6185359954833984, 0.9710073471069336, 0.8763494491577148, 1.2779064178466797, 0.973332405090332, 0.5018453598022461, 1.0536704063415527, 0.9774260520935059, 1.5782804489135742, 1.5108880996704102, 0.8999118804931641, 1.5038514137268066, 2.6547751426696777, 2.474259853363037, 0.7625570297241211, 0.9730086326599121, 0.6037559509277344, 1.2315235137939453, 1.49725341796875, 1.8917288780212402, 2.2672905921936035, 0.35897254943847656, 0.5208005905151367, 1.1061382293701172, 1.989487648010254, 1.269669532775879, 1.0108046531677246, 1.4886937141418457, 0.9405956268310547, 2.517679214477539, 0.9052734375, 0.2950706481933594, 0.9951338768005371, 2.5647926330566406, 1.1253471374511719, 1.0782890319824219, 1.715893268585205, 1.25571870803833, 0.24605131149291992, 2.1643733978271484, 0.7723150253295898, 0.7082552909851074, 0.7673921585083008, 2.192230224609375, 1.7596216201782227, 1.8408703804016113, 1.8543767929077148, 0.5775966644287109, 0.38667964935302734, 0.4459719657897949, 0.5153741836547852, 0.050579071044921875, 1.4584112167358398, 0.7932729721069336, 1.7484216690063477, 0.376248836517334, 1.5892009735107422, 0.31674861907958984, 1.4983654022216797, 1.8376178741455078, 1.0074090957641602, 0.7116422653198242, 2.195566177368164, 1.9349727630615234, 0.21474504470825195, 0.8288931846618652, 2.039246082305908, 1.2517237663269043, 0.9502363204956055, 1.681015968322754, 0.36757850646972656], "mean_td_error": 1.153078317642212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1852.0, "diff_num_grad_updates_vs_sampler_policy": 1851.0}, "agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113287925720215, "actor_loss": -17.17184829711914, "critic_loss": 0.1457105576992035, "alpha_loss": -5.6188836097717285, "alpha_value": 0.5737313032150269, "log_alpha_value": -0.5555941462516785, "target_entropy": -6.0, "policy_t": -0.0029074526391923428, "mean_q": 14.818599700927734, "max_q": 15.197132110595703, "min_q": 14.479320526123047}, "td_error": [0.5892319679260254, 1.4658160209655762, 1.5260186195373535, 0.7119789123535156, 0.620448112487793, 0.7351827621459961, 1.0277619361877441, 0.7980489730834961, 1.1630749702453613, 0.7298593521118164, 0.7245759963989258, 2.7591819763183594, 1.5387182235717773, 2.3489232063293457, 1.1067214012145996, 0.672245979309082, 2.427279472351074, 2.1876721382141113, 1.5506324768066406, 0.9664397239685059, 0.013745784759521484, 2.569507122039795, 2.5905699729919434, 0.40764713287353516, 0.6161303520202637, 1.088758945465088, 2.70733642578125, 0.16254186630249023, 0.13001060485839844, 2.726487636566162, 0.6247649192810059, 0.4045405387878418, 0.8400778770446777, 1.1598453521728516, 0.8636894226074219, 2.955979824066162, 0.562039852142334, 0.051666259765625, 1.6649870872497559, 0.19715166091918945, 0.5167160034179688, 1.167302131652832, 0.5080318450927734, 1.1572589874267578, 0.3228898048400879, 1.8770570755004883, 1.439112663269043, 1.2505302429199219, 0.6635656356811523, 0.9801769256591797, 1.7849173545837402, 1.1560039520263672, 0.6832823753356934, 0.6471824645996094, 0.5794157981872559, 1.6287899017333984, 1.2739791870117188, 1.662832260131836, 0.3060283660888672, 0.44978857040405273, 0.4852910041809082, 0.6881723403930664, 1.0384511947631836, 1.9201464653015137, 1.791684627532959, 2.9898204803466797, 0.2703433036804199, 0.8837347030639648, 0.07603168487548828, 0.19646978378295898, 1.3047733306884766, 1.1843843460083008, 2.16945219039917, 0.17518997192382812, 1.7094526290893555, 1.3902978897094727, 2.838416576385498, 1.5748567581176758, 0.7364020347595215, 0.2742290496826172, 1.0525097846984863, 0.11387920379638672, 0.9468884468078613, 0.4568009376525879, 1.4133920669555664, 3.1856865882873535], "mean_td_error": 1.1501036882400513, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 86.0, "num_grad_updates_lifetime": 1852.0, "diff_num_grad_updates_vs_sampler_policy": 1851.0}}, "num_env_steps_sampled": 14462, "num_env_steps_trained": 477816, "num_agent_steps_sampled": 43386, "num_agent_steps_trained": 477816, "last_target_update_ts": 14462, "num_target_updates": 1852}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 7, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43386, "num_agent_steps_trained": 477816, "num_env_steps_sampled": 14462, "num_env_steps_trained": 477816, "num_env_steps_sampled_this_iter": 105, "num_env_steps_trained_this_iter": 3870, "num_env_steps_sampled_throughput_per_sec": 62.789232691547674, "num_env_steps_trained_throughput_per_sec": 2314.231719202757, "timesteps_total": 14462, "num_steps_trained_this_iter": 3870, "agent_timesteps_total": 43386, "timers": {"training_iteration_time_ms": 113.973, "sample_time_ms": 18.939, "load_time_ms": 0.333, "load_throughput": 774277.642, "learn_time_ms": 20.131, "learn_throughput": 12815.802, "synch_weights_time_ms": 12.981}, "counters": {"num_env_steps_sampled": 14462, "num_env_steps_trained": 477816, "num_agent_steps_sampled": 43386, "num_agent_steps_trained": 477816, "last_target_update_ts": 14462, "num_target_updates": 1852}, "done": false, "episodes_total": 0, "training_iteration": 127, "trial_id": "db258_00000", "date": "2023-11-16_21-51-30", "timestamp": 1700200290, "time_this_iter_s": 1.6805319786071777, "time_total_s": 200.41580939292908, "pid": 44716, "hostname": "jang-yejun-ui-MacBookAir.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "politics_environment", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x16e141800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"agent_0": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_1": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}], "agent_2": [null, "Box(0.0, 2.0, (9,), float32)", "Box(-inf, inf, (6,), float32)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 7}, "time_since_restore": 200.41580939292908, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 41.3, "ram_util_percent": 63.5}}
